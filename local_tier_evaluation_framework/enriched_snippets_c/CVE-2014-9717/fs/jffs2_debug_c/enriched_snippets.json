[
  {
    "function_name": "jffs2_dbg_dump_node(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "772-865",
    "snippet": "id\n__jffs2_dbg_dump_node(struct jffs2_sb_info *c, uint32_t ofs)\n{\n\tunion jffs2_node_union node;\n\tint len = sizeof(union jffs2_node_union);\n\tsize_t retlen;\n\tuint32_t crc;\n\tint ret;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump node at offset %#08x.\\n\", ofs);\n\n\tret = jffs2_flash_read(c, ofs, len, &retlen, (unsigned char *)&node);\n\tif (ret || (retlen != len)) {\n\t\tJFFS2_ERROR(\"read %d bytes failed or short. ret %d, retlen %zd.\\n\",\n\t\t\tlen, ret, retlen);\n\t\treturn;\n\t}\n\n\tprintk(JFFS2_DBG \"magic:\\t%#04x\\n\", je16_to_cpu(node.u.magic));\n\tprintk(JFFS2_DBG \"nodetype:\\t%#04x\\n\", je16_to_cpu(node.u.nodetype));\n\tprintk(JFFS2_DBG \"totlen:\\t%#08x\\n\", je32_to_cpu(node.u.totlen));\n\tprintk(JFFS2_DBG \"hdr_crc:\\t%#08x\\n\", je32_to_cpu(node.u.hdr_crc));\n\n\tcrc = crc32(0, &node.u, sizeof(node.u) - 4);\n\tif (crc != je32_to_cpu(node.u.hdr_crc)) {\n\t\tJFFS2_ERROR(\"wrong common header CRC.\\n\");\n\t\treturn;\n\t}\n\n\tif (je16_to_cpu(node.u.magic) != JFFS2_MAGIC_BITMASK &&\n\t\tje16_to_cpu(node.u.magic) != JFFS2_OLD_MAGIC_BITMASK)\n\t{\n\t\tJFFS2_ERROR(\"wrong node magic: %#04x instead of %#04x.\\n\",\n\t\t\tje16_to_cpu(node.u.magic), JFFS2_MAGIC_BITMASK);\n\t\treturn;\n\t}\n\n\tswitch(je16_to_cpu(node.u.nodetype)) {\n\n\tcase JFFS2_NODETYPE_INODE:\n\n\t\tprintk(JFFS2_DBG \"the node is inode node\\n\");\n\t\tprintk(JFFS2_DBG \"ino:\\t%#08x\\n\", je32_to_cpu(node.i.ino));\n\t\tprintk(JFFS2_DBG \"version:\\t%#08x\\n\", je32_to_cpu(node.i.version));\n\t\tprintk(JFFS2_DBG \"mode:\\t%#08x\\n\", node.i.mode.m);\n\t\tprintk(JFFS2_DBG \"uid:\\t%#04x\\n\", je16_to_cpu(node.i.uid));\n\t\tprintk(JFFS2_DBG \"gid:\\t%#04x\\n\", je16_to_cpu(node.i.gid));\n\t\tprintk(JFFS2_DBG \"isize:\\t%#08x\\n\", je32_to_cpu(node.i.isize));\n\t\tprintk(JFFS2_DBG \"atime:\\t%#08x\\n\", je32_to_cpu(node.i.atime));\n\t\tprintk(JFFS2_DBG \"mtime:\\t%#08x\\n\", je32_to_cpu(node.i.mtime));\n\t\tprintk(JFFS2_DBG \"ctime:\\t%#08x\\n\", je32_to_cpu(node.i.ctime));\n\t\tprintk(JFFS2_DBG \"offset:\\t%#08x\\n\", je32_to_cpu(node.i.offset));\n\t\tprintk(JFFS2_DBG \"csize:\\t%#08x\\n\", je32_to_cpu(node.i.csize));\n\t\tprintk(JFFS2_DBG \"dsize:\\t%#08x\\n\", je32_to_cpu(node.i.dsize));\n\t\tprintk(JFFS2_DBG \"compr:\\t%#02x\\n\", node.i.compr);\n\t\tprintk(JFFS2_DBG \"usercompr:\\t%#02x\\n\", node.i.usercompr);\n\t\tprintk(JFFS2_DBG \"flags:\\t%#04x\\n\", je16_to_cpu(node.i.flags));\n\t\tprintk(JFFS2_DBG \"data_crc:\\t%#08x\\n\", je32_to_cpu(node.i.data_crc));\n\t\tprintk(JFFS2_DBG \"node_crc:\\t%#08x\\n\", je32_to_cpu(node.i.node_crc));\n\n\t\tcrc = crc32(0, &node.i, sizeof(node.i) - 8);\n\t\tif (crc != je32_to_cpu(node.i.node_crc)) {\n\t\t\tJFFS2_ERROR(\"wrong node header CRC.\\n\");\n\t\t\treturn;\n\t\t}\n\t\tbreak;\n\n\tcase JFFS2_NODETYPE_DIRENT:\n\n\t\tprintk(JFFS2_DBG \"the node is dirent node\\n\");\n\t\tprintk(JFFS2_DBG \"pino:\\t%#08x\\n\", je32_to_cpu(node.d.pino));\n\t\tprintk(JFFS2_DBG \"version:\\t%#08x\\n\", je32_to_cpu(node.d.version));\n\t\tprintk(JFFS2_DBG \"ino:\\t%#08x\\n\", je32_to_cpu(node.d.ino));\n\t\tprintk(JFFS2_DBG \"mctime:\\t%#08x\\n\", je32_to_cpu(node.d.mctime));\n\t\tprintk(JFFS2_DBG \"nsize:\\t%#02x\\n\", node.d.nsize);\n\t\tprintk(JFFS2_DBG \"type:\\t%#02x\\n\", node.d.type);\n\t\tprintk(JFFS2_DBG \"node_crc:\\t%#08x\\n\", je32_to_cpu(node.d.node_crc));\n\t\tprintk(JFFS2_DBG \"name_crc:\\t%#08x\\n\", je32_to_cpu(node.d.name_crc));\n\n\t\tnode.d.name[node.d.nsize] = '\\0';\n\t\tprintk(JFFS2_DBG \"name:\\t\\\"%s\\\"\\n\", node.d.name);\n\n\t\tcrc = crc32(0, &node.d, sizeof(node.d) - 8);\n\t\tif (crc != je32_to_cpu(node.d.node_crc)) {\n\t\t\tJFFS2_ERROR(\"wrong node header CRC.\\n\");\n\t\t\treturn;\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tprintk(JFFS2_DBG \"node type is unknown\\n\");\n\t\tbreak;\n\t}\n}\n#",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"node type is unknown\\n\");"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "rong node header CRC.\\n\");"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.d.node_crc))"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c32(0",
          "args": [
            "ode.d,",
            "zeof(node.d) - 8);"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"name:\\t\\\"%s\\\"\\n\",",
            "de.d.name);"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"name_crc:\\t%#08x\\n\",",
            "32_to_cpu(node.d.name_crc));"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.d.name_crc))"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"node_crc:\\t%#08x\\n\",",
            "32_to_cpu(node.d.node_crc));"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.d.node_crc))"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"type:\\t%#02x\\n\",",
            "de.d.type);"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"nsize:\\t%#02x\\n\",",
            "de.d.nsize);"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"mctime:\\t%#08x\\n\",",
            "32_to_cpu(node.d.mctime));"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.d.mctime))"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"ino:\\t%#08x\\n\",",
            "32_to_cpu(node.d.ino));"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.d.ino))"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"version:\\t%#08x\\n\",",
            "32_to_cpu(node.d.version));"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.d.version))"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"pino:\\t%#08x\\n\",",
            "32_to_cpu(node.d.pino));"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.d.pino))"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"the node is dirent node\\n\");"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "rong node header CRC.\\n\");"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.node_crc))"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c32(0",
          "args": [
            "ode.i,",
            "zeof(node.i) - 8);"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"node_crc:\\t%#08x\\n\",",
            "32_to_cpu(node.i.node_crc));"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.node_crc))"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"data_crc:\\t%#08x\\n\",",
            "32_to_cpu(node.i.data_crc));"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.data_crc))"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"flags:\\t%#04x\\n\",",
            "16_to_cpu(node.i.flags));"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.i.flags))"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"usercompr:\\t%#02x\\n\",",
            "de.i.usercompr);"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"compr:\\t%#02x\\n\",",
            "de.i.compr);"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"dsize:\\t%#08x\\n\",",
            "32_to_cpu(node.i.dsize));"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.dsize))"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"csize:\\t%#08x\\n\",",
            "32_to_cpu(node.i.csize));"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.csize))"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"offset:\\t%#08x\\n\",",
            "32_to_cpu(node.i.offset));"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.offset))"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"ctime:\\t%#08x\\n\",",
            "32_to_cpu(node.i.ctime));"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.ctime))"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"mtime:\\t%#08x\\n\",",
            "32_to_cpu(node.i.mtime));"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.mtime))"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"atime:\\t%#08x\\n\",",
            "32_to_cpu(node.i.atime));"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.atime))"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"isize:\\t%#08x\\n\",",
            "32_to_cpu(node.i.isize));"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.isize))"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"gid:\\t%#04x\\n\",",
            "16_to_cpu(node.i.gid));"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.i.gid))"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"uid:\\t%#04x\\n\",",
            "16_to_cpu(node.i.uid));"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.i.uid))"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"mode:\\t%#08x\\n\",",
            "de.i.mode.m);"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"version:\\t%#08x\\n\",",
            "32_to_cpu(node.i.version));"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.version))"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"ino:\\t%#08x\\n\",",
            "32_to_cpu(node.i.ino));"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.i.ino))"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"the node is inode node\\n\");"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.u.nodetype))"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "rong node magic: %#04x instead of %#04x.\\n\",",
            "16_to_cpu(node.u.magic),",
            "FS2_MAGIC_BITMASK);"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.u.magic),"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.u.magic)"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.u.magic)"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "rong common header CRC.\\n\");"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.u.hdr_crc))"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c32(0",
          "args": [
            "ode.u,",
            "zeof(node.u) - 4);"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"hdr_crc:\\t%#08x\\n\",",
            "32_to_cpu(node.u.hdr_crc));"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.u.hdr_crc))"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"totlen:\\t%#08x\\n\",",
            "32_to_cpu(node.u.totlen));"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "32_to_cpu(n",
          "args": [
            "de.u.totlen))"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"nodetype:\\t%#04x\\n\",",
            "16_to_cpu(node.u.nodetype));"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.u.nodetype))"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"magic:\\t%#04x\\n\",",
            "16_to_cpu(node.u.magic));"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "16_to_cpu(n",
          "args": [
            "de.u.magic))"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "ead %d bytes failed or short. ret %d, retlen %zd.\\n\",",
            "n,",
            "t,",
            "tlen);"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_flash_read(c",
          "args": [
            "s,",
            "n,",
            "etlen,",
            "nsigned char *)&node);"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG_MSG_PREFIX \" dump node at offset %#08x.\\n\",",
            "s);"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_node(struct jffs2_sb_info *c, uint32_t ofs)\n{\n\tunion jffs2_node_union node;\n\tint len = sizeof(union jffs2_node_union);\n\tsize_t retlen;\n\tuint32_t crc;\n\tint ret;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump node at offset %#08x.\\n\", ofs);\n\n\tret = jffs2_flash_read(c, ofs, len, &retlen, (unsigned char *)&node);\n\tif (ret || (retlen != len)) {\n\t\tJFFS2_ERROR(\"read %d bytes failed or short. ret %d, retlen %zd.\\n\",\n\t\t\tlen, ret, retlen);\n\t\treturn;\n\t}\n\n\tprintk(JFFS2_DBG \"magic:\\t%#04x\\n\", je16_to_cpu(node.u.magic));\n\tprintk(JFFS2_DBG \"nodetype:\\t%#04x\\n\", je16_to_cpu(node.u.nodetype));\n\tprintk(JFFS2_DBG \"totlen:\\t%#08x\\n\", je32_to_cpu(node.u.totlen));\n\tprintk(JFFS2_DBG \"hdr_crc:\\t%#08x\\n\", je32_to_cpu(node.u.hdr_crc));\n\n\tcrc = crc32(0, &node.u, sizeof(node.u) - 4);\n\tif (crc != je32_to_cpu(node.u.hdr_crc)) {\n\t\tJFFS2_ERROR(\"wrong common header CRC.\\n\");\n\t\treturn;\n\t}\n\n\tif (je16_to_cpu(node.u.magic) != JFFS2_MAGIC_BITMASK &&\n\t\tje16_to_cpu(node.u.magic) != JFFS2_OLD_MAGIC_BITMASK)\n\t{\n\t\tJFFS2_ERROR(\"wrong node magic: %#04x instead of %#04x.\\n\",\n\t\t\tje16_to_cpu(node.u.magic), JFFS2_MAGIC_BITMASK);\n\t\treturn;\n\t}\n\n\tswitch(je16_to_cpu(node.u.nodetype)) {\n\n\tcase JFFS2_NODETYPE_INODE:\n\n\t\tprintk(JFFS2_DBG \"the node is inode node\\n\");\n\t\tprintk(JFFS2_DBG \"ino:\\t%#08x\\n\", je32_to_cpu(node.i.ino));\n\t\tprintk(JFFS2_DBG \"version:\\t%#08x\\n\", je32_to_cpu(node.i.version));\n\t\tprintk(JFFS2_DBG \"mode:\\t%#08x\\n\", node.i.mode.m);\n\t\tprintk(JFFS2_DBG \"uid:\\t%#04x\\n\", je16_to_cpu(node.i.uid));\n\t\tprintk(JFFS2_DBG \"gid:\\t%#04x\\n\", je16_to_cpu(node.i.gid));\n\t\tprintk(JFFS2_DBG \"isize:\\t%#08x\\n\", je32_to_cpu(node.i.isize));\n\t\tprintk(JFFS2_DBG \"atime:\\t%#08x\\n\", je32_to_cpu(node.i.atime));\n\t\tprintk(JFFS2_DBG \"mtime:\\t%#08x\\n\", je32_to_cpu(node.i.mtime));\n\t\tprintk(JFFS2_DBG \"ctime:\\t%#08x\\n\", je32_to_cpu(node.i.ctime));\n\t\tprintk(JFFS2_DBG \"offset:\\t%#08x\\n\", je32_to_cpu(node.i.offset));\n\t\tprintk(JFFS2_DBG \"csize:\\t%#08x\\n\", je32_to_cpu(node.i.csize));\n\t\tprintk(JFFS2_DBG \"dsize:\\t%#08x\\n\", je32_to_cpu(node.i.dsize));\n\t\tprintk(JFFS2_DBG \"compr:\\t%#02x\\n\", node.i.compr);\n\t\tprintk(JFFS2_DBG \"usercompr:\\t%#02x\\n\", node.i.usercompr);\n\t\tprintk(JFFS2_DBG \"flags:\\t%#04x\\n\", je16_to_cpu(node.i.flags));\n\t\tprintk(JFFS2_DBG \"data_crc:\\t%#08x\\n\", je32_to_cpu(node.i.data_crc));\n\t\tprintk(JFFS2_DBG \"node_crc:\\t%#08x\\n\", je32_to_cpu(node.i.node_crc));\n\n\t\tcrc = crc32(0, &node.i, sizeof(node.i) - 8);\n\t\tif (crc != je32_to_cpu(node.i.node_crc)) {\n\t\t\tJFFS2_ERROR(\"wrong node header CRC.\\n\");\n\t\t\treturn;\n\t\t}\n\t\tbreak;\n\n\tcase JFFS2_NODETYPE_DIRENT:\n\n\t\tprintk(JFFS2_DBG \"the node is dirent node\\n\");\n\t\tprintk(JFFS2_DBG \"pino:\\t%#08x\\n\", je32_to_cpu(node.d.pino));\n\t\tprintk(JFFS2_DBG \"version:\\t%#08x\\n\", je32_to_cpu(node.d.version));\n\t\tprintk(JFFS2_DBG \"ino:\\t%#08x\\n\", je32_to_cpu(node.d.ino));\n\t\tprintk(JFFS2_DBG \"mctime:\\t%#08x\\n\", je32_to_cpu(node.d.mctime));\n\t\tprintk(JFFS2_DBG \"nsize:\\t%#02x\\n\", node.d.nsize);\n\t\tprintk(JFFS2_DBG \"type:\\t%#02x\\n\", node.d.type);\n\t\tprintk(JFFS2_DBG \"node_crc:\\t%#08x\\n\", je32_to_cpu(node.d.node_crc));\n\t\tprintk(JFFS2_DBG \"name_crc:\\t%#08x\\n\", je32_to_cpu(node.d.name_crc));\n\n\t\tnode.d.name[node.d.nsize] = '\\0';\n\t\tprintk(JFFS2_DBG \"name:\\t\\\"%s\\\"\\n\", node.d.name);\n\n\t\tcrc = crc32(0, &node.d, sizeof(node.d) - 8);\n\t\tif (crc != je32_to_cpu(node.d.node_crc)) {\n\t\t\tJFFS2_ERROR(\"wrong node header CRC.\\n\");\n\t\t\treturn;\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tprintk(JFFS2_DBG \"node type is unknown\\n\");\n\t\tbreak;\n\t}\n}\n#"
  },
  {
    "function_name": "jffs2_dbg_dump_buffer(u",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "736-767",
    "snippet": "id\n__jffs2_dbg_dump_buffer(unsigned char *buf, int len, uint32_t offs)\n{\n\tint skip;\n\tint i;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump from offset %#08x to offset %#08x (%x bytes).\\n\",\n\t\toffs, offs + len, len);\n\ti = skip = offs % JFFS2_BUFDUMP_BYTES_PER_LINE;\n\toffs = offs & ~(JFFS2_BUFDUMP_BYTES_PER_LINE - 1);\n\n\tif (skip != 0)\n\t\tprintk(JFFS2_DBG \"%#08x: \", offs);\n\n\twhile (skip--)\n\t\tprintk(\"   \");\n\n\twhile (i < len) {\n\t\tif ((i % JFFS2_BUFDUMP_BYTES_PER_LINE) == 0 && i != len -1) {\n\t\t\tif (i != 0)\n\t\t\t\tprintk(\"\\n\");\n\t\t\toffs += JFFS2_BUFDUMP_BYTES_PER_LINE;\n\t\t\tprintk(JFFS2_DBG \"%0#8x: \", offs);\n\t\t}\n\n\t\tprintk(\"%02x \", buf[i]);\n\n\t\ti += 1;\n\t}\n\n\tprintk(\"\\n\");\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "n\");"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "02x \",",
            "f[i]);"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"%0#8x: \",",
            "fs);"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "n\");"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "\");"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"%#08x: \",",
            "fs);"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG_MSG_PREFIX \" dump from offset %#08x to offset %#08x (%x bytes).\\n\",",
            "fs,",
            "fs + len,",
            "n);"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_buffer(unsigned char *buf, int len, uint32_t offs)\n{\n\tint skip;\n\tint i;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump from offset %#08x to offset %#08x (%x bytes).\\n\",\n\t\toffs, offs + len, len);\n\ti = skip = offs % JFFS2_BUFDUMP_BYTES_PER_LINE;\n\toffs = offs & ~(JFFS2_BUFDUMP_BYTES_PER_LINE - 1);\n\n\tif (skip != 0)\n\t\tprintk(JFFS2_DBG \"%#08x: \", offs);\n\n\twhile (skip--)\n\t\tprintk(\"   \");\n\n\twhile (i < len) {\n\t\tif ((i % JFFS2_BUFDUMP_BYTES_PER_LINE) == 0 && i != len -1) {\n\t\t\tif (i != 0)\n\t\t\t\tprintk(\"\\n\");\n\t\t\toffs += JFFS2_BUFDUMP_BYTES_PER_LINE;\n\t\t\tprintk(JFFS2_DBG \"%0#8x: \", offs);\n\t\t}\n\n\t\tprintk(\"%02x \", buf[i]);\n\n\t\ti += 1;\n\t}\n\n\tprintk(\"\\n\");\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_fragtree_nolock(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "702-733",
    "snippet": "id\n__jffs2_dbg_dump_fragtree_nolock(struct jffs2_inode_info *f)\n{\n\tstruct jffs2_node_frag *this = frag_first(&f->fragtree);\n\tuint32_t lastofs = 0;\n\tint buggy = 0;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump fragtree of ino #%u\\n\", f->inocache->ino);\n\twhile(this) {\n\t\tif (this->node)\n\t\t\tprintk(JFFS2_DBG \"frag %#04x-%#04x: %#08x(%d) on flash (*%p), left (%p), right (%p), parent (%p)\\n\",\n\t\t\t\tthis->ofs, this->ofs+this->size, ref_offset(this->node->raw),\n\t\t\t\tref_flags(this->node->raw), this, frag_left(this), frag_right(this),\n\t\t\t\tfrag_parent(this));\n\t\telse\n\t\t\tprintk(JFFS2_DBG \"frag %#04x-%#04x: hole (*%p). left (%p), right (%p), parent (%p)\\n\",\n\t\t\t\tthis->ofs, this->ofs+this->size, this, frag_left(this),\n\t\t\t\tfrag_right(this), frag_parent(this));\n\t\tif (this->ofs != lastofs)\n\t\t\tbuggy = 1;\n\t\tlastofs = this->ofs + this->size;\n\t\tthis = frag_next(this);\n\t}\n\n\tif (f->metadata)\n\t\tprintk(JFFS2_DBG \"metadata at 0x%08x\\n\", ref_offset(f->metadata->raw));\n\n\tif (buggy) {\n\t\tJFFS2_ERROR(\"frag tree got a hole in it.\\n\");\n\t\tBUG();\n\t}\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "G()",
          "args": [],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "rag tree got a hole in it.\\n\");"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"metadata at 0x%08x\\n\",",
            "f_offset(f->metadata->raw));"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(f",
          "args": [
            ">metadata->raw))"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_next(t",
          "args": [
            "is);"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"frag %#04x-%#04x: hole (*%p). left (%p), right (%p), parent (%p)\\n\",",
            "is->ofs,",
            "is->ofs+this->size,",
            "is,",
            "ag_left(this),",
            "ag_right(this),",
            "ag_parent(this));"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_parent(t",
          "args": [
            "is))"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_right(t",
          "args": [
            "is),"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_left(t",
          "args": [
            "is),"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"frag %#04x-%#04x: %#08x(%d) on flash (*%p), left (%p), right (%p), parent (%p)\\n\",",
            "is->ofs,",
            "is->ofs+this->size,",
            "f_offset(this->node->raw),",
            "f_flags(this->node->raw),",
            "is,",
            "ag_left(this),",
            "ag_right(this),",
            "ag_parent(this));"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_parent(t",
          "args": [
            "is))"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_right(t",
          "args": [
            "is),"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_left(t",
          "args": [
            "is),"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_flags(t",
          "args": [
            "is->node->raw),"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(t",
          "args": [
            "is->node->raw),"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG_MSG_PREFIX \" dump fragtree of ino #%u\\n\",",
            ">inocache->ino);"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_first(&",
          "args": [
            "->fragtree);"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_fragtree_nolock(struct jffs2_inode_info *f)\n{\n\tstruct jffs2_node_frag *this = frag_first(&f->fragtree);\n\tuint32_t lastofs = 0;\n\tint buggy = 0;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump fragtree of ino #%u\\n\", f->inocache->ino);\n\twhile(this) {\n\t\tif (this->node)\n\t\t\tprintk(JFFS2_DBG \"frag %#04x-%#04x: %#08x(%d) on flash (*%p), left (%p), right (%p), parent (%p)\\n\",\n\t\t\t\tthis->ofs, this->ofs+this->size, ref_offset(this->node->raw),\n\t\t\t\tref_flags(this->node->raw), this, frag_left(this), frag_right(this),\n\t\t\t\tfrag_parent(this));\n\t\telse\n\t\t\tprintk(JFFS2_DBG \"frag %#04x-%#04x: hole (*%p). left (%p), right (%p), parent (%p)\\n\",\n\t\t\t\tthis->ofs, this->ofs+this->size, this, frag_left(this),\n\t\t\t\tfrag_right(this), frag_parent(this));\n\t\tif (this->ofs != lastofs)\n\t\t\tbuggy = 1;\n\t\tlastofs = this->ofs + this->size;\n\t\tthis = frag_next(this);\n\t}\n\n\tif (f->metadata)\n\t\tprintk(JFFS2_DBG \"metadata at 0x%08x\\n\", ref_offset(f->metadata->raw));\n\n\tif (buggy) {\n\t\tJFFS2_ERROR(\"frag tree got a hole in it.\\n\");\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_fragtree(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "694-700",
    "snippet": "id\n__jffs2_dbg_dump_fragtree(struct jffs2_inode_info *f)\n{\n\tmutex_lock(&f->sem);\n\tjffs2_dbg_dump_fragtree_nolock(f);\n\tmutex_unlock(&f->sem);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tex_unlock(&",
          "args": [
            "->sem);"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_dbg_dump_fragtree_nolock(f",
          "args": [
            ";"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tex_lock(&",
          "args": [
            "->sem);"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_fragtree(struct jffs2_inode_info *f)\n{\n\tmutex_lock(&f->sem);\n\tjffs2_dbg_dump_fragtree_nolock(f);\n\tmutex_unlock(&f->sem);\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_block_lists_nolock(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "466-692",
    "snippet": "id\n__jffs2_dbg_dump_block_lists_nolock(struct jffs2_sb_info *c)\n{\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump JFFS2 blocks lists:\\n\");\n\n\tprintk(JFFS2_DBG \"flash_size: %#08x\\n\",\t\tc->flash_size);\n\tprintk(JFFS2_DBG \"used_size: %#08x\\n\",\t\tc->used_size);\n\tprintk(JFFS2_DBG \"dirty_size: %#08x\\n\",\t\tc->dirty_size);\n\tprintk(JFFS2_DBG \"wasted_size: %#08x\\n\",\tc->wasted_size);\n\tprintk(JFFS2_DBG \"unchecked_size: %#08x\\n\",\tc->unchecked_size);\n\tprintk(JFFS2_DBG \"free_size: %#08x\\n\",\t\tc->free_size);\n\tprintk(JFFS2_DBG \"erasing_size: %#08x\\n\",\tc->erasing_size);\n\tprintk(JFFS2_DBG \"bad_size: %#08x\\n\",\t\tc->bad_size);\n\tprintk(JFFS2_DBG \"sector_size: %#08x\\n\",\tc->sector_size);\n\tprintk(JFFS2_DBG \"jffs2_reserved_blocks size: %#08x\\n\",\n\t\t\t\tc->sector_size * c->resv_blocks_write);\n\n\tif (c->nextblock)\n\t\tprintk(JFFS2_DBG \"nextblock: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\tc->nextblock->offset, c->nextblock->used_size,\n\t\t\tc->nextblock->dirty_size, c->nextblock->wasted_size,\n\t\t\tc->nextblock->unchecked_size, c->nextblock->free_size);\n\telse\n\t\tprintk(JFFS2_DBG \"nextblock: NULL\\n\");\n\n\tif (c->gcblock)\n\t\tprintk(JFFS2_DBG \"gcblock: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\tc->gcblock->offset, c->gcblock->used_size, c->gcblock->dirty_size,\n\t\t\tc->gcblock->wasted_size, c->gcblock->unchecked_size, c->gcblock->free_size);\n\telse\n\t\tprintk(JFFS2_DBG \"gcblock: NULL\\n\");\n\n\tif (list_empty(&c->clean_list)) {\n\t\tprintk(JFFS2_DBG \"clean_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\t\tint numblocks = 0;\n\t\tuint32_t dirty = 0;\n\n\t\tlist_for_each(this, &c->clean_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\t\t\tnumblocks ++;\n\t\t\tdirty += jeb->wasted_size;\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"clean_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\n\t\tprintk (JFFS2_DBG \"Contains %d blocks with total wasted size %u, average wasted size: %u\\n\",\n\t\t\tnumblocks, dirty, dirty / numblocks);\n\t}\n\n\tif (list_empty(&c->very_dirty_list)) {\n\t\tprintk(JFFS2_DBG \"very_dirty_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\t\tint numblocks = 0;\n\t\tuint32_t dirty = 0;\n\n\t\tlist_for_each(this, &c->very_dirty_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tnumblocks ++;\n\t\t\tdirty += jeb->dirty_size;\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"very_dirty_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\n\t\tprintk (JFFS2_DBG \"Contains %d blocks with total dirty size %u, average dirty size: %u\\n\",\n\t\t\tnumblocks, dirty, dirty / numblocks);\n\t}\n\n\tif (list_empty(&c->dirty_list)) {\n\t\tprintk(JFFS2_DBG \"dirty_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\t\tint numblocks = 0;\n\t\tuint32_t dirty = 0;\n\n\t\tlist_for_each(this, &c->dirty_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tnumblocks ++;\n\t\t\tdirty += jeb->dirty_size;\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"dirty_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\n\t\tprintk (JFFS2_DBG \"contains %d blocks with total dirty size %u, average dirty size: %u\\n\",\n\t\t\tnumblocks, dirty, dirty / numblocks);\n\t}\n\n\tif (list_empty(&c->erasable_list)) {\n\t\tprintk(JFFS2_DBG \"erasable_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erasable_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erasable_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->erasing_list)) {\n\t\tprintk(JFFS2_DBG \"erasing_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erasing_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erasing_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\tif (list_empty(&c->erase_checking_list)) {\n\t\tprintk(JFFS2_DBG \"erase_checking_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erase_checking_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erase_checking_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->erase_pending_list)) {\n\t\tprintk(JFFS2_DBG \"erase_pending_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erase_pending_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erase_pending_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->erasable_pending_wbuf_list)) {\n\t\tprintk(JFFS2_DBG \"erasable_pending_wbuf_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erasable_pending_wbuf_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erasable_pending_wbuf_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->free_list)) {\n\t\tprintk(JFFS2_DBG \"free_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->free_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"free_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->bad_list)) {\n\t\tprintk(JFFS2_DBG \"bad_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->bad_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"bad_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->bad_used_list)) {\n\t\tprintk(JFFS2_DBG \"bad_used_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->bad_used_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"bad_used_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"bad_used_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->bad_used_list)"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"bad_used_list: empty\\n\");"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->bad_used_list))"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"bad_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->bad_list)"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"bad_list: empty\\n\");"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->bad_list))"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"free_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->free_list)"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"free_list: empty\\n\");"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->free_list))"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erasable_pending_wbuf_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->erasable_pending_wbuf_list)"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erasable_pending_wbuf_list: empty\\n\");"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->erasable_pending_wbuf_list))"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erase_pending_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->erase_pending_list)"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erase_pending_list: empty\\n\");"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->erase_pending_list))"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erase_checking_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->erase_checking_list)"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erase_checking_list: empty\\n\");"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->erase_checking_list))"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erasing_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->erasing_list)"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erasing_list: empty\\n\");"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->erasing_list))"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erasable_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->erasable_list)"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erasable_list: empty\\n\");"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->erasable_list))"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk (",
          "args": [
            "FS2_DBG \"contains %d blocks with total dirty size %u, average dirty size: %u\\n\",",
            "mblocks,",
            "rty,",
            "rty / numblocks);"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"dirty_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->dirty_list)"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"dirty_list: empty\\n\");"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->dirty_list))"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk (",
          "args": [
            "FS2_DBG \"Contains %d blocks with total dirty size %u, average dirty size: %u\\n\",",
            "mblocks,",
            "rty,",
            "rty / numblocks);"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"very_dirty_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->very_dirty_list)"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"very_dirty_list: empty\\n\");"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->very_dirty_list))"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk (",
          "args": [
            "FS2_DBG \"Contains %d blocks with total wasted size %u, average wasted size: %u\\n\",",
            "mblocks,",
            "rty,",
            "rty / numblocks);"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"clean_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            "b->offset,",
            "b->used_size,",
            "b->dirty_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            "b->free_size);"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_entry(t",
          "args": [
            "is,",
            "ruct jfs2_eraseblock,",
            "st);"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each(t",
          "args": [
            "is,",
            "->clean_list)"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"clean_list: empty\\n\");"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_empty(&",
          "args": [
            "->clean_list))"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"gcblock: NULL\\n\");"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"gcblock: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            ">gcblock->offset,",
            ">gcblock->used_size,",
            ">gcblock->dirty_size,",
            ">gcblock->wasted_size,",
            ">gcblock->unchecked_size,",
            ">gcblock->free_size);"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"nextblock: NULL\\n\");"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"nextblock: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",",
            ">nextblock->offset,",
            ">nextblock->used_size,",
            ">nextblock->dirty_size,",
            ">nextblock->wasted_size,",
            ">nextblock->unchecked_size,",
            ">nextblock->free_size);"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"jffs2_reserved_blocks size: %#08x\\n\",",
            ">sector_size * c->resv_blocks_write);"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"sector_size: %#08x\\n\",",
            ">sector_size);"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"bad_size: %#08x\\n\",",
            ">bad_size);"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"erasing_size: %#08x\\n\",",
            ">erasing_size);"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"free_size: %#08x\\n\",",
            ">free_size);"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"unchecked_size: %#08x\\n\",",
            ">unchecked_size);"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"wasted_size: %#08x\\n\",",
            ">wasted_size);"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"dirty_size: %#08x\\n\",",
            ">dirty_size);"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"used_size: %#08x\\n\",",
            ">used_size);"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"flash_size: %#08x\\n\",",
            ">flash_size);"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG_MSG_PREFIX \" dump JFFS2 blocks lists:\\n\");"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_block_lists_nolock(struct jffs2_sb_info *c)\n{\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump JFFS2 blocks lists:\\n\");\n\n\tprintk(JFFS2_DBG \"flash_size: %#08x\\n\",\t\tc->flash_size);\n\tprintk(JFFS2_DBG \"used_size: %#08x\\n\",\t\tc->used_size);\n\tprintk(JFFS2_DBG \"dirty_size: %#08x\\n\",\t\tc->dirty_size);\n\tprintk(JFFS2_DBG \"wasted_size: %#08x\\n\",\tc->wasted_size);\n\tprintk(JFFS2_DBG \"unchecked_size: %#08x\\n\",\tc->unchecked_size);\n\tprintk(JFFS2_DBG \"free_size: %#08x\\n\",\t\tc->free_size);\n\tprintk(JFFS2_DBG \"erasing_size: %#08x\\n\",\tc->erasing_size);\n\tprintk(JFFS2_DBG \"bad_size: %#08x\\n\",\t\tc->bad_size);\n\tprintk(JFFS2_DBG \"sector_size: %#08x\\n\",\tc->sector_size);\n\tprintk(JFFS2_DBG \"jffs2_reserved_blocks size: %#08x\\n\",\n\t\t\t\tc->sector_size * c->resv_blocks_write);\n\n\tif (c->nextblock)\n\t\tprintk(JFFS2_DBG \"nextblock: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\tc->nextblock->offset, c->nextblock->used_size,\n\t\t\tc->nextblock->dirty_size, c->nextblock->wasted_size,\n\t\t\tc->nextblock->unchecked_size, c->nextblock->free_size);\n\telse\n\t\tprintk(JFFS2_DBG \"nextblock: NULL\\n\");\n\n\tif (c->gcblock)\n\t\tprintk(JFFS2_DBG \"gcblock: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\tc->gcblock->offset, c->gcblock->used_size, c->gcblock->dirty_size,\n\t\t\tc->gcblock->wasted_size, c->gcblock->unchecked_size, c->gcblock->free_size);\n\telse\n\t\tprintk(JFFS2_DBG \"gcblock: NULL\\n\");\n\n\tif (list_empty(&c->clean_list)) {\n\t\tprintk(JFFS2_DBG \"clean_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\t\tint numblocks = 0;\n\t\tuint32_t dirty = 0;\n\n\t\tlist_for_each(this, &c->clean_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\t\t\tnumblocks ++;\n\t\t\tdirty += jeb->wasted_size;\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"clean_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\n\t\tprintk (JFFS2_DBG \"Contains %d blocks with total wasted size %u, average wasted size: %u\\n\",\n\t\t\tnumblocks, dirty, dirty / numblocks);\n\t}\n\n\tif (list_empty(&c->very_dirty_list)) {\n\t\tprintk(JFFS2_DBG \"very_dirty_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\t\tint numblocks = 0;\n\t\tuint32_t dirty = 0;\n\n\t\tlist_for_each(this, &c->very_dirty_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tnumblocks ++;\n\t\t\tdirty += jeb->dirty_size;\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"very_dirty_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\n\t\tprintk (JFFS2_DBG \"Contains %d blocks with total dirty size %u, average dirty size: %u\\n\",\n\t\t\tnumblocks, dirty, dirty / numblocks);\n\t}\n\n\tif (list_empty(&c->dirty_list)) {\n\t\tprintk(JFFS2_DBG \"dirty_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\t\tint numblocks = 0;\n\t\tuint32_t dirty = 0;\n\n\t\tlist_for_each(this, &c->dirty_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tnumblocks ++;\n\t\t\tdirty += jeb->dirty_size;\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"dirty_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\n\t\tprintk (JFFS2_DBG \"contains %d blocks with total dirty size %u, average dirty size: %u\\n\",\n\t\t\tnumblocks, dirty, dirty / numblocks);\n\t}\n\n\tif (list_empty(&c->erasable_list)) {\n\t\tprintk(JFFS2_DBG \"erasable_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erasable_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erasable_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->erasing_list)) {\n\t\tprintk(JFFS2_DBG \"erasing_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erasing_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erasing_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\tif (list_empty(&c->erase_checking_list)) {\n\t\tprintk(JFFS2_DBG \"erase_checking_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erase_checking_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erase_checking_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->erase_pending_list)) {\n\t\tprintk(JFFS2_DBG \"erase_pending_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erase_pending_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erase_pending_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->erasable_pending_wbuf_list)) {\n\t\tprintk(JFFS2_DBG \"erasable_pending_wbuf_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->erasable_pending_wbuf_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"erasable_pending_wbuf_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->free_list)) {\n\t\tprintk(JFFS2_DBG \"free_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->free_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"free_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->bad_list)) {\n\t\tprintk(JFFS2_DBG \"bad_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->bad_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"bad_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (list_empty(&c->bad_used_list)) {\n\t\tprintk(JFFS2_DBG \"bad_used_list: empty\\n\");\n\t} else {\n\t\tstruct list_head *this;\n\n\t\tlist_for_each(this, &c->bad_used_list) {\n\t\t\tstruct jffs2_eraseblock *jeb = list_entry(this, struct jffs2_eraseblock, list);\n\n\t\t\tif (!(jeb->used_size == 0 && jeb->dirty_size == 0 && jeb->wasted_size == 0)) {\n\t\t\t\tprintk(JFFS2_DBG \"bad_used_list: %#08x (used %#08x, dirty %#08x, wasted %#08x, unchecked %#08x, free %#08x)\\n\",\n\t\t\t\t\tjeb->offset, jeb->used_size, jeb->dirty_size, jeb->wasted_size,\n\t\t\t\t\tjeb->unchecked_size, jeb->free_size);\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_block_lists(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "458-464",
    "snippet": "id\n__jffs2_dbg_dump_block_lists(struct jffs2_sb_info *c)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_dump_block_lists_nolock(c);\n\tspin_unlock(&c->erase_completion_lock);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_unlock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_block_lists_nolock(c",
          "args": [
            ";"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_lock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_block_lists(struct jffs2_sb_info *c)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_dump_block_lists_nolock(c);\n\tspin_unlock(&c->erase_completion_lock);\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_jeb_nolock(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "442-456",
    "snippet": "id\n__jffs2_dbg_dump_jeb_nolock(struct jffs2_eraseblock *jeb)\n{\n\tif (!jeb)\n\t\treturn;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump space accounting for the eraseblock at %#08x:\\n\",\n\t\t\tjeb->offset);\n\n\tprintk(JFFS2_DBG \"used_size: %#08x\\n\",\t\tjeb->used_size);\n\tprintk(JFFS2_DBG \"dirty_size: %#08x\\n\",\t\tjeb->dirty_size);\n\tprintk(JFFS2_DBG \"wasted_size: %#08x\\n\",\tjeb->wasted_size);\n\tprintk(JFFS2_DBG \"unchecked_size: %#08x\\n\",\tjeb->unchecked_size);\n\tprintk(JFFS2_DBG \"free_size: %#08x\\n\",\t\tjeb->free_size);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"free_size: %#08x\\n\",",
            "b->free_size);"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"unchecked_size: %#08x\\n\",",
            "b->unchecked_size);"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"wasted_size: %#08x\\n\",",
            "b->wasted_size);"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"dirty_size: %#08x\\n\",",
            "b->dirty_size);"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG \"used_size: %#08x\\n\",",
            "b->used_size);"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG_MSG_PREFIX \" dump space accounting for the eraseblock at %#08x:\\n\",",
            "b->offset);"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_jeb_nolock(struct jffs2_eraseblock *jeb)\n{\n\tif (!jeb)\n\t\treturn;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" dump space accounting for the eraseblock at %#08x:\\n\",\n\t\t\tjeb->offset);\n\n\tprintk(JFFS2_DBG \"used_size: %#08x\\n\",\t\tjeb->used_size);\n\tprintk(JFFS2_DBG \"dirty_size: %#08x\\n\",\t\tjeb->dirty_size);\n\tprintk(JFFS2_DBG \"wasted_size: %#08x\\n\",\tjeb->wasted_size);\n\tprintk(JFFS2_DBG \"unchecked_size: %#08x\\n\",\tjeb->unchecked_size);\n\tprintk(JFFS2_DBG \"free_size: %#08x\\n\",\t\tjeb->free_size);\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_jeb(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "434-440",
    "snippet": "id\n__jffs2_dbg_dump_jeb(struct jffs2_sb_info *c, struct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_dump_jeb_nolock(jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_unlock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_jeb_nolock(j",
          "args": [
            "b);"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_lock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_jeb(struct jffs2_sb_info *c, struct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_dump_jeb_nolock(jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_node_refs_nolock(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "400-429",
    "snippet": "id\n__jffs2_dbg_dump_node_refs_nolock(struct jffs2_sb_info *c,\n\t\t\t\t  struct jffs2_eraseblock *jeb)\n{\n\tstruct jffs2_raw_node_ref *ref;\n\tint i = 0;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" Dump node_refs of the eraseblock %#08x\\n\", jeb->offset);\n\tif (!jeb->first_node) {\n\t\tprintk(JFFS2_DBG_MSG_PREFIX \" no nodes in the eraseblock %#08x\\n\", jeb->offset);\n\t\treturn;\n\t}\n\n\tprintk(JFFS2_DBG);\n\tfor (ref = jeb->first_node; ; ref = ref_next(ref)) {\n\t\tprintk(\"%#08x\", ref_offset(ref));\n#ifdef TEST_TOTLEN\n\t\tprintk(\"(%x)\", ref->__totlen);\n#endif\n\t\tif (ref_next(ref))\n\t\t\tprintk(\"->\");\n\t\telse\n\t\t\tbreak;\n\t\tif (++i == 4) {\n\t\t\ti = 0;\n\t\t\tprintk(\"\\n\" JFFS2_DBG);\n\t\t}\n\t}\n\tprintk(\"\\n\");\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "n\");"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "n\" JFFS2_DBG);"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            ">\");"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_next(r",
          "args": [
            "f))"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "%x)\",",
            "f->__totlen);"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(\"",
          "args": [
            "#08x\",",
            "f_offset(ref));"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(r",
          "args": [
            "f))"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_next(r",
          "args": [
            "f))"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG);"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG_MSG_PREFIX \" no nodes in the eraseblock %#08x\\n\",",
            "b->offset);"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intk(J",
          "args": [
            "FS2_DBG_MSG_PREFIX \" Dump node_refs of the eraseblock %#08x\\n\",",
            "b->offset);"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_node_refs_nolock(struct jffs2_sb_info *c,\n\t\t\t\t  struct jffs2_eraseblock *jeb)\n{\n\tstruct jffs2_raw_node_ref *ref;\n\tint i = 0;\n\n\tprintk(JFFS2_DBG_MSG_PREFIX \" Dump node_refs of the eraseblock %#08x\\n\", jeb->offset);\n\tif (!jeb->first_node) {\n\t\tprintk(JFFS2_DBG_MSG_PREFIX \" no nodes in the eraseblock %#08x\\n\", jeb->offset);\n\t\treturn;\n\t}\n\n\tprintk(JFFS2_DBG);\n\tfor (ref = jeb->first_node; ; ref = ref_next(ref)) {\n\t\tprintk(\"%#08x\", ref_offset(ref));\n#ifdef TEST_TOTLEN\n\t\tprintk(\"(%x)\", ref->__totlen);\n#endif\n\t\tif (ref_next(ref))\n\t\t\tprintk(\"->\");\n\t\telse\n\t\t\tbreak;\n\t\tif (++i == 4) {\n\t\t\ti = 0;\n\t\t\tprintk(\"\\n\" JFFS2_DBG);\n\t\t}\n\t}\n\tprintk(\"\\n\");\n}"
  },
  {
    "function_name": "jffs2_dbg_dump_node_refs(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "391-398",
    "snippet": "id\n__jffs2_dbg_dump_node_refs(struct jffs2_sb_info *c,\n\t\t\t   struct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_dump_node_refs_nolock(c, jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_unlock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_node_refs_nolock(c",
          "args": [
            "b);"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_lock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_dump_node_refs(struct jffs2_sb_info *c,\n\t\t\t   struct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_dump_node_refs_nolock(c, jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}"
  },
  {
    "function_name": "jffs2_dbg_acct_paranoia_check_nolock(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "309-384",
    "snippet": "id\n__jffs2_dbg_acct_paranoia_check_nolock(struct jffs2_sb_info *c,\n\t\t\t\t       struct jffs2_eraseblock *jeb)\n{\n\tuint32_t my_used_size = 0;\n\tuint32_t my_unchecked_size = 0;\n\tuint32_t my_dirty_size = 0;\n\tstruct jffs2_raw_node_ref *ref2 = jeb->first_node;\n\n\twhile (ref2) {\n\t\tuint32_t totlen = ref_totlen(c, jeb, ref2);\n\n\t\tif (ref_offset(ref2) < jeb->offset ||\n\t\t\t\tref_offset(ref2) > jeb->offset + c->sector_size) {\n\t\t\tJFFS2_ERROR(\"node_ref %#08x shouldn't be in block at %#08x.\\n\",\n\t\t\t\tref_offset(ref2), jeb->offset);\n\t\t\tgoto error;\n\n\t\t}\n\t\tif (ref_flags(ref2) == REF_UNCHECKED)\n\t\t\tmy_unchecked_size += totlen;\n\t\telse if (!ref_obsolete(ref2))\n\t\t\tmy_used_size += totlen;\n\t\telse\n\t\t\tmy_dirty_size += totlen;\n\n\t\tif ((!ref_next(ref2)) != (ref2 == jeb->last_node)) {\n\t\t\tJFFS2_ERROR(\"node_ref for node at %#08x (mem %p) has next at %#08x (mem %p), last_node is at %#08x (mem %p).\\n\",\n\t\t\t\t    ref_offset(ref2), ref2, ref_offset(ref_next(ref2)), ref_next(ref2),\n\t\t\t\t    ref_offset(jeb->last_node), jeb->last_node);\n\t\t\tgoto error;\n\t\t}\n\t\tref2 = ref_next(ref2);\n\t}\n\n\tif (my_used_size != jeb->used_size) {\n\t\tJFFS2_ERROR(\"Calculated used size %#08x != stored used size %#08x.\\n\",\n\t\t\tmy_used_size, jeb->used_size);\n\t\tgoto error;\n\t}\n\n\tif (my_unchecked_size != jeb->unchecked_size) {\n\t\tJFFS2_ERROR(\"Calculated unchecked size %#08x != stored unchecked size %#08x.\\n\",\n\t\t\tmy_unchecked_size, jeb->unchecked_size);\n\t\tgoto error;\n\t}\n\n#if 0\n\t/* This should work when we implement ref->__totlen elemination */\n\tif (my_dirty_size != jeb->dirty_size + jeb->wasted_size) {\n\t\tJFFS2_ERROR(\"Calculated dirty+wasted size %#08x != stored dirty + wasted size %#08x\\n\",\n\t\t\tmy_dirty_size, jeb->dirty_size + jeb->wasted_size);\n\t\tgoto error;\n\t}\n\n\tif (jeb->free_size == 0\n\t\t&& my_used_size + my_unchecked_size + my_dirty_size != c->sector_size) {\n\t\tJFFS2_ERROR(\"The sum of all nodes in block (%#x) != size of block (%#x)\\n\",\n\t\t\tmy_used_size + my_unchecked_size + my_dirty_size,\n\t\t\tc->sector_size);\n\t\tgoto error;\n\t}\n#endif\n\n\tif (!(c->flags & (JFFS2_SB_FLAG_BUILDING|JFFS2_SB_FLAG_SCANNING)))\n\t\t__jffs2_dbg_superblock_counts(c);\n\n\treturn;\n\nerror:\n\t__jffs2_dbg_dump_node_refs_nolock(c, jeb);\n\t__jffs2_dbg_dump_jeb_nolock(jeb);\n\t__jffs2_dbg_dump_block_lists_nolock(c);\n\tBUG();\n\n}\n#",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "G()",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_block_lists_nolock(c",
          "args": [
            ";"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_jeb_nolock(j",
          "args": [
            "b);"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_node_refs_nolock(c",
          "args": [
            "b);"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_superblock_counts(c",
          "args": [
            ";"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "he sum of all nodes in block (%#x) != size of block (%#x)\\n\",",
            "_used_size + my_unchecked_size + my_dirty_size,",
            ">sector_size);"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "alculated dirty+wasted size %#08x != stored dirty + wasted size %#08x\\n\",",
            "_dirty_size,",
            "b->dirty_size + jeb->wasted_size);"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "alculated unchecked size %#08x != stored unchecked size %#08x.\\n\",",
            "_unchecked_size,",
            "b->unchecked_size);"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "alculated used size %#08x != stored used size %#08x.\\n\",",
            "_used_size,",
            "b->used_size);"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_next(r",
          "args": [
            "f2);"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "ode_ref for node at %#08x (mem %p) has next at %#08x (mem %p), last_node is at %#08x (mem %p).\\n\",",
            "f_offset(ref2),",
            "f2,",
            "f_offset(ref_next(ref2)),",
            "f_next(ref2),",
            "f_offset(jeb->last_node),",
            "b->last_node);"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(j",
          "args": [
            "b->last_node),"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_next(r",
          "args": [
            "f2),"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(r",
          "args": [
            "f_next(ref2)),"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_next(r",
          "args": [
            "f2))"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(r",
          "args": [
            "f2),"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_next(r",
          "args": [
            "f2))"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_obsolete(r",
          "args": [
            "f2))"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_flags(r",
          "args": [
            "f2)"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "ode_ref %#08x shouldn't be in block at %#08x.\\n\",",
            "f_offset(ref2),",
            "b->offset);"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(r",
          "args": [
            "f2),"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(r",
          "args": [
            "f2)"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(r",
          "args": [
            "f2)"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_totlen(c",
          "args": [
            "b,",
            "f2);"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_acct_paranoia_check_nolock(struct jffs2_sb_info *c,\n\t\t\t\t       struct jffs2_eraseblock *jeb)\n{\n\tuint32_t my_used_size = 0;\n\tuint32_t my_unchecked_size = 0;\n\tuint32_t my_dirty_size = 0;\n\tstruct jffs2_raw_node_ref *ref2 = jeb->first_node;\n\n\twhile (ref2) {\n\t\tuint32_t totlen = ref_totlen(c, jeb, ref2);\n\n\t\tif (ref_offset(ref2) < jeb->offset ||\n\t\t\t\tref_offset(ref2) > jeb->offset + c->sector_size) {\n\t\t\tJFFS2_ERROR(\"node_ref %#08x shouldn't be in block at %#08x.\\n\",\n\t\t\t\tref_offset(ref2), jeb->offset);\n\t\t\tgoto error;\n\n\t\t}\n\t\tif (ref_flags(ref2) == REF_UNCHECKED)\n\t\t\tmy_unchecked_size += totlen;\n\t\telse if (!ref_obsolete(ref2))\n\t\t\tmy_used_size += totlen;\n\t\telse\n\t\t\tmy_dirty_size += totlen;\n\n\t\tif ((!ref_next(ref2)) != (ref2 == jeb->last_node)) {\n\t\t\tJFFS2_ERROR(\"node_ref for node at %#08x (mem %p) has next at %#08x (mem %p), last_node is at %#08x (mem %p).\\n\",\n\t\t\t\t    ref_offset(ref2), ref2, ref_offset(ref_next(ref2)), ref_next(ref2),\n\t\t\t\t    ref_offset(jeb->last_node), jeb->last_node);\n\t\t\tgoto error;\n\t\t}\n\t\tref2 = ref_next(ref2);\n\t}\n\n\tif (my_used_size != jeb->used_size) {\n\t\tJFFS2_ERROR(\"Calculated used size %#08x != stored used size %#08x.\\n\",\n\t\t\tmy_used_size, jeb->used_size);\n\t\tgoto error;\n\t}\n\n\tif (my_unchecked_size != jeb->unchecked_size) {\n\t\tJFFS2_ERROR(\"Calculated unchecked size %#08x != stored unchecked size %#08x.\\n\",\n\t\t\tmy_unchecked_size, jeb->unchecked_size);\n\t\tgoto error;\n\t}\n\n#if 0\n\t/* This should work when we implement ref->__totlen elemination */\n\tif (my_dirty_size != jeb->dirty_size + jeb->wasted_size) {\n\t\tJFFS2_ERROR(\"Calculated dirty+wasted size %#08x != stored dirty + wasted size %#08x\\n\",\n\t\t\tmy_dirty_size, jeb->dirty_size + jeb->wasted_size);\n\t\tgoto error;\n\t}\n\n\tif (jeb->free_size == 0\n\t\t&& my_used_size + my_unchecked_size + my_dirty_size != c->sector_size) {\n\t\tJFFS2_ERROR(\"The sum of all nodes in block (%#x) != size of block (%#x)\\n\",\n\t\t\tmy_used_size + my_unchecked_size + my_dirty_size,\n\t\t\tc->sector_size);\n\t\tgoto error;\n\t}\n#endif\n\n\tif (!(c->flags & (JFFS2_SB_FLAG_BUILDING|JFFS2_SB_FLAG_SCANNING)))\n\t\t__jffs2_dbg_superblock_counts(c);\n\n\treturn;\n\nerror:\n\t__jffs2_dbg_dump_node_refs_nolock(c, jeb);\n\t__jffs2_dbg_dump_jeb_nolock(jeb);\n\t__jffs2_dbg_dump_block_lists_nolock(c);\n\tBUG();\n\n}\n#"
  },
  {
    "function_name": "jffs2_dbg_acct_paranoia_check(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "300-307",
    "snippet": "id\n__jffs2_dbg_acct_paranoia_check(struct jffs2_sb_info *c,\n\t\t\t\tstruct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_acct_paranoia_check_nolock(c, jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_unlock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_acct_paranoia_check_nolock(c",
          "args": [
            "b);"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_lock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_acct_paranoia_check(struct jffs2_sb_info *c,\n\t\t\t\tstruct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\t__jffs2_dbg_acct_paranoia_check_nolock(c, jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}"
  },
  {
    "function_name": "jffs2_dbg_superblock_counts(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "160-295",
    "snippet": "id __jffs2_dbg_superblock_counts(struct jffs2_sb_info *c)\n{\n\tstruct jffs2_eraseblock *jeb;\n\tuint32_t free = 0, dirty = 0, used = 0, wasted = 0,\n\t\terasing = 0, bad = 0, unchecked = 0;\n\tint nr_counted = 0;\n\tint dump = 0;\n\n\tif (c->gcblock) {\n\t\tnr_counted++;\n\t\tfree += c->gcblock->free_size;\n\t\tdirty += c->gcblock->dirty_size;\n\t\tused += c->gcblock->used_size;\n\t\twasted += c->gcblock->wasted_size;\n\t\tunchecked += c->gcblock->unchecked_size;\n\t}\n\tif (c->nextblock) {\n\t\tnr_counted++;\n\t\tfree += c->nextblock->free_size;\n\t\tdirty += c->nextblock->dirty_size;\n\t\tused += c->nextblock->used_size;\n\t\twasted += c->nextblock->wasted_size;\n\t\tunchecked += c->nextblock->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->clean_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->very_dirty_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->dirty_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erasable_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erasable_pending_wbuf_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erase_pending_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->free_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->bad_used_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\n\tlist_for_each_entry(jeb, &c->erasing_list, list) {\n\t\tnr_counted++;\n\t\terasing += c->sector_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erase_checking_list, list) {\n\t\tnr_counted++;\n\t\terasing += c->sector_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erase_complete_list, list) {\n\t\tnr_counted++;\n\t\terasing += c->sector_size;\n\t}\n\tlist_for_each_entry(jeb, &c->bad_list, list) {\n\t\tnr_counted++;\n\t\tbad += c->sector_size;\n\t}\n\n#define check(sz)\t\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (sz != c->sz##_size) {\t\t\t\t\t\\\n\t\tpr_warn(\"%s_size mismatch counted 0x%x, c->%s_size 0x%x\\n\", \\\n\t\t\t#sz, sz, #sz, c->sz##_size);\t\t\t\\\n\t\tdump = 1;\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n\tcheck(free);\n\tcheck(dirty);\n\tcheck(used);\n\tcheck(wasted);\n\tcheck(unchecked);\n\tcheck(bad);\n\tcheck(erasing);\n\n#undef check\n\n\tif (nr_counted != c->nr_blocks) {\n\t\tpr_warn(\"%s counted only 0x%x blocks of 0x%x. Where are the others?\\n\",\n\t\t\t__func__, nr_counted, c->nr_blocks);\n\t\tdump = 1;\n\t}\n\n\tif (dump) {\n\t\t__jffs2_dbg_dump_block_lists_nolock(c);\n\t\tBUG();\n\t}\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "G()",
          "args": [],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_block_lists_nolock(c",
          "args": [
            ";"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_warn(\"",
          "args": [
            "s counted only 0x%x blocks of 0x%x. Where are the others?\\n\",",
            "func__,",
            "_counted,",
            ">nr_blocks);"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eck(e",
          "args": [
            "asing);"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eck(b",
          "args": [
            "d);"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eck(u",
          "args": [
            "checked);"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eck(w",
          "args": [
            "sted);"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eck(u",
          "args": [
            "ed);"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eck(d",
          "args": [
            "rty);"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eck(f",
          "args": [
            "ee);"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->bad_list,",
            "st)"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->erase_complete_list,",
            "st)"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->erase_checking_list,",
            "st)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->erasing_list,",
            "st)"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->bad_used_list,",
            "st)"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->free_list,",
            "st)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->erase_pending_list,",
            "st)"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->erasable_pending_wbuf_list,",
            "st)"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->erasable_list,",
            "st)"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->dirty_list,",
            "st)"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->very_dirty_list,",
            "st)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_for_each_entry(j",
          "args": [
            "b,",
            "->clean_list,",
            "st)"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid __jffs2_dbg_superblock_counts(struct jffs2_sb_info *c)\n{\n\tstruct jffs2_eraseblock *jeb;\n\tuint32_t free = 0, dirty = 0, used = 0, wasted = 0,\n\t\terasing = 0, bad = 0, unchecked = 0;\n\tint nr_counted = 0;\n\tint dump = 0;\n\n\tif (c->gcblock) {\n\t\tnr_counted++;\n\t\tfree += c->gcblock->free_size;\n\t\tdirty += c->gcblock->dirty_size;\n\t\tused += c->gcblock->used_size;\n\t\twasted += c->gcblock->wasted_size;\n\t\tunchecked += c->gcblock->unchecked_size;\n\t}\n\tif (c->nextblock) {\n\t\tnr_counted++;\n\t\tfree += c->nextblock->free_size;\n\t\tdirty += c->nextblock->dirty_size;\n\t\tused += c->nextblock->used_size;\n\t\twasted += c->nextblock->wasted_size;\n\t\tunchecked += c->nextblock->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->clean_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->very_dirty_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->dirty_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erasable_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erasable_pending_wbuf_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erase_pending_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->free_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\tlist_for_each_entry(jeb, &c->bad_used_list, list) {\n\t\tnr_counted++;\n\t\tfree += jeb->free_size;\n\t\tdirty += jeb->dirty_size;\n\t\tused += jeb->used_size;\n\t\twasted += jeb->wasted_size;\n\t\tunchecked += jeb->unchecked_size;\n\t}\n\n\tlist_for_each_entry(jeb, &c->erasing_list, list) {\n\t\tnr_counted++;\n\t\terasing += c->sector_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erase_checking_list, list) {\n\t\tnr_counted++;\n\t\terasing += c->sector_size;\n\t}\n\tlist_for_each_entry(jeb, &c->erase_complete_list, list) {\n\t\tnr_counted++;\n\t\terasing += c->sector_size;\n\t}\n\tlist_for_each_entry(jeb, &c->bad_list, list) {\n\t\tnr_counted++;\n\t\tbad += c->sector_size;\n\t}\n\n#define check(sz)\t\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (sz != c->sz##_size) {\t\t\t\t\t\\\n\t\tpr_warn(\"%s_size mismatch counted 0x%x, c->%s_size 0x%x\\n\", \\\n\t\t\t#sz, sz, #sz, c->sz##_size);\t\t\t\\\n\t\tdump = 1;\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n\tcheck(free);\n\tcheck(dirty);\n\tcheck(used);\n\tcheck(wasted);\n\tcheck(unchecked);\n\tcheck(bad);\n\tcheck(erasing);\n\n#undef check\n\n\tif (nr_counted != c->nr_blocks) {\n\t\tpr_warn(\"%s counted only 0x%x blocks of 0x%x. Where are the others?\\n\",\n\t\t\t__func__, nr_counted, c->nr_blocks);\n\t\tdump = 1;\n\t}\n\n\tif (dump) {\n\t\t__jffs2_dbg_dump_block_lists_nolock(c);\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "jffs2_dbg_prewrite_paranoia_check(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "124-158",
    "snippet": "id\n__jffs2_dbg_prewrite_paranoia_check(struct jffs2_sb_info *c,\n\t\t\t\t    uint32_t ofs, int len)\n{\n\tsize_t retlen;\n\tint ret, i;\n\tunsigned char *buf;\n\n\tbuf = kmalloc(len, GFP_KERNEL);\n\tif (!buf)\n\t\treturn;\n\n\tret = jffs2_flash_read(c, ofs, len, &retlen, buf);\n\tif (ret || (retlen != len)) {\n\t\tJFFS2_WARNING(\"read %d bytes failed or short. ret %d, retlen %zd.\\n\",\n\t\t\t\tlen, ret, retlen);\n\t\tkfree(buf);\n\t\treturn;\n\t}\n\n\tret = 0;\n\tfor (i = 0; i < len; i++)\n\t\tif (buf[i] != 0xff)\n\t\t\tret = 1;\n\n\tif (ret) {\n\t\tJFFS2_ERROR(\"argh, about to write node to %#08x on flash, but there are data already there. The first corrupted byte is at %#08x offset.\\n\",\n\t\t\tofs, ofs + i);\n\t\t__jffs2_dbg_dump_buffer(buf, len, ofs);\n\t\tkfree(buf);\n\t\tBUG();\n\t}\n\n\tkfree(buf);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ree(b",
          "args": [
            "f);"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G()",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree(b",
          "args": [
            "f);"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_buffer(b",
          "args": [
            "f,",
            "n,",
            "s);"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "rgh, about to write node to %#08x on flash, but there are data already there. The first corrupted byte is at %#08x offset.\\n\",",
            "s,",
            "s + i);"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree(b",
          "args": [
            "f);"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_WARNING(\"",
          "args": [
            "ead %d bytes failed or short. ret %d, retlen %zd.\\n\",",
            "n,",
            "t,",
            "tlen);"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_flash_read(c",
          "args": [
            "s,",
            "n,",
            "etlen,",
            "f);"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc(l",
          "args": [
            "n,",
            "P_KERNEL);"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_prewrite_paranoia_check(struct jffs2_sb_info *c,\n\t\t\t\t    uint32_t ofs, int len)\n{\n\tsize_t retlen;\n\tint ret, i;\n\tunsigned char *buf;\n\n\tbuf = kmalloc(len, GFP_KERNEL);\n\tif (!buf)\n\t\treturn;\n\n\tret = jffs2_flash_read(c, ofs, len, &retlen, buf);\n\tif (ret || (retlen != len)) {\n\t\tJFFS2_WARNING(\"read %d bytes failed or short. ret %d, retlen %zd.\\n\",\n\t\t\t\tlen, ret, retlen);\n\t\tkfree(buf);\n\t\treturn;\n\t}\n\n\tret = 0;\n\tfor (i = 0; i < len; i++)\n\t\tif (buf[i] != 0xff)\n\t\t\tret = 1;\n\n\tif (ret) {\n\t\tJFFS2_ERROR(\"argh, about to write node to %#08x on flash, but there are data already there. The first corrupted byte is at %#08x offset.\\n\",\n\t\t\tofs, ofs + i);\n\t\t__jffs2_dbg_dump_buffer(buf, len, ofs);\n\t\tkfree(buf);\n\t\tBUG();\n\t}\n\n\tkfree(buf);\n}"
  },
  {
    "function_name": "jffs2_dbg_fragtree_paranoia_check_nolock(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "74-119",
    "snippet": "id\n__jffs2_dbg_fragtree_paranoia_check_nolock(struct jffs2_inode_info *f)\n{\n\tstruct jffs2_node_frag *frag;\n\tint bitched = 0;\n\n\tfor (frag = frag_first(&f->fragtree); frag; frag = frag_next(frag)) {\n\t\tstruct jffs2_full_dnode *fn = frag->node;\n\n\t\tif (!fn || !fn->raw)\n\t\t\tcontinue;\n\n\t\tif (ref_flags(fn->raw) == REF_PRISTINE) {\n\t\t\tif (fn->frags > 1) {\n\t\t\t\tJFFS2_ERROR(\"REF_PRISTINE node at 0x%08x had %d frags. Tell dwmw2.\\n\",\n\t\t\t\t\tref_offset(fn->raw), fn->frags);\n\t\t\t\tbitched = 1;\n\t\t\t}\n\n\t\t\t/* A hole node which isn't multi-page should be garbage-collected\n\t\t\t   and merged anyway, so we just check for the frag size here,\n\t\t\t   rather than mucking around with actually reading the node\n\t\t\t   and checking the compression type, which is the real way\n\t\t\t   to tell a hole node. */\n\t\t\tif (frag->ofs & (PAGE_CACHE_SIZE-1) && frag_prev(frag)\n\t\t\t\t\t&& frag_prev(frag)->size < PAGE_CACHE_SIZE && frag_prev(frag)->node) {\n\t\t\t\tJFFS2_ERROR(\"REF_PRISTINE node at 0x%08x had a previous non-hole frag in the same page. Tell dwmw2.\\n\",\n\t\t\t\t\tref_offset(fn->raw));\n\t\t\t\tbitched = 1;\n\t\t\t}\n\n\t\t\tif ((frag->ofs+frag->size) & (PAGE_CACHE_SIZE-1) && frag_next(frag)\n\t\t\t\t\t&& frag_next(frag)->size < PAGE_CACHE_SIZE && frag_next(frag)->node) {\n\t\t\t\tJFFS2_ERROR(\"REF_PRISTINE node at 0x%08x (%08x-%08x) had a following non-hole frag in the same page. Tell dwmw2.\\n\",\n\t\t\t\t       ref_offset(fn->raw), frag->ofs, frag->ofs+frag->size);\n\t\t\t\tbitched = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (bitched) {\n\t\tJFFS2_ERROR(\"fragtree is corrupted.\\n\");\n\t\t__jffs2_dbg_dump_fragtree_nolock(f);\n\t\tBUG();\n\t}\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "G()",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_dump_fragtree_nolock(f",
          "args": [
            ";"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "ragtree is corrupted.\\n\");"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "EF_PRISTINE node at 0x%08x (%08x-%08x) had a following non-hole frag in the same page. Tell dwmw2.\\n\",",
            "f_offset(fn->raw),",
            "ag->ofs,",
            "ag->ofs+frag->size);"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(f",
          "args": [
            "->raw),"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_next(f",
          "args": [
            "ag)-"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_next(f",
          "args": [
            "ag)-"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_next(f",
          "args": [
            "ag)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "EF_PRISTINE node at 0x%08x had a previous non-hole frag in the same page. Tell dwmw2.\\n\",",
            "f_offset(fn->raw));"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(f",
          "args": [
            "->raw))"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_prev(f",
          "args": [
            "ag)-"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_prev(f",
          "args": [
            "ag)-"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_prev(f",
          "args": [
            "ag)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "EF_PRISTINE node at 0x%08x had %d frags. Tell dwmw2.\\n\",",
            "f_offset(fn->raw),",
            "->frags);"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_offset(f",
          "args": [
            "->raw),"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f_flags(f",
          "args": [
            "->raw)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_next(f",
          "args": [
            "ag))"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ag_first(&",
          "args": [
            "->fragtree);"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_fragtree_paranoia_check_nolock(struct jffs2_inode_info *f)\n{\n\tstruct jffs2_node_frag *frag;\n\tint bitched = 0;\n\n\tfor (frag = frag_first(&f->fragtree); frag; frag = frag_next(frag)) {\n\t\tstruct jffs2_full_dnode *fn = frag->node;\n\n\t\tif (!fn || !fn->raw)\n\t\t\tcontinue;\n\n\t\tif (ref_flags(fn->raw) == REF_PRISTINE) {\n\t\t\tif (fn->frags > 1) {\n\t\t\t\tJFFS2_ERROR(\"REF_PRISTINE node at 0x%08x had %d frags. Tell dwmw2.\\n\",\n\t\t\t\t\tref_offset(fn->raw), fn->frags);\n\t\t\t\tbitched = 1;\n\t\t\t}\n\n\t\t\t/* A hole node which isn't multi-page should be garbage-collected\n\t\t\t   and merged anyway, so we just check for the frag size here,\n\t\t\t   rather than mucking around with actually reading the node\n\t\t\t   and checking the compression type, which is the real way\n\t\t\t   to tell a hole node. */\n\t\t\tif (frag->ofs & (PAGE_CACHE_SIZE-1) && frag_prev(frag)\n\t\t\t\t\t&& frag_prev(frag)->size < PAGE_CACHE_SIZE && frag_prev(frag)->node) {\n\t\t\t\tJFFS2_ERROR(\"REF_PRISTINE node at 0x%08x had a previous non-hole frag in the same page. Tell dwmw2.\\n\",\n\t\t\t\t\tref_offset(fn->raw));\n\t\t\t\tbitched = 1;\n\t\t\t}\n\n\t\t\tif ((frag->ofs+frag->size) & (PAGE_CACHE_SIZE-1) && frag_next(frag)\n\t\t\t\t\t&& frag_next(frag)->size < PAGE_CACHE_SIZE && frag_next(frag)->node) {\n\t\t\t\tJFFS2_ERROR(\"REF_PRISTINE node at 0x%08x (%08x-%08x) had a following non-hole frag in the same page. Tell dwmw2.\\n\",\n\t\t\t\t       ref_offset(fn->raw), frag->ofs, frag->ofs+frag->size);\n\t\t\t\tbitched = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (bitched) {\n\t\tJFFS2_ERROR(\"fragtree is corrupted.\\n\");\n\t\t__jffs2_dbg_dump_fragtree_nolock(f);\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "jffs2_dbg_fragtree_paranoia_check(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "66-72",
    "snippet": "id\n__jffs2_dbg_fragtree_paranoia_check(struct jffs2_inode_info *f)\n{\n\tmutex_lock(&f->sem);\n\t__jffs2_dbg_fragtree_paranoia_check_nolock(f);\n\tmutex_unlock(&f->sem);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tex_unlock(&",
          "args": [
            "->sem);"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jffs2_dbg_fragtree_paranoia_check_nolock(f",
          "args": [
            ";"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tex_lock(&",
          "args": [
            "->sem);"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_fragtree_paranoia_check(struct jffs2_inode_info *f)\n{\n\tmutex_lock(&f->sem);\n\t__jffs2_dbg_fragtree_paranoia_check_nolock(f);\n\tmutex_unlock(&f->sem);\n}"
  },
  {
    "function_name": "jffs2_dbg_acct_sanity_check(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "51-58",
    "snippet": "id\n__jffs2_dbg_acct_sanity_check(struct jffs2_sb_info *c,\n\t\t\t      struct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\tjffs2_dbg_acct_sanity_check_nolock(c, jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_unlock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_dbg_acct_sanity_check_nolock(c",
          "args": [
            "b);"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_lock(&",
          "args": [
            "->erase_completion_lock);"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_acct_sanity_check(struct jffs2_sb_info *c,\n\t\t\t      struct jffs2_eraseblock *jeb)\n{\n\tspin_lock(&c->erase_completion_lock);\n\tjffs2_dbg_acct_sanity_check_nolock(c, jeb);\n\tspin_unlock(&c->erase_completion_lock);\n}"
  },
  {
    "function_name": "jffs2_dbg_acct_sanity_check_nolock(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/debug.c",
    "lines": "27-49",
    "snippet": "id\n__jffs2_dbg_acct_sanity_check_nolock(struct jffs2_sb_info *c,\n\t\t\t\t     struct jffs2_eraseblock *jeb)\n{\n\tif (unlikely(jeb && jeb->used_size + jeb->dirty_size +\n\t\t\tjeb->free_size + jeb->wasted_size +\n\t\t\tjeb->unchecked_size != c->sector_size)) {\n\t\tJFFS2_ERROR(\"eeep, space accounting for block at 0x%08x is screwed.\\n\", jeb->offset);\n\t\tJFFS2_ERROR(\"free %#08x + dirty %#08x + used %#08x + wasted %#08x + unchecked %#08x != total %#08x.\\n\",\n\t\t\tjeb->free_size, jeb->dirty_size, jeb->used_size,\n\t\t\tjeb->wasted_size, jeb->unchecked_size, c->sector_size);\n\t\tBUG();\n\t}\n\n\tif (unlikely(c->used_size + c->dirty_size + c->free_size + c->erasing_size + c->bad_size\n\t\t\t\t+ c->wasted_size + c->unchecked_size != c->flash_size)) {\n\t\tJFFS2_ERROR(\"eeep, space accounting superblock info is screwed.\\n\");\n\t\tJFFS2_ERROR(\"free %#08x + dirty %#08x + used %#08x + erasing %#08x + bad %#08x + wasted %#08x + unchecked %#08x != total %#08x.\\n\",\n\t\t\tc->free_size, c->dirty_size, c->used_size, c->erasing_size, c->bad_size,\n\t\t\tc->wasted_size, c->unchecked_size, c->flash_size);\n\t\tBUG();\n\t}\n}",
    "includes": [
      "nclude \"debug.h\"\n\n#",
      "nclude \"nodelist.h\"\n#i",
      "nclude <linux/slab.h>\n#i",
      "nclude <linux/mtd/mtd.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/crc32.h>\n#i",
      "nclude <linux/pagemap.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "G()",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "ree %#08x + dirty %#08x + used %#08x + erasing %#08x + bad %#08x + wasted %#08x + unchecked %#08x != total %#08x.\\n\",",
            ">free_size,",
            ">dirty_size,",
            ">used_size,",
            ">erasing_size,",
            ">bad_size,",
            ">wasted_size,",
            ">unchecked_size,",
            ">flash_size);"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "eep, space accounting superblock info is screwed.\\n\");"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely(c",
          "args": [
            ">used_size + c->dirty_size + c->free_size + c->erasing_size + c->bad_size\n\t\t\t\t+ c->wasted_size + c->unchecked_size != c->flash_size))"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G()",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "ree %#08x + dirty %#08x + used %#08x + wasted %#08x + unchecked %#08x != total %#08x.\\n\",",
            "b->free_size,",
            "b->dirty_size,",
            "b->used_size,",
            "b->wasted_size,",
            "b->unchecked_size,",
            ">sector_size);"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FS2_ERROR(\"",
          "args": [
            "eep, space accounting for block at 0x%08x is screwed.\\n\",",
            "b->offset);"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely(j",
          "args": [
            "b && jeb->used_size + jeb->dirty_size +\n\t\t\tjeb->free_size + jeb->wasted_size +\n\t\t\tjeb->unchecked_size != c->sector_size))"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"debug.h\"\n\n#\nnclude \"nodelist.h\"\n#i\nnclude <linux/slab.h>\n#i\nnclude <linux/mtd/mtd.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/crc32.h>\n#i\nnclude <linux/pagemap.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\nid\n__jffs2_dbg_acct_sanity_check_nolock(struct jffs2_sb_info *c,\n\t\t\t\t     struct jffs2_eraseblock *jeb)\n{\n\tif (unlikely(jeb && jeb->used_size + jeb->dirty_size +\n\t\t\tjeb->free_size + jeb->wasted_size +\n\t\t\tjeb->unchecked_size != c->sector_size)) {\n\t\tJFFS2_ERROR(\"eeep, space accounting for block at 0x%08x is screwed.\\n\", jeb->offset);\n\t\tJFFS2_ERROR(\"free %#08x + dirty %#08x + used %#08x + wasted %#08x + unchecked %#08x != total %#08x.\\n\",\n\t\t\tjeb->free_size, jeb->dirty_size, jeb->used_size,\n\t\t\tjeb->wasted_size, jeb->unchecked_size, c->sector_size);\n\t\tBUG();\n\t}\n\n\tif (unlikely(c->used_size + c->dirty_size + c->free_size + c->erasing_size + c->bad_size\n\t\t\t\t+ c->wasted_size + c->unchecked_size != c->flash_size)) {\n\t\tJFFS2_ERROR(\"eeep, space accounting superblock info is screwed.\\n\");\n\t\tJFFS2_ERROR(\"free %#08x + dirty %#08x + used %#08x + erasing %#08x + bad %#08x + wasted %#08x + unchecked %#08x != total %#08x.\\n\",\n\t\t\tc->free_size, c->dirty_size, c->used_size, c->erasing_size, c->bad_size,\n\t\t\tc->wasted_size, c->unchecked_size, c->flash_size);\n\t\tBUG();\n\t}\n}"
  }
]