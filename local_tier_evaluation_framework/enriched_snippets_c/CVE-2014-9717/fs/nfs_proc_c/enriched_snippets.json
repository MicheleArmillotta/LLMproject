[
  {
    "function_name": "nfs_return_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "673-677",
    "snippet": "static int nfs_return_delegation(struct inode *inode)\n{\n\tnfs_wb_all(inode);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_wb_all",
          "args": [
            "inode"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wb_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1841-1857",
          "snippet": "int nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int nfs_return_delegation(struct inode *inode)\n{\n\tnfs_wb_all(inode);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_have_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "668-671",
    "snippet": "static int nfs_have_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int nfs_have_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_lock_check_bounds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "646-666",
    "snippet": "static int nfs_lock_check_bounds(const struct file_lock *fl)\n{\n\t__s32 start, end;\n\n\tstart = (__s32)fl->fl_start;\n\tif ((loff_t)start != fl->fl_start)\n\t\tgoto out_einval;\n\n\tif (fl->fl_end != OFFSET_MAX) {\n\t\tend = (__s32)fl->fl_end;\n\t\tif ((loff_t)end != fl->fl_end)\n\t\t\tgoto out_einval;\n\t} else\n\t\tend = NFS_LOCK32_OFFSET_MAX;\n\n\tif (start < 0 || start > end)\n\t\tgoto out_einval;\n\treturn 0;\nout_einval:\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NFS_LOCK32_OFFSET_MAX ((__s32)0x7fffffffUL)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\n#define NFS_LOCK32_OFFSET_MAX ((__s32)0x7fffffffUL)\n\nstatic int nfs_lock_check_bounds(const struct file_lock *fl)\n{\n\t__s32 start, end;\n\n\tstart = (__s32)fl->fl_start;\n\tif ((loff_t)start != fl->fl_start)\n\t\tgoto out_einval;\n\n\tif (fl->fl_end != OFFSET_MAX) {\n\t\tend = (__s32)fl->fl_end;\n\t\tif ((loff_t)end != fl->fl_end)\n\t\t\tgoto out_einval;\n\t} else\n\t\tend = NFS_LOCK32_OFFSET_MAX;\n\n\tif (start < 0 || start > end)\n\t\tgoto out_einval;\n\treturn 0;\nout_einval:\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "nfs_proc_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "636-642",
    "snippet": "static int\nnfs_proc_lock(struct file *filp, int cmd, struct file_lock *fl)\n{\n\tstruct inode *inode = file_inode(filp);\n\n\treturn nlmclnt_proc(NFS_SERVER(inode)->nlm_host, cmd, fl);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nlmclnt_proc",
          "args": [
            "NFS_SERVER(inode)->nlm_host",
            "cmd",
            "fl"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "nlmclnt_proc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clntproc.c",
          "lines": "155-188",
          "snippet": "int nlmclnt_proc(struct nlm_host *host, int cmd, struct file_lock *fl)\n{\n\tstruct nlm_rqst\t\t*call;\n\tint\t\t\tstatus;\n\n\tcall = nlm_alloc_call(host);\n\tif (call == NULL)\n\t\treturn -ENOMEM;\n\n\tnlmclnt_locks_init_private(fl, host);\n\tif (!fl->fl_u.nfs_fl.owner) {\n\t\t/* lockowner allocation has failed */\n\t\tnlmclnt_release_call(call);\n\t\treturn -ENOMEM;\n\t}\n\t/* Set up the argument struct */\n\tnlmclnt_setlockargs(call, fl);\n\n\tif (IS_SETLK(cmd) || IS_SETLKW(cmd)) {\n\t\tif (fl->fl_type != F_UNLCK) {\n\t\t\tcall->a_args.block = IS_SETLKW(cmd) ? 1 : 0;\n\t\t\tstatus = nlmclnt_lock(call, fl);\n\t\t} else\n\t\t\tstatus = nlmclnt_unlock(call, fl);\n\t} else if (IS_GETLK(cmd))\n\t\tstatus = nlmclnt_test(call, fl);\n\telse\n\t\tstatus = -EINVAL;\n\tfl->fl_ops->fl_release_private(fl);\n\tfl->fl_ops = NULL;\n\n\tdprintk(\"lockd: clnt proc returns %d\\n\", status);\n\treturn status;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tnlmclnt_test(struct nlm_rqst *, struct file_lock *);",
            "static int\tnlmclnt_lock(struct nlm_rqst *, struct file_lock *);",
            "static int\tnlmclnt_unlock(struct nlm_rqst *, struct file_lock *);",
            "static void\tnlmclnt_locks_init_private(struct file_lock *fl, struct nlm_host *host);",
            "static int\tnlmclnt_cancel(struct nlm_host *, int , struct file_lock *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstatic int\tnlmclnt_test(struct nlm_rqst *, struct file_lock *);\nstatic int\tnlmclnt_lock(struct nlm_rqst *, struct file_lock *);\nstatic int\tnlmclnt_unlock(struct nlm_rqst *, struct file_lock *);\nstatic void\tnlmclnt_locks_init_private(struct file_lock *fl, struct nlm_host *host);\nstatic int\tnlmclnt_cancel(struct nlm_host *, int , struct file_lock *);\n\nint nlmclnt_proc(struct nlm_host *host, int cmd, struct file_lock *fl)\n{\n\tstruct nlm_rqst\t\t*call;\n\tint\t\t\tstatus;\n\n\tcall = nlm_alloc_call(host);\n\tif (call == NULL)\n\t\treturn -ENOMEM;\n\n\tnlmclnt_locks_init_private(fl, host);\n\tif (!fl->fl_u.nfs_fl.owner) {\n\t\t/* lockowner allocation has failed */\n\t\tnlmclnt_release_call(call);\n\t\treturn -ENOMEM;\n\t}\n\t/* Set up the argument struct */\n\tnlmclnt_setlockargs(call, fl);\n\n\tif (IS_SETLK(cmd) || IS_SETLKW(cmd)) {\n\t\tif (fl->fl_type != F_UNLCK) {\n\t\t\tcall->a_args.block = IS_SETLKW(cmd) ? 1 : 0;\n\t\t\tstatus = nlmclnt_lock(call, fl);\n\t\t} else\n\t\t\tstatus = nlmclnt_unlock(call, fl);\n\t} else if (IS_GETLK(cmd))\n\t\tstatus = nlmclnt_test(call, fl);\n\telse\n\t\tstatus = -EINVAL;\n\tfl->fl_ops->fl_release_private(fl);\n\tfl->fl_ops = NULL;\n\n\tdprintk(\"lockd: clnt proc returns %d\\n\", status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "filp"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_init_file_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fuse/file.c",
          "lines": "3009-3013",
          "snippet": "void fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}",
          "includes": [
            "#include <linux/falloc.h>",
            "#include <linux/aio.h>",
            "#include <linux/swap.h>",
            "#include <linux/compat.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include \"fuse_i.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};",
            "static const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/falloc.h>\n#include <linux/aio.h>\n#include <linux/swap.h>\n#include <linux/compat.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include \"fuse_i.h\"\n\nstatic const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};\nstatic const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};\n\nvoid fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_lock(struct file *filp, int cmd, struct file_lock *fl)\n{\n\tstruct inode *inode = file_inode(filp);\n\n\treturn nlmclnt_proc(NFS_SERVER(inode)->nlm_host, cmd, fl);\n}"
  },
  {
    "function_name": "nfs_proc_commit_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "630-634",
    "snippet": "static void\nnfs_proc_commit_setup(struct nfs_commit_data *data, struct rpc_message *msg)\n{\n\tBUG();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void\nnfs_proc_commit_setup(struct nfs_commit_data *data, struct rpc_message *msg)\n{\n\tBUG();\n}"
  },
  {
    "function_name": "nfs_proc_commit_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "625-628",
    "snippet": "static void nfs_proc_commit_rpc_prepare(struct rpc_task *task, struct nfs_commit_data *data)\n{\n\tBUG();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_proc_commit_rpc_prepare(struct rpc_task *task, struct nfs_commit_data *data)\n{\n\tBUG();\n}"
  },
  {
    "function_name": "nfs_proc_write_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "617-623",
    "snippet": "static void nfs_proc_write_setup(struct nfs_pgio_header *hdr,\n\t\t\t\t struct rpc_message *msg)\n{\n\t/* Note: NFSv2 ignores @stable and always uses NFS_FILE_SYNC */\n\thdr->args.stable = NFS_FILE_SYNC;\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_WRITE];\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_proc_write_setup(struct nfs_pgio_header *hdr,\n\t\t\t\t struct rpc_message *msg)\n{\n\t/* Note: NFSv2 ignores @stable and always uses NFS_FILE_SYNC */\n\thdr->args.stable = NFS_FILE_SYNC;\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_WRITE];\n}"
  },
  {
    "function_name": "nfs_write_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "610-615",
    "snippet": "static int nfs_write_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tif (task->tk_status >= 0)\n\t\tnfs_writeback_update_inode(hdr);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_writeback_update_inode",
          "args": [
            "hdr"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_writeback_update_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1396-1407",
          "snippet": "void nfs_writeback_update_inode(struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_fattr *fattr = hdr->res.fattr;\n\tstruct inode *inode = hdr->inode;\n\n\tif (fattr == NULL)\n\t\treturn;\n\tspin_lock(&inode->i_lock);\n\tnfs_writeback_check_extend(hdr, fattr);\n\tnfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nvoid nfs_writeback_update_inode(struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_fattr *fattr = hdr->res.fattr;\n\tstruct inode *inode = hdr->inode;\n\n\tif (fattr == NULL)\n\t\treturn;\n\tspin_lock(&inode->i_lock);\n\tnfs_writeback_check_extend(hdr, fattr);\n\tnfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int nfs_write_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tif (task->tk_status >= 0)\n\t\tnfs_writeback_update_inode(hdr);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_proc_pgio_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "603-608",
    "snippet": "static int nfs_proc_pgio_rpc_prepare(struct rpc_task *task,\n\t\t\t\t     struct nfs_pgio_header *hdr)\n{\n\trpc_call_start(task);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_call_start",
          "args": [
            "task"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int nfs_proc_pgio_rpc_prepare(struct rpc_task *task,\n\t\t\t\t     struct nfs_pgio_header *hdr)\n{\n\trpc_call_start(task);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_proc_read_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "597-601",
    "snippet": "static void nfs_proc_read_setup(struct nfs_pgio_header *hdr,\n\t\t\t\tstruct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_READ];\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_proc_read_setup(struct nfs_pgio_header *hdr,\n\t\t\t\tstruct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_READ];\n}"
  },
  {
    "function_name": "nfs_read_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "581-595",
    "snippet": "static int nfs_read_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tstruct inode *inode = hdr->inode;\n\n\tnfs_invalidate_atime(inode);\n\tif (task->tk_status >= 0) {\n\t\tnfs_refresh_inode(inode, hdr->res.fattr);\n\t\t/* Emulate the eof flag, which isn't normally needed in NFSv2\n\t\t * as it is guaranteed to always return the file attributes\n\t\t */\n\t\tif (hdr->args.offset + hdr->res.count >= hdr->res.fattr->size)\n\t\t\thdr->res.eof = 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "inode",
            "hdr->res.fattr"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_invalidate_atime",
          "args": [
            "inode"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_invalidate_atime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "219-224",
          "snippet": "void nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int nfs_read_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tstruct inode *inode = hdr->inode;\n\n\tnfs_invalidate_atime(inode);\n\tif (task->tk_status >= 0) {\n\t\tnfs_refresh_inode(inode, hdr->res.fattr);\n\t\t/* Emulate the eof flag, which isn't normally needed in NFSv2\n\t\t * as it is guaranteed to always return the file attributes\n\t\t */\n\t\tif (hdr->args.offset + hdr->res.count >= hdr->res.fattr->size)\n\t\t\thdr->res.eof = 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_proc_pathconf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "572-579",
    "snippet": "static int\nnfs_proc_pathconf(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t  struct nfs_pathconf *info)\n{\n\tinfo->max_link = 0;\n\tinfo->max_namelen = NFS2_MAXNAMLEN;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_pathconf(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t  struct nfs_pathconf *info)\n{\n\tinfo->max_link = 0;\n\tinfo->max_namelen = NFS2_MAXNAMLEN;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_proc_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "541-570",
    "snippet": "static int\nnfs_proc_fsinfo(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t\tstruct nfs_fsinfo *info)\n{\n\tstruct nfs2_fsstat fsinfo;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_STATFS],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= &fsinfo,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsinfo\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply fsinfo: %d\\n\", status);\n\tif (status)\n\t\tgoto out;\n\tinfo->rtmax  = NFS_MAXDATA;\n\tinfo->rtpref = fsinfo.tsize;\n\tinfo->rtmult = fsinfo.bsize;\n\tinfo->wtmax  = NFS_MAXDATA;\n\tinfo->wtpref = fsinfo.tsize;\n\tinfo->wtmult = fsinfo.bsize;\n\tinfo->dtpref = fsinfo.tsize;\n\tinfo->maxfilesize = 0x7FFFFFFF;\n\tinfo->lease_time = 0;\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply fsinfo: %d\\n\"",
            "status"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "info->fattr"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  fsinfo\\n\""
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_fsinfo(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t\tstruct nfs_fsinfo *info)\n{\n\tstruct nfs2_fsstat fsinfo;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_STATFS],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= &fsinfo,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsinfo\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply fsinfo: %d\\n\", status);\n\tif (status)\n\t\tgoto out;\n\tinfo->rtmax  = NFS_MAXDATA;\n\tinfo->rtpref = fsinfo.tsize;\n\tinfo->rtmult = fsinfo.bsize;\n\tinfo->wtmax  = NFS_MAXDATA;\n\tinfo->wtpref = fsinfo.tsize;\n\tinfo->wtmult = fsinfo.bsize;\n\tinfo->dtpref = fsinfo.tsize;\n\tinfo->maxfilesize = 0x7FFFFFFF;\n\tinfo->lease_time = 0;\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "513-539",
    "snippet": "static int\nnfs_proc_statfs(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t\tstruct nfs_fsstat *stat)\n{\n\tstruct nfs2_fsstat fsinfo;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_STATFS],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= &fsinfo,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  statfs\\n\");\n\tnfs_fattr_init(stat->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply statfs: %d\\n\", status);\n\tif (status)\n\t\tgoto out;\n\tstat->tbytes = (u64)fsinfo.blocks * fsinfo.bsize;\n\tstat->fbytes = (u64)fsinfo.bfree  * fsinfo.bsize;\n\tstat->abytes = (u64)fsinfo.bavail * fsinfo.bsize;\n\tstat->tfiles = 0;\n\tstat->ffiles = 0;\n\tstat->afiles = 0;\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply statfs: %d\\n\"",
            "status"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "stat->fattr"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  statfs\\n\""
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_statfs(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t\tstruct nfs_fsstat *stat)\n{\n\tstruct nfs2_fsstat fsinfo;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_STATFS],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= &fsinfo,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  statfs\\n\");\n\tnfs_fattr_init(stat->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply statfs: %d\\n\", status);\n\tif (status)\n\t\tgoto out;\n\tstat->tbytes = (u64)fsinfo.blocks * fsinfo.bsize;\n\tstat->fbytes = (u64)fsinfo.bfree  * fsinfo.bsize;\n\tstat->abytes = (u64)fsinfo.bavail * fsinfo.bsize;\n\tstat->tfiles = 0;\n\tstat->ffiles = 0;\n\tstat->afiles = 0;\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "486-511",
    "snippet": "static int\nnfs_proc_readdir(struct dentry *dentry, struct rpc_cred *cred,\n\t\t u64 cookie, struct page **pages, unsigned int count, int plus)\n{\n\tstruct inode\t\t*dir = dentry->d_inode;\n\tstruct nfs_readdirargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.cookie\t\t= cookie,\n\t\t.count\t\t= count,\n\t\t.pages\t\t= pages,\n\t};\n\tstruct rpc_message\tmsg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_READDIR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_cred\t= cred,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  readdir %d\\n\", (unsigned int)cookie);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\n\tnfs_invalidate_atime(dir);\n\n\tdprintk(\"NFS reply readdir: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply readdir: %d\\n\"",
            "status"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_invalidate_atime",
          "args": [
            "dir"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_invalidate_atime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "219-224",
          "snippet": "void nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  readdir %d\\n\"",
            "(unsigned int)cookie"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_readdir(struct dentry *dentry, struct rpc_cred *cred,\n\t\t u64 cookie, struct page **pages, unsigned int count, int plus)\n{\n\tstruct inode\t\t*dir = dentry->d_inode;\n\tstruct nfs_readdirargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.cookie\t\t= cookie,\n\t\t.count\t\t= count,\n\t\t.pages\t\t= pages,\n\t};\n\tstruct rpc_message\tmsg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_READDIR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_cred\t= cred,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  readdir %d\\n\", (unsigned int)cookie);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\n\tnfs_invalidate_atime(dir);\n\n\tdprintk(\"NFS reply readdir: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_rmdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "458-477",
    "snippet": "static int\nnfs_proc_rmdir(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_RMDIR],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  rmdir %s\\n\", name->name);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\tdprintk(\"NFS reply rmdir: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply rmdir: %d\\n\"",
            "status"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  rmdir %s\\n\"",
            "name->name"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_rmdir(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_RMDIR],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  rmdir %s\\n\", name->name);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\tdprintk(\"NFS reply rmdir: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_mkdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "432-456",
    "snippet": "static int\nnfs_proc_mkdir(struct inode *dir, struct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_MKDIR],\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mkdir %pd\\n\", dentry);\n\tdata = nfs_alloc_createdata(dir, dentry, sattr);\n\tif (data == NULL)\n\t\tgoto out;\n\tmsg.rpc_argp = &data->arg;\n\tmsg.rpc_resp = &data->res;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\tnfs_free_createdata(data);\nout:\n\tdprintk(\"NFS reply mkdir: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply mkdir: %d\\n\"",
            "status"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_createdata",
          "args": [
            "data"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
          "lines": "223-226",
          "snippet": "static void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_instantiate",
          "args": [
            "dentry",
            "data->res.fh",
            "data->res.fattr",
            "NULL"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "1641-1679",
          "snippet": "int nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nint nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_createdata",
          "args": [
            "dir",
            "dentry",
            "sattr"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
          "lines": "203-221",
          "snippet": "static struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  mkdir %pd\\n\"",
            "dentry"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_mkdir(struct inode *dir, struct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_MKDIR],\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mkdir %pd\\n\", dentry);\n\tdata = nfs_alloc_createdata(dir, dentry, sattr);\n\tif (data == NULL)\n\t\tgoto out;\n\tmsg.rpc_argp = &data->arg;\n\tmsg.rpc_resp = &data->res;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\tnfs_free_createdata(data);\nout:\n\tdprintk(\"NFS reply mkdir: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "382-430",
    "snippet": "static int\nnfs_proc_symlink(struct inode *dir, struct dentry *dentry, struct page *page,\n\t\t unsigned int len, struct iattr *sattr)\n{\n\tstruct nfs_fh *fh;\n\tstruct nfs_fattr *fattr;\n\tstruct nfs_symlinkargs\targ = {\n\t\t.fromfh\t\t= NFS_FH(dir),\n\t\t.fromname\t= dentry->d_name.name,\n\t\t.fromlen\t= dentry->d_name.len,\n\t\t.pages\t\t= &page,\n\t\t.pathlen\t= len,\n\t\t.sattr\t\t= sattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_SYMLINK],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint status = -ENAMETOOLONG;\n\n\tdprintk(\"NFS call  symlink %pd\\n\", dentry);\n\n\tif (len > NFS2_MAXPATHLEN)\n\t\tgoto out;\n\n\tfh = nfs_alloc_fhandle();\n\tfattr = nfs_alloc_fattr();\n\tstatus = -ENOMEM;\n\tif (fh == NULL || fattr == NULL)\n\t\tgoto out_free;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\n\t/*\n\t * V2 SYMLINK requests don't return any attributes.  Setting the\n\t * filehandle size to zero indicates to nfs_instantiate that it\n\t * should fill in the data with a LOOKUP call on the wire.\n\t */\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, fh, fattr, NULL);\n\nout_free:\n\tnfs_free_fattr(fattr);\n\tnfs_free_fhandle(fh);\nout:\n\tdprintk(\"NFS reply symlink: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply symlink: %d\\n\"",
            "status"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fhandle",
          "args": [
            "fh"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_instantiate",
          "args": [
            "dentry",
            "fh",
            "fattr",
            "NULL"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "1641-1679",
          "snippet": "int nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nint nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fhandle",
          "args": [],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1323-1331",
          "snippet": "struct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  symlink %pd\\n\"",
            "dentry"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_symlink(struct inode *dir, struct dentry *dentry, struct page *page,\n\t\t unsigned int len, struct iattr *sattr)\n{\n\tstruct nfs_fh *fh;\n\tstruct nfs_fattr *fattr;\n\tstruct nfs_symlinkargs\targ = {\n\t\t.fromfh\t\t= NFS_FH(dir),\n\t\t.fromname\t= dentry->d_name.name,\n\t\t.fromlen\t= dentry->d_name.len,\n\t\t.pages\t\t= &page,\n\t\t.pathlen\t= len,\n\t\t.sattr\t\t= sattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_SYMLINK],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint status = -ENAMETOOLONG;\n\n\tdprintk(\"NFS call  symlink %pd\\n\", dentry);\n\n\tif (len > NFS2_MAXPATHLEN)\n\t\tgoto out;\n\n\tfh = nfs_alloc_fhandle();\n\tfattr = nfs_alloc_fattr();\n\tstatus = -ENOMEM;\n\tif (fh == NULL || fattr == NULL)\n\t\tgoto out_free;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\n\t/*\n\t * V2 SYMLINK requests don't return any attributes.  Setting the\n\t * filehandle size to zero indicates to nfs_instantiate that it\n\t * should fill in the data with a LOOKUP call on the wire.\n\t */\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, fh, fattr, NULL);\n\nout_free:\n\tnfs_free_fattr(fattr);\n\tnfs_free_fhandle(fh);\nout:\n\tdprintk(\"NFS reply symlink: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "359-380",
    "snippet": "static int\nnfs_proc_link(struct inode *inode, struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_linkargs\targ = {\n\t\t.fromfh\t\t= NFS_FH(inode),\n\t\t.tofh\t\t= NFS_FH(dir),\n\t\t.toname\t\t= name->name,\n\t\t.tolen\t\t= name->len\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_LINK],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  link %s\\n\", name->name);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_mark_for_revalidate(inode);\n\tnfs_mark_for_revalidate(dir);\n\tdprintk(\"NFS reply link: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply link: %d\\n\"",
            "status"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "inode"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(inode)",
            "&msg",
            "0"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "inode"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  link %s\\n\"",
            "name->name"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_link(struct inode *inode, struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_linkargs\targ = {\n\t\t.fromfh\t\t= NFS_FH(inode),\n\t\t.tofh\t\t= NFS_FH(dir),\n\t\t.toname\t\t= name->name,\n\t\t.tolen\t\t= name->len\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_LINK],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  link %s\\n\", name->name);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_mark_for_revalidate(inode);\n\tnfs_mark_for_revalidate(dir);\n\tdprintk(\"NFS reply link: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_rename_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "350-357",
    "snippet": "static int\nnfs_proc_rename_done(struct rpc_task *task, struct inode *old_dir,\n\t\t     struct inode *new_dir)\n{\n\tnfs_mark_for_revalidate(old_dir);\n\tnfs_mark_for_revalidate(new_dir);\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "new_dir"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "old_dir"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_rename_done(struct rpc_task *task, struct inode *old_dir,\n\t\t     struct inode *new_dir)\n{\n\tnfs_mark_for_revalidate(old_dir);\n\tnfs_mark_for_revalidate(new_dir);\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_proc_rename_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "345-348",
    "snippet": "static void nfs_proc_rename_rpc_prepare(struct rpc_task *task, struct nfs_renamedata *data)\n{\n\trpc_call_start(task);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_call_start",
          "args": [
            "task"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_proc_rename_rpc_prepare(struct rpc_task *task, struct nfs_renamedata *data)\n{\n\trpc_call_start(task);\n}"
  },
  {
    "function_name": "nfs_proc_rename_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "339-343",
    "snippet": "static void\nnfs_proc_rename_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_RENAME];\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void\nnfs_proc_rename_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_RENAME];\n}"
  },
  {
    "function_name": "nfs_proc_unlink_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "333-337",
    "snippet": "static int nfs_proc_unlink_done(struct rpc_task *task, struct inode *dir)\n{\n\tnfs_mark_for_revalidate(dir);\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int nfs_proc_unlink_done(struct rpc_task *task, struct inode *dir)\n{\n\tnfs_mark_for_revalidate(dir);\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_proc_unlink_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "328-331",
    "snippet": "static void nfs_proc_unlink_rpc_prepare(struct rpc_task *task, struct nfs_unlinkdata *data)\n{\n\trpc_call_start(task);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_call_start",
          "args": [
            "task"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_proc_unlink_rpc_prepare(struct rpc_task *task, struct nfs_unlinkdata *data)\n{\n\trpc_call_start(task);\n}"
  },
  {
    "function_name": "nfs_proc_unlink_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "322-326",
    "snippet": "static void\nnfs_proc_unlink_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_REMOVE];\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void\nnfs_proc_unlink_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs_procedures[NFSPROC_REMOVE];\n}"
  },
  {
    "function_name": "nfs_proc_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "301-320",
    "snippet": "static int\nnfs_proc_remove(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_removeargs arg = {\n\t\t.fh = NFS_FH(dir),\n\t\t.name = *name,\n\t};\n\tstruct rpc_message msg = { \n\t\t.rpc_proc = &nfs_procedures[NFSPROC_REMOVE],\n\t\t.rpc_argp = &arg,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  remove %s\\n\", name->name);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\n\tdprintk(\"NFS reply remove: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply remove: %d\\n\"",
            "status"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  remove %s\\n\"",
            "name->name"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_remove(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_removeargs arg = {\n\t\t.fh = NFS_FH(dir),\n\t\t.name = *name,\n\t};\n\tstruct rpc_message msg = { \n\t\t.rpc_proc = &nfs_procedures[NFSPROC_REMOVE],\n\t\t.rpc_argp = &arg,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  remove %s\\n\", name->name);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\n\tdprintk(\"NFS reply remove: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_mknod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "257-299",
    "snippet": "static int\nnfs_proc_mknod(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t       dev_t rdev)\n{\n\tstruct nfs_createdata *data;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_CREATE],\n\t};\n\tumode_t mode;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mknod %pd\\n\", dentry);\n\n\tmode = sattr->ia_mode;\n\tif (S_ISFIFO(mode)) {\n\t\tsattr->ia_mode = (mode & ~S_IFMT) | S_IFCHR;\n\t\tsattr->ia_valid &= ~ATTR_SIZE;\n\t} else if (S_ISCHR(mode) || S_ISBLK(mode)) {\n\t\tsattr->ia_valid |= ATTR_SIZE;\n\t\tsattr->ia_size = new_encode_dev(rdev);/* get out your barf bag */\n\t}\n\n\tdata = nfs_alloc_createdata(dir, dentry, sattr);\n\tif (data == NULL)\n\t\tgoto out;\n\tmsg.rpc_argp = &data->arg;\n\tmsg.rpc_resp = &data->res;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\n\tif (status == -EINVAL && S_ISFIFO(mode)) {\n\t\tsattr->ia_mode = mode;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\t}\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\tnfs_free_createdata(data);\nout:\n\tdprintk(\"NFS reply mknod: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply mknod: %d\\n\"",
            "status"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_createdata",
          "args": [
            "data"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
          "lines": "223-226",
          "snippet": "static void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_instantiate",
          "args": [
            "dentry",
            "data->res.fh",
            "data->res.fattr",
            "NULL"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "1641-1679",
          "snippet": "int nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nint nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "data->res.fattr"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISFIFO",
          "args": [
            "mode"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_createdata",
          "args": [
            "dir",
            "dentry",
            "sattr"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
          "lines": "203-221",
          "snippet": "static struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_encode_dev",
          "args": [
            "rdev"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "mode"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "mode"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISFIFO",
          "args": [
            "mode"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  mknod %pd\\n\"",
            "dentry"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_mknod(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t       dev_t rdev)\n{\n\tstruct nfs_createdata *data;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_CREATE],\n\t};\n\tumode_t mode;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mknod %pd\\n\", dentry);\n\n\tmode = sattr->ia_mode;\n\tif (S_ISFIFO(mode)) {\n\t\tsattr->ia_mode = (mode & ~S_IFMT) | S_IFCHR;\n\t\tsattr->ia_valid &= ~ATTR_SIZE;\n\t} else if (S_ISCHR(mode) || S_ISBLK(mode)) {\n\t\tsattr->ia_valid |= ATTR_SIZE;\n\t\tsattr->ia_size = new_encode_dev(rdev);/* get out your barf bag */\n\t}\n\n\tdata = nfs_alloc_createdata(dir, dentry, sattr);\n\tif (data == NULL)\n\t\tgoto out;\n\tmsg.rpc_argp = &data->arg;\n\tmsg.rpc_resp = &data->res;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\n\tif (status == -EINVAL && S_ISFIFO(mode)) {\n\t\tsattr->ia_mode = mode;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\t}\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\tnfs_free_createdata(data);\nout:\n\tdprintk(\"NFS reply mknod: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "228-252",
    "snippet": "static int\nnfs_proc_create(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\tint flags)\n{\n\tstruct nfs_createdata *data;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_CREATE],\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  create %pd\\n\", dentry);\n\tdata = nfs_alloc_createdata(dir, dentry, sattr);\n\tif (data == NULL)\n\t\tgoto out;\n\tmsg.rpc_argp = &data->arg;\n\tmsg.rpc_resp = &data->res;\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\tnfs_free_createdata(data);\nout:\n\tdprintk(\"NFS reply create: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply create: %d\\n\"",
            "status"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_createdata",
          "args": [
            "data"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
          "lines": "223-226",
          "snippet": "static void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_instantiate",
          "args": [
            "dentry",
            "data->res.fh",
            "data->res.fattr",
            "NULL"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "1641-1679",
          "snippet": "int nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nint nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mark_for_revalidate",
          "args": [
            "dir"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_createdata",
          "args": [
            "dir",
            "dentry",
            "sattr"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
          "lines": "203-221",
          "snippet": "static struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  create %pd\\n\"",
            "dentry"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_create(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\tint flags)\n{\n\tstruct nfs_createdata *data;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_CREATE],\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  create %pd\\n\", dentry);\n\tdata = nfs_alloc_createdata(dir, dentry, sattr);\n\tif (data == NULL)\n\t\tgoto out;\n\tmsg.rpc_argp = &data->arg;\n\tmsg.rpc_resp = &data->res;\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_mark_for_revalidate(dir);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\tnfs_free_createdata(data);\nout:\n\tdprintk(\"NFS reply create: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_free_createdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "223-226",
    "snippet": "static void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic void nfs_free_createdata(const struct nfs_createdata *data)\n{\n\tkfree(data);\n}"
  },
  {
    "function_name": "nfs_alloc_createdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "203-221",
    "snippet": "static struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "&data->fattr"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*data)",
            "GFP_KERNEL"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic struct nfs_createdata *nfs_alloc_createdata(struct inode *dir,\n\t\tstruct dentry *dentry, struct iattr *sattr)\n{\n\tstruct nfs_createdata *data;\n\n\tdata = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data != NULL) {\n\t\tdata->arg.fh = NFS_FH(dir);\n\t\tdata->arg.name = dentry->d_name.name;\n\t\tdata->arg.len = dentry->d_name.len;\n\t\tdata->arg.sattr = sattr;\n\t\tnfs_fattr_init(&data->fattr);\n\t\tdata->fhandle.size = 0;\n\t\tdata->res.fh = &data->fhandle;\n\t\tdata->res.fattr = &data->fattr;\n\t}\n\treturn data;\n}"
  },
  {
    "function_name": "nfs_proc_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "175-194",
    "snippet": "static int nfs_proc_readlink(struct inode *inode, struct page *page,\n\t\tunsigned int pgbase, unsigned int pglen)\n{\n\tstruct nfs_readlinkargs\targs = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.pgbase\t\t= pgbase,\n\t\t.pglen\t\t= pglen,\n\t\t.pages\t\t= &page\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_READLINK],\n\t\t.rpc_argp\t= &args,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  readlink\\n\");\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tdprintk(\"NFS reply readlink: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply readlink: %d\\n\"",
            "status"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(inode)",
            "&msg",
            "0"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "inode"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  readlink\\n\""
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int nfs_proc_readlink(struct inode *inode, struct page *page,\n\t\tunsigned int pgbase, unsigned int pglen)\n{\n\tstruct nfs_readlinkargs\targs = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.pgbase\t\t= pgbase,\n\t\t.pglen\t\t= pglen,\n\t\t.pages\t\t= &page\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_READLINK],\n\t\t.rpc_argp\t= &args,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  readlink\\n\");\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tdprintk(\"NFS reply readlink: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "147-173",
    "snippet": "static int\nnfs_proc_lookup(struct inode *dir, struct qstr *name,\n\t\tstruct nfs_fh *fhandle, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label)\n{\n\tstruct nfs_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct nfs_diropok\tres = {\n\t\t.fh\t\t= fhandle,\n\t\t.fattr\t\t= fattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_LOOKUP],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  lookup %s\\n\", name->name);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tdprintk(\"NFS reply lookup: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply lookup: %d\\n\"",
            "status"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  lookup %s\\n\"",
            "name->name"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_lookup(struct inode *dir, struct qstr *name,\n\t\tstruct nfs_fh *fhandle, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label)\n{\n\tstruct nfs_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct nfs_diropok\tres = {\n\t\t.fh\t\t= fhandle,\n\t\t.fattr\t\t= fattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_LOOKUP],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  lookup %s\\n\", name->name);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tdprintk(\"NFS reply lookup: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "117-145",
    "snippet": "static int\nnfs_proc_setattr(struct dentry *dentry, struct nfs_fattr *fattr,\n\t\t struct iattr *sattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs_sattrargs\targ = { \n\t\t.fh\t= NFS_FH(inode),\n\t\t.sattr\t= sattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_SETATTR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\t/* Mask out the non-modebit related stuff from attr->ia_mode */\n\tsattr->ia_mode &= S_IALLUGO;\n\n\tdprintk(\"NFS call  setattr\\n\");\n\tif (sattr->ia_valid & ATTR_FILE)\n\t\tmsg.rpc_cred = nfs_file_cred(sattr->ia_file);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tif (status == 0)\n\t\tnfs_setattr_update_inode(inode, sattr, fattr);\n\tdprintk(\"NFS reply setattr: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply setattr: %d\\n\"",
            "status"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_setattr_update_inode",
          "args": [
            "inode",
            "sattr",
            "fattr"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_setattr_update_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "589-616",
          "snippet": "void nfs_setattr_update_inode(struct inode *inode, struct iattr *attr,\n\t\tstruct nfs_fattr *fattr)\n{\n\t/* Barrier: bump the attribute generation count. */\n\tnfs_fattr_set_barrier(fattr);\n\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->attr_gencount = fattr->gencount;\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0) {\n\t\tif ((attr->ia_valid & ATTR_MODE) != 0) {\n\t\t\tint mode = attr->ia_mode & S_IALLUGO;\n\t\t\tmode |= inode->i_mode & ~S_IALLUGO;\n\t\t\tinode->i_mode = mode;\n\t\t}\n\t\tif ((attr->ia_valid & ATTR_UID) != 0)\n\t\t\tinode->i_uid = attr->ia_uid;\n\t\tif ((attr->ia_valid & ATTR_GID) != 0)\n\t\t\tinode->i_gid = attr->ia_gid;\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL);\n\t}\n\tif ((attr->ia_valid & ATTR_SIZE) != 0) {\n\t\tnfs_inc_stats(inode, NFSIOS_SETATTRTRUNC);\n\t\tnfs_vmtruncate(inode, attr->ia_size);\n\t}\n\tnfs_update_inode(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_setattr_update_inode(struct inode *inode, struct iattr *attr,\n\t\tstruct nfs_fattr *fattr)\n{\n\t/* Barrier: bump the attribute generation count. */\n\tnfs_fattr_set_barrier(fattr);\n\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->attr_gencount = fattr->gencount;\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0) {\n\t\tif ((attr->ia_valid & ATTR_MODE) != 0) {\n\t\t\tint mode = attr->ia_mode & S_IALLUGO;\n\t\t\tmode |= inode->i_mode & ~S_IALLUGO;\n\t\t\tinode->i_mode = mode;\n\t\t}\n\t\tif ((attr->ia_valid & ATTR_UID) != 0)\n\t\t\tinode->i_uid = attr->ia_uid;\n\t\tif ((attr->ia_valid & ATTR_GID) != 0)\n\t\t\tinode->i_gid = attr->ia_gid;\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL);\n\t}\n\tif ((attr->ia_valid & ATTR_SIZE) != 0) {\n\t\tnfs_inc_stats(inode, NFSIOS_SETATTRTRUNC);\n\t\tnfs_vmtruncate(inode, attr->ia_size);\n\t}\n\tnfs_update_inode(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(inode)",
            "&msg",
            "0"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "inode"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_cred",
          "args": [
            "sattr->ia_file"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  setattr\\n\""
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_setattr(struct dentry *dentry, struct nfs_fattr *fattr,\n\t\t struct iattr *sattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs_sattrargs\targ = { \n\t\t.fh\t= NFS_FH(inode),\n\t\t.sattr\t= sattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_SETATTR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\t/* Mask out the non-modebit related stuff from attr->ia_mode */\n\tsattr->ia_mode &= S_IALLUGO;\n\n\tdprintk(\"NFS call  setattr\\n\");\n\tif (sattr->ia_valid & ATTR_FILE)\n\t\tmsg.rpc_cred = nfs_file_cred(sattr->ia_file);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tif (status == 0)\n\t\tnfs_setattr_update_inode(inode, sattr, fattr);\n\tdprintk(\"NFS reply setattr: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "99-115",
    "snippet": "static int\nnfs_proc_getattr(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\tstruct nfs_fattr *fattr, struct nfs4_label *label)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_GETATTR],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  getattr\\n\");\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply getattr: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply getattr: %d\\n\"",
            "status"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  getattr\\n\""
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_getattr(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\tstruct nfs_fattr *fattr, struct nfs4_label *label)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_GETATTR],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  getattr\\n\");\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply getattr: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_proc_get_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/proc.c",
    "lines": "52-94",
    "snippet": "static int\nnfs_proc_get_root(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t  struct nfs_fsinfo *info)\n{\n\tstruct nfs_fattr *fattr = info->fattr;\n\tstruct nfs2_fsstat fsinfo;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_GETATTR],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint status;\n\n\tdprintk(\"%s: call getattr\\n\", __func__);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\t/* Retry with default authentication if different */\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = rpc_call_sync(server->nfs_client->cl_rpcclient, &msg, 0);\n\tdprintk(\"%s: reply getattr: %d\\n\", __func__, status);\n\tif (status)\n\t\treturn status;\n\tdprintk(\"%s: call statfs\\n\", __func__);\n\tmsg.rpc_proc = &nfs_procedures[NFSPROC_STATFS];\n\tmsg.rpc_resp = &fsinfo;\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\t/* Retry with default authentication if different */\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = rpc_call_sync(server->nfs_client->cl_rpcclient, &msg, 0);\n\tdprintk(\"%s: reply statfs: %d\\n\", __func__, status);\n\tif (status)\n\t\treturn status;\n\tinfo->rtmax  = NFS_MAXDATA;\n\tinfo->rtpref = fsinfo.tsize;\n\tinfo->rtmult = fsinfo.bsize;\n\tinfo->wtmax  = NFS_MAXDATA;\n\tinfo->wtpref = fsinfo.tsize;\n\tinfo->wtmult = fsinfo.bsize;\n\tinfo->dtpref = fsinfo.tsize;\n\tinfo->maxfilesize = 0x7FFFFFFF;\n\tinfo->lease_time = 0;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/freezer.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: reply statfs: %d\\n\"",
            "__func__",
            "status"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->nfs_client->cl_rpcclient",
            "&msg",
            "0"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: call statfs\\n\"",
            "__func__"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: reply getattr: %d\\n\"",
            "__func__",
            "status"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->nfs_client->cl_rpcclient",
            "&msg",
            "0"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: call getattr\\n\"",
            "__func__"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/freezer.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n#include <linux/types.h>\n\nstatic int\nnfs_proc_get_root(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t  struct nfs_fsinfo *info)\n{\n\tstruct nfs_fattr *fattr = info->fattr;\n\tstruct nfs2_fsstat fsinfo;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs_procedures[NFSPROC_GETATTR],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint status;\n\n\tdprintk(\"%s: call getattr\\n\", __func__);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\t/* Retry with default authentication if different */\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = rpc_call_sync(server->nfs_client->cl_rpcclient, &msg, 0);\n\tdprintk(\"%s: reply getattr: %d\\n\", __func__, status);\n\tif (status)\n\t\treturn status;\n\tdprintk(\"%s: call statfs\\n\", __func__);\n\tmsg.rpc_proc = &nfs_procedures[NFSPROC_STATFS];\n\tmsg.rpc_resp = &fsinfo;\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\t/* Retry with default authentication if different */\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = rpc_call_sync(server->nfs_client->cl_rpcclient, &msg, 0);\n\tdprintk(\"%s: reply statfs: %d\\n\", __func__, status);\n\tif (status)\n\t\treturn status;\n\tinfo->rtmax  = NFS_MAXDATA;\n\tinfo->rtpref = fsinfo.tsize;\n\tinfo->rtmult = fsinfo.bsize;\n\tinfo->wtmax  = NFS_MAXDATA;\n\tinfo->wtpref = fsinfo.tsize;\n\tinfo->wtmult = fsinfo.bsize;\n\tinfo->dtpref = fsinfo.tsize;\n\tinfo->maxfilesize = 0x7FFFFFFF;\n\tinfo->lease_time = 0;\n\treturn 0;\n}"
  }
]