[
  {
    "function_name": "qnx6_find_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "217-275",
    "snippet": "unsigned qnx6_find_entry(int len, struct inode *dir, const char *name,\n\t\t\t struct page **res_page)\n{\n\tstruct super_block *s = dir->i_sb;\n\tstruct qnx6_inode_info *ei = QNX6_I(dir);\n\tstruct page *page = NULL;\n\tunsigned long start, n;\n\tunsigned long npages = dir_pages(dir);\n\tunsigned ino;\n\tstruct qnx6_dir_entry *de;\n\tstruct qnx6_long_dir_entry *lde;\n\n\t*res_page = NULL;\n\n\tif (npages == 0)\n\t\treturn 0;\n\tstart = ei->i_dir_start_lookup;\n\tif (start >= npages)\n\t\tstart = 0;\n\tn = start;\n\n\tdo {\n\t\tpage = qnx6_get_page(dir, n);\n\t\tif (!IS_ERR(page)) {\n\t\t\tint limit = last_entry(dir, n);\n\t\t\tint i;\n\n\t\t\tde = (struct qnx6_dir_entry *)page_address(page);\n\t\t\tfor (i = 0; i < limit; i++, de++) {\n\t\t\t\tif (len <= QNX6_SHORT_NAME_MAX) {\n\t\t\t\t\t/* short filename */\n\t\t\t\t\tif (len != de->de_size)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tino = qnx6_match(s, len, name, de);\n\t\t\t\t\tif (ino)\n\t\t\t\t\t\tgoto found;\n\t\t\t\t} else if (de->de_size == 0xff) {\n\t\t\t\t\t/* deal with long filename */\n\t\t\t\t\tlde = (struct qnx6_long_dir_entry *)de;\n\t\t\t\t\tino = qnx6_long_match(len,\n\t\t\t\t\t\t\t\tname, lde, dir);\n\t\t\t\t\tif (ino)\n\t\t\t\t\t\tgoto found;\n\t\t\t\t} else\n\t\t\t\t\tpr_err(\"undefined filename size in inode.\\n\");\n\t\t\t}\n\t\t\tqnx6_put_page(page);\n\t\t}\n\n\t\tif (++n >= npages)\n\t\t\tn = 0;\n\t} while (n != start);\n\treturn 0;\n\nfound:\n\t*res_page = page;\n\tei->i_dir_start_lookup = n;\n\treturn ino;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qnx6_put_page",
          "args": [
            "page"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_put_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "128-132",
          "snippet": "static inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"undefined filename size in inode.\\n\""
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qnx6_long_match",
          "args": [
            "len",
            "name",
            "lde",
            "dir"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_long_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "179-202",
          "snippet": "static unsigned qnx6_long_match(int len, const char *name,\n\t\t\tstruct qnx6_long_dir_entry *de, struct inode *dir)\n{\n\tstruct super_block *s = dir->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint thislen;\n\tstruct qnx6_long_filename *lf = qnx6_longname(s, de, &page);\n\n\tif (IS_ERR(lf))\n\t\treturn 0;\n\n\tthislen = fs16_to_cpu(sbi, lf->lf_size);\n\tif (len != thislen) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\tif (memcmp(name, lf->lf_fname, len) == 0) {\n\t\tqnx6_put_page(page);\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\t}\n\tqnx6_put_page(page);\n\treturn 0;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned qnx6_long_match(int len, const char *name,\n\t\t\tstruct qnx6_long_dir_entry *de, struct inode *dir)\n{\n\tstruct super_block *s = dir->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint thislen;\n\tstruct qnx6_long_filename *lf = qnx6_longname(s, de, &page);\n\n\tif (IS_ERR(lf))\n\t\treturn 0;\n\n\tthislen = fs16_to_cpu(sbi, lf->lf_size);\n\tif (len != thislen) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\tif (memcmp(name, lf->lf_fname, len) == 0) {\n\t\tqnx6_put_page(page);\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\t}\n\tqnx6_put_page(page);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qnx6_match",
          "args": [
            "s",
            "len",
            "name",
            "de"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "207-214",
          "snippet": "static unsigned qnx6_match(struct super_block *s, int len, const char *name,\n\t\t\tstruct qnx6_dir_entry *de)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tif (memcmp(name, de->de_fname, len) == 0)\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\treturn 0;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned qnx6_match(struct super_block *s, int len, const char *name,\n\t\t\tstruct qnx6_dir_entry *de)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tif (memcmp(name, de->de_fname, len) == 0)\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "last_entry",
          "args": [
            "dir",
            "n"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "last_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "40-47",
          "snippet": "static unsigned last_entry(struct inode *inode, unsigned long page_nr)\n{\n\tunsigned long last_byte = inode->i_size;\n\tlast_byte -= page_nr << PAGE_CACHE_SHIFT;\n\tif (last_byte > PAGE_CACHE_SIZE)\n\t\tlast_byte = PAGE_CACHE_SIZE;\n\treturn last_byte / QNX6_DIR_ENTRY_SIZE;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned last_entry(struct inode *inode, unsigned long page_nr)\n{\n\tunsigned long last_byte = inode->i_size;\n\tlast_byte -= page_nr << PAGE_CACHE_SHIFT;\n\tif (last_byte > PAGE_CACHE_SIZE)\n\t\tlast_byte = PAGE_CACHE_SIZE;\n\treturn last_byte / QNX6_DIR_ENTRY_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "page"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qnx6_get_page",
          "args": [
            "dir",
            "n"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_get_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "26-33",
          "snippet": "static struct page *qnx6_get_page(struct inode *dir, unsigned long n)\n{\n\tstruct address_space *mapping = dir->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (!IS_ERR(page))\n\t\tkmap(page);\n\treturn page;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic struct page *qnx6_get_page(struct inode *dir, unsigned long n)\n{\n\tstruct address_space *mapping = dir->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (!IS_ERR(page))\n\t\tkmap(page);\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_pages",
          "args": [
            "dir"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "dir_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "35-38",
          "snippet": "static inline unsigned long dir_pages(struct inode *inode)\n{\n\treturn (inode->i_size+PAGE_CACHE_SIZE-1)>>PAGE_CACHE_SHIFT;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic inline unsigned long dir_pages(struct inode *inode)\n{\n\treturn (inode->i_size+PAGE_CACHE_SIZE-1)>>PAGE_CACHE_SHIFT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QNX6_I",
          "args": [
            "dir"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "QNX6_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "63-66",
          "snippet": "static inline struct qnx6_inode_info *QNX6_I(struct inode *inode)\n{\n\treturn container_of(inode, struct qnx6_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct qnx6_inode_info *QNX6_I(struct inode *inode)\n{\n\treturn container_of(inode, struct qnx6_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qnx6.h\"\n\nunsigned qnx6_find_entry(int len, struct inode *dir, const char *name,\n\t\t\t struct page **res_page)\n{\n\tstruct super_block *s = dir->i_sb;\n\tstruct qnx6_inode_info *ei = QNX6_I(dir);\n\tstruct page *page = NULL;\n\tunsigned long start, n;\n\tunsigned long npages = dir_pages(dir);\n\tunsigned ino;\n\tstruct qnx6_dir_entry *de;\n\tstruct qnx6_long_dir_entry *lde;\n\n\t*res_page = NULL;\n\n\tif (npages == 0)\n\t\treturn 0;\n\tstart = ei->i_dir_start_lookup;\n\tif (start >= npages)\n\t\tstart = 0;\n\tn = start;\n\n\tdo {\n\t\tpage = qnx6_get_page(dir, n);\n\t\tif (!IS_ERR(page)) {\n\t\t\tint limit = last_entry(dir, n);\n\t\t\tint i;\n\n\t\t\tde = (struct qnx6_dir_entry *)page_address(page);\n\t\t\tfor (i = 0; i < limit; i++, de++) {\n\t\t\t\tif (len <= QNX6_SHORT_NAME_MAX) {\n\t\t\t\t\t/* short filename */\n\t\t\t\t\tif (len != de->de_size)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tino = qnx6_match(s, len, name, de);\n\t\t\t\t\tif (ino)\n\t\t\t\t\t\tgoto found;\n\t\t\t\t} else if (de->de_size == 0xff) {\n\t\t\t\t\t/* deal with long filename */\n\t\t\t\t\tlde = (struct qnx6_long_dir_entry *)de;\n\t\t\t\t\tino = qnx6_long_match(len,\n\t\t\t\t\t\t\t\tname, lde, dir);\n\t\t\t\t\tif (ino)\n\t\t\t\t\t\tgoto found;\n\t\t\t\t} else\n\t\t\t\t\tpr_err(\"undefined filename size in inode.\\n\");\n\t\t\t}\n\t\t\tqnx6_put_page(page);\n\t\t}\n\n\t\tif (++n >= npages)\n\t\t\tn = 0;\n\t} while (n != start);\n\treturn 0;\n\nfound:\n\t*res_page = page;\n\tei->i_dir_start_lookup = n;\n\treturn ino;\n}"
  },
  {
    "function_name": "qnx6_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "207-214",
    "snippet": "static unsigned qnx6_match(struct super_block *s, int len, const char *name,\n\t\t\tstruct qnx6_dir_entry *de)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tif (memcmp(name, de->de_fname, len) == 0)\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\treturn 0;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sbi",
            "de->de_inode"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "93-99",
          "snippet": "static inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "name",
            "de->de_fname",
            "len"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QNX6_SB",
          "args": [
            "s"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "QNX6_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "58-61",
          "snippet": "static inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned qnx6_match(struct super_block *s, int len, const char *name,\n\t\t\tstruct qnx6_dir_entry *de)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tif (memcmp(name, de->de_fname, len) == 0)\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\treturn 0;\n}"
  },
  {
    "function_name": "qnx6_long_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "179-202",
    "snippet": "static unsigned qnx6_long_match(int len, const char *name,\n\t\t\tstruct qnx6_long_dir_entry *de, struct inode *dir)\n{\n\tstruct super_block *s = dir->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint thislen;\n\tstruct qnx6_long_filename *lf = qnx6_longname(s, de, &page);\n\n\tif (IS_ERR(lf))\n\t\treturn 0;\n\n\tthislen = fs16_to_cpu(sbi, lf->lf_size);\n\tif (len != thislen) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\tif (memcmp(name, lf->lf_fname, len) == 0) {\n\t\tqnx6_put_page(page);\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\t}\n\tqnx6_put_page(page);\n\treturn 0;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qnx6_put_page",
          "args": [
            "page"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_put_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "128-132",
          "snippet": "static inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sbi",
            "de->de_inode"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "93-99",
          "snippet": "static inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "name",
            "lf->lf_fname",
            "len"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs16_to_cpu",
          "args": [
            "sbi",
            "lf->lf_size"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "fs16_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "109-115",
          "snippet": "static inline __u16 fs16_to_cpu(struct qnx6_sb_info *sbi, __fs16 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline __u16 fs16_to_cpu(struct qnx6_sb_info *sbi, __fs16 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "lf"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qnx6_longname",
          "args": [
            "s",
            "de",
            "&page"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_longname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "49-64",
          "snippet": "static struct qnx6_long_filename *qnx6_longname(struct super_block *sb,\n\t\t\t\t\t struct qnx6_long_dir_entry *de,\n\t\t\t\t\t struct page **p)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(sb);\n\tu32 s = fs32_to_cpu(sbi, de->de_long_inode); /* in block units */\n\tu32 n = s >> (PAGE_CACHE_SHIFT - sb->s_blocksize_bits); /* in pages */\n\t/* within page */\n\tu32 offs = (s << sb->s_blocksize_bits) & ~PAGE_CACHE_MASK;\n\tstruct address_space *mapping = sbi->longfile->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (IS_ERR(page))\n\t\treturn ERR_CAST(page);\n\tkmap(*p = page);\n\treturn (struct qnx6_long_filename *)(page_address(page) + offs);\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic struct qnx6_long_filename *qnx6_longname(struct super_block *sb,\n\t\t\t\t\t struct qnx6_long_dir_entry *de,\n\t\t\t\t\t struct page **p)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(sb);\n\tu32 s = fs32_to_cpu(sbi, de->de_long_inode); /* in block units */\n\tu32 n = s >> (PAGE_CACHE_SHIFT - sb->s_blocksize_bits); /* in pages */\n\t/* within page */\n\tu32 offs = (s << sb->s_blocksize_bits) & ~PAGE_CACHE_MASK;\n\tstruct address_space *mapping = sbi->longfile->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (IS_ERR(page))\n\t\treturn ERR_CAST(page);\n\tkmap(*p = page);\n\treturn (struct qnx6_long_filename *)(page_address(page) + offs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "QNX6_SB",
          "args": [
            "s"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "QNX6_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "58-61",
          "snippet": "static inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned qnx6_long_match(int len, const char *name,\n\t\t\tstruct qnx6_long_dir_entry *de, struct inode *dir)\n{\n\tstruct super_block *s = dir->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint thislen;\n\tstruct qnx6_long_filename *lf = qnx6_longname(s, de, &page);\n\n\tif (IS_ERR(lf))\n\t\treturn 0;\n\n\tthislen = fs16_to_cpu(sbi, lf->lf_size);\n\tif (len != thislen) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\tif (memcmp(name, lf->lf_fname, len) == 0) {\n\t\tqnx6_put_page(page);\n\t\treturn fs32_to_cpu(sbi, de->de_inode);\n\t}\n\tqnx6_put_page(page);\n\treturn 0;\n}"
  },
  {
    "function_name": "qnx6_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "116-174",
    "snippet": "static int qnx6_readdir(struct file *file, struct dir_context *ctx)\n{\n\tstruct inode *inode = file_inode(file);\n\tstruct super_block *s = inode->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tloff_t pos = ctx->pos & ~(QNX6_DIR_ENTRY_SIZE - 1);\n\tunsigned long npages = dir_pages(inode);\n\tunsigned long n = pos >> PAGE_CACHE_SHIFT;\n\tunsigned start = (pos & ~PAGE_CACHE_MASK) / QNX6_DIR_ENTRY_SIZE;\n\tbool done = false;\n\n\tctx->pos = pos;\n\tif (ctx->pos >= inode->i_size)\n\t\treturn 0;\n\n\tfor ( ; !done && n < npages; n++, start = 0) {\n\t\tstruct page *page = qnx6_get_page(inode, n);\n\t\tint limit = last_entry(inode, n);\n\t\tstruct qnx6_dir_entry *de;\n\t\tint i = start;\n\n\t\tif (IS_ERR(page)) {\n\t\t\tpr_err(\"%s(): read failed\\n\", __func__);\n\t\t\tctx->pos = (n + 1) << PAGE_CACHE_SHIFT;\n\t\t\treturn PTR_ERR(page);\n\t\t}\n\t\tde = ((struct qnx6_dir_entry *)page_address(page)) + start;\n\t\tfor (; i < limit; i++, de++, ctx->pos += QNX6_DIR_ENTRY_SIZE) {\n\t\t\tint size = de->de_size;\n\t\t\tu32 no_inode = fs32_to_cpu(sbi, de->de_inode);\n\n\t\t\tif (!no_inode || !size)\n\t\t\t\tcontinue;\n\n\t\t\tif (size > QNX6_SHORT_NAME_MAX) {\n\t\t\t\t/* long filename detected\n\t\t\t\t   get the filename from long filename\n\t\t\t\t   structure / block */\n\t\t\t\tif (!qnx6_dir_longfilename(inode,\n\t\t\t\t\t(struct qnx6_long_dir_entry *)de,\n\t\t\t\t\tctx, no_inode)) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpr_debug(\"%s():%.*s inode:%u\\n\",\n\t\t\t\t\t __func__, size, de->de_fname,\n\t\t\t\t\t no_inode);\n\t\t\t\tif (!dir_emit(ctx, de->de_fname, size,\n\t\t\t\t      no_inode, DT_UNKNOWN)) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tqnx6_put_page(page);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qnx6_put_page",
          "args": [
            "page"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_put_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "128-132",
          "snippet": "static inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_emit",
          "args": [
            "ctx",
            "de->de_fname",
            "size",
            "no_inode",
            "DT_UNKNOWN"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s():%.*s inode:%u\\n\"",
            "__func__",
            "size",
            "de->de_fname",
            "no_inode"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qnx6_dir_longfilename",
          "args": [
            "inode",
            "(struct qnx6_long_dir_entry *)de",
            "ctx",
            "no_inode"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_dir_longfilename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "66-114",
          "snippet": "static int qnx6_dir_longfilename(struct inode *inode,\n\t\t\tstruct qnx6_long_dir_entry *de,\n\t\t\tstruct dir_context *ctx,\n\t\t\tunsigned de_inode)\n{\n\tstruct qnx6_long_filename *lf;\n\tstruct super_block *s = inode->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint lf_size;\n\n\tif (de->de_size != 0xff) {\n\t\t/* error - long filename entries always have size 0xff\n\t\t   in direntry */\n\t\tpr_err(\"invalid direntry size (%i).\\n\", de->de_size);\n\t\treturn 0;\n\t}\n\tlf = qnx6_longname(s, de, &page);\n\tif (IS_ERR(lf)) {\n\t\tpr_err(\"Error reading longname\\n\");\n\t\treturn 0;\n\t}\n\n\tlf_size = fs16_to_cpu(sbi, lf->lf_size);\n\n\tif (lf_size > QNX6_LONG_NAME_MAX) {\n\t\tpr_debug(\"file %s\\n\", lf->lf_fname);\n\t\tpr_err(\"Filename too long (%i)\\n\", lf_size);\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\t/* calc & validate longfilename checksum\n\t   mmi 3g filesystem does not have that checksum */\n\tif (!test_opt(s, MMI_FS) && fs32_to_cpu(sbi, de->de_checksum) !=\n\t\t\tqnx6_lfile_checksum(lf->lf_fname, lf_size))\n\t\tpr_info(\"long filename checksum error.\\n\");\n\n\tpr_debug(\"qnx6_readdir:%.*s inode:%u\\n\",\n\t\t lf_size, lf->lf_fname, de_inode);\n\tif (!dir_emit(ctx, lf->lf_fname, lf_size, de_inode, DT_UNKNOWN)) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\tqnx6_put_page(page);\n\t/* success */\n\treturn 1;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic int qnx6_dir_longfilename(struct inode *inode,\n\t\t\tstruct qnx6_long_dir_entry *de,\n\t\t\tstruct dir_context *ctx,\n\t\t\tunsigned de_inode)\n{\n\tstruct qnx6_long_filename *lf;\n\tstruct super_block *s = inode->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint lf_size;\n\n\tif (de->de_size != 0xff) {\n\t\t/* error - long filename entries always have size 0xff\n\t\t   in direntry */\n\t\tpr_err(\"invalid direntry size (%i).\\n\", de->de_size);\n\t\treturn 0;\n\t}\n\tlf = qnx6_longname(s, de, &page);\n\tif (IS_ERR(lf)) {\n\t\tpr_err(\"Error reading longname\\n\");\n\t\treturn 0;\n\t}\n\n\tlf_size = fs16_to_cpu(sbi, lf->lf_size);\n\n\tif (lf_size > QNX6_LONG_NAME_MAX) {\n\t\tpr_debug(\"file %s\\n\", lf->lf_fname);\n\t\tpr_err(\"Filename too long (%i)\\n\", lf_size);\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\t/* calc & validate longfilename checksum\n\t   mmi 3g filesystem does not have that checksum */\n\tif (!test_opt(s, MMI_FS) && fs32_to_cpu(sbi, de->de_checksum) !=\n\t\t\tqnx6_lfile_checksum(lf->lf_fname, lf_size))\n\t\tpr_info(\"long filename checksum error.\\n\");\n\n\tpr_debug(\"qnx6_readdir:%.*s inode:%u\\n\",\n\t\t lf_size, lf->lf_fname, de_inode);\n\tif (!dir_emit(ctx, lf->lf_fname, lf_size, de_inode, DT_UNKNOWN)) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\tqnx6_put_page(page);\n\t/* success */\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sbi",
            "de->de_inode"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "93-99",
          "snippet": "static inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "page"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s(): read failed\\n\"",
            "__func__"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "page"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "last_entry",
          "args": [
            "inode",
            "n"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "last_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "40-47",
          "snippet": "static unsigned last_entry(struct inode *inode, unsigned long page_nr)\n{\n\tunsigned long last_byte = inode->i_size;\n\tlast_byte -= page_nr << PAGE_CACHE_SHIFT;\n\tif (last_byte > PAGE_CACHE_SIZE)\n\t\tlast_byte = PAGE_CACHE_SIZE;\n\treturn last_byte / QNX6_DIR_ENTRY_SIZE;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned last_entry(struct inode *inode, unsigned long page_nr)\n{\n\tunsigned long last_byte = inode->i_size;\n\tlast_byte -= page_nr << PAGE_CACHE_SHIFT;\n\tif (last_byte > PAGE_CACHE_SIZE)\n\t\tlast_byte = PAGE_CACHE_SIZE;\n\treturn last_byte / QNX6_DIR_ENTRY_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qnx6_get_page",
          "args": [
            "inode",
            "n"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_get_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "26-33",
          "snippet": "static struct page *qnx6_get_page(struct inode *dir, unsigned long n)\n{\n\tstruct address_space *mapping = dir->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (!IS_ERR(page))\n\t\tkmap(page);\n\treturn page;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic struct page *qnx6_get_page(struct inode *dir, unsigned long n)\n{\n\tstruct address_space *mapping = dir->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (!IS_ERR(page))\n\t\tkmap(page);\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_pages",
          "args": [
            "inode"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "dir_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "35-38",
          "snippet": "static inline unsigned long dir_pages(struct inode *inode)\n{\n\treturn (inode->i_size+PAGE_CACHE_SIZE-1)>>PAGE_CACHE_SHIFT;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic inline unsigned long dir_pages(struct inode *inode)\n{\n\treturn (inode->i_size+PAGE_CACHE_SIZE-1)>>PAGE_CACHE_SHIFT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QNX6_SB",
          "args": [
            "s"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "QNX6_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "58-61",
          "snippet": "static inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_init_file_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fuse/file.c",
          "lines": "3009-3013",
          "snippet": "void fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}",
          "includes": [
            "#include <linux/falloc.h>",
            "#include <linux/aio.h>",
            "#include <linux/swap.h>",
            "#include <linux/compat.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include \"fuse_i.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};",
            "static const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/falloc.h>\n#include <linux/aio.h>\n#include <linux/swap.h>\n#include <linux/compat.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include \"fuse_i.h\"\n\nstatic const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};\nstatic const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};\n\nvoid fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic int qnx6_readdir(struct file *file, struct dir_context *ctx)\n{\n\tstruct inode *inode = file_inode(file);\n\tstruct super_block *s = inode->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tloff_t pos = ctx->pos & ~(QNX6_DIR_ENTRY_SIZE - 1);\n\tunsigned long npages = dir_pages(inode);\n\tunsigned long n = pos >> PAGE_CACHE_SHIFT;\n\tunsigned start = (pos & ~PAGE_CACHE_MASK) / QNX6_DIR_ENTRY_SIZE;\n\tbool done = false;\n\n\tctx->pos = pos;\n\tif (ctx->pos >= inode->i_size)\n\t\treturn 0;\n\n\tfor ( ; !done && n < npages; n++, start = 0) {\n\t\tstruct page *page = qnx6_get_page(inode, n);\n\t\tint limit = last_entry(inode, n);\n\t\tstruct qnx6_dir_entry *de;\n\t\tint i = start;\n\n\t\tif (IS_ERR(page)) {\n\t\t\tpr_err(\"%s(): read failed\\n\", __func__);\n\t\t\tctx->pos = (n + 1) << PAGE_CACHE_SHIFT;\n\t\t\treturn PTR_ERR(page);\n\t\t}\n\t\tde = ((struct qnx6_dir_entry *)page_address(page)) + start;\n\t\tfor (; i < limit; i++, de++, ctx->pos += QNX6_DIR_ENTRY_SIZE) {\n\t\t\tint size = de->de_size;\n\t\t\tu32 no_inode = fs32_to_cpu(sbi, de->de_inode);\n\n\t\t\tif (!no_inode || !size)\n\t\t\t\tcontinue;\n\n\t\t\tif (size > QNX6_SHORT_NAME_MAX) {\n\t\t\t\t/* long filename detected\n\t\t\t\t   get the filename from long filename\n\t\t\t\t   structure / block */\n\t\t\t\tif (!qnx6_dir_longfilename(inode,\n\t\t\t\t\t(struct qnx6_long_dir_entry *)de,\n\t\t\t\t\tctx, no_inode)) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpr_debug(\"%s():%.*s inode:%u\\n\",\n\t\t\t\t\t __func__, size, de->de_fname,\n\t\t\t\t\t no_inode);\n\t\t\t\tif (!dir_emit(ctx, de->de_fname, size,\n\t\t\t\t      no_inode, DT_UNKNOWN)) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tqnx6_put_page(page);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "qnx6_dir_longfilename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "66-114",
    "snippet": "static int qnx6_dir_longfilename(struct inode *inode,\n\t\t\tstruct qnx6_long_dir_entry *de,\n\t\t\tstruct dir_context *ctx,\n\t\t\tunsigned de_inode)\n{\n\tstruct qnx6_long_filename *lf;\n\tstruct super_block *s = inode->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint lf_size;\n\n\tif (de->de_size != 0xff) {\n\t\t/* error - long filename entries always have size 0xff\n\t\t   in direntry */\n\t\tpr_err(\"invalid direntry size (%i).\\n\", de->de_size);\n\t\treturn 0;\n\t}\n\tlf = qnx6_longname(s, de, &page);\n\tif (IS_ERR(lf)) {\n\t\tpr_err(\"Error reading longname\\n\");\n\t\treturn 0;\n\t}\n\n\tlf_size = fs16_to_cpu(sbi, lf->lf_size);\n\n\tif (lf_size > QNX6_LONG_NAME_MAX) {\n\t\tpr_debug(\"file %s\\n\", lf->lf_fname);\n\t\tpr_err(\"Filename too long (%i)\\n\", lf_size);\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\t/* calc & validate longfilename checksum\n\t   mmi 3g filesystem does not have that checksum */\n\tif (!test_opt(s, MMI_FS) && fs32_to_cpu(sbi, de->de_checksum) !=\n\t\t\tqnx6_lfile_checksum(lf->lf_fname, lf_size))\n\t\tpr_info(\"long filename checksum error.\\n\");\n\n\tpr_debug(\"qnx6_readdir:%.*s inode:%u\\n\",\n\t\t lf_size, lf->lf_fname, de_inode);\n\tif (!dir_emit(ctx, lf->lf_fname, lf_size, de_inode, DT_UNKNOWN)) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\tqnx6_put_page(page);\n\t/* success */\n\treturn 1;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qnx6_put_page",
          "args": [
            "page"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_put_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "128-132",
          "snippet": "static inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline void qnx6_put_page(struct page *page)\n{\n\tkunmap(page);\n\tpage_cache_release(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_emit",
          "args": [
            "ctx",
            "lf->lf_fname",
            "lf_size",
            "de_inode",
            "DT_UNKNOWN"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"qnx6_readdir:%.*s inode:%u\\n\"",
            "lf_size",
            "lf->lf_fname",
            "de_inode"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"long filename checksum error.\\n\""
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qnx6_lfile_checksum",
          "args": [
            "lf->lf_fname",
            "lf_size"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_lfile_checksum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "15-24",
          "snippet": "static unsigned qnx6_lfile_checksum(char *name, unsigned size)\n{\n\tunsigned crc = 0;\n\tchar *end = name + size;\n\twhile (name < end) {\n\t\tcrc = ((crc >> 1) + *(name++)) ^\n\t\t\t((crc & 0x00000001) ? 0x80000000 : 0);\n\t}\n\treturn crc;\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned qnx6_lfile_checksum(char *name, unsigned size)\n{\n\tunsigned crc = 0;\n\tchar *end = name + size;\n\twhile (name < end) {\n\t\tcrc = ((crc >> 1) + *(name++)) ^\n\t\t\t((crc & 0x00000001) ? 0x80000000 : 0);\n\t}\n\treturn crc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sbi",
            "de->de_checksum"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "93-99",
          "snippet": "static inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_opt",
          "args": [
            "s",
            "MMI_FS"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Filename too long (%i)\\n\"",
            "lf_size"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"file %s\\n\"",
            "lf->lf_fname"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs16_to_cpu",
          "args": [
            "sbi",
            "lf->lf_size"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "fs16_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "109-115",
          "snippet": "static inline __u16 fs16_to_cpu(struct qnx6_sb_info *sbi, __fs16 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline __u16 fs16_to_cpu(struct qnx6_sb_info *sbi, __fs16 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Error reading longname\\n\""
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "lf"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qnx6_longname",
          "args": [
            "s",
            "de",
            "&page"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "qnx6_longname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
          "lines": "49-64",
          "snippet": "static struct qnx6_long_filename *qnx6_longname(struct super_block *sb,\n\t\t\t\t\t struct qnx6_long_dir_entry *de,\n\t\t\t\t\t struct page **p)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(sb);\n\tu32 s = fs32_to_cpu(sbi, de->de_long_inode); /* in block units */\n\tu32 n = s >> (PAGE_CACHE_SHIFT - sb->s_blocksize_bits); /* in pages */\n\t/* within page */\n\tu32 offs = (s << sb->s_blocksize_bits) & ~PAGE_CACHE_MASK;\n\tstruct address_space *mapping = sbi->longfile->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (IS_ERR(page))\n\t\treturn ERR_CAST(page);\n\tkmap(*p = page);\n\treturn (struct qnx6_long_filename *)(page_address(page) + offs);\n}",
          "includes": [
            "#include \"qnx6.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qnx6.h\"\n\nstatic struct qnx6_long_filename *qnx6_longname(struct super_block *sb,\n\t\t\t\t\t struct qnx6_long_dir_entry *de,\n\t\t\t\t\t struct page **p)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(sb);\n\tu32 s = fs32_to_cpu(sbi, de->de_long_inode); /* in block units */\n\tu32 n = s >> (PAGE_CACHE_SHIFT - sb->s_blocksize_bits); /* in pages */\n\t/* within page */\n\tu32 offs = (s << sb->s_blocksize_bits) & ~PAGE_CACHE_MASK;\n\tstruct address_space *mapping = sbi->longfile->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (IS_ERR(page))\n\t\treturn ERR_CAST(page);\n\tkmap(*p = page);\n\treturn (struct qnx6_long_filename *)(page_address(page) + offs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"invalid direntry size (%i).\\n\"",
            "de->de_size"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QNX6_SB",
          "args": [
            "s"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "QNX6_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "58-61",
          "snippet": "static inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic int qnx6_dir_longfilename(struct inode *inode,\n\t\t\tstruct qnx6_long_dir_entry *de,\n\t\t\tstruct dir_context *ctx,\n\t\t\tunsigned de_inode)\n{\n\tstruct qnx6_long_filename *lf;\n\tstruct super_block *s = inode->i_sb;\n\tstruct qnx6_sb_info *sbi = QNX6_SB(s);\n\tstruct page *page;\n\tint lf_size;\n\n\tif (de->de_size != 0xff) {\n\t\t/* error - long filename entries always have size 0xff\n\t\t   in direntry */\n\t\tpr_err(\"invalid direntry size (%i).\\n\", de->de_size);\n\t\treturn 0;\n\t}\n\tlf = qnx6_longname(s, de, &page);\n\tif (IS_ERR(lf)) {\n\t\tpr_err(\"Error reading longname\\n\");\n\t\treturn 0;\n\t}\n\n\tlf_size = fs16_to_cpu(sbi, lf->lf_size);\n\n\tif (lf_size > QNX6_LONG_NAME_MAX) {\n\t\tpr_debug(\"file %s\\n\", lf->lf_fname);\n\t\tpr_err(\"Filename too long (%i)\\n\", lf_size);\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\t/* calc & validate longfilename checksum\n\t   mmi 3g filesystem does not have that checksum */\n\tif (!test_opt(s, MMI_FS) && fs32_to_cpu(sbi, de->de_checksum) !=\n\t\t\tqnx6_lfile_checksum(lf->lf_fname, lf_size))\n\t\tpr_info(\"long filename checksum error.\\n\");\n\n\tpr_debug(\"qnx6_readdir:%.*s inode:%u\\n\",\n\t\t lf_size, lf->lf_fname, de_inode);\n\tif (!dir_emit(ctx, lf->lf_fname, lf_size, de_inode, DT_UNKNOWN)) {\n\t\tqnx6_put_page(page);\n\t\treturn 0;\n\t}\n\n\tqnx6_put_page(page);\n\t/* success */\n\treturn 1;\n}"
  },
  {
    "function_name": "qnx6_longname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "49-64",
    "snippet": "static struct qnx6_long_filename *qnx6_longname(struct super_block *sb,\n\t\t\t\t\t struct qnx6_long_dir_entry *de,\n\t\t\t\t\t struct page **p)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(sb);\n\tu32 s = fs32_to_cpu(sbi, de->de_long_inode); /* in block units */\n\tu32 n = s >> (PAGE_CACHE_SHIFT - sb->s_blocksize_bits); /* in pages */\n\t/* within page */\n\tu32 offs = (s << sb->s_blocksize_bits) & ~PAGE_CACHE_MASK;\n\tstruct address_space *mapping = sbi->longfile->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (IS_ERR(page))\n\t\treturn ERR_CAST(page);\n\tkmap(*p = page);\n\treturn (struct qnx6_long_filename *)(page_address(page) + offs);\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "*p = page"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "page"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "page"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_mapping_page",
          "args": [
            "mapping",
            "n",
            "NULL"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sbi",
            "de->de_long_inode"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "93-99",
          "snippet": "static inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline __u32 fs32_to_cpu(struct qnx6_sb_info *sbi, __fs32 n)\n{\n\tif (sbi->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "QNX6_SB",
          "args": [
            "sb"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "QNX6_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/qnx6.h",
          "lines": "58-61",
          "snippet": "static inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/qnx6_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/qnx6_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct qnx6_sb_info *QNX6_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic struct qnx6_long_filename *qnx6_longname(struct super_block *sb,\n\t\t\t\t\t struct qnx6_long_dir_entry *de,\n\t\t\t\t\t struct page **p)\n{\n\tstruct qnx6_sb_info *sbi = QNX6_SB(sb);\n\tu32 s = fs32_to_cpu(sbi, de->de_long_inode); /* in block units */\n\tu32 n = s >> (PAGE_CACHE_SHIFT - sb->s_blocksize_bits); /* in pages */\n\t/* within page */\n\tu32 offs = (s << sb->s_blocksize_bits) & ~PAGE_CACHE_MASK;\n\tstruct address_space *mapping = sbi->longfile->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (IS_ERR(page))\n\t\treturn ERR_CAST(page);\n\tkmap(*p = page);\n\treturn (struct qnx6_long_filename *)(page_address(page) + offs);\n}"
  },
  {
    "function_name": "last_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "40-47",
    "snippet": "static unsigned last_entry(struct inode *inode, unsigned long page_nr)\n{\n\tunsigned long last_byte = inode->i_size;\n\tlast_byte -= page_nr << PAGE_CACHE_SHIFT;\n\tif (last_byte > PAGE_CACHE_SIZE)\n\t\tlast_byte = PAGE_CACHE_SIZE;\n\treturn last_byte / QNX6_DIR_ENTRY_SIZE;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned last_entry(struct inode *inode, unsigned long page_nr)\n{\n\tunsigned long last_byte = inode->i_size;\n\tlast_byte -= page_nr << PAGE_CACHE_SHIFT;\n\tif (last_byte > PAGE_CACHE_SIZE)\n\t\tlast_byte = PAGE_CACHE_SIZE;\n\treturn last_byte / QNX6_DIR_ENTRY_SIZE;\n}"
  },
  {
    "function_name": "dir_pages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "35-38",
    "snippet": "static inline unsigned long dir_pages(struct inode *inode)\n{\n\treturn (inode->i_size+PAGE_CACHE_SIZE-1)>>PAGE_CACHE_SHIFT;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic inline unsigned long dir_pages(struct inode *inode)\n{\n\treturn (inode->i_size+PAGE_CACHE_SIZE-1)>>PAGE_CACHE_SHIFT;\n}"
  },
  {
    "function_name": "qnx6_get_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "26-33",
    "snippet": "static struct page *qnx6_get_page(struct inode *dir, unsigned long n)\n{\n\tstruct address_space *mapping = dir->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (!IS_ERR(page))\n\t\tkmap(page);\n\treturn page;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "page"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "page"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_mapping_page",
          "args": [
            "mapping",
            "n",
            "NULL"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic struct page *qnx6_get_page(struct inode *dir, unsigned long n)\n{\n\tstruct address_space *mapping = dir->i_mapping;\n\tstruct page *page = read_mapping_page(mapping, n, NULL);\n\tif (!IS_ERR(page))\n\t\tkmap(page);\n\treturn page;\n}"
  },
  {
    "function_name": "qnx6_lfile_checksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/qnx6/dir.c",
    "lines": "15-24",
    "snippet": "static unsigned qnx6_lfile_checksum(char *name, unsigned size)\n{\n\tunsigned crc = 0;\n\tchar *end = name + size;\n\twhile (name < end) {\n\t\tcrc = ((crc >> 1) + *(name++)) ^\n\t\t\t((crc & 0x00000001) ? 0x80000000 : 0);\n\t}\n\treturn crc;\n}",
    "includes": [
      "#include \"qnx6.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"qnx6.h\"\n\nstatic unsigned qnx6_lfile_checksum(char *name, unsigned size)\n{\n\tunsigned crc = 0;\n\tchar *end = name + size;\n\twhile (name < end) {\n\t\tcrc = ((crc >> 1) + *(name++)) ^\n\t\t\t((crc & 0x00000001) ? 0x80000000 : 0);\n\t}\n\treturn crc;\n}"
  }
]