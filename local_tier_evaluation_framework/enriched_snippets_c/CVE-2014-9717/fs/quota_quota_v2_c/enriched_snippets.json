[
  {
    "function_name": "exit_v2_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "335-339",
    "snippet": "static void __exit exit_v2_quota_format(void)\n{\n\tunregister_quota_format(&v2r0_quota_format);\n\tunregister_quota_format(&v2r1_quota_format);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct quota_format_type v2r0_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V0,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};",
      "static struct quota_format_type v2r1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V1,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_quota_format",
          "args": [
            "&v2r1_quota_format"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_quota_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "171-182",
          "snippet": "void unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static struct quota_format_type *quota_formats;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\n\nvoid unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic struct quota_format_type v2r0_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V0,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};\nstatic struct quota_format_type v2r1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V1,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};\n\nstatic void __exit exit_v2_quota_format(void)\n{\n\tunregister_quota_format(&v2r0_quota_format);\n\tunregister_quota_format(&v2r1_quota_format);\n}"
  },
  {
    "function_name": "init_v2_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "325-333",
    "snippet": "static int __init init_v2_quota_format(void)\n{\n\tint ret;\n\n\tret = register_quota_format(&v2r0_quota_format);\n\tif (ret)\n\t\treturn ret;\n\treturn register_quota_format(&v2r1_quota_format);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct quota_format_type v2r0_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V0,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};",
      "static struct quota_format_type v2r1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V1,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_quota_format",
          "args": [
            "&v2r1_quota_format"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_quota_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "171-182",
          "snippet": "void unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static struct quota_format_type *quota_formats;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\n\nvoid unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic struct quota_format_type v2r0_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V0,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};\nstatic struct quota_format_type v2r1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_V1,\n\t.qf_ops\t\t= &v2_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};\n\nstatic int __init init_v2_quota_format(void)\n{\n\tint ret;\n\n\tret = register_quota_format(&v2r0_quota_format);\n\tif (ret)\n\t\treturn ret;\n\treturn register_quota_format(&v2r1_quota_format);\n}"
  },
  {
    "function_name": "v2_free_file_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "297-301",
    "snippet": "static int v2_free_file_info(struct super_block *sb, int type)\n{\n\tkfree(sb_dqinfo(sb, type)->dqi_priv);\n\treturn 0;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sb_dqinfo(sb, type)->dqi_priv"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "sb",
            "type"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v2_free_file_info(struct super_block *sb, int type)\n{\n\tkfree(sb_dqinfo(sb, type)->dqi_priv);\n\treturn 0;\n}"
  },
  {
    "function_name": "v2_release_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "292-295",
    "snippet": "static int v2_release_dquot(struct dquot *dquot)\n{\n\treturn qtree_release_dquot(sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv, dquot);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qtree_release_dquot",
          "args": [
            "sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv",
            "dquot"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "qtree_release_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_tree.c",
          "lines": "656-662",
          "snippet": "int qtree_release_dquot(struct qtree_mem_dqinfo *info, struct dquot *dquot)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) &&\n\t    !(dquot->dq_dqb.dqb_curinodes | dquot->dq_dqb.dqb_curspace))\n\t\treturn qtree_delete_dquot(info, dquot);\n\treturn 0;\n}",
          "includes": [
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nint qtree_release_dquot(struct qtree_mem_dqinfo *info, struct dquot *dquot)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) &&\n\t    !(dquot->dq_dqb.dqb_curinodes | dquot->dq_dqb.dqb_curspace))\n\t\treturn qtree_delete_dquot(info, dquot);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic int v2_release_dquot(struct dquot *dquot)\n{\n\treturn qtree_release_dquot(sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv, dquot);\n}"
  },
  {
    "function_name": "v2_write_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "287-290",
    "snippet": "static int v2_write_dquot(struct dquot *dquot)\n{\n\treturn qtree_write_dquot(sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv, dquot);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qtree_write_dquot",
          "args": [
            "sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv",
            "dquot"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "qtree_write_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_tree.c",
          "lines": "359-395",
          "snippet": "int qtree_write_dquot(struct qtree_mem_dqinfo *info, struct dquot *dquot)\n{\n\tint type = dquot->dq_id.type;\n\tstruct super_block *sb = dquot->dq_sb;\n\tssize_t ret;\n\tchar *ddquot = getdqbuf(info->dqi_entry_size);\n\n\tif (!ddquot)\n\t\treturn -ENOMEM;\n\n\t/* dq_off is guarded by dqio_mutex */\n\tif (!dquot->dq_off) {\n\t\tret = dq_insert_tree(info, dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(sb, \"Error %zd occurred while creating \"\n\t\t\t\t    \"quota\", ret);\n\t\t\tkfree(ddquot);\n\t\t\treturn ret;\n\t\t}\n\t}\n\tspin_lock(&dq_data_lock);\n\tinfo->dqi_ops->mem2disk_dqblk(ddquot, dquot);\n\tspin_unlock(&dq_data_lock);\n\tret = sb->s_op->quota_write(sb, type, ddquot, info->dqi_entry_size,\n\t\t\t\t    dquot->dq_off);\n\tif (ret != info->dqi_entry_size) {\n\t\tquota_error(sb, \"dquota write failed\");\n\t\tif (ret >= 0)\n\t\t\tret = -ENOSPC;\n\t} else {\n\t\tret = 0;\n\t}\n\tdqstats_inc(DQST_WRITES);\n\tkfree(ddquot);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nint qtree_write_dquot(struct qtree_mem_dqinfo *info, struct dquot *dquot)\n{\n\tint type = dquot->dq_id.type;\n\tstruct super_block *sb = dquot->dq_sb;\n\tssize_t ret;\n\tchar *ddquot = getdqbuf(info->dqi_entry_size);\n\n\tif (!ddquot)\n\t\treturn -ENOMEM;\n\n\t/* dq_off is guarded by dqio_mutex */\n\tif (!dquot->dq_off) {\n\t\tret = dq_insert_tree(info, dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(sb, \"Error %zd occurred while creating \"\n\t\t\t\t    \"quota\", ret);\n\t\t\tkfree(ddquot);\n\t\t\treturn ret;\n\t\t}\n\t}\n\tspin_lock(&dq_data_lock);\n\tinfo->dqi_ops->mem2disk_dqblk(ddquot, dquot);\n\tspin_unlock(&dq_data_lock);\n\tret = sb->s_op->quota_write(sb, type, ddquot, info->dqi_entry_size,\n\t\t\t\t    dquot->dq_off);\n\tif (ret != info->dqi_entry_size) {\n\t\tquota_error(sb, \"dquota write failed\");\n\t\tif (ret >= 0)\n\t\t\tret = -ENOSPC;\n\t} else {\n\t\tret = 0;\n\t}\n\tdqstats_inc(DQST_WRITES);\n\tkfree(ddquot);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic int v2_write_dquot(struct dquot *dquot)\n{\n\treturn qtree_write_dquot(sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv, dquot);\n}"
  },
  {
    "function_name": "v2_read_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "282-285",
    "snippet": "static int v2_read_dquot(struct dquot *dquot)\n{\n\treturn qtree_read_dquot(sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv, dquot);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qtree_read_dquot",
          "args": [
            "sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv",
            "dquot"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "qtree_read_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_tree.c",
          "lines": "592-651",
          "snippet": "int qtree_read_dquot(struct qtree_mem_dqinfo *info, struct dquot *dquot)\n{\n\tint type = dquot->dq_id.type;\n\tstruct super_block *sb = dquot->dq_sb;\n\tloff_t offset;\n\tchar *ddquot;\n\tint ret = 0;\n\n#ifdef __QUOTA_QT_PARANOIA\n\t/* Invalidated quota? */\n\tif (!sb_dqopt(dquot->dq_sb)->files[type]) {\n\t\tquota_error(sb, \"Quota invalidated while reading!\");\n\t\treturn -EIO;\n\t}\n#endif\n\t/* Do we know offset of the dquot entry in the quota file? */\n\tif (!dquot->dq_off) {\n\t\toffset = find_dqentry(info, dquot);\n\t\tif (offset <= 0) {\t/* Entry not present? */\n\t\t\tif (offset < 0)\n\t\t\t\tquota_error(sb,\"Can't read quota structure \"\n\t\t\t\t\t    \"for id %u\",\n\t\t\t\t\t    from_kqid(&init_user_ns,\n\t\t\t\t\t\t      dquot->dq_id));\n\t\t\tdquot->dq_off = 0;\n\t\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\t\t\tmemset(&dquot->dq_dqb, 0, sizeof(struct mem_dqblk));\n\t\t\tret = offset;\n\t\t\tgoto out;\n\t\t}\n\t\tdquot->dq_off = offset;\n\t}\n\tddquot = getdqbuf(info->dqi_entry_size);\n\tif (!ddquot)\n\t\treturn -ENOMEM;\n\tret = sb->s_op->quota_read(sb, type, ddquot, info->dqi_entry_size,\n\t\t\t\t   dquot->dq_off);\n\tif (ret != info->dqi_entry_size) {\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tquota_error(sb, \"Error while reading quota structure for id %u\",\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\t\tmemset(&dquot->dq_dqb, 0, sizeof(struct mem_dqblk));\n\t\tkfree(ddquot);\n\t\tgoto out;\n\t}\n\tspin_lock(&dq_data_lock);\n\tinfo->dqi_ops->disk2mem_dqblk(dquot, ddquot);\n\tif (!dquot->dq_dqb.dqb_bhardlimit &&\n\t    !dquot->dq_dqb.dqb_bsoftlimit &&\n\t    !dquot->dq_dqb.dqb_ihardlimit &&\n\t    !dquot->dq_dqb.dqb_isoftlimit)\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tspin_unlock(&dq_data_lock);\n\tkfree(ddquot);\nout:\n\tdqstats_inc(DQST_READS);\n\treturn ret;\n}",
          "includes": [
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define __QUOTA_QT_PARANOIA"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define __QUOTA_QT_PARANOIA\n\nint qtree_read_dquot(struct qtree_mem_dqinfo *info, struct dquot *dquot)\n{\n\tint type = dquot->dq_id.type;\n\tstruct super_block *sb = dquot->dq_sb;\n\tloff_t offset;\n\tchar *ddquot;\n\tint ret = 0;\n\n#ifdef __QUOTA_QT_PARANOIA\n\t/* Invalidated quota? */\n\tif (!sb_dqopt(dquot->dq_sb)->files[type]) {\n\t\tquota_error(sb, \"Quota invalidated while reading!\");\n\t\treturn -EIO;\n\t}\n#endif\n\t/* Do we know offset of the dquot entry in the quota file? */\n\tif (!dquot->dq_off) {\n\t\toffset = find_dqentry(info, dquot);\n\t\tif (offset <= 0) {\t/* Entry not present? */\n\t\t\tif (offset < 0)\n\t\t\t\tquota_error(sb,\"Can't read quota structure \"\n\t\t\t\t\t    \"for id %u\",\n\t\t\t\t\t    from_kqid(&init_user_ns,\n\t\t\t\t\t\t      dquot->dq_id));\n\t\t\tdquot->dq_off = 0;\n\t\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\t\t\tmemset(&dquot->dq_dqb, 0, sizeof(struct mem_dqblk));\n\t\t\tret = offset;\n\t\t\tgoto out;\n\t\t}\n\t\tdquot->dq_off = offset;\n\t}\n\tddquot = getdqbuf(info->dqi_entry_size);\n\tif (!ddquot)\n\t\treturn -ENOMEM;\n\tret = sb->s_op->quota_read(sb, type, ddquot, info->dqi_entry_size,\n\t\t\t\t   dquot->dq_off);\n\tif (ret != info->dqi_entry_size) {\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tquota_error(sb, \"Error while reading quota structure for id %u\",\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\t\tmemset(&dquot->dq_dqb, 0, sizeof(struct mem_dqblk));\n\t\tkfree(ddquot);\n\t\tgoto out;\n\t}\n\tspin_lock(&dq_data_lock);\n\tinfo->dqi_ops->disk2mem_dqblk(dquot, ddquot);\n\tif (!dquot->dq_dqb.dqb_bhardlimit &&\n\t    !dquot->dq_dqb.dqb_bsoftlimit &&\n\t    !dquot->dq_dqb.dqb_ihardlimit &&\n\t    !dquot->dq_dqb.dqb_isoftlimit)\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tspin_unlock(&dq_data_lock);\n\tkfree(ddquot);\nout:\n\tdqstats_inc(DQST_READS);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic int v2_read_dquot(struct dquot *dquot)\n{\n\treturn qtree_read_dquot(sb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv, dquot);\n}"
  },
  {
    "function_name": "v2r1_is_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "269-280",
    "snippet": "static int v2r1_is_id(void *dp, struct dquot *dquot)\n{\n\tstruct v2r1_disk_dqblk *d = dp;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\tif (qtree_entry_unused(info, dp))\n\t\treturn 0;\n\treturn qid_eq(make_kqid(&init_user_ns, dquot->dq_id.type,\n\t\t\t\tle32_to_cpu(d->dqb_id)),\n\t\t      dquot->dq_id);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r0_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r1_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qid_eq",
          "args": [
            "make_kqid(&init_user_ns, dquot->dq_id.type,\n\t\t\t\tle32_to_cpu(d->dqb_id))",
            "dquot->dq_id"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "qid_eq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "12-26",
          "snippet": "bool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "&init_user_ns",
            "dquot->dq_id.type",
            "le32_to_cpu(d->dqb_id)"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "d->dqb_id"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qtree_entry_unused",
          "args": [
            "info",
            "dp"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "qtree_entry_unused",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_tree.c",
          "lines": "206-214",
          "snippet": "int qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nint qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r0_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r1_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic int v2r1_is_id(void *dp, struct dquot *dquot)\n{\n\tstruct v2r1_disk_dqblk *d = dp;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\tif (qtree_entry_unused(info, dp))\n\t\treturn 0;\n\treturn qid_eq(make_kqid(&init_user_ns, dquot->dq_id.type,\n\t\t\t\tle32_to_cpu(d->dqb_id)),\n\t\t      dquot->dq_id);\n}"
  },
  {
    "function_name": "v2r1_mem2diskdqb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "249-267",
    "snippet": "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot)\n{\n\tstruct v2r1_disk_dqblk *d = dp;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\td->dqb_ihardlimit = cpu_to_le64(m->dqb_ihardlimit);\n\td->dqb_isoftlimit = cpu_to_le64(m->dqb_isoftlimit);\n\td->dqb_curinodes = cpu_to_le64(m->dqb_curinodes);\n\td->dqb_itime = cpu_to_le64(m->dqb_itime);\n\td->dqb_bhardlimit = cpu_to_le64(v2_stoqb(m->dqb_bhardlimit));\n\td->dqb_bsoftlimit = cpu_to_le64(v2_stoqb(m->dqb_bsoftlimit));\n\td->dqb_curspace = cpu_to_le64(m->dqb_curspace);\n\td->dqb_btime = cpu_to_le64(m->dqb_btime);\n\td->dqb_id = cpu_to_le32(from_kqid(&init_user_ns, dquot->dq_id));\n\tif (qtree_entry_unused(info, dp))\n\t\td->dqb_itime = cpu_to_le64(1);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r0_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r1_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "1"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qtree_entry_unused",
          "args": [
            "info",
            "dp"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "qtree_entry_unused",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_tree.c",
          "lines": "206-214",
          "snippet": "int qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nint qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "from_kqid(&init_user_ns, dquot->dq_id)"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kqid",
          "args": [
            "&init_user_ns",
            "dquot->dq_id"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "from_kqid_munged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "100-112",
          "snippet": "qid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_btime"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_curspace"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "v2_stoqb(m->dqb_bsoftlimit)"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v2_stoqb",
          "args": [
            "m->dqb_bsoftlimit"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "v2_stoqb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
          "lines": "48-51",
          "snippet": "static inline qsize_t v2_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}",
          "includes": [
            "#include \"quotaio_v2.h\"",
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)",
            "#define QUOTABLOCK_BITS 10"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v2_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "v2_stoqb(m->dqb_bhardlimit)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_itime"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_curinodes"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_isoftlimit"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_ihardlimit"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r0_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r1_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot)\n{\n\tstruct v2r1_disk_dqblk *d = dp;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\td->dqb_ihardlimit = cpu_to_le64(m->dqb_ihardlimit);\n\td->dqb_isoftlimit = cpu_to_le64(m->dqb_isoftlimit);\n\td->dqb_curinodes = cpu_to_le64(m->dqb_curinodes);\n\td->dqb_itime = cpu_to_le64(m->dqb_itime);\n\td->dqb_bhardlimit = cpu_to_le64(v2_stoqb(m->dqb_bhardlimit));\n\td->dqb_bsoftlimit = cpu_to_le64(v2_stoqb(m->dqb_bsoftlimit));\n\td->dqb_curspace = cpu_to_le64(m->dqb_curspace);\n\td->dqb_btime = cpu_to_le64(m->dqb_btime);\n\td->dqb_id = cpu_to_le32(from_kqid(&init_user_ns, dquot->dq_id));\n\tif (qtree_entry_unused(info, dp))\n\t\td->dqb_itime = cpu_to_le64(1);\n}"
  },
  {
    "function_name": "v2r1_disk2memdqb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "229-247",
    "snippet": "static void v2r1_disk2memdqb(struct dquot *dquot, void *dp)\n{\n\tstruct v2r1_disk_dqblk *d = dp, empty;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\n\tm->dqb_ihardlimit = le64_to_cpu(d->dqb_ihardlimit);\n\tm->dqb_isoftlimit = le64_to_cpu(d->dqb_isoftlimit);\n\tm->dqb_curinodes = le64_to_cpu(d->dqb_curinodes);\n\tm->dqb_itime = le64_to_cpu(d->dqb_itime);\n\tm->dqb_bhardlimit = v2_qbtos(le64_to_cpu(d->dqb_bhardlimit));\n\tm->dqb_bsoftlimit = v2_qbtos(le64_to_cpu(d->dqb_bsoftlimit));\n\tm->dqb_curspace = le64_to_cpu(d->dqb_curspace);\n\tm->dqb_btime = le64_to_cpu(d->dqb_btime);\n\t/* We need to escape back all-zero structure */\n\tmemset(&empty, 0, sizeof(struct v2r1_disk_dqblk));\n\tempty.dqb_itime = cpu_to_le64(1);\n\tif (!memcmp(&empty, dp, sizeof(struct v2r1_disk_dqblk)))\n\t\tm->dqb_itime = 0;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r0_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r1_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&empty",
            "dp",
            "sizeof(struct v2r1_disk_dqblk)"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "1"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&empty",
            "0",
            "sizeof(struct v2r1_disk_dqblk)"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "d->dqb_btime"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "v2_qbtos",
          "args": [
            "le64_to_cpu(d->dqb_bsoftlimit)"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "v2_qbtos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
          "lines": "53-56",
          "snippet": "static inline qsize_t v2_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}",
          "includes": [
            "#include \"quotaio_v2.h\"",
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define QUOTABLOCK_BITS 10"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v2_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r0_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r1_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic void v2r1_disk2memdqb(struct dquot *dquot, void *dp)\n{\n\tstruct v2r1_disk_dqblk *d = dp, empty;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\n\tm->dqb_ihardlimit = le64_to_cpu(d->dqb_ihardlimit);\n\tm->dqb_isoftlimit = le64_to_cpu(d->dqb_isoftlimit);\n\tm->dqb_curinodes = le64_to_cpu(d->dqb_curinodes);\n\tm->dqb_itime = le64_to_cpu(d->dqb_itime);\n\tm->dqb_bhardlimit = v2_qbtos(le64_to_cpu(d->dqb_bhardlimit));\n\tm->dqb_bsoftlimit = v2_qbtos(le64_to_cpu(d->dqb_bsoftlimit));\n\tm->dqb_curspace = le64_to_cpu(d->dqb_curspace);\n\tm->dqb_btime = le64_to_cpu(d->dqb_btime);\n\t/* We need to escape back all-zero structure */\n\tmemset(&empty, 0, sizeof(struct v2r1_disk_dqblk));\n\tempty.dqb_itime = cpu_to_le64(1);\n\tif (!memcmp(&empty, dp, sizeof(struct v2r1_disk_dqblk)))\n\t\tm->dqb_itime = 0;\n}"
  },
  {
    "function_name": "v2r0_is_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "216-227",
    "snippet": "static int v2r0_is_id(void *dp, struct dquot *dquot)\n{\n\tstruct v2r0_disk_dqblk *d = dp;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\tif (qtree_entry_unused(info, dp))\n\t\treturn 0;\n\treturn qid_eq(make_kqid(&init_user_ns, dquot->dq_id.type,\n\t\t\t\tle32_to_cpu(d->dqb_id)),\n\t\t      dquot->dq_id);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r0_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r1_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qid_eq",
          "args": [
            "make_kqid(&init_user_ns, dquot->dq_id.type,\n\t\t\t\tle32_to_cpu(d->dqb_id))",
            "dquot->dq_id"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "qid_eq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "12-26",
          "snippet": "bool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "&init_user_ns",
            "dquot->dq_id.type",
            "le32_to_cpu(d->dqb_id)"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "d->dqb_id"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qtree_entry_unused",
          "args": [
            "info",
            "dp"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "qtree_entry_unused",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_tree.c",
          "lines": "206-214",
          "snippet": "int qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nint qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r0_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r1_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic int v2r0_is_id(void *dp, struct dquot *dquot)\n{\n\tstruct v2r0_disk_dqblk *d = dp;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\tif (qtree_entry_unused(info, dp))\n\t\treturn 0;\n\treturn qid_eq(make_kqid(&init_user_ns, dquot->dq_id.type,\n\t\t\t\tle32_to_cpu(d->dqb_id)),\n\t\t      dquot->dq_id);\n}"
  },
  {
    "function_name": "v2r0_mem2diskdqb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "196-214",
    "snippet": "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot)\n{\n\tstruct v2r0_disk_dqblk *d = dp;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\td->dqb_ihardlimit = cpu_to_le32(m->dqb_ihardlimit);\n\td->dqb_isoftlimit = cpu_to_le32(m->dqb_isoftlimit);\n\td->dqb_curinodes = cpu_to_le32(m->dqb_curinodes);\n\td->dqb_itime = cpu_to_le64(m->dqb_itime);\n\td->dqb_bhardlimit = cpu_to_le32(v2_stoqb(m->dqb_bhardlimit));\n\td->dqb_bsoftlimit = cpu_to_le32(v2_stoqb(m->dqb_bsoftlimit));\n\td->dqb_curspace = cpu_to_le64(m->dqb_curspace);\n\td->dqb_btime = cpu_to_le64(m->dqb_btime);\n\td->dqb_id = cpu_to_le32(from_kqid(&init_user_ns, dquot->dq_id));\n\tif (qtree_entry_unused(info, dp))\n\t\td->dqb_itime = cpu_to_le64(1);\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r0_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r1_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "1"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qtree_entry_unused",
          "args": [
            "info",
            "dp"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "qtree_entry_unused",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_tree.c",
          "lines": "206-214",
          "snippet": "int qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nint qtree_entry_unused(struct qtree_mem_dqinfo *info, char *disk)\n{\n\tint i;\n\n\tfor (i = 0; i < info->dqi_entry_size; i++)\n\t\tif (disk[i])\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "from_kqid(&init_user_ns, dquot->dq_id)"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kqid",
          "args": [
            "&init_user_ns",
            "dquot->dq_id"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "from_kqid_munged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "100-112",
          "snippet": "qid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_btime"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_curspace"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "v2_stoqb(m->dqb_bsoftlimit)"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v2_stoqb",
          "args": [
            "m->dqb_bsoftlimit"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "v2_stoqb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
          "lines": "48-51",
          "snippet": "static inline qsize_t v2_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}",
          "includes": [
            "#include \"quotaio_v2.h\"",
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)",
            "#define QUOTABLOCK_BITS 10"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v2_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "v2_stoqb(m->dqb_bhardlimit)"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "m->dqb_itime"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "m->dqb_curinodes"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "m->dqb_isoftlimit"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "m->dqb_ihardlimit"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r0_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r1_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot)\n{\n\tstruct v2r0_disk_dqblk *d = dp;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\tstruct qtree_mem_dqinfo *info =\n\t\t\tsb_dqinfo(dquot->dq_sb, dquot->dq_id.type)->dqi_priv;\n\n\td->dqb_ihardlimit = cpu_to_le32(m->dqb_ihardlimit);\n\td->dqb_isoftlimit = cpu_to_le32(m->dqb_isoftlimit);\n\td->dqb_curinodes = cpu_to_le32(m->dqb_curinodes);\n\td->dqb_itime = cpu_to_le64(m->dqb_itime);\n\td->dqb_bhardlimit = cpu_to_le32(v2_stoqb(m->dqb_bhardlimit));\n\td->dqb_bsoftlimit = cpu_to_le32(v2_stoqb(m->dqb_bsoftlimit));\n\td->dqb_curspace = cpu_to_le64(m->dqb_curspace);\n\td->dqb_btime = cpu_to_le64(m->dqb_btime);\n\td->dqb_id = cpu_to_le32(from_kqid(&init_user_ns, dquot->dq_id));\n\tif (qtree_entry_unused(info, dp))\n\t\td->dqb_itime = cpu_to_le64(1);\n}"
  },
  {
    "function_name": "v2r0_disk2memdqb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "176-194",
    "snippet": "static void v2r0_disk2memdqb(struct dquot *dquot, void *dp)\n{\n\tstruct v2r0_disk_dqblk *d = dp, empty;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\n\tm->dqb_ihardlimit = le32_to_cpu(d->dqb_ihardlimit);\n\tm->dqb_isoftlimit = le32_to_cpu(d->dqb_isoftlimit);\n\tm->dqb_curinodes = le32_to_cpu(d->dqb_curinodes);\n\tm->dqb_itime = le64_to_cpu(d->dqb_itime);\n\tm->dqb_bhardlimit = v2_qbtos(le32_to_cpu(d->dqb_bhardlimit));\n\tm->dqb_bsoftlimit = v2_qbtos(le32_to_cpu(d->dqb_bsoftlimit));\n\tm->dqb_curspace = le64_to_cpu(d->dqb_curspace);\n\tm->dqb_btime = le64_to_cpu(d->dqb_btime);\n\t/* We need to escape back all-zero structure */\n\tmemset(&empty, 0, sizeof(struct v2r0_disk_dqblk));\n\tempty.dqb_itime = cpu_to_le64(1);\n\tif (!memcmp(&empty, dp, sizeof(struct v2r0_disk_dqblk)))\n\t\tm->dqb_itime = 0;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r0_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r0_is_id(void *dp, struct dquot *dquot);",
      "static void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);",
      "static void v2r1_disk2memdqb(struct dquot *dquot, void *dp);",
      "static int v2r1_is_id(void *dp, struct dquot *dquot);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&empty",
            "dp",
            "sizeof(struct v2r0_disk_dqblk)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "1"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&empty",
            "0",
            "sizeof(struct v2r0_disk_dqblk)"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "d->dqb_btime"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "v2_qbtos",
          "args": [
            "le32_to_cpu(d->dqb_bsoftlimit)"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "v2_qbtos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
          "lines": "53-56",
          "snippet": "static inline qsize_t v2_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}",
          "includes": [
            "#include \"quotaio_v2.h\"",
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define QUOTABLOCK_BITS 10"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v2_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "d->dqb_bsoftlimit"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v2r0_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r0_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r0_is_id(void *dp, struct dquot *dquot);\nstatic void v2r1_mem2diskdqb(void *dp, struct dquot *dquot);\nstatic void v2r1_disk2memdqb(struct dquot *dquot, void *dp);\nstatic int v2r1_is_id(void *dp, struct dquot *dquot);\n\nstatic void v2r0_disk2memdqb(struct dquot *dquot, void *dp)\n{\n\tstruct v2r0_disk_dqblk *d = dp, empty;\n\tstruct mem_dqblk *m = &dquot->dq_dqb;\n\n\tm->dqb_ihardlimit = le32_to_cpu(d->dqb_ihardlimit);\n\tm->dqb_isoftlimit = le32_to_cpu(d->dqb_isoftlimit);\n\tm->dqb_curinodes = le32_to_cpu(d->dqb_curinodes);\n\tm->dqb_itime = le64_to_cpu(d->dqb_itime);\n\tm->dqb_bhardlimit = v2_qbtos(le32_to_cpu(d->dqb_bhardlimit));\n\tm->dqb_bsoftlimit = v2_qbtos(le32_to_cpu(d->dqb_bsoftlimit));\n\tm->dqb_curspace = le64_to_cpu(d->dqb_curspace);\n\tm->dqb_btime = le64_to_cpu(d->dqb_btime);\n\t/* We need to escape back all-zero structure */\n\tmemset(&empty, 0, sizeof(struct v2r0_disk_dqblk));\n\tempty.dqb_itime = cpu_to_le64(1);\n\tif (!memcmp(&empty, dp, sizeof(struct v2r0_disk_dqblk)))\n\t\tm->dqb_itime = 0;\n}"
  },
  {
    "function_name": "v2_write_file_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "150-174",
    "snippet": "static int v2_write_file_info(struct super_block *sb, int type)\n{\n\tstruct v2_disk_dqinfo dinfo;\n\tstruct mem_dqinfo *info = sb_dqinfo(sb, type);\n\tstruct qtree_mem_dqinfo *qinfo = info->dqi_priv;\n\tssize_t size;\n\n\tspin_lock(&dq_data_lock);\n\tinfo->dqi_flags &= ~DQF_INFO_DIRTY;\n\tdinfo.dqi_bgrace = cpu_to_le32(info->dqi_bgrace);\n\tdinfo.dqi_igrace = cpu_to_le32(info->dqi_igrace);\n\t/* No flags currently supported */\n\tdinfo.dqi_flags = cpu_to_le32(0);\n\tspin_unlock(&dq_data_lock);\n\tdinfo.dqi_blocks = cpu_to_le32(qinfo->dqi_blocks);\n\tdinfo.dqi_free_blk = cpu_to_le32(qinfo->dqi_free_blk);\n\tdinfo.dqi_free_entry = cpu_to_le32(qinfo->dqi_free_entry);\n\tsize = sb->s_op->quota_write(sb, type, (char *)&dinfo,\n\t       sizeof(struct v2_disk_dqinfo), V2_DQINFOOFF);\n\tif (size != sizeof(struct v2_disk_dqinfo)) {\n\t\tquota_error(sb, \"Can't write info structure\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quota_error",
          "args": [
            "sb",
            "\"Can't write info structure\""
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_op->quota_write",
          "args": [
            "sb",
            "type",
            "(char *)&dinfo",
            "sizeof(struct v2_disk_dqinfo)",
            "V2_DQINFOOFF"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "qinfo->dqi_free_entry"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "qinfo->dqi_free_blk"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "qinfo->dqi_blocks"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "0"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "info->dqi_igrace"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "info->dqi_bgrace"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "sb",
            "type"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v2_write_file_info(struct super_block *sb, int type)\n{\n\tstruct v2_disk_dqinfo dinfo;\n\tstruct mem_dqinfo *info = sb_dqinfo(sb, type);\n\tstruct qtree_mem_dqinfo *qinfo = info->dqi_priv;\n\tssize_t size;\n\n\tspin_lock(&dq_data_lock);\n\tinfo->dqi_flags &= ~DQF_INFO_DIRTY;\n\tdinfo.dqi_bgrace = cpu_to_le32(info->dqi_bgrace);\n\tdinfo.dqi_igrace = cpu_to_le32(info->dqi_igrace);\n\t/* No flags currently supported */\n\tdinfo.dqi_flags = cpu_to_le32(0);\n\tspin_unlock(&dq_data_lock);\n\tdinfo.dqi_blocks = cpu_to_le32(qinfo->dqi_blocks);\n\tdinfo.dqi_free_blk = cpu_to_le32(qinfo->dqi_free_blk);\n\tdinfo.dqi_free_entry = cpu_to_le32(qinfo->dqi_free_entry);\n\tsize = sb->s_op->quota_write(sb, type, (char *)&dinfo,\n\t       sizeof(struct v2_disk_dqinfo), V2_DQINFOOFF);\n\tif (size != sizeof(struct v2_disk_dqinfo)) {\n\t\tquota_error(sb, \"Can't write info structure\");\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "v2_read_file_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "89-147",
    "snippet": "static int v2_read_file_info(struct super_block *sb, int type)\n{\n\tstruct v2_disk_dqinfo dinfo;\n\tstruct v2_disk_dqheader dqhead;\n\tstruct mem_dqinfo *info = sb_dqinfo(sb, type);\n\tstruct qtree_mem_dqinfo *qinfo;\n\tssize_t size;\n\tunsigned int version;\n\n\tif (!v2_read_header(sb, type, &dqhead))\n\t\treturn -1;\n\tversion = le32_to_cpu(dqhead.dqh_version);\n\tif ((info->dqi_fmt_id == QFMT_VFS_V0 && version != 0) ||\n\t    (info->dqi_fmt_id == QFMT_VFS_V1 && version != 1))\n\t\treturn -1;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)&dinfo,\n\t       sizeof(struct v2_disk_dqinfo), V2_DQINFOOFF);\n\tif (size != sizeof(struct v2_disk_dqinfo)) {\n\t\tquota_error(sb, \"Can't read info structure\");\n\t\treturn -1;\n\t}\n\tinfo->dqi_priv = kmalloc(sizeof(struct qtree_mem_dqinfo), GFP_NOFS);\n\tif (!info->dqi_priv) {\n\t\tprintk(KERN_WARNING\n\t\t       \"Not enough memory for quota information structure.\\n\");\n\t\treturn -ENOMEM;\n\t}\n\tqinfo = info->dqi_priv;\n\tif (version == 0) {\n\t\t/* limits are stored as unsigned 32-bit data */\n\t\tinfo->dqi_max_spc_limit = 0xffffffffULL << QUOTABLOCK_BITS;\n\t\tinfo->dqi_max_ino_limit = 0xffffffff;\n\t} else {\n\t\t/* used space is stored as unsigned 64-bit value in bytes */\n\t\tinfo->dqi_max_spc_limit = 0xffffffffffffffffULL; /* 2^64-1 */\n\t\tinfo->dqi_max_ino_limit = 0xffffffffffffffffULL;\n\t}\n\tinfo->dqi_bgrace = le32_to_cpu(dinfo.dqi_bgrace);\n\tinfo->dqi_igrace = le32_to_cpu(dinfo.dqi_igrace);\n\t/* No flags currently supported */\n\tinfo->dqi_flags = 0;\n\tqinfo->dqi_sb = sb;\n\tqinfo->dqi_type = type;\n\tqinfo->dqi_blocks = le32_to_cpu(dinfo.dqi_blocks);\n\tqinfo->dqi_free_blk = le32_to_cpu(dinfo.dqi_free_blk);\n\tqinfo->dqi_free_entry = le32_to_cpu(dinfo.dqi_free_entry);\n\tqinfo->dqi_blocksize_bits = V2_DQBLKSIZE_BITS;\n\tqinfo->dqi_usable_bs = 1 << V2_DQBLKSIZE_BITS;\n\tqinfo->dqi_qtree_depth = qtree_depth(qinfo);\n\tif (version == 0) {\n\t\tqinfo->dqi_entry_size = sizeof(struct v2r0_disk_dqblk);\n\t\tqinfo->dqi_ops = &v2r0_qtree_ops;\n\t} else {\n\t\tqinfo->dqi_entry_size = sizeof(struct v2r1_disk_dqblk);\n\t\tqinfo->dqi_ops = &v2r1_qtree_ops;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define QUOTABLOCK_BITS 10"
    ],
    "globals_used": [
      "static struct qtree_fmt_operations v2r0_qtree_ops = {\n\t.mem2disk_dqblk = v2r0_mem2diskdqb,\n\t.disk2mem_dqblk = v2r0_disk2memdqb,\n\t.is_id = v2r0_is_id,\n};",
      "static struct qtree_fmt_operations v2r1_qtree_ops = {\n\t.mem2disk_dqblk = v2r1_mem2diskdqb,\n\t.disk2mem_dqblk = v2r1_disk2memdqb,\n\t.is_id = v2r1_is_id,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qtree_depth",
          "args": [
            "qinfo"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "dinfo.dqi_free_entry"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING\n\t\t       \"Not enough memory for quota information structure.\\n\""
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(struct qtree_mem_dqinfo)",
            "GFP_NOFS"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_error",
          "args": [
            "sb",
            "\"Can't read info structure\""
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_op->quota_read",
          "args": [
            "sb",
            "type",
            "(char *)&dinfo",
            "sizeof(struct v2_disk_dqinfo)",
            "V2_DQINFOOFF"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v2_read_header",
          "args": [
            "sb",
            "type",
            "&dqhead"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "v2_read_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
          "lines": "58-71",
          "snippet": "static int v2_read_header(struct super_block *sb, int type,\n\t\t\t  struct v2_disk_dqheader *dqhead)\n{\n\tssize_t size;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader)) {\n\t\tquota_error(sb, \"Failed header read: expected=%zd got=%zd\",\n\t\t\t    sizeof(struct v2_disk_dqheader), size);\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"quotaio_v2.h\"",
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v2_read_header(struct super_block *sb, int type,\n\t\t\t  struct v2_disk_dqheader *dqhead)\n{\n\tssize_t size;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader)) {\n\t\tquota_error(sb, \"Failed header read: expected=%zd got=%zd\",\n\t\t\t    sizeof(struct v2_disk_dqheader), size);\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqinfo",
          "args": [
            "sb",
            "type"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_BITS 10\n\nstatic struct qtree_fmt_operations v2r0_qtree_ops = {\n\t.mem2disk_dqblk = v2r0_mem2diskdqb,\n\t.disk2mem_dqblk = v2r0_disk2memdqb,\n\t.is_id = v2r0_is_id,\n};\nstatic struct qtree_fmt_operations v2r1_qtree_ops = {\n\t.mem2disk_dqblk = v2r1_mem2diskdqb,\n\t.disk2mem_dqblk = v2r1_disk2memdqb,\n\t.is_id = v2r1_is_id,\n};\n\nstatic int v2_read_file_info(struct super_block *sb, int type)\n{\n\tstruct v2_disk_dqinfo dinfo;\n\tstruct v2_disk_dqheader dqhead;\n\tstruct mem_dqinfo *info = sb_dqinfo(sb, type);\n\tstruct qtree_mem_dqinfo *qinfo;\n\tssize_t size;\n\tunsigned int version;\n\n\tif (!v2_read_header(sb, type, &dqhead))\n\t\treturn -1;\n\tversion = le32_to_cpu(dqhead.dqh_version);\n\tif ((info->dqi_fmt_id == QFMT_VFS_V0 && version != 0) ||\n\t    (info->dqi_fmt_id == QFMT_VFS_V1 && version != 1))\n\t\treturn -1;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)&dinfo,\n\t       sizeof(struct v2_disk_dqinfo), V2_DQINFOOFF);\n\tif (size != sizeof(struct v2_disk_dqinfo)) {\n\t\tquota_error(sb, \"Can't read info structure\");\n\t\treturn -1;\n\t}\n\tinfo->dqi_priv = kmalloc(sizeof(struct qtree_mem_dqinfo), GFP_NOFS);\n\tif (!info->dqi_priv) {\n\t\tprintk(KERN_WARNING\n\t\t       \"Not enough memory for quota information structure.\\n\");\n\t\treturn -ENOMEM;\n\t}\n\tqinfo = info->dqi_priv;\n\tif (version == 0) {\n\t\t/* limits are stored as unsigned 32-bit data */\n\t\tinfo->dqi_max_spc_limit = 0xffffffffULL << QUOTABLOCK_BITS;\n\t\tinfo->dqi_max_ino_limit = 0xffffffff;\n\t} else {\n\t\t/* used space is stored as unsigned 64-bit value in bytes */\n\t\tinfo->dqi_max_spc_limit = 0xffffffffffffffffULL; /* 2^64-1 */\n\t\tinfo->dqi_max_ino_limit = 0xffffffffffffffffULL;\n\t}\n\tinfo->dqi_bgrace = le32_to_cpu(dinfo.dqi_bgrace);\n\tinfo->dqi_igrace = le32_to_cpu(dinfo.dqi_igrace);\n\t/* No flags currently supported */\n\tinfo->dqi_flags = 0;\n\tqinfo->dqi_sb = sb;\n\tqinfo->dqi_type = type;\n\tqinfo->dqi_blocks = le32_to_cpu(dinfo.dqi_blocks);\n\tqinfo->dqi_free_blk = le32_to_cpu(dinfo.dqi_free_blk);\n\tqinfo->dqi_free_entry = le32_to_cpu(dinfo.dqi_free_entry);\n\tqinfo->dqi_blocksize_bits = V2_DQBLKSIZE_BITS;\n\tqinfo->dqi_usable_bs = 1 << V2_DQBLKSIZE_BITS;\n\tqinfo->dqi_qtree_depth = qtree_depth(qinfo);\n\tif (version == 0) {\n\t\tqinfo->dqi_entry_size = sizeof(struct v2r0_disk_dqblk);\n\t\tqinfo->dqi_ops = &v2r0_qtree_ops;\n\t} else {\n\t\tqinfo->dqi_entry_size = sizeof(struct v2r1_disk_dqblk);\n\t\tqinfo->dqi_ops = &v2r1_qtree_ops;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "v2_check_quota_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "74-86",
    "snippet": "static int v2_check_quota_file(struct super_block *sb, int type)\n{\n\tstruct v2_disk_dqheader dqhead;\n\tstatic const uint quota_magics[] = V2_INITQMAGICS;\n\tstatic const uint quota_versions[] = V2_INITQVERSIONS;\n \n\tif (!v2_read_header(sb, type, &dqhead))\n\t\treturn 0;\n\tif (le32_to_cpu(dqhead.dqh_magic) != quota_magics[type] ||\n\t    le32_to_cpu(dqhead.dqh_version) > quota_versions[type])\n\t\treturn 0;\n\treturn 1;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "dqhead.dqh_version"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "v2_read_header",
          "args": [
            "sb",
            "type",
            "&dqhead"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "v2_read_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
          "lines": "58-71",
          "snippet": "static int v2_read_header(struct super_block *sb, int type,\n\t\t\t  struct v2_disk_dqheader *dqhead)\n{\n\tssize_t size;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader)) {\n\t\tquota_error(sb, \"Failed header read: expected=%zd got=%zd\",\n\t\t\t    sizeof(struct v2_disk_dqheader), size);\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"quotaio_v2.h\"",
            "#include \"quota_tree.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v2.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v2_read_header(struct super_block *sb, int type,\n\t\t\t  struct v2_disk_dqheader *dqhead)\n{\n\tssize_t size;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader)) {\n\t\tquota_error(sb, \"Failed header read: expected=%zd got=%zd\",\n\t\t\t    sizeof(struct v2_disk_dqheader), size);\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v2_check_quota_file(struct super_block *sb, int type)\n{\n\tstruct v2_disk_dqheader dqhead;\n\tstatic const uint quota_magics[] = V2_INITQMAGICS;\n\tstatic const uint quota_versions[] = V2_INITQVERSIONS;\n \n\tif (!v2_read_header(sb, type, &dqhead))\n\t\treturn 0;\n\tif (le32_to_cpu(dqhead.dqh_magic) != quota_magics[type] ||\n\t    le32_to_cpu(dqhead.dqh_version) > quota_versions[type])\n\t\treturn 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "v2_read_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "58-71",
    "snippet": "static int v2_read_header(struct super_block *sb, int type,\n\t\t\t  struct v2_disk_dqheader *dqhead)\n{\n\tssize_t size;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader)) {\n\t\tquota_error(sb, \"Failed header read: expected=%zd got=%zd\",\n\t\t\t    sizeof(struct v2_disk_dqheader), size);\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quota_error",
          "args": [
            "sb",
            "\"Failed header read: expected=%zd got=%zd\"",
            "sizeof(struct v2_disk_dqheader)",
            "size"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "__quota_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "132-149",
          "snippet": "void __quota_error(struct super_block *sb, const char *func,\n\t\t   const char *fmt, ...)\n{\n\tif (printk_ratelimit()) {\n\t\tva_list args;\n\t\tstruct va_format vaf;\n\n\t\tva_start(args, fmt);\n\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tprintk(KERN_ERR \"Quota error (device %s): %s: %pV\\n\",\n\t\t       sb->s_id, func, &vaf);\n\n\t\tva_end(args);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nvoid __quota_error(struct super_block *sb, const char *func,\n\t\t   const char *fmt, ...)\n{\n\tif (printk_ratelimit()) {\n\t\tva_list args;\n\t\tstruct va_format vaf;\n\n\t\tva_start(args, fmt);\n\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tprintk(KERN_ERR \"Quota error (device %s): %s: %pV\\n\",\n\t\t       sb->s_id, func, &vaf);\n\n\t\tva_end(args);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->s_op->quota_read",
          "args": [
            "sb",
            "type",
            "(char *)dqhead",
            "sizeof(struct v2_disk_dqheader)",
            "0"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v2_read_header(struct super_block *sb, int type,\n\t\t\t  struct v2_disk_dqheader *dqhead)\n{\n\tssize_t size;\n\n\tsize = sb->s_op->quota_read(sb, type, (char *)dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader)) {\n\t\tquota_error(sb, \"Failed header read: expected=%zd got=%zd\",\n\t\t\t    sizeof(struct v2_disk_dqheader), size);\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "v2_qbtos",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "53-56",
    "snippet": "static inline qsize_t v2_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define QUOTABLOCK_BITS 10"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v2_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}"
  },
  {
    "function_name": "v2_stoqb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v2.c",
    "lines": "48-51",
    "snippet": "static inline qsize_t v2_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}",
    "includes": [
      "#include \"quotaio_v2.h\"",
      "#include \"quota_tree.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v2.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)",
      "#define QUOTABLOCK_BITS 10"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"quotaio_v2.h\"\n#include \"quota_tree.h\"\n#include <asm/byteorder.h>\n#include <linux/quotaops.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v2.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v2_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}"
  }
]