[
  {
    "function_name": "o2quo_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "335-340",
    "snippet": "void o2quo_exit(void)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tflush_work(&qs->qs_work);\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_work",
          "args": [
            "&qs->qs_work"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nvoid o2quo_exit(void)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tflush_work(&qs->qs_work);\n}"
  },
  {
    "function_name": "o2quo_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "327-333",
    "snippet": "void o2quo_init(void)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock_init(&qs->qs_lock);\n\tINIT_WORK(&qs->qs_work, o2quo_make_decision);\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&qs->qs_work",
            "o2quo_make_decision"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nvoid o2quo_init(void)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock_init(&qs->qs_lock);\n\tINIT_WORK(&qs->qs_work, o2quo_make_decision);\n}"
  },
  {
    "function_name": "o2quo_conn_err",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "304-325",
    "snippet": "void o2quo_conn_err(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tif (test_bit(node, qs->qs_conn_bm)) {\n\t\tqs->qs_connected--;\n\t\tmlog_bug_on_msg(qs->qs_connected < 0,\n\t\t\t\t\"node %u, connected %d\\n\",\n\t\t\t\tnode, qs->qs_connected);\n\n\t\tclear_bit(node, qs->qs_conn_bm);\n\t}\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_connected);\n\n\tif (test_bit(node, qs->qs_hb_bm))\n\t\to2quo_set_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2quo_set_hold",
          "args": [
            "qs",
            "node"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_set_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "177-187",
          "snippet": "static void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "node",
            "qs->qs_hb_bm"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"node %u, %d total\\n\"",
            "node",
            "qs->qs_connected"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "node",
            "qs->qs_conn_bm"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "qs->qs_connected < 0",
            "\"node %u, connected %d\\n\"",
            "node",
            "qs->qs_connected"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;\n\nvoid o2quo_conn_err(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tif (test_bit(node, qs->qs_conn_bm)) {\n\t\tqs->qs_connected--;\n\t\tmlog_bug_on_msg(qs->qs_connected < 0,\n\t\t\t\t\"node %u, connected %d\\n\",\n\t\t\t\tnode, qs->qs_connected);\n\n\t\tclear_bit(node, qs->qs_conn_bm);\n\t}\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_connected);\n\n\tif (test_bit(node, qs->qs_hb_bm))\n\t\to2quo_set_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}"
  },
  {
    "function_name": "o2quo_conn_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "278-298",
    "snippet": "void o2quo_conn_up(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tqs->qs_connected++;\n\tmlog_bug_on_msg(qs->qs_connected == O2NM_MAX_NODES,\n\t\t        \"node %u\\n\", node);\n\tmlog_bug_on_msg(test_bit(node, qs->qs_conn_bm), \"node %u\\n\", node);\n\tset_bit(node, qs->qs_conn_bm);\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_connected);\n\n\tif (!test_bit(node, qs->qs_hb_bm))\n\t\to2quo_set_hold(qs, node);\n\telse\n\t\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2quo_clear_hold",
          "args": [
            "qs",
            "node"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_clear_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "189-204",
          "snippet": "static void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2quo_set_hold",
          "args": [
            "qs",
            "node"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_set_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "177-187",
          "snippet": "static void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "node",
            "qs->qs_hb_bm"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"node %u, %d total\\n\"",
            "node",
            "qs->qs_connected"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "node",
            "qs->qs_conn_bm"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "test_bit(node, qs->qs_conn_bm)",
            "\"node %u\\n\"",
            "node"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "qs->qs_connected == O2NM_MAX_NODES",
            "\"node %u\\n\"",
            "node"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;\n\nvoid o2quo_conn_up(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tqs->qs_connected++;\n\tmlog_bug_on_msg(qs->qs_connected == O2NM_MAX_NODES,\n\t\t        \"node %u\\n\", node);\n\tmlog_bug_on_msg(test_bit(node, qs->qs_conn_bm), \"node %u\\n\", node);\n\tset_bit(node, qs->qs_conn_bm);\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_connected);\n\n\tif (!test_bit(node, qs->qs_hb_bm))\n\t\to2quo_set_hold(qs, node);\n\telse\n\t\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}"
  },
  {
    "function_name": "o2quo_hb_still_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "259-271",
    "snippet": "void o2quo_hb_still_up(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tmlog(0, \"node %u\\n\", node);\n\n\tqs->qs_pending = 1;\n\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2quo_clear_hold",
          "args": [
            "qs",
            "node"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_clear_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "189-204",
          "snippet": "static void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"node %u\\n\"",
            "node"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nvoid o2quo_hb_still_up(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tmlog(0, \"node %u\\n\", node);\n\n\tqs->qs_pending = 1;\n\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}"
  },
  {
    "function_name": "o2quo_hb_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "234-252",
    "snippet": "void o2quo_hb_down(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tqs->qs_heartbeating--;\n\tmlog_bug_on_msg(qs->qs_heartbeating < 0,\n\t\t\t\"node %u, %d heartbeating\\n\",\n\t\t\tnode, qs->qs_heartbeating);\n\tmlog_bug_on_msg(!test_bit(node, qs->qs_hb_bm), \"node %u\\n\", node);\n\tclear_bit(node, qs->qs_hb_bm);\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_heartbeating);\n\n\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2quo_clear_hold",
          "args": [
            "qs",
            "node"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_clear_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "189-204",
          "snippet": "static void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"node %u, %d total\\n\"",
            "node",
            "qs->qs_heartbeating"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "node",
            "qs->qs_hb_bm"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "!test_bit(node, qs->qs_hb_bm)",
            "\"node %u\\n\"",
            "node"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "node",
            "qs->qs_hb_bm"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "qs->qs_heartbeating < 0",
            "\"node %u, %d heartbeating\\n\"",
            "node",
            "qs->qs_heartbeating"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;\n\nvoid o2quo_hb_down(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tqs->qs_heartbeating--;\n\tmlog_bug_on_msg(qs->qs_heartbeating < 0,\n\t\t\t\"node %u, %d heartbeating\\n\",\n\t\t\tnode, qs->qs_heartbeating);\n\tmlog_bug_on_msg(!test_bit(node, qs->qs_hb_bm), \"node %u\\n\", node);\n\tclear_bit(node, qs->qs_hb_bm);\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_heartbeating);\n\n\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}"
  },
  {
    "function_name": "o2quo_hb_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "210-230",
    "snippet": "void o2quo_hb_up(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tqs->qs_heartbeating++;\n\tmlog_bug_on_msg(qs->qs_heartbeating == O2NM_MAX_NODES,\n\t\t        \"node %u\\n\", node);\n\tmlog_bug_on_msg(test_bit(node, qs->qs_hb_bm), \"node %u\\n\", node);\n\tset_bit(node, qs->qs_hb_bm);\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_heartbeating);\n\n\tif (!test_bit(node, qs->qs_conn_bm))\n\t\to2quo_set_hold(qs, node);\n\telse\n\t\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2quo_clear_hold",
          "args": [
            "qs",
            "node"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_clear_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "189-204",
          "snippet": "static void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2quo_set_hold",
          "args": [
            "qs",
            "node"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_set_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "177-187",
          "snippet": "static void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "node",
            "qs->qs_conn_bm"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"node %u, %d total\\n\"",
            "node",
            "qs->qs_heartbeating"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "node",
            "qs->qs_hb_bm"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "test_bit(node, qs->qs_hb_bm)",
            "\"node %u\\n\"",
            "node"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "qs->qs_heartbeating == O2NM_MAX_NODES",
            "\"node %u\\n\"",
            "node"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;\n\nvoid o2quo_hb_up(u8 node)\n{\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tqs->qs_heartbeating++;\n\tmlog_bug_on_msg(qs->qs_heartbeating == O2NM_MAX_NODES,\n\t\t        \"node %u\\n\", node);\n\tmlog_bug_on_msg(test_bit(node, qs->qs_hb_bm), \"node %u\\n\", node);\n\tset_bit(node, qs->qs_hb_bm);\n\n\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_heartbeating);\n\n\tif (!test_bit(node, qs->qs_conn_bm))\n\t\to2quo_set_hold(qs, node);\n\telse\n\t\to2quo_clear_hold(qs, node);\n\n\tspin_unlock(&qs->qs_lock);\n}"
  },
  {
    "function_name": "o2quo_clear_hold",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "189-204",
    "snippet": "static void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "qs->qs_holds < 0",
            "\"node %u, holds %d\\n\"",
            "node",
            "qs->qs_holds"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&qs->qs_work"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_schedule_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "755-771",
          "snippet": "static void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_direct_complete(dreq, true);\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */",
            "#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */"
          ],
          "globals_used": [
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */\n#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */\n\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_direct_complete(dreq, true);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"node %u, %d total\\n\"",
            "node",
            "qs->qs_holds - 1"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "node",
            "qs->qs_hold_bm"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_clear_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (test_and_clear_bit(node, qs->qs_hold_bm)) {\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds - 1);\n\t\tif (--qs->qs_holds == 0) {\n\t\t\tif (qs->qs_pending) {\n\t\t\t\tqs->qs_pending = 0;\n\t\t\t\tschedule_work(&qs->qs_work);\n\t\t\t}\n\t\t}\n\t\tmlog_bug_on_msg(qs->qs_holds < 0, \"node %u, holds %d\\n\",\n\t\t\t\tnode, qs->qs_holds);\n\t}\n}"
  },
  {
    "function_name": "o2quo_set_hold",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "177-187",
    "snippet": "static void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"node %u, %d total\\n\"",
            "node",
            "qs->qs_holds"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "qs->qs_holds == O2NM_MAX_NODES",
            "\"node %u\\n\"",
            "node"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "node",
            "qs->qs_hold_bm"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_set_hold(struct o2quo_state *qs, u8 node)\n{\n\tassert_spin_locked(&qs->qs_lock);\n\n\tif (!test_and_set_bit(node, qs->qs_hold_bm)) {\n\t\tqs->qs_holds++;\n\t\tmlog_bug_on_msg(qs->qs_holds == O2NM_MAX_NODES,\n\t\t\t        \"node %u\\n\", node);\n\t\tmlog(0, \"node %u, %d total\\n\", node, qs->qs_holds);\n\t}\n}"
  },
  {
    "function_name": "o2quo_make_decision",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "105-175",
    "snippet": "static void o2quo_make_decision(struct work_struct *work)\n{\n\tint quorum;\n\tint lowest_hb, lowest_reachable = 0, fence = 0;\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tlowest_hb = find_first_bit(qs->qs_hb_bm, O2NM_MAX_NODES);\n\tif (lowest_hb != O2NM_MAX_NODES)\n\t\tlowest_reachable = test_bit(lowest_hb, qs->qs_conn_bm);\n\n\tmlog(0, \"heartbeating: %d, connected: %d, \"\n\t     \"lowest: %d (%sreachable)\\n\", qs->qs_heartbeating,\n\t     qs->qs_connected, lowest_hb, lowest_reachable ? \"\" : \"un\");\n\n\tif (!test_bit(o2nm_this_node(), qs->qs_hb_bm) ||\n\t    qs->qs_heartbeating == 1)\n\t\tgoto out;\n\n\tif (qs->qs_heartbeating & 1) {\n\t\t/* the odd numbered cluster case is straight forward --\n\t\t * if we can't talk to the majority we're hosed */\n\t\tquorum = (qs->qs_heartbeating + 1)/2;\n\t\tif (qs->qs_connected < quorum) {\n\t\t\tmlog(ML_ERROR, \"fencing this node because it is \"\n\t\t\t     \"only connected to %u nodes and %u is needed \"\n\t\t\t     \"to make a quorum out of %u heartbeating nodes\\n\",\n\t\t\t     qs->qs_connected, quorum,\n\t\t\t     qs->qs_heartbeating);\n\t\t\tfence = 1;\n\t\t}\n\t} else {\n\t\t/* the even numbered cluster adds the possibility of each half\n\t\t * of the cluster being able to talk amongst themselves.. in\n\t\t * that case we're hosed if we can't talk to the group that has\n\t\t * the lowest numbered node */\n\t\tquorum = qs->qs_heartbeating / 2;\n\t\tif (qs->qs_connected < quorum) {\n\t\t\tmlog(ML_ERROR, \"fencing this node because it is \"\n\t\t\t     \"only connected to %u nodes and %u is needed \"\n\t\t\t     \"to make a quorum out of %u heartbeating nodes\\n\",\n\t\t\t     qs->qs_connected, quorum,\n\t\t\t     qs->qs_heartbeating);\n\t\t\tfence = 1;\n\t\t}\n\t\telse if ((qs->qs_connected == quorum) &&\n\t\t\t !lowest_reachable) {\n\t\t\tmlog(ML_ERROR, \"fencing this node because it is \"\n\t\t\t     \"connected to a half-quorum of %u out of %u \"\n\t\t\t     \"nodes which doesn't include the lowest active \"\n\t\t\t     \"node %u\\n\", quorum, qs->qs_heartbeating,\n\t\t\t     lowest_hb);\n\t\t\tfence = 1;\n\t\t}\n\t}\n\nout:\n\tif (fence) {\n\t\tspin_unlock(&qs->qs_lock);\n\t\to2quo_fence_self();\n\t} else {\n\t\tmlog(ML_NOTICE, \"not fencing this node, heartbeating: %d, \"\n\t\t\t\"connected: %d, lowest: %d (%sreachable)\\n\",\n\t\t\tqs->qs_heartbeating, qs->qs_connected, lowest_hb,\n\t\t\tlowest_reachable ? \"\" : \"un\");\n\t\tspin_unlock(&qs->qs_lock);\n\n\t}\n\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_NOTICE",
            "\"not fencing this node, heartbeating: %d, \"\n\t\t\t\"connected: %d, lowest: %d (%sreachable)\\n\"",
            "qs->qs_heartbeating",
            "qs->qs_connected",
            "lowest_hb",
            "lowest_reachable ? \"\" : \"un\""
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2quo_fence_self",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_fence_self",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "70-90",
          "snippet": "static void o2quo_fence_self(void)\n{\n\t/* panic spins with interrupts enabled.  with preempt\n\t * threads can still schedule, etc, etc */\n\to2hb_stop_all_regions();\n\n\tswitch (o2nm_single_cluster->cl_fence_method) {\n\tcase O2NM_FENCE_PANIC:\n\t\tpanic(\"*** ocfs2 is very sorry to be fencing this system by \"\n\t\t      \"panicing ***\\n\");\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(o2nm_single_cluster->cl_fence_method >=\n\t\t\tO2NM_FENCE_METHODS);\n\tcase O2NM_FENCE_RESET:\n\t\tprintk(KERN_ERR \"*** ocfs2 is very sorry to be fencing this \"\n\t\t       \"system by restarting ***\\n\");\n\t\temergency_restart();\n\t\tbreak;\n\t};\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_fence_self(void)\n{\n\t/* panic spins with interrupts enabled.  with preempt\n\t * threads can still schedule, etc, etc */\n\to2hb_stop_all_regions();\n\n\tswitch (o2nm_single_cluster->cl_fence_method) {\n\tcase O2NM_FENCE_PANIC:\n\t\tpanic(\"*** ocfs2 is very sorry to be fencing this system by \"\n\t\t      \"panicing ***\\n\");\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(o2nm_single_cluster->cl_fence_method >=\n\t\t\tO2NM_FENCE_METHODS);\n\tcase O2NM_FENCE_RESET:\n\t\tprintk(KERN_ERR \"*** ocfs2 is very sorry to be fencing this \"\n\t\t       \"system by restarting ***\\n\");\n\t\temergency_restart();\n\t\tbreak;\n\t};\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"fencing this node because it is \"\n\t\t\t     \"connected to a half-quorum of %u out of %u \"\n\t\t\t     \"nodes which doesn't include the lowest active \"\n\t\t\t     \"node %u\\n\"",
            "quorum",
            "qs->qs_heartbeating",
            "lowest_hb"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"fencing this node because it is \"\n\t\t\t     \"only connected to %u nodes and %u is needed \"\n\t\t\t     \"to make a quorum out of %u heartbeating nodes\\n\"",
            "qs->qs_connected",
            "quorum",
            "qs->qs_heartbeating"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"fencing this node because it is \"\n\t\t\t     \"only connected to %u nodes and %u is needed \"\n\t\t\t     \"to make a quorum out of %u heartbeating nodes\\n\"",
            "qs->qs_connected",
            "quorum",
            "qs->qs_heartbeating"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "o2nm_this_node()",
            "qs->qs_hb_bm"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_this_node",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "143-151",
          "snippet": "u8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nu8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"heartbeating: %d, connected: %d, \"\n\t     \"lowest: %d (%sreachable)\\n\"",
            "qs->qs_heartbeating",
            "qs->qs_connected",
            "lowest_hb",
            "lowest_reachable ? \"\" : \"un\""
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_first_bit",
          "args": [
            "qs->qs_hb_bm",
            "O2NM_MAX_NODES"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&qs->qs_lock"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic struct o2quo_state {\n\tspinlock_t\t\tqs_lock;\n\tstruct work_struct\tqs_work;\n\tint\t\t\tqs_pending;\n\tint\t\t\tqs_heartbeating;\n\tunsigned long\t\tqs_hb_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_connected;\n\tunsigned long\t\tqs_conn_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint\t\t\tqs_holds;\n\tunsigned long\t\tqs_hold_bm[BITS_TO_LONGS(O2NM_MAX_NODES)];\n} o2quo_state;\n\nstatic void o2quo_make_decision(struct work_struct *work)\n{\n\tint quorum;\n\tint lowest_hb, lowest_reachable = 0, fence = 0;\n\tstruct o2quo_state *qs = &o2quo_state;\n\n\tspin_lock(&qs->qs_lock);\n\n\tlowest_hb = find_first_bit(qs->qs_hb_bm, O2NM_MAX_NODES);\n\tif (lowest_hb != O2NM_MAX_NODES)\n\t\tlowest_reachable = test_bit(lowest_hb, qs->qs_conn_bm);\n\n\tmlog(0, \"heartbeating: %d, connected: %d, \"\n\t     \"lowest: %d (%sreachable)\\n\", qs->qs_heartbeating,\n\t     qs->qs_connected, lowest_hb, lowest_reachable ? \"\" : \"un\");\n\n\tif (!test_bit(o2nm_this_node(), qs->qs_hb_bm) ||\n\t    qs->qs_heartbeating == 1)\n\t\tgoto out;\n\n\tif (qs->qs_heartbeating & 1) {\n\t\t/* the odd numbered cluster case is straight forward --\n\t\t * if we can't talk to the majority we're hosed */\n\t\tquorum = (qs->qs_heartbeating + 1)/2;\n\t\tif (qs->qs_connected < quorum) {\n\t\t\tmlog(ML_ERROR, \"fencing this node because it is \"\n\t\t\t     \"only connected to %u nodes and %u is needed \"\n\t\t\t     \"to make a quorum out of %u heartbeating nodes\\n\",\n\t\t\t     qs->qs_connected, quorum,\n\t\t\t     qs->qs_heartbeating);\n\t\t\tfence = 1;\n\t\t}\n\t} else {\n\t\t/* the even numbered cluster adds the possibility of each half\n\t\t * of the cluster being able to talk amongst themselves.. in\n\t\t * that case we're hosed if we can't talk to the group that has\n\t\t * the lowest numbered node */\n\t\tquorum = qs->qs_heartbeating / 2;\n\t\tif (qs->qs_connected < quorum) {\n\t\t\tmlog(ML_ERROR, \"fencing this node because it is \"\n\t\t\t     \"only connected to %u nodes and %u is needed \"\n\t\t\t     \"to make a quorum out of %u heartbeating nodes\\n\",\n\t\t\t     qs->qs_connected, quorum,\n\t\t\t     qs->qs_heartbeating);\n\t\t\tfence = 1;\n\t\t}\n\t\telse if ((qs->qs_connected == quorum) &&\n\t\t\t !lowest_reachable) {\n\t\t\tmlog(ML_ERROR, \"fencing this node because it is \"\n\t\t\t     \"connected to a half-quorum of %u out of %u \"\n\t\t\t     \"nodes which doesn't include the lowest active \"\n\t\t\t     \"node %u\\n\", quorum, qs->qs_heartbeating,\n\t\t\t     lowest_hb);\n\t\t\tfence = 1;\n\t\t}\n\t}\n\nout:\n\tif (fence) {\n\t\tspin_unlock(&qs->qs_lock);\n\t\to2quo_fence_self();\n\t} else {\n\t\tmlog(ML_NOTICE, \"not fencing this node, heartbeating: %d, \"\n\t\t\t\"connected: %d, lowest: %d (%sreachable)\\n\",\n\t\t\tqs->qs_heartbeating, qs->qs_connected, lowest_hb,\n\t\t\tlowest_reachable ? \"\" : \"un\");\n\t\tspin_unlock(&qs->qs_lock);\n\n\t}\n\n}"
  },
  {
    "function_name": "o2quo_disk_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "100-103",
    "snippet": "void o2quo_disk_timeout(void)\n{\n\to2quo_fence_self();\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2quo_fence_self",
          "args": [],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_fence_self",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "70-90",
          "snippet": "static void o2quo_fence_self(void)\n{\n\t/* panic spins with interrupts enabled.  with preempt\n\t * threads can still schedule, etc, etc */\n\to2hb_stop_all_regions();\n\n\tswitch (o2nm_single_cluster->cl_fence_method) {\n\tcase O2NM_FENCE_PANIC:\n\t\tpanic(\"*** ocfs2 is very sorry to be fencing this system by \"\n\t\t      \"panicing ***\\n\");\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(o2nm_single_cluster->cl_fence_method >=\n\t\t\tO2NM_FENCE_METHODS);\n\tcase O2NM_FENCE_RESET:\n\t\tprintk(KERN_ERR \"*** ocfs2 is very sorry to be fencing this \"\n\t\t       \"system by restarting ***\\n\");\n\t\temergency_restart();\n\t\tbreak;\n\t};\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_fence_self(void)\n{\n\t/* panic spins with interrupts enabled.  with preempt\n\t * threads can still schedule, etc, etc */\n\to2hb_stop_all_regions();\n\n\tswitch (o2nm_single_cluster->cl_fence_method) {\n\tcase O2NM_FENCE_PANIC:\n\t\tpanic(\"*** ocfs2 is very sorry to be fencing this system by \"\n\t\t      \"panicing ***\\n\");\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(o2nm_single_cluster->cl_fence_method >=\n\t\t\tO2NM_FENCE_METHODS);\n\tcase O2NM_FENCE_RESET:\n\t\tprintk(KERN_ERR \"*** ocfs2 is very sorry to be fencing this \"\n\t\t       \"system by restarting ***\\n\");\n\t\temergency_restart();\n\t\tbreak;\n\t};\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nvoid o2quo_disk_timeout(void)\n{\n\to2quo_fence_self();\n}"
  },
  {
    "function_name": "o2quo_fence_self",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
    "lines": "70-90",
    "snippet": "static void o2quo_fence_self(void)\n{\n\t/* panic spins with interrupts enabled.  with preempt\n\t * threads can still schedule, etc, etc */\n\to2hb_stop_all_regions();\n\n\tswitch (o2nm_single_cluster->cl_fence_method) {\n\tcase O2NM_FENCE_PANIC:\n\t\tpanic(\"*** ocfs2 is very sorry to be fencing this system by \"\n\t\t      \"panicing ***\\n\");\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(o2nm_single_cluster->cl_fence_method >=\n\t\t\tO2NM_FENCE_METHODS);\n\tcase O2NM_FENCE_RESET:\n\t\tprintk(KERN_ERR \"*** ocfs2 is very sorry to be fencing this \"\n\t\t       \"system by restarting ***\\n\");\n\t\temergency_restart();\n\t\tbreak;\n\t};\n}",
    "includes": [
      "#include \"quorum.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "emergency_restart",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"*** ocfs2 is very sorry to be fencing this \"\n\t\t       \"system by restarting ***\\n\""
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "o2nm_single_cluster->cl_fence_method >=\n\t\t\tO2NM_FENCE_METHODS"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"*** ocfs2 is very sorry to be fencing this system by \"\n\t\t      \"panicing ***\\n\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_stop_all_regions",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_stop_all_regions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2631-2643",
          "snippet": "void o2hb_stop_all_regions(void)\n{\n\tstruct o2hb_region *reg;\n\n\tmlog(ML_ERROR, \"stopping heartbeat on all active regions.\\n\");\n\n\tspin_lock(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item)\n\t\treg->hr_unclean_stop = 1;\n\n\tspin_unlock(&o2hb_live_lock);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_all_regions);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\n\nvoid o2hb_stop_all_regions(void)\n{\n\tstruct o2hb_region *reg;\n\n\tmlog(ML_ERROR, \"stopping heartbeat on all active regions.\\n\");\n\n\tspin_lock(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item)\n\t\treg->hr_unclean_stop = 1;\n\n\tspin_unlock(&o2hb_live_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nstatic void o2quo_fence_self(void)\n{\n\t/* panic spins with interrupts enabled.  with preempt\n\t * threads can still schedule, etc, etc */\n\to2hb_stop_all_regions();\n\n\tswitch (o2nm_single_cluster->cl_fence_method) {\n\tcase O2NM_FENCE_PANIC:\n\t\tpanic(\"*** ocfs2 is very sorry to be fencing this system by \"\n\t\t      \"panicing ***\\n\");\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(o2nm_single_cluster->cl_fence_method >=\n\t\t\tO2NM_FENCE_METHODS);\n\tcase O2NM_FENCE_RESET:\n\t\tprintk(KERN_ERR \"*** ocfs2 is very sorry to be fencing this \"\n\t\t       \"system by restarting ***\\n\");\n\t\temergency_restart();\n\t\tbreak;\n\t};\n}"
  }
]