[
  {
    "function_name": "nilfs_segbuf_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "520-536",
    "snippet": "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf)\n{\n\tint err = 0;\n\n\tif (!segbuf->sb_nbio)\n\t\treturn 0;\n\n\tdo {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t} while (--segbuf->sb_nbio > 0);\n\n\tif (unlikely(atomic_read(&segbuf->sb_err) > 0)) {\n\t\tprintk(KERN_ERR \"NILFS: IO error writing segment\\n\");\n\t\terr = -EIO;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"NILFS: IO error writing segment\\n\""
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "atomic_read(&segbuf->sb_err) > 0"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&segbuf->sb_err"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&segbuf->sb_bio_event"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_for_completion_rpc_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "1116-1122",
          "snippet": "static int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf)\n{\n\tint err = 0;\n\n\tif (!segbuf->sb_nbio)\n\t\treturn 0;\n\n\tdo {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t} while (--segbuf->sb_nbio > 0);\n\n\tif (unlikely(atomic_read(&segbuf->sb_err) > 0)) {\n\t\tprintk(KERN_ERR \"NILFS: IO error writing segment\\n\");\n\t\terr = -EIO;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "nilfs_segbuf_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "476-509",
    "snippet": "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs)\n{\n\tstruct nilfs_write_info wi;\n\tstruct buffer_head *bh;\n\tint res = 0, rw = WRITE;\n\n\twi.nilfs = nilfs;\n\tnilfs_segbuf_prepare_write(segbuf, &wi);\n\n\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tif (wi.bio) {\n\t\t/*\n\t\t * Last BIO is always sent through the following\n\t\t * submission.\n\t\t */\n\t\trw |= REQ_SYNC;\n\t\tres = nilfs_segbuf_submit_bio(segbuf, &wi, rw);\n\t}\n\n failed_bio:\n\treturn res;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_submit_bio",
          "args": [
            "segbuf",
            "&wi",
            "rw"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_submit_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "358-396",
          "snippet": "static int nilfs_segbuf_submit_bio(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t   struct nilfs_write_info *wi, int mode)\n{\n\tstruct bio *bio = wi->bio;\n\tint err;\n\n\tif (segbuf->sb_nbio > 0 &&\n\t    bdi_write_congested(segbuf->sb_super->s_bdi)) {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t\tsegbuf->sb_nbio--;\n\t\tif (unlikely(atomic_read(&segbuf->sb_err))) {\n\t\t\tbio_put(bio);\n\t\t\terr = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t}\n\n\tbio->bi_end_io = nilfs_end_bio_write;\n\tbio->bi_private = segbuf;\n\tbio_get(bio);\n\tsubmit_bio(mode, bio);\n\tsegbuf->sb_nbio++;\n\tif (bio_flagged(bio, BIO_EOPNOTSUPP)) {\n\t\tbio_put(bio);\n\t\terr = -EOPNOTSUPP;\n\t\tgoto failed;\n\t}\n\tbio_put(bio);\n\n\twi->bio = NULL;\n\twi->rest_blocks -= wi->end - wi->start;\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end;\n\treturn 0;\n\n failed:\n\twi->bio = NULL;\n\treturn err;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_submit_bio(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t   struct nilfs_write_info *wi, int mode)\n{\n\tstruct bio *bio = wi->bio;\n\tint err;\n\n\tif (segbuf->sb_nbio > 0 &&\n\t    bdi_write_congested(segbuf->sb_super->s_bdi)) {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t\tsegbuf->sb_nbio--;\n\t\tif (unlikely(atomic_read(&segbuf->sb_err))) {\n\t\t\tbio_put(bio);\n\t\t\terr = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t}\n\n\tbio->bi_end_io = nilfs_end_bio_write;\n\tbio->bi_private = segbuf;\n\tbio_get(bio);\n\tsubmit_bio(mode, bio);\n\tsegbuf->sb_nbio++;\n\tif (bio_flagged(bio, BIO_EOPNOTSUPP)) {\n\t\tbio_put(bio);\n\t\terr = -EOPNOTSUPP;\n\t\tgoto failed;\n\t}\n\tbio_put(bio);\n\n\twi->bio = NULL;\n\twi->rest_blocks -= wi->end - wi->start;\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end;\n\treturn 0;\n\n failed:\n\twi->bio = NULL;\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "res"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_segbuf_submit_bh",
          "args": [
            "segbuf",
            "&wi",
            "bh",
            "rw"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_submit_bh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "436-462",
          "snippet": "static int nilfs_segbuf_submit_bh(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t  struct nilfs_write_info *wi,\n\t\t\t\t  struct buffer_head *bh, int mode)\n{\n\tint len, err;\n\n\tBUG_ON(wi->nr_vecs <= 0);\n repeat:\n\tif (!wi->bio) {\n\t\twi->bio = nilfs_alloc_seg_bio(wi->nilfs, wi->blocknr + wi->end,\n\t\t\t\t\t      wi->nr_vecs);\n\t\tif (unlikely(!wi->bio))\n\t\t\treturn -ENOMEM;\n\t}\n\n\tlen = bio_add_page(wi->bio, bh->b_page, bh->b_size, bh_offset(bh));\n\tif (len == bh->b_size) {\n\t\twi->end++;\n\t\treturn 0;\n\t}\n\t/* bio is FULL */\n\terr = nilfs_segbuf_submit_bio(segbuf, wi, mode);\n\t/* never submit current bh */\n\tif (likely(!err))\n\t\tgoto repeat;\n\treturn err;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_submit_bh(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t  struct nilfs_write_info *wi,\n\t\t\t\t  struct buffer_head *bh, int mode)\n{\n\tint len, err;\n\n\tBUG_ON(wi->nr_vecs <= 0);\n repeat:\n\tif (!wi->bio) {\n\t\twi->bio = nilfs_alloc_seg_bio(wi->nilfs, wi->blocknr + wi->end,\n\t\t\t\t\t      wi->nr_vecs);\n\t\tif (unlikely(!wi->bio))\n\t\t\treturn -ENOMEM;\n\t}\n\n\tlen = bio_add_page(wi->bio, bh->b_page, bh->b_size, bh_offset(bh));\n\tif (len == bh->b_size) {\n\t\twi->end++;\n\t\treturn 0;\n\t}\n\t/* bio is FULL */\n\terr = nilfs_segbuf_submit_bio(segbuf, wi, mode);\n\t/* never submit current bh */\n\tif (likely(!err))\n\t\tgoto repeat;\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "bh",
            "&segbuf->sb_payload_buffers",
            "b_assoc_buffers"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "res"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "bh",
            "&segbuf->sb_segsum_buffers",
            "b_assoc_buffers"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_segbuf_prepare_write",
          "args": [
            "segbuf",
            "&wi"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_prepare_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "425-434",
          "snippet": "static void nilfs_segbuf_prepare_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t       struct nilfs_write_info *wi)\n{\n\twi->bio = NULL;\n\twi->rest_blocks = segbuf->sb_sum.nblocks;\n\twi->max_pages = bio_get_nr_vecs(wi->nilfs->ns_bdev);\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end = 0;\n\twi->blocknr = segbuf->sb_pseg_start;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_segbuf_prepare_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t       struct nilfs_write_info *wi)\n{\n\twi->bio = NULL;\n\twi->rest_blocks = segbuf->sb_sum.nblocks;\n\twi->max_pages = bio_get_nr_vecs(wi->nilfs->ns_bdev);\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end = 0;\n\twi->blocknr = segbuf->sb_pseg_start;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs)\n{\n\tstruct nilfs_write_info wi;\n\tstruct buffer_head *bh;\n\tint res = 0, rw = WRITE;\n\n\twi.nilfs = nilfs;\n\tnilfs_segbuf_prepare_write(segbuf, &wi);\n\n\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tif (wi.bio) {\n\t\t/*\n\t\t * Last BIO is always sent through the following\n\t\t * submission.\n\t\t */\n\t\trw |= REQ_SYNC;\n\t\tres = nilfs_segbuf_submit_bio(segbuf, &wi, rw);\n\t}\n\n failed_bio:\n\treturn res;\n}"
  },
  {
    "function_name": "nilfs_segbuf_submit_bh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "436-462",
    "snippet": "static int nilfs_segbuf_submit_bh(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t  struct nilfs_write_info *wi,\n\t\t\t\t  struct buffer_head *bh, int mode)\n{\n\tint len, err;\n\n\tBUG_ON(wi->nr_vecs <= 0);\n repeat:\n\tif (!wi->bio) {\n\t\twi->bio = nilfs_alloc_seg_bio(wi->nilfs, wi->blocknr + wi->end,\n\t\t\t\t\t      wi->nr_vecs);\n\t\tif (unlikely(!wi->bio))\n\t\t\treturn -ENOMEM;\n\t}\n\n\tlen = bio_add_page(wi->bio, bh->b_page, bh->b_size, bh_offset(bh));\n\tif (len == bh->b_size) {\n\t\twi->end++;\n\t\treturn 0;\n\t}\n\t/* bio is FULL */\n\terr = nilfs_segbuf_submit_bio(segbuf, wi, mode);\n\t/* never submit current bh */\n\tif (likely(!err))\n\t\tgoto repeat;\n\treturn err;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!err"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_segbuf_submit_bio",
          "args": [
            "segbuf",
            "wi",
            "mode"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_submit_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "358-396",
          "snippet": "static int nilfs_segbuf_submit_bio(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t   struct nilfs_write_info *wi, int mode)\n{\n\tstruct bio *bio = wi->bio;\n\tint err;\n\n\tif (segbuf->sb_nbio > 0 &&\n\t    bdi_write_congested(segbuf->sb_super->s_bdi)) {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t\tsegbuf->sb_nbio--;\n\t\tif (unlikely(atomic_read(&segbuf->sb_err))) {\n\t\t\tbio_put(bio);\n\t\t\terr = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t}\n\n\tbio->bi_end_io = nilfs_end_bio_write;\n\tbio->bi_private = segbuf;\n\tbio_get(bio);\n\tsubmit_bio(mode, bio);\n\tsegbuf->sb_nbio++;\n\tif (bio_flagged(bio, BIO_EOPNOTSUPP)) {\n\t\tbio_put(bio);\n\t\terr = -EOPNOTSUPP;\n\t\tgoto failed;\n\t}\n\tbio_put(bio);\n\n\twi->bio = NULL;\n\twi->rest_blocks -= wi->end - wi->start;\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end;\n\treturn 0;\n\n failed:\n\twi->bio = NULL;\n\treturn err;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_submit_bio(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t   struct nilfs_write_info *wi, int mode)\n{\n\tstruct bio *bio = wi->bio;\n\tint err;\n\n\tif (segbuf->sb_nbio > 0 &&\n\t    bdi_write_congested(segbuf->sb_super->s_bdi)) {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t\tsegbuf->sb_nbio--;\n\t\tif (unlikely(atomic_read(&segbuf->sb_err))) {\n\t\t\tbio_put(bio);\n\t\t\terr = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t}\n\n\tbio->bi_end_io = nilfs_end_bio_write;\n\tbio->bi_private = segbuf;\n\tbio_get(bio);\n\tsubmit_bio(mode, bio);\n\tsegbuf->sb_nbio++;\n\tif (bio_flagged(bio, BIO_EOPNOTSUPP)) {\n\t\tbio_put(bio);\n\t\terr = -EOPNOTSUPP;\n\t\tgoto failed;\n\t}\n\tbio_put(bio);\n\n\twi->bio = NULL;\n\twi->rest_blocks -= wi->end - wi->start;\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end;\n\treturn 0;\n\n failed:\n\twi->bio = NULL;\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_add_page",
          "args": [
            "wi->bio",
            "bh->b_page",
            "bh->b_size",
            "bh_offset(bh)"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!wi->bio"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_alloc_seg_bio",
          "args": [
            "wi->nilfs",
            "wi->blocknr + wi->end",
            "wi->nr_vecs"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_alloc_seg_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "407-423",
          "snippet": "static struct bio *nilfs_alloc_seg_bio(struct the_nilfs *nilfs, sector_t start,\n\t\t\t\t       int nr_vecs)\n{\n\tstruct bio *bio;\n\n\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\tif (bio == NULL) {\n\t\twhile (!bio && (nr_vecs >>= 1))\n\t\t\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\t}\n\tif (likely(bio)) {\n\t\tbio->bi_bdev = nilfs->ns_bdev;\n\t\tbio->bi_iter.bi_sector =\n\t\t\tstart << (nilfs->ns_blocksize_bits - 9);\n\t}\n\treturn bio;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\n\nstatic struct bio *nilfs_alloc_seg_bio(struct the_nilfs *nilfs, sector_t start,\n\t\t\t\t       int nr_vecs)\n{\n\tstruct bio *bio;\n\n\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\tif (bio == NULL) {\n\t\twhile (!bio && (nr_vecs >>= 1))\n\t\t\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\t}\n\tif (likely(bio)) {\n\t\tbio->bi_bdev = nilfs->ns_bdev;\n\t\tbio->bi_iter.bi_sector =\n\t\t\tstart << (nilfs->ns_blocksize_bits - 9);\n\t}\n\treturn bio;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "wi->nr_vecs <= 0"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_submit_bh(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t  struct nilfs_write_info *wi,\n\t\t\t\t  struct buffer_head *bh, int mode)\n{\n\tint len, err;\n\n\tBUG_ON(wi->nr_vecs <= 0);\n repeat:\n\tif (!wi->bio) {\n\t\twi->bio = nilfs_alloc_seg_bio(wi->nilfs, wi->blocknr + wi->end,\n\t\t\t\t\t      wi->nr_vecs);\n\t\tif (unlikely(!wi->bio))\n\t\t\treturn -ENOMEM;\n\t}\n\n\tlen = bio_add_page(wi->bio, bh->b_page, bh->b_size, bh_offset(bh));\n\tif (len == bh->b_size) {\n\t\twi->end++;\n\t\treturn 0;\n\t}\n\t/* bio is FULL */\n\terr = nilfs_segbuf_submit_bio(segbuf, wi, mode);\n\t/* never submit current bh */\n\tif (likely(!err))\n\t\tgoto repeat;\n\treturn err;\n}"
  },
  {
    "function_name": "nilfs_segbuf_prepare_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "425-434",
    "snippet": "static void nilfs_segbuf_prepare_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t       struct nilfs_write_info *wi)\n{\n\twi->bio = NULL;\n\twi->rest_blocks = segbuf->sb_sum.nblocks;\n\twi->max_pages = bio_get_nr_vecs(wi->nilfs->ns_bdev);\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end = 0;\n\twi->blocknr = segbuf->sb_pseg_start;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "min",
          "args": [
            "wi->max_pages",
            "wi->rest_blocks"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_get_nr_vecs",
          "args": [
            "wi->nilfs->ns_bdev"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_segbuf_prepare_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t       struct nilfs_write_info *wi)\n{\n\twi->bio = NULL;\n\twi->rest_blocks = segbuf->sb_sum.nblocks;\n\twi->max_pages = bio_get_nr_vecs(wi->nilfs->ns_bdev);\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end = 0;\n\twi->blocknr = segbuf->sb_pseg_start;\n}"
  },
  {
    "function_name": "nilfs_alloc_seg_bio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "407-423",
    "snippet": "static struct bio *nilfs_alloc_seg_bio(struct the_nilfs *nilfs, sector_t start,\n\t\t\t\t       int nr_vecs)\n{\n\tstruct bio *bio;\n\n\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\tif (bio == NULL) {\n\t\twhile (!bio && (nr_vecs >>= 1))\n\t\t\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\t}\n\tif (likely(bio)) {\n\t\tbio->bi_bdev = nilfs->ns_bdev;\n\t\tbio->bi_iter.bi_sector =\n\t\t\tstart << (nilfs->ns_blocksize_bits - 9);\n\t}\n\treturn bio;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bio"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_alloc",
          "args": [
            "GFP_NOIO",
            "nr_vecs"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_io_bio_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/extent_io.c",
          "lines": "2733-2746",
          "snippet": "struct bio *btrfs_io_bio_alloc(gfp_t gfp_mask, unsigned int nr_iovecs)\n{\n\tstruct btrfs_io_bio *btrfs_bio;\n\tstruct bio *bio;\n\n\tbio = bio_alloc_bioset(gfp_mask, nr_iovecs, btrfs_bioset);\n\tif (bio) {\n\t\tbtrfs_bio = btrfs_io_bio(bio);\n\t\tbtrfs_bio->csum = NULL;\n\t\tbtrfs_bio->csum_allocated = NULL;\n\t\tbtrfs_bio->end_io = NULL;\n\t}\n\treturn bio;\n}",
          "includes": [
            "#include \"backref.h\"",
            "#include \"rcu-string.h\"",
            "#include \"locking.h\"",
            "#include \"check-integrity.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"ctree.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/cleancache.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/bio.h>",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct bio_set *btrfs_bioset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"backref.h\"\n#include \"rcu-string.h\"\n#include \"locking.h\"\n#include \"check-integrity.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"ctree.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/cleancache.h>\n#include <linux/prefetch.h>\n#include <linux/pagevec.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/page-flags.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/bio.h>\n#include <linux/slab.h>\n#include <linux/bitops.h>\n\nstatic struct bio_set *btrfs_bioset;\n\nstruct bio *btrfs_io_bio_alloc(gfp_t gfp_mask, unsigned int nr_iovecs)\n{\n\tstruct btrfs_io_bio *btrfs_bio;\n\tstruct bio *bio;\n\n\tbio = bio_alloc_bioset(gfp_mask, nr_iovecs, btrfs_bioset);\n\tif (bio) {\n\t\tbtrfs_bio = btrfs_io_bio(bio);\n\t\tbtrfs_bio->csum = NULL;\n\t\tbtrfs_bio->csum_allocated = NULL;\n\t\tbtrfs_bio->end_io = NULL;\n\t}\n\treturn bio;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\n\nstatic struct bio *nilfs_alloc_seg_bio(struct the_nilfs *nilfs, sector_t start,\n\t\t\t\t       int nr_vecs)\n{\n\tstruct bio *bio;\n\n\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\tif (bio == NULL) {\n\t\twhile (!bio && (nr_vecs >>= 1))\n\t\t\tbio = bio_alloc(GFP_NOIO, nr_vecs);\n\t}\n\tif (likely(bio)) {\n\t\tbio->bi_bdev = nilfs->ns_bdev;\n\t\tbio->bi_iter.bi_sector =\n\t\t\tstart << (nilfs->ns_blocksize_bits - 9);\n\t}\n\treturn bio;\n}"
  },
  {
    "function_name": "nilfs_segbuf_submit_bio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "358-396",
    "snippet": "static int nilfs_segbuf_submit_bio(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t   struct nilfs_write_info *wi, int mode)\n{\n\tstruct bio *bio = wi->bio;\n\tint err;\n\n\tif (segbuf->sb_nbio > 0 &&\n\t    bdi_write_congested(segbuf->sb_super->s_bdi)) {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t\tsegbuf->sb_nbio--;\n\t\tif (unlikely(atomic_read(&segbuf->sb_err))) {\n\t\t\tbio_put(bio);\n\t\t\terr = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t}\n\n\tbio->bi_end_io = nilfs_end_bio_write;\n\tbio->bi_private = segbuf;\n\tbio_get(bio);\n\tsubmit_bio(mode, bio);\n\tsegbuf->sb_nbio++;\n\tif (bio_flagged(bio, BIO_EOPNOTSUPP)) {\n\t\tbio_put(bio);\n\t\terr = -EOPNOTSUPP;\n\t\tgoto failed;\n\t}\n\tbio_put(bio);\n\n\twi->bio = NULL;\n\twi->rest_blocks -= wi->end - wi->start;\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end;\n\treturn 0;\n\n failed:\n\twi->bio = NULL;\n\treturn err;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "min",
          "args": [
            "wi->max_pages",
            "wi->rest_blocks"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_put",
          "args": [
            "bio"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_put",
          "args": [
            "bio"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_flagged",
          "args": [
            "bio",
            "BIO_EOPNOTSUPP"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "submit_bio",
          "args": [
            "mode",
            "bio"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "bl_submit_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/blocklayout/blocklayout.c",
          "lines": "104-115",
          "snippet": "static struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"blocklayout.h\"",
            "#include \"../internal.h\"",
            "#include \"../nfs4session.h\"",
            "#include \"../pnfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/bio.h>\t\t/* struct bio */",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blocklayout.h\"\n#include \"../internal.h\"\n#include \"../nfs4session.h\"\n#include \"../pnfs.h\"\n#include <linux/pagevec.h>\n#include <linux/prefetch.h>\n#include <linux/bio.h>\t\t/* struct bio */\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_get",
          "args": [
            "bio"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_put",
          "args": [
            "bio"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "atomic_read(&segbuf->sb_err)"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&segbuf->sb_err"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&segbuf->sb_bio_event"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_for_completion_rpc_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "1116-1122",
          "snippet": "static int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bdi_write_congested",
          "args": [
            "segbuf->sb_super->s_bdi"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_submit_bio(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t   struct nilfs_write_info *wi, int mode)\n{\n\tstruct bio *bio = wi->bio;\n\tint err;\n\n\tif (segbuf->sb_nbio > 0 &&\n\t    bdi_write_congested(segbuf->sb_super->s_bdi)) {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t\tsegbuf->sb_nbio--;\n\t\tif (unlikely(atomic_read(&segbuf->sb_err))) {\n\t\t\tbio_put(bio);\n\t\t\terr = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t}\n\n\tbio->bi_end_io = nilfs_end_bio_write;\n\tbio->bi_private = segbuf;\n\tbio_get(bio);\n\tsubmit_bio(mode, bio);\n\tsegbuf->sb_nbio++;\n\tif (bio_flagged(bio, BIO_EOPNOTSUPP)) {\n\t\tbio_put(bio);\n\t\terr = -EOPNOTSUPP;\n\t\tgoto failed;\n\t}\n\tbio_put(bio);\n\n\twi->bio = NULL;\n\twi->rest_blocks -= wi->end - wi->start;\n\twi->nr_vecs = min(wi->max_pages, wi->rest_blocks);\n\twi->start = wi->end;\n\treturn 0;\n\n failed:\n\twi->bio = NULL;\n\treturn err;\n}"
  },
  {
    "function_name": "nilfs_end_bio_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "341-356",
    "snippet": "static void nilfs_end_bio_write(struct bio *bio, int err)\n{\n\tconst int uptodate = test_bit(BIO_UPTODATE, &bio->bi_flags);\n\tstruct nilfs_segment_buffer *segbuf = bio->bi_private;\n\n\tif (err == -EOPNOTSUPP) {\n\t\tset_bit(BIO_EOPNOTSUPP, &bio->bi_flags);\n\t\t/* to be detected by nilfs_segbuf_submit_bio() */\n\t}\n\n\tif (!uptodate)\n\t\tatomic_inc(&segbuf->sb_err);\n\n\tbio_put(bio);\n\tcomplete(&segbuf->sb_bio_event);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&segbuf->sb_bio_event"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segctor_complete_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segment.c",
          "lines": "1757-1852",
          "snippet": "static void nilfs_segctor_complete_write(struct nilfs_sc_info *sci)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tstruct page *bd_page = NULL, *fs_page = NULL;\n\tstruct the_nilfs *nilfs = sci->sc_super->s_fs_info;\n\tint update_sr = false;\n\n\tlist_for_each_entry(segbuf, &sci->sc_write_logs, sb_list) {\n\t\tstruct buffer_head *bh;\n\n\t\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\tif (bd_page)\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\tbd_page = bh->b_page;\n\t\t\t}\n\t\t}\n\t\t/*\n\t\t * We assume that the buffers which belong to the same page\n\t\t * continue over the buffer list.\n\t\t * Under this assumption, the last BHs of pages is\n\t\t * identifiable by the discontinuity of bh->b_page\n\t\t * (page != fs_page).\n\t\t *\n\t\t * For B-tree node blocks, however, this assumption is not\n\t\t * guaranteed.  The cleanup code of B-tree node pages needs\n\t\t * special care.\n\t\t */\n\t\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tclear_buffer_delay(bh);\n\t\t\tclear_buffer_nilfs_volatile(bh);\n\t\t\tclear_buffer_nilfs_redirected(bh);\n\t\t\tif (bh == segbuf->sb_super_root) {\n\t\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\t\tbd_page = bh->b_page;\n\t\t\t\t}\n\t\t\t\tupdate_sr = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (bh->b_page != fs_page) {\n\t\t\t\tnilfs_end_page_io(fs_page, 0);\n\t\t\t\tfs_page = bh->b_page;\n\t\t\t}\n\t\t}\n\n\t\tif (!nilfs_segbuf_simplex(segbuf)) {\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGBGN) {\n\t\t\t\tset_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t\t\tsci->sc_lseg_stime = jiffies;\n\t\t\t}\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGEND)\n\t\t\t\tclear_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t}\n\t}\n\t/*\n\t * Since pages may continue over multiple segment buffers,\n\t * end of the last page must be checked outside of the loop.\n\t */\n\tif (bd_page)\n\t\tend_page_writeback(bd_page);\n\n\tnilfs_end_page_io(fs_page, 0);\n\n\tnilfs_drop_collected_inodes(&sci->sc_dirty_files);\n\n\tif (nilfs_doing_gc())\n\t\tnilfs_drop_collected_inodes(&sci->sc_gc_inodes);\n\telse\n\t\tnilfs->ns_nongc_ctime = sci->sc_seg_ctime;\n\n\tsci->sc_nblk_inc += sci->sc_nblk_this_inc;\n\n\tsegbuf = NILFS_LAST_SEGBUF(&sci->sc_write_logs);\n\tnilfs_set_next_segment(nilfs, segbuf);\n\n\tif (update_sr) {\n\t\tnilfs->ns_flushed_device = 0;\n\t\tnilfs_set_last_segment(nilfs, segbuf->sb_pseg_start,\n\t\t\t\t       segbuf->sb_sum.seg_seq, nilfs->ns_cno++);\n\n\t\tclear_bit(NILFS_SC_HAVE_DELTA, &sci->sc_flags);\n\t\tclear_bit(NILFS_SC_DIRTY, &sci->sc_flags);\n\t\tset_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n\t\tnilfs_segctor_clear_metadata_dirty(sci);\n\t} else\n\t\tclear_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"sufile.h\"",
            "#include \"segment.h\"",
            "#include \"page.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/crc32.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/completion.h>",
            "#include <linux/bio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nilfs_segctor_start_timer(struct nilfs_sc_info *);",
            "static void nilfs_segctor_do_flush(struct nilfs_sc_info *, int);",
            "static void nilfs_segctor_do_immediate_flush(struct nilfs_sc_info *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"segment.h\"\n#include \"page.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/pagevec.h>\n#include <linux/crc32.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n#include <linux/pagemap.h>\n\nstatic void nilfs_segctor_start_timer(struct nilfs_sc_info *);\nstatic void nilfs_segctor_do_flush(struct nilfs_sc_info *, int);\nstatic void nilfs_segctor_do_immediate_flush(struct nilfs_sc_info *);\n\nstatic void nilfs_segctor_complete_write(struct nilfs_sc_info *sci)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tstruct page *bd_page = NULL, *fs_page = NULL;\n\tstruct the_nilfs *nilfs = sci->sc_super->s_fs_info;\n\tint update_sr = false;\n\n\tlist_for_each_entry(segbuf, &sci->sc_write_logs, sb_list) {\n\t\tstruct buffer_head *bh;\n\n\t\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\tif (bd_page)\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\tbd_page = bh->b_page;\n\t\t\t}\n\t\t}\n\t\t/*\n\t\t * We assume that the buffers which belong to the same page\n\t\t * continue over the buffer list.\n\t\t * Under this assumption, the last BHs of pages is\n\t\t * identifiable by the discontinuity of bh->b_page\n\t\t * (page != fs_page).\n\t\t *\n\t\t * For B-tree node blocks, however, this assumption is not\n\t\t * guaranteed.  The cleanup code of B-tree node pages needs\n\t\t * special care.\n\t\t */\n\t\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tclear_buffer_delay(bh);\n\t\t\tclear_buffer_nilfs_volatile(bh);\n\t\t\tclear_buffer_nilfs_redirected(bh);\n\t\t\tif (bh == segbuf->sb_super_root) {\n\t\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\t\tbd_page = bh->b_page;\n\t\t\t\t}\n\t\t\t\tupdate_sr = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (bh->b_page != fs_page) {\n\t\t\t\tnilfs_end_page_io(fs_page, 0);\n\t\t\t\tfs_page = bh->b_page;\n\t\t\t}\n\t\t}\n\n\t\tif (!nilfs_segbuf_simplex(segbuf)) {\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGBGN) {\n\t\t\t\tset_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t\t\tsci->sc_lseg_stime = jiffies;\n\t\t\t}\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGEND)\n\t\t\t\tclear_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t}\n\t}\n\t/*\n\t * Since pages may continue over multiple segment buffers,\n\t * end of the last page must be checked outside of the loop.\n\t */\n\tif (bd_page)\n\t\tend_page_writeback(bd_page);\n\n\tnilfs_end_page_io(fs_page, 0);\n\n\tnilfs_drop_collected_inodes(&sci->sc_dirty_files);\n\n\tif (nilfs_doing_gc())\n\t\tnilfs_drop_collected_inodes(&sci->sc_gc_inodes);\n\telse\n\t\tnilfs->ns_nongc_ctime = sci->sc_seg_ctime;\n\n\tsci->sc_nblk_inc += sci->sc_nblk_this_inc;\n\n\tsegbuf = NILFS_LAST_SEGBUF(&sci->sc_write_logs);\n\tnilfs_set_next_segment(nilfs, segbuf);\n\n\tif (update_sr) {\n\t\tnilfs->ns_flushed_device = 0;\n\t\tnilfs_set_last_segment(nilfs, segbuf->sb_pseg_start,\n\t\t\t\t       segbuf->sb_sum.seg_seq, nilfs->ns_cno++);\n\n\t\tclear_bit(NILFS_SC_HAVE_DELTA, &sci->sc_flags);\n\t\tclear_bit(NILFS_SC_DIRTY, &sci->sc_flags);\n\t\tset_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n\t\tnilfs_segctor_clear_metadata_dirty(sci);\n\t} else\n\t\tclear_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_put",
          "args": [
            "bio"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&segbuf->sb_err"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "BIO_EOPNOTSUPP",
            "&bio->bi_flags"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "BIO_UPTODATE",
            "&bio->bi_flags"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_end_bio_write(struct bio *bio, int err)\n{\n\tconst int uptodate = test_bit(BIO_UPTODATE, &bio->bi_flags);\n\tstruct nilfs_segment_buffer *segbuf = bio->bi_private;\n\n\tif (err == -EOPNOTSUPP) {\n\t\tset_bit(BIO_EOPNOTSUPP, &bio->bi_flags);\n\t\t/* to be detected by nilfs_segbuf_submit_bio() */\n\t}\n\n\tif (!uptodate)\n\t\tatomic_inc(&segbuf->sb_err);\n\n\tbio_put(bio);\n\tcomplete(&segbuf->sb_bio_event);\n}"
  },
  {
    "function_name": "nilfs_add_checksums_on_logs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "326-336",
    "snippet": "void nilfs_add_checksums_on_logs(struct list_head *logs, u32 seed)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\n\tlist_for_each_entry(segbuf, logs, sb_list) {\n\t\tif (segbuf->sb_super_root)\n\t\t\tnilfs_segbuf_fill_in_super_root_crc(segbuf, seed);\n\t\tnilfs_segbuf_fill_in_segsum_crc(segbuf, seed);\n\t\tnilfs_segbuf_fill_in_data_crc(segbuf, seed);\n\t}\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_fill_in_data_crc",
          "args": [
            "segbuf",
            "seed"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_fill_in_data_crc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "210-235",
          "snippet": "static void nilfs_segbuf_fill_in_data_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t\t  u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tvoid *kaddr;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum + sizeof(raw_sum->ss_datasum),\n\t\t       bh->b_size - sizeof(raw_sum->ss_datasum));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tcrc = crc32_le(crc, bh->b_data, bh->b_size);\n\t}\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tkaddr = kmap_atomic(bh->b_page);\n\t\tcrc = crc32_le(crc, kaddr + bh_offset(bh), bh->b_size);\n\t\tkunmap_atomic(kaddr);\n\t}\n\traw_sum->ss_datasum = cpu_to_le32(crc);\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_segbuf_fill_in_data_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t\t  u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tvoid *kaddr;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum + sizeof(raw_sum->ss_datasum),\n\t\t       bh->b_size - sizeof(raw_sum->ss_datasum));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tcrc = crc32_le(crc, bh->b_data, bh->b_size);\n\t}\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tkaddr = kmap_atomic(bh->b_page);\n\t\tcrc = crc32_le(crc, kaddr + bh_offset(bh), bh->b_size);\n\t\tkunmap_atomic(kaddr);\n\t}\n\traw_sum->ss_datasum = cpu_to_le32(crc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_segbuf_fill_in_segsum_crc",
          "args": [
            "segbuf",
            "seed"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_fill_in_segsum_crc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "182-208",
          "snippet": "static void\nnilfs_segbuf_fill_in_segsum_crc(struct nilfs_segment_buffer *segbuf, u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tunsigned long size, bytes = segbuf->sb_sum.sumbytes;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tsize = min_t(unsigned long, bytes, bh->b_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum +\n\t\t       sizeof(raw_sum->ss_datasum) + sizeof(raw_sum->ss_sumsum),\n\t\t       size - (sizeof(raw_sum->ss_datasum) +\n\t\t\t       sizeof(raw_sum->ss_sumsum)));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tbytes -= size;\n\t\tsize = min_t(unsigned long, bytes, bh->b_size);\n\t\tcrc = crc32_le(crc, bh->b_data, size);\n\t}\n\traw_sum->ss_sumsum = cpu_to_le32(crc);\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void\nnilfs_segbuf_fill_in_segsum_crc(struct nilfs_segment_buffer *segbuf, u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tunsigned long size, bytes = segbuf->sb_sum.sumbytes;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tsize = min_t(unsigned long, bytes, bh->b_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum +\n\t\t       sizeof(raw_sum->ss_datasum) + sizeof(raw_sum->ss_sumsum),\n\t\t       size - (sizeof(raw_sum->ss_datasum) +\n\t\t\t       sizeof(raw_sum->ss_sumsum)));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tbytes -= size;\n\t\tsize = min_t(unsigned long, bytes, bh->b_size);\n\t\tcrc = crc32_le(crc, bh->b_data, size);\n\t}\n\traw_sum->ss_sumsum = cpu_to_le32(crc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_segbuf_fill_in_super_root_crc",
          "args": [
            "segbuf",
            "seed"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_fill_in_super_root_crc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "237-252",
          "snippet": "static void\nnilfs_segbuf_fill_in_super_root_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t    u32 seed)\n{\n\tstruct nilfs_super_root *raw_sr;\n\tstruct the_nilfs *nilfs = segbuf->sb_super->s_fs_info;\n\tunsigned srsize;\n\tu32 crc;\n\n\traw_sr = (struct nilfs_super_root *)segbuf->sb_super_root->b_data;\n\tsrsize = NILFS_SR_BYTES(nilfs->ns_inode_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sr + sizeof(raw_sr->sr_sum),\n\t\t       srsize - sizeof(raw_sr->sr_sum));\n\traw_sr->sr_sum = cpu_to_le32(crc);\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void\nnilfs_segbuf_fill_in_super_root_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t    u32 seed)\n{\n\tstruct nilfs_super_root *raw_sr;\n\tstruct the_nilfs *nilfs = segbuf->sb_super->s_fs_info;\n\tunsigned srsize;\n\tu32 crc;\n\n\traw_sr = (struct nilfs_super_root *)segbuf->sb_super_root->b_data;\n\tsrsize = NILFS_SR_BYTES(nilfs->ns_inode_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sr + sizeof(raw_sr->sr_sum),\n\t\t       srsize - sizeof(raw_sr->sr_sum));\n\traw_sr->sr_sum = cpu_to_le32(crc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "segbuf",
            "logs",
            "sb_list"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_add_checksums_on_logs(struct list_head *logs, u32 seed)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\n\tlist_for_each_entry(segbuf, logs, sb_list) {\n\t\tif (segbuf->sb_super_root)\n\t\t\tnilfs_segbuf_fill_in_super_root_crc(segbuf, seed);\n\t\tnilfs_segbuf_fill_in_segsum_crc(segbuf, seed);\n\t\tnilfs_segbuf_fill_in_data_crc(segbuf, seed);\n\t}\n}"
  },
  {
    "function_name": "nilfs_wait_on_logs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "308-319",
    "snippet": "int nilfs_wait_on_logs(struct list_head *logs)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tint err, ret = 0;\n\n\tlist_for_each_entry(segbuf, logs, sb_list) {\n\t\terr = nilfs_segbuf_wait(segbuf);\n\t\tif (err && !ret)\n\t\t\tret = err;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_wait",
          "args": [
            "segbuf"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "520-536",
          "snippet": "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf)\n{\n\tint err = 0;\n\n\tif (!segbuf->sb_nbio)\n\t\treturn 0;\n\n\tdo {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t} while (--segbuf->sb_nbio > 0);\n\n\tif (unlikely(atomic_read(&segbuf->sb_err) > 0)) {\n\t\tprintk(KERN_ERR \"NILFS: IO error writing segment\\n\");\n\t\terr = -EIO;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf)\n{\n\tint err = 0;\n\n\tif (!segbuf->sb_nbio)\n\t\treturn 0;\n\n\tdo {\n\t\twait_for_completion(&segbuf->sb_bio_event);\n\t} while (--segbuf->sb_nbio > 0);\n\n\tif (unlikely(atomic_read(&segbuf->sb_err) > 0)) {\n\t\tprintk(KERN_ERR \"NILFS: IO error writing segment\\n\");\n\t\terr = -EIO;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "segbuf",
            "logs",
            "sb_list"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nint nilfs_wait_on_logs(struct list_head *logs)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tint err, ret = 0;\n\n\tlist_for_each_entry(segbuf, logs, sb_list) {\n\t\terr = nilfs_segbuf_wait(segbuf);\n\t\tif (err && !ret)\n\t\t\tret = err;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_write_logs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "295-306",
    "snippet": "int nilfs_write_logs(struct list_head *logs, struct the_nilfs *nilfs)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tint ret = 0;\n\n\tlist_for_each_entry(segbuf, logs, sb_list) {\n\t\tret = nilfs_segbuf_write(segbuf, nilfs);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_write",
          "args": [
            "segbuf",
            "nilfs"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "476-509",
          "snippet": "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs)\n{\n\tstruct nilfs_write_info wi;\n\tstruct buffer_head *bh;\n\tint res = 0, rw = WRITE;\n\n\twi.nilfs = nilfs;\n\tnilfs_segbuf_prepare_write(segbuf, &wi);\n\n\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tif (wi.bio) {\n\t\t/*\n\t\t * Last BIO is always sent through the following\n\t\t * submission.\n\t\t */\n\t\trw |= REQ_SYNC;\n\t\tres = nilfs_segbuf_submit_bio(segbuf, &wi, rw);\n\t}\n\n failed_bio:\n\treturn res;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs)\n{\n\tstruct nilfs_write_info wi;\n\tstruct buffer_head *bh;\n\tint res = 0, rw = WRITE;\n\n\twi.nilfs = nilfs;\n\tnilfs_segbuf_prepare_write(segbuf, &wi);\n\n\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tres = nilfs_segbuf_submit_bh(segbuf, &wi, bh, rw);\n\t\tif (unlikely(res))\n\t\t\tgoto failed_bio;\n\t}\n\n\tif (wi.bio) {\n\t\t/*\n\t\t * Last BIO is always sent through the following\n\t\t * submission.\n\t\t */\n\t\trw |= REQ_SYNC;\n\t\tres = nilfs_segbuf_submit_bio(segbuf, &wi, rw);\n\t}\n\n failed_bio:\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "segbuf",
            "logs",
            "sb_list"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nint nilfs_write_logs(struct list_head *logs, struct the_nilfs *nilfs)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tint ret = 0;\n\n\tlist_for_each_entry(segbuf, logs, sb_list) {\n\t\tret = nilfs_segbuf_write(segbuf, nilfs);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_truncate_logs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "282-293",
    "snippet": "void nilfs_truncate_logs(struct list_head *logs,\n\t\t\t struct nilfs_segment_buffer *last)\n{\n\tstruct nilfs_segment_buffer *n, *segbuf;\n\n\tsegbuf = list_prepare_entry(last, logs, sb_list);\n\tlist_for_each_entry_safe_continue(segbuf, n, logs, sb_list) {\n\t\tlist_del_init(&segbuf->sb_list);\n\t\tnilfs_segbuf_clear(segbuf);\n\t\tnilfs_segbuf_free(segbuf);\n\t}\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_free",
          "args": [
            "segbuf"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "68-71",
          "snippet": "void nilfs_segbuf_free(struct nilfs_segment_buffer *segbuf)\n{\n\tkmem_cache_free(nilfs_segbuf_cachep, segbuf);\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_segbuf_free(struct nilfs_segment_buffer *segbuf)\n{\n\tkmem_cache_free(nilfs_segbuf_cachep, segbuf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_segbuf_clear",
          "args": [
            "segbuf"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "264-269",
          "snippet": "static void nilfs_segbuf_clear(struct nilfs_segment_buffer *segbuf)\n{\n\tnilfs_release_buffers(&segbuf->sb_segsum_buffers);\n\tnilfs_release_buffers(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_segbuf_clear(struct nilfs_segment_buffer *segbuf)\n{\n\tnilfs_release_buffers(&segbuf->sb_segsum_buffers);\n\tnilfs_release_buffers(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&segbuf->sb_list"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe_continue",
          "args": [
            "segbuf",
            "n",
            "logs",
            "sb_list"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_prepare_entry",
          "args": [
            "last",
            "logs",
            "sb_list"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_truncate_logs(struct list_head *logs,\n\t\t\t struct nilfs_segment_buffer *last)\n{\n\tstruct nilfs_segment_buffer *n, *segbuf;\n\n\tsegbuf = list_prepare_entry(last, logs, sb_list);\n\tlist_for_each_entry_safe_continue(segbuf, n, logs, sb_list) {\n\t\tlist_del_init(&segbuf->sb_list);\n\t\tnilfs_segbuf_clear(segbuf);\n\t\tnilfs_segbuf_free(segbuf);\n\t}\n}"
  },
  {
    "function_name": "nilfs_clear_logs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "274-280",
    "snippet": "void nilfs_clear_logs(struct list_head *logs)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\n\tlist_for_each_entry(segbuf, logs, sb_list)\n\t\tnilfs_segbuf_clear(segbuf);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_clear",
          "args": [
            "segbuf"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "264-269",
          "snippet": "static void nilfs_segbuf_clear(struct nilfs_segment_buffer *segbuf)\n{\n\tnilfs_release_buffers(&segbuf->sb_segsum_buffers);\n\tnilfs_release_buffers(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_segbuf_clear(struct nilfs_segment_buffer *segbuf)\n{\n\tnilfs_release_buffers(&segbuf->sb_segsum_buffers);\n\tnilfs_release_buffers(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "segbuf",
            "logs",
            "sb_list"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_clear_logs(struct list_head *logs)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\n\tlist_for_each_entry(segbuf, logs, sb_list)\n\t\tnilfs_segbuf_clear(segbuf);\n}"
  },
  {
    "function_name": "nilfs_segbuf_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "264-269",
    "snippet": "static void nilfs_segbuf_clear(struct nilfs_segment_buffer *segbuf)\n{\n\tnilfs_release_buffers(&segbuf->sb_segsum_buffers);\n\tnilfs_release_buffers(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_release_buffers",
          "args": [
            "&segbuf->sb_payload_buffers"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_release_buffers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "254-262",
          "snippet": "static void nilfs_release_buffers(struct list_head *list)\n{\n\tstruct buffer_head *bh, *n;\n\n\tlist_for_each_entry_safe(bh, n, list, b_assoc_buffers) {\n\t\tlist_del_init(&bh->b_assoc_buffers);\n\t\tbrelse(bh);\n\t}\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic void nilfs_release_buffers(struct list_head *list)\n{\n\tstruct buffer_head *bh, *n;\n\n\tlist_for_each_entry_safe(bh, n, list, b_assoc_buffers) {\n\t\tlist_del_init(&bh->b_assoc_buffers);\n\t\tbrelse(bh);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_segbuf_clear(struct nilfs_segment_buffer *segbuf)\n{\n\tnilfs_release_buffers(&segbuf->sb_segsum_buffers);\n\tnilfs_release_buffers(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n}"
  },
  {
    "function_name": "nilfs_release_buffers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "254-262",
    "snippet": "static void nilfs_release_buffers(struct list_head *list)\n{\n\tstruct buffer_head *bh, *n;\n\n\tlist_for_each_entry_safe(bh, n, list, b_assoc_buffers) {\n\t\tlist_del_init(&bh->b_assoc_buffers);\n\t\tbrelse(bh);\n\t}\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&bh->b_assoc_buffers"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "bh",
            "n",
            "list",
            "b_assoc_buffers"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic void nilfs_release_buffers(struct list_head *list)\n{\n\tstruct buffer_head *bh, *n;\n\n\tlist_for_each_entry_safe(bh, n, list, b_assoc_buffers) {\n\t\tlist_del_init(&bh->b_assoc_buffers);\n\t\tbrelse(bh);\n\t}\n}"
  },
  {
    "function_name": "nilfs_segbuf_fill_in_super_root_crc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "237-252",
    "snippet": "static void\nnilfs_segbuf_fill_in_super_root_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t    u32 seed)\n{\n\tstruct nilfs_super_root *raw_sr;\n\tstruct the_nilfs *nilfs = segbuf->sb_super->s_fs_info;\n\tunsigned srsize;\n\tu32 crc;\n\n\traw_sr = (struct nilfs_super_root *)segbuf->sb_super_root->b_data;\n\tsrsize = NILFS_SR_BYTES(nilfs->ns_inode_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sr + sizeof(raw_sr->sr_sum),\n\t\t       srsize - sizeof(raw_sr->sr_sum));\n\traw_sr->sr_sum = cpu_to_le32(crc);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "crc"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "seed",
            "(unsigned char *)raw_sr + sizeof(raw_sr->sr_sum)",
            "srsize - sizeof(raw_sr->sr_sum)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_SR_BYTES",
          "args": [
            "nilfs->ns_inode_size"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void\nnilfs_segbuf_fill_in_super_root_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t    u32 seed)\n{\n\tstruct nilfs_super_root *raw_sr;\n\tstruct the_nilfs *nilfs = segbuf->sb_super->s_fs_info;\n\tunsigned srsize;\n\tu32 crc;\n\n\traw_sr = (struct nilfs_super_root *)segbuf->sb_super_root->b_data;\n\tsrsize = NILFS_SR_BYTES(nilfs->ns_inode_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sr + sizeof(raw_sr->sr_sum),\n\t\t       srsize - sizeof(raw_sr->sr_sum));\n\traw_sr->sr_sum = cpu_to_le32(crc);\n}"
  },
  {
    "function_name": "nilfs_segbuf_fill_in_data_crc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "210-235",
    "snippet": "static void nilfs_segbuf_fill_in_data_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t\t  u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tvoid *kaddr;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum + sizeof(raw_sum->ss_datasum),\n\t\t       bh->b_size - sizeof(raw_sum->ss_datasum));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tcrc = crc32_le(crc, bh->b_data, bh->b_size);\n\t}\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tkaddr = kmap_atomic(bh->b_page);\n\t\tcrc = crc32_le(crc, kaddr + bh_offset(bh), bh->b_size);\n\t\tkunmap_atomic(kaddr);\n\t}\n\traw_sum->ss_datasum = cpu_to_le32(crc);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "crc"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "crc",
            "kaddr + bh_offset(bh)",
            "bh->b_size"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "bh->b_page"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "bh",
            "&segbuf->sb_payload_buffers",
            "b_assoc_buffers"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "crc",
            "bh->b_data",
            "bh->b_size"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_continue",
          "args": [
            "bh",
            "&segbuf->sb_segsum_buffers",
            "b_assoc_buffers"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "seed",
            "(unsigned char *)raw_sum + sizeof(raw_sum->ss_datasum)",
            "bh->b_size - sizeof(raw_sum->ss_datasum)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "segbuf->sb_segsum_buffers.next",
            "structbuffer_head",
            "b_assoc_buffers"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void nilfs_segbuf_fill_in_data_crc(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t\t  u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tvoid *kaddr;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum + sizeof(raw_sum->ss_datasum),\n\t\t       bh->b_size - sizeof(raw_sum->ss_datasum));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tcrc = crc32_le(crc, bh->b_data, bh->b_size);\n\t}\n\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers, b_assoc_buffers) {\n\t\tkaddr = kmap_atomic(bh->b_page);\n\t\tcrc = crc32_le(crc, kaddr + bh_offset(bh), bh->b_size);\n\t\tkunmap_atomic(kaddr);\n\t}\n\traw_sum->ss_datasum = cpu_to_le32(crc);\n}"
  },
  {
    "function_name": "nilfs_segbuf_fill_in_segsum_crc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "182-208",
    "snippet": "static void\nnilfs_segbuf_fill_in_segsum_crc(struct nilfs_segment_buffer *segbuf, u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tunsigned long size, bytes = segbuf->sb_sum.sumbytes;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tsize = min_t(unsigned long, bytes, bh->b_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum +\n\t\t       sizeof(raw_sum->ss_datasum) + sizeof(raw_sum->ss_sumsum),\n\t\t       size - (sizeof(raw_sum->ss_datasum) +\n\t\t\t       sizeof(raw_sum->ss_sumsum)));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tbytes -= size;\n\t\tsize = min_t(unsigned long, bytes, bh->b_size);\n\t\tcrc = crc32_le(crc, bh->b_data, size);\n\t}\n\traw_sum->ss_sumsum = cpu_to_le32(crc);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "crc"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "crc",
            "bh->b_data",
            "size"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedlong",
            "bytes",
            "bh->b_size"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_continue",
          "args": [
            "bh",
            "&segbuf->sb_segsum_buffers",
            "b_assoc_buffers"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "seed",
            "(unsigned char *)raw_sum +\n\t\t       sizeof(raw_sum->ss_datasum) + sizeof(raw_sum->ss_sumsum)",
            "size - (sizeof(raw_sum->ss_datasum) +\n\t\t\t       sizeof(raw_sum->ss_sumsum))"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedlong",
            "bytes",
            "bh->b_size"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "segbuf->sb_segsum_buffers.next",
            "structbuffer_head",
            "b_assoc_buffers"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstatic void\nnilfs_segbuf_fill_in_segsum_crc(struct nilfs_segment_buffer *segbuf, u32 seed)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_segment_summary *raw_sum;\n\tunsigned long size, bytes = segbuf->sb_sum.sumbytes;\n\tu32 crc;\n\n\tbh = list_entry(segbuf->sb_segsum_buffers.next, struct buffer_head,\n\t\t\tb_assoc_buffers);\n\n\traw_sum = (struct nilfs_segment_summary *)bh->b_data;\n\tsize = min_t(unsigned long, bytes, bh->b_size);\n\tcrc = crc32_le(seed,\n\t\t       (unsigned char *)raw_sum +\n\t\t       sizeof(raw_sum->ss_datasum) + sizeof(raw_sum->ss_sumsum),\n\t\t       size - (sizeof(raw_sum->ss_datasum) +\n\t\t\t       sizeof(raw_sum->ss_sumsum)));\n\n\tlist_for_each_entry_continue(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t     b_assoc_buffers) {\n\t\tbytes -= size;\n\t\tsize = min_t(unsigned long, bytes, bh->b_size);\n\t\tcrc = crc32_le(crc, bh->b_data, size);\n\t}\n\traw_sum->ss_sumsum = cpu_to_le32(crc);\n}"
  },
  {
    "function_name": "nilfs_segbuf_fill_in_segsum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "157-177",
    "snippet": "void nilfs_segbuf_fill_in_segsum(struct nilfs_segment_buffer *segbuf)\n{\n\tstruct nilfs_segment_summary *raw_sum;\n\tstruct buffer_head *bh_sum;\n\n\tbh_sum = list_entry(segbuf->sb_segsum_buffers.next,\n\t\t\t    struct buffer_head, b_assoc_buffers);\n\traw_sum = (struct nilfs_segment_summary *)bh_sum->b_data;\n\n\traw_sum->ss_magic    = cpu_to_le32(NILFS_SEGSUM_MAGIC);\n\traw_sum->ss_bytes    = cpu_to_le16(sizeof(*raw_sum));\n\traw_sum->ss_flags    = cpu_to_le16(segbuf->sb_sum.flags);\n\traw_sum->ss_seq      = cpu_to_le64(segbuf->sb_sum.seg_seq);\n\traw_sum->ss_create   = cpu_to_le64(segbuf->sb_sum.ctime);\n\traw_sum->ss_next     = cpu_to_le64(segbuf->sb_sum.next);\n\traw_sum->ss_nblocks  = cpu_to_le32(segbuf->sb_sum.nblocks);\n\traw_sum->ss_nfinfo   = cpu_to_le32(segbuf->sb_sum.nfinfo);\n\traw_sum->ss_sumbytes = cpu_to_le32(segbuf->sb_sum.sumbytes);\n\traw_sum->ss_pad      = 0;\n\traw_sum->ss_cno      = cpu_to_le64(segbuf->sb_sum.cno);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "segbuf->sb_sum.cno"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "segbuf->sb_sum.sumbytes"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "segbuf->sb_sum.nfinfo"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "segbuf->sb_sum.nblocks"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "segbuf->sb_sum.next"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "segbuf->sb_sum.ctime"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "segbuf->sb_sum.seg_seq"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "segbuf->sb_sum.flags"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "sizeof(*raw_sum)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "NILFS_SEGSUM_MAGIC"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "segbuf->sb_segsum_buffers.next",
            "structbuffer_head",
            "b_assoc_buffers"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_segbuf_fill_in_segsum(struct nilfs_segment_buffer *segbuf)\n{\n\tstruct nilfs_segment_summary *raw_sum;\n\tstruct buffer_head *bh_sum;\n\n\tbh_sum = list_entry(segbuf->sb_segsum_buffers.next,\n\t\t\t    struct buffer_head, b_assoc_buffers);\n\traw_sum = (struct nilfs_segment_summary *)bh_sum->b_data;\n\n\traw_sum->ss_magic    = cpu_to_le32(NILFS_SEGSUM_MAGIC);\n\traw_sum->ss_bytes    = cpu_to_le16(sizeof(*raw_sum));\n\traw_sum->ss_flags    = cpu_to_le16(segbuf->sb_sum.flags);\n\traw_sum->ss_seq      = cpu_to_le64(segbuf->sb_sum.seg_seq);\n\traw_sum->ss_create   = cpu_to_le64(segbuf->sb_sum.ctime);\n\traw_sum->ss_next     = cpu_to_le64(segbuf->sb_sum.next);\n\traw_sum->ss_nblocks  = cpu_to_le32(segbuf->sb_sum.nblocks);\n\traw_sum->ss_nfinfo   = cpu_to_le32(segbuf->sb_sum.nfinfo);\n\traw_sum->ss_sumbytes = cpu_to_le32(segbuf->sb_sum.sumbytes);\n\traw_sum->ss_pad      = 0;\n\traw_sum->ss_cno      = cpu_to_le64(segbuf->sb_sum.cno);\n}"
  },
  {
    "function_name": "nilfs_segbuf_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "136-152",
    "snippet": "int nilfs_segbuf_reset(struct nilfs_segment_buffer *segbuf, unsigned flags,\n\t\t       time_t ctime, __u64 cno)\n{\n\tint err;\n\n\tsegbuf->sb_sum.nblocks = segbuf->sb_sum.nsumblk = 0;\n\terr = nilfs_segbuf_extend_segsum(segbuf);\n\tif (unlikely(err))\n\t\treturn err;\n\n\tsegbuf->sb_sum.flags = flags;\n\tsegbuf->sb_sum.sumbytes = sizeof(struct nilfs_segment_summary);\n\tsegbuf->sb_sum.nfinfo = segbuf->sb_sum.nfileblk = 0;\n\tsegbuf->sb_sum.ctime = ctime;\n\tsegbuf->sb_sum.cno = cno;\n\treturn 0;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "err"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_segbuf_extend_segsum",
          "args": [
            "segbuf"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_extend_segsum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "108-119",
          "snippet": "int nilfs_segbuf_extend_segsum(struct nilfs_segment_buffer *segbuf)\n{\n\tstruct buffer_head *bh;\n\n\tbh = sb_getblk(segbuf->sb_super,\n\t\t       segbuf->sb_pseg_start + segbuf->sb_sum.nsumblk);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\tnilfs_segbuf_add_segsum_buffer(segbuf, bh);\n\treturn 0;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nint nilfs_segbuf_extend_segsum(struct nilfs_segment_buffer *segbuf)\n{\n\tstruct buffer_head *bh;\n\n\tbh = sb_getblk(segbuf->sb_super,\n\t\t       segbuf->sb_pseg_start + segbuf->sb_sum.nsumblk);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\tnilfs_segbuf_add_segsum_buffer(segbuf, bh);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nint nilfs_segbuf_reset(struct nilfs_segment_buffer *segbuf, unsigned flags,\n\t\t       time_t ctime, __u64 cno)\n{\n\tint err;\n\n\tsegbuf->sb_sum.nblocks = segbuf->sb_sum.nsumblk = 0;\n\terr = nilfs_segbuf_extend_segsum(segbuf);\n\tif (unlikely(err))\n\t\treturn err;\n\n\tsegbuf->sb_sum.flags = flags;\n\tsegbuf->sb_sum.sumbytes = sizeof(struct nilfs_segment_summary);\n\tsegbuf->sb_sum.nfinfo = segbuf->sb_sum.nfileblk = 0;\n\tsegbuf->sb_sum.ctime = ctime;\n\tsegbuf->sb_sum.cno = cno;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_segbuf_extend_payload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "121-134",
    "snippet": "int nilfs_segbuf_extend_payload(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head **bhp)\n{\n\tstruct buffer_head *bh;\n\n\tbh = sb_getblk(segbuf->sb_super,\n\t\t       segbuf->sb_pseg_start + segbuf->sb_sum.nblocks);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\tnilfs_segbuf_add_payload_buffer(segbuf, bh);\n\t*bhp = bh;\n\treturn 0;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_add_payload_buffer",
          "args": [
            "segbuf",
            "bh"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_add_payload_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
          "lines": "155-161",
          "snippet": "static inline void\nnilfs_segbuf_add_payload_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_payload_buffers);\n\tsegbuf->sb_sum.nblocks++;\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/bio.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nnilfs_segbuf_add_payload_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_payload_buffers);\n\tsegbuf->sb_sum.nblocks++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!bh"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_getblk",
          "args": [
            "segbuf->sb_super",
            "segbuf->sb_pseg_start + segbuf->sb_sum.nblocks"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nint nilfs_segbuf_extend_payload(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head **bhp)\n{\n\tstruct buffer_head *bh;\n\n\tbh = sb_getblk(segbuf->sb_super,\n\t\t       segbuf->sb_pseg_start + segbuf->sb_sum.nblocks);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\tnilfs_segbuf_add_payload_buffer(segbuf, bh);\n\t*bhp = bh;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_segbuf_extend_segsum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "108-119",
    "snippet": "int nilfs_segbuf_extend_segsum(struct nilfs_segment_buffer *segbuf)\n{\n\tstruct buffer_head *bh;\n\n\tbh = sb_getblk(segbuf->sb_super,\n\t\t       segbuf->sb_pseg_start + segbuf->sb_sum.nsumblk);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\tnilfs_segbuf_add_segsum_buffer(segbuf, bh);\n\treturn 0;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_add_segsum_buffer",
          "args": [
            "segbuf",
            "bh"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_add_segsum_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
          "lines": "146-153",
          "snippet": "static inline void\nnilfs_segbuf_add_segsum_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t       struct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_segsum_buffers);\n\tsegbuf->sb_sum.nblocks++;\n\tsegbuf->sb_sum.nsumblk++;\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/bio.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nnilfs_segbuf_add_segsum_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t       struct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_segsum_buffers);\n\tsegbuf->sb_sum.nblocks++;\n\tsegbuf->sb_sum.nsumblk++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!bh"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_getblk",
          "args": [
            "segbuf->sb_super",
            "segbuf->sb_pseg_start + segbuf->sb_sum.nsumblk"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nint nilfs_segbuf_extend_segsum(struct nilfs_segment_buffer *segbuf)\n{\n\tstruct buffer_head *bh;\n\n\tbh = sb_getblk(segbuf->sb_super,\n\t\t       segbuf->sb_pseg_start + segbuf->sb_sum.nsumblk);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\tnilfs_segbuf_add_segsum_buffer(segbuf, bh);\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_segbuf_set_next_segnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "101-106",
    "snippet": "void nilfs_segbuf_set_next_segnum(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t  __u64 nextnum, struct the_nilfs *nilfs)\n{\n\tsegbuf->sb_nextnum = nextnum;\n\tsegbuf->sb_sum.next = nilfs_get_segment_start_blocknr(nilfs, nextnum);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_get_segment_start_blocknr",
          "args": [
            "nilfs",
            "nextnum"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_get_segment_start_blocknr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
          "lines": "329-334",
          "snippet": "static inline sector_t\nnilfs_get_segment_start_blocknr(struct the_nilfs *nilfs, __u64 segnum)\n{\n\treturn (segnum == 0) ? nilfs->ns_first_data_block :\n\t\t(sector_t)nilfs->ns_blocks_per_segment * segnum;\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline sector_t\nnilfs_get_segment_start_blocknr(struct the_nilfs *nilfs, __u64 segnum)\n{\n\treturn (segnum == 0) ? nilfs->ns_first_data_block :\n\t\t(sector_t)nilfs->ns_blocks_per_segment * segnum;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_segbuf_set_next_segnum(struct nilfs_segment_buffer *segbuf,\n\t\t\t\t  __u64 nextnum, struct the_nilfs *nilfs)\n{\n\tsegbuf->sb_nextnum = nextnum;\n\tsegbuf->sb_sum.next = nilfs_get_segment_start_blocknr(nilfs, nextnum);\n}"
  },
  {
    "function_name": "nilfs_segbuf_map_cont",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "90-99",
    "snippet": "void nilfs_segbuf_map_cont(struct nilfs_segment_buffer *segbuf,\n\t\t\t   struct nilfs_segment_buffer *prev)\n{\n\tsegbuf->sb_segnum = prev->sb_segnum;\n\tsegbuf->sb_fseg_start = prev->sb_fseg_start;\n\tsegbuf->sb_fseg_end = prev->sb_fseg_end;\n\tsegbuf->sb_pseg_start = prev->sb_pseg_start + prev->sb_sum.nblocks;\n\tsegbuf->sb_rest_blocks =\n\t\tsegbuf->sb_fseg_end - segbuf->sb_pseg_start + 1;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_segbuf_map_cont(struct nilfs_segment_buffer *segbuf,\n\t\t\t   struct nilfs_segment_buffer *prev)\n{\n\tsegbuf->sb_segnum = prev->sb_segnum;\n\tsegbuf->sb_fseg_start = prev->sb_fseg_start;\n\tsegbuf->sb_fseg_end = prev->sb_fseg_end;\n\tsegbuf->sb_pseg_start = prev->sb_pseg_start + prev->sb_sum.nblocks;\n\tsegbuf->sb_rest_blocks =\n\t\tsegbuf->sb_fseg_end - segbuf->sb_pseg_start + 1;\n}"
  },
  {
    "function_name": "nilfs_segbuf_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "73-83",
    "snippet": "void nilfs_segbuf_map(struct nilfs_segment_buffer *segbuf, __u64 segnum,\n\t\t     unsigned long offset, struct the_nilfs *nilfs)\n{\n\tsegbuf->sb_segnum = segnum;\n\tnilfs_get_segment_range(nilfs, segnum, &segbuf->sb_fseg_start,\n\t\t\t\t&segbuf->sb_fseg_end);\n\n\tsegbuf->sb_pseg_start = segbuf->sb_fseg_start + offset;\n\tsegbuf->sb_rest_blocks =\n\t\tsegbuf->sb_fseg_end - segbuf->sb_pseg_start + 1;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);",
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_get_segment_range",
          "args": [
            "nilfs",
            "segnum",
            "&segbuf->sb_fseg_start",
            "&segbuf->sb_fseg_end"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_get_segment_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
          "lines": "319-327",
          "snippet": "static inline void\nnilfs_get_segment_range(struct the_nilfs *nilfs, __u64 segnum,\n\t\t\tsector_t *seg_start, sector_t *seg_end)\n{\n\t*seg_start = (sector_t)nilfs->ns_blocks_per_segment * segnum;\n\t*seg_end = *seg_start + nilfs->ns_blocks_per_segment - 1;\n\tif (segnum == 0)\n\t\t*seg_start = nilfs->ns_first_data_block;\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline void\nnilfs_get_segment_range(struct the_nilfs *nilfs, __u64 segnum,\n\t\t\tsector_t *seg_start, sector_t *seg_end)\n{\n\t*seg_start = (sector_t)nilfs->ns_blocks_per_segment * segnum;\n\t*seg_end = *seg_start + nilfs->ns_blocks_per_segment - 1;\n\tif (segnum == 0)\n\t\t*seg_start = nilfs->ns_first_data_block;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_write(struct nilfs_segment_buffer *segbuf,\n\t\t\t      struct the_nilfs *nilfs);\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_segbuf_map(struct nilfs_segment_buffer *segbuf, __u64 segnum,\n\t\t     unsigned long offset, struct the_nilfs *nilfs)\n{\n\tsegbuf->sb_segnum = segnum;\n\tnilfs_get_segment_range(nilfs, segnum, &segbuf->sb_fseg_start,\n\t\t\t\t&segbuf->sb_fseg_end);\n\n\tsegbuf->sb_pseg_start = segbuf->sb_fseg_start + offset;\n\tsegbuf->sb_rest_blocks =\n\t\tsegbuf->sb_fseg_end - segbuf->sb_pseg_start + 1;\n}"
  },
  {
    "function_name": "nilfs_segbuf_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "68-71",
    "snippet": "void nilfs_segbuf_free(struct nilfs_segment_buffer *segbuf)\n{\n\tkmem_cache_free(nilfs_segbuf_cachep, segbuf);\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "nilfs_segbuf_cachep",
            "segbuf"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_segbuf_free(struct nilfs_segment_buffer *segbuf)\n{\n\tkmem_cache_free(nilfs_segbuf_cachep, segbuf);\n}"
  },
  {
    "function_name": "nilfs_segbuf_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
    "lines": "47-66",
    "snippet": "struct nilfs_segment_buffer *nilfs_segbuf_new(struct super_block *sb)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\n\tsegbuf = kmem_cache_alloc(nilfs_segbuf_cachep, GFP_NOFS);\n\tif (unlikely(!segbuf))\n\t\treturn NULL;\n\n\tsegbuf->sb_super = sb;\n\tINIT_LIST_HEAD(&segbuf->sb_list);\n\tINIT_LIST_HEAD(&segbuf->sb_segsum_buffers);\n\tINIT_LIST_HEAD(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n\n\tinit_completion(&segbuf->sb_bio_event);\n\tatomic_set(&segbuf->sb_err, 0);\n\tsegbuf->sb_nbio = 0;\n\n\treturn segbuf;\n}",
    "includes": [
      "#include \"segbuf.h\"",
      "#include \"page.h\"",
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/crc32.h>",
      "#include <linux/writeback.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&segbuf->sb_err",
            "0"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&segbuf->sb_bio_event"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&segbuf->sb_payload_buffers"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&segbuf->sb_segsum_buffers"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&segbuf->sb_list"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!segbuf"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "nilfs_segbuf_cachep",
            "GFP_NOFS"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nstruct nilfs_segment_buffer *nilfs_segbuf_new(struct super_block *sb)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\n\tsegbuf = kmem_cache_alloc(nilfs_segbuf_cachep, GFP_NOFS);\n\tif (unlikely(!segbuf))\n\t\treturn NULL;\n\n\tsegbuf->sb_super = sb;\n\tINIT_LIST_HEAD(&segbuf->sb_list);\n\tINIT_LIST_HEAD(&segbuf->sb_segsum_buffers);\n\tINIT_LIST_HEAD(&segbuf->sb_payload_buffers);\n\tsegbuf->sb_super_root = NULL;\n\n\tinit_completion(&segbuf->sb_bio_event);\n\tatomic_set(&segbuf->sb_err, 0);\n\tsegbuf->sb_nbio = 0;\n\n\treturn segbuf;\n}"
  }
]