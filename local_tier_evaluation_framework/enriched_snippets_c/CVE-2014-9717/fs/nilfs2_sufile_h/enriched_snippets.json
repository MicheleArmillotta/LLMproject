[
  {
    "function_name": "nilfs_sufile_set_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.h",
    "lines": "140-144",
    "snippet": "static inline int nilfs_sufile_set_error(struct inode *sufile, __u64 segnum)\n{\n\treturn nilfs_sufile_update(sufile, segnum, 0,\n\t\t\t\t   nilfs_sufile_do_set_error);\n}",
    "includes": [
      "#include \"mdt.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_sufile_update",
          "args": [
            "sufile",
            "segnum",
            "0",
            "nilfs_sufile_do_set_error"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_sufile_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.c",
          "lines": "234-263",
          "snippet": "int nilfs_sufile_update(struct inode *sufile, __u64 segnum, int create,\n\t\t\tvoid (*dofunc)(struct inode *, __u64,\n\t\t\t\t       struct buffer_head *,\n\t\t\t\t       struct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tint ret;\n\n\tif (unlikely(segnum >= nilfs_sufile_get_nsegments(sufile))) {\n\t\tprintk(KERN_WARNING \"%s: invalid segment number: %llu\\n\",\n\t\t       __func__, (unsigned long long)segnum);\n\t\treturn -EINVAL;\n\t}\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tret = nilfs_sufile_get_segment_usage_block(sufile, segnum, create, &bh);\n\tif (!ret) {\n\t\tdofunc(sufile, segnum, header_bh, bh);\n\t\tbrelse(bh);\n\t}\n\tbrelse(header_bh);\n\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}",
          "includes": [
            "#include \"sufile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sufile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_sufile_update(struct inode *sufile, __u64 segnum, int create,\n\t\t\tvoid (*dofunc)(struct inode *, __u64,\n\t\t\t\t       struct buffer_head *,\n\t\t\t\t       struct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tint ret;\n\n\tif (unlikely(segnum >= nilfs_sufile_get_nsegments(sufile))) {\n\t\tprintk(KERN_WARNING \"%s: invalid segment number: %llu\\n\",\n\t\t       __func__, (unsigned long long)segnum);\n\t\treturn -EINVAL;\n\t}\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tret = nilfs_sufile_get_segment_usage_block(sufile, segnum, create, &bh);\n\tif (!ret) {\n\t\tdofunc(sufile, segnum, header_bh, bh);\n\t\tbrelse(bh);\n\t}\n\tbrelse(header_bh);\n\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int nilfs_sufile_set_error(struct inode *sufile, __u64 segnum)\n{\n\treturn nilfs_sufile_update(sufile, segnum, 0,\n\t\t\t\t   nilfs_sufile_do_set_error);\n}"
  },
  {
    "function_name": "nilfs_sufile_cancel_freev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.h",
    "lines": "115-121",
    "snippet": "static inline int nilfs_sufile_cancel_freev(struct inode *sufile,\n\t\t\t\t\t    __u64 *segnumv, size_t nsegs,\n\t\t\t\t\t    size_t *ndone)\n{\n\treturn nilfs_sufile_updatev(sufile, segnumv, nsegs, 0, ndone,\n\t\t\t\t    nilfs_sufile_do_cancel_free);\n}",
    "includes": [
      "#include \"mdt.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_sufile_updatev",
          "args": [
            "sufile",
            "segnumv",
            "nsegs",
            "0",
            "ndone",
            "nilfs_sufile_do_cancel_free"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_sufile_updatev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.c",
          "lines": "166-232",
          "snippet": "int nilfs_sufile_updatev(struct inode *sufile, __u64 *segnumv, size_t nsegs,\n\t\t\t int create, size_t *ndone,\n\t\t\t void (*dofunc)(struct inode *, __u64,\n\t\t\t\t\tstruct buffer_head *,\n\t\t\t\t\tstruct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tunsigned long blkoff, prev_blkoff;\n\t__u64 *seg;\n\tsize_t nerr = 0, n = 0;\n\tint ret = 0;\n\n\tif (unlikely(nsegs == 0))\n\t\tgoto out;\n\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\tfor (seg = segnumv; seg < segnumv + nsegs; seg++) {\n\t\tif (unlikely(*seg >= nilfs_sufile_get_nsegments(sufile))) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"%s: invalid segment number: %llu\\n\", __func__,\n\t\t\t       (unsigned long long)*seg);\n\t\t\tnerr++;\n\t\t}\n\t}\n\tif (nerr > 0) {\n\t\tret = -EINVAL;\n\t\tgoto out_sem;\n\t}\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tseg = segnumv;\n\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\tif (ret < 0)\n\t\tgoto out_header;\n\n\tfor (;;) {\n\t\tdofunc(sufile, *seg, header_bh, bh);\n\n\t\tif (++seg >= segnumv + nsegs)\n\t\t\tbreak;\n\t\tprev_blkoff = blkoff;\n\t\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\t\tif (blkoff == prev_blkoff)\n\t\t\tcontinue;\n\n\t\t/* get different block */\n\t\tbrelse(bh);\n\t\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\t\tif (unlikely(ret < 0))\n\t\t\tgoto out_header;\n\t}\n\tbrelse(bh);\n\n out_header:\n\tn = seg - segnumv;\n\tbrelse(header_bh);\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n out:\n\tif (ndone)\n\t\t*ndone = n;\n\treturn ret;\n}",
          "includes": [
            "#include \"sufile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sufile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_sufile_updatev(struct inode *sufile, __u64 *segnumv, size_t nsegs,\n\t\t\t int create, size_t *ndone,\n\t\t\t void (*dofunc)(struct inode *, __u64,\n\t\t\t\t\tstruct buffer_head *,\n\t\t\t\t\tstruct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tunsigned long blkoff, prev_blkoff;\n\t__u64 *seg;\n\tsize_t nerr = 0, n = 0;\n\tint ret = 0;\n\n\tif (unlikely(nsegs == 0))\n\t\tgoto out;\n\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\tfor (seg = segnumv; seg < segnumv + nsegs; seg++) {\n\t\tif (unlikely(*seg >= nilfs_sufile_get_nsegments(sufile))) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"%s: invalid segment number: %llu\\n\", __func__,\n\t\t\t       (unsigned long long)*seg);\n\t\t\tnerr++;\n\t\t}\n\t}\n\tif (nerr > 0) {\n\t\tret = -EINVAL;\n\t\tgoto out_sem;\n\t}\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tseg = segnumv;\n\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\tif (ret < 0)\n\t\tgoto out_header;\n\n\tfor (;;) {\n\t\tdofunc(sufile, *seg, header_bh, bh);\n\n\t\tif (++seg >= segnumv + nsegs)\n\t\t\tbreak;\n\t\tprev_blkoff = blkoff;\n\t\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\t\tif (blkoff == prev_blkoff)\n\t\t\tcontinue;\n\n\t\t/* get different block */\n\t\tbrelse(bh);\n\t\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\t\tif (unlikely(ret < 0))\n\t\t\tgoto out_header;\n\t}\n\tbrelse(bh);\n\n out_header:\n\tn = seg - segnumv;\n\tbrelse(header_bh);\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n out:\n\tif (ndone)\n\t\t*ndone = n;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int nilfs_sufile_cancel_freev(struct inode *sufile,\n\t\t\t\t\t    __u64 *segnumv, size_t nsegs,\n\t\t\t\t\t    size_t *ndone)\n{\n\treturn nilfs_sufile_updatev(sufile, segnumv, nsegs, 0, ndone,\n\t\t\t\t    nilfs_sufile_do_cancel_free);\n}"
  },
  {
    "function_name": "nilfs_sufile_freev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.h",
    "lines": "98-103",
    "snippet": "static inline int nilfs_sufile_freev(struct inode *sufile, __u64 *segnumv,\n\t\t\t\t     size_t nsegs, size_t *ndone)\n{\n\treturn nilfs_sufile_updatev(sufile, segnumv, nsegs, 0, ndone,\n\t\t\t\t    nilfs_sufile_do_free);\n}",
    "includes": [
      "#include \"mdt.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_sufile_updatev",
          "args": [
            "sufile",
            "segnumv",
            "nsegs",
            "0",
            "ndone",
            "nilfs_sufile_do_free"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_sufile_updatev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.c",
          "lines": "166-232",
          "snippet": "int nilfs_sufile_updatev(struct inode *sufile, __u64 *segnumv, size_t nsegs,\n\t\t\t int create, size_t *ndone,\n\t\t\t void (*dofunc)(struct inode *, __u64,\n\t\t\t\t\tstruct buffer_head *,\n\t\t\t\t\tstruct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tunsigned long blkoff, prev_blkoff;\n\t__u64 *seg;\n\tsize_t nerr = 0, n = 0;\n\tint ret = 0;\n\n\tif (unlikely(nsegs == 0))\n\t\tgoto out;\n\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\tfor (seg = segnumv; seg < segnumv + nsegs; seg++) {\n\t\tif (unlikely(*seg >= nilfs_sufile_get_nsegments(sufile))) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"%s: invalid segment number: %llu\\n\", __func__,\n\t\t\t       (unsigned long long)*seg);\n\t\t\tnerr++;\n\t\t}\n\t}\n\tif (nerr > 0) {\n\t\tret = -EINVAL;\n\t\tgoto out_sem;\n\t}\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tseg = segnumv;\n\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\tif (ret < 0)\n\t\tgoto out_header;\n\n\tfor (;;) {\n\t\tdofunc(sufile, *seg, header_bh, bh);\n\n\t\tif (++seg >= segnumv + nsegs)\n\t\t\tbreak;\n\t\tprev_blkoff = blkoff;\n\t\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\t\tif (blkoff == prev_blkoff)\n\t\t\tcontinue;\n\n\t\t/* get different block */\n\t\tbrelse(bh);\n\t\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\t\tif (unlikely(ret < 0))\n\t\t\tgoto out_header;\n\t}\n\tbrelse(bh);\n\n out_header:\n\tn = seg - segnumv;\n\tbrelse(header_bh);\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n out:\n\tif (ndone)\n\t\t*ndone = n;\n\treturn ret;\n}",
          "includes": [
            "#include \"sufile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sufile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_sufile_updatev(struct inode *sufile, __u64 *segnumv, size_t nsegs,\n\t\t\t int create, size_t *ndone,\n\t\t\t void (*dofunc)(struct inode *, __u64,\n\t\t\t\t\tstruct buffer_head *,\n\t\t\t\t\tstruct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tunsigned long blkoff, prev_blkoff;\n\t__u64 *seg;\n\tsize_t nerr = 0, n = 0;\n\tint ret = 0;\n\n\tif (unlikely(nsegs == 0))\n\t\tgoto out;\n\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\tfor (seg = segnumv; seg < segnumv + nsegs; seg++) {\n\t\tif (unlikely(*seg >= nilfs_sufile_get_nsegments(sufile))) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"%s: invalid segment number: %llu\\n\", __func__,\n\t\t\t       (unsigned long long)*seg);\n\t\t\tnerr++;\n\t\t}\n\t}\n\tif (nerr > 0) {\n\t\tret = -EINVAL;\n\t\tgoto out_sem;\n\t}\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tseg = segnumv;\n\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\tif (ret < 0)\n\t\tgoto out_header;\n\n\tfor (;;) {\n\t\tdofunc(sufile, *seg, header_bh, bh);\n\n\t\tif (++seg >= segnumv + nsegs)\n\t\t\tbreak;\n\t\tprev_blkoff = blkoff;\n\t\tblkoff = nilfs_sufile_get_blkoff(sufile, *seg);\n\t\tif (blkoff == prev_blkoff)\n\t\t\tcontinue;\n\n\t\t/* get different block */\n\t\tbrelse(bh);\n\t\tret = nilfs_mdt_get_block(sufile, blkoff, create, NULL, &bh);\n\t\tif (unlikely(ret < 0))\n\t\t\tgoto out_header;\n\t}\n\tbrelse(bh);\n\n out_header:\n\tn = seg - segnumv;\n\tbrelse(header_bh);\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n out:\n\tif (ndone)\n\t\t*ndone = n;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int nilfs_sufile_freev(struct inode *sufile, __u64 *segnumv,\n\t\t\t\t     size_t nsegs, size_t *ndone)\n{\n\treturn nilfs_sufile_updatev(sufile, segnumv, nsegs, 0, ndone,\n\t\t\t\t    nilfs_sufile_do_free);\n}"
  },
  {
    "function_name": "nilfs_sufile_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.h",
    "lines": "86-89",
    "snippet": "static inline int nilfs_sufile_free(struct inode *sufile, __u64 segnum)\n{\n\treturn nilfs_sufile_update(sufile, segnum, 0, nilfs_sufile_do_free);\n}",
    "includes": [
      "#include \"mdt.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_sufile_update",
          "args": [
            "sufile",
            "segnum",
            "0",
            "nilfs_sufile_do_free"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_sufile_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.c",
          "lines": "234-263",
          "snippet": "int nilfs_sufile_update(struct inode *sufile, __u64 segnum, int create,\n\t\t\tvoid (*dofunc)(struct inode *, __u64,\n\t\t\t\t       struct buffer_head *,\n\t\t\t\t       struct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tint ret;\n\n\tif (unlikely(segnum >= nilfs_sufile_get_nsegments(sufile))) {\n\t\tprintk(KERN_WARNING \"%s: invalid segment number: %llu\\n\",\n\t\t       __func__, (unsigned long long)segnum);\n\t\treturn -EINVAL;\n\t}\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tret = nilfs_sufile_get_segment_usage_block(sufile, segnum, create, &bh);\n\tif (!ret) {\n\t\tdofunc(sufile, segnum, header_bh, bh);\n\t\tbrelse(bh);\n\t}\n\tbrelse(header_bh);\n\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}",
          "includes": [
            "#include \"sufile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sufile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_sufile_update(struct inode *sufile, __u64 segnum, int create,\n\t\t\tvoid (*dofunc)(struct inode *, __u64,\n\t\t\t\t       struct buffer_head *,\n\t\t\t\t       struct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tint ret;\n\n\tif (unlikely(segnum >= nilfs_sufile_get_nsegments(sufile))) {\n\t\tprintk(KERN_WARNING \"%s: invalid segment number: %llu\\n\",\n\t\t       __func__, (unsigned long long)segnum);\n\t\treturn -EINVAL;\n\t}\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tret = nilfs_sufile_get_segment_usage_block(sufile, segnum, create, &bh);\n\tif (!ret) {\n\t\tdofunc(sufile, segnum, header_bh, bh);\n\t\tbrelse(bh);\n\t}\n\tbrelse(header_bh);\n\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int nilfs_sufile_free(struct inode *sufile, __u64 segnum)\n{\n\treturn nilfs_sufile_update(sufile, segnum, 0, nilfs_sufile_do_free);\n}"
  },
  {
    "function_name": "nilfs_sufile_scrap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.h",
    "lines": "76-79",
    "snippet": "static inline int nilfs_sufile_scrap(struct inode *sufile, __u64 segnum)\n{\n\treturn nilfs_sufile_update(sufile, segnum, 1, nilfs_sufile_do_scrap);\n}",
    "includes": [
      "#include \"mdt.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_sufile_update",
          "args": [
            "sufile",
            "segnum",
            "1",
            "nilfs_sufile_do_scrap"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_sufile_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.c",
          "lines": "234-263",
          "snippet": "int nilfs_sufile_update(struct inode *sufile, __u64 segnum, int create,\n\t\t\tvoid (*dofunc)(struct inode *, __u64,\n\t\t\t\t       struct buffer_head *,\n\t\t\t\t       struct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tint ret;\n\n\tif (unlikely(segnum >= nilfs_sufile_get_nsegments(sufile))) {\n\t\tprintk(KERN_WARNING \"%s: invalid segment number: %llu\\n\",\n\t\t       __func__, (unsigned long long)segnum);\n\t\treturn -EINVAL;\n\t}\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tret = nilfs_sufile_get_segment_usage_block(sufile, segnum, create, &bh);\n\tif (!ret) {\n\t\tdofunc(sufile, segnum, header_bh, bh);\n\t\tbrelse(bh);\n\t}\n\tbrelse(header_bh);\n\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}",
          "includes": [
            "#include \"sufile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sufile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_sufile_update(struct inode *sufile, __u64 segnum, int create,\n\t\t\tvoid (*dofunc)(struct inode *, __u64,\n\t\t\t\t       struct buffer_head *,\n\t\t\t\t       struct buffer_head *))\n{\n\tstruct buffer_head *header_bh, *bh;\n\tint ret;\n\n\tif (unlikely(segnum >= nilfs_sufile_get_nsegments(sufile))) {\n\t\tprintk(KERN_WARNING \"%s: invalid segment number: %llu\\n\",\n\t\t       __func__, (unsigned long long)segnum);\n\t\treturn -EINVAL;\n\t}\n\tdown_write(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tret = nilfs_sufile_get_segment_usage_block(sufile, segnum, create, &bh);\n\tif (!ret) {\n\t\tdofunc(sufile, segnum, header_bh, bh);\n\t\tbrelse(bh);\n\t}\n\tbrelse(header_bh);\n\n out_sem:\n\tup_write(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int nilfs_sufile_scrap(struct inode *sufile, __u64 segnum)\n{\n\treturn nilfs_sufile_update(sufile, segnum, 1, nilfs_sufile_do_scrap);\n}"
  },
  {
    "function_name": "nilfs_sufile_get_nsegments",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.h",
    "lines": "32-35",
    "snippet": "static inline unsigned long nilfs_sufile_get_nsegments(struct inode *sufile)\n{\n\treturn ((struct the_nilfs *)sufile->i_sb->s_fs_info)->ns_nsegments;\n}",
    "includes": [
      "#include \"mdt.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline unsigned long nilfs_sufile_get_nsegments(struct inode *sufile)\n{\n\treturn ((struct the_nilfs *)sufile->i_sb->s_fs_info)->ns_nsegments;\n}"
  }
]