[
  {
    "function_name": "lops_after_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
    "lines": "94-101",
    "snippet": "static inline void lops_after_scan(struct gfs2_jdesc *jd, int error,\n\t\t\t\t   unsigned int pass)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_before_scan)\n\t\t\tgfs2_log_ops[x]->lo_after_scan(jd, error, pass);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_ops[x]->lo_after_scan",
          "args": [
            "jd",
            "error",
            "pass"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\nstatic inline void lops_after_scan(struct gfs2_jdesc *jd, int error,\n\t\t\t\t   unsigned int pass)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_before_scan)\n\t\t\tgfs2_log_ops[x]->lo_after_scan(jd, error, pass);\n}"
  },
  {
    "function_name": "lops_scan_elements",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
    "lines": "77-92",
    "snippet": "static inline int lops_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\t     struct gfs2_log_descriptor *ld,\n\t\t\t\t     __be64 *ptr,\n\t\t\t\t     unsigned int pass)\n{\n\tint x, error;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_scan_elements) {\n\t\t\terror = gfs2_log_ops[x]->lo_scan_elements(jd, start,\n\t\t\t\t\t\t\t\t  ld, ptr, pass);\n\t\t\tif (error)\n\t\t\t\treturn error;\n\t\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_ops[x]->lo_scan_elements",
          "args": [
            "jd",
            "start",
            "ld",
            "ptr",
            "pass"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\nstatic inline int lops_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\t     struct gfs2_log_descriptor *ld,\n\t\t\t\t     __be64 *ptr,\n\t\t\t\t     unsigned int pass)\n{\n\tint x, error;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_scan_elements) {\n\t\t\terror = gfs2_log_ops[x]->lo_scan_elements(jd, start,\n\t\t\t\t\t\t\t\t  ld, ptr, pass);\n\t\t\tif (error)\n\t\t\t\treturn error;\n\t\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "lops_before_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
    "lines": "67-75",
    "snippet": "static inline void lops_before_scan(struct gfs2_jdesc *jd,\n\t\t\t\t    struct gfs2_log_header_host *head,\n\t\t\t\t    unsigned int pass)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_before_scan)\n\t\t\tgfs2_log_ops[x]->lo_before_scan(jd, head, pass);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_ops[x]->lo_before_scan",
          "args": [
            "jd",
            "head",
            "pass"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\nstatic inline void lops_before_scan(struct gfs2_jdesc *jd,\n\t\t\t\t    struct gfs2_log_header_host *head,\n\t\t\t\t    unsigned int pass)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_before_scan)\n\t\t\tgfs2_log_ops[x]->lo_before_scan(jd, head, pass);\n}"
  },
  {
    "function_name": "lops_after_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
    "lines": "58-65",
    "snippet": "static inline void lops_after_commit(struct gfs2_sbd *sdp,\n\t\t\t\t     struct gfs2_trans *tr)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_after_commit)\n\t\t\tgfs2_log_ops[x]->lo_after_commit(sdp, tr);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_ops[x]->lo_after_commit",
          "args": [
            "sdp",
            "tr"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\nstatic inline void lops_after_commit(struct gfs2_sbd *sdp,\n\t\t\t\t     struct gfs2_trans *tr)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_after_commit)\n\t\t\tgfs2_log_ops[x]->lo_after_commit(sdp, tr);\n}"
  },
  {
    "function_name": "lops_before_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
    "lines": "49-56",
    "snippet": "static inline void lops_before_commit(struct gfs2_sbd *sdp,\n\t\t\t\t      struct gfs2_trans *tr)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_before_commit)\n\t\t\tgfs2_log_ops[x]->lo_before_commit(sdp, tr);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_ops[x]->lo_before_commit",
          "args": [
            "sdp",
            "tr"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\nstatic inline void lops_before_commit(struct gfs2_sbd *sdp,\n\t\t\t\t      struct gfs2_trans *tr)\n{\n\tint x;\n\tfor (x = 0; gfs2_log_ops[x]; x++)\n\t\tif (gfs2_log_ops[x]->lo_before_commit)\n\t\t\tgfs2_log_ops[x]->lo_before_commit(sdp, tr);\n}"
  },
  {
    "function_name": "databuf_limit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
    "lines": "41-47",
    "snippet": "static inline unsigned int databuf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - DATABUF_OFFSET) / (2 * sizeof(__be64));\n\treturn limit;\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/list.h>"
    ],
    "macros_used": [
      "#define DATABUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + (2 * sizeof(__be64) - 1)) & \\\n\t ~(2 * sizeof(__be64) - 1))"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\n#define DATABUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + (2 * sizeof(__be64) - 1)) & \\\n\t ~(2 * sizeof(__be64) - 1))\n\nstatic inline unsigned int databuf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - DATABUF_OFFSET) / (2 * sizeof(__be64));\n\treturn limit;\n}"
  },
  {
    "function_name": "buf_limit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
    "lines": "33-39",
    "snippet": "static inline unsigned int buf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - BUF_OFFSET) / sizeof(__be64);\n\treturn limit;\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/list.h>"
    ],
    "macros_used": [
      "#define BUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + sizeof(__be64) - 1) & \\\n\t ~(sizeof(__be64) - 1))"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\n#define BUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + sizeof(__be64) - 1) & \\\n\t ~(sizeof(__be64) - 1))\n\nstatic inline unsigned int buf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - BUF_OFFSET) / sizeof(__be64);\n\treturn limit;\n}"
  }
]