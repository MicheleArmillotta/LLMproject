[
  {
    "function_name": "debugfs_create_devm_seqfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "797-816",
    "snippet": "struct dentry *debugfs_create_devm_seqfile(struct device *dev, const char *name,\n\t\t\t\t\t   struct dentry *parent,\n\t\t\t\t\t   int (*read_fn)(struct seq_file *s,\n\t\t\t\t\t\t\t  void *data))\n{\n\tstruct debugfs_devm_entry *entry;\n\n\tif (IS_ERR(parent))\n\t\treturn ERR_PTR(-ENOENT);\n\n\tentry = devm_kzalloc(dev, sizeof(*entry), GFP_KERNEL);\n\tif (!entry)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tentry->read = read_fn;\n\tentry->dev = dev;\n\n\treturn debugfs_create_file(name, S_IRUGO, parent, entry,\n\t\t\t\t   &debugfs_devm_entry_ops);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations debugfs_devm_entry_ops = {\n\t.owner = THIS_MODULE,\n\t.open = debugfs_devm_entry_open,\n\t.release = single_release,\n\t.read = seq_read,\n\t.llseek = seq_lseek\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "S_IRUGO",
            "parent",
            "entry",
            "&debugfs_devm_entry_ops"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "devm_kzalloc",
          "args": [
            "dev",
            "sizeof(*entry)",
            "GFP_KERNEL"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOENT"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "parent"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic const struct file_operations debugfs_devm_entry_ops = {\n\t.owner = THIS_MODULE,\n\t.open = debugfs_devm_entry_open,\n\t.release = single_release,\n\t.read = seq_read,\n\t.llseek = seq_lseek\n};\n\nstruct dentry *debugfs_create_devm_seqfile(struct device *dev, const char *name,\n\t\t\t\t\t   struct dentry *parent,\n\t\t\t\t\t   int (*read_fn)(struct seq_file *s,\n\t\t\t\t\t\t\t  void *data))\n{\n\tstruct debugfs_devm_entry *entry;\n\n\tif (IS_ERR(parent))\n\t\treturn ERR_PTR(-ENOENT);\n\n\tentry = devm_kzalloc(dev, sizeof(*entry), GFP_KERNEL);\n\tif (!entry)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tentry->read = read_fn;\n\tentry->dev = dev;\n\n\treturn debugfs_create_file(name, S_IRUGO, parent, entry,\n\t\t\t\t   &debugfs_devm_entry_ops);\n}"
  },
  {
    "function_name": "debugfs_devm_entry_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "772-777",
    "snippet": "static int debugfs_devm_entry_open(struct inode *inode, struct file *f)\n{\n\tstruct debugfs_devm_entry *entry = inode->i_private;\n\n\treturn single_open(f, entry->read, entry->dev);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "f",
            "entry->read",
            "entry->dev"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_devm_entry_open(struct inode *inode, struct file *f)\n{\n\tstruct debugfs_devm_entry *entry = inode->i_private;\n\n\treturn single_open(f, entry->read, entry->dev);\n}"
  },
  {
    "function_name": "debugfs_create_regset32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "757-762",
    "snippet": "struct dentry *debugfs_create_regset32(const char *name, umode_t mode,\n\t\t\t\t       struct dentry *parent,\n\t\t\t\t       struct debugfs_regset32 *regset)\n{\n\treturn debugfs_create_file(name, mode, parent, regset, &fops_regset32);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "regset",
            "&fops_regset32"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_regset32(const char *name, umode_t mode,\n\t\t\t\t       struct dentry *parent,\n\t\t\t\t       struct debugfs_regset32 *regset)\n{\n\treturn debugfs_create_file(name, mode, parent, regset, &fops_regset32);\n}"
  },
  {
    "function_name": "debugfs_open_regset32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "720-723",
    "snippet": "static int debugfs_open_regset32(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, debugfs_show_regset32, inode->i_private);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "debugfs_show_regset32",
            "inode->i_private"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_open_regset32(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, debugfs_show_regset32, inode->i_private);\n}"
  },
  {
    "function_name": "debugfs_show_regset32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "712-718",
    "snippet": "static int debugfs_show_regset32(struct seq_file *s, void *data)\n{\n\tstruct debugfs_regset32 *regset = s->private;\n\n\tdebugfs_print_regs32(s, regset->regs, regset->nregs, regset->base, \"\");\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_print_regs32",
          "args": [
            "s",
            "regset->regs",
            "regset->nregs",
            "regset->base",
            "\"\""
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_print_regs32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
          "lines": "696-709",
          "snippet": "void debugfs_print_regs32(struct seq_file *s, const struct debugfs_reg32 *regs,\n\t\t\t  int nregs, void __iomem *base, char *prefix)\n{\n\tint i;\n\n\tfor (i = 0; i < nregs; i++, regs++) {\n\t\tif (prefix)\n\t\t\tseq_printf(s, \"%s\", prefix);\n\t\tseq_printf(s, \"%s = 0x%08x\\n\", regs->name,\n\t\t\t   readl(base + regs->offset));\n\t\tif (seq_has_overflowed(s))\n\t\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <linux/device.h>",
            "#include <linux/atomic.h>",
            "#include <linux/slab.h>",
            "#include <linux/io.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nvoid debugfs_print_regs32(struct seq_file *s, const struct debugfs_reg32 *regs,\n\t\t\t  int nregs, void __iomem *base, char *prefix)\n{\n\tint i;\n\n\tfor (i = 0; i < nregs; i++, regs++) {\n\t\tif (prefix)\n\t\t\tseq_printf(s, \"%s\", prefix);\n\t\tseq_printf(s, \"%s = 0x%08x\\n\", regs->name,\n\t\t\t   readl(base + regs->offset));\n\t\tif (seq_has_overflowed(s))\n\t\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_show_regset32(struct seq_file *s, void *data)\n{\n\tstruct debugfs_regset32 *regset = s->private;\n\n\tdebugfs_print_regs32(s, regset->regs, regset->nregs, regset->base, \"\");\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_print_regs32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "696-709",
    "snippet": "void debugfs_print_regs32(struct seq_file *s, const struct debugfs_reg32 *regs,\n\t\t\t  int nregs, void __iomem *base, char *prefix)\n{\n\tint i;\n\n\tfor (i = 0; i < nregs; i++, regs++) {\n\t\tif (prefix)\n\t\t\tseq_printf(s, \"%s\", prefix);\n\t\tseq_printf(s, \"%s = 0x%08x\\n\", regs->name,\n\t\t\t   readl(base + regs->offset));\n\t\tif (seq_has_overflowed(s))\n\t\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_has_overflowed",
          "args": [
            "s"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\"%s = 0x%08x\\n\"",
            "regs->name",
            "readl(base + regs->offset)"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "readl",
          "args": [
            "base + regs->offset"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nvoid debugfs_print_regs32(struct seq_file *s, const struct debugfs_reg32 *regs,\n\t\t\t  int nregs, void __iomem *base, char *prefix)\n{\n\tint i;\n\n\tfor (i = 0; i < nregs; i++, regs++) {\n\t\tif (prefix)\n\t\t\tseq_printf(s, \"%s\", prefix);\n\t\tseq_printf(s, \"%s = 0x%08x\\n\", regs->name,\n\t\t\t   readl(base + regs->offset));\n\t\tif (seq_has_overflowed(s))\n\t\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "debugfs_create_u32_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "657-670",
    "snippet": "struct dentry *debugfs_create_u32_array(const char *name, umode_t mode,\n\t\t\t\t\t    struct dentry *parent,\n\t\t\t\t\t    u32 *array, u32 elements)\n{\n\tstruct array_data *data = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data == NULL)\n\t\treturn NULL;\n\n\tdata->array = array;\n\tdata->elements = elements;\n\n\treturn debugfs_create_file(name, mode, parent, data, &u32_array_fops);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations u32_array_fops = {\n\t.owner\t = THIS_MODULE,\n\t.open\t = u32_array_open,\n\t.release = u32_array_release,\n\t.read\t = u32_array_read,\n\t.llseek  = no_llseek,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "data",
            "&u32_array_fops"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*data)",
            "GFP_KERNEL"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic const struct file_operations u32_array_fops = {\n\t.owner\t = THIS_MODULE,\n\t.open\t = u32_array_open,\n\t.release = u32_array_release,\n\t.read\t = u32_array_read,\n\t.llseek  = no_llseek,\n};\n\nstruct dentry *debugfs_create_u32_array(const char *name, umode_t mode,\n\t\t\t\t\t    struct dentry *parent,\n\t\t\t\t\t    u32 *array, u32 elements)\n{\n\tstruct array_data *data = kmalloc(sizeof(*data), GFP_KERNEL);\n\n\tif (data == NULL)\n\t\treturn NULL;\n\n\tdata->array = array;\n\tdata->elements = elements;\n\n\treturn debugfs_create_file(name, mode, parent, data, &u32_array_fops);\n}"
  },
  {
    "function_name": "u32_array_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "623-628",
    "snippet": "static int u32_array_release(struct inode *inode, struct file *file)\n{\n\tkfree(file->private_data);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "file->private_data"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int u32_array_release(struct inode *inode, struct file *file)\n{\n\tkfree(file->private_data);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "u32_array_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "614-621",
    "snippet": "static ssize_t u32_array_read(struct file *file, char __user *buf, size_t len,\n\t\t\t      loff_t *ppos)\n{\n\tsize_t size = strlen(file->private_data);\n\n\treturn simple_read_from_buffer(buf, len, ppos,\n\t\t\t\t\tfile->private_data, size);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "len",
            "ppos",
            "file->private_data",
            "size"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "simple_read_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/libfs.c",
          "lines": "590-608",
          "snippet": "ssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "file->private_data"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic ssize_t u32_array_read(struct file *file, char __user *buf, size_t len,\n\t\t\t      loff_t *ppos)\n{\n\tsize_t size = strlen(file->private_data);\n\n\treturn simple_read_from_buffer(buf, len, ppos,\n\t\t\t\t\tfile->private_data, size);\n}"
  },
  {
    "function_name": "u32_array_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "591-612",
    "snippet": "static int u32_array_open(struct inode *inode, struct file *file)\n{\n\tstruct array_data *data = inode->i_private;\n\tint size, elements = data->elements;\n\tchar *buf;\n\n\t/*\n\t * Max size:\n\t *  - 10 digits + ' '/'\\n' = 11 bytes per number\n\t *  - terminating NUL character\n\t */\n\tsize = elements*11;\n\tbuf = kmalloc(size+1, GFP_KERNEL);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\tbuf[size] = 0;\n\n\tfile->private_data = buf;\n\tu32_format_array(buf, size, data->array, data->elements);\n\n\treturn nonseekable_open(inode, file);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nonseekable_open",
          "args": [
            "inode",
            "file"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "nonseekable_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/open.c",
          "lines": "1136-1140",
          "snippet": "int nonseekable_open(struct inode *inode, struct file *filp)\n{\n\tfilp->f_mode &= ~(FMODE_LSEEK | FMODE_PREAD | FMODE_PWRITE);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/dnotify.h>",
            "#include <linux/ima.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/falloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/personality.h>",
            "#include <linux/fs.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mount.h>",
            "#include <linux/security.h>",
            "#include <linux/securebits.h>",
            "#include <linux/capability.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/namei.h>",
            "#include <linux/tty.h>",
            "#include <linux/module.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/dnotify.h>\n#include <linux/ima.h>\n#include <linux/fs_struct.h>\n#include <linux/falloc.h>\n#include <linux/audit.h>\n#include <linux/rcupdate.h>\n#include <linux/syscalls.h>\n#include <linux/pagemap.h>\n#include <linux/personality.h>\n#include <linux/fs.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mount.h>\n#include <linux/security.h>\n#include <linux/securebits.h>\n#include <linux/capability.h>\n#include <linux/backing-dev.h>\n#include <linux/namei.h>\n#include <linux/tty.h>\n#include <linux/module.h>\n#include <linux/fsnotify.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n\nint nonseekable_open(struct inode *inode, struct file *filp)\n{\n\tfilp->f_mode &= ~(FMODE_LSEEK | FMODE_PREAD | FMODE_PWRITE);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "u32_format_array",
          "args": [
            "buf",
            "size",
            "data->array",
            "data->elements"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "u32_format_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
          "lines": "573-589",
          "snippet": "static size_t u32_format_array(char *buf, size_t bufsize,\n\t\t\t       u32 *array, int array_size)\n{\n\tsize_t ret = 0;\n\n\twhile (--array_size >= 0) {\n\t\tsize_t len;\n\t\tchar term = array_size ? ' ' : '\\n';\n\n\t\tlen = snprintf(buf, bufsize, \"%u%c\", *array++, term);\n\t\tret += len;\n\n\t\tbuf += len;\n\t\tbufsize -= len;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <linux/device.h>",
            "#include <linux/atomic.h>",
            "#include <linux/slab.h>",
            "#include <linux/io.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic size_t u32_format_array(char *buf, size_t bufsize,\n\t\t\t       u32 *array, int array_size)\n{\n\tsize_t ret = 0;\n\n\twhile (--array_size >= 0) {\n\t\tsize_t len;\n\t\tchar term = array_size ? ' ' : '\\n';\n\n\t\tlen = snprintf(buf, bufsize, \"%u%c\", *array++, term);\n\t\tret += len;\n\n\t\tbuf += len;\n\t\tbufsize -= len;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "size+1",
            "GFP_KERNEL"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int u32_array_open(struct inode *inode, struct file *file)\n{\n\tstruct array_data *data = inode->i_private;\n\tint size, elements = data->elements;\n\tchar *buf;\n\n\t/*\n\t * Max size:\n\t *  - 10 digits + ' '/'\\n' = 11 bytes per number\n\t *  - terminating NUL character\n\t */\n\tsize = elements*11;\n\tbuf = kmalloc(size+1, GFP_KERNEL);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\tbuf[size] = 0;\n\n\tfile->private_data = buf;\n\tu32_format_array(buf, size, data->array, data->elements);\n\n\treturn nonseekable_open(inode, file);\n}"
  },
  {
    "function_name": "u32_format_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "573-589",
    "snippet": "static size_t u32_format_array(char *buf, size_t bufsize,\n\t\t\t       u32 *array, int array_size)\n{\n\tsize_t ret = 0;\n\n\twhile (--array_size >= 0) {\n\t\tsize_t len;\n\t\tchar term = array_size ? ' ' : '\\n';\n\n\t\tlen = snprintf(buf, bufsize, \"%u%c\", *array++, term);\n\t\tret += len;\n\n\t\tbuf += len;\n\t\tbufsize -= len;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "bufsize",
            "\"%u%c\"",
            "*array++",
            "term"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic size_t u32_format_array(char *buf, size_t bufsize,\n\t\t\t       u32 *array, int array_size)\n{\n\tsize_t ret = 0;\n\n\twhile (--array_size >= 0) {\n\t\tsize_t len;\n\t\tchar term = array_size ? ' ' : '\\n';\n\n\t\tlen = snprintf(buf, bufsize, \"%u%c\", *array++, term);\n\t\tret += len;\n\n\t\tbuf += len;\n\t\tbufsize -= len;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "debugfs_create_blob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "560-565",
    "snippet": "struct dentry *debugfs_create_blob(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent,\n\t\t\t\t   struct debugfs_blob_wrapper *blob)\n{\n\treturn debugfs_create_file(name, mode, parent, blob, &fops_blob);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations fops_blob = {\n\t.read =\t\tread_file_blob,\n\t.open =\t\tsimple_open,\n\t.llseek =\tdefault_llseek,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "blob",
            "&fops_blob"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic const struct file_operations fops_blob = {\n\t.read =\t\tread_file_blob,\n\t.open =\t\tsimple_open,\n\t.llseek =\tdefault_llseek,\n};\n\nstruct dentry *debugfs_create_blob(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent,\n\t\t\t\t   struct debugfs_blob_wrapper *blob)\n{\n\treturn debugfs_create_file(name, mode, parent, blob, &fops_blob);\n}"
  },
  {
    "function_name": "read_file_blob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "522-528",
    "snippet": "static ssize_t read_file_blob(struct file *file, char __user *user_buf,\n\t\t\t      size_t count, loff_t *ppos)\n{\n\tstruct debugfs_blob_wrapper *blob = file->private_data;\n\treturn simple_read_from_buffer(user_buf, count, ppos, blob->data,\n\t\t\tblob->size);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "user_buf",
            "count",
            "ppos",
            "blob->data",
            "blob->size"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "simple_read_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/libfs.c",
          "lines": "590-608",
          "snippet": "ssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic ssize_t read_file_blob(struct file *file, char __user *user_buf,\n\t\t\t      size_t count, loff_t *ppos)\n{\n\tstruct debugfs_blob_wrapper *blob = file->private_data;\n\treturn simple_read_from_buffer(user_buf, count, ppos, blob->data,\n\t\t\tblob->size);\n}"
  },
  {
    "function_name": "debugfs_create_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "515-519",
    "snippet": "struct dentry *debugfs_create_bool(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, u32 *value)\n{\n\treturn debugfs_create_file(name, mode, parent, value, &fops_bool);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations fops_bool = {\n\t.read =\t\tread_file_bool,\n\t.write =\twrite_file_bool,\n\t.open =\t\tsimple_open,\n\t.llseek =\tdefault_llseek,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_bool"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic const struct file_operations fops_bool = {\n\t.read =\t\tread_file_bool,\n\t.write =\twrite_file_bool,\n\t.open =\t\tsimple_open,\n\t.llseek =\tdefault_llseek,\n};\n\nstruct dentry *debugfs_create_bool(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, u32 *value)\n{\n\treturn debugfs_create_file(name, mode, parent, value, &fops_bool);\n}"
  },
  {
    "function_name": "write_file_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "465-482",
    "snippet": "static ssize_t write_file_bool(struct file *file, const char __user *user_buf,\n\t\t\t       size_t count, loff_t *ppos)\n{\n\tchar buf[32];\n\tsize_t buf_size;\n\tbool bv;\n\tu32 *val = file->private_data;\n\n\tbuf_size = min(count, (sizeof(buf)-1));\n\tif (copy_from_user(buf, user_buf, buf_size))\n\t\treturn -EFAULT;\n\n\tbuf[buf_size] = '\\0';\n\tif (strtobool(buf, &bv) == 0)\n\t\t*val = bv;\n\n\treturn count;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtobool",
          "args": [
            "buf",
            "&bv"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "buf",
            "user_buf",
            "buf_size"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "count",
            "(sizeof(buf)-1)"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "minix_setattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/file.c",
          "lines": "26-48",
          "snippet": "static int minix_setattr(struct dentry *dentry, struct iattr *attr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tint error;\n\n\terror = inode_change_ok(inode, attr);\n\tif (error)\n\t\treturn error;\n\n\tif ((attr->ia_valid & ATTR_SIZE) &&\n\t    attr->ia_size != i_size_read(inode)) {\n\t\terror = inode_newsize_ok(inode, attr->ia_size);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\ttruncate_setsize(inode, attr->ia_size);\n\t\tminix_truncate(inode);\n\t}\n\n\tsetattr_copy(inode, attr);\n\tmark_inode_dirty(inode);\n\treturn 0;\n}",
          "includes": [
            "#include \"minix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"minix.h\"\n\nstatic int minix_setattr(struct dentry *dentry, struct iattr *attr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tint error;\n\n\terror = inode_change_ok(inode, attr);\n\tif (error)\n\t\treturn error;\n\n\tif ((attr->ia_valid & ATTR_SIZE) &&\n\t    attr->ia_size != i_size_read(inode)) {\n\t\terror = inode_newsize_ok(inode, attr->ia_size);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\ttruncate_setsize(inode, attr->ia_size);\n\t\tminix_truncate(inode);\n\t}\n\n\tsetattr_copy(inode, attr);\n\tmark_inode_dirty(inode);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic ssize_t write_file_bool(struct file *file, const char __user *user_buf,\n\t\t\t       size_t count, loff_t *ppos)\n{\n\tchar buf[32];\n\tsize_t buf_size;\n\tbool bv;\n\tu32 *val = file->private_data;\n\n\tbuf_size = min(count, (sizeof(buf)-1));\n\tif (copy_from_user(buf, user_buf, buf_size))\n\t\treturn -EFAULT;\n\n\tbuf[buf_size] = '\\0';\n\tif (strtobool(buf, &bv) == 0)\n\t\t*val = bv;\n\n\treturn count;\n}"
  },
  {
    "function_name": "read_file_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "450-463",
    "snippet": "static ssize_t read_file_bool(struct file *file, char __user *user_buf,\n\t\t\t      size_t count, loff_t *ppos)\n{\n\tchar buf[3];\n\tu32 *val = file->private_data;\n\n\tif (*val)\n\t\tbuf[0] = 'Y';\n\telse\n\t\tbuf[0] = 'N';\n\tbuf[1] = '\\n';\n\tbuf[2] = 0x00;\n\treturn simple_read_from_buffer(user_buf, count, ppos, buf, 2);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "user_buf",
            "count",
            "ppos",
            "buf",
            "2"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "simple_read_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/libfs.c",
          "lines": "590-608",
          "snippet": "ssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic ssize_t read_file_bool(struct file *file, char __user *user_buf,\n\t\t\t      size_t count, loff_t *ppos)\n{\n\tchar buf[3];\n\tu32 *val = file->private_data;\n\n\tif (*val)\n\t\tbuf[0] = 'Y';\n\telse\n\t\tbuf[0] = 'N';\n\tbuf[1] = '\\n';\n\tbuf[2] = 0x00;\n\treturn simple_read_from_buffer(user_buf, count, ppos, buf, 2);\n}"
  },
  {
    "function_name": "debugfs_create_atomic_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "434-447",
    "snippet": "struct dentry *debugfs_create_atomic_t(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, atomic_t *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value,\n\t\t\t\t\t&fops_atomic_t_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value,\n\t\t\t\t\t&fops_atomic_t_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_atomic_t);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_atomic_t"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_atomic_t(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, atomic_t *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value,\n\t\t\t\t\t&fops_atomic_t_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value,\n\t\t\t\t\t&fops_atomic_t_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_atomic_t);\n}"
  },
  {
    "function_name": "debugfs_atomic_t_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "413-417",
    "snippet": "static int debugfs_atomic_t_get(void *data, u64 *val)\n{\n\t*val = atomic_read((atomic_t *)data);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "(atomic_t *)data"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_atomic_t_get(void *data, u64 *val)\n{\n\t*val = atomic_read((atomic_t *)data);\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_atomic_t_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "408-412",
    "snippet": "static int debugfs_atomic_t_set(void *data, u64 val)\n{\n\tatomic_set((atomic_t *)data, val);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "(atomic_t *)data",
            "val"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_atomic_t_set(void *data, u64 val)\n{\n\tatomic_set((atomic_t *)data, val);\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_create_size_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "401-405",
    "snippet": "struct dentry *debugfs_create_size_t(const char *name, umode_t mode,\n\t\t\t\t     struct dentry *parent, size_t *value)\n{\n\treturn debugfs_create_file(name, mode, parent, value, &fops_size_t);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_size_t"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_size_t(const char *name, umode_t mode,\n\t\t\t\t     struct dentry *parent, size_t *value)\n{\n\treturn debugfs_create_file(name, mode, parent, value, &fops_size_t);\n}"
  },
  {
    "function_name": "debugfs_size_t_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "383-387",
    "snippet": "static int debugfs_size_t_get(void *data, u64 *val)\n{\n\t*val = *(size_t *)data;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_size_t_get(void *data, u64 *val)\n{\n\t*val = *(size_t *)data;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_size_t_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "378-382",
    "snippet": "static int debugfs_size_t_set(void *data, u64 val)\n{\n\t*(size_t *)data = val;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_size_t_set(void *data, u64 val)\n{\n\t*(size_t *)data = val;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_create_x64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "370-374",
    "snippet": "struct dentry *debugfs_create_x64(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u64 *value)\n{\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x64);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_x64"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_x64(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u64 *value)\n{\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x64);\n}"
  },
  {
    "function_name": "debugfs_create_x32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "346-357",
    "snippet": "struct dentry *debugfs_create_x32(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u32 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x32_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x32_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x32);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_x32"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_x32(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u32 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x32_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x32_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x32);\n}"
  },
  {
    "function_name": "debugfs_create_x16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "322-333",
    "snippet": "struct dentry *debugfs_create_x16(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u16 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x16_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x16_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x16);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_x16"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_x16(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u16 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x16_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x16_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x16);\n}"
  },
  {
    "function_name": "debugfs_create_x8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "298-309",
    "snippet": "struct dentry *debugfs_create_x8(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u8 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x8_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x8_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x8);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_x8"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_x8(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u8 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x8_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_x8_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_x8);\n}"
  },
  {
    "function_name": "debugfs_create_u64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "252-263",
    "snippet": "struct dentry *debugfs_create_u64(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u64 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u64);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_u64"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_u64(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u64 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u64);\n}"
  },
  {
    "function_name": "debugfs_u64_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "219-223",
    "snippet": "static int debugfs_u64_get(void *data, u64 *val)\n{\n\t*val = *(u64 *)data;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u64_get(void *data, u64 *val)\n{\n\t*val = *(u64 *)data;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_u64_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "213-217",
    "snippet": "static int debugfs_u64_set(void *data, u64 val)\n{\n\t*(u64 *)data = val;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u64_set(void *data, u64 val)\n{\n\t*(u64 *)data = val;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_create_u32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "199-210",
    "snippet": "struct dentry *debugfs_create_u32(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u32 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u32_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u32_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u32);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_u32"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_u32(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u32 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u32_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u32_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u32);\n}"
  },
  {
    "function_name": "debugfs_u32_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "166-170",
    "snippet": "static int debugfs_u32_get(void *data, u64 *val)\n{\n\t*val = *(u32 *)data;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u32_get(void *data, u64 *val)\n{\n\t*val = *(u32 *)data;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_u32_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "161-165",
    "snippet": "static int debugfs_u32_set(void *data, u64 val)\n{\n\t*(u32 *)data = val;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u32_set(void *data, u64 val)\n{\n\t*(u32 *)data = val;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_create_u16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "147-158",
    "snippet": "struct dentry *debugfs_create_u16(const char *name, umode_t mode,\n\t\t\t\t  struct dentry *parent, u16 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u16_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u16_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u16);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_u16"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_u16(const char *name, umode_t mode,\n\t\t\t\t  struct dentry *parent, u16 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u16_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u16_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u16);\n}"
  },
  {
    "function_name": "debugfs_u16_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "114-118",
    "snippet": "static int debugfs_u16_get(void *data, u64 *val)\n{\n\t*val = *(u16 *)data;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u16_get(void *data, u64 *val)\n{\n\t*val = *(u16 *)data;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_u16_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "109-113",
    "snippet": "static int debugfs_u16_set(void *data, u64 val)\n{\n\t*(u16 *)data = val;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u16_set(void *data, u64 val)\n{\n\t*(u16 *)data = val;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_create_u8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "95-106",
    "snippet": "struct dentry *debugfs_create_u8(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u8 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u8_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u8_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u8);\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "mode",
            "parent",
            "value",
            "&fops_u8"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_u8(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u8 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u8_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u8_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u8);\n}"
  },
  {
    "function_name": "debugfs_u8_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "62-66",
    "snippet": "static int debugfs_u8_get(void *data, u64 *val)\n{\n\t*val = *(u8 *)data;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u8_get(void *data, u64 *val)\n{\n\t*val = *(u8 *)data;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_u8_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "57-61",
    "snippet": "static int debugfs_u8_set(void *data, u64 val)\n{\n\t*(u8 *)data = val;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic int debugfs_u8_set(void *data, u64 val)\n{\n\t*(u8 *)data = val;\n\treturn 0;\n}"
  },
  {
    "function_name": "debugfs_follow_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "46-50",
    "snippet": "static void *debugfs_follow_link(struct dentry *dentry, struct nameidata *nd)\n{\n\tnd_set_link(nd, dentry->d_inode->i_private);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nd_set_link",
          "args": [
            "nd",
            "dentry->d_inode->i_private"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "nd_set_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "717-720",
          "snippet": "void nd_set_link(struct nameidata *nd, char *path)\n{\n\tnd->saved_names[nd->depth] = path;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int link_path_walk(const char *, struct nameidata *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int link_path_walk(const char *, struct nameidata *);\n\nvoid nd_set_link(struct nameidata *nd, char *path)\n{\n\tnd->saved_names[nd->depth] = path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void *debugfs_follow_link(struct dentry *dentry, struct nameidata *nd)\n{\n\tnd_set_link(nd, dentry->d_inode->i_private);\n\treturn NULL;\n}"
  },
  {
    "function_name": "default_write_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "33-37",
    "snippet": "static ssize_t default_write_file(struct file *file, const char __user *buf,\n\t\t\t\t   size_t count, loff_t *ppos)\n{\n\treturn count;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic ssize_t default_write_file(struct file *file, const char __user *buf,\n\t\t\t\t   size_t count, loff_t *ppos)\n{\n\treturn count;\n}"
  },
  {
    "function_name": "default_read_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
    "lines": "27-31",
    "snippet": "static ssize_t default_read_file(struct file *file, char __user *buf,\n\t\t\t\t size_t count, loff_t *ppos)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <linux/device.h>",
      "#include <linux/atomic.h>",
      "#include <linux/slab.h>",
      "#include <linux/io.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic ssize_t default_read_file(struct file *file, char __user *buf,\n\t\t\t\t size_t count, loff_t *ppos)\n{\n\treturn 0;\n}"
  }
]