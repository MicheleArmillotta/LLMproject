[
  {
    "function_name": "configfs_put_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "299-306",
    "snippet": "static void configfs_put_link(struct dentry *dentry, struct nameidata *nd,\n\t\t\t      void *cookie)\n{\n\tif (cookie) {\n\t\tunsigned long page = (unsigned long)cookie;\n\t\tfree_page(page);\n\t}\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_page",
          "args": [
            "page"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "_xfs_buf_free_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_buf.c",
          "lines": "238-246",
          "snippet": "STATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/migrate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hash.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/percpu.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/bio.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/gfp.h>",
            "#include <linux/errno.h>",
            "#include <linux/stddef.h>",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include <linux/freezer.h>\n#include <linux/backing-dev.h>\n#include <linux/migrate.h>\n#include <linux/kthread.h>\n#include <linux/hash.h>\n#include <linux/blkdev.h>\n#include <linux/percpu.h>\n#include <linux/workqueue.h>\n#include <linux/proc_fs.h>\n#include <linux/sysctl.h>\n#include <linux/bio.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/gfp.h>\n#include <linux/errno.h>\n#include <linux/stddef.h>\n#include \"xfs.h\"\n\nSTATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic void configfs_put_link(struct dentry *dentry, struct nameidata *nd,\n\t\t\t      void *cookie)\n{\n\tif (cookie) {\n\t\tunsigned long page = (unsigned long)cookie;\n\t\tfree_page(page);\n\t}\n}"
  },
  {
    "function_name": "configfs_follow_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "282-297",
    "snippet": "static void *configfs_follow_link(struct dentry *dentry, struct nameidata *nd)\n{\n\tint error = -ENOMEM;\n\tunsigned long page = get_zeroed_page(GFP_KERNEL);\n\n\tif (page) {\n\t\terror = configfs_getlink(dentry, (char *)page);\n\t\tif (!error) {\n\t\t\tnd_set_link(nd, (char *)page);\n\t\t\treturn (void *)page;\n\t\t}\n\t}\n\n\tnd_set_link(nd, ERR_PTR(error));\n\treturn NULL;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nd_set_link",
          "args": [
            "nd",
            "ERR_PTR(error)"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "nd_set_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "717-720",
          "snippet": "void nd_set_link(struct nameidata *nd, char *path)\n{\n\tnd->saved_names[nd->depth] = path;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int link_path_walk(const char *, struct nameidata *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int link_path_walk(const char *, struct nameidata *);\n\nvoid nd_set_link(struct nameidata *nd, char *path)\n{\n\tnd->saved_names[nd->depth] = path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configfs_getlink",
          "args": [
            "dentry",
            "(char *)page"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_getlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
          "lines": "257-280",
          "snippet": "static int configfs_getlink(struct dentry *dentry, char * path)\n{\n\tstruct config_item *item, *target_item;\n\tint error = 0;\n\n\titem = configfs_get_config_item(dentry->d_parent);\n\tif (!item)\n\t\treturn -EINVAL;\n\n\ttarget_item = configfs_get_config_item(dentry);\n\tif (!target_item) {\n\t\tconfig_item_put(item);\n\t\treturn -EINVAL;\n\t}\n\n\tdown_read(&configfs_rename_sem);\n\terror = configfs_get_target_path(item, target_item, path);\n\tup_read(&configfs_rename_sem);\n\n\tconfig_item_put(item);\n\tconfig_item_put(target_item);\n\treturn error;\n\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int configfs_getlink(struct dentry *dentry, char * path)\n{\n\tstruct config_item *item, *target_item;\n\tint error = 0;\n\n\titem = configfs_get_config_item(dentry->d_parent);\n\tif (!item)\n\t\treturn -EINVAL;\n\n\ttarget_item = configfs_get_config_item(dentry);\n\tif (!target_item) {\n\t\tconfig_item_put(item);\n\t\treturn -EINVAL;\n\t}\n\n\tdown_read(&configfs_rename_sem);\n\terror = configfs_get_target_path(item, target_item, path);\n\tup_read(&configfs_rename_sem);\n\n\tconfig_item_put(item);\n\tconfig_item_put(target_item);\n\treturn error;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "GFP_KERNEL"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic void *configfs_follow_link(struct dentry *dentry, struct nameidata *nd)\n{\n\tint error = -ENOMEM;\n\tunsigned long page = get_zeroed_page(GFP_KERNEL);\n\n\tif (page) {\n\t\terror = configfs_getlink(dentry, (char *)page);\n\t\tif (!error) {\n\t\t\tnd_set_link(nd, (char *)page);\n\t\t\treturn (void *)page;\n\t\t}\n\t}\n\n\tnd_set_link(nd, ERR_PTR(error));\n\treturn NULL;\n}"
  },
  {
    "function_name": "configfs_getlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "257-280",
    "snippet": "static int configfs_getlink(struct dentry *dentry, char * path)\n{\n\tstruct config_item *item, *target_item;\n\tint error = 0;\n\n\titem = configfs_get_config_item(dentry->d_parent);\n\tif (!item)\n\t\treturn -EINVAL;\n\n\ttarget_item = configfs_get_config_item(dentry);\n\tif (!target_item) {\n\t\tconfig_item_put(item);\n\t\treturn -EINVAL;\n\t}\n\n\tdown_read(&configfs_rename_sem);\n\terror = configfs_get_target_path(item, target_item, path);\n\tup_read(&configfs_rename_sem);\n\n\tconfig_item_put(item);\n\tconfig_item_put(target_item);\n\treturn error;\n\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "target_item"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&configfs_rename_sem"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configfs_get_target_path",
          "args": [
            "item",
            "target_item",
            "path"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_get_target_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
          "lines": "235-255",
          "snippet": "static int configfs_get_target_path(struct config_item * item, struct config_item * target,\n\t\t\t\t   char *path)\n{\n\tchar * s;\n\tint depth, size;\n\n\tdepth = item_depth(item);\n\tsize = item_path_length(target) + depth * 3 - 1;\n\tif (size > PATH_MAX)\n\t\treturn -ENAMETOOLONG;\n\n\tpr_debug(\"%s: depth = %d, size = %d\\n\", __func__, depth, size);\n\n\tfor (s = path; depth--; s += 3)\n\t\tstrcpy(s,\"../\");\n\n\tfill_item_path(target, path, size);\n\tpr_debug(\"%s: path = '%s'\\n\", __func__, path);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int configfs_get_target_path(struct config_item * item, struct config_item * target,\n\t\t\t\t   char *path)\n{\n\tchar * s;\n\tint depth, size;\n\n\tdepth = item_depth(item);\n\tsize = item_path_length(target) + depth * 3 - 1;\n\tif (size > PATH_MAX)\n\t\treturn -ENAMETOOLONG;\n\n\tpr_debug(\"%s: depth = %d, size = %d\\n\", __func__, depth, size);\n\n\tfor (s = path; depth--; s += 3)\n\t\tstrcpy(s,\"../\");\n\n\tfill_item_path(target, path, size);\n\tpr_debug(\"%s: path = '%s'\\n\", __func__, path);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&configfs_rename_sem"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configfs_get_config_item",
          "args": [
            "dentry"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_get_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
          "lines": "122-138",
          "snippet": "static inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define CONFIGFS_ITEM_LINK\t0x0020"
          ],
          "globals_used": [
            "extern int configfs_is_root(struct config_item *item);",
            "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
            "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);",
            "extern int configfs_unlink(struct inode *dir, struct dentry *dentry);",
            "extern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\n#define CONFIGFS_ITEM_LINK\t0x0020\n\nextern int configfs_is_root(struct config_item *item);\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\nextern int configfs_unlink(struct inode *dir, struct dentry *dentry);\nextern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);\n\nstatic inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int configfs_getlink(struct dentry *dentry, char * path)\n{\n\tstruct config_item *item, *target_item;\n\tint error = 0;\n\n\titem = configfs_get_config_item(dentry->d_parent);\n\tif (!item)\n\t\treturn -EINVAL;\n\n\ttarget_item = configfs_get_config_item(dentry);\n\tif (!target_item) {\n\t\tconfig_item_put(item);\n\t\treturn -EINVAL;\n\t}\n\n\tdown_read(&configfs_rename_sem);\n\terror = configfs_get_target_path(item, target_item, path);\n\tup_read(&configfs_rename_sem);\n\n\tconfig_item_put(item);\n\tconfig_item_put(target_item);\n\treturn error;\n\n}"
  },
  {
    "function_name": "configfs_get_target_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "235-255",
    "snippet": "static int configfs_get_target_path(struct config_item * item, struct config_item * target,\n\t\t\t\t   char *path)\n{\n\tchar * s;\n\tint depth, size;\n\n\tdepth = item_depth(item);\n\tsize = item_path_length(target) + depth * 3 - 1;\n\tif (size > PATH_MAX)\n\t\treturn -ENAMETOOLONG;\n\n\tpr_debug(\"%s: depth = %d, size = %d\\n\", __func__, depth, size);\n\n\tfor (s = path; depth--; s += 3)\n\t\tstrcpy(s,\"../\");\n\n\tfill_item_path(target, path, size);\n\tpr_debug(\"%s: path = '%s'\\n\", __func__, path);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s: path = '%s'\\n\"",
            "__func__",
            "path"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fill_item_path",
          "args": [
            "target",
            "path",
            "size"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "fill_item_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
          "lines": "57-70",
          "snippet": "static void fill_item_path(struct config_item * item, char * buffer, int length)\n{\n\tstruct config_item * p;\n\n\t--length;\n\tfor (p = item; p && !configfs_is_root(p); p = p->ci_parent) {\n\t\tint cur = strlen(config_item_name(p));\n\n\t\t/* back up enough to print this bus id with '/' */\n\t\tlength -= cur;\n\t\tstrncpy(buffer + length,config_item_name(p),cur);\n\t\t*(buffer + --length) = '/';\n\t}\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic void fill_item_path(struct config_item * item, char * buffer, int length)\n{\n\tstruct config_item * p;\n\n\t--length;\n\tfor (p = item; p && !configfs_is_root(p); p = p->ci_parent) {\n\t\tint cur = strlen(config_item_name(p));\n\n\t\t/* back up enough to print this bus id with '/' */\n\t\tlength -= cur;\n\t\tstrncpy(buffer + length,config_item_name(p),cur);\n\t\t*(buffer + --length) = '/';\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "s",
            "\"../\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s: depth = %d, size = %d\\n\"",
            "__func__",
            "depth",
            "size"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item_path_length",
          "args": [
            "target"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "item_path_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
          "lines": "46-55",
          "snippet": "static int item_path_length(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint length = 1;\n\tdo {\n\t\tlength += strlen(config_item_name(p)) + 1;\n\t\tp = p->ci_parent;\n\t} while (p && !configfs_is_root(p));\n\treturn length;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int item_path_length(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint length = 1;\n\tdo {\n\t\tlength += strlen(config_item_name(p)) + 1;\n\t\tp = p->ci_parent;\n\t} while (p && !configfs_is_root(p));\n\treturn length;\n}"
        }
      },
      {
        "call_info": {
          "callee": "item_depth",
          "args": [
            "item"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "item_depth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
          "lines": "38-44",
          "snippet": "static int item_depth(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint depth = 0;\n\tdo { depth++; } while ((p = p->ci_parent) && !configfs_is_root(p));\n\treturn depth;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int item_depth(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint depth = 0;\n\tdo { depth++; } while ((p = p->ci_parent) && !configfs_is_root(p));\n\treturn depth;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int configfs_get_target_path(struct config_item * item, struct config_item * target,\n\t\t\t\t   char *path)\n{\n\tchar * s;\n\tint depth, size;\n\n\tdepth = item_depth(item);\n\tsize = item_path_length(target) + depth * 3 - 1;\n\tif (size > PATH_MAX)\n\t\treturn -ENAMETOOLONG;\n\n\tpr_debug(\"%s: depth = %d, size = %d\\n\", __func__, depth, size);\n\n\tfor (s = path; depth--; s += 3)\n\t\tstrcpy(s,\"../\");\n\n\tfill_item_path(target, path, size);\n\tpr_debug(\"%s: path = '%s'\\n\", __func__, path);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "configfs_unlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "185-233",
    "snippet": "int configfs_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct configfs_dirent *sd = dentry->d_fsdata;\n\tstruct configfs_symlink *sl;\n\tstruct config_item *parent_item;\n\tstruct config_item_type *type;\n\tint ret;\n\n\tret = -EPERM;  /* What lack-of-symlink returns */\n\tif (!(sd->s_type & CONFIGFS_ITEM_LINK))\n\t\tgoto out;\n\n\tsl = sd->s_element;\n\n\tparent_item = configfs_get_config_item(dentry->d_parent);\n\ttype = parent_item->ci_type;\n\n\tspin_lock(&configfs_dirent_lock);\n\tlist_del_init(&sd->s_sibling);\n\tspin_unlock(&configfs_dirent_lock);\n\tconfigfs_drop_dentry(sd, dentry->d_parent);\n\tdput(dentry);\n\tconfigfs_put(sd);\n\n\t/*\n\t * drop_link() must be called before\n\t * list_del_init(&sl->sl_list), so that the order of\n\t * drop_link(this, target) and drop_item(target) is preserved.\n\t */\n\tif (type && type->ct_item_ops &&\n\t    type->ct_item_ops->drop_link)\n\t\ttype->ct_item_ops->drop_link(parent_item,\n\t\t\t\t\t       sl->sl_target);\n\n\tspin_lock(&configfs_dirent_lock);\n\tlist_del_init(&sl->sl_list);\n\tspin_unlock(&configfs_dirent_lock);\n\n\t/* Put reference from create_link() */\n\tconfig_item_put(sl->sl_target);\n\tkfree(sl);\n\n\tconfig_item_put(parent_item);\n\n\tret = 0;\n\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "parent_item"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sl"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&configfs_dirent_lock"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&sl->sl_list"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&configfs_dirent_lock"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "type->ct_item_ops->drop_link",
          "args": [
            "parent_item",
            "sl->sl_target"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configfs_put",
          "args": [
            "sd"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
          "lines": "157-162",
          "snippet": "static inline void configfs_put(struct configfs_dirent * sd)\n{\n\tWARN_ON(!atomic_read(&sd->s_count));\n\tif (atomic_dec_and_test(&sd->s_count))\n\t\trelease_configfs_dirent(sd);\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
            "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\n\nstatic inline void configfs_put(struct configfs_dirent * sd)\n{\n\tWARN_ON(!atomic_read(&sd->s_count));\n\tif (atomic_dec_and_test(&sd->s_count))\n\t\trelease_configfs_dirent(sd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "dentry"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "dput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "726-762",
          "snippet": "void dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "configfs_drop_dentry",
          "args": [
            "sd",
            "dentry->d_parent"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_drop_dentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/inode.c",
          "lines": "233-247",
          "snippet": "void configfs_drop_dentry(struct configfs_dirent * sd, struct dentry * parent)\n{\n\tstruct dentry * dentry = sd->s_dentry;\n\n\tif (dentry) {\n\t\tspin_lock(&dentry->d_lock);\n\t\tif (!d_unhashed(dentry) && dentry->d_inode) {\n\t\t\tdget_dlock(dentry);\n\t\t\t__d_drop(dentry);\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\tsimple_unlink(parent->d_inode, dentry);\n\t\t} else\n\t\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/sched.h>",
            "#include <linux/capability.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/lockdep.h>\n#include <linux/sched.h>\n#include <linux/capability.h>\n#include <linux/backing-dev.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n\nvoid configfs_drop_dentry(struct configfs_dirent * sd, struct dentry * parent)\n{\n\tstruct dentry * dentry = sd->s_dentry;\n\n\tif (dentry) {\n\t\tspin_lock(&dentry->d_lock);\n\t\tif (!d_unhashed(dentry) && dentry->d_inode) {\n\t\t\tdget_dlock(dentry);\n\t\t\t__d_drop(dentry);\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\tsimple_unlink(parent->d_inode, dentry);\n\t\t} else\n\t\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&sd->s_sibling"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configfs_get_config_item",
          "args": [
            "dentry->d_parent"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_get_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
          "lines": "122-138",
          "snippet": "static inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define CONFIGFS_ITEM_LINK\t0x0020"
          ],
          "globals_used": [
            "extern int configfs_is_root(struct config_item *item);",
            "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
            "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);",
            "extern int configfs_unlink(struct inode *dir, struct dentry *dentry);",
            "extern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\n#define CONFIGFS_ITEM_LINK\t0x0020\n\nextern int configfs_is_root(struct config_item *item);\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\nextern int configfs_unlink(struct inode *dir, struct dentry *dentry);\nextern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);\n\nstatic inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nint configfs_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct configfs_dirent *sd = dentry->d_fsdata;\n\tstruct configfs_symlink *sl;\n\tstruct config_item *parent_item;\n\tstruct config_item_type *type;\n\tint ret;\n\n\tret = -EPERM;  /* What lack-of-symlink returns */\n\tif (!(sd->s_type & CONFIGFS_ITEM_LINK))\n\t\tgoto out;\n\n\tsl = sd->s_element;\n\n\tparent_item = configfs_get_config_item(dentry->d_parent);\n\ttype = parent_item->ci_type;\n\n\tspin_lock(&configfs_dirent_lock);\n\tlist_del_init(&sd->s_sibling);\n\tspin_unlock(&configfs_dirent_lock);\n\tconfigfs_drop_dentry(sd, dentry->d_parent);\n\tdput(dentry);\n\tconfigfs_put(sd);\n\n\t/*\n\t * drop_link() must be called before\n\t * list_del_init(&sl->sl_list), so that the order of\n\t * drop_link(this, target) and drop_item(target) is preserved.\n\t */\n\tif (type && type->ct_item_ops &&\n\t    type->ct_item_ops->drop_link)\n\t\ttype->ct_item_ops->drop_link(parent_item,\n\t\t\t\t\t       sl->sl_target);\n\n\tspin_lock(&configfs_dirent_lock);\n\tlist_del_init(&sl->sl_list);\n\tspin_unlock(&configfs_dirent_lock);\n\n\t/* Put reference from create_link() */\n\tconfig_item_put(sl->sl_target);\n\tkfree(sl);\n\n\tconfig_item_put(parent_item);\n\n\tret = 0;\n\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "configfs_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "135-183",
    "snippet": "int configfs_symlink(struct inode *dir, struct dentry *dentry, const char *symname)\n{\n\tint ret;\n\tstruct path path;\n\tstruct configfs_dirent *sd;\n\tstruct config_item *parent_item;\n\tstruct config_item *target_item = NULL;\n\tstruct config_item_type *type;\n\n\tsd = dentry->d_parent->d_fsdata;\n\t/*\n\t * Fake invisibility if dir belongs to a group/default groups hierarchy\n\t * being attached\n\t */\n\tret = -ENOENT;\n\tif (!configfs_dirent_is_ready(sd))\n\t\tgoto out;\n\n\tparent_item = configfs_get_config_item(dentry->d_parent);\n\ttype = parent_item->ci_type;\n\n\tret = -EPERM;\n\tif (!type || !type->ct_item_ops ||\n\t    !type->ct_item_ops->allow_link)\n\t\tgoto out_put;\n\n\tret = get_target(symname, &path, &target_item, dentry->d_sb);\n\tif (ret)\n\t\tgoto out_put;\n\n\tret = type->ct_item_ops->allow_link(parent_item, target_item);\n\tif (!ret) {\n\t\tmutex_lock(&configfs_symlink_mutex);\n\t\tret = create_link(parent_item, target_item, dentry);\n\t\tmutex_unlock(&configfs_symlink_mutex);\n\t\tif (ret && type->ct_item_ops->drop_link)\n\t\t\ttype->ct_item_ops->drop_link(parent_item,\n\t\t\t\t\t\t     target_item);\n\t}\n\n\tconfig_item_put(target_item);\n\tpath_put(&path);\n\nout_put:\n\tconfig_item_put(parent_item);\n\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "parent_item"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&path"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "path_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "489-493",
          "snippet": "void path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "type->ct_item_ops->drop_link",
          "args": [
            "parent_item",
            "target_item"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&configfs_symlink_mutex"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_link",
          "args": [
            "parent_item",
            "target_item",
            "dentry"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "create_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
          "lines": "72-109",
          "snippet": "static int create_link(struct config_item *parent_item,\n\t\t       struct config_item *item,\n\t\t       struct dentry *dentry)\n{\n\tstruct configfs_dirent *target_sd = item->ci_dentry->d_fsdata;\n\tstruct configfs_symlink *sl;\n\tint ret;\n\n\tret = -ENOENT;\n\tif (!configfs_dirent_is_ready(target_sd))\n\t\tgoto out;\n\tret = -ENOMEM;\n\tsl = kmalloc(sizeof(struct configfs_symlink), GFP_KERNEL);\n\tif (sl) {\n\t\tsl->sl_target = config_item_get(item);\n\t\tspin_lock(&configfs_dirent_lock);\n\t\tif (target_sd->s_type & CONFIGFS_USET_DROPPING) {\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tlist_add(&sl->sl_list, &target_sd->s_links);\n\t\tspin_unlock(&configfs_dirent_lock);\n\t\tret = configfs_create_link(sl, parent_item->ci_dentry,\n\t\t\t\t\t   dentry);\n\t\tif (ret) {\n\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\tlist_del_init(&sl->sl_list);\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t}\n\t}\n\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int create_link(struct config_item *parent_item,\n\t\t       struct config_item *item,\n\t\t       struct dentry *dentry)\n{\n\tstruct configfs_dirent *target_sd = item->ci_dentry->d_fsdata;\n\tstruct configfs_symlink *sl;\n\tint ret;\n\n\tret = -ENOENT;\n\tif (!configfs_dirent_is_ready(target_sd))\n\t\tgoto out;\n\tret = -ENOMEM;\n\tsl = kmalloc(sizeof(struct configfs_symlink), GFP_KERNEL);\n\tif (sl) {\n\t\tsl->sl_target = config_item_get(item);\n\t\tspin_lock(&configfs_dirent_lock);\n\t\tif (target_sd->s_type & CONFIGFS_USET_DROPPING) {\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tlist_add(&sl->sl_list, &target_sd->s_links);\n\t\tspin_unlock(&configfs_dirent_lock);\n\t\tret = configfs_create_link(sl, parent_item->ci_dentry,\n\t\t\t\t\t   dentry);\n\t\tif (ret) {\n\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\tlist_del_init(&sl->sl_list);\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t}\n\t}\n\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&configfs_symlink_mutex"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type->ct_item_ops->allow_link",
          "args": [
            "parent_item",
            "target_item"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_target",
          "args": [
            "symname",
            "&path",
            "&target_item",
            "dentry->d_sb"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "get_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
          "lines": "112-132",
          "snippet": "static int get_target(const char *symname, struct path *path,\n\t\t      struct config_item **target, struct super_block *sb)\n{\n\tint ret;\n\n\tret = kern_path(symname, LOOKUP_FOLLOW|LOOKUP_DIRECTORY, path);\n\tif (!ret) {\n\t\tif (path->dentry->d_sb == sb) {\n\t\t\t*target = configfs_get_config_item(path->dentry);\n\t\t\tif (!*target) {\n\t\t\t\tret = -ENOENT;\n\t\t\t\tpath_put(path);\n\t\t\t}\n\t\t} else {\n\t\t\tret = -EPERM;\n\t\t\tpath_put(path);\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int get_target(const char *symname, struct path *path,\n\t\t      struct config_item **target, struct super_block *sb)\n{\n\tint ret;\n\n\tret = kern_path(symname, LOOKUP_FOLLOW|LOOKUP_DIRECTORY, path);\n\tif (!ret) {\n\t\tif (path->dentry->d_sb == sb) {\n\t\t\t*target = configfs_get_config_item(path->dentry);\n\t\t\tif (!*target) {\n\t\t\t\tret = -ENOENT;\n\t\t\t\tpath_put(path);\n\t\t\t}\n\t\t} else {\n\t\t\tret = -EPERM;\n\t\t\tpath_put(path);\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "configfs_get_config_item",
          "args": [
            "dentry->d_parent"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_get_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
          "lines": "122-138",
          "snippet": "static inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define CONFIGFS_ITEM_LINK\t0x0020"
          ],
          "globals_used": [
            "extern int configfs_is_root(struct config_item *item);",
            "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
            "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);",
            "extern int configfs_unlink(struct inode *dir, struct dentry *dentry);",
            "extern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\n#define CONFIGFS_ITEM_LINK\t0x0020\n\nextern int configfs_is_root(struct config_item *item);\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\nextern int configfs_unlink(struct inode *dir, struct dentry *dentry);\nextern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);\n\nstatic inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}"
        }
      },
      {
        "call_info": {
          "callee": "configfs_dirent_is_ready",
          "args": [
            "sd"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_dirent_is_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/dir.c",
          "lines": "333-342",
          "snippet": "int configfs_dirent_is_ready(struct configfs_dirent *sd)\n{\n\tint ret;\n\n\tspin_lock(&configfs_dirent_lock);\n\tret = !(sd->s_type & CONFIGFS_USET_CREATING);\n\tspin_unlock(&configfs_dirent_lock);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/err.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/err.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nint configfs_dirent_is_ready(struct configfs_dirent *sd)\n{\n\tint ret;\n\n\tspin_lock(&configfs_dirent_lock);\n\tret = !(sd->s_type & CONFIGFS_USET_CREATING);\n\tspin_unlock(&configfs_dirent_lock);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nint configfs_symlink(struct inode *dir, struct dentry *dentry, const char *symname)\n{\n\tint ret;\n\tstruct path path;\n\tstruct configfs_dirent *sd;\n\tstruct config_item *parent_item;\n\tstruct config_item *target_item = NULL;\n\tstruct config_item_type *type;\n\n\tsd = dentry->d_parent->d_fsdata;\n\t/*\n\t * Fake invisibility if dir belongs to a group/default groups hierarchy\n\t * being attached\n\t */\n\tret = -ENOENT;\n\tif (!configfs_dirent_is_ready(sd))\n\t\tgoto out;\n\n\tparent_item = configfs_get_config_item(dentry->d_parent);\n\ttype = parent_item->ci_type;\n\n\tret = -EPERM;\n\tif (!type || !type->ct_item_ops ||\n\t    !type->ct_item_ops->allow_link)\n\t\tgoto out_put;\n\n\tret = get_target(symname, &path, &target_item, dentry->d_sb);\n\tif (ret)\n\t\tgoto out_put;\n\n\tret = type->ct_item_ops->allow_link(parent_item, target_item);\n\tif (!ret) {\n\t\tmutex_lock(&configfs_symlink_mutex);\n\t\tret = create_link(parent_item, target_item, dentry);\n\t\tmutex_unlock(&configfs_symlink_mutex);\n\t\tif (ret && type->ct_item_ops->drop_link)\n\t\t\ttype->ct_item_ops->drop_link(parent_item,\n\t\t\t\t\t\t     target_item);\n\t}\n\n\tconfig_item_put(target_item);\n\tpath_put(&path);\n\nout_put:\n\tconfig_item_put(parent_item);\n\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "get_target",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "112-132",
    "snippet": "static int get_target(const char *symname, struct path *path,\n\t\t      struct config_item **target, struct super_block *sb)\n{\n\tint ret;\n\n\tret = kern_path(symname, LOOKUP_FOLLOW|LOOKUP_DIRECTORY, path);\n\tif (!ret) {\n\t\tif (path->dentry->d_sb == sb) {\n\t\t\t*target = configfs_get_config_item(path->dentry);\n\t\t\tif (!*target) {\n\t\t\t\tret = -ENOENT;\n\t\t\t\tpath_put(path);\n\t\t\t}\n\t\t} else {\n\t\t\tret = -EPERM;\n\t\t\tpath_put(path);\n\t\t}\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "path"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "path_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "489-493",
          "snippet": "void path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "configfs_get_config_item",
          "args": [
            "path->dentry"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_get_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
          "lines": "122-138",
          "snippet": "static inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define CONFIGFS_ITEM_LINK\t0x0020"
          ],
          "globals_used": [
            "extern int configfs_is_root(struct config_item *item);",
            "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
            "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);",
            "extern int configfs_unlink(struct inode *dir, struct dentry *dentry);",
            "extern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\n#define CONFIGFS_ITEM_LINK\t0x0020\n\nextern int configfs_is_root(struct config_item *item);\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\nextern int configfs_unlink(struct inode *dir, struct dentry *dentry);\nextern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);\n\nstatic inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kern_path",
          "args": [
            "symname",
            "LOOKUP_FOLLOW|LOOKUP_DIRECTORY",
            "path"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "kern_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "2089-2096",
          "snippet": "int kern_path(const char *name, unsigned int flags, struct path *path)\n{\n\tstruct nameidata nd;\n\tint res = do_path_lookup(AT_FDCWD, name, flags, &nd);\n\tif (!res)\n\t\t*path = nd.path;\n\treturn res;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int link_path_walk(const char *, struct nameidata *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int link_path_walk(const char *, struct nameidata *);\n\nint kern_path(const char *name, unsigned int flags, struct path *path)\n{\n\tstruct nameidata nd;\n\tint res = do_path_lookup(AT_FDCWD, name, flags, &nd);\n\tif (!res)\n\t\t*path = nd.path;\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int get_target(const char *symname, struct path *path,\n\t\t      struct config_item **target, struct super_block *sb)\n{\n\tint ret;\n\n\tret = kern_path(symname, LOOKUP_FOLLOW|LOOKUP_DIRECTORY, path);\n\tif (!ret) {\n\t\tif (path->dentry->d_sb == sb) {\n\t\t\t*target = configfs_get_config_item(path->dentry);\n\t\t\tif (!*target) {\n\t\t\t\tret = -ENOENT;\n\t\t\t\tpath_put(path);\n\t\t\t}\n\t\t} else {\n\t\t\tret = -EPERM;\n\t\t\tpath_put(path);\n\t\t}\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "create_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "72-109",
    "snippet": "static int create_link(struct config_item *parent_item,\n\t\t       struct config_item *item,\n\t\t       struct dentry *dentry)\n{\n\tstruct configfs_dirent *target_sd = item->ci_dentry->d_fsdata;\n\tstruct configfs_symlink *sl;\n\tint ret;\n\n\tret = -ENOENT;\n\tif (!configfs_dirent_is_ready(target_sd))\n\t\tgoto out;\n\tret = -ENOMEM;\n\tsl = kmalloc(sizeof(struct configfs_symlink), GFP_KERNEL);\n\tif (sl) {\n\t\tsl->sl_target = config_item_get(item);\n\t\tspin_lock(&configfs_dirent_lock);\n\t\tif (target_sd->s_type & CONFIGFS_USET_DROPPING) {\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tlist_add(&sl->sl_list, &target_sd->s_links);\n\t\tspin_unlock(&configfs_dirent_lock);\n\t\tret = configfs_create_link(sl, parent_item->ci_dentry,\n\t\t\t\t\t   dentry);\n\t\tif (ret) {\n\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\tlist_del_init(&sl->sl_list);\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t}\n\t}\n\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sl"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "item"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&configfs_dirent_lock"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&sl->sl_list"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&configfs_dirent_lock"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "configfs_create_link",
          "args": [
            "sl",
            "parent_item->ci_dentry",
            "dentry"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_create_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/dir.c",
          "lines": "344-366",
          "snippet": "int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t struct dentry *parent,\n\t\t\t struct dentry *dentry)\n{\n\tint err = 0;\n\tumode_t mode = S_IFLNK | S_IRWXUGO;\n\n\terr = configfs_make_dirent(parent->d_fsdata, dentry, sl, mode,\n\t\t\t\t   CONFIGFS_ITEM_LINK);\n\tif (!err) {\n\t\terr = configfs_create(dentry, mode, init_symlink);\n\t\tif (err) {\n\t\t\tstruct configfs_dirent *sd = dentry->d_fsdata;\n\t\t\tif (sd) {\n\t\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\t\tlist_del_init(&sd->s_sibling);\n\t\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\t\tconfigfs_put(sd);\n\t\t\t}\n\t\t}\n\t}\n\treturn err;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/err.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int configfs_attach_group(struct config_item *parent_item,\n\t\t\t\t struct config_item *item,\n\t\t\t\t struct dentry *dentry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/err.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstatic int configfs_attach_group(struct config_item *parent_item,\n\t\t\t\t struct config_item *item,\n\t\t\t\t struct dentry *dentry);\n\nint configfs_create_link(struct configfs_symlink *sl,\n\t\t\t struct dentry *parent,\n\t\t\t struct dentry *dentry)\n{\n\tint err = 0;\n\tumode_t mode = S_IFLNK | S_IRWXUGO;\n\n\terr = configfs_make_dirent(parent->d_fsdata, dentry, sl, mode,\n\t\t\t\t   CONFIGFS_ITEM_LINK);\n\tif (!err) {\n\t\terr = configfs_create(dentry, mode, init_symlink);\n\t\tif (err) {\n\t\t\tstruct configfs_dirent *sd = dentry->d_fsdata;\n\t\t\tif (sd) {\n\t\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\t\tlist_del_init(&sd->s_sibling);\n\t\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\t\tconfigfs_put(sd);\n\t\t\t}\n\t\t}\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&sl->sl_list",
            "&target_sd->s_links"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sl"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_get",
          "args": [
            "item"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "134-139",
          "snippet": "struct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstruct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(struct configfs_symlink)",
            "GFP_KERNEL"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "configfs_dirent_is_ready",
          "args": [
            "target_sd"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_dirent_is_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/dir.c",
          "lines": "333-342",
          "snippet": "int configfs_dirent_is_ready(struct configfs_dirent *sd)\n{\n\tint ret;\n\n\tspin_lock(&configfs_dirent_lock);\n\tret = !(sd->s_type & CONFIGFS_USET_CREATING);\n\tspin_unlock(&configfs_dirent_lock);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/err.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/err.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nint configfs_dirent_is_ready(struct configfs_dirent *sd)\n{\n\tint ret;\n\n\tspin_lock(&configfs_dirent_lock);\n\tret = !(sd->s_type & CONFIGFS_USET_CREATING);\n\tspin_unlock(&configfs_dirent_lock);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int create_link(struct config_item *parent_item,\n\t\t       struct config_item *item,\n\t\t       struct dentry *dentry)\n{\n\tstruct configfs_dirent *target_sd = item->ci_dentry->d_fsdata;\n\tstruct configfs_symlink *sl;\n\tint ret;\n\n\tret = -ENOENT;\n\tif (!configfs_dirent_is_ready(target_sd))\n\t\tgoto out;\n\tret = -ENOMEM;\n\tsl = kmalloc(sizeof(struct configfs_symlink), GFP_KERNEL);\n\tif (sl) {\n\t\tsl->sl_target = config_item_get(item);\n\t\tspin_lock(&configfs_dirent_lock);\n\t\tif (target_sd->s_type & CONFIGFS_USET_DROPPING) {\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tlist_add(&sl->sl_list, &target_sd->s_links);\n\t\tspin_unlock(&configfs_dirent_lock);\n\t\tret = configfs_create_link(sl, parent_item->ci_dentry,\n\t\t\t\t\t   dentry);\n\t\tif (ret) {\n\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\tlist_del_init(&sl->sl_list);\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t\tconfig_item_put(item);\n\t\t\tkfree(sl);\n\t\t}\n\t}\n\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "fill_item_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "57-70",
    "snippet": "static void fill_item_path(struct config_item * item, char * buffer, int length)\n{\n\tstruct config_item * p;\n\n\t--length;\n\tfor (p = item; p && !configfs_is_root(p); p = p->ci_parent) {\n\t\tint cur = strlen(config_item_name(p));\n\n\t\t/* back up enough to print this bus id with '/' */\n\t\tlength -= cur;\n\t\tstrncpy(buffer + length,config_item_name(p),cur);\n\t\t*(buffer + --length) = '/';\n\t}\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "buffer + length",
            "config_item_name(p)",
            "cur"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "p"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "config_item_name(p)"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "p"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configfs_is_root",
          "args": [
            "p"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_is_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/mount.c",
          "lines": "56-59",
          "snippet": "int configfs_is_root(struct config_item *item)\n{\n\treturn item == &configfs_root_group.cg_item;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct config_group configfs_root_group = {\n\t.cg_item = {\n\t\t.ci_namebuf\t= \"root\",\n\t\t.ci_name\t= configfs_root_group.cg_item.ci_namebuf,\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic struct config_group configfs_root_group = {\n\t.cg_item = {\n\t\t.ci_namebuf\t= \"root\",\n\t\t.ci_name\t= configfs_root_group.cg_item.ci_namebuf,\n\t},\n};\n\nint configfs_is_root(struct config_item *item)\n{\n\treturn item == &configfs_root_group.cg_item;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic void fill_item_path(struct config_item * item, char * buffer, int length)\n{\n\tstruct config_item * p;\n\n\t--length;\n\tfor (p = item; p && !configfs_is_root(p); p = p->ci_parent) {\n\t\tint cur = strlen(config_item_name(p));\n\n\t\t/* back up enough to print this bus id with '/' */\n\t\tlength -= cur;\n\t\tstrncpy(buffer + length,config_item_name(p),cur);\n\t\t*(buffer + --length) = '/';\n\t}\n}"
  },
  {
    "function_name": "item_path_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "46-55",
    "snippet": "static int item_path_length(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint length = 1;\n\tdo {\n\t\tlength += strlen(config_item_name(p)) + 1;\n\t\tp = p->ci_parent;\n\t} while (p && !configfs_is_root(p));\n\treturn length;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "configfs_is_root",
          "args": [
            "p"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_is_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/mount.c",
          "lines": "56-59",
          "snippet": "int configfs_is_root(struct config_item *item)\n{\n\treturn item == &configfs_root_group.cg_item;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct config_group configfs_root_group = {\n\t.cg_item = {\n\t\t.ci_namebuf\t= \"root\",\n\t\t.ci_name\t= configfs_root_group.cg_item.ci_namebuf,\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic struct config_group configfs_root_group = {\n\t.cg_item = {\n\t\t.ci_namebuf\t= \"root\",\n\t\t.ci_name\t= configfs_root_group.cg_item.ci_namebuf,\n\t},\n};\n\nint configfs_is_root(struct config_item *item)\n{\n\treturn item == &configfs_root_group.cg_item;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "config_item_name(p)"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "p"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int item_path_length(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint length = 1;\n\tdo {\n\t\tlength += strlen(config_item_name(p)) + 1;\n\t\tp = p->ci_parent;\n\t} while (p && !configfs_is_root(p));\n\treturn length;\n}"
  },
  {
    "function_name": "item_depth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/symlink.c",
    "lines": "38-44",
    "snippet": "static int item_depth(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint depth = 0;\n\tdo { depth++; } while ((p = p->ci_parent) && !configfs_is_root(p));\n\treturn depth;\n}",
    "includes": [
      "#include \"configfs_internal.h\"",
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "configfs_is_root",
          "args": [
            "p"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_is_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/mount.c",
          "lines": "56-59",
          "snippet": "int configfs_is_root(struct config_item *item)\n{\n\treturn item == &configfs_root_group.cg_item;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct config_group configfs_root_group = {\n\t.cg_item = {\n\t\t.ci_namebuf\t= \"root\",\n\t\t.ci_name\t= configfs_root_group.cg_item.ci_namebuf,\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic struct config_group configfs_root_group = {\n\t.cg_item = {\n\t\t.ci_namebuf\t= \"root\",\n\t\t.ci_name\t= configfs_root_group.cg_item.ci_namebuf,\n\t},\n};\n\nint configfs_is_root(struct config_item *item)\n{\n\treturn item == &configfs_root_group.cg_item;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nstatic int item_depth(struct config_item * item)\n{\n\tstruct config_item * p = item;\n\tint depth = 0;\n\tdo { depth++; } while ((p = p->ci_parent) && !configfs_is_root(p));\n\treturn depth;\n}"
  }
]