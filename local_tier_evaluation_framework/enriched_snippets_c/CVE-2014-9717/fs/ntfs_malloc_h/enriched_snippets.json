[
  {
    "function_name": "ntfs_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/malloc.h",
    "lines": "86-94",
    "snippet": "static inline void ntfs_free(void *addr)\n{\n\tif (!is_vmalloc_addr(addr)) {\n\t\tkfree(addr);\n\t\t/* free_page((unsigned long)addr); */\n\t\treturn;\n\t}\n\tvfree(addr);\n}",
    "includes": [
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/vmalloc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfree",
          "args": [
            "addr"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "addr"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_vmalloc_addr",
          "args": [
            "addr"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n\nstatic inline void ntfs_free(void *addr)\n{\n\tif (!is_vmalloc_addr(addr)) {\n\t\tkfree(addr);\n\t\t/* free_page((unsigned long)addr); */\n\t\treturn;\n\t}\n\tvfree(addr);\n}"
  },
  {
    "function_name": "ntfs_malloc_nofs_nofail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/malloc.h",
    "lines": "81-84",
    "snippet": "static inline void *ntfs_malloc_nofs_nofail(unsigned long size)\n{\n\treturn __ntfs_malloc(size, GFP_NOFS | __GFP_HIGHMEM | __GFP_NOFAIL);\n}",
    "includes": [
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/vmalloc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__ntfs_malloc",
          "args": [
            "size",
            "GFP_NOFS | __GFP_HIGHMEM | __GFP_NOFAIL"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "__ntfs_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/malloc.h",
          "lines": "42-53",
          "snippet": "static inline void *__ntfs_malloc(unsigned long size, gfp_t gfp_mask)\n{\n\tif (likely(size <= PAGE_SIZE)) {\n\t\tBUG_ON(!size);\n\t\t/* kmalloc() has per-CPU caches so is faster for now. */\n\t\treturn kmalloc(PAGE_SIZE, gfp_mask & ~__GFP_HIGHMEM);\n\t\t/* return (void *)__get_free_page(gfp_mask); */\n\t}\n\tif (likely((size >> PAGE_SHIFT) < totalram_pages))\n\t\treturn __vmalloc(size, gfp_mask, PAGE_KERNEL);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n\nstatic inline void *__ntfs_malloc(unsigned long size, gfp_t gfp_mask)\n{\n\tif (likely(size <= PAGE_SIZE)) {\n\t\tBUG_ON(!size);\n\t\t/* kmalloc() has per-CPU caches so is faster for now. */\n\t\treturn kmalloc(PAGE_SIZE, gfp_mask & ~__GFP_HIGHMEM);\n\t\t/* return (void *)__get_free_page(gfp_mask); */\n\t}\n\tif (likely((size >> PAGE_SHIFT) < totalram_pages))\n\t\treturn __vmalloc(size, gfp_mask, PAGE_KERNEL);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n\nstatic inline void *ntfs_malloc_nofs_nofail(unsigned long size)\n{\n\treturn __ntfs_malloc(size, GFP_NOFS | __GFP_HIGHMEM | __GFP_NOFAIL);\n}"
  },
  {
    "function_name": "ntfs_malloc_nofs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/malloc.h",
    "lines": "64-67",
    "snippet": "static inline void *ntfs_malloc_nofs(unsigned long size)\n{\n\treturn __ntfs_malloc(size, GFP_NOFS | __GFP_HIGHMEM);\n}",
    "includes": [
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/vmalloc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__ntfs_malloc",
          "args": [
            "size",
            "GFP_NOFS | __GFP_HIGHMEM"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "__ntfs_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/malloc.h",
          "lines": "42-53",
          "snippet": "static inline void *__ntfs_malloc(unsigned long size, gfp_t gfp_mask)\n{\n\tif (likely(size <= PAGE_SIZE)) {\n\t\tBUG_ON(!size);\n\t\t/* kmalloc() has per-CPU caches so is faster for now. */\n\t\treturn kmalloc(PAGE_SIZE, gfp_mask & ~__GFP_HIGHMEM);\n\t\t/* return (void *)__get_free_page(gfp_mask); */\n\t}\n\tif (likely((size >> PAGE_SHIFT) < totalram_pages))\n\t\treturn __vmalloc(size, gfp_mask, PAGE_KERNEL);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n\nstatic inline void *__ntfs_malloc(unsigned long size, gfp_t gfp_mask)\n{\n\tif (likely(size <= PAGE_SIZE)) {\n\t\tBUG_ON(!size);\n\t\t/* kmalloc() has per-CPU caches so is faster for now. */\n\t\treturn kmalloc(PAGE_SIZE, gfp_mask & ~__GFP_HIGHMEM);\n\t\t/* return (void *)__get_free_page(gfp_mask); */\n\t}\n\tif (likely((size >> PAGE_SHIFT) < totalram_pages))\n\t\treturn __vmalloc(size, gfp_mask, PAGE_KERNEL);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n\nstatic inline void *ntfs_malloc_nofs(unsigned long size)\n{\n\treturn __ntfs_malloc(size, GFP_NOFS | __GFP_HIGHMEM);\n}"
  },
  {
    "function_name": "__ntfs_malloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/malloc.h",
    "lines": "42-53",
    "snippet": "static inline void *__ntfs_malloc(unsigned long size, gfp_t gfp_mask)\n{\n\tif (likely(size <= PAGE_SIZE)) {\n\t\tBUG_ON(!size);\n\t\t/* kmalloc() has per-CPU caches so is faster for now. */\n\t\treturn kmalloc(PAGE_SIZE, gfp_mask & ~__GFP_HIGHMEM);\n\t\t/* return (void *)__get_free_page(gfp_mask); */\n\t}\n\tif (likely((size >> PAGE_SHIFT) < totalram_pages))\n\t\treturn __vmalloc(size, gfp_mask, PAGE_KERNEL);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/vmalloc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__vmalloc",
          "args": [
            "size",
            "gfp_mask",
            "PAGE_KERNEL"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "(size >> PAGE_SHIFT) < totalram_pages"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "gfp_mask & ~__GFP_HIGHMEM"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!size"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "size <= PAGE_SIZE"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n\nstatic inline void *__ntfs_malloc(unsigned long size, gfp_t gfp_mask)\n{\n\tif (likely(size <= PAGE_SIZE)) {\n\t\tBUG_ON(!size);\n\t\t/* kmalloc() has per-CPU caches so is faster for now. */\n\t\treturn kmalloc(PAGE_SIZE, gfp_mask & ~__GFP_HIGHMEM);\n\t\t/* return (void *)__get_free_page(gfp_mask); */\n\t}\n\tif (likely((size >> PAGE_SHIFT) < totalram_pages))\n\t\treturn __vmalloc(size, gfp_mask, PAGE_KERNEL);\n\treturn NULL;\n}"
  }
]