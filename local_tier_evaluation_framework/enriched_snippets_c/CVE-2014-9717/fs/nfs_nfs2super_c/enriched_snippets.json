[
  {
    "function_name": "exit_nfs_v2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2super.c",
    "lines": "23-26",
    "snippet": "static void __exit exit_nfs_v2(void)\n{\n\tunregister_nfs_version(&nfs_v2);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct nfs_subversion nfs_v2 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs_fs_type,\n\t.rpc_vers = &nfs_version2,\n\t.rpc_ops  = &nfs_v2_clientops,\n\t.sops     = &nfs_sops,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_nfs_version",
          "args": [
            "&nfs_v2"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "134-142",
          "snippet": "void unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(nfs_version_lock);",
            "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nvoid unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs_subversion nfs_v2 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs_fs_type,\n\t.rpc_vers = &nfs_version2,\n\t.rpc_ops  = &nfs_v2_clientops,\n\t.sops     = &nfs_sops,\n};\n\nstatic void __exit exit_nfs_v2(void)\n{\n\tunregister_nfs_version(&nfs_v2);\n}"
  },
  {
    "function_name": "init_nfs_v2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2super.c",
    "lines": "17-21",
    "snippet": "static int __init init_nfs_v2(void)\n{\n\tregister_nfs_version(&nfs_v2);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct nfs_subversion nfs_v2 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs_fs_type,\n\t.rpc_vers = &nfs_version2,\n\t.rpc_ops  = &nfs_v2_clientops,\n\t.sops     = &nfs_sops,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_nfs_version",
          "args": [
            "&nfs_v2"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "134-142",
          "snippet": "void unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(nfs_version_lock);",
            "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nvoid unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs_subversion nfs_v2 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs_fs_type,\n\t.rpc_vers = &nfs_version2,\n\t.rpc_ops  = &nfs_v2_clientops,\n\t.sops     = &nfs_sops,\n};\n\nstatic int __init init_nfs_v2(void)\n{\n\tregister_nfs_version(&nfs_v2);\n\treturn 0;\n}"
  }
]