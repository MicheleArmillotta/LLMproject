[
  {
    "function_name": "ntfs2utc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/time.h",
    "lines": "85-98",
    "snippet": "static inline struct timespec ntfs2utc(const sle64 time)\n{\n\tstruct timespec ts;\n\n\t/* Subtract the NTFS time offset. */\n\tu64 t = (u64)(sle64_to_cpu(time) - NTFS_TIME_OFFSET);\n\t/*\n\t * Convert the time to 1-second intervals and the remainder to\n\t * 1-nano-second intervals.\n\t */\n\tts.tv_nsec = do_div(t, 10000000) * 100;\n\tts.tv_sec = t;\n\treturn ts;\n}",
    "includes": [
      "#include \"endian.h\"",
      "#include <asm/div64.h>\t\t/* For do_div(). */",
      "#include <linux/time.h>\t\t/* For current_kernel_time(). */"
    ],
    "macros_used": [
      "#define NTFS_TIME_OFFSET ((s64)(369 * 365 + 89) * 24 * 3600 * 10000000)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "t",
            "10000000"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sle64_to_cpu(time) - NTFS_TIME_OFFSET"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sle64_to_cpu",
          "args": [
            "time"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"endian.h\"\n#include <asm/div64.h>\t\t/* For do_div(). */\n#include <linux/time.h>\t\t/* For current_kernel_time(). */\n\n#define NTFS_TIME_OFFSET ((s64)(369 * 365 + 89) * 24 * 3600 * 10000000)\n\nstatic inline struct timespec ntfs2utc(const sle64 time)\n{\n\tstruct timespec ts;\n\n\t/* Subtract the NTFS time offset. */\n\tu64 t = (u64)(sle64_to_cpu(time) - NTFS_TIME_OFFSET);\n\t/*\n\t * Convert the time to 1-second intervals and the remainder to\n\t * 1-nano-second intervals.\n\t */\n\tts.tv_nsec = do_div(t, 10000000) * 100;\n\tts.tv_sec = t;\n\treturn ts;\n}"
  },
  {
    "function_name": "get_current_ntfs_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/time.h",
    "lines": "64-67",
    "snippet": "static inline sle64 get_current_ntfs_time(void)\n{\n\treturn utc2ntfs(current_kernel_time());\n}",
    "includes": [
      "#include \"endian.h\"",
      "#include <asm/div64.h>\t\t/* For do_div(). */",
      "#include <linux/time.h>\t\t/* For current_kernel_time(). */"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "utc2ntfs",
          "args": [
            "current_kernel_time()"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "utc2ntfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/time.h",
          "lines": "48-56",
          "snippet": "static inline sle64 utc2ntfs(const struct timespec ts)\n{\n\t/*\n\t * Convert the seconds to 100ns intervals, add the nano-seconds\n\t * converted to 100ns intervals, and then add the NTFS time offset.\n\t */\n\treturn cpu_to_sle64((s64)ts.tv_sec * 10000000 + ts.tv_nsec / 100 +\n\t\t\tNTFS_TIME_OFFSET);\n}",
          "includes": [
            "#include \"endian.h\"",
            "#include <asm/div64.h>\t\t/* For do_div(). */",
            "#include <linux/time.h>\t\t/* For current_kernel_time(). */"
          ],
          "macros_used": [
            "#define NTFS_TIME_OFFSET ((s64)(369 * 365 + 89) * 24 * 3600 * 10000000)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include <asm/div64.h>\t\t/* For do_div(). */\n#include <linux/time.h>\t\t/* For current_kernel_time(). */\n\n#define NTFS_TIME_OFFSET ((s64)(369 * 365 + 89) * 24 * 3600 * 10000000)\n\nstatic inline sle64 utc2ntfs(const struct timespec ts)\n{\n\t/*\n\t * Convert the seconds to 100ns intervals, add the nano-seconds\n\t * converted to 100ns intervals, and then add the NTFS time offset.\n\t */\n\treturn cpu_to_sle64((s64)ts.tv_sec * 10000000 + ts.tv_nsec / 100 +\n\t\t\tNTFS_TIME_OFFSET);\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_kernel_time",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"endian.h\"\n#include <asm/div64.h>\t\t/* For do_div(). */\n#include <linux/time.h>\t\t/* For current_kernel_time(). */\n\nstatic inline sle64 get_current_ntfs_time(void)\n{\n\treturn utc2ntfs(current_kernel_time());\n}"
  },
  {
    "function_name": "utc2ntfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/time.h",
    "lines": "48-56",
    "snippet": "static inline sle64 utc2ntfs(const struct timespec ts)\n{\n\t/*\n\t * Convert the seconds to 100ns intervals, add the nano-seconds\n\t * converted to 100ns intervals, and then add the NTFS time offset.\n\t */\n\treturn cpu_to_sle64((s64)ts.tv_sec * 10000000 + ts.tv_nsec / 100 +\n\t\t\tNTFS_TIME_OFFSET);\n}",
    "includes": [
      "#include \"endian.h\"",
      "#include <asm/div64.h>\t\t/* For do_div(). */",
      "#include <linux/time.h>\t\t/* For current_kernel_time(). */"
    ],
    "macros_used": [
      "#define NTFS_TIME_OFFSET ((s64)(369 * 365 + 89) * 24 * 3600 * 10000000)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_sle64",
          "args": [
            "(s64)ts.tv_sec * 10000000 + ts.tv_nsec / 100 +\n\t\t\tNTFS_TIME_OFFSET"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_sle64p",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "88-91",
          "snippet": "static inline sle64 cpu_to_sle64p(s64 *x)\n{\n\treturn (__force sle64)cpu_to_le64(*x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline sle64 cpu_to_sle64p(s64 *x)\n{\n\treturn (__force sle64)cpu_to_le64(*x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"endian.h\"\n#include <asm/div64.h>\t\t/* For do_div(). */\n#include <linux/time.h>\t\t/* For current_kernel_time(). */\n\n#define NTFS_TIME_OFFSET ((s64)(369 * 365 + 89) * 24 * 3600 * 10000000)\n\nstatic inline sle64 utc2ntfs(const struct timespec ts)\n{\n\t/*\n\t * Convert the seconds to 100ns intervals, add the nano-seconds\n\t * converted to 100ns intervals, and then add the NTFS time offset.\n\t */\n\treturn cpu_to_sle64((s64)ts.tv_sec * 10000000 + ts.tv_nsec / 100 +\n\t\t\tNTFS_TIME_OFFSET);\n}"
  }
]