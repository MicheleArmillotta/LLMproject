[
  {
    "function_name": "ncp__vol2io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1296-1319",
    "snippet": "int\nncp__vol2io(unsigned char *iname, unsigned int *ilen,\n\t\tconst unsigned char *vname, unsigned int vlen, int cc)\n{\n\tint i;\n\n\tif (*ilen <= vlen)\n\t\treturn -ENAMETOOLONG;\n\n\tif (cc)\n\t\tfor (i = 0; i < vlen; i++) {\n\t\t\t*iname = tolower(*vname);\n\t\t\tiname++;\n\t\t\tvname++;\n\t\t}\n\telse {\n\t\tmemmove(iname, vname, vlen);\n\t\tiname += vlen;\n\t}\n\n\t*ilen = vlen;\n\t*iname = 0;\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "iname",
            "vname",
            "vlen"
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tolower",
          "args": [
            "*vname"
          ],
          "line": 1307
        },
        "resolved": true,
        "details": {
          "function_name": "fat_tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/dir.c",
          "lines": "38-41",
          "snippet": "static inline unsigned char fat_tolower(unsigned char c)\n{\n\treturn ((c >= 'A') && (c <= 'Z')) ? c+32 : c;\n}",
          "includes": [
            "#include \"fat.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fat.h\"\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/buffer_head.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstatic inline unsigned char fat_tolower(unsigned char c)\n{\n\treturn ((c >= 'A') && (c <= 'Z')) ? c+32 : c;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp__vol2io(unsigned char *iname, unsigned int *ilen,\n\t\tconst unsigned char *vname, unsigned int vlen, int cc)\n{\n\tint i;\n\n\tif (*ilen <= vlen)\n\t\treturn -ENAMETOOLONG;\n\n\tif (cc)\n\t\tfor (i = 0; i < vlen; i++) {\n\t\t\t*iname = tolower(*vname);\n\t\t\tiname++;\n\t\t\tvname++;\n\t\t}\n\telse {\n\t\tmemmove(iname, vname, vlen);\n\t\tiname += vlen;\n\t}\n\n\t*ilen = vlen;\n\t*iname = 0;\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp__io2vol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1271-1294",
    "snippet": "int\nncp__io2vol(unsigned char *vname, unsigned int *vlen,\n\t\tconst unsigned char *iname, unsigned int ilen, int cc)\n{\n\tint i;\n\n\tif (*vlen <= ilen)\n\t\treturn -ENAMETOOLONG;\n\n\tif (cc)\n\t\tfor (i = 0; i < ilen; i++) {\n\t\t\t*vname = toupper(*iname);\n\t\t\tvname++;\n\t\t\tiname++;\n\t\t}\n\telse {\n\t\tmemmove(vname, iname, ilen);\n\t\tvname += ilen;\n\t}\n\n\t*vlen = ilen;\n\t*vname = 0;\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "vname",
            "iname",
            "ilen"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "*iname"
          ],
          "line": 1282
        },
        "resolved": true,
        "details": {
          "function_name": "cifs_toupper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/winucase.c",
          "lines": "639-663",
          "snippet": "wchar_t\ncifs_toupper(wchar_t in)\n{\n\tunsigned char idx;\n\tconst wchar_t *tbl;\n\twchar_t out;\n\n\t/* grab upper byte */\n\tidx = (in & 0xff00) >> 8;\n\n\t/* find pointer to 2nd layer table */\n\ttbl = toplevel[idx];\n\tif (!tbl)\n\t\treturn in;\n\n\t/* grab lower byte */\n\tidx = in & 0xff;\n\n\t/* look up character in table */\n\tout = tbl[idx];\n\tif (out)\n\t\treturn out;\n\n\treturn in;\n}",
          "includes": [
            "#include <linux/nls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "wchar_t cifs_toupper(wchar_t in);",
            "static const wchar_t *const toplevel[256] = {\n\tt2_00, t2_01, t2_02, t2_03, t2_04, t2_05,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL, t2_1d, t2_1e, t2_1f,\n\tNULL, t2_21,  NULL,  NULL, t2_24,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL, t2_2c, t2_2d,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_a6, t2_a7,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_ff,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nls.h>\n\nwchar_t cifs_toupper(wchar_t in);\nstatic const wchar_t *const toplevel[256] = {\n\tt2_00, t2_01, t2_02, t2_03, t2_04, t2_05,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL, t2_1d, t2_1e, t2_1f,\n\tNULL, t2_21,  NULL,  NULL, t2_24,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL, t2_2c, t2_2d,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_a6, t2_a7,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_ff,\n};\n\nwchar_t\ncifs_toupper(wchar_t in)\n{\n\tunsigned char idx;\n\tconst wchar_t *tbl;\n\twchar_t out;\n\n\t/* grab upper byte */\n\tidx = (in & 0xff00) >> 8;\n\n\t/* find pointer to 2nd layer table */\n\ttbl = toplevel[idx];\n\tif (!tbl)\n\t\treturn in;\n\n\t/* grab lower byte */\n\tidx = in & 0xff;\n\n\t/* look up character in table */\n\tout = tbl[idx];\n\tif (out)\n\t\treturn out;\n\n\treturn in;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp__io2vol(unsigned char *vname, unsigned int *vlen,\n\t\tconst unsigned char *iname, unsigned int ilen, int cc)\n{\n\tint i;\n\n\tif (*vlen <= ilen)\n\t\treturn -ENAMETOOLONG;\n\n\tif (cc)\n\t\tfor (i = 0; i < ilen; i++) {\n\t\t\t*vname = toupper(*iname);\n\t\t\tvname++;\n\t\t\tiname++;\n\t\t}\n\telse {\n\t\tmemmove(vname, iname, ilen);\n\t\tvname += ilen;\n\t}\n\n\t*vlen = ilen;\n\t*vname = 0;\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp__vol2io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1183-1267",
    "snippet": "int\nncp__vol2io(struct ncp_server *server, unsigned char *iname, unsigned int *ilen,\n\t\tconst unsigned char *vname, unsigned int vlen, int cc)\n{\n\tstruct nls_table *in = server->nls_vol;\n\tstruct nls_table *out = server->nls_io;\n\tconst unsigned char *vname_end;\n\tunsigned char *iname_start;\n\tunsigned char *iname_end;\n\tunsigned char *vname_cc;\n\tint err;\n\n\tvname_cc = NULL;\n\n\tif (cc) {\n\t\tint i;\n\n\t\t/* this is wrong! */\n\t\tvname_cc = kmalloc(vlen, GFP_KERNEL);\n\t\tif (!vname_cc)\n\t\t\treturn -ENOMEM;\n\t\tfor (i = 0; i < vlen; i++)\n\t\t\tvname_cc[i] = ncp_tolower(in, vname[i]);\n\t\tvname = vname_cc;\n\t}\n\n\tiname_start = iname;\n\tiname_end = iname + *ilen - 1;\n\tvname_end = vname + vlen;\n\n\twhile (vname < vname_end) {\n\t\twchar_t ec;\n\t\tint chl;\n\n\t\tif ( (chl = in->char2uni(vname, vname_end - vname, &ec)) < 0) {\n\t\t\terr = chl;\n\t\t\tgoto quit;\n\t\t}\n\t\tvname += chl;\n\n\t\t/* unitolower should be here! */\n\n\t\tif (NCP_IS_FLAG(server, NCP_FLAG_UTF8)) {\n\t\t\tint k;\n\n\t\t\tk = utf32_to_utf8(ec, iname, iname_end - iname);\n\t\t\tif (k < 0) {\n\t\t\t\terr = -ENAMETOOLONG;\n\t\t\t\tgoto quit;\n\t\t\t}\n\t\t\tiname += k;\n\t\t} else {\n\t\t\tif ( (chl = out->uni2char(ec, iname, iname_end - iname)) >= 0) {\n\t\t\t\tiname += chl;\n\t\t\t} else {\n\t\t\t\tint k;\n\n\t\t\t\tif (iname_end - iname < 5) {\n\t\t\t\t\terr = -ENAMETOOLONG;\n\t\t\t\t\tgoto quit;\n\t\t\t\t}\n\t\t\t\t*iname = NCP_ESC;\n\t\t\t\tfor (k = 4; k > 0; k--) {\n\t\t\t\t\tunsigned char v;\n\t\t\t\t\t\n\t\t\t\t\tv = (ec & 0xF) + '0';\n\t\t\t\t\tif (v > '9') {\n\t\t\t\t\t\tv += 'A' - '9' - 1;\n\t\t\t\t\t}\n\t\t\t\t\tiname[k] = v;\n\t\t\t\t\tec >>= 4;\n\t\t\t\t}\n\t\t\t\tiname += 5;\n\t\t\t}\n\t\t}\n\t}\n\n\t*iname = 0;\n\t*ilen = iname - iname_start;\n\terr = 0;\nquit:;\n\tif (cc)\n\t\tkfree(vname_cc);\n\treturn err;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "vname_cc"
          ],
          "line": 1265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out->uni2char",
          "args": [
            "ec",
            "iname",
            "iname_end - iname"
          ],
          "line": 1235
        },
        "resolved": true,
        "details": {
          "function_name": "uni2char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_cp932.c",
          "lines": "7837-7875",
          "snippet": "static int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};",
            "static const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};\nstatic const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };\n\nstatic int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "utf32_to_utf8",
          "args": [
            "ec",
            "iname",
            "iname_end - iname"
          ],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "utf32_to_utf8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_base.c",
          "lines": "86-114",
          "snippet": "int utf32_to_utf8(unicode_t u, u8 *s, int maxout)\n{\n\tunsigned long l;\n\tint c, nc;\n\tconst struct utf8_table *t;\n\n\tif (!s)\n\t\treturn 0;\n\n\tl = u;\n\tif (l > UNICODE_MAX || (l & SURROGATE_MASK) == SURROGATE_PAIR)\n\t\treturn -1;\n\n\tnc = 0;\n\tfor (t = utf8_table; t->cmask && maxout; t++, maxout--) {\n\t\tnc++;\n\t\tif (l <= t->lmask) {\n\t\t\tc = t->shift;\n\t\t\t*s = (u8) (t->cval | (l >> c));\n\t\t\twhile (c > 0) {\n\t\t\t\tc -= 6;\n\t\t\t\ts++;\n\t\t\t\t*s = (u8) (0x80 | ((l >> c) & 0x3F));\n\t\t\t}\n\t\t\treturn nc;\n\t\t}\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <asm/byteorder.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kmod.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define SURROGATE_PAIR\t0x0000d800",
            "#define SURROGATE_MASK\t0xfffff800",
            "#define UNICODE_MAX\t0x0010ffff"
          ],
          "globals_used": [
            "static const struct utf8_table utf8_table[] =\n{\n    {0x80,  0x00,   0*6,    0x7F,           0,         /* 1 byte sequence */},\n    {0xE0,  0xC0,   1*6,    0x7FF,          0x80,      /* 2 byte sequence */},\n    {0xF0,  0xE0,   2*6,    0xFFFF,         0x800,     /* 3 byte sequence */},\n    {0xF8,  0xF0,   3*6,    0x1FFFFF,       0x10000,   /* 4 byte sequence */},\n    {0xFC,  0xF8,   4*6,    0x3FFFFFF,      0x200000,  /* 5 byte sequence */},\n    {0xFE,  0xFC,   5*6,    0x7FFFFFFF,     0x4000000, /* 6 byte sequence */},\n    {0,\t\t\t\t\t\t       /* end of table    */}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n#include <linux/spinlock.h>\n#include <linux/kmod.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\n#define SURROGATE_PAIR\t0x0000d800\n#define SURROGATE_MASK\t0xfffff800\n#define UNICODE_MAX\t0x0010ffff\n\nstatic const struct utf8_table utf8_table[] =\n{\n    {0x80,  0x00,   0*6,    0x7F,           0,         /* 1 byte sequence */},\n    {0xE0,  0xC0,   1*6,    0x7FF,          0x80,      /* 2 byte sequence */},\n    {0xF0,  0xE0,   2*6,    0xFFFF,         0x800,     /* 3 byte sequence */},\n    {0xF8,  0xF0,   3*6,    0x1FFFFF,       0x10000,   /* 4 byte sequence */},\n    {0xFC,  0xF8,   4*6,    0x3FFFFFF,      0x200000,  /* 5 byte sequence */},\n    {0xFE,  0xFC,   5*6,    0x7FFFFFFF,     0x4000000, /* 6 byte sequence */},\n    {0,\t\t\t\t\t\t       /* end of table    */}\n};\n\nint utf32_to_utf8(unicode_t u, u8 *s, int maxout)\n{\n\tunsigned long l;\n\tint c, nc;\n\tconst struct utf8_table *t;\n\n\tif (!s)\n\t\treturn 0;\n\n\tl = u;\n\tif (l > UNICODE_MAX || (l & SURROGATE_MASK) == SURROGATE_PAIR)\n\t\treturn -1;\n\n\tnc = 0;\n\tfor (t = utf8_table; t->cmask && maxout; t++, maxout--) {\n\t\tnc++;\n\t\tif (l <= t->lmask) {\n\t\t\tc = t->shift;\n\t\t\t*s = (u8) (t->cval | (l >> c));\n\t\t\twhile (c > 0) {\n\t\t\t\tc -= 6;\n\t\t\t\ts++;\n\t\t\t\t*s = (u8) (0x80 | ((l >> c) & 0x3F));\n\t\t\t}\n\t\t\treturn nc;\n\t\t}\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NCP_IS_FLAG",
          "args": [
            "server",
            "NCP_FLAG_UTF8"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in->char2uni",
          "args": [
            "vname",
            "vname_end - vname",
            "&ec"
          ],
          "line": 1217
        },
        "resolved": true,
        "details": {
          "function_name": "char2uni",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_cp932.c",
          "lines": "7877-7908",
          "snippet": "static int char2uni(const unsigned char *rawstring, int boundlen,\n\t\t    wchar_t *uni)\n{\n\tunsigned char ch, cl;\n\tconst wchar_t *charset2uni;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (rawstring[0] <= 0x7F) {\n\t\t*uni = rawstring[0];\n\t\treturn 1;\n\t}\n\tif (0xA1 <= rawstring[0] && rawstring[0] <= 0xDF) {\n\t\t*uni = 0xFF00 | (rawstring[0] - 0x40);\n\t\treturn 1;\n\t}\n\n\tif (boundlen < 2)\n\t\treturn -ENAMETOOLONG;\n\tch = rawstring[0];\n\tcl = rawstring[1];\n\tcharset2uni = page_charset2uni[ch];\n\tif (charset2uni && cl) {\n\t\t*uni = charset2uni[cl];\n\t\tif (*uni == 0x0000)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t}\n\telse\n\t\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const wchar_t *page_charset2uni[256] = {\n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   c2u_81, c2u_82, c2u_83, c2u_84, NULL,   NULL,   c2u_87, \n\tc2u_88, c2u_89, c2u_8A, c2u_8B, c2u_8C, c2u_8D, c2u_8E, c2u_8F, \n\tc2u_90, c2u_91, c2u_92, c2u_93, c2u_94, c2u_95, c2u_96, c2u_97, \n\tc2u_98, c2u_99, c2u_9A, c2u_9B, c2u_9C, c2u_9D, c2u_9E, c2u_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tc2u_E0, c2u_E1, c2u_E2, c2u_E3, c2u_E4, c2u_E5, c2u_E6, c2u_E7, \n\tc2u_E8, c2u_E9, c2u_EA, NULL,   NULL,   c2u_ED, c2u_EE, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   c2u_FA, c2u_FB, c2u_FC, NULL,   NULL,   NULL,   \n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const wchar_t *page_charset2uni[256] = {\n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   c2u_81, c2u_82, c2u_83, c2u_84, NULL,   NULL,   c2u_87, \n\tc2u_88, c2u_89, c2u_8A, c2u_8B, c2u_8C, c2u_8D, c2u_8E, c2u_8F, \n\tc2u_90, c2u_91, c2u_92, c2u_93, c2u_94, c2u_95, c2u_96, c2u_97, \n\tc2u_98, c2u_99, c2u_9A, c2u_9B, c2u_9C, c2u_9D, c2u_9E, c2u_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tc2u_E0, c2u_E1, c2u_E2, c2u_E3, c2u_E4, c2u_E5, c2u_E6, c2u_E7, \n\tc2u_E8, c2u_E9, c2u_EA, NULL,   NULL,   c2u_ED, c2u_EE, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   c2u_FA, c2u_FB, c2u_FC, NULL,   NULL,   NULL,   \n};\n\nstatic int char2uni(const unsigned char *rawstring, int boundlen,\n\t\t    wchar_t *uni)\n{\n\tunsigned char ch, cl;\n\tconst wchar_t *charset2uni;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (rawstring[0] <= 0x7F) {\n\t\t*uni = rawstring[0];\n\t\treturn 1;\n\t}\n\tif (0xA1 <= rawstring[0] && rawstring[0] <= 0xDF) {\n\t\t*uni = 0xFF00 | (rawstring[0] - 0x40);\n\t\treturn 1;\n\t}\n\n\tif (boundlen < 2)\n\t\treturn -ENAMETOOLONG;\n\tch = rawstring[0];\n\tcl = rawstring[1];\n\tcharset2uni = page_charset2uni[ch];\n\tif (charset2uni && cl) {\n\t\t*uni = charset2uni[cl];\n\t\tif (*uni == 0x0000)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t}\n\telse\n\t\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_tolower",
          "args": [
            "in",
            "vname[i]"
          ],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "vlen",
            "GFP_KERNEL"
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp__vol2io(struct ncp_server *server, unsigned char *iname, unsigned int *ilen,\n\t\tconst unsigned char *vname, unsigned int vlen, int cc)\n{\n\tstruct nls_table *in = server->nls_vol;\n\tstruct nls_table *out = server->nls_io;\n\tconst unsigned char *vname_end;\n\tunsigned char *iname_start;\n\tunsigned char *iname_end;\n\tunsigned char *vname_cc;\n\tint err;\n\n\tvname_cc = NULL;\n\n\tif (cc) {\n\t\tint i;\n\n\t\t/* this is wrong! */\n\t\tvname_cc = kmalloc(vlen, GFP_KERNEL);\n\t\tif (!vname_cc)\n\t\t\treturn -ENOMEM;\n\t\tfor (i = 0; i < vlen; i++)\n\t\t\tvname_cc[i] = ncp_tolower(in, vname[i]);\n\t\tvname = vname_cc;\n\t}\n\n\tiname_start = iname;\n\tiname_end = iname + *ilen - 1;\n\tvname_end = vname + vlen;\n\n\twhile (vname < vname_end) {\n\t\twchar_t ec;\n\t\tint chl;\n\n\t\tif ( (chl = in->char2uni(vname, vname_end - vname, &ec)) < 0) {\n\t\t\terr = chl;\n\t\t\tgoto quit;\n\t\t}\n\t\tvname += chl;\n\n\t\t/* unitolower should be here! */\n\n\t\tif (NCP_IS_FLAG(server, NCP_FLAG_UTF8)) {\n\t\t\tint k;\n\n\t\t\tk = utf32_to_utf8(ec, iname, iname_end - iname);\n\t\t\tif (k < 0) {\n\t\t\t\terr = -ENAMETOOLONG;\n\t\t\t\tgoto quit;\n\t\t\t}\n\t\t\tiname += k;\n\t\t} else {\n\t\t\tif ( (chl = out->uni2char(ec, iname, iname_end - iname)) >= 0) {\n\t\t\t\tiname += chl;\n\t\t\t} else {\n\t\t\t\tint k;\n\n\t\t\t\tif (iname_end - iname < 5) {\n\t\t\t\t\terr = -ENAMETOOLONG;\n\t\t\t\t\tgoto quit;\n\t\t\t\t}\n\t\t\t\t*iname = NCP_ESC;\n\t\t\t\tfor (k = 4; k > 0; k--) {\n\t\t\t\t\tunsigned char v;\n\t\t\t\t\t\n\t\t\t\t\tv = (ec & 0xF) + '0';\n\t\t\t\t\tif (v > '9') {\n\t\t\t\t\t\tv += 'A' - '9' - 1;\n\t\t\t\t\t}\n\t\t\t\t\tiname[k] = v;\n\t\t\t\t\tec >>= 4;\n\t\t\t\t}\n\t\t\t\tiname += 5;\n\t\t\t}\n\t\t}\n\t}\n\n\t*iname = 0;\n\t*ilen = iname - iname_start;\n\terr = 0;\nquit:;\n\tif (cc)\n\t\tkfree(vname_cc);\n\treturn err;\n}"
  },
  {
    "function_name": "ncp__io2vol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1105-1181",
    "snippet": "int\nncp__io2vol(struct ncp_server *server, unsigned char *vname, unsigned int *vlen,\n\t\tconst unsigned char *iname, unsigned int ilen, int cc)\n{\n\tstruct nls_table *in = server->nls_io;\n\tstruct nls_table *out = server->nls_vol;\n\tunsigned char *vname_start;\n\tunsigned char *vname_end;\n\tconst unsigned char *iname_end;\n\n\tiname_end = iname + ilen;\n\tvname_start = vname;\n\tvname_end = vname + *vlen - 1;\n\n\twhile (iname < iname_end) {\n\t\tint chl;\n\t\twchar_t ec;\n\n\t\tif (NCP_IS_FLAG(server, NCP_FLAG_UTF8)) {\n\t\t\tint k;\n\t\t\tunicode_t u;\n\n\t\t\tk = utf8_to_utf32(iname, iname_end - iname, &u);\n\t\t\tif (k < 0 || u > MAX_WCHAR_T)\n\t\t\t\treturn -EINVAL;\n\t\t\tiname += k;\n\t\t\tec = u;\n\t\t} else {\n\t\t\tif (*iname == NCP_ESC) {\n\t\t\t\tint k;\n\n\t\t\t\tif (iname_end - iname < 5)\n\t\t\t\t\tgoto nospec;\n\n\t\t\t\tec = 0;\n\t\t\t\tfor (k = 1; k < 5; k++) {\n\t\t\t\t\tunsigned char nc;\n\n\t\t\t\t\tnc = iname[k] - '0';\n\t\t\t\t\tif (nc >= 10) {\n\t\t\t\t\t\tnc -= 'A' - '0' - 10;\n\t\t\t\t\t\tif ((nc < 10) || (nc > 15)) {\n\t\t\t\t\t\t\tgoto nospec;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tec = (ec << 4) | nc;\n\t\t\t\t}\n\t\t\t\tiname += 5;\n\t\t\t} else {\nnospec:;\t\t\t\n\t\t\t\tif ( (chl = in->char2uni(iname, iname_end - iname, &ec)) < 0)\n\t\t\t\t\treturn chl;\n\t\t\t\tiname += chl;\n\t\t\t}\n\t\t}\n\n\t\t/* unitoupper should be here! */\n\n\t\tchl = out->uni2char(ec, vname, vname_end - vname);\n\t\tif (chl < 0)\n\t\t\treturn chl;\n\n\t\t/* this is wrong... */\n\t\tif (cc) {\n\t\t\tint chi;\n\n\t\t\tfor (chi = 0; chi < chl; chi++){\n\t\t\t\tvname[chi] = ncp_toupper(out, vname[chi]);\n\t\t\t}\n\t\t}\n\t\tvname += chl;\n\t}\n\n\t*vname = 0;\n\t*vlen = vname - vname_start;\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_toupper",
          "args": [
            "out",
            "vname[chi]"
          ],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out->uni2char",
          "args": [
            "ec",
            "vname",
            "vname_end - vname"
          ],
          "line": 1163
        },
        "resolved": true,
        "details": {
          "function_name": "uni2char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_cp932.c",
          "lines": "7837-7875",
          "snippet": "static int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};",
            "static const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};\nstatic const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };\n\nstatic int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "in->char2uni",
          "args": [
            "iname",
            "iname_end - iname",
            "&ec"
          ],
          "line": 1155
        },
        "resolved": true,
        "details": {
          "function_name": "char2uni",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_cp932.c",
          "lines": "7877-7908",
          "snippet": "static int char2uni(const unsigned char *rawstring, int boundlen,\n\t\t    wchar_t *uni)\n{\n\tunsigned char ch, cl;\n\tconst wchar_t *charset2uni;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (rawstring[0] <= 0x7F) {\n\t\t*uni = rawstring[0];\n\t\treturn 1;\n\t}\n\tif (0xA1 <= rawstring[0] && rawstring[0] <= 0xDF) {\n\t\t*uni = 0xFF00 | (rawstring[0] - 0x40);\n\t\treturn 1;\n\t}\n\n\tif (boundlen < 2)\n\t\treturn -ENAMETOOLONG;\n\tch = rawstring[0];\n\tcl = rawstring[1];\n\tcharset2uni = page_charset2uni[ch];\n\tif (charset2uni && cl) {\n\t\t*uni = charset2uni[cl];\n\t\tif (*uni == 0x0000)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t}\n\telse\n\t\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const wchar_t *page_charset2uni[256] = {\n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   c2u_81, c2u_82, c2u_83, c2u_84, NULL,   NULL,   c2u_87, \n\tc2u_88, c2u_89, c2u_8A, c2u_8B, c2u_8C, c2u_8D, c2u_8E, c2u_8F, \n\tc2u_90, c2u_91, c2u_92, c2u_93, c2u_94, c2u_95, c2u_96, c2u_97, \n\tc2u_98, c2u_99, c2u_9A, c2u_9B, c2u_9C, c2u_9D, c2u_9E, c2u_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tc2u_E0, c2u_E1, c2u_E2, c2u_E3, c2u_E4, c2u_E5, c2u_E6, c2u_E7, \n\tc2u_E8, c2u_E9, c2u_EA, NULL,   NULL,   c2u_ED, c2u_EE, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   c2u_FA, c2u_FB, c2u_FC, NULL,   NULL,   NULL,   \n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const wchar_t *page_charset2uni[256] = {\n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   c2u_81, c2u_82, c2u_83, c2u_84, NULL,   NULL,   c2u_87, \n\tc2u_88, c2u_89, c2u_8A, c2u_8B, c2u_8C, c2u_8D, c2u_8E, c2u_8F, \n\tc2u_90, c2u_91, c2u_92, c2u_93, c2u_94, c2u_95, c2u_96, c2u_97, \n\tc2u_98, c2u_99, c2u_9A, c2u_9B, c2u_9C, c2u_9D, c2u_9E, c2u_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tc2u_E0, c2u_E1, c2u_E2, c2u_E3, c2u_E4, c2u_E5, c2u_E6, c2u_E7, \n\tc2u_E8, c2u_E9, c2u_EA, NULL,   NULL,   c2u_ED, c2u_EE, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   c2u_FA, c2u_FB, c2u_FC, NULL,   NULL,   NULL,   \n};\n\nstatic int char2uni(const unsigned char *rawstring, int boundlen,\n\t\t    wchar_t *uni)\n{\n\tunsigned char ch, cl;\n\tconst wchar_t *charset2uni;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (rawstring[0] <= 0x7F) {\n\t\t*uni = rawstring[0];\n\t\treturn 1;\n\t}\n\tif (0xA1 <= rawstring[0] && rawstring[0] <= 0xDF) {\n\t\t*uni = 0xFF00 | (rawstring[0] - 0x40);\n\t\treturn 1;\n\t}\n\n\tif (boundlen < 2)\n\t\treturn -ENAMETOOLONG;\n\tch = rawstring[0];\n\tcl = rawstring[1];\n\tcharset2uni = page_charset2uni[ch];\n\tif (charset2uni && cl) {\n\t\t*uni = charset2uni[cl];\n\t\tif (*uni == 0x0000)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t}\n\telse\n\t\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "utf8_to_utf32",
          "args": [
            "iname",
            "iname_end - iname",
            "&u"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "utf8_to_utf32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_base.c",
          "lines": "55-83",
          "snippet": "int utf8_to_utf32(const u8 *s, int inlen, unicode_t *pu)\n{\n\tunsigned long l;\n\tint c0, c, nc;\n\tconst struct utf8_table *t;\n  \n\tnc = 0;\n\tc0 = *s;\n\tl = c0;\n\tfor (t = utf8_table; t->cmask; t++) {\n\t\tnc++;\n\t\tif ((c0 & t->cmask) == t->cval) {\n\t\t\tl &= t->lmask;\n\t\t\tif (l < t->lval || l > UNICODE_MAX ||\n\t\t\t\t\t(l & SURROGATE_MASK) == SURROGATE_PAIR)\n\t\t\t\treturn -1;\n\t\t\t*pu = (unicode_t) l;\n\t\t\treturn nc;\n\t\t}\n\t\tif (inlen <= nc)\n\t\t\treturn -1;\n\t\ts++;\n\t\tc = (*s ^ 0x80) & 0xFF;\n\t\tif (c & 0xC0)\n\t\t\treturn -1;\n\t\tl = (l << 6) | c;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <asm/byteorder.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kmod.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define SURROGATE_PAIR\t0x0000d800",
            "#define SURROGATE_MASK\t0xfffff800",
            "#define UNICODE_MAX\t0x0010ffff"
          ],
          "globals_used": [
            "static const struct utf8_table utf8_table[] =\n{\n    {0x80,  0x00,   0*6,    0x7F,           0,         /* 1 byte sequence */},\n    {0xE0,  0xC0,   1*6,    0x7FF,          0x80,      /* 2 byte sequence */},\n    {0xF0,  0xE0,   2*6,    0xFFFF,         0x800,     /* 3 byte sequence */},\n    {0xF8,  0xF0,   3*6,    0x1FFFFF,       0x10000,   /* 4 byte sequence */},\n    {0xFC,  0xF8,   4*6,    0x3FFFFFF,      0x200000,  /* 5 byte sequence */},\n    {0xFE,  0xFC,   5*6,    0x7FFFFFFF,     0x4000000, /* 6 byte sequence */},\n    {0,\t\t\t\t\t\t       /* end of table    */}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n#include <linux/spinlock.h>\n#include <linux/kmod.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\n#define SURROGATE_PAIR\t0x0000d800\n#define SURROGATE_MASK\t0xfffff800\n#define UNICODE_MAX\t0x0010ffff\n\nstatic const struct utf8_table utf8_table[] =\n{\n    {0x80,  0x00,   0*6,    0x7F,           0,         /* 1 byte sequence */},\n    {0xE0,  0xC0,   1*6,    0x7FF,          0x80,      /* 2 byte sequence */},\n    {0xF0,  0xE0,   2*6,    0xFFFF,         0x800,     /* 3 byte sequence */},\n    {0xF8,  0xF0,   3*6,    0x1FFFFF,       0x10000,   /* 4 byte sequence */},\n    {0xFC,  0xF8,   4*6,    0x3FFFFFF,      0x200000,  /* 5 byte sequence */},\n    {0xFE,  0xFC,   5*6,    0x7FFFFFFF,     0x4000000, /* 6 byte sequence */},\n    {0,\t\t\t\t\t\t       /* end of table    */}\n};\n\nint utf8_to_utf32(const u8 *s, int inlen, unicode_t *pu)\n{\n\tunsigned long l;\n\tint c0, c, nc;\n\tconst struct utf8_table *t;\n  \n\tnc = 0;\n\tc0 = *s;\n\tl = c0;\n\tfor (t = utf8_table; t->cmask; t++) {\n\t\tnc++;\n\t\tif ((c0 & t->cmask) == t->cval) {\n\t\t\tl &= t->lmask;\n\t\t\tif (l < t->lval || l > UNICODE_MAX ||\n\t\t\t\t\t(l & SURROGATE_MASK) == SURROGATE_PAIR)\n\t\t\t\treturn -1;\n\t\t\t*pu = (unicode_t) l;\n\t\t\treturn nc;\n\t\t}\n\t\tif (inlen <= nc)\n\t\t\treturn -1;\n\t\ts++;\n\t\tc = (*s ^ 0x80) & 0xFF;\n\t\tif (c & 0xC0)\n\t\t\treturn -1;\n\t\tl = (l << 6) | c;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NCP_IS_FLAG",
          "args": [
            "server",
            "NCP_FLAG_UTF8"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp__io2vol(struct ncp_server *server, unsigned char *vname, unsigned int *vlen,\n\t\tconst unsigned char *iname, unsigned int ilen, int cc)\n{\n\tstruct nls_table *in = server->nls_io;\n\tstruct nls_table *out = server->nls_vol;\n\tunsigned char *vname_start;\n\tunsigned char *vname_end;\n\tconst unsigned char *iname_end;\n\n\tiname_end = iname + ilen;\n\tvname_start = vname;\n\tvname_end = vname + *vlen - 1;\n\n\twhile (iname < iname_end) {\n\t\tint chl;\n\t\twchar_t ec;\n\n\t\tif (NCP_IS_FLAG(server, NCP_FLAG_UTF8)) {\n\t\t\tint k;\n\t\t\tunicode_t u;\n\n\t\t\tk = utf8_to_utf32(iname, iname_end - iname, &u);\n\t\t\tif (k < 0 || u > MAX_WCHAR_T)\n\t\t\t\treturn -EINVAL;\n\t\t\tiname += k;\n\t\t\tec = u;\n\t\t} else {\n\t\t\tif (*iname == NCP_ESC) {\n\t\t\t\tint k;\n\n\t\t\t\tif (iname_end - iname < 5)\n\t\t\t\t\tgoto nospec;\n\n\t\t\t\tec = 0;\n\t\t\t\tfor (k = 1; k < 5; k++) {\n\t\t\t\t\tunsigned char nc;\n\n\t\t\t\t\tnc = iname[k] - '0';\n\t\t\t\t\tif (nc >= 10) {\n\t\t\t\t\t\tnc -= 'A' - '0' - 10;\n\t\t\t\t\t\tif ((nc < 10) || (nc > 15)) {\n\t\t\t\t\t\t\tgoto nospec;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tec = (ec << 4) | nc;\n\t\t\t\t}\n\t\t\t\tiname += 5;\n\t\t\t} else {\nnospec:;\t\t\t\n\t\t\t\tif ( (chl = in->char2uni(iname, iname_end - iname, &ec)) < 0)\n\t\t\t\t\treturn chl;\n\t\t\t\tiname += chl;\n\t\t\t}\n\t\t}\n\n\t\t/* unitoupper should be here! */\n\n\t\tchl = out->uni2char(ec, vname, vname_end - vname);\n\t\tif (chl < 0)\n\t\t\treturn chl;\n\n\t\t/* this is wrong... */\n\t\tif (cc) {\n\t\t\tint chi;\n\n\t\t\tfor (chi = 0; chi < chl; chi++){\n\t\t\t\tvname[chi] = ncp_toupper(out, vname[chi]);\n\t\t\t}\n\t\t}\n\t\tvname += chl;\n\t}\n\n\t*vname = 0;\n\t*vlen = vname - vname_start;\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_ClearPhysicalRecord",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1078-1097",
    "snippet": "int\nncp_ClearPhysicalRecord(struct ncp_server *server, const char *file_id,\n\t  __u32 offset, __u32 length)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\t/* who knows... lanalyzer says that */\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be32(server, length);\n\n\tif ((result = ncp_request(server, 0x1E)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\tncp_unlock_server(server);\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "0x1E"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be32",
          "args": [
            "server",
            "length"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "54-59",
          "snippet": "static void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "file_id",
            "6"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_ClearPhysicalRecord(struct ncp_server *server, const char *file_id,\n\t  __u32 offset, __u32 length)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\t/* who knows... lanalyzer says that */\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be32(server, length);\n\n\tif ((result = ncp_request(server, 0x1E)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\tncp_unlock_server(server);\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_LogPhysicalRecord",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1056-1076",
    "snippet": "int\nncp_LogPhysicalRecord(struct ncp_server *server, const char *file_id,\n\t  __u8 locktype, __u32 offset, __u32 length, __u16 timeout)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, locktype);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be32(server, length);\n\tncp_add_be16(server, timeout);\n\n\tif ((result = ncp_request(server, 0x1A)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\tncp_unlock_server(server);\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "0x1A"
          ],
          "line": 1069
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be16",
          "args": [
            "server",
            "timeout"
          ],
          "line": 1067
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "39-44",
          "snippet": "static void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be32",
          "args": [
            "server",
            "length"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "54-59",
          "snippet": "static void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "file_id",
            "6"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "locktype"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 1062
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_LogPhysicalRecord(struct ncp_server *server, const char *file_id,\n\t  __u8 locktype, __u32 offset, __u32 length, __u16 timeout)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, locktype);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be32(server, length);\n\tncp_add_be16(server, timeout);\n\n\tif ((result = ncp_request(server, 0x1A)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\tncp_unlock_server(server);\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_write_kernel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1035-1053",
    "snippet": "int\nncp_write_kernel(struct ncp_server *server, const char *file_id,\n\t\t __u32 offset, __u16 to_write,\n\t\t const char *source, int *bytes_written)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be16(server, to_write);\n\tncp_add_mem(server, source, to_write);\n\t\n\tif ((result = ncp_request(server, 73)) == 0)\n\t\t*bytes_written = to_write;\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 1051
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "73"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "source",
            "to_write"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be16",
          "args": [
            "server",
            "to_write"
          ],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "39-44",
          "snippet": "static void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be32",
          "args": [
            "server",
            "offset"
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "54-59",
          "snippet": "static void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 1043
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_write_kernel(struct ncp_server *server, const char *file_id,\n\t\t __u32 offset, __u16 to_write,\n\t\t const char *source, int *bytes_written)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be16(server, to_write);\n\tncp_add_mem(server, source, to_write);\n\t\n\tif ((result = ncp_request(server, 73)) == 0)\n\t\t*bytes_written = to_write;\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_read_bounce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "1002-1033",
    "snippet": "int\nncp_read_bounce(struct ncp_server *server, const char *file_id,\n\t __u32 offset, __u16 to_read, char __user *target, int *bytes_read,\n\t void* bounce, __u32 bufsize)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be16(server, to_read);\n\tresult = ncp_request2(server, 72, bounce, bufsize);\n\tncp_unlock_server(server);\n\tif (!result) {\n\t\tint len = get_unaligned_be16((char *)bounce +\n\t\t\t  sizeof(struct ncp_reply_header));\n\t\tresult = -EIO;\n\t\tif (len <= to_read) {\n\t\t\tchar* source;\n\n\t\t\tsource = (char*)bounce + \n\t\t\t         sizeof(struct ncp_reply_header) + 2 + \n\t\t\t         (offset & 1);\n\t\t\t*bytes_read = len;\n\t\t\tresult = 0;\n\t\t\tif (copy_to_user(target, source, len))\n\t\t\t\tresult = -EFAULT;\n\t\t}\n\t}\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "target",
            "source",
            "len"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_unaligned_be16",
          "args": [
            "(char *)bounce +\n\t\t\t  sizeof(struct ncp_reply_header)"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 1015
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request2",
          "args": [
            "server",
            "72",
            "bounce",
            "bufsize"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "794-829",
          "snippet": "int ncp_request2(struct ncp_server *server, int function, \n\t\tvoid* rpl, int size)\n{\n\tstruct ncp_request_header *h;\n\tstruct ncp_reply_header* reply = rpl;\n\tint result;\n\n\th = (struct ncp_request_header *) (server->packet);\n\tif (server->has_subfunction != 0) {\n\t\t*(__u16 *) & (h->data[0]) = htons(server->current_size - sizeof(*h) - 2);\n\t}\n\th->type = NCP_REQUEST;\n\t/*\n\t * The server shouldn't know or care what task is making a\n\t * request, so we always use the same task number.\n\t */\n\th->task = 2; /* (current->pid) & 0xff; */\n\th->function = function;\n\n\tresult = ncp_do_request(server, server->current_size, reply, size);\n\tif (result < 0) {\n\t\tncp_dbg(1, \"ncp_request_error: %d\\n\", result);\n\t\tgoto out;\n\t}\n\tserver->completion = reply->completion_code;\n\tserver->conn_status = reply->connection_state;\n\tserver->reply_size = result;\n\tserver->ncp_reply_size = result - sizeof(struct ncp_reply_header);\n\n\tresult = reply->completion_code;\n\n\tif (result != 0)\n\t\tncp_vdbg(\"completion code=%x\\n\", result);\nout:\n\treturn result;\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nint ncp_request2(struct ncp_server *server, int function, \n\t\tvoid* rpl, int size)\n{\n\tstruct ncp_request_header *h;\n\tstruct ncp_reply_header* reply = rpl;\n\tint result;\n\n\th = (struct ncp_request_header *) (server->packet);\n\tif (server->has_subfunction != 0) {\n\t\t*(__u16 *) & (h->data[0]) = htons(server->current_size - sizeof(*h) - 2);\n\t}\n\th->type = NCP_REQUEST;\n\t/*\n\t * The server shouldn't know or care what task is making a\n\t * request, so we always use the same task number.\n\t */\n\th->task = 2; /* (current->pid) & 0xff; */\n\th->function = function;\n\n\tresult = ncp_do_request(server, server->current_size, reply, size);\n\tif (result < 0) {\n\t\tncp_dbg(1, \"ncp_request_error: %d\\n\", result);\n\t\tgoto out;\n\t}\n\tserver->completion = reply->completion_code;\n\tserver->conn_status = reply->connection_state;\n\tserver->reply_size = result;\n\tserver->ncp_reply_size = result - sizeof(struct ncp_reply_header);\n\n\tresult = reply->completion_code;\n\n\tif (result != 0)\n\t\tncp_vdbg(\"completion code=%x\\n\", result);\nout:\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be16",
          "args": [
            "server",
            "to_read"
          ],
          "line": 1013
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "39-44",
          "snippet": "static void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be32",
          "args": [
            "server",
            "offset"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "54-59",
          "snippet": "static void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "file_id",
            "6"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_read_bounce(struct ncp_server *server, const char *file_id,\n\t __u32 offset, __u16 to_read, char __user *target, int *bytes_read,\n\t void* bounce, __u32 bufsize)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be16(server, to_read);\n\tresult = ncp_request2(server, 72, bounce, bufsize);\n\tncp_unlock_server(server);\n\tif (!result) {\n\t\tint len = get_unaligned_be16((char *)bounce +\n\t\t\t  sizeof(struct ncp_reply_header));\n\t\tresult = -EIO;\n\t\tif (len <= to_read) {\n\t\t\tchar* source;\n\n\t\t\tsource = (char*)bounce + \n\t\t\t         sizeof(struct ncp_reply_header) + 2 + \n\t\t\t         (offset & 1);\n\t\t\t*bytes_read = len;\n\t\t\tresult = 0;\n\t\t\tif (copy_to_user(target, source, len))\n\t\t\t\tresult = -EFAULT;\n\t\t}\n\t}\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_read_kernel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "966-989",
    "snippet": "int\nncp_read_kernel(struct ncp_server *server, const char *file_id,\n\t     __u32 offset, __u16 to_read, char *target, int *bytes_read)\n{\n\tconst char *source;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be16(server, to_read);\n\n\tif ((result = ncp_request(server, 72)) != 0) {\n\t\tgoto out;\n\t}\n\t*bytes_read = ncp_reply_be16(server, 0);\n\tsource = ncp_reply_data(server, 2 + (offset & 1));\n\n\tmemcpy(target, source, *bytes_read);\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "target",
            "source",
            "*bytes_read"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "2 + (offset & 1)"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_be16",
          "args": [
            "server",
            "0"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "131-135",
          "snippet": "static u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "72"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be16",
          "args": [
            "server",
            "to_read"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "39-44",
          "snippet": "static void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be32",
          "args": [
            "server",
            "offset"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "54-59",
          "snippet": "static void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "file_id",
            "6"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_read_kernel(struct ncp_server *server, const char *file_id,\n\t     __u32 offset, __u16 to_read, char *target, int *bytes_read)\n{\n\tconst char *source;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\tncp_add_be32(server, offset);\n\tncp_add_be16(server, to_read);\n\n\tif ((result = ncp_request(server, 72)) != 0) {\n\t\tgoto out;\n\t}\n\t*bytes_read = ncp_reply_be16(server, 0);\n\tsource = ncp_reply_data(server, 2 + (offset & 1));\n\n\tmemcpy(target, source, *bytes_read);\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_ren_or_mov_file_or_subdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "940-962",
    "snippet": "int ncp_ren_or_mov_file_or_subdir(struct ncp_server *server,\n\t\t\t\tstruct inode *old_dir, const char *old_name,\n\t\t\t\tstruct inode *new_dir, const char *new_name)\n{\n        int result;\n        __le16 old_type = cpu_to_le16(0x06);\n\n/* If somebody can do it atomic, call me... vandrove@vc.cvut.cz */\n\tresult = ncp_RenameNSEntry(server, old_dir, old_name, old_type,\n\t                                   new_dir, new_name);\n        if (result == 0xFF)\t/* File Not Found, try directory */\n\t{\n\t\told_type = cpu_to_le16(0x16);\n\t\tresult = ncp_RenameNSEntry(server, old_dir, old_name, old_type,\n\t\t\t\t\t\t   new_dir, new_name);\n\t}\n\tif (result != 0x92) return result;\t/* All except NO_FILES_RENAMED */\n\tresult = ncp_del_file_or_subdir(server, new_dir, new_name);\n\tif (result != 0) return -EACCES;\n\tresult = ncp_RenameNSEntry(server, old_dir, old_name, old_type,\n\t\t\t\t\t   new_dir, new_name);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_RenameNSEntry",
          "args": [
            "server",
            "old_dir",
            "old_name",
            "old_type",
            "new_dir",
            "new_name"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_RenameNSEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "900-938",
          "snippet": "static int\nncp_RenameNSEntry(struct ncp_server *server,\n\t\t  struct inode *old_dir, const char *old_name, __le16 old_type,\n\t\t  struct inode *new_dir, const char *new_name)\n{\n\tint result = -EINVAL;\n\n\tif ((old_dir == NULL) || (old_name == NULL) ||\n\t    (new_dir == NULL) || (new_name == NULL))\n\t\tgoto out;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 4);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[NCP_FINFO(old_dir)->volNumber]);\n\tncp_add_byte(server, 1);\t/* rename flag */\n\tncp_add_word(server, old_type);\t/* search attributes */\n\n\t/* source Handle Path */\n\tncp_add_byte(server, NCP_FINFO(old_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(old_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 source component */\n\n\t/* dest Handle Path */\n\tncp_add_byte(server, NCP_FINFO(new_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(new_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 destination component */\n\n\t/* source path string */\n\tncp_add_pstring(server, old_name);\n\t/* dest path string */\n\tncp_add_pstring(server, new_name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\nout:\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_RenameNSEntry(struct ncp_server *server,\n\t\t  struct inode *old_dir, const char *old_name, __le16 old_type,\n\t\t  struct inode *new_dir, const char *new_name)\n{\n\tint result = -EINVAL;\n\n\tif ((old_dir == NULL) || (old_name == NULL) ||\n\t    (new_dir == NULL) || (new_name == NULL))\n\t\tgoto out;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 4);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[NCP_FINFO(old_dir)->volNumber]);\n\tncp_add_byte(server, 1);\t/* rename flag */\n\tncp_add_word(server, old_type);\t/* search attributes */\n\n\t/* source Handle Path */\n\tncp_add_byte(server, NCP_FINFO(old_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(old_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 source component */\n\n\t/* dest Handle Path */\n\tncp_add_byte(server, NCP_FINFO(new_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(new_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 destination component */\n\n\t/* source path string */\n\tncp_add_pstring(server, old_name);\n\t/* dest path string */\n\tncp_add_pstring(server, new_name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\nout:\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_del_file_or_subdir",
          "args": [
            "server",
            "new_dir",
            "new_name"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_del_file_or_subdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "742-763",
          "snippet": "int\nncp_del_file_or_subdir(struct ncp_server *server,\n\t\t       struct inode *dir, const char *name)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint name_space;\n\n\tname_space = server->name_space[volnum];\n#ifdef CONFIG_NCPFS_NFS_NS\n\tif (name_space == NW_NS_NFS)\n \t{\n \t\tint result;\n \n\t\tresult=ncp_obtain_DOS_dir_base(server, name_space, volnum, dirent, name, &dirent);\n \t\tif (result) return result;\n\t\tname = NULL;\n\t\tname_space = NW_NS_DOS;\n \t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n\treturn ncp_DeleteNSEntry(server, 1, volnum, dirent, name, name_space, cpu_to_le16(0x8006));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_del_file_or_subdir(struct ncp_server *server,\n\t\t       struct inode *dir, const char *name)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint name_space;\n\n\tname_space = server->name_space[volnum];\n#ifdef CONFIG_NCPFS_NFS_NS\n\tif (name_space == NW_NS_NFS)\n \t{\n \t\tint result;\n \n\t\tresult=ncp_obtain_DOS_dir_base(server, name_space, volnum, dirent, name, &dirent);\n \t\tif (result) return result;\n\t\tname = NULL;\n\t\tname_space = NW_NS_DOS;\n \t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n\treturn ncp_DeleteNSEntry(server, 1, volnum, dirent, name, name_space, cpu_to_le16(0x8006));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x16"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x06"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_ren_or_mov_file_or_subdir(struct ncp_server *server,\n\t\t\t\tstruct inode *old_dir, const char *old_name,\n\t\t\t\tstruct inode *new_dir, const char *new_name)\n{\n        int result;\n        __le16 old_type = cpu_to_le16(0x06);\n\n/* If somebody can do it atomic, call me... vandrove@vc.cvut.cz */\n\tresult = ncp_RenameNSEntry(server, old_dir, old_name, old_type,\n\t                                   new_dir, new_name);\n        if (result == 0xFF)\t/* File Not Found, try directory */\n\t{\n\t\told_type = cpu_to_le16(0x16);\n\t\tresult = ncp_RenameNSEntry(server, old_dir, old_name, old_type,\n\t\t\t\t\t\t   new_dir, new_name);\n\t}\n\tif (result != 0x92) return result;\t/* All except NO_FILES_RENAMED */\n\tresult = ncp_del_file_or_subdir(server, new_dir, new_name);\n\tif (result != 0) return -EACCES;\n\tresult = ncp_RenameNSEntry(server, old_dir, old_name, old_type,\n\t\t\t\t\t   new_dir, new_name);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_RenameNSEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "900-938",
    "snippet": "static int\nncp_RenameNSEntry(struct ncp_server *server,\n\t\t  struct inode *old_dir, const char *old_name, __le16 old_type,\n\t\t  struct inode *new_dir, const char *new_name)\n{\n\tint result = -EINVAL;\n\n\tif ((old_dir == NULL) || (old_name == NULL) ||\n\t    (new_dir == NULL) || (new_name == NULL))\n\t\tgoto out;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 4);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[NCP_FINFO(old_dir)->volNumber]);\n\tncp_add_byte(server, 1);\t/* rename flag */\n\tncp_add_word(server, old_type);\t/* search attributes */\n\n\t/* source Handle Path */\n\tncp_add_byte(server, NCP_FINFO(old_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(old_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 source component */\n\n\t/* dest Handle Path */\n\tncp_add_byte(server, NCP_FINFO(new_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(new_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 destination component */\n\n\t/* source path string */\n\tncp_add_pstring(server, old_name);\n\t/* dest path string */\n\tncp_add_pstring(server, new_name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\nout:\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_pstring",
          "args": [
            "server",
            "new_name"
          ],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_pstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "73-84",
          "snippet": "static void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "1"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "NCP_FINFO(new_dir)->dirEntNum"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "new_dir"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "old_type"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_RenameNSEntry(struct ncp_server *server,\n\t\t  struct inode *old_dir, const char *old_name, __le16 old_type,\n\t\t  struct inode *new_dir, const char *new_name)\n{\n\tint result = -EINVAL;\n\n\tif ((old_dir == NULL) || (old_name == NULL) ||\n\t    (new_dir == NULL) || (new_name == NULL))\n\t\tgoto out;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 4);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[NCP_FINFO(old_dir)->volNumber]);\n\tncp_add_byte(server, 1);\t/* rename flag */\n\tncp_add_word(server, old_type);\t/* search attributes */\n\n\t/* source Handle Path */\n\tncp_add_byte(server, NCP_FINFO(old_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(old_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 source component */\n\n\t/* dest Handle Path */\n\tncp_add_byte(server, NCP_FINFO(new_dir)->volNumber);\n\tncp_add_dword(server, NCP_FINFO(new_dir)->dirEntNum);\n\tncp_add_byte(server, 1);\n\tncp_add_byte(server, 1);\t/* 1 destination component */\n\n\t/* source path string */\n\tncp_add_pstring(server, old_name);\n\t/* dest path string */\n\tncp_add_pstring(server, new_name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\nout:\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_search_for_fileset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "852-898",
    "snippet": "int ncp_search_for_fileset(struct ncp_server *server,\n\t\t\t   struct nw_search_sequence *seq,\n\t\t\t   int* more,\n\t\t\t   int* cnt,\n\t\t\t   char* buffer,\n\t\t\t   size_t bufsize,\n\t\t\t   char** rbuf,\n\t\t\t   size_t* rsize)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 20);\n\tncp_add_byte(server, server->name_space[seq->volNumber]);\n\tncp_add_byte(server, 0);\t\t/* datastream */\n\tncp_add_word(server, cpu_to_le16(0x8006));\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_word(server, cpu_to_le16(32767));\t/* max returned items */\n\tncp_add_mem(server, seq, 9);\n#ifdef CONFIG_NCPFS_NFS_NS\n\tif (server->name_space[seq->volNumber] == NW_NS_NFS) {\n\t\tncp_add_byte(server, 0);\t/* 0 byte pattern */\n\t} else \n#endif\n\t{\n\t\tncp_add_byte(server, 2);\t/* 2 byte pattern */\n\t\tncp_add_byte(server, 0xff);\t/* following is a wildcard */\n\t\tncp_add_byte(server, '*');\n\t}\n\tresult = ncp_request2(server, 87, buffer, bufsize);\n\tif (result) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\tif (server->ncp_reply_size < 12) {\n\t\tncp_unlock_server(server);\n\t\treturn 0xFF;\n\t}\n\t*rsize = server->ncp_reply_size - 12;\n\tncp_unlock_server(server);\n\tbuffer = buffer + sizeof(struct ncp_reply_header);\n\t*rbuf = buffer + 12;\n\t*cnt = WVAL_LH(buffer + 10);\n\t*more = BVAL(buffer + 9);\n\tmemcpy(seq, buffer, 9);\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "seq",
            "buffer",
            "9"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BVAL",
          "args": [
            "buffer + 9"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "BVAL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "110-113",
          "snippet": "static inline u8 BVAL(const void *data)\n{\n\treturn *(const u8 *)data;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline u8 BVAL(const void *data)\n{\n\treturn *(const u8 *)data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WVAL_LH",
          "args": [
            "buffer + 10"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "WVAL_LH",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "120-123",
          "snippet": "static inline u16 WVAL_LH(const void *data)\n{\n\treturn get_unaligned_le16(data);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline u16 WVAL_LH(const void *data)\n{\n\treturn get_unaligned_le16(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request2",
          "args": [
            "server",
            "87",
            "buffer",
            "bufsize"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "794-829",
          "snippet": "int ncp_request2(struct ncp_server *server, int function, \n\t\tvoid* rpl, int size)\n{\n\tstruct ncp_request_header *h;\n\tstruct ncp_reply_header* reply = rpl;\n\tint result;\n\n\th = (struct ncp_request_header *) (server->packet);\n\tif (server->has_subfunction != 0) {\n\t\t*(__u16 *) & (h->data[0]) = htons(server->current_size - sizeof(*h) - 2);\n\t}\n\th->type = NCP_REQUEST;\n\t/*\n\t * The server shouldn't know or care what task is making a\n\t * request, so we always use the same task number.\n\t */\n\th->task = 2; /* (current->pid) & 0xff; */\n\th->function = function;\n\n\tresult = ncp_do_request(server, server->current_size, reply, size);\n\tif (result < 0) {\n\t\tncp_dbg(1, \"ncp_request_error: %d\\n\", result);\n\t\tgoto out;\n\t}\n\tserver->completion = reply->completion_code;\n\tserver->conn_status = reply->connection_state;\n\tserver->reply_size = result;\n\tserver->ncp_reply_size = result - sizeof(struct ncp_reply_header);\n\n\tresult = reply->completion_code;\n\n\tif (result != 0)\n\t\tncp_vdbg(\"completion code=%x\\n\", result);\nout:\n\treturn result;\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nint ncp_request2(struct ncp_server *server, int function, \n\t\tvoid* rpl, int size)\n{\n\tstruct ncp_request_header *h;\n\tstruct ncp_reply_header* reply = rpl;\n\tint result;\n\n\th = (struct ncp_request_header *) (server->packet);\n\tif (server->has_subfunction != 0) {\n\t\t*(__u16 *) & (h->data[0]) = htons(server->current_size - sizeof(*h) - 2);\n\t}\n\th->type = NCP_REQUEST;\n\t/*\n\t * The server shouldn't know or care what task is making a\n\t * request, so we always use the same task number.\n\t */\n\th->task = 2; /* (current->pid) & 0xff; */\n\th->function = function;\n\n\tresult = ncp_do_request(server, server->current_size, reply, size);\n\tif (result < 0) {\n\t\tncp_dbg(1, \"ncp_request_error: %d\\n\", result);\n\t\tgoto out;\n\t}\n\tserver->completion = reply->completion_code;\n\tserver->conn_status = reply->connection_state;\n\tserver->reply_size = result;\n\tserver->ncp_reply_size = result - sizeof(struct ncp_reply_header);\n\n\tresult = reply->completion_code;\n\n\tif (result != 0)\n\t\tncp_vdbg(\"completion code=%x\\n\", result);\nout:\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "'*'"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "seq",
            "9"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "cpu_to_le16(32767)"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "32767"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "RIM_ALL"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8006"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_search_for_fileset(struct ncp_server *server,\n\t\t\t   struct nw_search_sequence *seq,\n\t\t\t   int* more,\n\t\t\t   int* cnt,\n\t\t\t   char* buffer,\n\t\t\t   size_t bufsize,\n\t\t\t   char** rbuf,\n\t\t\t   size_t* rsize)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 20);\n\tncp_add_byte(server, server->name_space[seq->volNumber]);\n\tncp_add_byte(server, 0);\t\t/* datastream */\n\tncp_add_word(server, cpu_to_le16(0x8006));\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_word(server, cpu_to_le16(32767));\t/* max returned items */\n\tncp_add_mem(server, seq, 9);\n#ifdef CONFIG_NCPFS_NFS_NS\n\tif (server->name_space[seq->volNumber] == NW_NS_NFS) {\n\t\tncp_add_byte(server, 0);\t/* 0 byte pattern */\n\t} else \n#endif\n\t{\n\t\tncp_add_byte(server, 2);\t/* 2 byte pattern */\n\t\tncp_add_byte(server, 0xff);\t/* following is a wildcard */\n\t\tncp_add_byte(server, '*');\n\t}\n\tresult = ncp_request2(server, 87, buffer, bufsize);\n\tif (result) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\tif (server->ncp_reply_size < 12) {\n\t\tncp_unlock_server(server);\n\t\treturn 0xFF;\n\t}\n\t*rsize = server->ncp_reply_size - 12;\n\tncp_unlock_server(server);\n\tbuffer = buffer + sizeof(struct ncp_reply_header);\n\t*rbuf = buffer + 12;\n\t*cnt = WVAL_LH(buffer + 10);\n\t*more = BVAL(buffer + 9);\n\tmemcpy(seq, buffer, 9);\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_initialize_search",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "828-850",
    "snippet": "int\nncp_initialize_search(struct ncp_server *server, struct inode *dir,\n\t\t\tstruct nw_search_sequence *target)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 2);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_handle_path(server, volnum, dirent, 1, NULL);\n\n\tresult = ncp_request(server, 87);\n\tif (result)\n\t\tgoto out;\n\tmemcpy(target, ncp_reply_data(server, 0), sizeof(*target));\n\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "target",
            "ncp_reply_data(server, 0)",
            "sizeof(*target)"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "0"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "volnum",
            "dirent",
            "1",
            "NULL"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "dir"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_initialize_search(struct ncp_server *server, struct inode *dir,\n\t\t\tstruct nw_search_sequence *target)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 2);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_handle_path(server, volnum, dirent, 1, NULL);\n\n\tresult = ncp_request(server, 87);\n\tif (result)\n\t\tgoto out;\n\tmemcpy(target, ncp_reply_data(server, 0), sizeof(*target));\n\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_open_create_file_or_subdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "776-826",
    "snippet": "int ncp_open_create_file_or_subdir(struct ncp_server *server,\n\t\t\t\t   struct inode *dir, const char *name,\n\t\t\t\t   int open_create_mode,\n\t\t\t\t   __le32 create_attributes,\n\t\t\t\t   __le16 desired_acc_rights,\n\t\t\t\t   struct ncp_entry_info *target)\n{\n\t__le16 search_attribs = cpu_to_le16(0x0006);\n\t__u8  volnum;\n\t__le32 dirent;\n\tint result;\n\n\tvolnum = NCP_FINFO(dir)->volNumber;\n\tdirent = NCP_FINFO(dir)->dirEntNum;\n\n\tif ((create_attributes & aDIR) != 0) {\n\t\tsearch_attribs |= cpu_to_le16(0x8000);\n\t}\n\tncp_init_request(server);\n\tncp_add_byte(server, 1);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, open_create_mode);\n\tncp_add_word(server, search_attribs);\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_dword(server, create_attributes);\n\t/* The desired acc rights seem to be the inherited rights mask\n\t   for directories */\n\tncp_add_word(server, desired_acc_rights);\n\tncp_add_handle_path(server, volnum, dirent, 1, name);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t\tgoto out;\n\tif (!(create_attributes & aDIR))\n\t\ttarget->opened = 1;\n\n\t/* in target there's a new finfo to fill */\n\tncp_extract_file_info(ncp_reply_data(server, 6), &(target->i));\n\ttarget->volume = target->i.volNumber;\n\tConvertToNWfromDWORD(ncp_reply_le16(server, 0),\n\t\t\t     ncp_reply_le16(server, 2),\n\t\t\t     target->file_handle);\n\t\n\tncp_unlock_server(server);\n\n\t(void)ncp_obtain_nfs_info(server, &(target->i));\n\treturn 0;\n\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_obtain_nfs_info",
          "args": [
            "server",
            "&(target->i)"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_obtain_nfs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "375-413",
          "snippet": "int ncp_obtain_nfs_info(struct ncp_server *server,\n\t\t        struct nw_info_struct *target)\n\n{\n\tint result = 0;\n#ifdef CONFIG_NCPFS_NFS_NS\n\t__u32 volnum = target->volNumber;\n\n\tif (ncp_is_nfs_extras(server, volnum)) {\n\t\tncp_init_request(server);\n\t\tncp_add_byte(server, 19);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, 0);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, target->dirEntNum);\n\t\t/* We must retrieve both nlinks and rdev, otherwise some server versions\n\t\t   report zeroes instead of valid data */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\n\t\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t\tncp_extract_nfs_info(ncp_reply_data(server, 0), &target->nfs);\n\t\t\tncp_dbg(1, \"(%s) mode=0%o, rdev=0x%x\\n\",\n\t\t\t\ttarget->entryName, target->nfs.mode,\n\t\t\t\ttarget->nfs.rdev);\n\t\t} else {\n\t\t\ttarget->nfs.mode = 0;\n\t\t\ttarget->nfs.rdev = 0;\n\t\t}\n\t        ncp_unlock_server(server);\n\n\t} else\n#endif\n\t{\n\t\ttarget->nfs.mode = 0;\n\t\ttarget->nfs.rdev = 0;\n\t}\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_obtain_nfs_info(struct ncp_server *server,\n\t\t        struct nw_info_struct *target)\n\n{\n\tint result = 0;\n#ifdef CONFIG_NCPFS_NFS_NS\n\t__u32 volnum = target->volNumber;\n\n\tif (ncp_is_nfs_extras(server, volnum)) {\n\t\tncp_init_request(server);\n\t\tncp_add_byte(server, 19);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, 0);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, target->dirEntNum);\n\t\t/* We must retrieve both nlinks and rdev, otherwise some server versions\n\t\t   report zeroes instead of valid data */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\n\t\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t\tncp_extract_nfs_info(ncp_reply_data(server, 0), &target->nfs);\n\t\t\tncp_dbg(1, \"(%s) mode=0%o, rdev=0x%x\\n\",\n\t\t\t\ttarget->entryName, target->nfs.mode,\n\t\t\t\ttarget->nfs.rdev);\n\t\t} else {\n\t\t\ttarget->nfs.mode = 0;\n\t\t\ttarget->nfs.rdev = 0;\n\t\t}\n\t        ncp_unlock_server(server);\n\n\t} else\n#endif\n\t{\n\t\ttarget->nfs.mode = 0;\n\t\ttarget->nfs.rdev = 0;\n\t}\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ConvertToNWfromDWORD",
          "args": [
            "ncp_reply_le16(server, 0)",
            "ncp_reply_le16(server, 2)",
            "target->file_handle"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertToNWfromDWORD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "765-772",
          "snippet": "static inline void ConvertToNWfromDWORD(__u16 v0, __u16 v1, __u8 ret[6])\n{\n\t__le16 *dest = (__le16 *) ret;\n\tdest[1] = cpu_to_le16(v0);\n\tdest[2] = cpu_to_le16(v1);\n\tdest[0] = cpu_to_le16(v0 + 1);\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ConvertToNWfromDWORD(__u16 v0, __u16 v1, __u8 ret[6])\n{\n\t__le16 *dest = (__le16 *) ret;\n\tdest[1] = cpu_to_le16(v0);\n\tdest[2] = cpu_to_le16(v1);\n\tdest[0] = cpu_to_le16(v0 + 1);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_le16",
          "args": [
            "server",
            "2"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "125-129",
          "snippet": "static u16\nncp_reply_le16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_le16(ncp_reply_data(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u16\nncp_reply_le16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_le16(ncp_reply_data(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_extract_file_info",
          "args": [
            "ncp_reply_data(server, 6)",
            "&(target->i)"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_extract_file_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "352-364",
          "snippet": "void ncp_extract_file_info(const void *structure, struct nw_info_struct *target)\n{\n\tconst __u8 *name_len;\n\tconst int info_struct_size = offsetof(struct nw_info_struct, nameLen);\n\n\tmemcpy(target, structure, info_struct_size);\n\tname_len = structure + info_struct_size;\n\ttarget->nameLen = *name_len;\n\tmemcpy(target->entryName, name_len + 1, *name_len);\n\ttarget->entryName[*name_len] = '\\0';\n\ttarget->volNumber = le32_to_cpu(target->volNumber);\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nvoid ncp_extract_file_info(const void *structure, struct nw_info_struct *target)\n{\n\tconst __u8 *name_len;\n\tconst int info_struct_size = offsetof(struct nw_info_struct, nameLen);\n\n\tmemcpy(target, structure, info_struct_size);\n\tname_len = structure + info_struct_size;\n\ttarget->nameLen = *name_len;\n\tmemcpy(target->entryName, name_len + 1, *name_len);\n\ttarget->entryName[*name_len] = '\\0';\n\ttarget->volNumber = le32_to_cpu(target->volNumber);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "6"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "volnum",
            "dirent",
            "1",
            "name"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "desired_acc_rights"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "create_attributes"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "open_create_mode"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8000"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "dir"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x0006"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_open_create_file_or_subdir(struct ncp_server *server,\n\t\t\t\t   struct inode *dir, const char *name,\n\t\t\t\t   int open_create_mode,\n\t\t\t\t   __le32 create_attributes,\n\t\t\t\t   __le16 desired_acc_rights,\n\t\t\t\t   struct ncp_entry_info *target)\n{\n\t__le16 search_attribs = cpu_to_le16(0x0006);\n\t__u8  volnum;\n\t__le32 dirent;\n\tint result;\n\n\tvolnum = NCP_FINFO(dir)->volNumber;\n\tdirent = NCP_FINFO(dir)->dirEntNum;\n\n\tif ((create_attributes & aDIR) != 0) {\n\t\tsearch_attribs |= cpu_to_le16(0x8000);\n\t}\n\tncp_init_request(server);\n\tncp_add_byte(server, 1);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, open_create_mode);\n\tncp_add_word(server, search_attribs);\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_dword(server, create_attributes);\n\t/* The desired acc rights seem to be the inherited rights mask\n\t   for directories */\n\tncp_add_word(server, desired_acc_rights);\n\tncp_add_handle_path(server, volnum, dirent, 1, name);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t\tgoto out;\n\tif (!(create_attributes & aDIR))\n\t\ttarget->opened = 1;\n\n\t/* in target there's a new finfo to fill */\n\tncp_extract_file_info(ncp_reply_data(server, 6), &(target->i));\n\ttarget->volume = target->i.volNumber;\n\tConvertToNWfromDWORD(ncp_reply_le16(server, 0),\n\t\t\t     ncp_reply_le16(server, 2),\n\t\t\t     target->file_handle);\n\t\n\tncp_unlock_server(server);\n\n\t(void)ncp_obtain_nfs_info(server, &(target->i));\n\treturn 0;\n\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ConvertToNWfromDWORD",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "765-772",
    "snippet": "static inline void ConvertToNWfromDWORD(__u16 v0, __u16 v1, __u8 ret[6])\n{\n\t__le16 *dest = (__le16 *) ret;\n\tdest[1] = cpu_to_le16(v0);\n\tdest[2] = cpu_to_le16(v1);\n\tdest[0] = cpu_to_le16(v0 + 1);\n\treturn;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "v0 + 1"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "v1"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "v0"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ConvertToNWfromDWORD(__u16 v0, __u16 v1, __u8 ret[6])\n{\n\t__le16 *dest = (__le16 *) ret;\n\tdest[1] = cpu_to_le16(v0);\n\tdest[2] = cpu_to_le16(v1);\n\tdest[0] = cpu_to_le16(v0 + 1);\n\treturn;\n}"
  },
  {
    "function_name": "ncp_del_file_or_subdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "742-763",
    "snippet": "int\nncp_del_file_or_subdir(struct ncp_server *server,\n\t\t       struct inode *dir, const char *name)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint name_space;\n\n\tname_space = server->name_space[volnum];\n#ifdef CONFIG_NCPFS_NFS_NS\n\tif (name_space == NW_NS_NFS)\n \t{\n \t\tint result;\n \n\t\tresult=ncp_obtain_DOS_dir_base(server, name_space, volnum, dirent, name, &dirent);\n \t\tif (result) return result;\n\t\tname = NULL;\n\t\tname_space = NW_NS_DOS;\n \t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n\treturn ncp_DeleteNSEntry(server, 1, volnum, dirent, name, name_space, cpu_to_le16(0x8006));\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_DeleteNSEntry",
          "args": [
            "server",
            "1",
            "volnum",
            "dirent",
            "name",
            "name_space",
            "cpu_to_le16(0x8006)"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_DeleteNSEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "707-724",
          "snippet": "static int\nncp_DeleteNSEntry(struct ncp_server *server,\n\t\t  __u8 have_dir_base, __u8 volnum, __le32 dirent,\n\t\t  const char* name, __u8 ns, __le16 attr)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 8);\t/* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, attr);\t/* search attribs: all */\n\tncp_add_handle_path(server, volnum, dirent, have_dir_base, name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_DeleteNSEntry(struct ncp_server *server,\n\t\t  __u8 have_dir_base, __u8 volnum, __le32 dirent,\n\t\t  const char* name, __u8 ns, __le16 attr)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 8);\t/* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, attr);\t/* search attribs: all */\n\tncp_add_handle_path(server, volnum, dirent, have_dir_base, name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8006"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_obtain_DOS_dir_base",
          "args": [
            "server",
            "name_space",
            "volnum",
            "dirent",
            "name",
            "&dirent"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_obtain_DOS_dir_base",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "452-474",
          "snippet": "static int\nncp_obtain_DOS_dir_base(struct ncp_server *server,\n\t\t__u8 ns, __u8 volnum, __le32 dirent,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *DOS_dir_base)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, ns);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_DIRECTORY);\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tif ((result = ncp_request(server, 87)) == 0)\n\t{\n\t   \tif (DOS_dir_base) *DOS_dir_base=ncp_reply_dword(server, 0x34);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_obtain_DOS_dir_base(struct ncp_server *server,\n\t\t__u8 ns, __u8 volnum, __le32 dirent,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *DOS_dir_base)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, ns);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_DIRECTORY);\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tif ((result = ncp_request(server, 87)) == 0)\n\t{\n\t   \tif (DOS_dir_base) *DOS_dir_base=ncp_reply_dword(server, 0x34);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "dir"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_del_file_or_subdir(struct ncp_server *server,\n\t\t       struct inode *dir, const char *name)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint name_space;\n\n\tname_space = server->name_space[volnum];\n#ifdef CONFIG_NCPFS_NFS_NS\n\tif (name_space == NW_NS_NFS)\n \t{\n \t\tint result;\n \n\t\tresult=ncp_obtain_DOS_dir_base(server, name_space, volnum, dirent, name, &dirent);\n \t\tif (result) return result;\n\t\tname = NULL;\n\t\tname_space = NW_NS_DOS;\n \t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n\treturn ncp_DeleteNSEntry(server, 1, volnum, dirent, name, name_space, cpu_to_le16(0x8006));\n}"
  },
  {
    "function_name": "ncp_del_file_or_subdir2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "726-740",
    "snippet": "int\nncp_del_file_or_subdir2(struct ncp_server *server,\n\t\t\tstruct dentry *dentry)\n{\n\tstruct inode *inode = dentry->d_inode;\n\t__u8  volnum;\n\t__le32 dirent;\n\n\tif (!inode) {\n\t\treturn 0xFF;\t/* Any error */\n\t}\n\tvolnum = NCP_FINFO(inode)->volNumber;\n\tdirent = NCP_FINFO(inode)->DosDirNum;\n\treturn ncp_DeleteNSEntry(server, 1, volnum, dirent, NULL, NW_NS_DOS, cpu_to_le16(0x8006));\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_DeleteNSEntry",
          "args": [
            "server",
            "1",
            "volnum",
            "dirent",
            "NULL",
            "NW_NS_DOS",
            "cpu_to_le16(0x8006)"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_DeleteNSEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "707-724",
          "snippet": "static int\nncp_DeleteNSEntry(struct ncp_server *server,\n\t\t  __u8 have_dir_base, __u8 volnum, __le32 dirent,\n\t\t  const char* name, __u8 ns, __le16 attr)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 8);\t/* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, attr);\t/* search attribs: all */\n\tncp_add_handle_path(server, volnum, dirent, have_dir_base, name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_DeleteNSEntry(struct ncp_server *server,\n\t\t  __u8 have_dir_base, __u8 volnum, __le32 dirent,\n\t\t  const char* name, __u8 ns, __le16 attr)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 8);\t/* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, attr);\t/* search attribs: all */\n\tncp_add_handle_path(server, volnum, dirent, have_dir_base, name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8006"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "inode"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_del_file_or_subdir2(struct ncp_server *server,\n\t\t\tstruct dentry *dentry)\n{\n\tstruct inode *inode = dentry->d_inode;\n\t__u8  volnum;\n\t__le32 dirent;\n\n\tif (!inode) {\n\t\treturn 0xFF;\t/* Any error */\n\t}\n\tvolnum = NCP_FINFO(inode)->volNumber;\n\tdirent = NCP_FINFO(inode)->DosDirNum;\n\treturn ncp_DeleteNSEntry(server, 1, volnum, dirent, NULL, NW_NS_DOS, cpu_to_le16(0x8006));\n}"
  },
  {
    "function_name": "ncp_DeleteNSEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "707-724",
    "snippet": "static int\nncp_DeleteNSEntry(struct ncp_server *server,\n\t\t  __u8 have_dir_base, __u8 volnum, __le32 dirent,\n\t\t  const char* name, __u8 ns, __le16 attr)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 8);\t/* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, attr);\t/* search attribs: all */\n\tncp_add_handle_path(server, volnum, dirent, have_dir_base, name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "volnum",
            "dirent",
            "have_dir_base",
            "name"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "attr"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_DeleteNSEntry(struct ncp_server *server,\n\t\t  __u8 have_dir_base, __u8 volnum, __le32 dirent,\n\t\t  const char* name, __u8 ns, __le16 attr)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 8);\t/* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, attr);\t/* search attribs: all */\n\tncp_add_handle_path(server, volnum, dirent, have_dir_base, name);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_modify_nfs_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "680-703",
    "snippet": "int ncp_modify_nfs_info(struct ncp_server *server, __u8 volnum, __le32 dirent,\n\t\t\t       __u32 mode, __u32 rdev)\n\n{\n\tint result = 0;\n\n\tncp_init_request(server);\n\tif (server->name_space[volnum] == NW_NS_NFS) {\n\t\tncp_add_byte(server, 25);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, dirent);\n\t\t/* we must always operate on both nlinks and rdev, otherwise\n\t\t   rdev is not set */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\t\tncp_add_dword_lh(server, mode);\n\t\tncp_add_dword_lh(server, 1);\t/* nlinks */\n\t\tncp_add_dword_lh(server, rdev);\n\t\tresult = ncp_request(server, 87);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword_lh",
          "args": [
            "server",
            "rdev"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "volnum"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_modify_nfs_info(struct ncp_server *server, __u8 volnum, __le32 dirent,\n\t\t\t       __u32 mode, __u32 rdev)\n\n{\n\tint result = 0;\n\n\tncp_init_request(server);\n\tif (server->name_space[volnum] == NW_NS_NFS) {\n\t\tncp_add_byte(server, 25);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, dirent);\n\t\t/* we must always operate on both nlinks and rdev, otherwise\n\t\t   rdev is not set */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\t\tncp_add_dword_lh(server, mode);\n\t\tncp_add_dword_lh(server, 1);\t/* nlinks */\n\t\tncp_add_dword_lh(server, rdev);\n\t\tresult = ncp_request(server, 87);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_modify_file_or_subdir_dos_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "670-677",
    "snippet": "int ncp_modify_file_or_subdir_dos_info(struct ncp_server *server,\n\t\t\t\t       struct inode *dir,\n\t\t\t\t       __le32 info_mask,\n\t\t\t\t       const struct nw_modify_dos_info *info)\n{\n\treturn ncp_modify_file_or_subdir_dos_info_path(server, dir, NULL,\n\t\tinfo_mask, info);\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_modify_file_or_subdir_dos_info_path",
          "args": [
            "server",
            "dir",
            "NULL",
            "info_mask",
            "info"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_modify_file_or_subdir_dos_info_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "645-668",
          "snippet": "int ncp_modify_file_or_subdir_dos_info_path(struct ncp_server *server,\n\t\t\t\t\t    struct inode *dir,\n\t\t\t\t\t    const char *path,\n\t\t\t\t\t    __le32 info_mask,\n\t\t\t\t\t    const struct nw_modify_dos_info *info)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 7);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, cpu_to_le16(0x8006));\t/* search attribs: all */\n\n\tncp_add_dword(server, info_mask);\n\tncp_add_mem(server, info, sizeof(*info));\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_modify_file_or_subdir_dos_info_path(struct ncp_server *server,\n\t\t\t\t\t    struct inode *dir,\n\t\t\t\t\t    const char *path,\n\t\t\t\t\t    __le32 info_mask,\n\t\t\t\t\t    const struct nw_modify_dos_info *info)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 7);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, cpu_to_le16(0x8006));\t/* search attribs: all */\n\n\tncp_add_dword(server, info_mask);\n\tncp_add_mem(server, info, sizeof(*info));\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_modify_file_or_subdir_dos_info(struct ncp_server *server,\n\t\t\t\t       struct inode *dir,\n\t\t\t\t       __le32 info_mask,\n\t\t\t\t       const struct nw_modify_dos_info *info)\n{\n\treturn ncp_modify_file_or_subdir_dos_info_path(server, dir, NULL,\n\t\tinfo_mask, info);\n}"
  },
  {
    "function_name": "ncp_modify_file_or_subdir_dos_info_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "645-668",
    "snippet": "int ncp_modify_file_or_subdir_dos_info_path(struct ncp_server *server,\n\t\t\t\t\t    struct inode *dir,\n\t\t\t\t\t    const char *path,\n\t\t\t\t\t    __le32 info_mask,\n\t\t\t\t\t    const struct nw_modify_dos_info *info)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 7);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, cpu_to_le16(0x8006));\t/* search attribs: all */\n\n\tncp_add_dword(server, info_mask);\n\tncp_add_mem(server, info, sizeof(*info));\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "volnum",
            "dirent",
            "1",
            "path"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "info",
            "sizeof(*info)"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "info_mask"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "cpu_to_le16(0x8006)"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8006"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "dir"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_modify_file_or_subdir_dos_info_path(struct ncp_server *server,\n\t\t\t\t\t    struct inode *dir,\n\t\t\t\t\t    const char *path,\n\t\t\t\t\t    __le32 info_mask,\n\t\t\t\t\t    const struct nw_modify_dos_info *info)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 7);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_word(server, cpu_to_le16(0x8006));\t/* search attribs: all */\n\n\tncp_add_dword(server, info_mask);\n\tncp_add_mem(server, info, sizeof(*info));\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tresult = ncp_request(server, 87);\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_lookup_volume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "622-643",
    "snippet": "int\nncp_lookup_volume(struct ncp_server *server,\n\t\t  const char *volname, struct nw_info_struct *target)\n{\n\tint result;\n\n\tmemset(target, 0, sizeof(*target));\n\tresult = ncp_get_volume_root(server, volname,\n\t\t\t&target->volNumber, &target->dirEntNum, &target->DosDirNum);\n\tif (result) {\n\t\treturn result;\n\t}\n\tncp_update_known_namespace(server, target->volNumber, NULL);\n\ttarget->nameLen = strlen(volname);\n\tmemcpy(target->entryName, volname, target->nameLen+1);\n\ttarget->attributes = aDIR;\n\t/* set dates to Jan 1, 1986  00:00 */\n\ttarget->creationTime = target->modifyTime = cpu_to_le16(0x0000);\n\ttarget->creationDate = target->modifyDate = target->lastAccessDate = cpu_to_le16(0x0C21);\n\ttarget->nfs.mode = 0;\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x0C21"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x0000"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "target->entryName",
            "volname",
            "target->nameLen+1"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "volname"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_update_known_namespace",
          "args": [
            "server",
            "target->volNumber",
            "NULL"
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_update_known_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "525-539",
          "snippet": "int\nncp_update_known_namespace(struct ncp_server *server, __u8 volume, int *ret_ns)\n{\n\tint ns = ncp_get_known_namespace(server, volume);\n\n\tif (ret_ns)\n\t\t*ret_ns = ns;\n\n\tncp_dbg(1, \"namespace[%d] = %d\\n\", volume, server->name_space[volume]);\n\n\tif (server->name_space[volume] == ns)\n\t\treturn 0;\n\tserver->name_space[volume] = ns;\n\treturn 1;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_update_known_namespace(struct ncp_server *server, __u8 volume, int *ret_ns)\n{\n\tint ns = ncp_get_known_namespace(server, volume);\n\n\tif (ret_ns)\n\t\t*ret_ns = ns;\n\n\tncp_dbg(1, \"namespace[%d] = %d\\n\", volume, server->name_space[volume]);\n\n\tif (server->name_space[volume] == ns)\n\t\treturn 0;\n\tserver->name_space[volume] = ns;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_get_volume_root",
          "args": [
            "server",
            "volname",
            "&target->volNumber",
            "&target->dirEntNum",
            "&target->DosDirNum"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_get_volume_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "591-620",
          "snippet": "int \nncp_get_volume_root(struct ncp_server *server,\n\t\t    const char *volname, __u32* volume, __le32* dirent, __le32* dosdirent)\n{\n\tint result;\n\n\tncp_dbg(1, \"looking up vol %s\\n\", volname);\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 22);\t/* Subfunction: Generate dir handle */\n\tncp_add_byte(server, 0);\t/* DOS namespace */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\n\tncp_add_byte(server, 0);\t/* faked volume number */\n\tncp_add_dword(server, 0);\t/* faked dir_base */\n\tncp_add_byte(server, 0xff);\t/* Don't have a dir_base */\n\tncp_add_byte(server, 1);\t/* 1 path component */\n\tncp_add_pstring(server, volname);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\t*dirent = *dosdirent = ncp_reply_dword(server, 4);\n\t*volume = ncp_reply_byte(server, 8);\n\tncp_unlock_server(server);\n\treturn 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint \nncp_get_volume_root(struct ncp_server *server,\n\t\t    const char *volname, __u32* volume, __le32* dirent, __le32* dosdirent)\n{\n\tint result;\n\n\tncp_dbg(1, \"looking up vol %s\\n\", volname);\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 22);\t/* Subfunction: Generate dir handle */\n\tncp_add_byte(server, 0);\t/* DOS namespace */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\n\tncp_add_byte(server, 0);\t/* faked volume number */\n\tncp_add_dword(server, 0);\t/* faked dir_base */\n\tncp_add_byte(server, 0xff);\t/* Don't have a dir_base */\n\tncp_add_byte(server, 1);\t/* 1 path component */\n\tncp_add_pstring(server, volname);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\t*dirent = *dosdirent = ncp_reply_dword(server, 4);\n\t*volume = ncp_reply_byte(server, 8);\n\tncp_unlock_server(server);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "target",
            "0",
            "sizeof(*target)"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_lookup_volume(struct ncp_server *server,\n\t\t  const char *volname, struct nw_info_struct *target)\n{\n\tint result;\n\n\tmemset(target, 0, sizeof(*target));\n\tresult = ncp_get_volume_root(server, volname,\n\t\t\t&target->volNumber, &target->dirEntNum, &target->DosDirNum);\n\tif (result) {\n\t\treturn result;\n\t}\n\tncp_update_known_namespace(server, target->volNumber, NULL);\n\ttarget->nameLen = strlen(volname);\n\tmemcpy(target->entryName, volname, target->nameLen+1);\n\ttarget->attributes = aDIR;\n\t/* set dates to Jan 1, 1986  00:00 */\n\ttarget->creationTime = target->modifyTime = cpu_to_le16(0x0000);\n\ttarget->creationDate = target->modifyDate = target->lastAccessDate = cpu_to_le16(0x0C21);\n\ttarget->nfs.mode = 0;\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_get_volume_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "591-620",
    "snippet": "int \nncp_get_volume_root(struct ncp_server *server,\n\t\t    const char *volname, __u32* volume, __le32* dirent, __le32* dosdirent)\n{\n\tint result;\n\n\tncp_dbg(1, \"looking up vol %s\\n\", volname);\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 22);\t/* Subfunction: Generate dir handle */\n\tncp_add_byte(server, 0);\t/* DOS namespace */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\n\tncp_add_byte(server, 0);\t/* faked volume number */\n\tncp_add_dword(server, 0);\t/* faked dir_base */\n\tncp_add_byte(server, 0xff);\t/* Don't have a dir_base */\n\tncp_add_byte(server, 1);\t/* 1 path component */\n\tncp_add_pstring(server, volname);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\t*dirent = *dosdirent = ncp_reply_dword(server, 4);\n\t*volume = ncp_reply_byte(server, 8);\n\tncp_unlock_server(server);\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_byte",
          "args": [
            "server",
            "8"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "115-118",
          "snippet": "static u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_dword",
          "args": [
            "server",
            "4"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "148-150",
          "snippet": "static inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_pstring",
          "args": [
            "server",
            "volname"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_pstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "73-84",
          "snippet": "static void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "1"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "0"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"looking up vol %s\\n\"",
            "volname"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint \nncp_get_volume_root(struct ncp_server *server,\n\t\t    const char *volname, __u32* volume, __le32* dirent, __le32* dosdirent)\n{\n\tint result;\n\n\tncp_dbg(1, \"looking up vol %s\\n\", volname);\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 22);\t/* Subfunction: Generate dir handle */\n\tncp_add_byte(server, 0);\t/* DOS namespace */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\tncp_add_byte(server, 0);\t/* reserved */\n\n\tncp_add_byte(server, 0);\t/* faked volume number */\n\tncp_add_dword(server, 0);\t/* faked dir_base */\n\tncp_add_byte(server, 0xff);\t/* Don't have a dir_base */\n\tncp_add_byte(server, 1);\t/* 1 path component */\n\tncp_add_pstring(server, volname);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\t*dirent = *dosdirent = ncp_reply_dword(server, 4);\n\t*volume = ncp_reply_byte(server, 8);\n\tncp_unlock_server(server);\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_mount_subdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "571-589",
    "snippet": "int\nncp_mount_subdir(struct ncp_server *server,\n\t\t __u8 volNumber, __u8 srcNS, __le32 dirEntNum,\n\t\t __u32* volume, __le32* newDirEnt, __le32* newDosEnt)\n{\n\tint dstNS;\n\tint result;\n\n\tncp_update_known_namespace(server, volNumber, &dstNS);\n\tif ((result = ncp_ObtainSpecificDirBase(server, srcNS, dstNS, volNumber, \n\t\t\t\t      dirEntNum, NULL, newDirEnt, newDosEnt)) != 0)\n\t{\n\t\treturn result;\n\t}\n\t*volume = volNumber;\n\tserver->m.mounted_vol[1] = 0;\n\tserver->m.mounted_vol[0] = 'X';\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_ObtainSpecificDirBase",
          "args": [
            "server",
            "srcNS",
            "dstNS",
            "volNumber",
            "dirEntNum",
            "NULL",
            "newDirEnt",
            "newDosEnt"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_ObtainSpecificDirBase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "541-569",
          "snippet": "static int\nncp_ObtainSpecificDirBase(struct ncp_server *server,\n\t\t__u8 nsSrc, __u8 nsDst, __u8 vol_num, __le32 dir_base,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *dirEntNum, __le32 *DosDirNum)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, nsSrc);\n\tncp_add_byte(server, nsDst);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_handle_path(server, vol_num, dir_base, 1, path);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\n\tif (dirEntNum)\n\t\t*dirEntNum = ncp_reply_dword(server, 0x30);\n\tif (DosDirNum)\n\t\t*DosDirNum = ncp_reply_dword(server, 0x34);\n\tncp_unlock_server(server);\n\treturn 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_ObtainSpecificDirBase(struct ncp_server *server,\n\t\t__u8 nsSrc, __u8 nsDst, __u8 vol_num, __le32 dir_base,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *dirEntNum, __le32 *DosDirNum)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, nsSrc);\n\tncp_add_byte(server, nsDst);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_handle_path(server, vol_num, dir_base, 1, path);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\n\tif (dirEntNum)\n\t\t*dirEntNum = ncp_reply_dword(server, 0x30);\n\tif (DosDirNum)\n\t\t*DosDirNum = ncp_reply_dword(server, 0x34);\n\tncp_unlock_server(server);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_update_known_namespace",
          "args": [
            "server",
            "volNumber",
            "&dstNS"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_update_known_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "525-539",
          "snippet": "int\nncp_update_known_namespace(struct ncp_server *server, __u8 volume, int *ret_ns)\n{\n\tint ns = ncp_get_known_namespace(server, volume);\n\n\tif (ret_ns)\n\t\t*ret_ns = ns;\n\n\tncp_dbg(1, \"namespace[%d] = %d\\n\", volume, server->name_space[volume]);\n\n\tif (server->name_space[volume] == ns)\n\t\treturn 0;\n\tserver->name_space[volume] = ns;\n\treturn 1;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_update_known_namespace(struct ncp_server *server, __u8 volume, int *ret_ns)\n{\n\tint ns = ncp_get_known_namespace(server, volume);\n\n\tif (ret_ns)\n\t\t*ret_ns = ns;\n\n\tncp_dbg(1, \"namespace[%d] = %d\\n\", volume, server->name_space[volume]);\n\n\tif (server->name_space[volume] == ns)\n\t\treturn 0;\n\tserver->name_space[volume] = ns;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_mount_subdir(struct ncp_server *server,\n\t\t __u8 volNumber, __u8 srcNS, __le32 dirEntNum,\n\t\t __u32* volume, __le32* newDirEnt, __le32* newDosEnt)\n{\n\tint dstNS;\n\tint result;\n\n\tncp_update_known_namespace(server, volNumber, &dstNS);\n\tif ((result = ncp_ObtainSpecificDirBase(server, srcNS, dstNS, volNumber, \n\t\t\t\t      dirEntNum, NULL, newDirEnt, newDosEnt)) != 0)\n\t{\n\t\treturn result;\n\t}\n\t*volume = volNumber;\n\tserver->m.mounted_vol[1] = 0;\n\tserver->m.mounted_vol[0] = 'X';\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_ObtainSpecificDirBase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "541-569",
    "snippet": "static int\nncp_ObtainSpecificDirBase(struct ncp_server *server,\n\t\t__u8 nsSrc, __u8 nsDst, __u8 vol_num, __le32 dir_base,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *dirEntNum, __le32 *DosDirNum)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, nsSrc);\n\tncp_add_byte(server, nsDst);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_handle_path(server, vol_num, dir_base, 1, path);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\n\tif (dirEntNum)\n\t\t*dirEntNum = ncp_reply_dword(server, 0x30);\n\tif (DosDirNum)\n\t\t*DosDirNum = ncp_reply_dword(server, 0x34);\n\tncp_unlock_server(server);\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_dword",
          "args": [
            "server",
            "0x34"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "148-150",
          "snippet": "static inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "vol_num",
            "dir_base",
            "1",
            "path"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "RIM_ALL"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "cpu_to_le16(0x8006)"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8006"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "nsDst"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_ObtainSpecificDirBase(struct ncp_server *server,\n\t\t__u8 nsSrc, __u8 nsDst, __u8 vol_num, __le32 dir_base,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *dirEntNum, __le32 *DosDirNum)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, nsSrc);\n\tncp_add_byte(server, nsDst);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_handle_path(server, vol_num, dir_base, 1, path);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\n\tif (dirEntNum)\n\t\t*dirEntNum = ncp_reply_dword(server, 0x30);\n\tif (DosDirNum)\n\t\t*DosDirNum = ncp_reply_dword(server, 0x34);\n\tncp_unlock_server(server);\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_update_known_namespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "525-539",
    "snippet": "int\nncp_update_known_namespace(struct ncp_server *server, __u8 volume, int *ret_ns)\n{\n\tint ns = ncp_get_known_namespace(server, volume);\n\n\tif (ret_ns)\n\t\t*ret_ns = ns;\n\n\tncp_dbg(1, \"namespace[%d] = %d\\n\", volume, server->name_space[volume]);\n\n\tif (server->name_space[volume] == ns)\n\t\treturn 0;\n\tserver->name_space[volume] = ns;\n\treturn 1;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"namespace[%d] = %d\\n\"",
            "volume",
            "server->name_space[volume]"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_get_known_namespace",
          "args": [
            "server",
            "volume"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_get_known_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "477-523",
          "snippet": "static inline int\nncp_get_known_namespace(struct ncp_server *server, __u8 volume)\n{\n#if defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS)\n\tint result;\n\t__u8 *namespace;\n\t__u16 no_namespaces;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 24);\t/* Subfunction: Get Name Spaces Loaded */\n\tncp_add_word(server, 0);\n\tncp_add_byte(server, volume);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn NW_NS_DOS; /* not result ?? */\n\t}\n\n\tresult = NW_NS_DOS;\n\tno_namespaces = ncp_reply_le16(server, 0);\n\tnamespace = ncp_reply_data(server, 2);\n\n\twhile (no_namespaces > 0) {\n\t\tncp_dbg(1, \"found %d on %d\\n\", *namespace, volume);\n\n#ifdef CONFIG_NCPFS_NFS_NS\n\t\tif ((*namespace == NW_NS_NFS) && !(server->m.flags&NCP_MOUNT_NO_NFS)) \n\t\t{\n\t\t\tresult = NW_NS_NFS;\n\t\t\tbreak;\n\t\t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n#ifdef CONFIG_NCPFS_OS2_NS\n\t\tif ((*namespace == NW_NS_OS2) && !(server->m.flags&NCP_MOUNT_NO_OS2))\n\t\t{\n\t\t\tresult = NW_NS_OS2;\n\t\t}\n#endif\t/* CONFIG_NCPFS_OS2_NS */\n\t\tnamespace += 1;\n\t\tno_namespaces -= 1;\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n#else\t/* neither OS2 nor NFS - only DOS */\n\treturn NW_NS_DOS;\n#endif\t/* defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS) */\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline int\nncp_get_known_namespace(struct ncp_server *server, __u8 volume)\n{\n#if defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS)\n\tint result;\n\t__u8 *namespace;\n\t__u16 no_namespaces;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 24);\t/* Subfunction: Get Name Spaces Loaded */\n\tncp_add_word(server, 0);\n\tncp_add_byte(server, volume);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn NW_NS_DOS; /* not result ?? */\n\t}\n\n\tresult = NW_NS_DOS;\n\tno_namespaces = ncp_reply_le16(server, 0);\n\tnamespace = ncp_reply_data(server, 2);\n\n\twhile (no_namespaces > 0) {\n\t\tncp_dbg(1, \"found %d on %d\\n\", *namespace, volume);\n\n#ifdef CONFIG_NCPFS_NFS_NS\n\t\tif ((*namespace == NW_NS_NFS) && !(server->m.flags&NCP_MOUNT_NO_NFS)) \n\t\t{\n\t\t\tresult = NW_NS_NFS;\n\t\t\tbreak;\n\t\t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n#ifdef CONFIG_NCPFS_OS2_NS\n\t\tif ((*namespace == NW_NS_OS2) && !(server->m.flags&NCP_MOUNT_NO_OS2))\n\t\t{\n\t\t\tresult = NW_NS_OS2;\n\t\t}\n#endif\t/* CONFIG_NCPFS_OS2_NS */\n\t\tnamespace += 1;\n\t\tno_namespaces -= 1;\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n#else\t/* neither OS2 nor NFS - only DOS */\n\treturn NW_NS_DOS;\n#endif\t/* defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS) */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_update_known_namespace(struct ncp_server *server, __u8 volume, int *ret_ns)\n{\n\tint ns = ncp_get_known_namespace(server, volume);\n\n\tif (ret_ns)\n\t\t*ret_ns = ns;\n\n\tncp_dbg(1, \"namespace[%d] = %d\\n\", volume, server->name_space[volume]);\n\n\tif (server->name_space[volume] == ns)\n\t\treturn 0;\n\tserver->name_space[volume] = ns;\n\treturn 1;\n}"
  },
  {
    "function_name": "ncp_get_known_namespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "477-523",
    "snippet": "static inline int\nncp_get_known_namespace(struct ncp_server *server, __u8 volume)\n{\n#if defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS)\n\tint result;\n\t__u8 *namespace;\n\t__u16 no_namespaces;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 24);\t/* Subfunction: Get Name Spaces Loaded */\n\tncp_add_word(server, 0);\n\tncp_add_byte(server, volume);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn NW_NS_DOS; /* not result ?? */\n\t}\n\n\tresult = NW_NS_DOS;\n\tno_namespaces = ncp_reply_le16(server, 0);\n\tnamespace = ncp_reply_data(server, 2);\n\n\twhile (no_namespaces > 0) {\n\t\tncp_dbg(1, \"found %d on %d\\n\", *namespace, volume);\n\n#ifdef CONFIG_NCPFS_NFS_NS\n\t\tif ((*namespace == NW_NS_NFS) && !(server->m.flags&NCP_MOUNT_NO_NFS)) \n\t\t{\n\t\t\tresult = NW_NS_NFS;\n\t\t\tbreak;\n\t\t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n#ifdef CONFIG_NCPFS_OS2_NS\n\t\tif ((*namespace == NW_NS_OS2) && !(server->m.flags&NCP_MOUNT_NO_OS2))\n\t\t{\n\t\t\tresult = NW_NS_OS2;\n\t\t}\n#endif\t/* CONFIG_NCPFS_OS2_NS */\n\t\tnamespace += 1;\n\t\tno_namespaces -= 1;\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n#else\t/* neither OS2 nor NFS - only DOS */\n\treturn NW_NS_DOS;\n#endif\t/* defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS) */\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"found %d on %d\\n\"",
            "*namespace",
            "volume"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "2"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_le16",
          "args": [
            "server",
            "0"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "125-129",
          "snippet": "static u16\nncp_reply_le16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_le16(ncp_reply_data(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u16\nncp_reply_le16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_le16(ncp_reply_data(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "volume"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "0"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline int\nncp_get_known_namespace(struct ncp_server *server, __u8 volume)\n{\n#if defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS)\n\tint result;\n\t__u8 *namespace;\n\t__u16 no_namespaces;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 24);\t/* Subfunction: Get Name Spaces Loaded */\n\tncp_add_word(server, 0);\n\tncp_add_byte(server, volume);\n\n\tif ((result = ncp_request(server, 87)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn NW_NS_DOS; /* not result ?? */\n\t}\n\n\tresult = NW_NS_DOS;\n\tno_namespaces = ncp_reply_le16(server, 0);\n\tnamespace = ncp_reply_data(server, 2);\n\n\twhile (no_namespaces > 0) {\n\t\tncp_dbg(1, \"found %d on %d\\n\", *namespace, volume);\n\n#ifdef CONFIG_NCPFS_NFS_NS\n\t\tif ((*namespace == NW_NS_NFS) && !(server->m.flags&NCP_MOUNT_NO_NFS)) \n\t\t{\n\t\t\tresult = NW_NS_NFS;\n\t\t\tbreak;\n\t\t}\n#endif\t/* CONFIG_NCPFS_NFS_NS */\n#ifdef CONFIG_NCPFS_OS2_NS\n\t\tif ((*namespace == NW_NS_OS2) && !(server->m.flags&NCP_MOUNT_NO_OS2))\n\t\t{\n\t\t\tresult = NW_NS_OS2;\n\t\t}\n#endif\t/* CONFIG_NCPFS_OS2_NS */\n\t\tnamespace += 1;\n\t\tno_namespaces -= 1;\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n#else\t/* neither OS2 nor NFS - only DOS */\n\treturn NW_NS_DOS;\n#endif\t/* defined(CONFIG_NCPFS_OS2_NS) || defined(CONFIG_NCPFS_NFS_NS) */\n}"
  },
  {
    "function_name": "ncp_obtain_DOS_dir_base",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "452-474",
    "snippet": "static int\nncp_obtain_DOS_dir_base(struct ncp_server *server,\n\t\t__u8 ns, __u8 volnum, __le32 dirent,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *DOS_dir_base)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, ns);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_DIRECTORY);\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tif ((result = ncp_request(server, 87)) == 0)\n\t{\n\t   \tif (DOS_dir_base) *DOS_dir_base=ncp_reply_dword(server, 0x34);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_dword",
          "args": [
            "server",
            "0x34"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "148-150",
          "snippet": "static inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "volnum",
            "dirent",
            "1",
            "path"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "RIM_DIRECTORY"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "cpu_to_le16(0x8006)"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8006"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "ns"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic int\nncp_obtain_DOS_dir_base(struct ncp_server *server,\n\t\t__u8 ns, __u8 volnum, __le32 dirent,\n\t\tconst char *path, /* At most 1 component */\n\t\t__le32 *DOS_dir_base)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 6); /* subfunction */\n\tncp_add_byte(server, ns);\n\tncp_add_byte(server, ns);\n\tncp_add_word(server, cpu_to_le16(0x8006)); /* get all */\n\tncp_add_dword(server, RIM_DIRECTORY);\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tif ((result = ncp_request(server, 87)) == 0)\n\t{\n\t   \tif (DOS_dir_base) *DOS_dir_base=ncp_reply_dword(server, 0x34);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_obtain_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "419-449",
    "snippet": "int ncp_obtain_info(struct ncp_server *server, struct inode *dir, const char *path,\n\t\t\tstruct nw_info_struct *target)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tif (target == NULL) {\n\t\tpr_err(\"%s: invalid call\\n\", __func__);\n\t\treturn -EINVAL;\n\t}\n\tncp_init_request(server);\n\tncp_add_byte(server, 6);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, server->name_space[volnum]); /* N.B. twice ?? */\n\tncp_add_word(server, cpu_to_le16(0x8006));\t/* get all */\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t\tgoto out;\n\tncp_extract_file_info(ncp_reply_data(server, 0), target);\n\tncp_unlock_server(server);\n\t\n\tresult = ncp_obtain_nfs_info(server, target);\n\treturn result;\n\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_obtain_nfs_info",
          "args": [
            "server",
            "target"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_obtain_nfs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "375-413",
          "snippet": "int ncp_obtain_nfs_info(struct ncp_server *server,\n\t\t        struct nw_info_struct *target)\n\n{\n\tint result = 0;\n#ifdef CONFIG_NCPFS_NFS_NS\n\t__u32 volnum = target->volNumber;\n\n\tif (ncp_is_nfs_extras(server, volnum)) {\n\t\tncp_init_request(server);\n\t\tncp_add_byte(server, 19);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, 0);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, target->dirEntNum);\n\t\t/* We must retrieve both nlinks and rdev, otherwise some server versions\n\t\t   report zeroes instead of valid data */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\n\t\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t\tncp_extract_nfs_info(ncp_reply_data(server, 0), &target->nfs);\n\t\t\tncp_dbg(1, \"(%s) mode=0%o, rdev=0x%x\\n\",\n\t\t\t\ttarget->entryName, target->nfs.mode,\n\t\t\t\ttarget->nfs.rdev);\n\t\t} else {\n\t\t\ttarget->nfs.mode = 0;\n\t\t\ttarget->nfs.rdev = 0;\n\t\t}\n\t        ncp_unlock_server(server);\n\n\t} else\n#endif\n\t{\n\t\ttarget->nfs.mode = 0;\n\t\ttarget->nfs.rdev = 0;\n\t}\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_obtain_nfs_info(struct ncp_server *server,\n\t\t        struct nw_info_struct *target)\n\n{\n\tint result = 0;\n#ifdef CONFIG_NCPFS_NFS_NS\n\t__u32 volnum = target->volNumber;\n\n\tif (ncp_is_nfs_extras(server, volnum)) {\n\t\tncp_init_request(server);\n\t\tncp_add_byte(server, 19);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, 0);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, target->dirEntNum);\n\t\t/* We must retrieve both nlinks and rdev, otherwise some server versions\n\t\t   report zeroes instead of valid data */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\n\t\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t\tncp_extract_nfs_info(ncp_reply_data(server, 0), &target->nfs);\n\t\t\tncp_dbg(1, \"(%s) mode=0%o, rdev=0x%x\\n\",\n\t\t\t\ttarget->entryName, target->nfs.mode,\n\t\t\t\ttarget->nfs.rdev);\n\t\t} else {\n\t\t\ttarget->nfs.mode = 0;\n\t\t\ttarget->nfs.rdev = 0;\n\t\t}\n\t        ncp_unlock_server(server);\n\n\t} else\n#endif\n\t{\n\t\ttarget->nfs.mode = 0;\n\t\ttarget->nfs.rdev = 0;\n\t}\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_extract_file_info",
          "args": [
            "ncp_reply_data(server, 0)",
            "target"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_extract_file_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "352-364",
          "snippet": "void ncp_extract_file_info(const void *structure, struct nw_info_struct *target)\n{\n\tconst __u8 *name_len;\n\tconst int info_struct_size = offsetof(struct nw_info_struct, nameLen);\n\n\tmemcpy(target, structure, info_struct_size);\n\tname_len = structure + info_struct_size;\n\ttarget->nameLen = *name_len;\n\tmemcpy(target->entryName, name_len + 1, *name_len);\n\ttarget->entryName[*name_len] = '\\0';\n\ttarget->volNumber = le32_to_cpu(target->volNumber);\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nvoid ncp_extract_file_info(const void *structure, struct nw_info_struct *target)\n{\n\tconst __u8 *name_len;\n\tconst int info_struct_size = offsetof(struct nw_info_struct, nameLen);\n\n\tmemcpy(target, structure, info_struct_size);\n\tname_len = structure + info_struct_size;\n\ttarget->nameLen = *name_len;\n\tmemcpy(target->entryName, name_len + 1, *name_len);\n\ttarget->entryName[*name_len] = '\\0';\n\ttarget->volNumber = le32_to_cpu(target->volNumber);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "0"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "volnum",
            "dirent",
            "1",
            "path"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "RIM_ALL"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "cpu_to_le16(0x8006)"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x8006"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "server->name_space[volnum]"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: invalid call\\n\"",
            "__func__"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "dir"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_obtain_info(struct ncp_server *server, struct inode *dir, const char *path,\n\t\t\tstruct nw_info_struct *target)\n{\n\t__u8  volnum = NCP_FINFO(dir)->volNumber;\n\t__le32 dirent = NCP_FINFO(dir)->dirEntNum;\n\tint result;\n\n\tif (target == NULL) {\n\t\tpr_err(\"%s: invalid call\\n\", __func__);\n\t\treturn -EINVAL;\n\t}\n\tncp_init_request(server);\n\tncp_add_byte(server, 6);\t/* subfunction */\n\tncp_add_byte(server, server->name_space[volnum]);\n\tncp_add_byte(server, server->name_space[volnum]); /* N.B. twice ?? */\n\tncp_add_word(server, cpu_to_le16(0x8006));\t/* get all */\n\tncp_add_dword(server, RIM_ALL);\n\tncp_add_handle_path(server, volnum, dirent, 1, path);\n\n\tif ((result = ncp_request(server, 87)) != 0)\n\t\tgoto out;\n\tncp_extract_file_info(ncp_reply_data(server, 0), target);\n\tncp_unlock_server(server);\n\t\n\tresult = ncp_obtain_nfs_info(server, target);\n\treturn result;\n\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_obtain_nfs_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "375-413",
    "snippet": "int ncp_obtain_nfs_info(struct ncp_server *server,\n\t\t        struct nw_info_struct *target)\n\n{\n\tint result = 0;\n#ifdef CONFIG_NCPFS_NFS_NS\n\t__u32 volnum = target->volNumber;\n\n\tif (ncp_is_nfs_extras(server, volnum)) {\n\t\tncp_init_request(server);\n\t\tncp_add_byte(server, 19);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, 0);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, target->dirEntNum);\n\t\t/* We must retrieve both nlinks and rdev, otherwise some server versions\n\t\t   report zeroes instead of valid data */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\n\t\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t\tncp_extract_nfs_info(ncp_reply_data(server, 0), &target->nfs);\n\t\t\tncp_dbg(1, \"(%s) mode=0%o, rdev=0x%x\\n\",\n\t\t\t\ttarget->entryName, target->nfs.mode,\n\t\t\t\ttarget->nfs.rdev);\n\t\t} else {\n\t\t\ttarget->nfs.mode = 0;\n\t\t\ttarget->nfs.rdev = 0;\n\t\t}\n\t        ncp_unlock_server(server);\n\n\t} else\n#endif\n\t{\n\t\ttarget->nfs.mode = 0;\n\t\ttarget->nfs.rdev = 0;\n\t}\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"(%s) mode=0%o, rdev=0x%x\\n\"",
            "target->entryName",
            "target->nfs.mode",
            "target->nfs.rdev"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_extract_nfs_info",
          "args": [
            "ncp_reply_data(server, 0)",
            "&target->nfs"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_extract_nfs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "367-372",
          "snippet": "static inline void ncp_extract_nfs_info(const unsigned char *structure,\n\t\t\t\t struct nw_nfs_info *target)\n{\n\ttarget->mode = DVAL_LH(structure);\n\ttarget->rdev = DVAL_LH(structure + 8);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_extract_nfs_info(const unsigned char *structure,\n\t\t\t\t struct nw_nfs_info *target)\n{\n\ttarget->mode = DVAL_LH(structure);\n\ttarget->rdev = DVAL_LH(structure + 8);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "0"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword_lh",
          "args": [
            "server",
            "NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "volnum"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_is_nfs_extras",
          "args": [
            "server",
            "volnum"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_is_nfs_extras",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.h",
          "lines": "119-126",
          "snippet": "static inline int ncp_is_nfs_extras(struct ncp_server* server, unsigned int volnum) {\n#ifdef CONFIG_NCPFS_NFS_NS\n\treturn (server->m.flags & NCP_MOUNT_NFS_EXTRAS) &&\n\t       (server->name_space[volnum] == NW_NS_NFS);\n#else\n\treturn 0;\n#endif\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/nls.h>",
            "#include <asm/string.h>",
            "#include <asm/unaligned.h>",
            "#include <asm/byteorder.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/nls.h>\n#include <asm/string.h>\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline int ncp_is_nfs_extras(struct ncp_server* server, unsigned int volnum) {\n#ifdef CONFIG_NCPFS_NFS_NS\n\treturn (server->m.flags & NCP_MOUNT_NFS_EXTRAS) &&\n\t       (server->name_space[volnum] == NW_NS_NFS);\n#else\n\treturn 0;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_obtain_nfs_info(struct ncp_server *server,\n\t\t        struct nw_info_struct *target)\n\n{\n\tint result = 0;\n#ifdef CONFIG_NCPFS_NFS_NS\n\t__u32 volnum = target->volNumber;\n\n\tif (ncp_is_nfs_extras(server, volnum)) {\n\t\tncp_init_request(server);\n\t\tncp_add_byte(server, 19);\t/* subfunction */\n\t\tncp_add_byte(server, server->name_space[volnum]);\n\t\tncp_add_byte(server, NW_NS_NFS);\n\t\tncp_add_byte(server, 0);\n\t\tncp_add_byte(server, volnum);\n\t\tncp_add_dword(server, target->dirEntNum);\n\t\t/* We must retrieve both nlinks and rdev, otherwise some server versions\n\t\t   report zeroes instead of valid data */\n\t\tncp_add_dword_lh(server, NSIBM_NFS_MODE | NSIBM_NFS_NLINKS | NSIBM_NFS_RDEV);\n\n\t\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t\tncp_extract_nfs_info(ncp_reply_data(server, 0), &target->nfs);\n\t\t\tncp_dbg(1, \"(%s) mode=0%o, rdev=0x%x\\n\",\n\t\t\t\ttarget->entryName, target->nfs.mode,\n\t\t\t\ttarget->nfs.rdev);\n\t\t} else {\n\t\t\ttarget->nfs.mode = 0;\n\t\t\ttarget->nfs.rdev = 0;\n\t\t}\n\t        ncp_unlock_server(server);\n\n\t} else\n#endif\n\t{\n\t\ttarget->nfs.mode = 0;\n\t\ttarget->nfs.rdev = 0;\n\t}\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_extract_nfs_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "367-372",
    "snippet": "static inline void ncp_extract_nfs_info(const unsigned char *structure,\n\t\t\t\t struct nw_nfs_info *target)\n{\n\ttarget->mode = DVAL_LH(structure);\n\ttarget->rdev = DVAL_LH(structure + 8);\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DVAL_LH",
          "args": [
            "structure + 8"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "DVAL_LH",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "137-140",
          "snippet": "static inline u32 DVAL_LH(const void *data)\n{\n\treturn get_unaligned_le32(data);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline u32 DVAL_LH(const void *data)\n{\n\treturn get_unaligned_le32(data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_extract_nfs_info(const unsigned char *structure,\n\t\t\t\t struct nw_nfs_info *target)\n{\n\ttarget->mode = DVAL_LH(structure);\n\ttarget->rdev = DVAL_LH(structure + 8);\n}"
  },
  {
    "function_name": "ncp_extract_file_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "352-364",
    "snippet": "void ncp_extract_file_info(const void *structure, struct nw_info_struct *target)\n{\n\tconst __u8 *name_len;\n\tconst int info_struct_size = offsetof(struct nw_info_struct, nameLen);\n\n\tmemcpy(target, structure, info_struct_size);\n\tname_len = structure + info_struct_size;\n\ttarget->nameLen = *name_len;\n\tmemcpy(target->entryName, name_len + 1, *name_len);\n\ttarget->entryName[*name_len] = '\\0';\n\ttarget->volNumber = le32_to_cpu(target->volNumber);\n\treturn;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "target->volNumber"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "target->entryName",
            "name_len + 1",
            "*name_len"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "target",
            "structure",
            "info_struct_size"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nvoid ncp_extract_file_info(const void *structure, struct nw_info_struct *target)\n{\n\tconst __u8 *name_len;\n\tconst int info_struct_size = offsetof(struct nw_info_struct, nameLen);\n\n\tmemcpy(target, structure, info_struct_size);\n\tname_len = structure + info_struct_size;\n\ttarget->nameLen = *name_len;\n\tmemcpy(target->entryName, name_len + 1, *name_len);\n\ttarget->entryName[*name_len] = '\\0';\n\ttarget->volNumber = le32_to_cpu(target->volNumber);\n\treturn;\n}"
  },
  {
    "function_name": "ncp_dirhandle_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "342-350",
    "snippet": "int ncp_dirhandle_free(struct ncp_server* server, __u8 dirhandle) {\n\tint result;\n\t\n\tncp_init_request_s(server, 20);\n\tncp_add_byte(server, dirhandle);\n\tresult = ncp_request(server, 22);\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "22"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "dirhandle"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request_s",
          "args": [
            "server",
            "20"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request_s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "94-102",
          "snippet": "static inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_dirhandle_free(struct ncp_server* server, __u8 dirhandle) {\n\tint result;\n\t\n\tncp_init_request_s(server, 20);\n\tncp_add_byte(server, dirhandle);\n\tresult = ncp_request(server, 22);\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_dirhandle_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "325-340",
    "snippet": "int ncp_dirhandle_alloc(struct ncp_server* server, __u8 volnum, __le32 dirent,\n\t\t\t__u8* dirhandle) {\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 12);\t\t/* subfunction */\n\tncp_add_byte(server, NW_NS_DOS);\n\tncp_add_byte(server, 0);\n\tncp_add_word(server, 0);\n\tncp_add_handle_path(server, volnum, dirent, 1, NULL);\n\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t*dirhandle = ncp_reply_byte(server, 0);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "115-118",
          "snippet": "static u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "87"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_handle_path",
          "args": [
            "server",
            "volnum",
            "dirent",
            "1",
            "NULL"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_handle_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "306-323",
          "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_word",
          "args": [
            "server",
            "0"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "31-37",
          "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_dirhandle_alloc(struct ncp_server* server, __u8 volnum, __le32 dirent,\n\t\t\t__u8* dirhandle) {\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 12);\t\t/* subfunction */\n\tncp_add_byte(server, NW_NS_DOS);\n\tncp_add_byte(server, 0);\n\tncp_add_word(server, 0);\n\tncp_add_handle_path(server, volnum, dirent, 1, NULL);\n\tif ((result = ncp_request(server, 87)) == 0) {\n\t\t*dirhandle = ncp_reply_byte(server, 0);\n\t}\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_add_handle_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "306-323",
    "snippet": "static void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_pstring",
          "args": [
            "server",
            "path"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_pstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "73-84",
          "snippet": "static void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "dir_base"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_handle_path(struct ncp_server *server, __u8 vol_num,\n\t\t\t\t__le32 dir_base, int have_dir_base, \n\t\t\t\tconst char *path)\n{\n\tncp_add_byte(server, vol_num);\n\tncp_add_dword(server, dir_base);\n\tif (have_dir_base != 0) {\n\t\tncp_add_byte(server, 1);\t/* dir_base */\n\t} else {\n\t\tncp_add_byte(server, 0xff);\t/* no handle */\n\t}\n\tif (path != NULL) {\n\t\tncp_add_byte(server, 1);\t/* 1 component */\n\t\tncp_add_pstring(server, path);\n\t} else {\n\t\tncp_add_byte(server, 0);\n\t}\n}"
  },
  {
    "function_name": "ncp_make_closed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "286-304",
    "snippet": "int\nncp_make_closed(struct inode *inode)\n{\n\tint err;\n\n\terr = 0;\n\tmutex_lock(&NCP_FINFO(inode)->open_mutex);\n\tif (atomic_read(&NCP_FINFO(inode)->opened) == 1) {\n\t\tatomic_set(&NCP_FINFO(inode)->opened, 0);\n\t\terr = ncp_close_file(NCP_SERVER(inode), NCP_FINFO(inode)->file_handle);\n\n\t\tif (!err)\n\t\t\tncp_vdbg(\"volnum=%d, dirent=%u, error=%d\\n\",\n\t\t\t\t NCP_FINFO(inode)->volNumber,\n\t\t\t\t NCP_FINFO(inode)->dirEntNum, err);\n\t}\n\tmutex_unlock(&NCP_FINFO(inode)->open_mutex);\n\treturn err;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&NCP_FINFO(inode)->open_mutex"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "inode"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_vdbg",
          "args": [
            "\"volnum=%d, dirent=%u, error=%d\\n\"",
            "NCP_FINFO(inode)->volNumber",
            "NCP_FINFO(inode)->dirEntNum",
            "err"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_close_file",
          "args": [
            "NCP_SERVER(inode)",
            "NCP_FINFO(inode)->file_handle"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_close_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "272-284",
          "snippet": "int\nncp_close_file(struct ncp_server *server, const char *file_id)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\n\tresult = ncp_request(server, 66);\n\tncp_unlock_server(server);\n\treturn result;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_close_file(struct ncp_server *server, const char *file_id)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\n\tresult = ncp_request(server, 66);\n\tncp_unlock_server(server);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NCP_SERVER",
          "args": [
            "inode"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&NCP_FINFO(inode)->opened",
            "0"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&NCP_FINFO(inode)->opened"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&NCP_FINFO(inode)->open_mutex"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_make_closed(struct inode *inode)\n{\n\tint err;\n\n\terr = 0;\n\tmutex_lock(&NCP_FINFO(inode)->open_mutex);\n\tif (atomic_read(&NCP_FINFO(inode)->opened) == 1) {\n\t\tatomic_set(&NCP_FINFO(inode)->opened, 0);\n\t\terr = ncp_close_file(NCP_SERVER(inode), NCP_FINFO(inode)->file_handle);\n\n\t\tif (!err)\n\t\t\tncp_vdbg(\"volnum=%d, dirent=%u, error=%d\\n\",\n\t\t\t\t NCP_FINFO(inode)->volNumber,\n\t\t\t\t NCP_FINFO(inode)->dirEntNum, err);\n\t}\n\tmutex_unlock(&NCP_FINFO(inode)->open_mutex);\n\treturn err;\n}"
  },
  {
    "function_name": "ncp_close_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "272-284",
    "snippet": "int\nncp_close_file(struct ncp_server *server, const char *file_id)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\n\tresult = ncp_request(server, 66);\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "66"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "file_id",
            "6"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "0"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_close_file(struct ncp_server *server, const char *file_id)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_byte(server, 0);\n\tncp_add_mem(server, file_id, 6);\n\n\tresult = ncp_request(server, 66);\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_get_directory_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "238-270",
    "snippet": "int ncp_get_directory_info(struct ncp_server* server, __u8 n, \n\t\t\t   struct ncp_volume_info* target) {\n\tint result;\n\tint len;\n\n\tncp_init_request_s(server, 45);\n\tncp_add_byte(server, n);\n\n\tif ((result = ncp_request(server, 22)) != 0) {\n\t\tgoto out;\n\t}\n\ttarget->total_blocks = ncp_reply_dword_lh(server, 0);\n\ttarget->free_blocks = ncp_reply_dword_lh(server, 4);\n\ttarget->purgeable_blocks = 0;\n\ttarget->not_yet_purgeable_blocks = 0;\n\ttarget->total_dir_entries = ncp_reply_dword_lh(server, 8);\n\ttarget->available_dir_entries = ncp_reply_dword_lh(server, 12);\n\ttarget->sectors_per_block = ncp_reply_byte(server, 20);\n\n\tmemset(&(target->volume_name), 0, sizeof(target->volume_name));\n\n\tresult = -EIO;\n\tlen = ncp_reply_byte(server, 21);\n\tif (len > NCP_VOLNAME_LEN) {\n\t\tncp_dbg(1, \"volume name too long: %d\\n\", len);\n\t\tgoto out;\n\t}\n\tmemcpy(&(target->volume_name), ncp_reply_data(server, 22), len);\n\tresult = 0;\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&(target->volume_name)",
            "ncp_reply_data(server, 22)",
            "len"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "22"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"volume name too long: %d\\n\"",
            "len"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_byte",
          "args": [
            "server",
            "21"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "115-118",
          "snippet": "static u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&(target->volume_name)",
            "0",
            "sizeof(target->volume_name)"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_dword_lh",
          "args": [
            "server",
            "12"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "148-150",
          "snippet": "static inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "22"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "n"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request_s",
          "args": [
            "server",
            "45"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request_s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "94-102",
          "snippet": "static inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_get_directory_info(struct ncp_server* server, __u8 n, \n\t\t\t   struct ncp_volume_info* target) {\n\tint result;\n\tint len;\n\n\tncp_init_request_s(server, 45);\n\tncp_add_byte(server, n);\n\n\tif ((result = ncp_request(server, 22)) != 0) {\n\t\tgoto out;\n\t}\n\ttarget->total_blocks = ncp_reply_dword_lh(server, 0);\n\ttarget->free_blocks = ncp_reply_dword_lh(server, 4);\n\ttarget->purgeable_blocks = 0;\n\ttarget->not_yet_purgeable_blocks = 0;\n\ttarget->total_dir_entries = ncp_reply_dword_lh(server, 8);\n\ttarget->available_dir_entries = ncp_reply_dword_lh(server, 12);\n\ttarget->sectors_per_block = ncp_reply_byte(server, 20);\n\n\tmemset(&(target->volume_name), 0, sizeof(target->volume_name));\n\n\tresult = -EIO;\n\tlen = ncp_reply_byte(server, 21);\n\tif (len > NCP_VOLNAME_LEN) {\n\t\tncp_dbg(1, \"volume name too long: %d\\n\", len);\n\t\tgoto out;\n\t}\n\tmemcpy(&(target->volume_name), ncp_reply_data(server, 22), len);\n\tresult = 0;\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_get_volume_info_with_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "204-236",
    "snippet": "int ncp_get_volume_info_with_number(struct ncp_server* server,\n\t\t\t     int n, struct ncp_volume_info* target) {\n\tint result;\n\tint len;\n\n\tncp_init_request_s(server, 44);\n\tncp_add_byte(server, n);\n\n\tif ((result = ncp_request(server, 22)) != 0) {\n\t\tgoto out;\n\t}\n\ttarget->total_blocks = ncp_reply_dword_lh(server, 0);\n\ttarget->free_blocks = ncp_reply_dword_lh(server, 4);\n\ttarget->purgeable_blocks = ncp_reply_dword_lh(server, 8);\n\ttarget->not_yet_purgeable_blocks = ncp_reply_dword_lh(server, 12);\n\ttarget->total_dir_entries = ncp_reply_dword_lh(server, 16);\n\ttarget->available_dir_entries = ncp_reply_dword_lh(server, 20);\n\ttarget->sectors_per_block = ncp_reply_byte(server, 28);\n\n\tmemset(&(target->volume_name), 0, sizeof(target->volume_name));\n\n\tresult = -EIO;\n\tlen = ncp_reply_byte(server, 29);\n\tif (len > NCP_VOLNAME_LEN) {\n\t\tncp_dbg(1, \"volume name too long: %d\\n\", len);\n\t\tgoto out;\n\t}\n\tmemcpy(&(target->volume_name), ncp_reply_data(server, 30), len);\n\tresult = 0;\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&(target->volume_name)",
            "ncp_reply_data(server, 30)",
            "len"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "30"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"volume name too long: %d\\n\"",
            "len"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_byte",
          "args": [
            "server",
            "29"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "115-118",
          "snippet": "static u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&(target->volume_name)",
            "0",
            "sizeof(target->volume_name)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_dword_lh",
          "args": [
            "server",
            "20"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "148-150",
          "snippet": "static inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "22"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "n"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request_s",
          "args": [
            "server",
            "44"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request_s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "94-102",
          "snippet": "static inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint ncp_get_volume_info_with_number(struct ncp_server* server,\n\t\t\t     int n, struct ncp_volume_info* target) {\n\tint result;\n\tint len;\n\n\tncp_init_request_s(server, 44);\n\tncp_add_byte(server, n);\n\n\tif ((result = ncp_request(server, 22)) != 0) {\n\t\tgoto out;\n\t}\n\ttarget->total_blocks = ncp_reply_dword_lh(server, 0);\n\ttarget->free_blocks = ncp_reply_dword_lh(server, 4);\n\ttarget->purgeable_blocks = ncp_reply_dword_lh(server, 8);\n\ttarget->not_yet_purgeable_blocks = ncp_reply_dword_lh(server, 12);\n\ttarget->total_dir_entries = ncp_reply_dword_lh(server, 16);\n\ttarget->available_dir_entries = ncp_reply_dword_lh(server, 20);\n\ttarget->sectors_per_block = ncp_reply_byte(server, 28);\n\n\tmemset(&(target->volume_name), 0, sizeof(target->volume_name));\n\n\tresult = -EIO;\n\tlen = ncp_reply_byte(server, 29);\n\tif (len > NCP_VOLNAME_LEN) {\n\t\tncp_dbg(1, \"volume name too long: %d\\n\", len);\n\t\tgoto out;\n\t}\n\tmemcpy(&(target->volume_name), ncp_reply_data(server, 30), len);\n\tresult = 0;\nout:\n\tncp_unlock_server(server);\n\treturn result;\n}"
  },
  {
    "function_name": "ncp_negotiate_size_and_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "175-202",
    "snippet": "int\nncp_negotiate_size_and_options(struct ncp_server *server, \n\tint size, int options, int *ret_size, int *ret_options) {\n\tint result;\n\n\t/* there is minimum */\n\tif (size < NCP_BLOCK_SIZE) size = NCP_BLOCK_SIZE;\n\n\tncp_init_request(server);\n\tncp_add_be16(server, size);\n\tncp_add_byte(server, options);\n\t\n\tif ((result = ncp_request(server, 0x61)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\n\t/* NCP over UDP returns 0 (!!!) */\n\tresult = ncp_reply_be16(server, 0);\n\tif (result >= NCP_BLOCK_SIZE)\n\t\tsize = min(result, size);\n\t*ret_size = size;\n\t*ret_options = ncp_reply_byte(server, 4);\n\n\tncp_unlock_server(server);\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_byte",
          "args": [
            "server",
            "4"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "115-118",
          "snippet": "static u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "result",
            "size"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_be16",
          "args": [
            "server",
            "0"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "131-135",
          "snippet": "static u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "0x61"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "options"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be16",
          "args": [
            "server",
            "size"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "39-44",
          "snippet": "static void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_negotiate_size_and_options(struct ncp_server *server, \n\tint size, int options, int *ret_size, int *ret_options) {\n\tint result;\n\n\t/* there is minimum */\n\tif (size < NCP_BLOCK_SIZE) size = NCP_BLOCK_SIZE;\n\n\tncp_init_request(server);\n\tncp_add_be16(server, size);\n\tncp_add_byte(server, options);\n\t\n\tif ((result = ncp_request(server, 0x61)) != 0)\n\t{\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\n\t/* NCP over UDP returns 0 (!!!) */\n\tresult = ncp_reply_be16(server, 0);\n\tif (result >= NCP_BLOCK_SIZE)\n\t\tsize = min(result, size);\n\t*ret_size = size;\n\t*ret_options = ncp_reply_byte(server, 4);\n\n\tncp_unlock_server(server);\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_negotiate_buffersize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "152-168",
    "snippet": "int\nncp_negotiate_buffersize(struct ncp_server *server, int size, int *target)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_be16(server, size);\n\n\tif ((result = ncp_request(server, 33)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\t*target = min_t(unsigned int, ncp_reply_be16(server, 0), size);\n\n\tncp_unlock_server(server);\n\treturn 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_unlock_server",
          "args": [
            "server"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_unlock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "873-881",
          "snippet": "void ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_unlock_server(struct ncp_server *server)\n{\n\tif (!server->lock) {\n\t\tpr_warn(\"%s: was not locked!\\n\", __func__);\n\t\treturn;\n\t}\n\tserver->lock = 0;\n\tmutex_unlock(&server->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedint",
            "ncp_reply_be16(server, 0)",
            "size"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_be16",
          "args": [
            "server",
            "0"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "131-135",
          "snippet": "static u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_request",
          "args": [
            "server",
            "33"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "75-77",
          "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_connect(struct ncp_server *server);",
            "int ncp_disconnect(struct ncp_server *server);",
            "void ncp_lock_server(struct ncp_server *server);",
            "void ncp_unlock_server(struct ncp_server *server);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_be16",
          "args": [
            "server",
            "size"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_be16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "39-44",
          "snippet": "static void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_init_request",
          "args": [
            "server"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_init_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "86-92",
          "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nint\nncp_negotiate_buffersize(struct ncp_server *server, int size, int *target)\n{\n\tint result;\n\n\tncp_init_request(server);\n\tncp_add_be16(server, size);\n\n\tif ((result = ncp_request(server, 33)) != 0) {\n\t\tncp_unlock_server(server);\n\t\treturn result;\n\t}\n\t*target = min_t(unsigned int, ncp_reply_be16(server, 0), size);\n\n\tncp_unlock_server(server);\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_reply_dword_lh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "148-150",
    "snippet": "static inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "ncp_reply_dword(server, offset)"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_dword",
          "args": [
            "server",
            "offset"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "148-150",
          "snippet": "static inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline __u32 ncp_reply_dword_lh(struct ncp_server* server, int offset) {\n\treturn le32_to_cpu(ncp_reply_dword(server, offset));\n}"
  },
  {
    "function_name": "ncp_reply_dword",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "142-146",
    "snippet": "static __le32\nncp_reply_dword(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned((__le32 *)ncp_reply_data(server, offset));\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_unaligned",
          "args": [
            "(__le32 *)ncp_reply_data(server, offset)"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "get_unaligned_le8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/struct-funcs.c",
          "lines": "24-27",
          "snippet": "static inline u8 get_unaligned_le8(const void *p)\n{\n       return *(u8 *)p;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/highmem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/highmem.h>\n\nstatic inline u8 get_unaligned_le8(const void *p)\n{\n       return *(u8 *)p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "offset"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic __le32\nncp_reply_dword(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned((__le32 *)ncp_reply_data(server, offset));\n}"
  },
  {
    "function_name": "DVAL_LH",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "137-140",
    "snippet": "static inline u32 DVAL_LH(const void *data)\n{\n\treturn get_unaligned_le32(data);\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_unaligned_le32",
          "args": [
            "data"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline u32 DVAL_LH(const void *data)\n{\n\treturn get_unaligned_le32(data);\n}"
  },
  {
    "function_name": "ncp_reply_be16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "131-135",
    "snippet": "static u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_unaligned_be16",
          "args": [
            "ncp_reply_data(server, offset)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "offset"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u16\nncp_reply_be16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_be16(ncp_reply_data(server, offset));\n}"
  },
  {
    "function_name": "ncp_reply_le16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "125-129",
    "snippet": "static u16\nncp_reply_le16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_le16(ncp_reply_data(server, offset));\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_unaligned_le16",
          "args": [
            "ncp_reply_data(server, offset)"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "offset"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u16\nncp_reply_le16(struct ncp_server *server, int offset)\n{\n\treturn get_unaligned_le16(ncp_reply_data(server, offset));\n}"
  },
  {
    "function_name": "WVAL_LH",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "120-123",
    "snippet": "static inline u16 WVAL_LH(const void *data)\n{\n\treturn get_unaligned_le16(data);\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_unaligned_le16",
          "args": [
            "data"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline u16 WVAL_LH(const void *data)\n{\n\treturn get_unaligned_le16(data);\n}"
  },
  {
    "function_name": "ncp_reply_byte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "115-118",
    "snippet": "static u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_reply_data",
          "args": [
            "server",
            "offset"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_reply_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "104-108",
          "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic u8 ncp_reply_byte(struct ncp_server *server, int offset)\n{\n\treturn *(const u8 *)ncp_reply_data(server, offset);\n}"
  },
  {
    "function_name": "BVAL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "110-113",
    "snippet": "static inline u8 BVAL(const void *data)\n{\n\treturn *(const u8 *)data;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline u8 BVAL(const void *data)\n{\n\treturn *(const u8 *)data;\n}"
  },
  {
    "function_name": "ncp_reply_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "104-108",
    "snippet": "static inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline char *\nncp_reply_data(struct ncp_server *server, int offset)\n{\n\treturn &(server->packet[sizeof(struct ncp_reply_header) + offset]);\n}"
  },
  {
    "function_name": "ncp_init_request_s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "94-102",
    "snippet": "static inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "subfunction"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_lock_server",
          "args": [
            "server"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_lock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "865-871",
          "snippet": "void ncp_lock_server(struct ncp_server *server)\n{\n\tmutex_lock(&server->mutex);\n\tif (server->lock)\n\t\tpr_warn(\"%s: was locked!\\n\", __func__);\n\tserver->lock = 1;\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_lock_server(struct ncp_server *server)\n{\n\tmutex_lock(&server->mutex);\n\tif (server->lock)\n\t\tpr_warn(\"%s: was locked!\\n\", __func__);\n\tserver->lock = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request_s(struct ncp_server *server, int subfunction)\n{\n\tncp_lock_server(server);\n\t\n\tserver->current_size = sizeof(struct ncp_request_header) + 2;\n\tncp_add_byte(server, subfunction);\n\n\tserver->has_subfunction = 1;\n}"
  },
  {
    "function_name": "ncp_init_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "86-92",
    "snippet": "static inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_lock_server",
          "args": [
            "server"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_lock_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "865-871",
          "snippet": "void ncp_lock_server(struct ncp_server *server)\n{\n\tmutex_lock(&server->mutex);\n\tif (server->lock)\n\t\tpr_warn(\"%s: was locked!\\n\", __func__);\n\tserver->lock = 1;\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nvoid ncp_lock_server(struct ncp_server *server)\n{\n\tmutex_lock(&server->mutex);\n\tif (server->lock)\n\t\tpr_warn(\"%s: was locked!\\n\", __func__);\n\tserver->lock = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_init_request(struct ncp_server *server)\n{\n\tncp_lock_server(server);\n\n\tserver->current_size = sizeof(struct ncp_request_header);\n\tserver->has_subfunction = 0;\n}"
  },
  {
    "function_name": "ncp_add_pstring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "73-84",
    "snippet": "static void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_add_mem",
          "args": [
            "server",
            "s",
            "len"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "65-71",
          "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_add_byte",
          "args": [
            "server",
            "len"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "23-29",
          "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"string too long: %s\\n\"",
            "s"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_server_locked",
          "args": [
            "server"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "assert_server_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "16-21",
          "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_pstring(struct ncp_server *server, const char *s)\n{\n\tint len = strlen(s);\n\tassert_server_locked(server);\n\tif (len > 255) {\n\t\tncp_dbg(1, \"string too long: %s\\n\", s);\n\t\tlen = 255;\n\t}\n\tncp_add_byte(server, len);\n\tncp_add_mem(server, s, len);\n\treturn;\n}"
  },
  {
    "function_name": "ncp_add_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "65-71",
    "snippet": "static void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&(server->packet[server->current_size])",
            "source",
            "size"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_server_locked",
          "args": [
            "server"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "assert_server_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "16-21",
          "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_mem(struct ncp_server *server, const void *source, int size)\n{\n\tassert_server_locked(server);\n\tmemcpy(&(server->packet[server->current_size]), source, size);\n\tserver->current_size += size;\n\treturn;\n}"
  },
  {
    "function_name": "ncp_add_dword_lh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "61-63",
    "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_add_dword",
          "args": [
            "server",
            "cpu_to_le32(x)"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_add_dword_lh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "61-63",
          "snippet": "static inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "x"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void ncp_add_dword_lh(struct ncp_server *server, __u32 x) {\n\tncp_add_dword(server, cpu_to_le32(x));\n}"
  },
  {
    "function_name": "ncp_add_be32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "54-59",
    "snippet": "static void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_unaligned",
          "args": [
            "cpu_to_be32(x)",
            "(__be32 *)(&(server->packet[server->current_size]))"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "put_unaligned_le8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/struct-funcs.c",
          "lines": "29-32",
          "snippet": "static inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/highmem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/highmem.h>\n\nstatic inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "x"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_server_locked",
          "args": [
            "server"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "assert_server_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "16-21",
          "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be32(struct ncp_server *server, __u32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be32(x), (__be32 *)(&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n}"
  },
  {
    "function_name": "ncp_add_dword",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "46-52",
    "snippet": "static void ncp_add_dword(struct ncp_server *server, __le32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le32 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n\treturn;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_unaligned",
          "args": [
            "x",
            "(__le32 *) (&(server->packet[server->current_size]))"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "put_unaligned_le8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/struct-funcs.c",
          "lines": "29-32",
          "snippet": "static inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/highmem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/highmem.h>\n\nstatic inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_server_locked",
          "args": [
            "server"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "assert_server_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "16-21",
          "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_dword(struct ncp_server *server, __le32 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le32 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 4;\n\treturn;\n}"
  },
  {
    "function_name": "ncp_add_be16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "39-44",
    "snippet": "static void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_unaligned",
          "args": [
            "cpu_to_be16(x)",
            "(__be16 *) (&(server->packet[server->current_size]))"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "put_unaligned_le8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/struct-funcs.c",
          "lines": "29-32",
          "snippet": "static inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/highmem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/highmem.h>\n\nstatic inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be16",
          "args": [
            "x"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_server_locked",
          "args": [
            "server"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "assert_server_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "16-21",
          "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_be16(struct ncp_server *server, __u16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(cpu_to_be16(x), (__be16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n}"
  },
  {
    "function_name": "ncp_add_word",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "31-37",
    "snippet": "static void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_unaligned",
          "args": [
            "x",
            "(__le16 *) (&(server->packet[server->current_size]))"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "put_unaligned_le8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/struct-funcs.c",
          "lines": "29-32",
          "snippet": "static inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/highmem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/highmem.h>\n\nstatic inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_server_locked",
          "args": [
            "server"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "assert_server_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "16-21",
          "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_word(struct ncp_server *server, __le16 x)\n{\n\tassert_server_locked(server);\n\tput_unaligned(x, (__le16 *) (&(server->packet[server->current_size])));\n\tserver->current_size += 2;\n\treturn;\n}"
  },
  {
    "function_name": "ncp_add_byte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "23-29",
    "snippet": "static void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert_server_locked",
          "args": [
            "server"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "assert_server_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
          "lines": "16-21",
          "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
          "includes": [
            "#include \"ncp_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic void ncp_add_byte(struct ncp_server *server, __u8 x)\n{\n\tassert_server_locked(server);\n\t*(__u8 *) (&(server->packet[server->current_size])) = x;\n\tserver->current_size += 1;\n\treturn;\n}"
  },
  {
    "function_name": "assert_server_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.c",
    "lines": "16-21",
    "snippet": "static inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}",
    "includes": [
      "#include \"ncp_fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_dbg",
          "args": [
            "1",
            "\"server not locked!\\n\""
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncp_fs.h\"\n\nstatic inline void assert_server_locked(struct ncp_server *server)\n{\n\tif (server->lock == 0) {\n\t\tncp_dbg(1, \"server not locked!\\n\");\n\t}\n}"
  }
]