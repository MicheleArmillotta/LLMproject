[
  {
    "function_name": "cifs_proc_clean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "698-700",
    "snippet": "inline void cifs_proc_clean(void)\n{\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\ninline void cifs_proc_clean(void)\n{\n}"
  },
  {
    "function_name": "cifs_proc_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "694-696",
    "snippet": "inline void cifs_proc_init(void)\n{\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\ninline void cifs_proc_init(void)\n{\n}"
  },
  {
    "function_name": "cifs_security_flags_proc_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "619-683",
    "snippet": "static ssize_t cifs_security_flags_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tint rc;\n\tunsigned int flags;\n\tchar flags_string[12];\n\tchar c;\n\tbool bv;\n\n\tif ((count < 1) || (count > 11))\n\t\treturn -EINVAL;\n\n\tmemset(flags_string, 0, 12);\n\n\tif (copy_from_user(flags_string, buffer, count))\n\t\treturn -EFAULT;\n\n\tif (count < 3) {\n\t\t/* single char or single char followed by null */\n\t\tc = flags_string[0];\n\t\tif (strtobool(&c, &bv) == 0) {\n\t\t\tglobal_secflags = bv ? CIFSSEC_MAX : CIFSSEC_DEF;\n\t\t\treturn count;\n\t\t} else if (!isdigit(c)) {\n\t\t\tcifs_dbg(VFS, \"Invalid SecurityFlags: %s\\n\",\n\t\t\t\t\tflags_string);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\t/* else we have a number */\n\trc = kstrtouint(flags_string, 0, &flags);\n\tif (rc) {\n\t\tcifs_dbg(VFS, \"Invalid SecurityFlags: %s\\n\",\n\t\t\t\tflags_string);\n\t\treturn rc;\n\t}\n\n\tcifs_dbg(FYI, \"sec flags 0x%x\\n\", flags);\n\n\tif (flags == 0)  {\n\t\tcifs_dbg(VFS, \"Invalid SecurityFlags: %s\\n\", flags_string);\n\t\treturn -EINVAL;\n\t}\n\n\tif (flags & ~CIFSSEC_MASK) {\n\t\tcifs_dbg(VFS, \"Unsupported security flags: 0x%x\\n\",\n\t\t\t flags & ~CIFSSEC_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tcifs_security_flags_handle_must_flags(&flags);\n\n\t/* flags look ok - update the global security flags for cifs module */\n\tglobal_secflags = flags;\n\tif (global_secflags & CIFSSEC_MUST_SIGN) {\n\t\t/* requiring signing implies signing is allowed */\n\t\tglobal_secflags |= CIFSSEC_MAY_SIGN;\n\t\tcifs_dbg(FYI, \"packet signing now required\\n\");\n\t} else if ((global_secflags & CIFSSEC_MAY_SIGN) == 0) {\n\t\tcifs_dbg(FYI, \"packet signing disabled\\n\");\n\t}\n\t/* BB should we turn on MAY flags for other MUST options? */\n\treturn count;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"packet signing disabled\\n\""
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"packet signing now required\\n\""
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_security_flags_handle_must_flags",
          "args": [
            "&flags"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "cifs_security_flags_handle_must_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
          "lines": "596-617",
          "snippet": "static void\ncifs_security_flags_handle_must_flags(unsigned int *flags)\n{\n\tunsigned int signflags = *flags & CIFSSEC_MUST_SIGN;\n\n\tif ((*flags & CIFSSEC_MUST_KRB5) == CIFSSEC_MUST_KRB5)\n\t\t*flags = CIFSSEC_MUST_KRB5;\n\telse if ((*flags & CIFSSEC_MUST_NTLMSSP) == CIFSSEC_MUST_NTLMSSP)\n\t\t*flags = CIFSSEC_MUST_NTLMSSP;\n\telse if ((*flags & CIFSSEC_MUST_NTLMV2) == CIFSSEC_MUST_NTLMV2)\n\t\t*flags = CIFSSEC_MUST_NTLMV2;\n\telse if ((*flags & CIFSSEC_MUST_NTLM) == CIFSSEC_MUST_NTLM)\n\t\t*flags = CIFSSEC_MUST_NTLM;\n\telse if (CIFSSEC_MUST_LANMAN &&\n\t\t (*flags & CIFSSEC_MUST_LANMAN) == CIFSSEC_MUST_LANMAN)\n\t\t*flags = CIFSSEC_MUST_LANMAN;\n\telse if (CIFSSEC_MUST_PLNTXT &&\n\t\t (*flags & CIFSSEC_MUST_PLNTXT) == CIFSSEC_MUST_PLNTXT)\n\t\t*flags = CIFSSEC_MUST_PLNTXT;\n\n\t*flags |= signflags;\n}",
          "includes": [
            "#include \"cifsfs.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsproto.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/ctype.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic void\ncifs_security_flags_handle_must_flags(unsigned int *flags)\n{\n\tunsigned int signflags = *flags & CIFSSEC_MUST_SIGN;\n\n\tif ((*flags & CIFSSEC_MUST_KRB5) == CIFSSEC_MUST_KRB5)\n\t\t*flags = CIFSSEC_MUST_KRB5;\n\telse if ((*flags & CIFSSEC_MUST_NTLMSSP) == CIFSSEC_MUST_NTLMSSP)\n\t\t*flags = CIFSSEC_MUST_NTLMSSP;\n\telse if ((*flags & CIFSSEC_MUST_NTLMV2) == CIFSSEC_MUST_NTLMV2)\n\t\t*flags = CIFSSEC_MUST_NTLMV2;\n\telse if ((*flags & CIFSSEC_MUST_NTLM) == CIFSSEC_MUST_NTLM)\n\t\t*flags = CIFSSEC_MUST_NTLM;\n\telse if (CIFSSEC_MUST_LANMAN &&\n\t\t (*flags & CIFSSEC_MUST_LANMAN) == CIFSSEC_MUST_LANMAN)\n\t\t*flags = CIFSSEC_MUST_LANMAN;\n\telse if (CIFSSEC_MUST_PLNTXT &&\n\t\t (*flags & CIFSSEC_MUST_PLNTXT) == CIFSSEC_MUST_PLNTXT)\n\t\t*flags = CIFSSEC_MUST_PLNTXT;\n\n\t*flags |= signflags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"Unsupported security flags: 0x%x\\n\"",
            "flags & ~CIFSSEC_MASK"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"Invalid SecurityFlags: %s\\n\"",
            "flags_string"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"sec flags 0x%x\\n\"",
            "flags"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"Invalid SecurityFlags: %s\\n\"",
            "flags_string"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtouint",
          "args": [
            "flags_string",
            "0",
            "&flags"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"Invalid SecurityFlags: %s\\n\"",
            "flags_string"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "c"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtobool",
          "args": [
            "&c",
            "&bv"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "flags_string",
            "buffer",
            "count"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "flags_string",
            "0",
            "12"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic ssize_t cifs_security_flags_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tint rc;\n\tunsigned int flags;\n\tchar flags_string[12];\n\tchar c;\n\tbool bv;\n\n\tif ((count < 1) || (count > 11))\n\t\treturn -EINVAL;\n\n\tmemset(flags_string, 0, 12);\n\n\tif (copy_from_user(flags_string, buffer, count))\n\t\treturn -EFAULT;\n\n\tif (count < 3) {\n\t\t/* single char or single char followed by null */\n\t\tc = flags_string[0];\n\t\tif (strtobool(&c, &bv) == 0) {\n\t\t\tglobal_secflags = bv ? CIFSSEC_MAX : CIFSSEC_DEF;\n\t\t\treturn count;\n\t\t} else if (!isdigit(c)) {\n\t\t\tcifs_dbg(VFS, \"Invalid SecurityFlags: %s\\n\",\n\t\t\t\t\tflags_string);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\t/* else we have a number */\n\trc = kstrtouint(flags_string, 0, &flags);\n\tif (rc) {\n\t\tcifs_dbg(VFS, \"Invalid SecurityFlags: %s\\n\",\n\t\t\t\tflags_string);\n\t\treturn rc;\n\t}\n\n\tcifs_dbg(FYI, \"sec flags 0x%x\\n\", flags);\n\n\tif (flags == 0)  {\n\t\tcifs_dbg(VFS, \"Invalid SecurityFlags: %s\\n\", flags_string);\n\t\treturn -EINVAL;\n\t}\n\n\tif (flags & ~CIFSSEC_MASK) {\n\t\tcifs_dbg(VFS, \"Unsupported security flags: 0x%x\\n\",\n\t\t\t flags & ~CIFSSEC_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tcifs_security_flags_handle_must_flags(&flags);\n\n\t/* flags look ok - update the global security flags for cifs module */\n\tglobal_secflags = flags;\n\tif (global_secflags & CIFSSEC_MUST_SIGN) {\n\t\t/* requiring signing implies signing is allowed */\n\t\tglobal_secflags |= CIFSSEC_MAY_SIGN;\n\t\tcifs_dbg(FYI, \"packet signing now required\\n\");\n\t} else if ((global_secflags & CIFSSEC_MAY_SIGN) == 0) {\n\t\tcifs_dbg(FYI, \"packet signing disabled\\n\");\n\t}\n\t/* BB should we turn on MAY flags for other MUST options? */\n\treturn count;\n}"
  },
  {
    "function_name": "cifs_security_flags_handle_must_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "596-617",
    "snippet": "static void\ncifs_security_flags_handle_must_flags(unsigned int *flags)\n{\n\tunsigned int signflags = *flags & CIFSSEC_MUST_SIGN;\n\n\tif ((*flags & CIFSSEC_MUST_KRB5) == CIFSSEC_MUST_KRB5)\n\t\t*flags = CIFSSEC_MUST_KRB5;\n\telse if ((*flags & CIFSSEC_MUST_NTLMSSP) == CIFSSEC_MUST_NTLMSSP)\n\t\t*flags = CIFSSEC_MUST_NTLMSSP;\n\telse if ((*flags & CIFSSEC_MUST_NTLMV2) == CIFSSEC_MUST_NTLMV2)\n\t\t*flags = CIFSSEC_MUST_NTLMV2;\n\telse if ((*flags & CIFSSEC_MUST_NTLM) == CIFSSEC_MUST_NTLM)\n\t\t*flags = CIFSSEC_MUST_NTLM;\n\telse if (CIFSSEC_MUST_LANMAN &&\n\t\t (*flags & CIFSSEC_MUST_LANMAN) == CIFSSEC_MUST_LANMAN)\n\t\t*flags = CIFSSEC_MUST_LANMAN;\n\telse if (CIFSSEC_MUST_PLNTXT &&\n\t\t (*flags & CIFSSEC_MUST_PLNTXT) == CIFSSEC_MUST_PLNTXT)\n\t\t*flags = CIFSSEC_MUST_PLNTXT;\n\n\t*flags |= signflags;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic void\ncifs_security_flags_handle_must_flags(unsigned int *flags)\n{\n\tunsigned int signflags = *flags & CIFSSEC_MUST_SIGN;\n\n\tif ((*flags & CIFSSEC_MUST_KRB5) == CIFSSEC_MUST_KRB5)\n\t\t*flags = CIFSSEC_MUST_KRB5;\n\telse if ((*flags & CIFSSEC_MUST_NTLMSSP) == CIFSSEC_MUST_NTLMSSP)\n\t\t*flags = CIFSSEC_MUST_NTLMSSP;\n\telse if ((*flags & CIFSSEC_MUST_NTLMV2) == CIFSSEC_MUST_NTLMV2)\n\t\t*flags = CIFSSEC_MUST_NTLMV2;\n\telse if ((*flags & CIFSSEC_MUST_NTLM) == CIFSSEC_MUST_NTLM)\n\t\t*flags = CIFSSEC_MUST_NTLM;\n\telse if (CIFSSEC_MUST_LANMAN &&\n\t\t (*flags & CIFSSEC_MUST_LANMAN) == CIFSSEC_MUST_LANMAN)\n\t\t*flags = CIFSSEC_MUST_LANMAN;\n\telse if (CIFSSEC_MUST_PLNTXT &&\n\t\t (*flags & CIFSSEC_MUST_PLNTXT) == CIFSSEC_MUST_PLNTXT)\n\t\t*flags = CIFSSEC_MUST_PLNTXT;\n\n\t*flags |= signflags;\n}"
  },
  {
    "function_name": "cifs_security_flags_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "586-589",
    "snippet": "static int cifs_security_flags_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_security_flags_proc_show, NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "cifs_security_flags_proc_show",
            "NULL"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_security_flags_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_security_flags_proc_show, NULL);\n}"
  },
  {
    "function_name": "cifs_security_flags_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "580-584",
    "snippet": "static int cifs_security_flags_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"0x%x\\n\", global_secflags);\n\treturn 0;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"0x%x\\n\"",
            "global_secflags"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_security_flags_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"0x%x\\n\", global_secflags);\n\treturn 0;\n}"
  },
  {
    "function_name": "traceSMB_proc_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "551-569",
    "snippet": "static ssize_t traceSMB_proc_write(struct file *file, const char __user *buffer,\n\t\tsize_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\trc = strtobool(&c, &bv);\n\tif (rc)\n\t\treturn rc;\n\n\ttraceSMB = bv;\n\n\treturn count;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtobool",
          "args": [
            "&c",
            "&bv"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "c",
            "buffer"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic ssize_t traceSMB_proc_write(struct file *file, const char __user *buffer,\n\t\tsize_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\trc = strtobool(&c, &bv);\n\tif (rc)\n\t\treturn rc;\n\n\ttraceSMB = bv;\n\n\treturn count;\n}"
  },
  {
    "function_name": "traceSMB_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "546-549",
    "snippet": "static int traceSMB_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, traceSMB_proc_show, NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "traceSMB_proc_show",
            "NULL"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int traceSMB_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, traceSMB_proc_show, NULL);\n}"
  },
  {
    "function_name": "traceSMB_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "540-544",
    "snippet": "static int traceSMB_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", traceSMB);\n\treturn 0;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%d\\n\"",
            "traceSMB"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int traceSMB_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", traceSMB);\n\treturn 0;\n}"
  },
  {
    "function_name": "cifs_lookup_cache_proc_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "511-529",
    "snippet": "static ssize_t cifs_lookup_cache_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\trc = strtobool(&c, &bv);\n\tif (rc)\n\t\treturn rc;\n\n\tlookupCacheEnabled = bv;\n\n\treturn count;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtobool",
          "args": [
            "&c",
            "&bv"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "c",
            "buffer"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic ssize_t cifs_lookup_cache_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\trc = strtobool(&c, &bv);\n\tif (rc)\n\t\treturn rc;\n\n\tlookupCacheEnabled = bv;\n\n\treturn count;\n}"
  },
  {
    "function_name": "cifs_lookup_cache_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "506-509",
    "snippet": "static int cifs_lookup_cache_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_lookup_cache_proc_show, NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "cifs_lookup_cache_proc_show",
            "NULL"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_lookup_cache_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_lookup_cache_proc_show, NULL);\n}"
  },
  {
    "function_name": "cifs_lookup_cache_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "500-504",
    "snippet": "static int cifs_lookup_cache_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", lookupCacheEnabled);\n\treturn 0;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%d\\n\"",
            "lookupCacheEnabled"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_lookup_cache_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", lookupCacheEnabled);\n\treturn 0;\n}"
  },
  {
    "function_name": "cifs_linux_ext_proc_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "471-489",
    "snippet": "static ssize_t cifs_linux_ext_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\trc = strtobool(&c, &bv);\n\tif (rc)\n\t\treturn rc;\n\n\tlinuxExtEnabled = bv;\n\n\treturn count;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtobool",
          "args": [
            "&c",
            "&bv"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "c",
            "buffer"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic ssize_t cifs_linux_ext_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\trc = strtobool(&c, &bv);\n\tif (rc)\n\t\treturn rc;\n\n\tlinuxExtEnabled = bv;\n\n\treturn count;\n}"
  },
  {
    "function_name": "cifs_linux_ext_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "466-469",
    "snippet": "static int cifs_linux_ext_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_linux_ext_proc_show, NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "cifs_linux_ext_proc_show",
            "NULL"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_linux_ext_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_linux_ext_proc_show, NULL);\n}"
  },
  {
    "function_name": "cifs_linux_ext_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "460-464",
    "snippet": "static int cifs_linux_ext_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", linuxExtEnabled);\n\treturn 0;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%d\\n\"",
            "linuxExtEnabled"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_linux_ext_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", linuxExtEnabled);\n\treturn 0;\n}"
  },
  {
    "function_name": "cifsFYI_proc_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "433-449",
    "snippet": "static ssize_t cifsFYI_proc_write(struct file *file, const char __user *buffer,\n\t\tsize_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\tif (strtobool(&c, &bv) == 0)\n\t\tcifsFYI = bv;\n\telse if ((c > '1') && (c <= '9'))\n\t\tcifsFYI = (int) (c - '0'); /* see cifs_debug.h for meanings */\n\n\treturn count;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtobool",
          "args": [
            "&c",
            "&bv"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "c",
            "buffer"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic ssize_t cifsFYI_proc_write(struct file *file, const char __user *buffer,\n\t\tsize_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\tif (strtobool(&c, &bv) == 0)\n\t\tcifsFYI = bv;\n\telse if ((c > '1') && (c <= '9'))\n\t\tcifsFYI = (int) (c - '0'); /* see cifs_debug.h for meanings */\n\n\treturn count;\n}"
  },
  {
    "function_name": "cifsFYI_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "428-431",
    "snippet": "static int cifsFYI_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifsFYI_proc_show, NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "cifsFYI_proc_show",
            "NULL"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifsFYI_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifsFYI_proc_show, NULL);\n}"
  },
  {
    "function_name": "cifsFYI_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "422-426",
    "snippet": "static int cifsFYI_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", cifsFYI);\n\treturn 0;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%d\\n\"",
            "cifsFYI"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifsFYI_proc_show(struct seq_file *m, void *v)\n{\n\tseq_printf(m, \"%d\\n\", cifsFYI);\n\treturn 0;\n}"
  },
  {
    "function_name": "cifs_proc_clean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "404-420",
    "snippet": "void\ncifs_proc_clean(void)\n{\n\tif (proc_fs_cifs == NULL)\n\t\treturn;\n\n\tremove_proc_entry(\"DebugData\", proc_fs_cifs);\n\tremove_proc_entry(\"cifsFYI\", proc_fs_cifs);\n\tremove_proc_entry(\"traceSMB\", proc_fs_cifs);\n#ifdef CONFIG_CIFS_STATS\n\tremove_proc_entry(\"Stats\", proc_fs_cifs);\n#endif\n\tremove_proc_entry(\"SecurityFlags\", proc_fs_cifs);\n\tremove_proc_entry(\"LinuxExtensionsEnabled\", proc_fs_cifs);\n\tremove_proc_entry(\"LookupCacheEnabled\", proc_fs_cifs);\n\tremove_proc_entry(\"fs/cifs\", NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_entry",
          "args": [
            "\"fs/cifs\"",
            "NULL"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "remove_proc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "523-554",
          "snippet": "void remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nvoid remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid\ncifs_proc_clean(void)\n{\n\tif (proc_fs_cifs == NULL)\n\t\treturn;\n\n\tremove_proc_entry(\"DebugData\", proc_fs_cifs);\n\tremove_proc_entry(\"cifsFYI\", proc_fs_cifs);\n\tremove_proc_entry(\"traceSMB\", proc_fs_cifs);\n#ifdef CONFIG_CIFS_STATS\n\tremove_proc_entry(\"Stats\", proc_fs_cifs);\n#endif\n\tremove_proc_entry(\"SecurityFlags\", proc_fs_cifs);\n\tremove_proc_entry(\"LinuxExtensionsEnabled\", proc_fs_cifs);\n\tremove_proc_entry(\"LookupCacheEnabled\", proc_fs_cifs);\n\tremove_proc_entry(\"fs/cifs\", NULL);\n}"
  },
  {
    "function_name": "cifs_proc_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "382-402",
    "snippet": "void\ncifs_proc_init(void)\n{\n\tproc_fs_cifs = proc_mkdir(\"fs/cifs\", NULL);\n\tif (proc_fs_cifs == NULL)\n\t\treturn;\n\n\tproc_create(\"DebugData\", 0, proc_fs_cifs, &cifs_debug_data_proc_fops);\n\n#ifdef CONFIG_CIFS_STATS\n\tproc_create(\"Stats\", 0, proc_fs_cifs, &cifs_stats_proc_fops);\n#endif /* STATS */\n\tproc_create(\"cifsFYI\", 0, proc_fs_cifs, &cifsFYI_proc_fops);\n\tproc_create(\"traceSMB\", 0, proc_fs_cifs, &traceSMB_proc_fops);\n\tproc_create(\"LinuxExtensionsEnabled\", 0, proc_fs_cifs,\n\t\t    &cifs_linux_ext_proc_fops);\n\tproc_create(\"SecurityFlags\", 0, proc_fs_cifs,\n\t\t    &cifs_security_flags_proc_fops);\n\tproc_create(\"LookupCacheEnabled\", 0, proc_fs_cifs,\n\t\t    &cifs_lookup_cache_proc_fops);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"LookupCacheEnabled\"",
            "0",
            "proc_fs_cifs",
            "&cifs_lookup_cache_proc_fops"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "__proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "355-391",
          "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_mkdir",
          "args": [
            "\"fs/cifs\"",
            "NULL"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "proc_mkdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "451-455",
          "snippet": "struct proc_dir_entry *proc_mkdir(const char *name,\n\t\tstruct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, 0, parent, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstruct proc_dir_entry *proc_mkdir(const char *name,\n\t\tstruct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, 0, parent, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid\ncifs_proc_init(void)\n{\n\tproc_fs_cifs = proc_mkdir(\"fs/cifs\", NULL);\n\tif (proc_fs_cifs == NULL)\n\t\treturn;\n\n\tproc_create(\"DebugData\", 0, proc_fs_cifs, &cifs_debug_data_proc_fops);\n\n#ifdef CONFIG_CIFS_STATS\n\tproc_create(\"Stats\", 0, proc_fs_cifs, &cifs_stats_proc_fops);\n#endif /* STATS */\n\tproc_create(\"cifsFYI\", 0, proc_fs_cifs, &cifsFYI_proc_fops);\n\tproc_create(\"traceSMB\", 0, proc_fs_cifs, &traceSMB_proc_fops);\n\tproc_create(\"LinuxExtensionsEnabled\", 0, proc_fs_cifs,\n\t\t    &cifs_linux_ext_proc_fops);\n\tproc_create(\"SecurityFlags\", 0, proc_fs_cifs,\n\t\t    &cifs_security_flags_proc_fops);\n\tproc_create(\"LookupCacheEnabled\", 0, proc_fs_cifs,\n\t\t    &cifs_lookup_cache_proc_fops);\n}"
  },
  {
    "function_name": "cifs_stats_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "360-363",
    "snippet": "static int cifs_stats_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_stats_proc_show, NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "cifs_stats_proc_show",
            "NULL"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_stats_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_stats_proc_show, NULL);\n}"
  },
  {
    "function_name": "cifs_stats_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "298-358",
    "snippet": "static int cifs_stats_proc_show(struct seq_file *m, void *v)\n{\n\tint i;\n\tstruct list_head *tmp1, *tmp2, *tmp3;\n\tstruct TCP_Server_Info *server;\n\tstruct cifs_ses *ses;\n\tstruct cifs_tcon *tcon;\n\n\tseq_printf(m,\n\t\t\t\"Resources in use\\nCIFS Session: %d\\n\",\n\t\t\tsesInfoAllocCount.counter);\n\tseq_printf(m, \"Share (unique mount targets): %d\\n\",\n\t\t\ttconInfoAllocCount.counter);\n\tseq_printf(m, \"SMB Request/Response Buffer: %d Pool size: %d\\n\",\n\t\t\tbufAllocCount.counter,\n\t\t\tcifs_min_rcv + tcpSesAllocCount.counter);\n\tseq_printf(m, \"SMB Small Req/Resp Buffer: %d Pool size: %d\\n\",\n\t\t\tsmBufAllocCount.counter, cifs_min_small);\n#ifdef CONFIG_CIFS_STATS2\n\tseq_printf(m, \"Total Large %d Small %d Allocations\\n\",\n\t\t\t\tatomic_read(&totBufAllocCount),\n\t\t\t\tatomic_read(&totSmBufAllocCount));\n#endif /* CONFIG_CIFS_STATS2 */\n\n\tseq_printf(m, \"Operations (MIDs): %d\\n\", atomic_read(&midCount));\n\tseq_printf(m,\n\t\t\"\\n%d session %d share reconnects\\n\",\n\t\ttcpSesReconnectCount.counter, tconInfoReconnectCount.counter);\n\n\tseq_printf(m,\n\t\t\"Total vfs operations: %d maximum at one time: %d\\n\",\n\t\tGlobalCurrentXid, GlobalMaxActiveXid);\n\n\ti = 0;\n\tspin_lock(&cifs_tcp_ses_lock);\n\tlist_for_each(tmp1, &cifs_tcp_ses_list) {\n\t\tserver = list_entry(tmp1, struct TCP_Server_Info,\n\t\t\t\t    tcp_ses_list);\n\t\tlist_for_each(tmp2, &server->smb_ses_list) {\n\t\t\tses = list_entry(tmp2, struct cifs_ses,\n\t\t\t\t\t smb_ses_list);\n\t\t\tlist_for_each(tmp3, &ses->tcon_list) {\n\t\t\t\ttcon = list_entry(tmp3,\n\t\t\t\t\t\t  struct cifs_tcon,\n\t\t\t\t\t\t  tcon_list);\n\t\t\t\ti++;\n\t\t\t\tseq_printf(m, \"\\n%d) %s\", i, tcon->treeName);\n\t\t\t\tif (tcon->need_reconnect)\n\t\t\t\t\tseq_puts(m, \"\\tDISCONNECTED \");\n\t\t\t\tseq_printf(m, \"\\nSMBs: %d\",\n\t\t\t\t\t   atomic_read(&tcon->num_smbs_sent));\n\t\t\t\tif (server->ops->print_stats)\n\t\t\t\t\tserver->ops->print_stats(m, tcon);\n\t\t\t}\n\t\t}\n\t}\n\tspin_unlock(&cifs_tcp_ses_lock);\n\n\tseq_putc(m, '\\n');\n\treturn 0;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_putc",
          "args": [
            "m",
            "'\\n'"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "seq_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "648-655",
          "snippet": "int seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cifs_tcp_ses_lock"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "server->ops->print_stats",
          "args": [
            "m",
            "tcon"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\nSMBs: %d\"",
            "atomic_read(&tcon->num_smbs_sent)"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&tcon->num_smbs_sent"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"\\tDISCONNECTED \""
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp3",
            "structcifs_tcon",
            "tcon_list"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp3",
            "&ses->tcon_list"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp2",
            "structcifs_ses",
            "smb_ses_list"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp2",
            "&server->smb_ses_list"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp1",
            "structTCP_Server_Info",
            "tcp_ses_list"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp1",
            "&cifs_tcp_ses_list"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cifs_tcp_ses_lock"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&midCount"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&totSmBufAllocCount"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&totBufAllocCount"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_stats_proc_show(struct seq_file *m, void *v)\n{\n\tint i;\n\tstruct list_head *tmp1, *tmp2, *tmp3;\n\tstruct TCP_Server_Info *server;\n\tstruct cifs_ses *ses;\n\tstruct cifs_tcon *tcon;\n\n\tseq_printf(m,\n\t\t\t\"Resources in use\\nCIFS Session: %d\\n\",\n\t\t\tsesInfoAllocCount.counter);\n\tseq_printf(m, \"Share (unique mount targets): %d\\n\",\n\t\t\ttconInfoAllocCount.counter);\n\tseq_printf(m, \"SMB Request/Response Buffer: %d Pool size: %d\\n\",\n\t\t\tbufAllocCount.counter,\n\t\t\tcifs_min_rcv + tcpSesAllocCount.counter);\n\tseq_printf(m, \"SMB Small Req/Resp Buffer: %d Pool size: %d\\n\",\n\t\t\tsmBufAllocCount.counter, cifs_min_small);\n#ifdef CONFIG_CIFS_STATS2\n\tseq_printf(m, \"Total Large %d Small %d Allocations\\n\",\n\t\t\t\tatomic_read(&totBufAllocCount),\n\t\t\t\tatomic_read(&totSmBufAllocCount));\n#endif /* CONFIG_CIFS_STATS2 */\n\n\tseq_printf(m, \"Operations (MIDs): %d\\n\", atomic_read(&midCount));\n\tseq_printf(m,\n\t\t\"\\n%d session %d share reconnects\\n\",\n\t\ttcpSesReconnectCount.counter, tconInfoReconnectCount.counter);\n\n\tseq_printf(m,\n\t\t\"Total vfs operations: %d maximum at one time: %d\\n\",\n\t\tGlobalCurrentXid, GlobalMaxActiveXid);\n\n\ti = 0;\n\tspin_lock(&cifs_tcp_ses_lock);\n\tlist_for_each(tmp1, &cifs_tcp_ses_list) {\n\t\tserver = list_entry(tmp1, struct TCP_Server_Info,\n\t\t\t\t    tcp_ses_list);\n\t\tlist_for_each(tmp2, &server->smb_ses_list) {\n\t\t\tses = list_entry(tmp2, struct cifs_ses,\n\t\t\t\t\t smb_ses_list);\n\t\t\tlist_for_each(tmp3, &ses->tcon_list) {\n\t\t\t\ttcon = list_entry(tmp3,\n\t\t\t\t\t\t  struct cifs_tcon,\n\t\t\t\t\t\t  tcon_list);\n\t\t\t\ti++;\n\t\t\t\tseq_printf(m, \"\\n%d) %s\", i, tcon->treeName);\n\t\t\t\tif (tcon->need_reconnect)\n\t\t\t\t\tseq_puts(m, \"\\tDISCONNECTED \");\n\t\t\t\tseq_printf(m, \"\\nSMBs: %d\",\n\t\t\t\t\t   atomic_read(&tcon->num_smbs_sent));\n\t\t\t\tif (server->ops->print_stats)\n\t\t\t\t\tserver->ops->print_stats(m, tcon);\n\t\t\t}\n\t\t}\n\t}\n\tspin_unlock(&cifs_tcp_ses_lock);\n\n\tseq_putc(m, '\\n');\n\treturn 0;\n}"
  },
  {
    "function_name": "cifs_stats_proc_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "255-296",
    "snippet": "static ssize_t cifs_stats_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\tstruct list_head *tmp1, *tmp2, *tmp3;\n\tstruct TCP_Server_Info *server;\n\tstruct cifs_ses *ses;\n\tstruct cifs_tcon *tcon;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\tif (strtobool(&c, &bv) == 0) {\n#ifdef CONFIG_CIFS_STATS2\n\t\tatomic_set(&totBufAllocCount, 0);\n\t\tatomic_set(&totSmBufAllocCount, 0);\n#endif /* CONFIG_CIFS_STATS2 */\n\t\tspin_lock(&cifs_tcp_ses_lock);\n\t\tlist_for_each(tmp1, &cifs_tcp_ses_list) {\n\t\t\tserver = list_entry(tmp1, struct TCP_Server_Info,\n\t\t\t\t\t    tcp_ses_list);\n\t\t\tlist_for_each(tmp2, &server->smb_ses_list) {\n\t\t\t\tses = list_entry(tmp2, struct cifs_ses,\n\t\t\t\t\t\t smb_ses_list);\n\t\t\t\tlist_for_each(tmp3, &ses->tcon_list) {\n\t\t\t\t\ttcon = list_entry(tmp3,\n\t\t\t\t\t\t\t  struct cifs_tcon,\n\t\t\t\t\t\t\t  tcon_list);\n\t\t\t\t\tatomic_set(&tcon->num_smbs_sent, 0);\n\t\t\t\t\tif (server->ops->clear_stats)\n\t\t\t\t\t\tserver->ops->clear_stats(tcon);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tspin_unlock(&cifs_tcp_ses_lock);\n\t}\n\n\treturn count;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cifs_tcp_ses_lock"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "server->ops->clear_stats",
          "args": [
            "tcon"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&tcon->num_smbs_sent",
            "0"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp3",
            "structcifs_tcon",
            "tcon_list"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp3",
            "&ses->tcon_list"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp2",
            "structcifs_ses",
            "smb_ses_list"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp2",
            "&server->smb_ses_list"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp1",
            "structTCP_Server_Info",
            "tcp_ses_list"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp1",
            "&cifs_tcp_ses_list"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cifs_tcp_ses_lock"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&totSmBufAllocCount",
            "0"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&totBufAllocCount",
            "0"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtobool",
          "args": [
            "&c",
            "&bv"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "c",
            "buffer"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic ssize_t cifs_stats_proc_write(struct file *file,\n\t\tconst char __user *buffer, size_t count, loff_t *ppos)\n{\n\tchar c;\n\tbool bv;\n\tint rc;\n\tstruct list_head *tmp1, *tmp2, *tmp3;\n\tstruct TCP_Server_Info *server;\n\tstruct cifs_ses *ses;\n\tstruct cifs_tcon *tcon;\n\n\trc = get_user(c, buffer);\n\tif (rc)\n\t\treturn rc;\n\n\tif (strtobool(&c, &bv) == 0) {\n#ifdef CONFIG_CIFS_STATS2\n\t\tatomic_set(&totBufAllocCount, 0);\n\t\tatomic_set(&totSmBufAllocCount, 0);\n#endif /* CONFIG_CIFS_STATS2 */\n\t\tspin_lock(&cifs_tcp_ses_lock);\n\t\tlist_for_each(tmp1, &cifs_tcp_ses_list) {\n\t\t\tserver = list_entry(tmp1, struct TCP_Server_Info,\n\t\t\t\t\t    tcp_ses_list);\n\t\t\tlist_for_each(tmp2, &server->smb_ses_list) {\n\t\t\t\tses = list_entry(tmp2, struct cifs_ses,\n\t\t\t\t\t\t smb_ses_list);\n\t\t\t\tlist_for_each(tmp3, &ses->tcon_list) {\n\t\t\t\t\ttcon = list_entry(tmp3,\n\t\t\t\t\t\t\t  struct cifs_tcon,\n\t\t\t\t\t\t\t  tcon_list);\n\t\t\t\t\tatomic_set(&tcon->num_smbs_sent, 0);\n\t\t\t\t\tif (server->ops->clear_stats)\n\t\t\t\t\t\tserver->ops->clear_stats(tcon);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tspin_unlock(&cifs_tcp_ses_lock);\n\t}\n\n\treturn count;\n}"
  },
  {
    "function_name": "cifs_debug_data_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "241-244",
    "snippet": "static int cifs_debug_data_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_debug_data_proc_show, NULL);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "cifs_debug_data_proc_show",
            "NULL"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_debug_data_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, cifs_debug_data_proc_show, NULL);\n}"
  },
  {
    "function_name": "cifs_debug_data_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "110-239",
    "snippet": "static int cifs_debug_data_proc_show(struct seq_file *m, void *v)\n{\n\tstruct list_head *tmp1, *tmp2, *tmp3;\n\tstruct mid_q_entry *mid_entry;\n\tstruct TCP_Server_Info *server;\n\tstruct cifs_ses *ses;\n\tstruct cifs_tcon *tcon;\n\tint i, j;\n\t__u32 dev_type;\n\n\tseq_puts(m,\n\t\t    \"Display Internal CIFS Data Structures for Debugging\\n\"\n\t\t    \"---------------------------------------------------\\n\");\n\tseq_printf(m, \"CIFS Version %s\\n\", CIFS_VERSION);\n\tseq_printf(m, \"Features:\");\n#ifdef CONFIG_CIFS_DFS_UPCALL\n\tseq_printf(m, \" dfs\");\n#endif\n#ifdef CONFIG_CIFS_FSCACHE\n\tseq_printf(m, \" fscache\");\n#endif\n#ifdef CONFIG_CIFS_WEAK_PW_HASH\n\tseq_printf(m, \" lanman\");\n#endif\n#ifdef CONFIG_CIFS_POSIX\n\tseq_printf(m, \" posix\");\n#endif\n#ifdef CONFIG_CIFS_UPCALL\n\tseq_printf(m, \" spnego\");\n#endif\n#ifdef CONFIG_CIFS_XATTR\n\tseq_printf(m, \" xattr\");\n#endif\n#ifdef CONFIG_CIFS_ACL\n\tseq_printf(m, \" acl\");\n#endif\n\tseq_putc(m, '\\n');\n\tseq_printf(m, \"Active VFS Requests: %d\\n\", GlobalTotalActiveXid);\n\tseq_printf(m, \"Servers:\");\n\n\ti = 0;\n\tspin_lock(&cifs_tcp_ses_lock);\n\tlist_for_each(tmp1, &cifs_tcp_ses_list) {\n\t\tserver = list_entry(tmp1, struct TCP_Server_Info,\n\t\t\t\t    tcp_ses_list);\n\t\ti++;\n\t\tlist_for_each(tmp2, &server->smb_ses_list) {\n\t\t\tses = list_entry(tmp2, struct cifs_ses,\n\t\t\t\t\t smb_ses_list);\n\t\t\tif ((ses->serverDomain == NULL) ||\n\t\t\t\t(ses->serverOS == NULL) ||\n\t\t\t\t(ses->serverNOS == NULL)) {\n\t\t\t\tseq_printf(m, \"\\n%d) entry for %s not fully \"\n\t\t\t\t\t   \"displayed\\n\\t\", i, ses->serverName);\n\t\t\t} else {\n\t\t\t\tseq_printf(m,\n\t\t\t\t    \"\\n%d) Name: %s  Domain: %s Uses: %d OS:\"\n\t\t\t\t    \" %s\\n\\tNOS: %s\\tCapability: 0x%x\\n\\tSMB\"\n\t\t\t\t    \" session status: %d\\t\",\n\t\t\t\ti, ses->serverName, ses->serverDomain,\n\t\t\t\tses->ses_count, ses->serverOS, ses->serverNOS,\n\t\t\t\tses->capabilities, ses->status);\n\t\t\t}\n\t\t\tseq_printf(m, \"TCP status: %d\\n\\tLocal Users To \"\n\t\t\t\t   \"Server: %d SecMode: 0x%x Req On Wire: %d\",\n\t\t\t\t   server->tcpStatus, server->srv_count,\n\t\t\t\t   server->sec_mode, in_flight(server));\n\n#ifdef CONFIG_CIFS_STATS2\n\t\t\tseq_printf(m, \" In Send: %d In MaxReq Wait: %d\",\n\t\t\t\tatomic_read(&server->in_send),\n\t\t\t\tatomic_read(&server->num_waiters));\n#endif\n\n\t\t\tseq_puts(m, \"\\n\\tShares:\");\n\t\t\tj = 0;\n\t\t\tlist_for_each(tmp3, &ses->tcon_list) {\n\t\t\t\ttcon = list_entry(tmp3, struct cifs_tcon,\n\t\t\t\t\t\t  tcon_list);\n\t\t\t\t++j;\n\t\t\t\tdev_type = le32_to_cpu(tcon->fsDevInfo.DeviceType);\n\t\t\t\tseq_printf(m, \"\\n\\t%d) %s Mounts: %d \", j,\n\t\t\t\t\t   tcon->treeName, tcon->tc_count);\n\t\t\t\tif (tcon->nativeFileSystem) {\n\t\t\t\t\tseq_printf(m, \"Type: %s \",\n\t\t\t\t\t\t   tcon->nativeFileSystem);\n\t\t\t\t}\n\t\t\t\tseq_printf(m, \"DevInfo: 0x%x Attributes: 0x%x\"\n\t\t\t\t\t\"\\n\\tPathComponentMax: %d Status: %d\",\n\t\t\t\t\tle32_to_cpu(tcon->fsDevInfo.DeviceCharacteristics),\n\t\t\t\t\tle32_to_cpu(tcon->fsAttrInfo.Attributes),\n\t\t\t\t\tle32_to_cpu(tcon->fsAttrInfo.MaxPathNameComponentLength),\n\t\t\t\t\ttcon->tidStatus);\n\t\t\t\tif (dev_type == FILE_DEVICE_DISK)\n\t\t\t\t\tseq_puts(m, \" type: DISK \");\n\t\t\t\telse if (dev_type == FILE_DEVICE_CD_ROM)\n\t\t\t\t\tseq_puts(m, \" type: CDROM \");\n\t\t\t\telse\n\t\t\t\t\tseq_printf(m, \" type: %d \", dev_type);\n\t\t\t\tif (server->ops->dump_share_caps)\n\t\t\t\t\tserver->ops->dump_share_caps(m, tcon);\n\n\t\t\t\tif (tcon->need_reconnect)\n\t\t\t\t\tseq_puts(m, \"\\tDISCONNECTED \");\n\t\t\t\tseq_putc(m, '\\n');\n\t\t\t}\n\n\t\t\tseq_puts(m, \"\\n\\tMIDs:\\n\");\n\n\t\t\tspin_lock(&GlobalMid_Lock);\n\t\t\tlist_for_each(tmp3, &server->pending_mid_q) {\n\t\t\t\tmid_entry = list_entry(tmp3, struct mid_q_entry,\n\t\t\t\t\tqhead);\n\t\t\t\tseq_printf(m, \"\\tState: %d com: %d pid:\"\n\t\t\t\t\t      \" %d cbdata: %p mid %llu\\n\",\n\t\t\t\t\t      mid_entry->mid_state,\n\t\t\t\t\t      le16_to_cpu(mid_entry->command),\n\t\t\t\t\t      mid_entry->pid,\n\t\t\t\t\t      mid_entry->callback_data,\n\t\t\t\t\t      mid_entry->mid);\n\t\t\t}\n\t\t\tspin_unlock(&GlobalMid_Lock);\n\t\t}\n\t}\n\tspin_unlock(&cifs_tcp_ses_lock);\n\tseq_putc(m, '\\n');\n\n\t/* BB add code to dump additional info such as TCP session info now */\n\treturn 0;\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_putc",
          "args": [
            "m",
            "'\\n'"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "seq_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "648-655",
          "snippet": "int seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cifs_tcp_ses_lock"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\tState: %d com: %d pid:\"\n\t\t\t\t\t      \" %d cbdata: %p mid %llu\\n\"",
            "mid_entry->mid_state",
            "le16_to_cpu(mid_entry->command)",
            "mid_entry->pid",
            "mid_entry->callback_data",
            "mid_entry->mid"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le16_to_cpu",
          "args": [
            "mid_entry->command"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "sle16_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "48-51",
          "snippet": "static inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp3",
            "structmid_q_entry",
            "qhead"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp3",
            "&server->pending_mid_q"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&GlobalMid_Lock"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"\\n\\tMIDs:\\n\""
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "server->ops->dump_share_caps",
          "args": [
            "m",
            "tcon"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "tcon->fsAttrInfo.MaxPathNameComponentLength"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp3",
            "structcifs_tcon",
            "tcon_list"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp3",
            "&ses->tcon_list"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&server->num_waiters"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&server->in_send"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_flight",
          "args": [
            "server"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "in_flight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifsglob.h",
          "lines": "621-629",
          "snippet": "static inline unsigned int\nin_flight(struct TCP_Server_Info *server)\n{\n\tunsigned int num;\n\tspin_lock(&server->req_lock);\n\tnum = server->in_flight;\n\tspin_unlock(&server->req_lock);\n\treturn num;\n}",
          "includes": [
            "#include \"cifspdu.h\"",
            "#include \"smb2pdu.h\"",
            "#include <uapi/linux/cifs/cifs_mount.h>",
            "#include <linux/scatterlist.h>",
            "#include <crypto/internal/hash.h>",
            "#include \"cifsacl.h\"",
            "#include \"cifs_fs_sb.h\"",
            "#include <linux/workqueue.h>",
            "#include <linux/mempool.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifspdu.h\"\n#include \"smb2pdu.h\"\n#include <uapi/linux/cifs/cifs_mount.h>\n#include <linux/scatterlist.h>\n#include <crypto/internal/hash.h>\n#include \"cifsacl.h\"\n#include \"cifs_fs_sb.h\"\n#include <linux/workqueue.h>\n#include <linux/mempool.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n\nstatic inline unsigned int\nin_flight(struct TCP_Server_Info *server)\n{\n\tunsigned int num;\n\tspin_lock(&server->req_lock);\n\tnum = server->in_flight;\n\tspin_unlock(&server->req_lock);\n\treturn num;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp2",
            "structcifs_ses",
            "smb_ses_list"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp2",
            "&server->smb_ses_list"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp1",
            "structTCP_Server_Info",
            "tcp_ses_list"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp1",
            "&cifs_tcp_ses_list"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstatic int cifs_debug_data_proc_show(struct seq_file *m, void *v)\n{\n\tstruct list_head *tmp1, *tmp2, *tmp3;\n\tstruct mid_q_entry *mid_entry;\n\tstruct TCP_Server_Info *server;\n\tstruct cifs_ses *ses;\n\tstruct cifs_tcon *tcon;\n\tint i, j;\n\t__u32 dev_type;\n\n\tseq_puts(m,\n\t\t    \"Display Internal CIFS Data Structures for Debugging\\n\"\n\t\t    \"---------------------------------------------------\\n\");\n\tseq_printf(m, \"CIFS Version %s\\n\", CIFS_VERSION);\n\tseq_printf(m, \"Features:\");\n#ifdef CONFIG_CIFS_DFS_UPCALL\n\tseq_printf(m, \" dfs\");\n#endif\n#ifdef CONFIG_CIFS_FSCACHE\n\tseq_printf(m, \" fscache\");\n#endif\n#ifdef CONFIG_CIFS_WEAK_PW_HASH\n\tseq_printf(m, \" lanman\");\n#endif\n#ifdef CONFIG_CIFS_POSIX\n\tseq_printf(m, \" posix\");\n#endif\n#ifdef CONFIG_CIFS_UPCALL\n\tseq_printf(m, \" spnego\");\n#endif\n#ifdef CONFIG_CIFS_XATTR\n\tseq_printf(m, \" xattr\");\n#endif\n#ifdef CONFIG_CIFS_ACL\n\tseq_printf(m, \" acl\");\n#endif\n\tseq_putc(m, '\\n');\n\tseq_printf(m, \"Active VFS Requests: %d\\n\", GlobalTotalActiveXid);\n\tseq_printf(m, \"Servers:\");\n\n\ti = 0;\n\tspin_lock(&cifs_tcp_ses_lock);\n\tlist_for_each(tmp1, &cifs_tcp_ses_list) {\n\t\tserver = list_entry(tmp1, struct TCP_Server_Info,\n\t\t\t\t    tcp_ses_list);\n\t\ti++;\n\t\tlist_for_each(tmp2, &server->smb_ses_list) {\n\t\t\tses = list_entry(tmp2, struct cifs_ses,\n\t\t\t\t\t smb_ses_list);\n\t\t\tif ((ses->serverDomain == NULL) ||\n\t\t\t\t(ses->serverOS == NULL) ||\n\t\t\t\t(ses->serverNOS == NULL)) {\n\t\t\t\tseq_printf(m, \"\\n%d) entry for %s not fully \"\n\t\t\t\t\t   \"displayed\\n\\t\", i, ses->serverName);\n\t\t\t} else {\n\t\t\t\tseq_printf(m,\n\t\t\t\t    \"\\n%d) Name: %s  Domain: %s Uses: %d OS:\"\n\t\t\t\t    \" %s\\n\\tNOS: %s\\tCapability: 0x%x\\n\\tSMB\"\n\t\t\t\t    \" session status: %d\\t\",\n\t\t\t\ti, ses->serverName, ses->serverDomain,\n\t\t\t\tses->ses_count, ses->serverOS, ses->serverNOS,\n\t\t\t\tses->capabilities, ses->status);\n\t\t\t}\n\t\t\tseq_printf(m, \"TCP status: %d\\n\\tLocal Users To \"\n\t\t\t\t   \"Server: %d SecMode: 0x%x Req On Wire: %d\",\n\t\t\t\t   server->tcpStatus, server->srv_count,\n\t\t\t\t   server->sec_mode, in_flight(server));\n\n#ifdef CONFIG_CIFS_STATS2\n\t\t\tseq_printf(m, \" In Send: %d In MaxReq Wait: %d\",\n\t\t\t\tatomic_read(&server->in_send),\n\t\t\t\tatomic_read(&server->num_waiters));\n#endif\n\n\t\t\tseq_puts(m, \"\\n\\tShares:\");\n\t\t\tj = 0;\n\t\t\tlist_for_each(tmp3, &ses->tcon_list) {\n\t\t\t\ttcon = list_entry(tmp3, struct cifs_tcon,\n\t\t\t\t\t\t  tcon_list);\n\t\t\t\t++j;\n\t\t\t\tdev_type = le32_to_cpu(tcon->fsDevInfo.DeviceType);\n\t\t\t\tseq_printf(m, \"\\n\\t%d) %s Mounts: %d \", j,\n\t\t\t\t\t   tcon->treeName, tcon->tc_count);\n\t\t\t\tif (tcon->nativeFileSystem) {\n\t\t\t\t\tseq_printf(m, \"Type: %s \",\n\t\t\t\t\t\t   tcon->nativeFileSystem);\n\t\t\t\t}\n\t\t\t\tseq_printf(m, \"DevInfo: 0x%x Attributes: 0x%x\"\n\t\t\t\t\t\"\\n\\tPathComponentMax: %d Status: %d\",\n\t\t\t\t\tle32_to_cpu(tcon->fsDevInfo.DeviceCharacteristics),\n\t\t\t\t\tle32_to_cpu(tcon->fsAttrInfo.Attributes),\n\t\t\t\t\tle32_to_cpu(tcon->fsAttrInfo.MaxPathNameComponentLength),\n\t\t\t\t\ttcon->tidStatus);\n\t\t\t\tif (dev_type == FILE_DEVICE_DISK)\n\t\t\t\t\tseq_puts(m, \" type: DISK \");\n\t\t\t\telse if (dev_type == FILE_DEVICE_CD_ROM)\n\t\t\t\t\tseq_puts(m, \" type: CDROM \");\n\t\t\t\telse\n\t\t\t\t\tseq_printf(m, \" type: %d \", dev_type);\n\t\t\t\tif (server->ops->dump_share_caps)\n\t\t\t\t\tserver->ops->dump_share_caps(m, tcon);\n\n\t\t\t\tif (tcon->need_reconnect)\n\t\t\t\t\tseq_puts(m, \"\\tDISCONNECTED \");\n\t\t\t\tseq_putc(m, '\\n');\n\t\t\t}\n\n\t\t\tseq_puts(m, \"\\n\\tMIDs:\\n\");\n\n\t\t\tspin_lock(&GlobalMid_Lock);\n\t\t\tlist_for_each(tmp3, &server->pending_mid_q) {\n\t\t\t\tmid_entry = list_entry(tmp3, struct mid_q_entry,\n\t\t\t\t\tqhead);\n\t\t\t\tseq_printf(m, \"\\tState: %d com: %d pid:\"\n\t\t\t\t\t      \" %d cbdata: %p mid %llu\\n\",\n\t\t\t\t\t      mid_entry->mid_state,\n\t\t\t\t\t      le16_to_cpu(mid_entry->command),\n\t\t\t\t\t      mid_entry->pid,\n\t\t\t\t\t      mid_entry->callback_data,\n\t\t\t\t\t      mid_entry->mid);\n\t\t\t}\n\t\t\tspin_unlock(&GlobalMid_Lock);\n\t\t}\n\t}\n\tspin_unlock(&cifs_tcp_ses_lock);\n\tseq_putc(m, '\\n');\n\n\t/* BB add code to dump additional info such as TCP session info now */\n\treturn 0;\n}"
  },
  {
    "function_name": "cifs_dump_mids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "71-107",
    "snippet": "void cifs_dump_mids(struct TCP_Server_Info *server)\n{\n#ifdef CONFIG_CIFS_DEBUG2\n\tstruct list_head *tmp;\n\tstruct mid_q_entry *mid_entry;\n\n\tif (server == NULL)\n\t\treturn;\n\n\tcifs_dbg(VFS, \"Dump pending requests:\\n\");\n\tspin_lock(&GlobalMid_Lock);\n\tlist_for_each(tmp, &server->pending_mid_q) {\n\t\tmid_entry = list_entry(tmp, struct mid_q_entry, qhead);\n\t\tcifs_dbg(VFS, \"State: %d Cmd: %d Pid: %d Cbdata: %p Mid %llu\\n\",\n\t\t\t mid_entry->mid_state,\n\t\t\t le16_to_cpu(mid_entry->command),\n\t\t\t mid_entry->pid,\n\t\t\t mid_entry->callback_data,\n\t\t\t mid_entry->mid);\n#ifdef CONFIG_CIFS_STATS2\n\t\tcifs_dbg(VFS, \"IsLarge: %d buf: %p time rcv: %ld now: %ld\\n\",\n\t\t\t mid_entry->large_buf,\n\t\t\t mid_entry->resp_buf,\n\t\t\t mid_entry->when_received,\n\t\t\t jiffies);\n#endif /* STATS2 */\n\t\tcifs_dbg(VFS, \"IsMult: %d IsEnd: %d\\n\",\n\t\t\t mid_entry->multiRsp, mid_entry->multiEnd);\n\t\tif (mid_entry->resp_buf) {\n\t\t\tcifs_dump_detail(mid_entry->resp_buf);\n\t\t\tcifs_dump_mem(\"existing buf: \",\n\t\t\t\tmid_entry->resp_buf, 62);\n\t\t}\n\t}\n\tspin_unlock(&GlobalMid_Lock);\n#endif /* CONFIG_CIFS_DEBUG2 */\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&GlobalMid_Lock"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dump_mem",
          "args": [
            "\"existing buf: \"",
            "mid_entry->resp_buf",
            "62"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "cifs_dump_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
          "lines": "34-40",
          "snippet": "void\ncifs_dump_mem(char *label, void *data, int length)\n{\n\tpr_debug(\"%s: dump of %d bytes of data at 0x%p\\n\", label, length, data);\n\tprint_hex_dump(KERN_DEBUG, \"\", DUMP_PREFIX_OFFSET, 16, 4,\n\t\t       data, length, true);\n}",
          "includes": [
            "#include \"cifsfs.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsproto.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/ctype.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid\ncifs_dump_mem(char *label, void *data, int length)\n{\n\tpr_debug(\"%s: dump of %d bytes of data at 0x%p\\n\", label, length, data);\n\tprint_hex_dump(KERN_DEBUG, \"\", DUMP_PREFIX_OFFSET, 16, 4,\n\t\t       data, length, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dump_detail",
          "args": [
            "mid_entry->resp_buf"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "cifs_dump_detail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
          "lines": "59-69",
          "snippet": "void cifs_dump_detail(void *buf)\n{\n#ifdef CONFIG_CIFS_DEBUG2\n\tstruct smb_hdr *smb = (struct smb_hdr *)buf;\n\n\tcifs_dbg(VFS, \"Cmd: %d Err: 0x%x Flags: 0x%x Flgs2: 0x%x Mid: %d Pid: %d\\n\",\n\t\t smb->Command, smb->Status.CifsError,\n\t\t smb->Flags, smb->Flags2, smb->Mid, smb->Pid);\n\tcifs_dbg(VFS, \"smb buf %p len %u\\n\", smb, smbCalcSize(smb));\n#endif /* CONFIG_CIFS_DEBUG2 */\n}",
          "includes": [
            "#include \"cifsfs.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsproto.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/ctype.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid cifs_dump_detail(void *buf)\n{\n#ifdef CONFIG_CIFS_DEBUG2\n\tstruct smb_hdr *smb = (struct smb_hdr *)buf;\n\n\tcifs_dbg(VFS, \"Cmd: %d Err: 0x%x Flags: 0x%x Flgs2: 0x%x Mid: %d Pid: %d\\n\",\n\t\t smb->Command, smb->Status.CifsError,\n\t\t smb->Flags, smb->Flags2, smb->Mid, smb->Pid);\n\tcifs_dbg(VFS, \"smb buf %p len %u\\n\", smb, smbCalcSize(smb));\n#endif /* CONFIG_CIFS_DEBUG2 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"IsMult: %d IsEnd: %d\\n\"",
            "mid_entry->multiRsp",
            "mid_entry->multiEnd"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"IsLarge: %d buf: %p time rcv: %ld now: %ld\\n\"",
            "mid_entry->large_buf",
            "mid_entry->resp_buf",
            "mid_entry->when_received",
            "jiffies"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"State: %d Cmd: %d Pid: %d Cbdata: %p Mid %llu\\n\"",
            "mid_entry->mid_state",
            "le16_to_cpu(mid_entry->command)",
            "mid_entry->pid",
            "mid_entry->callback_data",
            "mid_entry->mid"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le16_to_cpu",
          "args": [
            "mid_entry->command"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "sle16_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "48-51",
          "snippet": "static inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "tmp",
            "structmid_q_entry",
            "qhead"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "tmp",
            "&server->pending_mid_q"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&GlobalMid_Lock"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"Dump pending requests:\\n\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid cifs_dump_mids(struct TCP_Server_Info *server)\n{\n#ifdef CONFIG_CIFS_DEBUG2\n\tstruct list_head *tmp;\n\tstruct mid_q_entry *mid_entry;\n\n\tif (server == NULL)\n\t\treturn;\n\n\tcifs_dbg(VFS, \"Dump pending requests:\\n\");\n\tspin_lock(&GlobalMid_Lock);\n\tlist_for_each(tmp, &server->pending_mid_q) {\n\t\tmid_entry = list_entry(tmp, struct mid_q_entry, qhead);\n\t\tcifs_dbg(VFS, \"State: %d Cmd: %d Pid: %d Cbdata: %p Mid %llu\\n\",\n\t\t\t mid_entry->mid_state,\n\t\t\t le16_to_cpu(mid_entry->command),\n\t\t\t mid_entry->pid,\n\t\t\t mid_entry->callback_data,\n\t\t\t mid_entry->mid);\n#ifdef CONFIG_CIFS_STATS2\n\t\tcifs_dbg(VFS, \"IsLarge: %d buf: %p time rcv: %ld now: %ld\\n\",\n\t\t\t mid_entry->large_buf,\n\t\t\t mid_entry->resp_buf,\n\t\t\t mid_entry->when_received,\n\t\t\t jiffies);\n#endif /* STATS2 */\n\t\tcifs_dbg(VFS, \"IsMult: %d IsEnd: %d\\n\",\n\t\t\t mid_entry->multiRsp, mid_entry->multiEnd);\n\t\tif (mid_entry->resp_buf) {\n\t\t\tcifs_dump_detail(mid_entry->resp_buf);\n\t\t\tcifs_dump_mem(\"existing buf: \",\n\t\t\t\tmid_entry->resp_buf, 62);\n\t\t}\n\t}\n\tspin_unlock(&GlobalMid_Lock);\n#endif /* CONFIG_CIFS_DEBUG2 */\n}"
  },
  {
    "function_name": "cifs_dump_detail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "59-69",
    "snippet": "void cifs_dump_detail(void *buf)\n{\n#ifdef CONFIG_CIFS_DEBUG2\n\tstruct smb_hdr *smb = (struct smb_hdr *)buf;\n\n\tcifs_dbg(VFS, \"Cmd: %d Err: 0x%x Flags: 0x%x Flgs2: 0x%x Mid: %d Pid: %d\\n\",\n\t\t smb->Command, smb->Status.CifsError,\n\t\t smb->Flags, smb->Flags2, smb->Mid, smb->Pid);\n\tcifs_dbg(VFS, \"smb buf %p len %u\\n\", smb, smbCalcSize(smb));\n#endif /* CONFIG_CIFS_DEBUG2 */\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"smb buf %p len %u\\n\"",
            "smb",
            "smbCalcSize(smb)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smbCalcSize",
          "args": [
            "smb"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "smbCalcSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/netmisc.c",
          "lines": "905-911",
          "snippet": "unsigned int\nsmbCalcSize(void *buf)\n{\n\tstruct smb_hdr *ptr = (struct smb_hdr *)buf;\n\treturn (sizeof(struct smb_hdr) + (2 * ptr->WordCount) +\n\t\t2 /* size of the bcc field */ + get_bcc(ptr));\n}",
          "includes": [
            "#include \"nterr.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"smberr.h\"",
            "#include \"cifsproto.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include \"cifsfs.h\"",
            "#include <linux/inet.h>",
            "#include <asm/byteorder.h>",
            "#include <asm/div64.h>",
            "#include <linux/fs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/net.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nterr.h\"\n#include \"cifs_debug.h\"\n#include \"smberr.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include \"cifsfs.h\"\n#include <linux/inet.h>\n#include <asm/byteorder.h>\n#include <asm/div64.h>\n#include <linux/fs.h>\n#include <linux/ctype.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/net.h>\n\nunsigned int\nsmbCalcSize(void *buf)\n{\n\tstruct smb_hdr *ptr = (struct smb_hdr *)buf;\n\treturn (sizeof(struct smb_hdr) + (2 * ptr->WordCount) +\n\t\t2 /* size of the bcc field */ + get_bcc(ptr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "VFS",
            "\"Cmd: %d Err: 0x%x Flags: 0x%x Flgs2: 0x%x Mid: %d Pid: %d\\n\"",
            "smb->Command",
            "smb->Status.CifsError",
            "smb->Flags",
            "smb->Flags2",
            "smb->Mid",
            "smb->Pid"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid cifs_dump_detail(void *buf)\n{\n#ifdef CONFIG_CIFS_DEBUG2\n\tstruct smb_hdr *smb = (struct smb_hdr *)buf;\n\n\tcifs_dbg(VFS, \"Cmd: %d Err: 0x%x Flags: 0x%x Flgs2: 0x%x Mid: %d Pid: %d\\n\",\n\t\t smb->Command, smb->Status.CifsError,\n\t\t smb->Flags, smb->Flags2, smb->Mid, smb->Pid);\n\tcifs_dbg(VFS, \"smb buf %p len %u\\n\", smb, smbCalcSize(smb));\n#endif /* CONFIG_CIFS_DEBUG2 */\n}"
  },
  {
    "function_name": "cifs_vfs_err",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "43-56",
    "snippet": "void cifs_vfs_err(const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tpr_err(\"CIFS VFS: %pV\", &vaf);\n\n\tva_end(args);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"CIFS VFS: %pV\"",
            "&vaf"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid cifs_vfs_err(const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tpr_err(\"CIFS VFS: %pV\", &vaf);\n\n\tva_end(args);\n}"
  },
  {
    "function_name": "cifs_dump_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
    "lines": "34-40",
    "snippet": "void\ncifs_dump_mem(char *label, void *data, int length)\n{\n\tpr_debug(\"%s: dump of %d bytes of data at 0x%p\\n\", label, length, data);\n\tprint_hex_dump(KERN_DEBUG, \"\", DUMP_PREFIX_OFFSET, 16, 4,\n\t\t       data, length, true);\n}",
    "includes": [
      "#include \"cifsfs.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsproto.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_DEBUG",
            "\"\"",
            "DUMP_PREFIX_OFFSET",
            "16",
            "4",
            "data",
            "length",
            "true"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s: dump of %d bytes of data at 0x%p\\n\"",
            "label",
            "length",
            "data"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid\ncifs_dump_mem(char *label, void *data, int length)\n{\n\tpr_debug(\"%s: dump of %d bytes of data at 0x%p\\n\", label, length, data);\n\tprint_hex_dump(KERN_DEBUG, \"\", DUMP_PREFIX_OFFSET, 16, 4,\n\t\t       data, length, true);\n}"
  }
]