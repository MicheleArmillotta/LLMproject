[
  {
    "function_name": "dlm_our_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "1000-1008",
    "snippet": "int dlm_our_addr(struct sockaddr_storage *addr, int num)\n{\n\tif (!local_comm)\n\t\treturn -1;\n\tif (num + 1 > local_comm->addr_count)\n\t\treturn -1;\n\tmemcpy(addr, local_comm->addr[num], sizeof(*addr));\n\treturn 0;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dlm_comm *local_comm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "addr",
            "local_comm->addr[num]",
            "sizeof(*addr)"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_comm *local_comm;\n\nint dlm_our_addr(struct sockaddr_storage *addr, int num)\n{\n\tif (!local_comm)\n\t\treturn -1;\n\tif (num + 1 > local_comm->addr_count)\n\t\treturn -1;\n\tmemcpy(addr, local_comm->addr[num], sizeof(*addr));\n\treturn 0;\n}"
  },
  {
    "function_name": "dlm_our_nodeid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "994-997",
    "snippet": "int dlm_our_nodeid(void)\n{\n\treturn local_comm ? local_comm->nodeid : 0;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dlm_comm *local_comm;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_comm *local_comm;\n\nint dlm_our_nodeid(void)\n{\n\treturn local_comm ? local_comm->nodeid : 0;\n}"
  },
  {
    "function_name": "dlm_comm_seq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "984-992",
    "snippet": "int dlm_comm_seq(int nodeid, uint32_t *seq)\n{\n\tstruct dlm_comm *cm = get_comm(nodeid);\n\tif (!cm)\n\t\treturn -EEXIST;\n\t*seq = cm->seq;\n\tput_comm(cm);\n\treturn 0;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_comm",
          "args": [
            "cm"
          ],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "put_comm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "931-934",
          "snippet": "static void put_comm(struct dlm_comm *cm)\n{\n\tconfig_item_put(&cm->item);\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void put_comm(struct dlm_comm *cm)\n{\n\tconfig_item_put(&cm->item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_comm",
          "args": [
            "nodeid"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "get_comm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "904-929",
          "snippet": "static struct dlm_comm *get_comm(int nodeid)\n{\n\tstruct config_item *i;\n\tstruct dlm_comm *cm = NULL;\n\tint found = 0;\n\n\tif (!comm_list)\n\t\treturn NULL;\n\n\tmutex_lock(&clusters_root.subsys.su_mutex);\n\n\tlist_for_each_entry(i, &comm_list->cg_children, ci_entry) {\n\t\tcm = config_item_to_comm(i);\n\n\t\tif (cm->nodeid != nodeid)\n\t\t\tcontinue;\n\t\tfound = 1;\n\t\tconfig_item_get(i);\n\t\tbreak;\n\t}\n\tmutex_unlock(&clusters_root.subsys.su_mutex);\n\n\tif (!found)\n\t\tcm = NULL;\n\treturn cm;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct config_group *comm_list;",
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);",
            "static struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *comm_list;\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nstatic struct dlm_comm *get_comm(int nodeid)\n{\n\tstruct config_item *i;\n\tstruct dlm_comm *cm = NULL;\n\tint found = 0;\n\n\tif (!comm_list)\n\t\treturn NULL;\n\n\tmutex_lock(&clusters_root.subsys.su_mutex);\n\n\tlist_for_each_entry(i, &comm_list->cg_children, ci_entry) {\n\t\tcm = config_item_to_comm(i);\n\n\t\tif (cm->nodeid != nodeid)\n\t\t\tcontinue;\n\t\tfound = 1;\n\t\tconfig_item_get(i);\n\t\tbreak;\n\t}\n\tmutex_unlock(&clusters_root.subsys.su_mutex);\n\n\tif (!found)\n\t\tcm = NULL;\n\treturn cm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nint dlm_comm_seq(int nodeid, uint32_t *seq)\n{\n\tstruct dlm_comm *cm = get_comm(nodeid);\n\tif (!cm)\n\t\treturn -EEXIST;\n\t*seq = cm->seq;\n\tput_comm(cm);\n\treturn 0;\n}"
  },
  {
    "function_name": "dlm_config_nodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "937-982",
    "snippet": "int dlm_config_nodes(char *lsname, struct dlm_config_node **nodes_out,\n\t\t     int *count_out)\n{\n\tstruct dlm_space *sp;\n\tstruct dlm_node *nd;\n\tstruct dlm_config_node *nodes, *node;\n\tint rv, count;\n\n\tsp = get_space(lsname);\n\tif (!sp)\n\t\treturn -EEXIST;\n\n\tmutex_lock(&sp->members_lock);\n\tif (!sp->members_count) {\n\t\trv = -EINVAL;\n\t\tprintk(KERN_ERR \"dlm: zero members_count\\n\");\n\t\tgoto out;\n\t}\n\n\tcount = sp->members_count;\n\n\tnodes = kcalloc(count, sizeof(struct dlm_config_node), GFP_NOFS);\n\tif (!nodes) {\n\t\trv = -ENOMEM;\n\t\tgoto out;\n\t}\n\n\tnode = nodes;\n\tlist_for_each_entry(nd, &sp->members, list) {\n\t\tnode->nodeid = nd->nodeid;\n\t\tnode->weight = nd->weight;\n\t\tnode->new = nd->new;\n\t\tnode->comm_seq = nd->comm_seq;\n\t\tnode++;\n\n\t\tnd->new = 0;\n\t}\n\n\t*count_out = count;\n\t*nodes_out = nodes;\n\trv = 0;\n out:\n\tmutex_unlock(&sp->members_lock);\n\tput_space(sp);\n\treturn rv;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_space",
          "args": [
            "sp"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "put_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "899-902",
          "snippet": "static void put_space(struct dlm_space *sp)\n{\n\tconfig_item_put(&sp->group.cg_item);\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void put_space(struct dlm_space *sp)\n{\n\tconfig_item_put(&sp->group.cg_item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sp->members_lock"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "nd",
            "&sp->members",
            "list"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "count",
            "sizeof(struct dlm_config_node)",
            "GFP_NOFS"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"dlm: zero members_count\\n\""
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sp->members_lock"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_space",
          "args": [
            "lsname"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "get_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "885-897",
          "snippet": "static struct dlm_space *get_space(char *name)\n{\n\tstruct config_item *i;\n\n\tif (!space_list)\n\t\treturn NULL;\n\n\tmutex_lock(&space_list->cg_subsys->su_mutex);\n\ti = config_group_find_item(space_list, name);\n\tmutex_unlock(&space_list->cg_subsys->su_mutex);\n\n\treturn config_item_to_space(i);\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct config_group *space_list;",
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *space_list;\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *get_space(char *name)\n{\n\tstruct config_item *i;\n\n\tif (!space_list)\n\t\treturn NULL;\n\n\tmutex_lock(&space_list->cg_subsys->su_mutex);\n\ti = config_group_find_item(space_list, name);\n\tmutex_unlock(&space_list->cg_subsys->su_mutex);\n\n\treturn config_item_to_space(i);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nint dlm_config_nodes(char *lsname, struct dlm_config_node **nodes_out,\n\t\t     int *count_out)\n{\n\tstruct dlm_space *sp;\n\tstruct dlm_node *nd;\n\tstruct dlm_config_node *nodes, *node;\n\tint rv, count;\n\n\tsp = get_space(lsname);\n\tif (!sp)\n\t\treturn -EEXIST;\n\n\tmutex_lock(&sp->members_lock);\n\tif (!sp->members_count) {\n\t\trv = -EINVAL;\n\t\tprintk(KERN_ERR \"dlm: zero members_count\\n\");\n\t\tgoto out;\n\t}\n\n\tcount = sp->members_count;\n\n\tnodes = kcalloc(count, sizeof(struct dlm_config_node), GFP_NOFS);\n\tif (!nodes) {\n\t\trv = -ENOMEM;\n\t\tgoto out;\n\t}\n\n\tnode = nodes;\n\tlist_for_each_entry(nd, &sp->members, list) {\n\t\tnode->nodeid = nd->nodeid;\n\t\tnode->weight = nd->weight;\n\t\tnode->new = nd->new;\n\t\tnode->comm_seq = nd->comm_seq;\n\t\tnode++;\n\n\t\tnd->new = 0;\n\t}\n\n\t*count_out = count;\n\t*nodes_out = nodes;\n\trv = 0;\n out:\n\tmutex_unlock(&sp->members_lock);\n\tput_space(sp);\n\treturn rv;\n}"
  },
  {
    "function_name": "put_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "931-934",
    "snippet": "static void put_comm(struct dlm_comm *cm)\n{\n\tconfig_item_put(&cm->item);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "&cm->item"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void put_comm(struct dlm_comm *cm)\n{\n\tconfig_item_put(&cm->item);\n}"
  },
  {
    "function_name": "get_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "904-929",
    "snippet": "static struct dlm_comm *get_comm(int nodeid)\n{\n\tstruct config_item *i;\n\tstruct dlm_comm *cm = NULL;\n\tint found = 0;\n\n\tif (!comm_list)\n\t\treturn NULL;\n\n\tmutex_lock(&clusters_root.subsys.su_mutex);\n\n\tlist_for_each_entry(i, &comm_list->cg_children, ci_entry) {\n\t\tcm = config_item_to_comm(i);\n\n\t\tif (cm->nodeid != nodeid)\n\t\t\tcontinue;\n\t\tfound = 1;\n\t\tconfig_item_get(i);\n\t\tbreak;\n\t}\n\tmutex_unlock(&clusters_root.subsys.su_mutex);\n\n\tif (!found)\n\t\tcm = NULL;\n\treturn cm;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *comm_list;",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&clusters_root.subsys.su_mutex"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_get",
          "args": [
            "i"
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "134-139",
          "snippet": "struct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstruct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_to_comm",
          "args": [
            "i"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_comm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "442-445",
          "snippet": "static struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "i",
            "&comm_list->cg_children",
            "ci_entry"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&clusters_root.subsys.su_mutex"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *comm_list;\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nstatic struct dlm_comm *get_comm(int nodeid)\n{\n\tstruct config_item *i;\n\tstruct dlm_comm *cm = NULL;\n\tint found = 0;\n\n\tif (!comm_list)\n\t\treturn NULL;\n\n\tmutex_lock(&clusters_root.subsys.su_mutex);\n\n\tlist_for_each_entry(i, &comm_list->cg_children, ci_entry) {\n\t\tcm = config_item_to_comm(i);\n\n\t\tif (cm->nodeid != nodeid)\n\t\t\tcontinue;\n\t\tfound = 1;\n\t\tconfig_item_get(i);\n\t\tbreak;\n\t}\n\tmutex_unlock(&clusters_root.subsys.su_mutex);\n\n\tif (!found)\n\t\tcm = NULL;\n\treturn cm;\n}"
  },
  {
    "function_name": "put_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "899-902",
    "snippet": "static void put_space(struct dlm_space *sp)\n{\n\tconfig_item_put(&sp->group.cg_item);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "&sp->group.cg_item"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void put_space(struct dlm_space *sp)\n{\n\tconfig_item_put(&sp->group.cg_item);\n}"
  },
  {
    "function_name": "get_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "885-897",
    "snippet": "static struct dlm_space *get_space(char *name)\n{\n\tstruct config_item *i;\n\n\tif (!space_list)\n\t\treturn NULL;\n\n\tmutex_lock(&space_list->cg_subsys->su_mutex);\n\ti = config_group_find_item(space_list, name);\n\tmutex_unlock(&space_list->cg_subsys->su_mutex);\n\n\treturn config_item_to_space(i);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *space_list;",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_to_space",
          "args": [
            "i"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "436-440",
          "snippet": "static struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&space_list->cg_subsys->su_mutex"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_group_find_item",
          "args": [
            "space_list",
            "name"
          ],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "config_group_find_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "198-213",
          "snippet": "struct config_item *config_group_find_item(struct config_group *group,\n\t\t\t\t\t   const char *name)\n{\n\tstruct list_head *entry;\n\tstruct config_item *ret = NULL;\n\n\tlist_for_each(entry, &group->cg_children) {\n\t\tstruct config_item *item = to_item(entry);\n\t\tif (config_item_name(item) &&\n\t\t    !strcmp(config_item_name(item), name)) {\n\t\t\tret = config_item_get(item);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstruct config_item *config_group_find_item(struct config_group *group,\n\t\t\t\t\t   const char *name)\n{\n\tstruct list_head *entry;\n\tstruct config_item *ret = NULL;\n\n\tlist_for_each(entry, &group->cg_children) {\n\t\tstruct config_item *item = to_item(entry);\n\t\tif (config_item_name(item) &&\n\t\t    !strcmp(config_item_name(item), name)) {\n\t\t\tret = config_item_get(item);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&space_list->cg_subsys->su_mutex"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *space_list;\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *get_space(char *name)\n{\n\tstruct config_item *i;\n\n\tif (!space_list)\n\t\treturn NULL;\n\n\tmutex_lock(&space_list->cg_subsys->su_mutex);\n\ti = config_group_find_item(space_list, name);\n\tmutex_unlock(&space_list->cg_subsys->su_mutex);\n\n\treturn config_item_to_space(i);\n}"
  },
  {
    "function_name": "node_weight_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "871-879",
    "snippet": "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\t size_t len)\n{\n\tint rc = kstrtoint(buf, 0, &nd->weight);\n\n\tif (rc)\n\t\treturn rc;\n\treturn len;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtoint",
          "args": [
            "buf",
            "0",
            "&nd->weight"
          ],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "suffix_kstrtoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_super.c",
          "lines": "140-164",
          "snippet": "STATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/parser.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mempool.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/namei.h>",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs_quota.h\"",
            "#include \"xfs_filestream.h\"",
            "#include \"xfs_icreate_item.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_icache.h\"",
            "#include \"xfs_inode_item.h\"",
            "#include \"xfs_mru_cache.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_dir2.h\"",
            "#include \"xfs_da_btree.h\"",
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_fsops.h\"",
            "#include \"xfs_error.h\"",
            "#include \"xfs_alloc.h\"",
            "#include \"xfs_bmap.h\"",
            "#include \"xfs_btree.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_da_format.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "STATIC int",
            "STATIC int",
            "STATIC int",
            "STATIC void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/parser.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/writeback.h>\n#include <linux/mempool.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/namei.h>\n#include \"xfs_sysfs.h\"\n#include \"xfs_quota.h\"\n#include \"xfs_filestream.h\"\n#include \"xfs_icreate_item.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_icache.h\"\n#include \"xfs_inode_item.h\"\n#include \"xfs_mru_cache.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_dir2.h\"\n#include \"xfs_da_btree.h\"\n#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_fsops.h\"\n#include \"xfs_error.h\"\n#include \"xfs_alloc.h\"\n#include \"xfs_bmap.h\"\n#include \"xfs_btree.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_da_format.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs.h\"\n\nSTATIC int;\nSTATIC int;\nSTATIC int;\nSTATIC void;\n\nSTATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\t size_t len)\n{\n\tint rc = kstrtoint(buf, 0, &nd->weight);\n\n\tif (rc)\n\t\treturn rc;\n\treturn len;\n}"
  },
  {
    "function_name": "node_weight_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "866-869",
    "snippet": "static ssize_t node_weight_read(struct dlm_node *nd, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", nd->weight);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "nd->weight"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", nd->weight);\n}"
  },
  {
    "function_name": "node_nodeid_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "853-864",
    "snippet": "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\t size_t len)\n{\n\tuint32_t seq = 0;\n\tint rc = kstrtoint(buf, 0, &nd->nodeid);\n\n\tif (rc)\n\t\treturn rc;\n\tdlm_comm_seq(nd->nodeid, &seq);\n\tnd->comm_seq = seq;\n\treturn len;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlm_comm_seq",
          "args": [
            "nd->nodeid",
            "&seq"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_comm_seq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "984-992",
          "snippet": "int dlm_comm_seq(int nodeid, uint32_t *seq)\n{\n\tstruct dlm_comm *cm = get_comm(nodeid);\n\tif (!cm)\n\t\treturn -EEXIST;\n\t*seq = cm->seq;\n\tput_comm(cm);\n\treturn 0;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nint dlm_comm_seq(int nodeid, uint32_t *seq)\n{\n\tstruct dlm_comm *cm = get_comm(nodeid);\n\tif (!cm)\n\t\treturn -EEXIST;\n\t*seq = cm->seq;\n\tput_comm(cm);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtoint",
          "args": [
            "buf",
            "0",
            "&nd->nodeid"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "suffix_kstrtoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_super.c",
          "lines": "140-164",
          "snippet": "STATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/parser.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mempool.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/namei.h>",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs_quota.h\"",
            "#include \"xfs_filestream.h\"",
            "#include \"xfs_icreate_item.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_icache.h\"",
            "#include \"xfs_inode_item.h\"",
            "#include \"xfs_mru_cache.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_dir2.h\"",
            "#include \"xfs_da_btree.h\"",
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_fsops.h\"",
            "#include \"xfs_error.h\"",
            "#include \"xfs_alloc.h\"",
            "#include \"xfs_bmap.h\"",
            "#include \"xfs_btree.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_da_format.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "STATIC int",
            "STATIC int",
            "STATIC int",
            "STATIC void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/parser.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/writeback.h>\n#include <linux/mempool.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/namei.h>\n#include \"xfs_sysfs.h\"\n#include \"xfs_quota.h\"\n#include \"xfs_filestream.h\"\n#include \"xfs_icreate_item.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_icache.h\"\n#include \"xfs_inode_item.h\"\n#include \"xfs_mru_cache.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_dir2.h\"\n#include \"xfs_da_btree.h\"\n#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_fsops.h\"\n#include \"xfs_error.h\"\n#include \"xfs_alloc.h\"\n#include \"xfs_bmap.h\"\n#include \"xfs_btree.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_da_format.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs.h\"\n\nSTATIC int;\nSTATIC int;\nSTATIC int;\nSTATIC void;\n\nSTATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\t size_t len)\n{\n\tuint32_t seq = 0;\n\tint rc = kstrtoint(buf, 0, &nd->nodeid);\n\n\tif (rc)\n\t\treturn rc;\n\tdlm_comm_seq(nd->nodeid, &seq);\n\tnd->comm_seq = seq;\n\treturn len;\n}"
  },
  {
    "function_name": "node_nodeid_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "848-851",
    "snippet": "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", nd->nodeid);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "nd->nodeid"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", nd->nodeid);\n}"
  },
  {
    "function_name": "store_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "839-846",
    "snippet": "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len)\n{\n\tstruct dlm_node *nd = config_item_to_node(i);\n\tstruct node_attribute *nda =\n\t\tcontainer_of(a, struct node_attribute, attr);\n\treturn nda->store ? nda->store(nd, buf, len) : -EINVAL;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nda->store",
          "args": [
            "nd",
            "buf",
            "len"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "a",
            "structnode_attribute",
            "attr"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_node",
          "args": [
            "i"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "447-450",
          "snippet": "static struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len)\n{\n\tstruct dlm_node *nd = config_item_to_node(i);\n\tstruct node_attribute *nda =\n\t\tcontainer_of(a, struct node_attribute, attr);\n\treturn nda->store ? nda->store(nd, buf, len) : -EINVAL;\n}"
  },
  {
    "function_name": "show_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "830-837",
    "snippet": "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf)\n{\n\tstruct dlm_node *nd = config_item_to_node(i);\n\tstruct node_attribute *nda =\n\t\t\tcontainer_of(a, struct node_attribute, attr);\n\treturn nda->show ? nda->show(nd, buf) : 0;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nda->show",
          "args": [
            "nd",
            "buf"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "a",
            "structnode_attribute",
            "attr"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_node",
          "args": [
            "i"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "447-450",
          "snippet": "static struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf)\n{\n\tstruct dlm_node *nd = config_item_to_node(i);\n\tstruct node_attribute *nda =\n\t\t\tcontainer_of(a, struct node_attribute, attr);\n\treturn nda->show ? nda->show(nd, buf) : 0;\n}"
  },
  {
    "function_name": "comm_addr_list_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "786-828",
    "snippet": "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf)\n{\n\tssize_t s;\n\tssize_t allowance;\n\tint i;\n\tstruct sockaddr_storage *addr;\n\tstruct sockaddr_in *addr_in;\n\tstruct sockaddr_in6 *addr_in6;\n\t\n\t/* Taken from ip6_addr_string() defined in lib/vsprintf.c */\n\tchar buf0[sizeof(\"AF_INET6\txxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255\\n\")];\n\t\n\n\t/* Derived from SIMPLE_ATTR_SIZE of fs/configfs/file.c */\n\tallowance = 4096;\n\tbuf[0] = '\\0';\n\n\tfor (i = 0; i < cm->addr_count; i++) {\n\t\taddr = cm->addr[i];\n\n\t\tswitch(addr->ss_family) {\n\t\tcase AF_INET:\n\t\t\taddr_in = (struct sockaddr_in *)addr;\n\t\t\ts = sprintf(buf0, \"AF_INET\t%pI4\\n\", &addr_in->sin_addr.s_addr);\n\t\t\tbreak;\n\t\tcase AF_INET6:\n\t\t\taddr_in6 = (struct sockaddr_in6 *)addr;\n\t\t\ts = sprintf(buf0, \"AF_INET6\t%pI6\\n\", &addr_in6->sin6_addr);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ts = sprintf(buf0, \"%s\\n\", \"<UNKNOWN>\");\n\t\t\tbreak;\n\t\t}\n\t\tallowance -= s;\n\t\tif (allowance >= 0)\n\t\t\tstrcat(buf, buf0);\n\t\telse {\n\t\t\tallowance += s;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn 4096 - allowance;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "buf0"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf0",
            "\"%s\\n\"",
            "\"<UNKNOWN>\""
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf0",
            "\"AF_INET6\t%pI6\\n\"",
            "&addr_in6->sin6_addr"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf0",
            "\"AF_INET\t%pI4\\n\"",
            "&addr_in->sin_addr.s_addr"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf)\n{\n\tssize_t s;\n\tssize_t allowance;\n\tint i;\n\tstruct sockaddr_storage *addr;\n\tstruct sockaddr_in *addr_in;\n\tstruct sockaddr_in6 *addr_in6;\n\t\n\t/* Taken from ip6_addr_string() defined in lib/vsprintf.c */\n\tchar buf0[sizeof(\"AF_INET6\txxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255\\n\")];\n\t\n\n\t/* Derived from SIMPLE_ATTR_SIZE of fs/configfs/file.c */\n\tallowance = 4096;\n\tbuf[0] = '\\0';\n\n\tfor (i = 0; i < cm->addr_count; i++) {\n\t\taddr = cm->addr[i];\n\n\t\tswitch(addr->ss_family) {\n\t\tcase AF_INET:\n\t\t\taddr_in = (struct sockaddr_in *)addr;\n\t\t\ts = sprintf(buf0, \"AF_INET\t%pI4\\n\", &addr_in->sin_addr.s_addr);\n\t\t\tbreak;\n\t\tcase AF_INET6:\n\t\t\taddr_in6 = (struct sockaddr_in6 *)addr;\n\t\t\ts = sprintf(buf0, \"AF_INET6\t%pI6\\n\", &addr_in6->sin6_addr);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ts = sprintf(buf0, \"%s\\n\", \"<UNKNOWN>\");\n\t\t\tbreak;\n\t\t}\n\t\tallowance -= s;\n\t\tif (allowance >= 0)\n\t\t\tstrcat(buf, buf0);\n\t\telse {\n\t\t\tallowance += s;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn 4096 - allowance;\n}"
  },
  {
    "function_name": "comm_addr_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "759-784",
    "snippet": "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf, size_t len)\n{\n\tstruct sockaddr_storage *addr;\n\tint rv;\n\n\tif (len != sizeof(struct sockaddr_storage))\n\t\treturn -EINVAL;\n\n\tif (cm->addr_count >= DLM_MAX_ADDR_COUNT)\n\t\treturn -ENOSPC;\n\n\taddr = kzalloc(sizeof(*addr), GFP_NOFS);\n\tif (!addr)\n\t\treturn -ENOMEM;\n\n\tmemcpy(addr, buf, len);\n\n\trv = dlm_lowcomms_addr(cm->nodeid, addr, len);\n\tif (rv) {\n\t\tkfree(addr);\n\t\treturn rv;\n\t}\n\n\tcm->addr[cm->addr_count++] = addr;\n\treturn len;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "addr"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_lowcomms_addr",
          "args": [
            "cm->nodeid",
            "addr",
            "len"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lowcomms_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/lowcomms.c",
          "lines": "385-424",
          "snippet": "int dlm_lowcomms_addr(int nodeid, struct sockaddr_storage *addr, int len)\n{\n\tstruct sockaddr_storage *new_addr;\n\tstruct dlm_node_addr *new_node, *na;\n\n\tnew_node = kzalloc(sizeof(struct dlm_node_addr), GFP_NOFS);\n\tif (!new_node)\n\t\treturn -ENOMEM;\n\n\tnew_addr = kzalloc(sizeof(struct sockaddr_storage), GFP_NOFS);\n\tif (!new_addr) {\n\t\tkfree(new_node);\n\t\treturn -ENOMEM;\n\t}\n\n\tmemcpy(new_addr, addr, len);\n\n\tspin_lock(&dlm_node_addrs_spin);\n\tna = find_node_addr(nodeid);\n\tif (!na) {\n\t\tnew_node->nodeid = nodeid;\n\t\tnew_node->addr[0] = new_addr;\n\t\tnew_node->addr_count = 1;\n\t\tlist_add(&new_node->list, &dlm_node_addrs);\n\t\tspin_unlock(&dlm_node_addrs_spin);\n\t\treturn 0;\n\t}\n\n\tif (na->addr_count >= DLM_MAX_ADDR_COUNT) {\n\t\tspin_unlock(&dlm_node_addrs_spin);\n\t\tkfree(new_addr);\n\t\tkfree(new_node);\n\t\treturn -ENOSPC;\n\t}\n\n\tna->addr[na->addr_count++] = new_addr;\n\tspin_unlock(&dlm_node_addrs_spin);\n\tkfree(new_node);\n\treturn 0;\n}",
          "includes": [
            "#include \"config.h\"",
            "#include \"midcomms.h\"",
            "#include \"lowcomms.h\"",
            "#include \"dlm_internal.h\"",
            "#include <net/ipv6.h>",
            "#include <net/sctp/sctp.h>",
            "#include <linux/slab.h>",
            "#include <linux/sctp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <net/tcp.h>",
            "#include <net/sock.h>",
            "#include <asm/ioctls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(dlm_node_addrs);",
            "static DEFINE_SPINLOCK(dlm_node_addrs_spin);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include \"midcomms.h\"\n#include \"lowcomms.h\"\n#include \"dlm_internal.h\"\n#include <net/ipv6.h>\n#include <net/sctp/sctp.h>\n#include <linux/slab.h>\n#include <linux/sctp.h>\n#include <linux/mutex.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <net/tcp.h>\n#include <net/sock.h>\n#include <asm/ioctls.h>\n\nstatic LIST_HEAD(dlm_node_addrs);\nstatic DEFINE_SPINLOCK(dlm_node_addrs_spin);\n\nint dlm_lowcomms_addr(int nodeid, struct sockaddr_storage *addr, int len)\n{\n\tstruct sockaddr_storage *new_addr;\n\tstruct dlm_node_addr *new_node, *na;\n\n\tnew_node = kzalloc(sizeof(struct dlm_node_addr), GFP_NOFS);\n\tif (!new_node)\n\t\treturn -ENOMEM;\n\n\tnew_addr = kzalloc(sizeof(struct sockaddr_storage), GFP_NOFS);\n\tif (!new_addr) {\n\t\tkfree(new_node);\n\t\treturn -ENOMEM;\n\t}\n\n\tmemcpy(new_addr, addr, len);\n\n\tspin_lock(&dlm_node_addrs_spin);\n\tna = find_node_addr(nodeid);\n\tif (!na) {\n\t\tnew_node->nodeid = nodeid;\n\t\tnew_node->addr[0] = new_addr;\n\t\tnew_node->addr_count = 1;\n\t\tlist_add(&new_node->list, &dlm_node_addrs);\n\t\tspin_unlock(&dlm_node_addrs_spin);\n\t\treturn 0;\n\t}\n\n\tif (na->addr_count >= DLM_MAX_ADDR_COUNT) {\n\t\tspin_unlock(&dlm_node_addrs_spin);\n\t\tkfree(new_addr);\n\t\tkfree(new_node);\n\t\treturn -ENOSPC;\n\t}\n\n\tna->addr[na->addr_count++] = new_addr;\n\tspin_unlock(&dlm_node_addrs_spin);\n\tkfree(new_node);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "addr",
            "buf",
            "len"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*addr)",
            "GFP_NOFS"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf, size_t len)\n{\n\tstruct sockaddr_storage *addr;\n\tint rv;\n\n\tif (len != sizeof(struct sockaddr_storage))\n\t\treturn -EINVAL;\n\n\tif (cm->addr_count >= DLM_MAX_ADDR_COUNT)\n\t\treturn -ENOSPC;\n\n\taddr = kzalloc(sizeof(*addr), GFP_NOFS);\n\tif (!addr)\n\t\treturn -ENOMEM;\n\n\tmemcpy(addr, buf, len);\n\n\trv = dlm_lowcomms_addr(cm->nodeid, addr, len);\n\tif (rv) {\n\t\tkfree(addr);\n\t\treturn rv;\n\t}\n\n\tcm->addr[cm->addr_count++] = addr;\n\treturn len;\n}"
  },
  {
    "function_name": "comm_local_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "747-757",
    "snippet": "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len)\n{\n\tint rc = kstrtoint(buf, 0, &cm->local);\n\n\tif (rc)\n\t\treturn rc;\n\tif (cm->local && !local_comm)\n\t\tlocal_comm = cm;\n\treturn len;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dlm_comm *local_comm;",
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtoint",
          "args": [
            "buf",
            "0",
            "&cm->local"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "suffix_kstrtoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_super.c",
          "lines": "140-164",
          "snippet": "STATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/parser.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mempool.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/namei.h>",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs_quota.h\"",
            "#include \"xfs_filestream.h\"",
            "#include \"xfs_icreate_item.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_icache.h\"",
            "#include \"xfs_inode_item.h\"",
            "#include \"xfs_mru_cache.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_dir2.h\"",
            "#include \"xfs_da_btree.h\"",
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_fsops.h\"",
            "#include \"xfs_error.h\"",
            "#include \"xfs_alloc.h\"",
            "#include \"xfs_bmap.h\"",
            "#include \"xfs_btree.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_da_format.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "STATIC int",
            "STATIC int",
            "STATIC int",
            "STATIC void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/parser.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/writeback.h>\n#include <linux/mempool.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/namei.h>\n#include \"xfs_sysfs.h\"\n#include \"xfs_quota.h\"\n#include \"xfs_filestream.h\"\n#include \"xfs_icreate_item.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_icache.h\"\n#include \"xfs_inode_item.h\"\n#include \"xfs_mru_cache.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_dir2.h\"\n#include \"xfs_da_btree.h\"\n#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_fsops.h\"\n#include \"xfs_error.h\"\n#include \"xfs_alloc.h\"\n#include \"xfs_bmap.h\"\n#include \"xfs_btree.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_da_format.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs.h\"\n\nSTATIC int;\nSTATIC int;\nSTATIC int;\nSTATIC void;\n\nSTATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_comm *local_comm;\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len)\n{\n\tint rc = kstrtoint(buf, 0, &cm->local);\n\n\tif (rc)\n\t\treturn rc;\n\tif (cm->local && !local_comm)\n\t\tlocal_comm = cm;\n\treturn len;\n}"
  },
  {
    "function_name": "comm_local_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "742-745",
    "snippet": "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", cm->local);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "cm->local"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", cm->local);\n}"
  },
  {
    "function_name": "comm_nodeid_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "732-740",
    "snippet": "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\t size_t len)\n{\n\tint rc = kstrtoint(buf, 0, &cm->nodeid);\n\n\tif (rc)\n\t\treturn rc;\n\treturn len;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtoint",
          "args": [
            "buf",
            "0",
            "&cm->nodeid"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "suffix_kstrtoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_super.c",
          "lines": "140-164",
          "snippet": "STATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/parser.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mempool.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/namei.h>",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs_quota.h\"",
            "#include \"xfs_filestream.h\"",
            "#include \"xfs_icreate_item.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_icache.h\"",
            "#include \"xfs_inode_item.h\"",
            "#include \"xfs_mru_cache.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_dir2.h\"",
            "#include \"xfs_da_btree.h\"",
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_fsops.h\"",
            "#include \"xfs_error.h\"",
            "#include \"xfs_alloc.h\"",
            "#include \"xfs_bmap.h\"",
            "#include \"xfs_btree.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_da_format.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "STATIC int",
            "STATIC int",
            "STATIC int",
            "STATIC void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/parser.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/writeback.h>\n#include <linux/mempool.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/namei.h>\n#include \"xfs_sysfs.h\"\n#include \"xfs_quota.h\"\n#include \"xfs_filestream.h\"\n#include \"xfs_icreate_item.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_icache.h\"\n#include \"xfs_inode_item.h\"\n#include \"xfs_mru_cache.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_dir2.h\"\n#include \"xfs_da_btree.h\"\n#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_fsops.h\"\n#include \"xfs_error.h\"\n#include \"xfs_alloc.h\"\n#include \"xfs_bmap.h\"\n#include \"xfs_btree.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_da_format.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs.h\"\n\nSTATIC int;\nSTATIC int;\nSTATIC int;\nSTATIC void;\n\nSTATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\t size_t len)\n{\n\tint rc = kstrtoint(buf, 0, &cm->nodeid);\n\n\tif (rc)\n\t\treturn rc;\n\treturn len;\n}"
  },
  {
    "function_name": "comm_nodeid_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "727-730",
    "snippet": "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", cm->nodeid);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "cm->nodeid"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", cm->nodeid);\n}"
  },
  {
    "function_name": "store_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "718-725",
    "snippet": "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tstruct comm_attribute *cma =\n\t\tcontainer_of(a, struct comm_attribute, attr);\n\treturn cma->store ? cma->store(cm, buf, len) : -EINVAL;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cma->store",
          "args": [
            "cm",
            "buf",
            "len"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "a",
            "structcomm_attribute",
            "attr"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_comm",
          "args": [
            "i"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_comm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "442-445",
          "snippet": "static struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tstruct comm_attribute *cma =\n\t\tcontainer_of(a, struct comm_attribute, attr);\n\treturn cma->store ? cma->store(cm, buf, len) : -EINVAL;\n}"
  },
  {
    "function_name": "show_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "709-716",
    "snippet": "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tstruct comm_attribute *cma =\n\t\t\tcontainer_of(a, struct comm_attribute, attr);\n\treturn cma->show ? cma->show(cm, buf) : 0;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cma->show",
          "args": [
            "cm",
            "buf"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "a",
            "structcomm_attribute",
            "attr"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_comm",
          "args": [
            "i"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_comm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "442-445",
          "snippet": "static struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tstruct comm_attribute *cma =\n\t\t\tcontainer_of(a, struct comm_attribute, attr);\n\treturn cma->show ? cma->show(cm, buf) : 0;\n}"
  },
  {
    "function_name": "store_cluster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "699-707",
    "snippet": "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tstruct cluster_attribute *cla =\n\t\tcontainer_of(a, struct cluster_attribute, attr);\n\treturn cla->store ? cla->store(cl, buf, len) : -EINVAL;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cla->store",
          "args": [
            "cl",
            "buf",
            "len"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "a",
            "structcluster_attribute",
            "attr"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_cluster",
          "args": [
            "i"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_cluster",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "430-434",
          "snippet": "static struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tstruct cluster_attribute *cla =\n\t\tcontainer_of(a, struct cluster_attribute, attr);\n\treturn cla->store ? cla->store(cl, buf, len) : -EINVAL;\n}"
  },
  {
    "function_name": "show_cluster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "690-697",
    "snippet": "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tstruct cluster_attribute *cla =\n\t\t\tcontainer_of(a, struct cluster_attribute, attr);\n\treturn cla->show ? cla->show(cl, buf) : 0;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cla->show",
          "args": [
            "cl",
            "buf"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "a",
            "structcluster_attribute",
            "attr"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_cluster",
          "args": [
            "i"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_cluster",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "430-434",
          "snippet": "static struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tstruct cluster_attribute *cla =\n\t\t\tcontainer_of(a, struct cluster_attribute, attr);\n\treturn cla->show ? cla->show(cl, buf) : 0;\n}"
  },
  {
    "function_name": "dlm_config_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "681-684",
    "snippet": "void dlm_config_exit(void)\n{\n\tconfigfs_unregister_subsystem(&clusters_root.subsys);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "configfs_unregister_subsystem",
          "args": [
            "&clusters_root.subsys"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_unregister_subsystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/dir.c",
          "lines": "1687-1721",
          "snippet": "void configfs_unregister_subsystem(struct configfs_subsystem *subsys)\n{\n\tstruct config_group *group = &subsys->su_group;\n\tstruct dentry *dentry = group->cg_item.ci_dentry;\n\tstruct dentry *root = dentry->d_sb->s_root;\n\n\tif (dentry->d_parent != root) {\n\t\tpr_err(\"Tried to unregister non-subsystem!\\n\");\n\t\treturn;\n\t}\n\n\tmutex_lock_nested(&root->d_inode->i_mutex,\n\t\t\t  I_MUTEX_PARENT);\n\tmutex_lock_nested(&dentry->d_inode->i_mutex, I_MUTEX_CHILD);\n\tmutex_lock(&configfs_symlink_mutex);\n\tspin_lock(&configfs_dirent_lock);\n\tif (configfs_detach_prep(dentry, NULL)) {\n\t\tpr_err(\"Tried to unregister non-empty subsystem!\\n\");\n\t}\n\tspin_unlock(&configfs_dirent_lock);\n\tmutex_unlock(&configfs_symlink_mutex);\n\tconfigfs_detach_group(&group->cg_item);\n\tdentry->d_inode->i_flags |= S_DEAD;\n\tdont_mount(dentry);\n\tmutex_unlock(&dentry->d_inode->i_mutex);\n\n\td_delete(dentry);\n\n\tmutex_unlock(&root->d_inode->i_mutex);\n\n\tdput(dentry);\n\n\tunlink_group(group);\n\tconfigfs_release_fs();\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/err.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int configfs_attach_group(struct config_item *parent_item,\n\t\t\t\t struct config_item *item,\n\t\t\t\t struct dentry *dentry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/err.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstatic int configfs_attach_group(struct config_item *parent_item,\n\t\t\t\t struct config_item *item,\n\t\t\t\t struct dentry *dentry);\n\nvoid configfs_unregister_subsystem(struct configfs_subsystem *subsys)\n{\n\tstruct config_group *group = &subsys->su_group;\n\tstruct dentry *dentry = group->cg_item.ci_dentry;\n\tstruct dentry *root = dentry->d_sb->s_root;\n\n\tif (dentry->d_parent != root) {\n\t\tpr_err(\"Tried to unregister non-subsystem!\\n\");\n\t\treturn;\n\t}\n\n\tmutex_lock_nested(&root->d_inode->i_mutex,\n\t\t\t  I_MUTEX_PARENT);\n\tmutex_lock_nested(&dentry->d_inode->i_mutex, I_MUTEX_CHILD);\n\tmutex_lock(&configfs_symlink_mutex);\n\tspin_lock(&configfs_dirent_lock);\n\tif (configfs_detach_prep(dentry, NULL)) {\n\t\tpr_err(\"Tried to unregister non-empty subsystem!\\n\");\n\t}\n\tspin_unlock(&configfs_dirent_lock);\n\tmutex_unlock(&configfs_symlink_mutex);\n\tconfigfs_detach_group(&group->cg_item);\n\tdentry->d_inode->i_flags |= S_DEAD;\n\tdont_mount(dentry);\n\tmutex_unlock(&dentry->d_inode->i_mutex);\n\n\td_delete(dentry);\n\n\tmutex_unlock(&root->d_inode->i_mutex);\n\n\tdput(dentry);\n\n\tunlink_group(group);\n\tconfigfs_release_fs();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nvoid dlm_config_exit(void)\n{\n\tconfigfs_unregister_subsystem(&clusters_root.subsys);\n}"
  },
  {
    "function_name": "dlm_config_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "674-679",
    "snippet": "int __init dlm_config_init(void)\n{\n\tconfig_group_init(&clusters_root.subsys.su_group);\n\tmutex_init(&clusters_root.subsys.su_mutex);\n\treturn configfs_register_subsystem(&clusters_root.subsys);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "configfs_register_subsystem",
          "args": [
            "&clusters_root.subsys"
          ],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "configfs_register_subsystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/dir.c",
          "lines": "1639-1685",
          "snippet": "int configfs_register_subsystem(struct configfs_subsystem *subsys)\n{\n\tint err;\n\tstruct config_group *group = &subsys->su_group;\n\tstruct dentry *dentry;\n\tstruct dentry *root;\n\tstruct configfs_dirent *sd;\n\n\troot = configfs_pin_fs();\n\tif (IS_ERR(root))\n\t\treturn PTR_ERR(root);\n\n\tif (!group->cg_item.ci_name)\n\t\tgroup->cg_item.ci_name = group->cg_item.ci_namebuf;\n\n\tsd = root->d_fsdata;\n\tlink_group(to_config_group(sd->s_element), group);\n\n\tmutex_lock_nested(&root->d_inode->i_mutex, I_MUTEX_PARENT);\n\n\terr = -ENOMEM;\n\tdentry = d_alloc_name(root, group->cg_item.ci_name);\n\tif (dentry) {\n\t\td_add(dentry, NULL);\n\n\t\terr = configfs_attach_group(sd->s_element, &group->cg_item,\n\t\t\t\t\t    dentry);\n\t\tif (err) {\n\t\t\tBUG_ON(dentry->d_inode);\n\t\t\td_drop(dentry);\n\t\t\tdput(dentry);\n\t\t} else {\n\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\tconfigfs_dir_set_ready(dentry->d_fsdata);\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t}\n\t}\n\n\tmutex_unlock(&root->d_inode->i_mutex);\n\n\tif (err) {\n\t\tunlink_group(group);\n\t\tconfigfs_release_fs();\n\t}\n\n\treturn err;\n}",
          "includes": [
            "#include \"configfs_internal.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/err.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int configfs_attach_group(struct config_item *parent_item,\n\t\t\t\t struct config_item *item,\n\t\t\t\t struct dentry *dentry);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configfs_internal.h\"\n#include <linux/configfs.h>\n#include <linux/err.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstatic int configfs_attach_group(struct config_item *parent_item,\n\t\t\t\t struct config_item *item,\n\t\t\t\t struct dentry *dentry);\n\nint configfs_register_subsystem(struct configfs_subsystem *subsys)\n{\n\tint err;\n\tstruct config_group *group = &subsys->su_group;\n\tstruct dentry *dentry;\n\tstruct dentry *root;\n\tstruct configfs_dirent *sd;\n\n\troot = configfs_pin_fs();\n\tif (IS_ERR(root))\n\t\treturn PTR_ERR(root);\n\n\tif (!group->cg_item.ci_name)\n\t\tgroup->cg_item.ci_name = group->cg_item.ci_namebuf;\n\n\tsd = root->d_fsdata;\n\tlink_group(to_config_group(sd->s_element), group);\n\n\tmutex_lock_nested(&root->d_inode->i_mutex, I_MUTEX_PARENT);\n\n\terr = -ENOMEM;\n\tdentry = d_alloc_name(root, group->cg_item.ci_name);\n\tif (dentry) {\n\t\td_add(dentry, NULL);\n\n\t\terr = configfs_attach_group(sd->s_element, &group->cg_item,\n\t\t\t\t\t    dentry);\n\t\tif (err) {\n\t\t\tBUG_ON(dentry->d_inode);\n\t\t\td_drop(dentry);\n\t\t\tdput(dentry);\n\t\t} else {\n\t\t\tspin_lock(&configfs_dirent_lock);\n\t\t\tconfigfs_dir_set_ready(dentry->d_fsdata);\n\t\t\tspin_unlock(&configfs_dirent_lock);\n\t\t}\n\t}\n\n\tmutex_unlock(&root->d_inode->i_mutex);\n\n\tif (err) {\n\t\tunlink_group(group);\n\t\tconfigfs_release_fs();\n\t}\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&clusters_root.subsys.su_mutex"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_group_init",
          "args": [
            "&clusters_root.subsys.su_group"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "config_group_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "182-186",
          "snippet": "void config_group_init(struct config_group *group)\n{\n\tconfig_item_init(&group->cg_item);\n\tINIT_LIST_HEAD(&group->cg_children);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_group_init(struct config_group *group)\n{\n\tconfig_item_init(&group->cg_item);\n\tINIT_LIST_HEAD(&group->cg_children);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nint __init dlm_config_init(void)\n{\n\tconfig_group_init(&clusters_root.subsys.su_group);\n\tmutex_init(&clusters_root.subsys.su_mutex);\n\treturn configfs_register_subsystem(&clusters_root.subsys);\n}"
  },
  {
    "function_name": "release_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "657-661",
    "snippet": "static void release_node(struct config_item *i)\n{\n\tstruct dlm_node *nd = config_item_to_node(i);\n\tkfree(nd);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "nd"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_node",
          "args": [
            "i"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "447-450",
          "snippet": "static struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void release_node(struct config_item *i)\n{\n\tstruct dlm_node *nd = config_item_to_node(i);\n\tkfree(nd);\n}"
  },
  {
    "function_name": "drop_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "644-655",
    "snippet": "static void drop_node(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_space *sp = config_item_to_space(g->cg_item.ci_parent);\n\tstruct dlm_node *nd = config_item_to_node(i);\n\n\tmutex_lock(&sp->members_lock);\n\tlist_del(&nd->list);\n\tsp->members_count--;\n\tmutex_unlock(&sp->members_lock);\n\n\tconfig_item_put(i);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "i"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sp->members_lock"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&nd->list"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "recover_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/recover.c",
          "lines": "261-271",
          "snippet": "static void recover_list_del(struct dlm_rsb *r)\n{\n\tstruct dlm_ls *ls = r->res_ls;\n\n\tspin_lock(&ls->ls_recover_list_lock);\n\tlist_del_init(&r->res_recover_list);\n\tls->ls_recover_list_count--;\n\tspin_unlock(&ls->ls_recover_list_lock);\n\n\tdlm_put_rsb(r);\n}",
          "includes": [
            "#include \"recover.h\"",
            "#include \"member.h\"",
            "#include \"lowcomms.h\"",
            "#include \"lock.h\"",
            "#include \"rcom.h\"",
            "#include \"memory.h\"",
            "#include \"ast.h\"",
            "#include \"config.h\"",
            "#include \"dir.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recover.h\"\n#include \"member.h\"\n#include \"lowcomms.h\"\n#include \"lock.h\"\n#include \"rcom.h\"\n#include \"memory.h\"\n#include \"ast.h\"\n#include \"config.h\"\n#include \"dir.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n\nstatic void recover_list_del(struct dlm_rsb *r)\n{\n\tstruct dlm_ls *ls = r->res_ls;\n\n\tspin_lock(&ls->ls_recover_list_lock);\n\tlist_del_init(&r->res_recover_list);\n\tls->ls_recover_list_count--;\n\tspin_unlock(&ls->ls_recover_list_lock);\n\n\tdlm_put_rsb(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sp->members_lock"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_node",
          "args": [
            "i"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "447-450",
          "snippet": "static struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_to_space",
          "args": [
            "g->cg_item.ci_parent"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "436-440",
          "snippet": "static struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void drop_node(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_space *sp = config_item_to_space(g->cg_item.ci_parent);\n\tstruct dlm_node *nd = config_item_to_node(i);\n\n\tmutex_lock(&sp->members_lock);\n\tlist_del(&nd->list);\n\tsp->members_count--;\n\tmutex_unlock(&sp->members_lock);\n\n\tconfig_item_put(i);\n}"
  },
  {
    "function_name": "make_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "622-642",
    "snippet": "static struct config_item *make_node(struct config_group *g, const char *name)\n{\n\tstruct dlm_space *sp = config_item_to_space(g->cg_item.ci_parent);\n\tstruct dlm_node *nd;\n\n\tnd = kzalloc(sizeof(struct dlm_node), GFP_NOFS);\n\tif (!nd)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tconfig_item_init_type_name(&nd->item, name, &node_type);\n\tnd->nodeid = -1;\n\tnd->weight = 1;  /* default weight of 1 if none is set */\n\tnd->new = 1;     /* set to 0 once it's been read by dlm_nodeid_list() */\n\n\tmutex_lock(&sp->members_lock);\n\tlist_add(&nd->list, &sp->members);\n\tsp->members_count++;\n\tmutex_unlock(&sp->members_lock);\n\n\treturn &nd->item;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static struct config_item_type node_type = {\n\t.ct_item_ops = &node_ops,\n\t.ct_attrs = node_attrs,\n\t.ct_owner = THIS_MODULE,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sp->members_lock"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&nd->list",
            "&sp->members"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sp->members_lock"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_init_type_name",
          "args": [
            "&nd->item",
            "name",
            "&node_type"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_init_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "115-122",
          "snippet": "void config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_node)",
            "GFP_NOFS"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_space",
          "args": [
            "g->cg_item.ci_parent"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "436-440",
          "snippet": "static struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic struct config_item_type node_type = {\n\t.ct_item_ops = &node_ops,\n\t.ct_attrs = node_attrs,\n\t.ct_owner = THIS_MODULE,\n};\n\nstatic struct config_item *make_node(struct config_group *g, const char *name)\n{\n\tstruct dlm_space *sp = config_item_to_space(g->cg_item.ci_parent);\n\tstruct dlm_node *nd;\n\n\tnd = kzalloc(sizeof(struct dlm_node), GFP_NOFS);\n\tif (!nd)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tconfig_item_init_type_name(&nd->item, name, &node_type);\n\tnd->nodeid = -1;\n\tnd->weight = 1;  /* default weight of 1 if none is set */\n\tnd->new = 1;     /* set to 0 once it's been read by dlm_nodeid_list() */\n\n\tmutex_lock(&sp->members_lock);\n\tlist_add(&nd->list, &sp->members);\n\tsp->members_count++;\n\tmutex_unlock(&sp->members_lock);\n\n\treturn &nd->item;\n}"
  },
  {
    "function_name": "release_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "616-620",
    "snippet": "static void release_comm(struct config_item *i)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tkfree(cm);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cm"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_comm",
          "args": [
            "i"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_comm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "442-445",
          "snippet": "static struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void release_comm(struct config_item *i)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tkfree(cm);\n}"
  },
  {
    "function_name": "drop_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "605-614",
    "snippet": "static void drop_comm(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tif (local_comm == cm)\n\t\tlocal_comm = NULL;\n\tdlm_lowcomms_close(cm->nodeid);\n\twhile (cm->addr_count--)\n\t\tkfree(cm->addr[cm->addr_count]);\n\tconfig_item_put(i);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dlm_comm *local_comm;",
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "i"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cm->addr[cm->addr_count]"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_lowcomms_close",
          "args": [
            "cm->nodeid"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lowcomms_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/lowcomms.c",
          "lines": "1639-1669",
          "snippet": "int dlm_lowcomms_close(int nodeid)\n{\n\tstruct connection *con;\n\tstruct dlm_node_addr *na;\n\n\tlog_print(\"closing connection to node %d\", nodeid);\n\tcon = nodeid2con(nodeid, 0);\n\tif (con) {\n\t\tclear_bit(CF_CONNECT_PENDING, &con->flags);\n\t\tclear_bit(CF_WRITE_PENDING, &con->flags);\n\t\tset_bit(CF_CLOSE, &con->flags);\n\t\tif (cancel_work_sync(&con->swork))\n\t\t\tlog_print(\"canceled swork for node %d\", nodeid);\n\t\tif (cancel_work_sync(&con->rwork))\n\t\t\tlog_print(\"canceled rwork for node %d\", nodeid);\n\t\tclean_one_writequeue(con);\n\t\tclose_connection(con, true);\n\t}\n\n\tspin_lock(&dlm_node_addrs_spin);\n\tna = find_node_addr(nodeid);\n\tif (na) {\n\t\tlist_del(&na->list);\n\t\twhile (na->addr_count--)\n\t\t\tkfree(na->addr[na->addr_count]);\n\t\tkfree(na);\n\t}\n\tspin_unlock(&dlm_node_addrs_spin);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"config.h\"",
            "#include \"midcomms.h\"",
            "#include \"lowcomms.h\"",
            "#include \"dlm_internal.h\"",
            "#include <net/ipv6.h>",
            "#include <net/sctp/sctp.h>",
            "#include <linux/slab.h>",
            "#include <linux/sctp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <net/tcp.h>",
            "#include <net/sock.h>",
            "#include <asm/ioctls.h>"
          ],
          "macros_used": [
            "#define CF_CLOSE 6",
            "#define CF_CONNECT_PENDING 3",
            "#define CF_WRITE_PENDING 2"
          ],
          "globals_used": [
            "static DEFINE_SPINLOCK(dlm_node_addrs_spin);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include \"midcomms.h\"\n#include \"lowcomms.h\"\n#include \"dlm_internal.h\"\n#include <net/ipv6.h>\n#include <net/sctp/sctp.h>\n#include <linux/slab.h>\n#include <linux/sctp.h>\n#include <linux/mutex.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <net/tcp.h>\n#include <net/sock.h>\n#include <asm/ioctls.h>\n\n#define CF_CLOSE 6\n#define CF_CONNECT_PENDING 3\n#define CF_WRITE_PENDING 2\n\nstatic DEFINE_SPINLOCK(dlm_node_addrs_spin);\n\nint dlm_lowcomms_close(int nodeid)\n{\n\tstruct connection *con;\n\tstruct dlm_node_addr *na;\n\n\tlog_print(\"closing connection to node %d\", nodeid);\n\tcon = nodeid2con(nodeid, 0);\n\tif (con) {\n\t\tclear_bit(CF_CONNECT_PENDING, &con->flags);\n\t\tclear_bit(CF_WRITE_PENDING, &con->flags);\n\t\tset_bit(CF_CLOSE, &con->flags);\n\t\tif (cancel_work_sync(&con->swork))\n\t\t\tlog_print(\"canceled swork for node %d\", nodeid);\n\t\tif (cancel_work_sync(&con->rwork))\n\t\t\tlog_print(\"canceled rwork for node %d\", nodeid);\n\t\tclean_one_writequeue(con);\n\t\tclose_connection(con, true);\n\t}\n\n\tspin_lock(&dlm_node_addrs_spin);\n\tna = find_node_addr(nodeid);\n\tif (na) {\n\t\tlist_del(&na->list);\n\t\twhile (na->addr_count--)\n\t\t\tkfree(na->addr[na->addr_count]);\n\t\tkfree(na);\n\t}\n\tspin_unlock(&dlm_node_addrs_spin);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_to_comm",
          "args": [
            "i"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_comm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "442-445",
          "snippet": "static struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_comm *local_comm;\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void drop_comm(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_comm *cm = config_item_to_comm(i);\n\tif (local_comm == cm)\n\t\tlocal_comm = NULL;\n\tdlm_lowcomms_close(cm->nodeid);\n\twhile (cm->addr_count--)\n\t\tkfree(cm->addr[cm->addr_count]);\n\tconfig_item_put(i);\n}"
  },
  {
    "function_name": "make_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "585-603",
    "snippet": "static struct config_item *make_comm(struct config_group *g, const char *name)\n{\n\tstruct dlm_comm *cm;\n\n\tcm = kzalloc(sizeof(struct dlm_comm), GFP_NOFS);\n\tif (!cm)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tconfig_item_init_type_name(&cm->item, name, &comm_type);\n\n\tcm->seq = dlm_comm_count++;\n\tif (!cm->seq)\n\t\tcm->seq = dlm_comm_count++;\n\n\tcm->nodeid = -1;\n\tcm->local = 0;\n\tcm->addr_count = 0;\n\treturn &cm->item;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static uint32_t dlm_comm_count;",
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);",
      "static struct config_item_type comm_type = {\n\t.ct_item_ops = &comm_ops,\n\t.ct_attrs = comm_attrs,\n\t.ct_owner = THIS_MODULE,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_init_type_name",
          "args": [
            "&cm->item",
            "name",
            "&comm_type"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_init_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "115-122",
          "snippet": "void config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_comm)",
            "GFP_NOFS"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic uint32_t dlm_comm_count;\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\nstatic struct config_item_type comm_type = {\n\t.ct_item_ops = &comm_ops,\n\t.ct_attrs = comm_attrs,\n\t.ct_owner = THIS_MODULE,\n};\n\nstatic struct config_item *make_comm(struct config_group *g, const char *name)\n{\n\tstruct dlm_comm *cm;\n\n\tcm = kzalloc(sizeof(struct dlm_comm), GFP_NOFS);\n\tif (!cm)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tconfig_item_init_type_name(&cm->item, name, &comm_type);\n\n\tcm->seq = dlm_comm_count++;\n\tif (!cm->seq)\n\t\tcm->seq = dlm_comm_count++;\n\n\tcm->nodeid = -1;\n\tcm->local = 0;\n\tcm->addr_count = 0;\n\treturn &cm->item;\n}"
  },
  {
    "function_name": "release_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "578-583",
    "snippet": "static void release_space(struct config_item *i)\n{\n\tstruct dlm_space *sp = config_item_to_space(i);\n\tkfree(sp->group.default_groups);\n\tkfree(sp);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sp"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sp->group.default_groups"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_space",
          "args": [
            "i"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "436-440",
          "snippet": "static struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void release_space(struct config_item *i)\n{\n\tstruct dlm_space *sp = config_item_to_space(i);\n\tkfree(sp->group.default_groups);\n\tkfree(sp);\n}"
  },
  {
    "function_name": "drop_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "561-576",
    "snippet": "static void drop_space(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_space *sp = config_item_to_space(i);\n\tstruct config_item *tmp;\n\tint j;\n\n\t/* assert list_empty(&sp->members) */\n\n\tfor (j = 0; sp->group.default_groups[j]; j++) {\n\t\ttmp = &sp->group.default_groups[j]->cg_item;\n\t\tsp->group.default_groups[j] = NULL;\n\t\tconfig_item_put(tmp);\n\t}\n\n\tconfig_item_put(i);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "i"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_to_space",
          "args": [
            "i"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "436-440",
          "snippet": "static struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void drop_space(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_space *sp = config_item_to_space(i);\n\tstruct config_item *tmp;\n\tint j;\n\n\t/* assert list_empty(&sp->members) */\n\n\tfor (j = 0; sp->group.default_groups[j]; j++) {\n\t\ttmp = &sp->group.default_groups[j]->cg_item;\n\t\tsp->group.default_groups[j] = NULL;\n\t\tconfig_item_put(tmp);\n\t}\n\n\tconfig_item_put(i);\n}"
  },
  {
    "function_name": "make_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "529-559",
    "snippet": "static struct config_group *make_space(struct config_group *g, const char *name)\n{\n\tstruct dlm_space *sp = NULL;\n\tstruct dlm_nodes *nds = NULL;\n\tvoid *gps = NULL;\n\n\tsp = kzalloc(sizeof(struct dlm_space), GFP_NOFS);\n\tgps = kcalloc(2, sizeof(struct config_group *), GFP_NOFS);\n\tnds = kzalloc(sizeof(struct dlm_nodes), GFP_NOFS);\n\n\tif (!sp || !gps || !nds)\n\t\tgoto fail;\n\n\tconfig_group_init_type_name(&sp->group, name, &space_type);\n\tconfig_group_init_type_name(&nds->ns_group, \"nodes\", &nodes_type);\n\n\tsp->group.default_groups = gps;\n\tsp->group.default_groups[0] = &nds->ns_group;\n\tsp->group.default_groups[1] = NULL;\n\n\tINIT_LIST_HEAD(&sp->members);\n\tmutex_init(&sp->members_lock);\n\tsp->members_count = 0;\n\treturn &sp->group;\n\n fail:\n\tkfree(sp);\n\tkfree(gps);\n\tkfree(nds);\n\treturn ERR_PTR(-ENOMEM);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static struct config_item_type space_type = {\n\t.ct_item_ops = &space_ops,\n\t.ct_owner = THIS_MODULE,\n};",
      "static struct config_item_type nodes_type = {\n\t.ct_group_ops = &nodes_ops,\n\t.ct_owner = THIS_MODULE,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "nds"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "gps"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sp"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&sp->members_lock"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&sp->members"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_group_init_type_name",
          "args": [
            "&nds->ns_group",
            "\"nodes\"",
            "&nodes_type"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "config_group_init_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "125-131",
          "snippet": "void config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_nodes)",
            "GFP_NOFS"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "2",
            "sizeof(struct config_group *)",
            "GFP_NOFS"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_space)",
            "GFP_NOFS"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic struct config_item_type space_type = {\n\t.ct_item_ops = &space_ops,\n\t.ct_owner = THIS_MODULE,\n};\nstatic struct config_item_type nodes_type = {\n\t.ct_group_ops = &nodes_ops,\n\t.ct_owner = THIS_MODULE,\n};\n\nstatic struct config_group *make_space(struct config_group *g, const char *name)\n{\n\tstruct dlm_space *sp = NULL;\n\tstruct dlm_nodes *nds = NULL;\n\tvoid *gps = NULL;\n\n\tsp = kzalloc(sizeof(struct dlm_space), GFP_NOFS);\n\tgps = kcalloc(2, sizeof(struct config_group *), GFP_NOFS);\n\tnds = kzalloc(sizeof(struct dlm_nodes), GFP_NOFS);\n\n\tif (!sp || !gps || !nds)\n\t\tgoto fail;\n\n\tconfig_group_init_type_name(&sp->group, name, &space_type);\n\tconfig_group_init_type_name(&nds->ns_group, \"nodes\", &nodes_type);\n\n\tsp->group.default_groups = gps;\n\tsp->group.default_groups[0] = &nds->ns_group;\n\tsp->group.default_groups[1] = NULL;\n\n\tINIT_LIST_HEAD(&sp->members);\n\tmutex_init(&sp->members_lock);\n\tsp->members_count = 0;\n\treturn &sp->group;\n\n fail:\n\tkfree(sp);\n\tkfree(gps);\n\tkfree(nds);\n\treturn ERR_PTR(-ENOMEM);\n}"
  },
  {
    "function_name": "release_cluster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "522-527",
    "snippet": "static void release_cluster(struct config_item *i)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tkfree(cl->group.default_groups);\n\tkfree(cl);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cl"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cl->group.default_groups"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_to_cluster",
          "args": [
            "i"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_cluster",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "430-434",
          "snippet": "static struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void release_cluster(struct config_item *i)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tkfree(cl->group.default_groups);\n\tkfree(cl);\n}"
  },
  {
    "function_name": "drop_cluster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "504-520",
    "snippet": "static void drop_cluster(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tstruct config_item *tmp;\n\tint j;\n\n\tfor (j = 0; cl->group.default_groups[j]; j++) {\n\t\ttmp = &cl->group.default_groups[j]->cg_item;\n\t\tcl->group.default_groups[j] = NULL;\n\t\tconfig_item_put(tmp);\n\t}\n\n\tspace_list = NULL;\n\tcomm_list = NULL;\n\n\tconfig_item_put(i);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *space_list;",
      "static struct config_group *comm_list;",
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "i"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_to_cluster",
          "args": [
            "i"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_to_cluster",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "430-434",
          "snippet": "static struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void drop_cluster(struct config_group *, struct config_item *);",
            "static void release_cluster(struct config_item *);",
            "static void drop_space(struct config_group *, struct config_item *);",
            "static void release_space(struct config_item *);",
            "static void drop_comm(struct config_group *, struct config_item *);",
            "static void release_comm(struct config_item *);",
            "static void drop_node(struct config_group *, struct config_item *);",
            "static void release_node(struct config_item *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *space_list;\nstatic struct config_group *comm_list;\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic void drop_cluster(struct config_group *g, struct config_item *i)\n{\n\tstruct dlm_cluster *cl = config_item_to_cluster(i);\n\tstruct config_item *tmp;\n\tint j;\n\n\tfor (j = 0; cl->group.default_groups[j]; j++) {\n\t\ttmp = &cl->group.default_groups[j]->cg_item;\n\t\tcl->group.default_groups[j] = NULL;\n\t\tconfig_item_put(tmp);\n\t}\n\n\tspace_list = NULL;\n\tcomm_list = NULL;\n\n\tconfig_item_put(i);\n}"
  },
  {
    "function_name": "make_cluster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "452-502",
    "snippet": "static struct config_group *make_cluster(struct config_group *g,\n\t\t\t\t\t const char *name)\n{\n\tstruct dlm_cluster *cl = NULL;\n\tstruct dlm_spaces *sps = NULL;\n\tstruct dlm_comms *cms = NULL;\n\tvoid *gps = NULL;\n\n\tcl = kzalloc(sizeof(struct dlm_cluster), GFP_NOFS);\n\tgps = kcalloc(3, sizeof(struct config_group *), GFP_NOFS);\n\tsps = kzalloc(sizeof(struct dlm_spaces), GFP_NOFS);\n\tcms = kzalloc(sizeof(struct dlm_comms), GFP_NOFS);\n\n\tif (!cl || !gps || !sps || !cms)\n\t\tgoto fail;\n\n\tconfig_group_init_type_name(&cl->group, name, &cluster_type);\n\tconfig_group_init_type_name(&sps->ss_group, \"spaces\", &spaces_type);\n\tconfig_group_init_type_name(&cms->cs_group, \"comms\", &comms_type);\n\n\tcl->group.default_groups = gps;\n\tcl->group.default_groups[0] = &sps->ss_group;\n\tcl->group.default_groups[1] = &cms->cs_group;\n\tcl->group.default_groups[2] = NULL;\n\n\tcl->cl_tcp_port = dlm_config.ci_tcp_port;\n\tcl->cl_buffer_size = dlm_config.ci_buffer_size;\n\tcl->cl_rsbtbl_size = dlm_config.ci_rsbtbl_size;\n\tcl->cl_recover_timer = dlm_config.ci_recover_timer;\n\tcl->cl_toss_secs = dlm_config.ci_toss_secs;\n\tcl->cl_scan_secs = dlm_config.ci_scan_secs;\n\tcl->cl_log_debug = dlm_config.ci_log_debug;\n\tcl->cl_protocol = dlm_config.ci_protocol;\n\tcl->cl_timewarn_cs = dlm_config.ci_timewarn_cs;\n\tcl->cl_waitwarn_us = dlm_config.ci_waitwarn_us;\n\tcl->cl_new_rsb_count = dlm_config.ci_new_rsb_count;\n\tcl->cl_recover_callbacks = dlm_config.ci_recover_callbacks;\n\tmemcpy(cl->cl_cluster_name, dlm_config.ci_cluster_name,\n\t       DLM_LOCKSPACE_LEN);\n\n\tspace_list = &sps->ss_group;\n\tcomm_list = &cms->cs_group;\n\treturn &cl->group;\n\n fail:\n\tkfree(cl);\n\tkfree(gps);\n\tkfree(sps);\n\tkfree(cms);\n\treturn ERR_PTR(-ENOMEM);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_group *space_list;",
      "static struct config_group *comm_list;",
      "static struct config_group *make_cluster(struct config_group *, const char *);",
      "static struct config_group *make_space(struct config_group *, const char *);",
      "static struct config_item *make_comm(struct config_group *, const char *);",
      "static struct config_item *make_node(struct config_group *, const char *);",
      "static struct config_item_type cluster_type = {\n\t.ct_item_ops = &cluster_ops,\n\t.ct_attrs = cluster_attrs,\n\t.ct_owner = THIS_MODULE,\n};",
      "static struct config_item_type spaces_type = {\n\t.ct_group_ops = &spaces_ops,\n\t.ct_owner = THIS_MODULE,\n};",
      "static struct config_item_type comms_type = {\n\t.ct_group_ops = &comms_ops,\n\t.ct_owner = THIS_MODULE,\n};",
      "struct dlm_config_info dlm_config = {\n\t.ci_tcp_port = DEFAULT_TCP_PORT,\n\t.ci_buffer_size = DEFAULT_BUFFER_SIZE,\n\t.ci_rsbtbl_size = DEFAULT_RSBTBL_SIZE,\n\t.ci_recover_timer = DEFAULT_RECOVER_TIMER,\n\t.ci_toss_secs = DEFAULT_TOSS_SECS,\n\t.ci_scan_secs = DEFAULT_SCAN_SECS,\n\t.ci_log_debug = DEFAULT_LOG_DEBUG,\n\t.ci_protocol = DEFAULT_PROTOCOL,\n\t.ci_timewarn_cs = DEFAULT_TIMEWARN_CS,\n\t.ci_waitwarn_us = DEFAULT_WAITWARN_US,\n\t.ci_new_rsb_count = DEFAULT_NEW_RSB_COUNT,\n\t.ci_recover_callbacks = DEFAULT_RECOVER_CALLBACKS,\n\t.ci_cluster_name = DEFAULT_CLUSTER_NAME\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cms"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sps"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "gps"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cl"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "cl->cl_cluster_name",
            "dlm_config.ci_cluster_name",
            "DLM_LOCKSPACE_LEN"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_group_init_type_name",
          "args": [
            "&cms->cs_group",
            "\"comms\"",
            "&comms_type"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "config_group_init_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "125-131",
          "snippet": "void config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_comms)",
            "GFP_NOFS"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_spaces)",
            "GFP_NOFS"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "3",
            "sizeof(struct config_group *)",
            "GFP_NOFS"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_cluster)",
            "GFP_NOFS"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct config_group *space_list;\nstatic struct config_group *comm_list;\nstatic struct config_group *make_cluster(struct config_group *, const char *);\nstatic struct config_group *make_space(struct config_group *, const char *);\nstatic struct config_item *make_comm(struct config_group *, const char *);\nstatic struct config_item *make_node(struct config_group *, const char *);\nstatic struct config_item_type cluster_type = {\n\t.ct_item_ops = &cluster_ops,\n\t.ct_attrs = cluster_attrs,\n\t.ct_owner = THIS_MODULE,\n};\nstatic struct config_item_type spaces_type = {\n\t.ct_group_ops = &spaces_ops,\n\t.ct_owner = THIS_MODULE,\n};\nstatic struct config_item_type comms_type = {\n\t.ct_group_ops = &comms_ops,\n\t.ct_owner = THIS_MODULE,\n};\nstruct dlm_config_info dlm_config = {\n\t.ci_tcp_port = DEFAULT_TCP_PORT,\n\t.ci_buffer_size = DEFAULT_BUFFER_SIZE,\n\t.ci_rsbtbl_size = DEFAULT_RSBTBL_SIZE,\n\t.ci_recover_timer = DEFAULT_RECOVER_TIMER,\n\t.ci_toss_secs = DEFAULT_TOSS_SECS,\n\t.ci_scan_secs = DEFAULT_SCAN_SECS,\n\t.ci_log_debug = DEFAULT_LOG_DEBUG,\n\t.ci_protocol = DEFAULT_PROTOCOL,\n\t.ci_timewarn_cs = DEFAULT_TIMEWARN_CS,\n\t.ci_waitwarn_us = DEFAULT_WAITWARN_US,\n\t.ci_new_rsb_count = DEFAULT_NEW_RSB_COUNT,\n\t.ci_recover_callbacks = DEFAULT_RECOVER_CALLBACKS,\n\t.ci_cluster_name = DEFAULT_CLUSTER_NAME\n};\n\nstatic struct config_group *make_cluster(struct config_group *g,\n\t\t\t\t\t const char *name)\n{\n\tstruct dlm_cluster *cl = NULL;\n\tstruct dlm_spaces *sps = NULL;\n\tstruct dlm_comms *cms = NULL;\n\tvoid *gps = NULL;\n\n\tcl = kzalloc(sizeof(struct dlm_cluster), GFP_NOFS);\n\tgps = kcalloc(3, sizeof(struct config_group *), GFP_NOFS);\n\tsps = kzalloc(sizeof(struct dlm_spaces), GFP_NOFS);\n\tcms = kzalloc(sizeof(struct dlm_comms), GFP_NOFS);\n\n\tif (!cl || !gps || !sps || !cms)\n\t\tgoto fail;\n\n\tconfig_group_init_type_name(&cl->group, name, &cluster_type);\n\tconfig_group_init_type_name(&sps->ss_group, \"spaces\", &spaces_type);\n\tconfig_group_init_type_name(&cms->cs_group, \"comms\", &comms_type);\n\n\tcl->group.default_groups = gps;\n\tcl->group.default_groups[0] = &sps->ss_group;\n\tcl->group.default_groups[1] = &cms->cs_group;\n\tcl->group.default_groups[2] = NULL;\n\n\tcl->cl_tcp_port = dlm_config.ci_tcp_port;\n\tcl->cl_buffer_size = dlm_config.ci_buffer_size;\n\tcl->cl_rsbtbl_size = dlm_config.ci_rsbtbl_size;\n\tcl->cl_recover_timer = dlm_config.ci_recover_timer;\n\tcl->cl_toss_secs = dlm_config.ci_toss_secs;\n\tcl->cl_scan_secs = dlm_config.ci_scan_secs;\n\tcl->cl_log_debug = dlm_config.ci_log_debug;\n\tcl->cl_protocol = dlm_config.ci_protocol;\n\tcl->cl_timewarn_cs = dlm_config.ci_timewarn_cs;\n\tcl->cl_waitwarn_us = dlm_config.ci_waitwarn_us;\n\tcl->cl_new_rsb_count = dlm_config.ci_new_rsb_count;\n\tcl->cl_recover_callbacks = dlm_config.ci_recover_callbacks;\n\tmemcpy(cl->cl_cluster_name, dlm_config.ci_cluster_name,\n\t       DLM_LOCKSPACE_LEN);\n\n\tspace_list = &sps->ss_group;\n\tcomm_list = &cms->cs_group;\n\treturn &cl->group;\n\n fail:\n\tkfree(cl);\n\tkfree(gps);\n\tkfree(sps);\n\tkfree(cms);\n\treturn ERR_PTR(-ENOMEM);\n}"
  },
  {
    "function_name": "config_item_to_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "447-450",
    "snippet": "static struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "i",
            "structdlm_node",
            "item"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_node *config_item_to_node(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_node, item) : NULL;\n}"
  },
  {
    "function_name": "config_item_to_comm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "442-445",
    "snippet": "static struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "i",
            "structdlm_comm",
            "item"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_comm *config_item_to_comm(struct config_item *i)\n{\n\treturn i ? container_of(i, struct dlm_comm, item) : NULL;\n}"
  },
  {
    "function_name": "config_item_to_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "436-440",
    "snippet": "static struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "to_config_group(i)",
            "structdlm_space",
            "group"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_config_group",
          "args": [
            "i"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_space *config_item_to_space(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_space, group) :\n\t\t   NULL;\n}"
  },
  {
    "function_name": "config_item_to_cluster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "430-434",
    "snippet": "static struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drop_cluster(struct config_group *, struct config_item *);",
      "static void release_cluster(struct config_item *);",
      "static void drop_space(struct config_group *, struct config_item *);",
      "static void release_space(struct config_item *);",
      "static void drop_comm(struct config_group *, struct config_item *);",
      "static void release_comm(struct config_item *);",
      "static void drop_node(struct config_group *, struct config_item *);",
      "static void release_node(struct config_item *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "to_config_group(i)",
            "structdlm_cluster",
            "group"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_config_group",
          "args": [
            "i"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void drop_cluster(struct config_group *, struct config_item *);\nstatic void release_cluster(struct config_item *);\nstatic void drop_space(struct config_group *, struct config_item *);\nstatic void release_space(struct config_item *);\nstatic void drop_comm(struct config_group *, struct config_item *);\nstatic void release_comm(struct config_item *);\nstatic void drop_node(struct config_group *, struct config_item *);\nstatic void release_node(struct config_item *);\n\nstatic struct dlm_cluster *config_item_to_cluster(struct config_item *i)\n{\n\treturn i ? container_of(to_config_group(i), struct dlm_cluster, group) :\n\t\t   NULL;\n}"
  },
  {
    "function_name": "cluster_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "155-175",
    "snippet": "static ssize_t cluster_set(struct dlm_cluster *cl, unsigned int *cl_field,\n\t\t\t   int *info_field, int check_zero,\n\t\t\t   const char *buf, size_t len)\n{\n\tunsigned int x;\n\tint rc;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\trc = kstrtouint(buf, 0, &x);\n\tif (rc)\n\t\treturn rc;\n\n\tif (check_zero && !x)\n\t\treturn -EINVAL;\n\n\t*cl_field = x;\n\t*info_field = x;\n\n\treturn len;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtouint",
          "args": [
            "buf",
            "0",
            "&x"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\n\nstatic ssize_t cluster_set(struct dlm_cluster *cl, unsigned int *cl_field,\n\t\t\t   int *info_field, int check_zero,\n\t\t\t   const char *buf, size_t len)\n{\n\tunsigned int x;\n\tint rc;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\trc = kstrtouint(buf, 0, &x);\n\tif (rc)\n\t\treturn rc;\n\n\tif (check_zero && !x)\n\t\treturn -EINVAL;\n\n\t*cl_field = x;\n\t*info_field = x;\n\n\treturn len;\n}"
  },
  {
    "function_name": "cluster_cluster_name_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "138-145",
    "snippet": "static ssize_t cluster_cluster_name_write(struct dlm_cluster *cl,\n\t\t\t\t\t  const char *buf, size_t len)\n{\n\tstrlcpy(dlm_config.ci_cluster_name, buf,\n\t\t\t\tsizeof(dlm_config.ci_cluster_name));\n\tstrlcpy(cl->cl_cluster_name, buf, sizeof(cl->cl_cluster_name));\n\treturn len;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);",
      "struct dlm_config_info dlm_config = {\n\t.ci_tcp_port = DEFAULT_TCP_PORT,\n\t.ci_buffer_size = DEFAULT_BUFFER_SIZE,\n\t.ci_rsbtbl_size = DEFAULT_RSBTBL_SIZE,\n\t.ci_recover_timer = DEFAULT_RECOVER_TIMER,\n\t.ci_toss_secs = DEFAULT_TOSS_SECS,\n\t.ci_scan_secs = DEFAULT_SCAN_SECS,\n\t.ci_log_debug = DEFAULT_LOG_DEBUG,\n\t.ci_protocol = DEFAULT_PROTOCOL,\n\t.ci_timewarn_cs = DEFAULT_TIMEWARN_CS,\n\t.ci_waitwarn_us = DEFAULT_WAITWARN_US,\n\t.ci_new_rsb_count = DEFAULT_NEW_RSB_COUNT,\n\t.ci_recover_callbacks = DEFAULT_RECOVER_CALLBACKS,\n\t.ci_cluster_name = DEFAULT_CLUSTER_NAME\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "cl->cl_cluster_name",
            "buf",
            "sizeof(cl->cl_cluster_name)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "dlm_config.ci_cluster_name",
            "buf",
            "sizeof(dlm_config.ci_cluster_name)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t store_cluster(struct config_item *i,\n\t\t\t     struct configfs_attribute *a,\n\t\t\t     const char *buf, size_t len);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t store_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t  const char *buf, size_t len);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_nodeid_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_write(struct dlm_comm *cm, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_nodeid_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_write(struct dlm_node *nd, const char *buf,\n\t\t\t\tsize_t len);\nstruct dlm_config_info dlm_config = {\n\t.ci_tcp_port = DEFAULT_TCP_PORT,\n\t.ci_buffer_size = DEFAULT_BUFFER_SIZE,\n\t.ci_rsbtbl_size = DEFAULT_RSBTBL_SIZE,\n\t.ci_recover_timer = DEFAULT_RECOVER_TIMER,\n\t.ci_toss_secs = DEFAULT_TOSS_SECS,\n\t.ci_scan_secs = DEFAULT_SCAN_SECS,\n\t.ci_log_debug = DEFAULT_LOG_DEBUG,\n\t.ci_protocol = DEFAULT_PROTOCOL,\n\t.ci_timewarn_cs = DEFAULT_TIMEWARN_CS,\n\t.ci_waitwarn_us = DEFAULT_WAITWARN_US,\n\t.ci_new_rsb_count = DEFAULT_NEW_RSB_COUNT,\n\t.ci_recover_callbacks = DEFAULT_RECOVER_CALLBACKS,\n\t.ci_cluster_name = DEFAULT_CLUSTER_NAME\n};\n\nstatic ssize_t cluster_cluster_name_write(struct dlm_cluster *cl,\n\t\t\t\t\t  const char *buf, size_t len)\n{\n\tstrlcpy(dlm_config.ci_cluster_name, buf,\n\t\t\t\tsizeof(dlm_config.ci_cluster_name));\n\tstrlcpy(cl->cl_cluster_name, buf, sizeof(cl->cl_cluster_name));\n\treturn len;\n}"
  },
  {
    "function_name": "cluster_cluster_name_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
    "lines": "133-136",
    "snippet": "static ssize_t cluster_cluster_name_read(struct dlm_cluster *cl, char *buf)\n{\n\treturn sprintf(buf, \"%s\\n\", cl->cl_cluster_name);\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include <net/sock.h>",
      "#include <net/ipv6.h>",
      "#include <linux/dlmconstants.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/slab.h>",
      "#include <linux/configfs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);",
      "static ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);",
      "static ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_local_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);",
      "static ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);",
      "static ssize_t node_weight_read(struct dlm_node *nd, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "cl->cl_cluster_name"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t show_cluster(struct config_item *i, struct configfs_attribute *a,\n\t\t\t    char *buf);\nstatic ssize_t show_comm(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t show_node(struct config_item *i, struct configfs_attribute *a,\n\t\t\t char *buf);\nstatic ssize_t comm_nodeid_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_local_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t comm_addr_list_read(struct dlm_comm *cm, char *buf);\nstatic ssize_t node_nodeid_read(struct dlm_node *nd, char *buf);\nstatic ssize_t node_weight_read(struct dlm_node *nd, char *buf);\n\nstatic ssize_t cluster_cluster_name_read(struct dlm_cluster *cl, char *buf)\n{\n\treturn sprintf(buf, \"%s\\n\", cl->cl_cluster_name);\n}"
  }
]