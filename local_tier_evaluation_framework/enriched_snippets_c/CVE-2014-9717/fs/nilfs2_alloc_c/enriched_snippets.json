[
  {
    "function_name": "nilfs_palloc_destroy_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "780-784",
    "snippet": "void nilfs_palloc_destroy_cache(struct inode *inode)\n{\n\tnilfs_palloc_clear_cache(inode);\n\tNILFS_MDT(inode)->mi_palloc_cache = NULL;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_clear_cache",
          "args": [
            "inode"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_clear_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "766-778",
          "snippet": "void nilfs_palloc_clear_cache(struct inode *inode)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\tspin_lock(&cache->lock);\n\tbrelse(cache->prev_desc.bh);\n\tbrelse(cache->prev_bitmap.bh);\n\tbrelse(cache->prev_entry.bh);\n\tcache->prev_desc.bh = NULL;\n\tcache->prev_bitmap.bh = NULL;\n\tcache->prev_entry.bh = NULL;\n\tspin_unlock(&cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_clear_cache(struct inode *inode)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\tspin_lock(&cache->lock);\n\tbrelse(cache->prev_desc.bh);\n\tbrelse(cache->prev_bitmap.bh);\n\tbrelse(cache->prev_entry.bh);\n\tcache->prev_desc.bh = NULL;\n\tcache->prev_bitmap.bh = NULL;\n\tcache->prev_entry.bh = NULL;\n\tspin_unlock(&cache->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_destroy_cache(struct inode *inode)\n{\n\tnilfs_palloc_clear_cache(inode);\n\tNILFS_MDT(inode)->mi_palloc_cache = NULL;\n}"
  },
  {
    "function_name": "nilfs_palloc_clear_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "766-778",
    "snippet": "void nilfs_palloc_clear_cache(struct inode *inode)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\tspin_lock(&cache->lock);\n\tbrelse(cache->prev_desc.bh);\n\tbrelse(cache->prev_bitmap.bh);\n\tbrelse(cache->prev_entry.bh);\n\tcache->prev_desc.bh = NULL;\n\tcache->prev_bitmap.bh = NULL;\n\tcache->prev_entry.bh = NULL;\n\tspin_unlock(&cache->lock);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cache->lock"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "cache->prev_entry.bh"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cache->lock"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_clear_cache(struct inode *inode)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\tspin_lock(&cache->lock);\n\tbrelse(cache->prev_desc.bh);\n\tbrelse(cache->prev_bitmap.bh);\n\tbrelse(cache->prev_entry.bh);\n\tcache->prev_desc.bh = NULL;\n\tcache->prev_bitmap.bh = NULL;\n\tcache->prev_entry.bh = NULL;\n\tspin_unlock(&cache->lock);\n}"
  },
  {
    "function_name": "nilfs_palloc_setup_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "759-764",
    "snippet": "void nilfs_palloc_setup_cache(struct inode *inode,\n\t\t\t      struct nilfs_palloc_cache *cache)\n{\n\tNILFS_MDT(inode)->mi_palloc_cache = cache;\n\tspin_lock_init(&cache->lock);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&cache->lock"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_setup_cache(struct inode *inode,\n\t\t\t      struct nilfs_palloc_cache *cache)\n{\n\tNILFS_MDT(inode)->mi_palloc_cache = cache;\n\tspin_lock_init(&cache->lock);\n}"
  },
  {
    "function_name": "nilfs_palloc_freev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "703-757",
    "snippet": "int nilfs_palloc_freev(struct inode *inode, __u64 *entry_nrs, size_t nitems)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, group_offset;\n\tint i, j, n, ret;\n\n\tfor (i = 0; i < nitems; i = j) {\n\t\tgroup = nilfs_palloc_group(inode, entry_nrs[i], &group_offset);\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 0, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tret = nilfs_palloc_get_bitmap_block(inode, group, 0,\n\t\t\t\t\t\t    &bitmap_bh);\n\t\tif (ret < 0) {\n\t\t\tbrelse(desc_bh);\n\t\t\treturn ret;\n\t\t}\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\tfor (j = i, n = 0;\n\t\t     (j < nitems) && nilfs_palloc_group_is_in(inode, group,\n\t\t\t\t\t\t\t      entry_nrs[j]);\n\t\t     j++) {\n\t\t\tnilfs_palloc_group(inode, entry_nrs[j], &group_offset);\n\t\t\tif (!nilfs_clear_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap)) {\n\t\t\t\tprintk(KERN_WARNING\n\t\t\t\t       \"%s: entry number %llu already freed\\n\",\n\t\t\t\t       __func__,\n\t\t\t\t       (unsigned long long)entry_nrs[j]);\n\t\t\t} else {\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, n);\n\n\t\tkunmap(bitmap_bh->b_page);\n\t\tkunmap(desc_bh->b_page);\n\n\t\tmark_buffer_dirty(desc_bh);\n\t\tmark_buffer_dirty(bitmap_bh);\n\t\tnilfs_mdt_mark_dirty(inode);\n\n\t\tbrelse(bitmap_bh);\n\t\tbrelse(desc_bh);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "desc_bh"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_mark_dirty",
          "args": [
            "inode"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "98-102",
          "snippet": "static inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bitmap_bh"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "desc_bh->b_page"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "bitmap_bh->b_page"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group_desc_add_entries",
          "args": [
            "inode",
            "group",
            "desc",
            "n"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_desc_add_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "159-168",
          "snippet": "static void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING\n\t\t\t\t       \"%s: entry number %llu already freed\\n\"",
            "__func__",
            "(unsigned long long)entry_nrs[j]"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_clear_bit_atomic",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)",
            "group_offset",
            "bitmap"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group",
          "args": [
            "inode",
            "entry_nrs[j]",
            "&group_offset"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_is_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "687-695",
          "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bitmap_bh"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "bitmap_bh->b_page"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_group_desc",
          "args": [
            "inode",
            "group",
            "desc_bh",
            "desc_kaddr"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_group_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "305-312",
          "snippet": "static struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "desc_bh->b_page"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_bitmap_block",
          "args": [
            "inode",
            "group",
            "0",
            "&bitmap_bh"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_bitmap_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "268-278",
          "snippet": "static int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_desc_block",
          "args": [
            "inode",
            "group",
            "0",
            "&desc_bh"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "249-259",
          "snippet": "static int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_freev(struct inode *inode, __u64 *entry_nrs, size_t nitems)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, group_offset;\n\tint i, j, n, ret;\n\n\tfor (i = 0; i < nitems; i = j) {\n\t\tgroup = nilfs_palloc_group(inode, entry_nrs[i], &group_offset);\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 0, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tret = nilfs_palloc_get_bitmap_block(inode, group, 0,\n\t\t\t\t\t\t    &bitmap_bh);\n\t\tif (ret < 0) {\n\t\t\tbrelse(desc_bh);\n\t\t\treturn ret;\n\t\t}\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\tfor (j = i, n = 0;\n\t\t     (j < nitems) && nilfs_palloc_group_is_in(inode, group,\n\t\t\t\t\t\t\t      entry_nrs[j]);\n\t\t     j++) {\n\t\t\tnilfs_palloc_group(inode, entry_nrs[j], &group_offset);\n\t\t\tif (!nilfs_clear_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap)) {\n\t\t\t\tprintk(KERN_WARNING\n\t\t\t\t       \"%s: entry number %llu already freed\\n\",\n\t\t\t\t       __func__,\n\t\t\t\t       (unsigned long long)entry_nrs[j]);\n\t\t\t} else {\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, n);\n\n\t\tkunmap(bitmap_bh->b_page);\n\t\tkunmap(desc_bh->b_page);\n\n\t\tmark_buffer_dirty(desc_bh);\n\t\tmark_buffer_dirty(bitmap_bh);\n\t\tnilfs_mdt_mark_dirty(inode);\n\n\t\tbrelse(bitmap_bh);\n\t\tbrelse(desc_bh);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_palloc_group_is_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "687-695",
    "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_entries_per_group",
          "args": [
            "inode"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_entries_per_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.h",
          "lines": "39-43",
          "snippet": "static inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
  },
  {
    "function_name": "nilfs_palloc_abort_free_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "670-679",
    "snippet": "void nilfs_palloc_abort_free_entry(struct inode *inode,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "req->pr_desc_bh"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_abort_free_entry(struct inode *inode,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}"
  },
  {
    "function_name": "nilfs_palloc_prepare_free_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "643-663",
    "snippet": "int nilfs_palloc_prepare_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tunsigned long group, group_offset;\n\tint ret;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\tret = nilfs_palloc_get_bitmap_block(inode, group, 1, &bitmap_bh);\n\tif (ret < 0) {\n\t\tbrelse(desc_bh);\n\t\treturn ret;\n\t}\n\n\treq->pr_desc_bh = desc_bh;\n\treq->pr_bitmap_bh = bitmap_bh;\n\treturn 0;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "desc_bh"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_bitmap_block",
          "args": [
            "inode",
            "group",
            "1",
            "&bitmap_bh"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_bitmap_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "268-278",
          "snippet": "static int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_desc_block",
          "args": [
            "inode",
            "group",
            "1",
            "&desc_bh"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "249-259",
          "snippet": "static int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group",
          "args": [
            "inode",
            "req->pr_entry_nr",
            "&group_offset"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_is_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "687-695",
          "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_prepare_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tunsigned long group, group_offset;\n\tint ret;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\tret = nilfs_palloc_get_bitmap_block(inode, group, 1, &bitmap_bh);\n\tif (ret < 0) {\n\t\tbrelse(desc_bh);\n\t\treturn ret;\n\t}\n\n\treq->pr_desc_bh = desc_bh;\n\treq->pr_bitmap_bh = bitmap_bh;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_palloc_abort_alloc_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "606-636",
    "snippet": "void nilfs_palloc_abort_alloc_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned char *bitmap;\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "req->pr_desc_bh"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "req->pr_desc_bh->b_page"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "req->pr_bitmap_bh->b_page"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group_desc_add_entries",
          "args": [
            "inode",
            "group",
            "desc",
            "1"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_desc_add_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "159-168",
          "snippet": "static void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"%s: entry number %llu already freed\\n\"",
            "__func__",
            "(unsigned long long)req->pr_entry_nr"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_clear_bit_atomic",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)",
            "group_offset",
            "bitmap"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "req->pr_bitmap_bh"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "req->pr_bitmap_bh->b_page"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_group_desc",
          "args": [
            "inode",
            "group",
            "req->pr_desc_bh",
            "desc_kaddr"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_group_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "305-312",
          "snippet": "static struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "req->pr_desc_bh->b_page"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group",
          "args": [
            "inode",
            "req->pr_entry_nr",
            "&group_offset"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_is_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "687-695",
          "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_abort_alloc_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned char *bitmap;\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}"
  },
  {
    "function_name": "nilfs_palloc_commit_free_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "568-599",
    "snippet": "void nilfs_palloc_commit_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned long group, group_offset;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "req->pr_desc_bh"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_mark_dirty",
          "args": [
            "inode"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "98-102",
          "snippet": "static inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "req->pr_bitmap_bh"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "req->pr_desc_bh->b_page"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "req->pr_bitmap_bh->b_page"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group_desc_add_entries",
          "args": [
            "inode",
            "group",
            "desc",
            "1"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_desc_add_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "159-168",
          "snippet": "static void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"%s: entry number %llu already freed\\n\"",
            "__func__",
            "(unsigned long long)req->pr_entry_nr"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_clear_bit_atomic",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)",
            "group_offset",
            "bitmap"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "req->pr_bitmap_bh"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "req->pr_bitmap_bh->b_page"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_group_desc",
          "args": [
            "inode",
            "group",
            "req->pr_desc_bh",
            "desc_kaddr"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_group_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "305-312",
          "snippet": "static struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "req->pr_desc_bh->b_page"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group",
          "args": [
            "inode",
            "req->pr_entry_nr",
            "&group_offset"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_is_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "687-695",
          "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_commit_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned long group, group_offset;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}"
  },
  {
    "function_name": "nilfs_palloc_commit_alloc_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "552-561",
    "snippet": "void nilfs_palloc_commit_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "req->pr_desc_bh"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_mark_dirty",
          "args": [
            "inode"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "98-102",
          "snippet": "static inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "req->pr_desc_bh"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_commit_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}"
  },
  {
    "function_name": "nilfs_palloc_prepare_alloc_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "468-545",
    "snippet": "int nilfs_palloc_prepare_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, maxgroup, ngroups;\n\tunsigned long group_offset, maxgroup_offset;\n\tunsigned long n, entries_per_group, groups_per_desc_block;\n\tunsigned long i, j;\n\tint pos, ret;\n\n\tngroups = nilfs_palloc_groups_count(inode);\n\tmaxgroup = ngroups - 1;\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tentries_per_group = nilfs_palloc_entries_per_group(inode);\n\tgroups_per_desc_block = nilfs_palloc_groups_per_desc_block(inode);\n\n\tfor (i = 0; i < ngroups; i += n) {\n\t\tif (group >= ngroups) {\n\t\t\t/* wrap around */\n\t\t\tgroup = 0;\n\t\t\tmaxgroup = nilfs_palloc_group(inode, req->pr_entry_nr,\n\t\t\t\t\t\t      &maxgroup_offset) - 1;\n\t\t}\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tn = nilfs_palloc_rest_groups_in_desc_block(inode, group,\n\t\t\t\t\t\t\t   maxgroup);\n\t\tfor (j = 0; j < n; j++, desc++, group++) {\n\t\t\tif (nilfs_palloc_group_desc_nfrees(inode, group, desc)\n\t\t\t    > 0) {\n\t\t\t\tret = nilfs_palloc_get_bitmap_block(\n\t\t\t\t\tinode, group, 1, &bitmap_bh);\n\t\t\t\tif (ret < 0)\n\t\t\t\t\tgoto out_desc;\n\t\t\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\t\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\t\t\tpos = nilfs_palloc_find_available_slot(\n\t\t\t\t\tinode, group, group_offset, bitmap,\n\t\t\t\t\tentries_per_group);\n\t\t\t\tif (pos >= 0) {\n\t\t\t\t\t/* found a free entry */\n\t\t\t\t\tnilfs_palloc_group_desc_add_entries(\n\t\t\t\t\t\tinode, group, desc, -1);\n\t\t\t\t\treq->pr_entry_nr =\n\t\t\t\t\t\tentries_per_group * group + pos;\n\t\t\t\t\tkunmap(desc_bh->b_page);\n\t\t\t\t\tkunmap(bitmap_bh->b_page);\n\n\t\t\t\t\treq->pr_desc_bh = desc_bh;\n\t\t\t\t\treq->pr_bitmap_bh = bitmap_bh;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tkunmap(bitmap_bh->b_page);\n\t\t\t\tbrelse(bitmap_bh);\n\t\t\t}\n\n\t\t\tgroup_offset = 0;\n\t\t}\n\n\t\tkunmap(desc_bh->b_page);\n\t\tbrelse(desc_bh);\n\t}\n\n\t/* no entries left */\n\treturn -ENOSPC;\n\n out_desc:\n\tkunmap(desc_bh->b_page);\n\tbrelse(desc_bh);\n\treturn ret;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "desc_bh"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "desc_bh->b_page"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "desc_bh->b_page"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "bitmap_bh->b_page"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "bitmap_bh->b_page"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap",
          "args": [
            "desc_bh->b_page"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group_desc_add_entries",
          "args": [
            "inode",
            "group",
            "desc",
            "-1"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_desc_add_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "159-168",
          "snippet": "static void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_find_available_slot",
          "args": [
            "inode",
            "group",
            "group_offset",
            "bitmap",
            "entries_per_group"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_find_available_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "341-381",
          "snippet": "static int nilfs_palloc_find_available_slot(struct inode *inode,\n\t\t\t\t\t    unsigned long group,\n\t\t\t\t\t    unsigned long target,\n\t\t\t\t\t    unsigned char *bitmap,\n\t\t\t\t\t    int bsize)\n{\n\tint curr, pos, end, i;\n\n\tif (target > 0) {\n\t\tend = (target + BITS_PER_LONG - 1) & ~(BITS_PER_LONG - 1);\n\t\tif (end > bsize)\n\t\t\tend = bsize;\n\t\tpos = nilfs_find_next_zero_bit(bitmap, end, target);\n\t\tif (pos < end &&\n\t\t    !nilfs_set_bit_atomic(\n\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos, bitmap))\n\t\t\treturn pos;\n\t} else\n\t\tend = 0;\n\n\tfor (i = 0, curr = end;\n\t     i < bsize;\n\t     i += BITS_PER_LONG, curr += BITS_PER_LONG) {\n\t\t/* wrap around */\n\t\tif (curr >= bsize)\n\t\t\tcurr = 0;\n\t\twhile (*((unsigned long *)bitmap + curr / BITS_PER_LONG)\n\t\t       != ~0UL) {\n\t\t\tend = curr + BITS_PER_LONG;\n\t\t\tif (end > bsize)\n\t\t\t\tend = bsize;\n\t\t\tpos = nilfs_find_next_zero_bit(bitmap, end, curr);\n\t\t\tif ((pos < end) &&\n\t\t\t    !nilfs_set_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos,\n\t\t\t\t    bitmap))\n\t\t\t\treturn pos;\n\t\t}\n\t}\n\treturn -ENOSPC;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_find_available_slot(struct inode *inode,\n\t\t\t\t\t    unsigned long group,\n\t\t\t\t\t    unsigned long target,\n\t\t\t\t\t    unsigned char *bitmap,\n\t\t\t\t\t    int bsize)\n{\n\tint curr, pos, end, i;\n\n\tif (target > 0) {\n\t\tend = (target + BITS_PER_LONG - 1) & ~(BITS_PER_LONG - 1);\n\t\tif (end > bsize)\n\t\t\tend = bsize;\n\t\tpos = nilfs_find_next_zero_bit(bitmap, end, target);\n\t\tif (pos < end &&\n\t\t    !nilfs_set_bit_atomic(\n\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos, bitmap))\n\t\t\treturn pos;\n\t} else\n\t\tend = 0;\n\n\tfor (i = 0, curr = end;\n\t     i < bsize;\n\t     i += BITS_PER_LONG, curr += BITS_PER_LONG) {\n\t\t/* wrap around */\n\t\tif (curr >= bsize)\n\t\t\tcurr = 0;\n\t\twhile (*((unsigned long *)bitmap + curr / BITS_PER_LONG)\n\t\t       != ~0UL) {\n\t\t\tend = curr + BITS_PER_LONG;\n\t\t\tif (end > bsize)\n\t\t\t\tend = bsize;\n\t\t\tpos = nilfs_find_next_zero_bit(bitmap, end, curr);\n\t\t\tif ((pos < end) &&\n\t\t\t    !nilfs_set_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos,\n\t\t\t\t    bitmap))\n\t\t\t\treturn pos;\n\t\t}\n\t}\n\treturn -ENOSPC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bitmap_bh"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "bitmap_bh->b_page"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_bitmap_block",
          "args": [
            "inode",
            "group",
            "1",
            "&bitmap_bh"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_bitmap_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "268-278",
          "snippet": "static int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group_desc_nfrees",
          "args": [
            "inode",
            "group",
            "desc"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_desc_nfrees",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "140-150",
          "snippet": "static unsigned long\nnilfs_palloc_group_desc_nfrees(struct inode *inode, unsigned long group,\n\t\t\t       const struct nilfs_palloc_group_desc *desc)\n{\n\tunsigned long nfree;\n\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tnfree = le32_to_cpu(desc->pg_nfrees);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n\treturn nfree;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_group_desc_nfrees(struct inode *inode, unsigned long group,\n\t\t\t       const struct nilfs_palloc_group_desc *desc)\n{\n\tunsigned long nfree;\n\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tnfree = le32_to_cpu(desc->pg_nfrees);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n\treturn nfree;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_rest_groups_in_desc_block",
          "args": [
            "inode",
            "group",
            "maxgroup"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_rest_groups_in_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "390-398",
          "snippet": "static unsigned long\nnilfs_palloc_rest_groups_in_desc_block(const struct inode *inode,\n\t\t\t\t       unsigned long curr, unsigned long max)\n{\n\treturn min_t(unsigned long,\n\t\t     nilfs_palloc_groups_per_desc_block(inode) -\n\t\t     curr % nilfs_palloc_groups_per_desc_block(inode),\n\t\t     max - curr + 1);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_rest_groups_in_desc_block(const struct inode *inode,\n\t\t\t\t       unsigned long curr, unsigned long max)\n{\n\treturn min_t(unsigned long,\n\t\t     nilfs_palloc_groups_per_desc_block(inode) -\n\t\t     curr % nilfs_palloc_groups_per_desc_block(inode),\n\t\t     max - curr + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_group_desc",
          "args": [
            "inode",
            "group",
            "desc_bh",
            "desc_kaddr"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_group_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "305-312",
          "snippet": "static struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap",
          "args": [
            "desc_bh->b_page"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_desc_block",
          "args": [
            "inode",
            "group",
            "1",
            "&desc_bh"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "249-259",
          "snippet": "static int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group",
          "args": [
            "inode",
            "req->pr_entry_nr",
            "&maxgroup_offset"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_is_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "687-695",
          "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_entries_per_group",
          "args": [
            "inode"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_entries_per_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.h",
          "lines": "39-43",
          "snippet": "static inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_count",
          "args": [
            "inode"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "50-54",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_count(const struct inode *inode)\n{\n\treturn 1UL << (BITS_PER_LONG - (inode->i_blkbits + 3 /* log2(8) */));\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_count(const struct inode *inode)\n{\n\treturn 1UL << (BITS_PER_LONG - (inode->i_blkbits + 3 /* log2(8) */));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_prepare_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, maxgroup, ngroups;\n\tunsigned long group_offset, maxgroup_offset;\n\tunsigned long n, entries_per_group, groups_per_desc_block;\n\tunsigned long i, j;\n\tint pos, ret;\n\n\tngroups = nilfs_palloc_groups_count(inode);\n\tmaxgroup = ngroups - 1;\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tentries_per_group = nilfs_palloc_entries_per_group(inode);\n\tgroups_per_desc_block = nilfs_palloc_groups_per_desc_block(inode);\n\n\tfor (i = 0; i < ngroups; i += n) {\n\t\tif (group >= ngroups) {\n\t\t\t/* wrap around */\n\t\t\tgroup = 0;\n\t\t\tmaxgroup = nilfs_palloc_group(inode, req->pr_entry_nr,\n\t\t\t\t\t\t      &maxgroup_offset) - 1;\n\t\t}\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tn = nilfs_palloc_rest_groups_in_desc_block(inode, group,\n\t\t\t\t\t\t\t   maxgroup);\n\t\tfor (j = 0; j < n; j++, desc++, group++) {\n\t\t\tif (nilfs_palloc_group_desc_nfrees(inode, group, desc)\n\t\t\t    > 0) {\n\t\t\t\tret = nilfs_palloc_get_bitmap_block(\n\t\t\t\t\tinode, group, 1, &bitmap_bh);\n\t\t\t\tif (ret < 0)\n\t\t\t\t\tgoto out_desc;\n\t\t\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\t\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\t\t\tpos = nilfs_palloc_find_available_slot(\n\t\t\t\t\tinode, group, group_offset, bitmap,\n\t\t\t\t\tentries_per_group);\n\t\t\t\tif (pos >= 0) {\n\t\t\t\t\t/* found a free entry */\n\t\t\t\t\tnilfs_palloc_group_desc_add_entries(\n\t\t\t\t\t\tinode, group, desc, -1);\n\t\t\t\t\treq->pr_entry_nr =\n\t\t\t\t\t\tentries_per_group * group + pos;\n\t\t\t\t\tkunmap(desc_bh->b_page);\n\t\t\t\t\tkunmap(bitmap_bh->b_page);\n\n\t\t\t\t\treq->pr_desc_bh = desc_bh;\n\t\t\t\t\treq->pr_bitmap_bh = bitmap_bh;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tkunmap(bitmap_bh->b_page);\n\t\t\t\tbrelse(bitmap_bh);\n\t\t\t}\n\n\t\t\tgroup_offset = 0;\n\t\t}\n\n\t\tkunmap(desc_bh->b_page);\n\t\tbrelse(desc_bh);\n\t}\n\n\t/* no entries left */\n\treturn -ENOSPC;\n\n out_desc:\n\tkunmap(desc_bh->b_page);\n\tbrelse(desc_bh);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_palloc_count_max_entries",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "438-461",
    "snippet": "int nilfs_palloc_count_max_entries(struct inode *inode, u64 nused, u64 *nmaxp)\n{\n\tunsigned long desc_blocks = 0;\n\tu64 entries_per_desc_block, nmax;\n\tint err;\n\n\terr = nilfs_palloc_count_desc_blocks(inode, &desc_blocks);\n\tif (unlikely(err))\n\t\treturn err;\n\n\tentries_per_desc_block = (u64)nilfs_palloc_entries_per_group(inode) *\n\t\t\t\tnilfs_palloc_groups_per_desc_block(inode);\n\tnmax = entries_per_desc_block * desc_blocks;\n\n\tif (nused == nmax &&\n\t\t\tnilfs_palloc_mdt_file_can_grow(inode, desc_blocks))\n\t\tnmax += entries_per_desc_block;\n\n\tif (nused > nmax)\n\t\treturn -ERANGE;\n\n\t*nmaxp = nmax;\n\treturn 0;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_mdt_file_can_grow",
          "args": [
            "inode",
            "desc_blocks"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_mdt_file_can_grow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "424-429",
          "snippet": "static inline bool nilfs_palloc_mdt_file_can_grow(struct inode *inode,\n\t\t\t\t\t\t    unsigned long desc_blocks)\n{\n\treturn (nilfs_palloc_groups_per_desc_block(inode) * desc_blocks) <\n\t\t\tnilfs_palloc_groups_count(inode);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline bool nilfs_palloc_mdt_file_can_grow(struct inode *inode,\n\t\t\t\t\t\t    unsigned long desc_blocks)\n{\n\treturn (nilfs_palloc_groups_per_desc_block(inode) * desc_blocks) <\n\t\t\tnilfs_palloc_groups_count(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_entries_per_group",
          "args": [
            "inode"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_entries_per_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.h",
          "lines": "39-43",
          "snippet": "static inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "err"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_count_desc_blocks",
          "args": [
            "inode",
            "&desc_blocks"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_count_desc_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "405-416",
          "snippet": "static int nilfs_palloc_count_desc_blocks(struct inode *inode,\n\t\t\t\t\t    unsigned long *desc_blocks)\n{\n\tunsigned long blknum;\n\tint ret;\n\n\tret = nilfs_bmap_last_key(NILFS_I(inode)->i_bmap, &blknum);\n\tif (likely(!ret))\n\t\t*desc_blocks = DIV_ROUND_UP(\n\t\t\tblknum, NILFS_MDT(inode)->mi_blocks_per_desc_block);\n\treturn ret;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_count_desc_blocks(struct inode *inode,\n\t\t\t\t\t    unsigned long *desc_blocks)\n{\n\tunsigned long blknum;\n\tint ret;\n\n\tret = nilfs_bmap_last_key(NILFS_I(inode)->i_bmap, &blknum);\n\tif (likely(!ret))\n\t\t*desc_blocks = DIV_ROUND_UP(\n\t\t\tblknum, NILFS_MDT(inode)->mi_blocks_per_desc_block);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_count_max_entries(struct inode *inode, u64 nused, u64 *nmaxp)\n{\n\tunsigned long desc_blocks = 0;\n\tu64 entries_per_desc_block, nmax;\n\tint err;\n\n\terr = nilfs_palloc_count_desc_blocks(inode, &desc_blocks);\n\tif (unlikely(err))\n\t\treturn err;\n\n\tentries_per_desc_block = (u64)nilfs_palloc_entries_per_group(inode) *\n\t\t\t\tnilfs_palloc_groups_per_desc_block(inode);\n\tnmax = entries_per_desc_block * desc_blocks;\n\n\tif (nused == nmax &&\n\t\t\tnilfs_palloc_mdt_file_can_grow(inode, desc_blocks))\n\t\tnmax += entries_per_desc_block;\n\n\tif (nused > nmax)\n\t\treturn -ERANGE;\n\n\t*nmaxp = nmax;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_palloc_mdt_file_can_grow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "424-429",
    "snippet": "static inline bool nilfs_palloc_mdt_file_can_grow(struct inode *inode,\n\t\t\t\t\t\t    unsigned long desc_blocks)\n{\n\treturn (nilfs_palloc_groups_per_desc_block(inode) * desc_blocks) <\n\t\t\tnilfs_palloc_groups_count(inode);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_count",
          "args": [
            "inode"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "50-54",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_count(const struct inode *inode)\n{\n\treturn 1UL << (BITS_PER_LONG - (inode->i_blkbits + 3 /* log2(8) */));\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_count(const struct inode *inode)\n{\n\treturn 1UL << (BITS_PER_LONG - (inode->i_blkbits + 3 /* log2(8) */));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline bool nilfs_palloc_mdt_file_can_grow(struct inode *inode,\n\t\t\t\t\t\t    unsigned long desc_blocks)\n{\n\treturn (nilfs_palloc_groups_per_desc_block(inode) * desc_blocks) <\n\t\t\tnilfs_palloc_groups_count(inode);\n}"
  },
  {
    "function_name": "nilfs_palloc_count_desc_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "405-416",
    "snippet": "static int nilfs_palloc_count_desc_blocks(struct inode *inode,\n\t\t\t\t\t    unsigned long *desc_blocks)\n{\n\tunsigned long blknum;\n\tint ret;\n\n\tret = nilfs_bmap_last_key(NILFS_I(inode)->i_bmap, &blknum);\n\tif (likely(!ret))\n\t\t*desc_blocks = DIV_ROUND_UP(\n\t\t\tblknum, NILFS_MDT(inode)->mi_blocks_per_desc_block);\n\treturn ret;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "blknum",
            "NILFS_MDT(inode)->mi_blocks_per_desc_block"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!ret"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_last_key",
          "args": [
            "NILFS_I(inode)->i_bmap",
            "&blknum"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_last_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "194-208",
          "snippet": "int nilfs_bmap_last_key(struct nilfs_bmap *bmap, unsigned long *key)\n{\n\t__u64 lastkey;\n\tint ret;\n\n\tdown_read(&bmap->b_sem);\n\tret = bmap->b_ops->bop_last_key(bmap, &lastkey);\n\tup_read(&bmap->b_sem);\n\n\tif (ret < 0)\n\t\tret = nilfs_bmap_convert_error(bmap, __func__, ret);\n\telse\n\t\t*key = lastkey;\n\treturn ret;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nint nilfs_bmap_last_key(struct nilfs_bmap *bmap, unsigned long *key)\n{\n\t__u64 lastkey;\n\tint ret;\n\n\tdown_read(&bmap->b_sem);\n\tret = bmap->b_ops->bop_last_key(bmap, &lastkey);\n\tup_read(&bmap->b_sem);\n\n\tif (ret < 0)\n\t\tret = nilfs_bmap_convert_error(bmap, __func__, ret);\n\telse\n\t\t*key = lastkey;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_I",
          "args": [
            "inode"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "78-81",
          "snippet": "static inline struct nilfs_inode_info *NILFS_I(const struct inode *inode)\n{\n\treturn container_of(inode, struct nilfs_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *NILFS_I(const struct inode *inode)\n{\n\treturn container_of(inode, struct nilfs_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_count_desc_blocks(struct inode *inode,\n\t\t\t\t\t    unsigned long *desc_blocks)\n{\n\tunsigned long blknum;\n\tint ret;\n\n\tret = nilfs_bmap_last_key(NILFS_I(inode)->i_bmap, &blknum);\n\tif (likely(!ret))\n\t\t*desc_blocks = DIV_ROUND_UP(\n\t\t\tblknum, NILFS_MDT(inode)->mi_blocks_per_desc_block);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_palloc_rest_groups_in_desc_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "390-398",
    "snippet": "static unsigned long\nnilfs_palloc_rest_groups_in_desc_block(const struct inode *inode,\n\t\t\t\t       unsigned long curr, unsigned long max)\n{\n\treturn min_t(unsigned long,\n\t\t     nilfs_palloc_groups_per_desc_block(inode) -\n\t\t     curr % nilfs_palloc_groups_per_desc_block(inode),\n\t\t     max - curr + 1);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedlong",
            "nilfs_palloc_groups_per_desc_block(inode) -\n\t\t     curr % nilfs_palloc_groups_per_desc_block(inode)",
            "max - curr + 1"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_rest_groups_in_desc_block(const struct inode *inode,\n\t\t\t\t       unsigned long curr, unsigned long max)\n{\n\treturn min_t(unsigned long,\n\t\t     nilfs_palloc_groups_per_desc_block(inode) -\n\t\t     curr % nilfs_palloc_groups_per_desc_block(inode),\n\t\t     max - curr + 1);\n}"
  },
  {
    "function_name": "nilfs_palloc_find_available_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "341-381",
    "snippet": "static int nilfs_palloc_find_available_slot(struct inode *inode,\n\t\t\t\t\t    unsigned long group,\n\t\t\t\t\t    unsigned long target,\n\t\t\t\t\t    unsigned char *bitmap,\n\t\t\t\t\t    int bsize)\n{\n\tint curr, pos, end, i;\n\n\tif (target > 0) {\n\t\tend = (target + BITS_PER_LONG - 1) & ~(BITS_PER_LONG - 1);\n\t\tif (end > bsize)\n\t\t\tend = bsize;\n\t\tpos = nilfs_find_next_zero_bit(bitmap, end, target);\n\t\tif (pos < end &&\n\t\t    !nilfs_set_bit_atomic(\n\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos, bitmap))\n\t\t\treturn pos;\n\t} else\n\t\tend = 0;\n\n\tfor (i = 0, curr = end;\n\t     i < bsize;\n\t     i += BITS_PER_LONG, curr += BITS_PER_LONG) {\n\t\t/* wrap around */\n\t\tif (curr >= bsize)\n\t\t\tcurr = 0;\n\t\twhile (*((unsigned long *)bitmap + curr / BITS_PER_LONG)\n\t\t       != ~0UL) {\n\t\t\tend = curr + BITS_PER_LONG;\n\t\t\tif (end > bsize)\n\t\t\t\tend = bsize;\n\t\t\tpos = nilfs_find_next_zero_bit(bitmap, end, curr);\n\t\t\tif ((pos < end) &&\n\t\t\t    !nilfs_set_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos,\n\t\t\t\t    bitmap))\n\t\t\t\treturn pos;\n\t\t}\n\t}\n\treturn -ENOSPC;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_set_bit_atomic",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)",
            "pos",
            "bitmap"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_find_next_zero_bit",
          "args": [
            "bitmap",
            "end",
            "curr"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_set_bit_atomic",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)",
            "pos",
            "bitmap"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_find_next_zero_bit",
          "args": [
            "bitmap",
            "end",
            "target"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_find_available_slot(struct inode *inode,\n\t\t\t\t\t    unsigned long group,\n\t\t\t\t\t    unsigned long target,\n\t\t\t\t\t    unsigned char *bitmap,\n\t\t\t\t\t    int bsize)\n{\n\tint curr, pos, end, i;\n\n\tif (target > 0) {\n\t\tend = (target + BITS_PER_LONG - 1) & ~(BITS_PER_LONG - 1);\n\t\tif (end > bsize)\n\t\t\tend = bsize;\n\t\tpos = nilfs_find_next_zero_bit(bitmap, end, target);\n\t\tif (pos < end &&\n\t\t    !nilfs_set_bit_atomic(\n\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos, bitmap))\n\t\t\treturn pos;\n\t} else\n\t\tend = 0;\n\n\tfor (i = 0, curr = end;\n\t     i < bsize;\n\t     i += BITS_PER_LONG, curr += BITS_PER_LONG) {\n\t\t/* wrap around */\n\t\tif (curr >= bsize)\n\t\t\tcurr = 0;\n\t\twhile (*((unsigned long *)bitmap + curr / BITS_PER_LONG)\n\t\t       != ~0UL) {\n\t\t\tend = curr + BITS_PER_LONG;\n\t\t\tif (end > bsize)\n\t\t\t\tend = bsize;\n\t\t\tpos = nilfs_find_next_zero_bit(bitmap, end, curr);\n\t\t\tif ((pos < end) &&\n\t\t\t    !nilfs_set_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group), pos,\n\t\t\t\t    bitmap))\n\t\t\t\treturn pos;\n\t\t}\n\t}\n\treturn -ENOSPC;\n}"
  },
  {
    "function_name": "nilfs_palloc_block_get_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "321-331",
    "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group",
          "args": [
            "inode",
            "nr",
            "&group_offset"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_is_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "687-695",
          "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
  },
  {
    "function_name": "nilfs_palloc_block_get_group_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "305-312",
    "snippet": "static struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic struct nilfs_palloc_group_desc *\nnilfs_palloc_block_get_group_desc(const struct inode *inode,\n\t\t\t\t  unsigned long group,\n\t\t\t\t  const struct buffer_head *bh, void *kaddr)\n{\n\treturn (struct nilfs_palloc_group_desc *)(kaddr + bh_offset(bh)) +\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n}"
  },
  {
    "function_name": "nilfs_palloc_get_entry_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "287-296",
    "snippet": "int nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_get_block",
          "args": [
            "inode",
            "nilfs_palloc_entry_blkoff(inode, nr)",
            "create",
            "NULL",
            "bhp",
            "&cache->prev_entry",
            "&cache->lock"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "206-240",
          "snippet": "static int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_entry_blkoff",
          "args": [
            "inode",
            "nr"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_entry_blkoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "175-184",
          "snippet": "static unsigned long\nnilfs_palloc_entry_blkoff(const struct inode *inode, __u64 nr)\n{\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, nr, &group_offset);\n\n\treturn nilfs_palloc_bitmap_blkoff(inode, group) + 1 +\n\t\tgroup_offset / NILFS_MDT(inode)->mi_entries_per_block;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_entry_blkoff(const struct inode *inode, __u64 nr)\n{\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, nr, &group_offset);\n\n\treturn nilfs_palloc_bitmap_blkoff(inode, group) + 1 +\n\t\tgroup_offset / NILFS_MDT(inode)->mi_entries_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}"
  },
  {
    "function_name": "nilfs_palloc_get_bitmap_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "268-278",
    "snippet": "static int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_get_block",
          "args": [
            "inode",
            "nilfs_palloc_bitmap_blkoff(inode, group)",
            "create",
            "NULL",
            "bhp",
            "&cache->prev_bitmap",
            "&cache->lock"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "206-240",
          "snippet": "static int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_bitmap_blkoff",
          "args": [
            "inode",
            "group"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_bitmap_blkoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "125-132",
          "snippet": "static unsigned long\nnilfs_palloc_bitmap_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_offset =\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n\treturn nilfs_palloc_desc_blkoff(inode, group) + 1 +\n\t\tdesc_offset * NILFS_MDT(inode)->mi_blocks_per_group;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_bitmap_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_offset =\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n\treturn nilfs_palloc_desc_blkoff(inode, group) + 1 +\n\t\tdesc_offset * NILFS_MDT(inode)->mi_blocks_per_group;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_bitmap_block(struct inode *inode,\n\t\t\t\t\t unsigned long group,\n\t\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_bitmap_blkoff(inode, group),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_bitmap, &cache->lock);\n}"
  },
  {
    "function_name": "nilfs_palloc_get_desc_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "249-259",
    "snippet": "static int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_get_block",
          "args": [
            "inode",
            "nilfs_palloc_desc_blkoff(inode, group)",
            "create",
            "nilfs_palloc_desc_block_init",
            "bhp",
            "&cache->prev_desc",
            "&cache->lock"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "206-240",
          "snippet": "static int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_desc_blkoff",
          "args": [
            "inode",
            "group"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_desc_blkoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "109-115",
          "snippet": "static unsigned long\nnilfs_palloc_desc_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_block =\n\t\tgroup / nilfs_palloc_groups_per_desc_block(inode);\n\treturn desc_block * NILFS_MDT(inode)->mi_blocks_per_desc_block;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_desc_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_block =\n\t\tgroup / nilfs_palloc_groups_per_desc_block(inode);\n\treturn desc_block * NILFS_MDT(inode)->mi_blocks_per_desc_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_desc_block(struct inode *inode,\n\t\t\t\t       unsigned long group,\n\t\t\t\t       int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_desc_blkoff(inode, group),\n\t\t\t\t      create, nilfs_palloc_desc_block_init,\n\t\t\t\t      bhp, &cache->prev_desc, &cache->lock);\n}"
  },
  {
    "function_name": "nilfs_palloc_get_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "206-240",
    "snippet": "static int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "lock"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_bh",
          "args": [
            "*bhp"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "prev->bh"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "lock"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_get_block",
          "args": [
            "inode",
            "blkoff",
            "create",
            "init_block",
            "bhp"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.c",
          "lines": "242-261",
          "snippet": "int nilfs_mdt_get_block(struct inode *inode, unsigned long blkoff, int create,\n\t\t\tvoid (*init_block)(struct inode *,\n\t\t\t\t\t   struct buffer_head *, void *),\n\t\t\tstruct buffer_head **out_bh)\n{\n\tint ret;\n\n\t/* Should be rewritten with merging nilfs_mdt_read_block() */\n retry:\n\tret = nilfs_mdt_read_block(inode, blkoff, !create, out_bh);\n\tif (!create || ret != -ENOENT)\n\t\treturn ret;\n\n\tret = nilfs_mdt_create_block(inode, blkoff, out_bh, init_block);\n\tif (unlikely(ret == -EEXIST)) {\n\t\t/* create = 0; */  /* limit read-create loop retries */\n\t\tgoto retry;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mm.h>",
            "#include <linux/mpage.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/mm.h>\n#include <linux/mpage.h>\n#include <linux/buffer_head.h>\n\nint nilfs_mdt_get_block(struct inode *inode, unsigned long blkoff, int create,\n\t\t\tvoid (*init_block)(struct inode *,\n\t\t\t\t\t   struct buffer_head *, void *),\n\t\t\tstruct buffer_head **out_bh)\n{\n\tint ret;\n\n\t/* Should be rewritten with merging nilfs_mdt_read_block() */\n retry:\n\tret = nilfs_mdt_read_block(inode, blkoff, !create, out_bh);\n\tif (!create || ret != -ENOENT)\n\t\treturn ret;\n\n\tret = nilfs_mdt_create_block(inode, blkoff, out_bh, init_block);\n\tif (unlikely(ret == -EEXIST)) {\n\t\t/* create = 0; */  /* limit read-create loop retries */\n\t\tgoto retry;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_bh",
          "args": [
            "prev->bh"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_palloc_get_block(struct inode *inode, unsigned long blkoff,\n\t\t\t\t  int create,\n\t\t\t\t  void (*init_block)(struct inode *,\n\t\t\t\t\t\t     struct buffer_head *,\n\t\t\t\t\t\t     void *),\n\t\t\t\t  struct buffer_head **bhp,\n\t\t\t\t  struct nilfs_bh_assoc *prev,\n\t\t\t\t  spinlock_t *lock)\n{\n\tint ret;\n\n\tspin_lock(lock);\n\tif (prev->bh && blkoff == prev->blkoff) {\n\t\tget_bh(prev->bh);\n\t\t*bhp = prev->bh;\n\t\tspin_unlock(lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(lock);\n\n\tret = nilfs_mdt_get_block(inode, blkoff, create, init_block, bhp);\n\tif (!ret) {\n\t\tspin_lock(lock);\n\t\t/*\n\t\t * The following code must be safe for change of the\n\t\t * cache contents during the get block call.\n\t\t */\n\t\tbrelse(prev->bh);\n\t\tget_bh(*bhp);\n\t\tprev->bh = *bhp;\n\t\tprev->blkoff = blkoff;\n\t\tspin_unlock(lock);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_palloc_desc_block_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "192-204",
    "snippet": "static void nilfs_palloc_desc_block_init(struct inode *inode,\n\t\t\t\t\t struct buffer_head *bh, void *kaddr)\n{\n\tstruct nilfs_palloc_group_desc *desc = kaddr + bh_offset(bh);\n\tunsigned long n = nilfs_palloc_groups_per_desc_block(inode);\n\t__le32 nfrees;\n\n\tnfrees = cpu_to_le32(nilfs_palloc_entries_per_group(inode));\n\twhile (n-- > 0) {\n\t\tdesc->pg_nfrees = nfrees;\n\t\tdesc++;\n\t}\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "nilfs_palloc_entries_per_group(inode)"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_entries_per_group",
          "args": [
            "inode"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_entries_per_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.h",
          "lines": "39-43",
          "snippet": "static inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_palloc_desc_block_init(struct inode *inode,\n\t\t\t\t\t struct buffer_head *bh, void *kaddr)\n{\n\tstruct nilfs_palloc_group_desc *desc = kaddr + bh_offset(bh);\n\tunsigned long n = nilfs_palloc_groups_per_desc_block(inode);\n\t__le32 nfrees;\n\n\tnfrees = cpu_to_le32(nilfs_palloc_entries_per_group(inode));\n\twhile (n-- > 0) {\n\t\tdesc->pg_nfrees = nfrees;\n\t\tdesc++;\n\t}\n}"
  },
  {
    "function_name": "nilfs_palloc_entry_blkoff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "175-184",
    "snippet": "static unsigned long\nnilfs_palloc_entry_blkoff(const struct inode *inode, __u64 nr)\n{\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, nr, &group_offset);\n\n\treturn nilfs_palloc_bitmap_blkoff(inode, group) + 1 +\n\t\tgroup_offset / NILFS_MDT(inode)->mi_entries_per_block;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_bitmap_blkoff",
          "args": [
            "inode",
            "group"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_bitmap_blkoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "125-132",
          "snippet": "static unsigned long\nnilfs_palloc_bitmap_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_offset =\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n\treturn nilfs_palloc_desc_blkoff(inode, group) + 1 +\n\t\tdesc_offset * NILFS_MDT(inode)->mi_blocks_per_group;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_bitmap_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_offset =\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n\treturn nilfs_palloc_desc_blkoff(inode, group) + 1 +\n\t\tdesc_offset * NILFS_MDT(inode)->mi_blocks_per_group;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_group",
          "args": [
            "inode",
            "nr",
            "&group_offset"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_group_is_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "687-695",
          "snippet": "static int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int\nnilfs_palloc_group_is_in(struct inode *inode, unsigned long group, __u64 nr)\n{\n\t__u64 first, last;\n\n\tfirst = group * nilfs_palloc_entries_per_group(inode);\n\tlast = first + nilfs_palloc_entries_per_group(inode) - 1;\n\treturn (nr >= first) && (nr <= last);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_entry_blkoff(const struct inode *inode, __u64 nr)\n{\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, nr, &group_offset);\n\n\treturn nilfs_palloc_bitmap_blkoff(inode, group) + 1 +\n\t\tgroup_offset / NILFS_MDT(inode)->mi_entries_per_block;\n}"
  },
  {
    "function_name": "nilfs_palloc_group_desc_add_entries",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "159-168",
    "snippet": "static void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le32_add_cpu",
          "args": [
            "&desc->pg_nfrees",
            "n"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void\nnilfs_palloc_group_desc_add_entries(struct inode *inode,\n\t\t\t\t    unsigned long group,\n\t\t\t\t    struct nilfs_palloc_group_desc *desc,\n\t\t\t\t    u32 n)\n{\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tle32_add_cpu(&desc->pg_nfrees, n);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n}"
  },
  {
    "function_name": "nilfs_palloc_group_desc_nfrees",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "140-150",
    "snippet": "static unsigned long\nnilfs_palloc_group_desc_nfrees(struct inode *inode, unsigned long group,\n\t\t\t       const struct nilfs_palloc_group_desc *desc)\n{\n\tunsigned long nfree;\n\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tnfree = le32_to_cpu(desc->pg_nfrees);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n\treturn nfree;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "desc->pg_nfrees"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "nilfs_mdt_bgl_lock(inode, group)"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_bgl_lock",
          "args": [
            "inode",
            "group"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_group_desc_nfrees(struct inode *inode, unsigned long group,\n\t\t\t       const struct nilfs_palloc_group_desc *desc)\n{\n\tunsigned long nfree;\n\n\tspin_lock(nilfs_mdt_bgl_lock(inode, group));\n\tnfree = le32_to_cpu(desc->pg_nfrees);\n\tspin_unlock(nilfs_mdt_bgl_lock(inode, group));\n\treturn nfree;\n}"
  },
  {
    "function_name": "nilfs_palloc_bitmap_blkoff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "125-132",
    "snippet": "static unsigned long\nnilfs_palloc_bitmap_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_offset =\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n\treturn nilfs_palloc_desc_blkoff(inode, group) + 1 +\n\t\tdesc_offset * NILFS_MDT(inode)->mi_blocks_per_group;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_desc_blkoff",
          "args": [
            "inode",
            "group"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_desc_blkoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "109-115",
          "snippet": "static unsigned long\nnilfs_palloc_desc_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_block =\n\t\tgroup / nilfs_palloc_groups_per_desc_block(inode);\n\treturn desc_block * NILFS_MDT(inode)->mi_blocks_per_desc_block;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_desc_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_block =\n\t\tgroup / nilfs_palloc_groups_per_desc_block(inode);\n\treturn desc_block * NILFS_MDT(inode)->mi_blocks_per_desc_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_bitmap_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_offset =\n\t\tgroup % nilfs_palloc_groups_per_desc_block(inode);\n\treturn nilfs_palloc_desc_blkoff(inode, group) + 1 +\n\t\tdesc_offset * NILFS_MDT(inode)->mi_blocks_per_group;\n}"
  },
  {
    "function_name": "nilfs_palloc_desc_blkoff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "109-115",
    "snippet": "static unsigned long\nnilfs_palloc_desc_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_block =\n\t\tgroup / nilfs_palloc_groups_per_desc_block(inode);\n\treturn desc_block * NILFS_MDT(inode)->mi_blocks_per_desc_block;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long\nnilfs_palloc_desc_blkoff(const struct inode *inode, unsigned long group)\n{\n\tunsigned long desc_block =\n\t\tgroup / nilfs_palloc_groups_per_desc_block(inode);\n\treturn desc_block * NILFS_MDT(inode)->mi_blocks_per_desc_block;\n}"
  },
  {
    "function_name": "nilfs_palloc_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "92-99",
    "snippet": "static unsigned long nilfs_palloc_group(const struct inode *inode, __u64 nr,\n\t\t\t\t\tunsigned long *offset)\n{\n\t__u64 group = nr;\n\n\t*offset = do_div(group, nilfs_palloc_entries_per_group(inode));\n\treturn group;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "group",
            "nilfs_palloc_entries_per_group(inode)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_entries_per_group",
          "args": [
            "inode"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_entries_per_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.h",
          "lines": "39-43",
          "snippet": "static inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic unsigned long nilfs_palloc_group(const struct inode *inode, __u64 nr,\n\t\t\t\t\tunsigned long *offset)\n{\n\t__u64 group = nr;\n\n\t*offset = do_div(group, nilfs_palloc_entries_per_group(inode));\n\treturn group;\n}"
  },
  {
    "function_name": "nilfs_palloc_init_blockgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "61-84",
    "snippet": "int nilfs_palloc_init_blockgroup(struct inode *inode, unsigned entry_size)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tmi->mi_bgl = kmalloc(sizeof(*mi->mi_bgl), GFP_NOFS);\n\tif (!mi->mi_bgl)\n\t\treturn -ENOMEM;\n\n\tbgl_lock_init(mi->mi_bgl);\n\n\tnilfs_mdt_set_entry_size(inode, entry_size, 0);\n\n\tmi->mi_blocks_per_group =\n\t\tDIV_ROUND_UP(nilfs_palloc_entries_per_group(inode),\n\t\t\t     mi->mi_entries_per_block) + 1;\n\t\t/* Number of blocks in a group including entry blocks and\n\t\t   a bitmap block */\n\tmi->mi_blocks_per_desc_block =\n\t\tnilfs_palloc_groups_per_desc_block(inode) *\n\t\tmi->mi_blocks_per_group + 1;\n\t\t/* Number of blocks per descriptor including the\n\t\t   descriptor block */\n\treturn 0;\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_groups_per_desc_block",
          "args": [
            "inode"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_groups_per_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "39-44",
          "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "nilfs_palloc_entries_per_group(inode)",
            "mi->mi_entries_per_block"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_entries_per_group",
          "args": [
            "inode"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_entries_per_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.h",
          "lines": "39-43",
          "snippet": "static inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_entries_per_group(const struct inode *inode)\n{\n\treturn 1UL << (inode->i_blkbits + 3 /* log2(8 = CHAR_BITS) */);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_set_entry_size",
          "args": [
            "inode",
            "entry_size",
            "0"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_set_entry_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.c",
          "lines": "440-448",
          "snippet": "void nilfs_mdt_set_entry_size(struct inode *inode, unsigned entry_size,\n\t\t\t      unsigned header_size)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tmi->mi_entry_size = entry_size;\n\tmi->mi_entries_per_block = (1 << inode->i_blkbits) / entry_size;\n\tmi->mi_first_entry_offset = DIV_ROUND_UP(header_size, entry_size);\n}",
          "includes": [
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mm.h>",
            "#include <linux/mpage.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/mm.h>\n#include <linux/mpage.h>\n#include <linux/buffer_head.h>\n\nvoid nilfs_mdt_set_entry_size(struct inode *inode, unsigned entry_size,\n\t\t\t      unsigned header_size)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tmi->mi_entry_size = entry_size;\n\tmi->mi_entries_per_block = (1 << inode->i_blkbits) / entry_size;\n\tmi->mi_first_entry_offset = DIV_ROUND_UP(header_size, entry_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bgl_lock_init",
          "args": [
            "mi->mi_bgl"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*mi->mi_bgl)",
            "GFP_NOFS"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "inode"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_init_blockgroup(struct inode *inode, unsigned entry_size)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tmi->mi_bgl = kmalloc(sizeof(*mi->mi_bgl), GFP_NOFS);\n\tif (!mi->mi_bgl)\n\t\treturn -ENOMEM;\n\n\tbgl_lock_init(mi->mi_bgl);\n\n\tnilfs_mdt_set_entry_size(inode, entry_size, 0);\n\n\tmi->mi_blocks_per_group =\n\t\tDIV_ROUND_UP(nilfs_palloc_entries_per_group(inode),\n\t\t\t     mi->mi_entries_per_block) + 1;\n\t\t/* Number of blocks in a group including entry blocks and\n\t\t   a bitmap block */\n\tmi->mi_blocks_per_desc_block =\n\t\tnilfs_palloc_groups_per_desc_block(inode) *\n\t\tmi->mi_blocks_per_group + 1;\n\t\t/* Number of blocks per descriptor including the\n\t\t   descriptor block */\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_palloc_groups_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "50-54",
    "snippet": "static inline unsigned long\nnilfs_palloc_groups_count(const struct inode *inode)\n{\n\treturn 1UL << (BITS_PER_LONG - (inode->i_blkbits + 3 /* log2(8) */));\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_count(const struct inode *inode)\n{\n\treturn 1UL << (BITS_PER_LONG - (inode->i_blkbits + 3 /* log2(8) */));\n}"
  },
  {
    "function_name": "nilfs_palloc_groups_per_desc_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
    "lines": "39-44",
    "snippet": "static inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}",
    "includes": [
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include <linux/slab.h>",
      "#include <linux/bitops.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline unsigned long\nnilfs_palloc_groups_per_desc_block(const struct inode *inode)\n{\n\treturn (1UL << inode->i_blkbits) /\n\t\tsizeof(struct nilfs_palloc_group_desc);\n}"
  }
]