[
  {
    "function_name": "nfs4_unregister_sysctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4sysctl.c",
    "lines": "65-69",
    "snippet": "void nfs4_unregister_sysctl(void)\n{\n\tunregister_sysctl_table(nfs4_callback_sysctl_table);\n\tnfs4_callback_sysctl_table = NULL;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/sysctl.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ctl_table_header *nfs4_callback_sysctl_table;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_sysctl_table",
          "args": [
            "nfs4_callback_sysctl_table"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1528-1555",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/sysctl.h>\n\nstatic struct ctl_table_header *nfs4_callback_sysctl_table;\n\nvoid nfs4_unregister_sysctl(void)\n{\n\tunregister_sysctl_table(nfs4_callback_sysctl_table);\n\tnfs4_callback_sysctl_table = NULL;\n}"
  },
  {
    "function_name": "nfs4_register_sysctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4sysctl.c",
    "lines": "57-63",
    "snippet": "int nfs4_register_sysctl(void)\n{\n\tnfs4_callback_sysctl_table = register_sysctl_table(nfs4_cb_sysctl_root);\n\tif (nfs4_callback_sysctl_table == NULL)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/sysctl.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ctl_table_header *nfs4_callback_sysctl_table;",
      "static struct ctl_table nfs4_cb_sysctl_root[] = {\n\t{\n\t\t.procname = \"fs\",\n\t\t.mode = 0555,\n\t\t.child = nfs4_cb_sysctl_dir,\n\t},\n\t{ }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_sysctl_table",
          "args": [
            "nfs4_cb_sysctl_root"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1528-1555",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/sysctl.h>\n\nstatic struct ctl_table_header *nfs4_callback_sysctl_table;\nstatic struct ctl_table nfs4_cb_sysctl_root[] = {\n\t{\n\t\t.procname = \"fs\",\n\t\t.mode = 0555,\n\t\t.child = nfs4_cb_sysctl_dir,\n\t},\n\t{ }\n};\n\nint nfs4_register_sysctl(void)\n{\n\tnfs4_callback_sysctl_table = register_sysctl_table(nfs4_cb_sysctl_root);\n\tif (nfs4_callback_sysctl_table == NULL)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
  }
]