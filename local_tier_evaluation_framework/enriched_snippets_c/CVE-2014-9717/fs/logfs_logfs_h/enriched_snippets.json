[
  {
    "function_name": "logfs_mempool_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "730-734",
    "snippet": "static inline void logfs_mempool_destroy(mempool_t *pool)\n{\n\tif (pool)\n\t\tmempool_destroy(pool);\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mempool_destroy",
          "args": [
            "pool"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_mempool_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "730-734",
          "snippet": "static inline void logfs_mempool_destroy(mempool_t *pool)\n{\n\tif (pool)\n\t\tmempool_destroy(pool);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline void logfs_mempool_destroy(mempool_t *pool)\n{\n\tif (pool)\n\t\tmempool_destroy(pool);\n}"
  },
  {
    "function_name": "get_area",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "724-728",
    "snippet": "static inline struct logfs_area *get_area(struct super_block *sb,\n\t\tgc_level_t gc_level)\n{\n\treturn logfs_super(sb)->s_area[(__force u8)gc_level];\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logfs_super",
          "args": [
            "sb"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "628-631",
          "snippet": "static inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_area *get_area(struct super_block *sb,\n\t\tgc_level_t gc_level)\n{\n\treturn logfs_super(sb)->s_area[(__force u8)gc_level];\n}"
  },
  {
    "function_name": "logfs_block_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "719-722",
    "snippet": "static inline u64 logfs_block_mask(struct super_block *sb, level_t level)\n{\n\treturn ~0ull << logfs_block_shift(sb, level);\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logfs_block_shift",
          "args": [
            "sb",
            "level"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_block_shift",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "713-717",
          "snippet": "static inline int logfs_block_shift(struct super_block *sb, level_t level)\n{\n\tlevel = shrink_level((__force gc_level_t)level);\n\treturn (__force int)level * (sb->s_blocksize_bits - 3);\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline int logfs_block_shift(struct super_block *sb, level_t level)\n{\n\tlevel = shrink_level((__force gc_level_t)level);\n\treturn (__force int)level * (sb->s_blocksize_bits - 3);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline u64 logfs_block_mask(struct super_block *sb, level_t level)\n{\n\treturn ~0ull << logfs_block_shift(sb, level);\n}"
  },
  {
    "function_name": "logfs_block_shift",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "713-717",
    "snippet": "static inline int logfs_block_shift(struct super_block *sb, level_t level)\n{\n\tlevel = shrink_level((__force gc_level_t)level);\n\treturn (__force int)level * (sb->s_blocksize_bits - 3);\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shrink_level",
          "args": [
            "(__force gc_level_t)level"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "shrink_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "693-700",
          "snippet": "static inline level_t shrink_level(gc_level_t __level)\n{\n\tu8 level = (__force u8)__level;\n\n\tif (level >= LOGFS_MAX_LEVELS)\n\t\tlevel -= LOGFS_MAX_LEVELS;\n\treturn (__force level_t)level;\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline level_t shrink_level(gc_level_t __level)\n{\n\tu8 level = (__force u8)__level;\n\n\tif (level >= LOGFS_MAX_LEVELS)\n\t\tlevel -= LOGFS_MAX_LEVELS;\n\treturn (__force level_t)level;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline int logfs_block_shift(struct super_block *sb, level_t level)\n{\n\tlevel = shrink_level((__force gc_level_t)level);\n\treturn (__force int)level * (sb->s_blocksize_bits - 3);\n}"
  },
  {
    "function_name": "expand_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "702-711",
    "snippet": "static inline gc_level_t expand_level(u64 ino, level_t __level)\n{\n\tu8 level = (__force u8)__level;\n\n\tif (ino == LOGFS_INO_MASTER) {\n\t\t/* ifile has separate areas */\n\t\tlevel += LOGFS_MAX_LEVELS;\n\t}\n\treturn (__force gc_level_t)level;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline gc_level_t expand_level(u64 ino, level_t __level)\n{\n\tu8 level = (__force u8)__level;\n\n\tif (ino == LOGFS_INO_MASTER) {\n\t\t/* ifile has separate areas */\n\t\tlevel += LOGFS_MAX_LEVELS;\n\t}\n\treturn (__force gc_level_t)level;\n}"
  },
  {
    "function_name": "shrink_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "693-700",
    "snippet": "static inline level_t shrink_level(gc_level_t __level)\n{\n\tu8 level = (__force u8)__level;\n\n\tif (level >= LOGFS_MAX_LEVELS)\n\t\tlevel -= LOGFS_MAX_LEVELS;\n\treturn (__force level_t)level;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline level_t shrink_level(gc_level_t __level)\n{\n\tu8 level = (__force u8)__level;\n\n\tif (level >= LOGFS_MAX_LEVELS)\n\t\tlevel -= LOGFS_MAX_LEVELS;\n\treturn (__force level_t)level;\n}"
  },
  {
    "function_name": "logfs_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "688-691",
    "snippet": "static inline struct logfs_block *logfs_block(struct page *page)\n{\n\treturn (void *)page->private;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_block *logfs_block(struct page *page)\n{\n\treturn (void *)page->private;\n}"
  },
  {
    "function_name": "seg_align",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "683-686",
    "snippet": "static inline u64 seg_align(struct super_block *sb, u64 ofs)\n{\n\treturn ofs & ~logfs_super(sb)->s_segmask;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logfs_super",
          "args": [
            "sb"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "628-631",
          "snippet": "static inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline u64 seg_align(struct super_block *sb, u64 ofs)\n{\n\treturn ofs & ~logfs_super(sb)->s_segmask;\n}"
  },
  {
    "function_name": "seg_ofs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "678-681",
    "snippet": "static inline u32 seg_ofs(struct super_block *sb, u64 ofs)\n{\n\treturn ofs & logfs_super(sb)->s_segmask;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logfs_super",
          "args": [
            "sb"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "628-631",
          "snippet": "static inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline u32 seg_ofs(struct super_block *sb, u64 ofs)\n{\n\treturn ofs & logfs_super(sb)->s_segmask;\n}"
  },
  {
    "function_name": "seg_no",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "673-676",
    "snippet": "static inline u32 seg_no(struct super_block *sb, u64 ofs)\n{\n\treturn ofs >> logfs_super(sb)->s_segshift;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logfs_super",
          "args": [
            "sb"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "628-631",
          "snippet": "static inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline u32 seg_no(struct super_block *sb, u64 ofs)\n{\n\treturn ofs >> logfs_super(sb)->s_segshift;\n}"
  },
  {
    "function_name": "dev_ofs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "668-671",
    "snippet": "static inline u64 dev_ofs(struct super_block *sb, u32 segno, u32 ofs)\n{\n\treturn ((u64)segno << logfs_super(sb)->s_segshift) + ofs;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logfs_super",
          "args": [
            "sb"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "628-631",
          "snippet": "static inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline u64 dev_ofs(struct super_block *sb, u32 segno, u32 ofs)\n{\n\treturn ((u64)segno << logfs_super(sb)->s_segshift) + ofs;\n}"
  },
  {
    "function_name": "logfs_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "663-666",
    "snippet": "static inline pgoff_t logfs_index(struct super_block *sb, u64 pos)\n{\n\treturn pos >> sb->s_blocksize_bits;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline pgoff_t logfs_index(struct super_block *sb, u64 pos)\n{\n\treturn pos >> sb->s_blocksize_bits;\n}"
  },
  {
    "function_name": "logfs_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "658-661",
    "snippet": "static inline u8 logfs_type(struct inode *inode)\n{\n\treturn (inode->i_mode >> 12) & 15;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline u8 logfs_type(struct inode *inode)\n{\n\treturn (inode->i_mode >> 12) & 15;\n}"
  },
  {
    "function_name": "logfs_crc32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "653-656",
    "snippet": "static inline __be32 logfs_crc32(void *data, size_t len, size_t skip)\n{\n\treturn cpu_to_be32(crc32(~0, data+skip, len-skip));\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "crc32(~0, data+skip, len-skip)"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32",
          "args": [
            "~0",
            "data+skip",
            "len-skip"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_crc32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "653-656",
          "snippet": "static inline __be32 logfs_crc32(void *data, size_t len, size_t skip)\n{\n\treturn cpu_to_be32(crc32(~0, data+skip, len-skip));\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline __be32 logfs_crc32(void *data, size_t len, size_t skip)\n{\n\treturn cpu_to_be32(crc32(~0, data+skip, len-skip));\n}"
  },
  {
    "function_name": "logfs_set_ro",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "638-641",
    "snippet": "static inline void logfs_set_ro(struct super_block *sb)\n{\n\tlogfs_super(sb)->s_flags |= LOGFS_SB_FLAG_RO;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [
      "#define LOGFS_SB_FLAG_RO\t0x0001"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logfs_super",
          "args": [
            "sb"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "628-631",
          "snippet": "static inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\n#define LOGFS_SB_FLAG_RO\t0x0001\n\nstatic inline void logfs_set_ro(struct super_block *sb)\n{\n\tlogfs_super(sb)->s_flags |= LOGFS_SB_FLAG_RO;\n}"
  },
  {
    "function_name": "logfs_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "633-636",
    "snippet": "static inline struct logfs_inode *logfs_inode(struct inode *inode)\n{\n\treturn container_of(inode, struct logfs_inode, vfs_inode);\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "inode",
            "structlogfs_inode",
            "vfs_inode"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_inode *logfs_inode(struct inode *inode)\n{\n\treturn container_of(inode, struct logfs_inode, vfs_inode);\n}"
  },
  {
    "function_name": "logfs_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "628-631",
    "snippet": "static inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline struct logfs_super *logfs_super(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
  },
  {
    "function_name": "logfs_buf_recover",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "614-618",
    "snippet": "static inline int logfs_buf_recover(struct logfs_area *area, u64 ofs,\n\t\tvoid *buf, size_t len)\n{\n\treturn __logfs_buf_write(area, ofs, buf, len, 1);\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__logfs_buf_write",
          "args": [
            "area",
            "ofs",
            "buf",
            "len",
            "1"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "__logfs_buf_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/segment.c",
          "lines": "71-103",
          "snippet": "int __logfs_buf_write(struct logfs_area *area, u64 ofs, void *buf, size_t len,\n\t\tint use_filler)\n{\n\tpgoff_t index = ofs >> PAGE_SHIFT;\n\tstruct page *page;\n\tlong offset = ofs & (PAGE_SIZE-1);\n\tlong copylen;\n\n\t/* Only logfs_wbuf_recover may use len==0 */\n\tBUG_ON(!len && !use_filler);\n\tdo {\n\t\tcopylen = min((ulong)len, PAGE_SIZE - offset);\n\n\t\tpage = get_mapping_page(area->a_sb, index, use_filler);\n\t\tif (IS_ERR(page))\n\t\t\treturn PTR_ERR(page);\n\t\tBUG_ON(!page); /* FIXME: reserve a pool */\n\t\tSetPageUptodate(page);\n\t\tmemcpy(page_address(page) + offset, buf, copylen);\n\n\t\tif (!PagePrivate(page)) {\n\t\t\tSetPagePrivate(page);\n\t\t\tpage_cache_get(page);\n\t\t}\n\t\tpage_cache_release(page);\n\n\t\tbuf += copylen;\n\t\tlen -= copylen;\n\t\toffset = 0;\n\t\tindex++;\n\t} while (len);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include \"logfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include \"logfs.h\"\n\nint __logfs_buf_write(struct logfs_area *area, u64 ofs, void *buf, size_t len,\n\t\tint use_filler)\n{\n\tpgoff_t index = ofs >> PAGE_SHIFT;\n\tstruct page *page;\n\tlong offset = ofs & (PAGE_SIZE-1);\n\tlong copylen;\n\n\t/* Only logfs_wbuf_recover may use len==0 */\n\tBUG_ON(!len && !use_filler);\n\tdo {\n\t\tcopylen = min((ulong)len, PAGE_SIZE - offset);\n\n\t\tpage = get_mapping_page(area->a_sb, index, use_filler);\n\t\tif (IS_ERR(page))\n\t\t\treturn PTR_ERR(page);\n\t\tBUG_ON(!page); /* FIXME: reserve a pool */\n\t\tSetPageUptodate(page);\n\t\tmemcpy(page_address(page) + offset, buf, copylen);\n\n\t\tif (!PagePrivate(page)) {\n\t\t\tSetPagePrivate(page);\n\t\t\tpage_cache_get(page);\n\t\t}\n\t\tpage_cache_release(page);\n\n\t\tbuf += copylen;\n\t\tlen -= copylen;\n\t\toffset = 0;\n\t\tindex++;\n\t} while (len);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline int logfs_buf_recover(struct logfs_area *area, u64 ofs,\n\t\tvoid *buf, size_t len)\n{\n\treturn __logfs_buf_write(area, ofs, buf, len, 1);\n}"
  },
  {
    "function_name": "logfs_buf_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "608-612",
    "snippet": "static inline int logfs_buf_write(struct logfs_area *area, u64 ofs,\n\t\tvoid *buf, size_t len)\n{\n\treturn __logfs_buf_write(area, ofs, buf, len, 0);\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__logfs_buf_write",
          "args": [
            "area",
            "ofs",
            "buf",
            "len",
            "0"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "__logfs_buf_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/segment.c",
          "lines": "71-103",
          "snippet": "int __logfs_buf_write(struct logfs_area *area, u64 ofs, void *buf, size_t len,\n\t\tint use_filler)\n{\n\tpgoff_t index = ofs >> PAGE_SHIFT;\n\tstruct page *page;\n\tlong offset = ofs & (PAGE_SIZE-1);\n\tlong copylen;\n\n\t/* Only logfs_wbuf_recover may use len==0 */\n\tBUG_ON(!len && !use_filler);\n\tdo {\n\t\tcopylen = min((ulong)len, PAGE_SIZE - offset);\n\n\t\tpage = get_mapping_page(area->a_sb, index, use_filler);\n\t\tif (IS_ERR(page))\n\t\t\treturn PTR_ERR(page);\n\t\tBUG_ON(!page); /* FIXME: reserve a pool */\n\t\tSetPageUptodate(page);\n\t\tmemcpy(page_address(page) + offset, buf, copylen);\n\n\t\tif (!PagePrivate(page)) {\n\t\t\tSetPagePrivate(page);\n\t\t\tpage_cache_get(page);\n\t\t}\n\t\tpage_cache_release(page);\n\n\t\tbuf += copylen;\n\t\tlen -= copylen;\n\t\toffset = 0;\n\t\tindex++;\n\t} while (len);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include \"logfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include \"logfs.h\"\n\nint __logfs_buf_write(struct logfs_area *area, u64 ofs, void *buf, size_t len,\n\t\tint use_filler)\n{\n\tpgoff_t index = ofs >> PAGE_SHIFT;\n\tstruct page *page;\n\tlong offset = ofs & (PAGE_SIZE-1);\n\tlong copylen;\n\n\t/* Only logfs_wbuf_recover may use len==0 */\n\tBUG_ON(!len && !use_filler);\n\tdo {\n\t\tcopylen = min((ulong)len, PAGE_SIZE - offset);\n\n\t\tpage = get_mapping_page(area->a_sb, index, use_filler);\n\t\tif (IS_ERR(page))\n\t\t\treturn PTR_ERR(page);\n\t\tBUG_ON(!page); /* FIXME: reserve a pool */\n\t\tSetPageUptodate(page);\n\t\tmemcpy(page_address(page) + offset, buf, copylen);\n\n\t\tif (!PagePrivate(page)) {\n\t\t\tSetPagePrivate(page);\n\t\t\tpage_cache_get(page);\n\t\t}\n\t\tpage_cache_release(page);\n\n\t\tbuf += copylen;\n\t\tlen -= copylen;\n\t\toffset = 0;\n\t\tindex++;\n\t} while (len);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline int logfs_buf_write(struct logfs_area *area, u64 ofs,\n\t\tvoid *buf, size_t len)\n{\n\treturn __logfs_buf_write(area, ofs, buf, len, 0);\n}"
  },
  {
    "function_name": "logfs_get_sb_mtd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "491-494",
    "snippet": "static inline int logfs_get_sb_mtd(struct logfs_super *s, int mtdnr)\n{\n\treturn -ENODEV;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline int logfs_get_sb_mtd(struct logfs_super *s, int mtdnr)\n{\n\treturn -ENODEV;\n}"
  },
  {
    "function_name": "logfs_get_sb_bdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
    "lines": "479-484",
    "snippet": "static inline int logfs_get_sb_bdev(struct logfs_super *s,\n\t\tstruct file_system_type *type,\n\t\tconst char *devname)\n{\n\treturn -ENODEV;\n}",
    "includes": [
      "#include \"logfs_abi.h\"",
      "#include <linux/mtd/mtd.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/mempool.h>",
      "#include <linux/kernel.h>",
      "#include <linux/fs.h>",
      "#include <linux/crc32.h>",
      "#include <linux/btree.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline int logfs_get_sb_bdev(struct logfs_super *s,\n\t\tstruct file_system_type *type,\n\t\tconst char *devname)\n{\n\treturn -ENODEV;\n}"
  }
]