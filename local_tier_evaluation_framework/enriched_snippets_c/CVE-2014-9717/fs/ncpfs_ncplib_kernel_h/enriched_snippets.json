[
  {
    "function_name": "ncp_new_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.h",
    "lines": "181-185",
    "snippet": "static inline void\nncp_new_dentry(struct dentry* dentry)\n{\n\tdentry->d_time = jiffies;\n}",
    "includes": [
      "#include <linux/ctype.h>",
      "#include <linux/nls.h>",
      "#include <asm/string.h>",
      "#include <asm/unaligned.h>",
      "#include <asm/byteorder.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/nls.h>\n#include <asm/string.h>\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void\nncp_new_dentry(struct dentry* dentry)\n{\n\tdentry->d_time = jiffies;\n}"
  },
  {
    "function_name": "ncp_age_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.h",
    "lines": "175-179",
    "snippet": "static inline void\nncp_age_dentry(struct ncp_server* server, struct dentry* dentry)\n{\n\tdentry->d_time = jiffies - NCP_MAX_AGE(server);\n}",
    "includes": [
      "#include <linux/ctype.h>",
      "#include <linux/nls.h>",
      "#include <asm/string.h>",
      "#include <asm/unaligned.h>",
      "#include <asm/byteorder.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NCP_MAX_AGE",
          "args": [
            "server"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/nls.h>\n#include <asm/string.h>\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void\nncp_age_dentry(struct ncp_server* server, struct dentry* dentry)\n{\n\tdentry->d_time = jiffies - NCP_MAX_AGE(server);\n}"
  },
  {
    "function_name": "ncp_strnicmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.h",
    "lines": "158-167",
    "snippet": "static inline int ncp_strnicmp(const struct nls_table *t,\n\t\tconst unsigned char *s1, const unsigned char *s2, int len)\n{\n\twhile (len--) {\n\t\tif (tolower(*s1++) != tolower(*s2++))\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/ctype.h>",
      "#include <linux/nls.h>",
      "#include <asm/string.h>",
      "#include <asm/unaligned.h>",
      "#include <asm/byteorder.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tolower",
          "args": [
            "*s2++"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "fat_tolower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/dir.c",
          "lines": "38-41",
          "snippet": "static inline unsigned char fat_tolower(unsigned char c)\n{\n\treturn ((c >= 'A') && (c <= 'Z')) ? c+32 : c;\n}",
          "includes": [
            "#include \"fat.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fat.h\"\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/buffer_head.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstatic inline unsigned char fat_tolower(unsigned char c)\n{\n\treturn ((c >= 'A') && (c <= 'Z')) ? c+32 : c;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/nls.h>\n#include <asm/string.h>\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline int ncp_strnicmp(const struct nls_table *t,\n\t\tconst unsigned char *s1, const unsigned char *s2, int len)\n{\n\twhile (len--) {\n\t\tif (tolower(*s1++) != tolower(*s2++))\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ncp_is_nfs_extras",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.h",
    "lines": "119-126",
    "snippet": "static inline int ncp_is_nfs_extras(struct ncp_server* server, unsigned int volnum) {\n#ifdef CONFIG_NCPFS_NFS_NS\n\treturn (server->m.flags & NCP_MOUNT_NFS_EXTRAS) &&\n\t       (server->name_space[volnum] == NW_NS_NFS);\n#else\n\treturn 0;\n#endif\n}",
    "includes": [
      "#include <linux/ctype.h>",
      "#include <linux/nls.h>",
      "#include <asm/string.h>",
      "#include <asm/unaligned.h>",
      "#include <asm/byteorder.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/nls.h>\n#include <asm/string.h>\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline int ncp_is_nfs_extras(struct ncp_server* server, unsigned int volnum) {\n#ifdef CONFIG_NCPFS_NFS_NS\n\treturn (server->m.flags & NCP_MOUNT_NFS_EXTRAS) &&\n\t       (server->name_space[volnum] == NW_NS_NFS);\n#else\n\treturn 0;\n#endif\n}"
  },
  {
    "function_name": "ncp_inode_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.h",
    "lines": "62-64",
    "snippet": "static inline void ncp_inode_close(struct inode *inode) {\n\tatomic_dec(&NCP_FINFO(inode)->opened);\n}",
    "includes": [
      "#include <linux/ctype.h>",
      "#include <linux/nls.h>",
      "#include <asm/string.h>",
      "#include <asm/unaligned.h>",
      "#include <asm/byteorder.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&NCP_FINFO(inode)->opened"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NCP_FINFO",
          "args": [
            "inode"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "NCP_FINFO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
          "lines": "49-52",
          "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"ncplib_kernel.h\"",
            "#include \"ncp_fs_sb.h\"",
            "#include \"ncp_fs_i.h\"",
            "#include <linux/ncp_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ncp_make_open(struct inode *, int);",
            "int ncp_make_closed(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/nls.h>\n#include <asm/string.h>\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void ncp_inode_close(struct inode *inode) {\n\tatomic_dec(&NCP_FINFO(inode)->opened);\n}"
  },
  {
    "function_name": "ncp_read_bounce_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncplib_kernel.h",
    "lines": "52-54",
    "snippet": "static inline int ncp_read_bounce_size(__u32 size) {\n\treturn sizeof(struct ncp_reply_header) + 2 + 2 + size + 8;\n}",
    "includes": [
      "#include <linux/ctype.h>",
      "#include <linux/nls.h>",
      "#include <asm/string.h>",
      "#include <asm/unaligned.h>",
      "#include <asm/byteorder.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/nls.h>\n#include <asm/string.h>\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline int ncp_read_bounce_size(__u32 size) {\n\treturn sizeof(struct ncp_reply_header) + 2 + 2 + size + 8;\n}"
  }
]