[
  {
    "function_name": "it_jffs2_fs(v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "422-434",
    "snippet": "atic void __exit exit_jffs2_fs(void)\n{\n\tunregister_filesystem(&jffs2_fs_type);\n\tjffs2_destroy_slab_caches();\n\tjffs2_compressors_exit();\n\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(jffs2_inode_cachep);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *jffs2_inode_cachep;",
      "tatic struct file_system_type jffs2_fs_type = {\n\t.owner =\tTHIS_MODULE,\n\t.name =\t\t\"jffs2\",\n\t.mount =\tjffs2_mount,\n\t.kill_sb =\tjffs2_kill_sb,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "em_cache_destroy(j",
          "args": [
            "fs2_inode_cachep);"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u_barrier()",
          "args": [],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_compressors_exit()",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_destroy_slab_caches()",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_filesystem(&",
          "args": [
            "ffs2_fs_type);"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *jffs2_inode_cachep;\ntatic struct file_system_type jffs2_fs_type = {\n\t.owner =\tTHIS_MODULE,\n\t.name =\t\t\"jffs2\",\n\t.mount =\tjffs2_mount,\n\t.kill_sb =\tjffs2_kill_sb,\n};\n\natic void __exit exit_jffs2_fs(void)\n{\n\tunregister_filesystem(&jffs2_fs_type);\n\tjffs2_destroy_slab_caches();\n\tjffs2_compressors_exit();\n\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(jffs2_inode_cachep);\n}"
  },
  {
    "function_name": "nit_jffs2_fs(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "362-420",
    "snippet": "tatic int __init init_jffs2_fs(void)\n{\n\tint ret;\n\n\t/* Paranoia checks for on-medium structures. If we ask GCC\n\t   to pack them with __attribute__((packed)) then it _also_\n\t   assumes that they're not aligned -- so it emits crappy\n\t   code on some architectures. Ideally we want an attribute\n\t   which means just 'no padding', without the alignment\n\t   thing. But GCC doesn't have that -- we have to just\n\t   hope the structs are the right sizes, instead. */\n\tBUILD_BUG_ON(sizeof(struct jffs2_unknown_node) != 12);\n\tBUILD_BUG_ON(sizeof(struct jffs2_raw_dirent) != 40);\n\tBUILD_BUG_ON(sizeof(struct jffs2_raw_inode) != 68);\n\tBUILD_BUG_ON(sizeof(struct jffs2_raw_summary) != 32);\n\n\tpr_info(\"version 2.2.\"\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\t       \" (NAND)\"\n#endif\n#ifdef CONFIG_JFFS2_SUMMARY\n\t       \" (SUMMARY) \"\n#endif\n\t       \" © 2001-2006 Red Hat, Inc.\\n\");\n\n\tjffs2_inode_cachep = kmem_cache_create(\"jffs2_i\",\n\t\t\t\t\t     sizeof(struct jffs2_inode_info),\n\t\t\t\t\t     0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t     jffs2_i_init_once);\n\tif (!jffs2_inode_cachep) {\n\t\tpr_err(\"error: Failed to initialise inode cache\\n\");\n\t\treturn -ENOMEM;\n\t}\n\tret = jffs2_compressors_init();\n\tif (ret) {\n\t\tpr_err(\"error: Failed to initialise compressors\\n\");\n\t\tgoto out;\n\t}\n\tret = jffs2_create_slab_caches();\n\tif (ret) {\n\t\tpr_err(\"error: Failed to initialise slab caches\\n\");\n\t\tgoto out_compressors;\n\t}\n\tret = register_filesystem(&jffs2_fs_type);\n\tif (ret) {\n\t\tpr_err(\"error: Failed to register filesystem\\n\");\n\t\tgoto out_slab;\n\t}\n\treturn 0;\n\n out_slab:\n\tjffs2_destroy_slab_caches();\n out_compressors:\n\tjffs2_compressors_exit();\n out:\n\tkmem_cache_destroy(jffs2_inode_cachep);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *jffs2_inode_cachep;",
      "tatic struct file_system_type jffs2_fs_type = {\n\t.owner =\tTHIS_MODULE,\n\t.name =\t\t\"jffs2\",\n\t.mount =\tjffs2_mount,\n\t.kill_sb =\tjffs2_kill_sb,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "em_cache_destroy(j",
          "args": [
            "fs2_inode_cachep);"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_compressors_exit()",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_destroy_slab_caches()",
          "args": [],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_err(\"",
          "args": [
            "rror: Failed to register filesystem\\n\");"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gister_filesystem(&",
          "args": [
            "ffs2_fs_type);"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_err(\"",
          "args": [
            "rror: Failed to initialise slab caches\\n\");"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_create_slab_caches()",
          "args": [],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_err(\"",
          "args": [
            "rror: Failed to initialise compressors\\n\");"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs2_compressors_init()",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_err(\"",
          "args": [
            "rror: Failed to initialise inode cache\\n\");"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "em_cache_create(\"",
          "args": [
            "ffs2_i\",",
            "zeof(struct jffs2_inode_info),",
            "LAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD),",
            "fs2_i_init_once);"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r_info(",
          "args": [
            "version 2.2.\"\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\t       \" (NAND)\"\n#endif\n#ifdef CONFIG_JFFS2_SUMMARY\n\t       \" (SUMMARY) \"\n#endif\n © 2001-2006 Red Hat, Inc.\\n\");"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UILD_BUG_ON(",
          "args": [
            "izeof(struct jffs2_raw_summary) != 32)"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UILD_BUG_ON(",
          "args": [
            "izeof(struct jffs2_raw_inode) != 68)"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UILD_BUG_ON(",
          "args": [
            "izeof(struct jffs2_raw_dirent) != 40)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UILD_BUG_ON(",
          "args": [
            "izeof(struct jffs2_unknown_node) != 12)"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *jffs2_inode_cachep;\ntatic struct file_system_type jffs2_fs_type = {\n\t.owner =\tTHIS_MODULE,\n\t.name =\t\t\"jffs2\",\n\t.mount =\tjffs2_mount,\n\t.kill_sb =\tjffs2_kill_sb,\n};\n\ntatic int __init init_jffs2_fs(void)\n{\n\tint ret;\n\n\t/* Paranoia checks for on-medium structures. If we ask GCC\n\t   to pack them with __attribute__((packed)) then it _also_\n\t   assumes that they're not aligned -- so it emits crappy\n\t   code on some architectures. Ideally we want an attribute\n\t   which means just 'no padding', without the alignment\n\t   thing. But GCC doesn't have that -- we have to just\n\t   hope the structs are the right sizes, instead. */\n\tBUILD_BUG_ON(sizeof(struct jffs2_unknown_node) != 12);\n\tBUILD_BUG_ON(sizeof(struct jffs2_raw_dirent) != 40);\n\tBUILD_BUG_ON(sizeof(struct jffs2_raw_inode) != 68);\n\tBUILD_BUG_ON(sizeof(struct jffs2_raw_summary) != 32);\n\n\tpr_info(\"version 2.2.\"\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\t       \" (NAND)\"\n#endif\n#ifdef CONFIG_JFFS2_SUMMARY\n\t       \" (SUMMARY) \"\n#endif\n\t       \" © 2001-2006 Red Hat, Inc.\\n\");\n\n\tjffs2_inode_cachep = kmem_cache_create(\"jffs2_i\",\n\t\t\t\t\t     sizeof(struct jffs2_inode_info),\n\t\t\t\t\t     0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t     jffs2_i_init_once);\n\tif (!jffs2_inode_cachep) {\n\t\tpr_err(\"error: Failed to initialise inode cache\\n\");\n\t\treturn -ENOMEM;\n\t}\n\tret = jffs2_compressors_init();\n\tif (ret) {\n\t\tpr_err(\"error: Failed to initialise compressors\\n\");\n\t\tgoto out;\n\t}\n\tret = jffs2_create_slab_caches();\n\tif (ret) {\n\t\tpr_err(\"error: Failed to initialise slab caches\\n\");\n\t\tgoto out_compressors;\n\t}\n\tret = register_filesystem(&jffs2_fs_type);\n\tif (ret) {\n\t\tpr_err(\"error: Failed to register filesystem\\n\");\n\t\tgoto out_slab;\n\t}\n\treturn 0;\n\n out_slab:\n\tjffs2_destroy_slab_caches();\n out_compressors:\n\tjffs2_compressors_exit();\n out:\n\tkmem_cache_destroy(jffs2_inode_cachep);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_kill_sb(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "345-352",
    "snippet": "tatic void jffs2_kill_sb(struct super_block *sb)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\tif (!(sb->s_flags & MS_RDONLY))\n\t\tjffs2_stop_garbage_collect_thread(c);\n\tkill_mtd_super(sb);\n\tkfree(c);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free(",
          "args": [
            ")"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "in_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/scan.c",
          "lines": "51-60",
          "snippet": "tatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}",
          "includes": [
            "include \"debug.h\"",
            "include \"summary.h\"\n#",
            "include \"nodelist.h\"\n#",
            "include <linux/compiler.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/sched.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"debug.h\"\ninclude \"summary.h\"\n#\ninclude \"nodelist.h\"\n#\ninclude <linux/compiler.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/sched.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "ill_mtd_super(",
          "args": [
            "b)"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_stop_garbage_collect_thread(",
          "args": [
            ")"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FFS2_SB_INFO(",
          "args": [
            "b)"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\n\ntatic void jffs2_kill_sb(struct super_block *sb)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\tif (!(sb->s_flags & MS_RDONLY))\n\t\tjffs2_stop_garbage_collect_thread(c);\n\tkill_mtd_super(sb);\n\tkfree(c);\n}"
  },
  {
    "function_name": "ffs2_put_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "320-343",
    "snippet": "tatic void jffs2_put_super (struct super_block *sb)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\n\tjffs2_dbg(2, \"%s()\\n\", __func__);\n\n\tmutex_lock(&c->alloc_sem);\n\tjffs2_flush_wbuf_pad(c);\n\tmutex_unlock(&c->alloc_sem);\n\n\tjffs2_sum_exit(c);\n\n\tjffs2_free_ino_caches(c);\n\tjffs2_free_raw_node_refs(c);\n\tif (jffs2_blocks_use_vmalloc(c))\n\t\tvfree(c->blocks);\n\telse\n\t\tkfree(c->blocks);\n\tjffs2_flash_cleanup(c);\n\tkfree(c->inocache_list);\n\tjffs2_clear_xattr_subsystem(c);\n\tmtd_sync(c->mtd);\n\tjffs2_dbg(1, \"%s(): returning\\n\", __func__);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ffs2_dbg(",
          "args": [
            ",",
            "%s(): returning\\n\",",
            "_func__)"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "td_sync(",
          "args": [
            "->mtd)"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_clear_xattr_subsystem(",
          "args": [
            ")"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_clear_xattr_subsystem(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/xattr.c",
          "lines": "740-772",
          "snippet": "oid jffs2_clear_xattr_subsystem(struct jffs2_sb_info *c)\n{\n\tstruct jffs2_xattr_datum *xd, *_xd;\n\tstruct jffs2_xattr_ref *ref, *_ref;\n\tint i;\n\n\tfor (ref=c->xref_temp; ref; ref = _ref) {\n\t\t_ref = ref->next;\n\t\tjffs2_free_xattr_ref(ref);\n\t}\n\n\tfor (ref=c->xref_dead_list; ref; ref = _ref) {\n\t\t_ref = ref->next;\n\t\tjffs2_free_xattr_ref(ref);\n\t}\n\n\tfor (i=0; i < XATTRINDEX_HASHSIZE; i++) {\n\t\tlist_for_each_entry_safe(xd, _xd, &c->xattrindex[i], xindex) {\n\t\t\tlist_del(&xd->xindex);\n\t\t\tkfree(xd->xname);\n\t\t\tjffs2_free_xattr_datum(xd);\n\t\t}\n\t}\n\n\tlist_for_each_entry_safe(xd, _xd, &c->xattr_dead_list, xindex) {\n\t\tlist_del(&xd->xindex);\n\t\tjffs2_free_xattr_datum(xd);\n\t}\n\tlist_for_each_entry_safe(xd, _xd, &c->xattr_unchecked, xindex) {\n\t\tlist_del(&xd->xindex);\n\t\tjffs2_free_xattr_datum(xd);\n\t}\n}",
          "includes": [
            "include \"nodelist.h\"\n/",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/posix_acl_xattr.h>\n#",
            "include <linux/xattr.h>\n#",
            "include <linux/jffs2.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/highmem.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/time.h>\n#",
            "include <linux/fs.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"nodelist.h\"\n/\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/posix_acl_xattr.h>\n#\ninclude <linux/xattr.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/highmem.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/time.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\noid jffs2_clear_xattr_subsystem(struct jffs2_sb_info *c)\n{\n\tstruct jffs2_xattr_datum *xd, *_xd;\n\tstruct jffs2_xattr_ref *ref, *_ref;\n\tint i;\n\n\tfor (ref=c->xref_temp; ref; ref = _ref) {\n\t\t_ref = ref->next;\n\t\tjffs2_free_xattr_ref(ref);\n\t}\n\n\tfor (ref=c->xref_dead_list; ref; ref = _ref) {\n\t\t_ref = ref->next;\n\t\tjffs2_free_xattr_ref(ref);\n\t}\n\n\tfor (i=0; i < XATTRINDEX_HASHSIZE; i++) {\n\t\tlist_for_each_entry_safe(xd, _xd, &c->xattrindex[i], xindex) {\n\t\t\tlist_del(&xd->xindex);\n\t\t\tkfree(xd->xname);\n\t\t\tjffs2_free_xattr_datum(xd);\n\t\t}\n\t}\n\n\tlist_for_each_entry_safe(xd, _xd, &c->xattr_dead_list, xindex) {\n\t\tlist_del(&xd->xindex);\n\t\tjffs2_free_xattr_datum(xd);\n\t}\n\tlist_for_each_entry_safe(xd, _xd, &c->xattr_unchecked, xindex) {\n\t\tlist_del(&xd->xindex);\n\t\tjffs2_free_xattr_datum(xd);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "free(",
          "args": [
            "->inocache_list)"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "in_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/scan.c",
          "lines": "51-60",
          "snippet": "tatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}",
          "includes": [
            "include \"debug.h\"",
            "include \"summary.h\"\n#",
            "include \"nodelist.h\"\n#",
            "include <linux/compiler.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/sched.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"debug.h\"\ninclude \"summary.h\"\n#\ninclude \"nodelist.h\"\n#\ninclude <linux/compiler.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/sched.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "ffs2_flash_cleanup(",
          "args": [
            ")"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_blocks_use_vmalloc(",
          "args": [
            ")"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_blocks_use_vmalloc(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.h",
          "lines": "292-295",
          "snippet": "tatic inline int jffs2_blocks_use_vmalloc(struct jffs2_sb_info *c)\n{\n\treturn ((c->flash_size / c->sector_size) * sizeof (struct jffs2_eraseblock)) > (128 * 1024);\n}",
          "includes": [
            "include \"debug.h\"",
            "include \"os-linux.h\"\n#",
            "include \"os-ecos.h\"\n#",
            "include \"summary.h\"",
            "include \"acl.h\"\n#",
            "include \"xattr.h\"\n#",
            "include \"jffs2_fs_i.h\"\n#",
            "include \"jffs2_fs_sb.h\"\n#",
            "include <linux/jffs2.h>\n#",
            "include <linux/types.h>\n#",
            "include <linux/fs.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"debug.h\"\ninclude \"os-linux.h\"\n#\ninclude \"os-ecos.h\"\n#\ninclude \"summary.h\"\ninclude \"acl.h\"\n#\ninclude \"xattr.h\"\n#\ninclude \"jffs2_fs_i.h\"\n#\ninclude \"jffs2_fs_sb.h\"\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/types.h>\n#\ninclude <linux/fs.h>\n#\n\ntatic inline int jffs2_blocks_use_vmalloc(struct jffs2_sb_info *c)\n{\n\treturn ((c->flash_size / c->sector_size) * sizeof (struct jffs2_eraseblock)) > (128 * 1024);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ffs2_free_raw_node_refs(",
          "args": [
            ")"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_free_raw_node_refs(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.c",
          "lines": "504-522",
          "snippet": "oid jffs2_free_raw_node_refs(struct jffs2_sb_info *c)\n{\n\tint i;\n\tstruct jffs2_raw_node_ref *this, *next;\n\n\tfor (i=0; i<c->nr_blocks; i++) {\n\t\tthis = c->blocks[i].first_node;\n\t\twhile (this) {\n\t\t\tif (this[REFS_PER_BLOCK].flash_offset == REF_LINK_NODE)\n\t\t\t\tnext = this[REFS_PER_BLOCK].next_in_ino;\n\t\t\telse\n\t\t\t\tnext = NULL;\n\n\t\t\tjffs2_free_refblock(this);\n\t\t\tthis = next;\n\t\t}\n\t\tc->blocks[i].first_node = c->blocks[i].last_node = NULL;\n\t}\n}",
          "includes": [
            "include \"nodelist.h\"",
            "include <linux/pagemap.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/rbtree.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/fs.h>\n#",
            "include <linux/sched.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [
            "tatic void jffs2_obsolete_node_frag(struct jffs2_sb_info *c,\n\t\t\t\t     struct jffs2_node_frag *this);"
          ],
          "called_functions": [],
          "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/pagemap.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/rbtree.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/sched.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_obsolete_node_frag(struct jffs2_sb_info *c,\n\t\t\t\t     struct jffs2_node_frag *this);\n\noid jffs2_free_raw_node_refs(struct jffs2_sb_info *c)\n{\n\tint i;\n\tstruct jffs2_raw_node_ref *this, *next;\n\n\tfor (i=0; i<c->nr_blocks; i++) {\n\t\tthis = c->blocks[i].first_node;\n\t\twhile (this) {\n\t\t\tif (this[REFS_PER_BLOCK].flash_offset == REF_LINK_NODE)\n\t\t\t\tnext = this[REFS_PER_BLOCK].next_in_ino;\n\t\t\telse\n\t\t\t\tnext = NULL;\n\n\t\t\tjffs2_free_refblock(this);\n\t\t\tthis = next;\n\t\t}\n\t\tc->blocks[i].first_node = c->blocks[i].last_node = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ffs2_free_ino_caches(",
          "args": [
            ")"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_free_ino_caches(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.c",
          "lines": "487-502",
          "snippet": "oid jffs2_free_ino_caches(struct jffs2_sb_info *c)\n{\n\tint i;\n\tstruct jffs2_inode_cache *this, *next;\n\n\tfor (i=0; i < c->inocache_hashsize; i++) {\n\t\tthis = c->inocache_list[i];\n\t\twhile (this) {\n\t\t\tnext = this->next;\n\t\t\tjffs2_xattr_free_inode(c, this);\n\t\t\tjffs2_free_inode_cache(this);\n\t\t\tthis = next;\n\t\t}\n\t\tc->inocache_list[i] = NULL;\n\t}\n}",
          "includes": [
            "include \"nodelist.h\"",
            "include <linux/pagemap.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/rbtree.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/fs.h>\n#",
            "include <linux/sched.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [
            "tatic void jffs2_obsolete_node_frag(struct jffs2_sb_info *c,\n\t\t\t\t     struct jffs2_node_frag *this);"
          ],
          "called_functions": [],
          "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/pagemap.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/rbtree.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/sched.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_obsolete_node_frag(struct jffs2_sb_info *c,\n\t\t\t\t     struct jffs2_node_frag *this);\n\noid jffs2_free_ino_caches(struct jffs2_sb_info *c)\n{\n\tint i;\n\tstruct jffs2_inode_cache *this, *next;\n\n\tfor (i=0; i < c->inocache_hashsize; i++) {\n\t\tthis = c->inocache_list[i];\n\t\twhile (this) {\n\t\t\tnext = this->next;\n\t\t\tjffs2_xattr_free_inode(c, this);\n\t\t\tjffs2_free_inode_cache(this);\n\t\t\tthis = next;\n\t\t}\n\t\tc->inocache_list[i] = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ffs2_sum_exit(",
          "args": [
            ")"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_sum_exit(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/summary.c",
          "lines": "50-61",
          "snippet": "oid jffs2_sum_exit(struct jffs2_sb_info *c)\n{\n\tdbg_summary(\"called\\n\");\n\n\tjffs2_sum_disable_collecting(c->summary);\n\n\tkfree(c->summary->sum_buf);\n\tc->summary->sum_buf = NULL;\n\n\tkfree(c->summary);\n\tc->summary = NULL;\n}",
          "includes": [
            "include \"debug.h\"",
            "include \"nodelist.h\"\n#",
            "include <linux/vmalloc.h>\n#",
            "include <linux/compiler.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"debug.h\"\ninclude \"nodelist.h\"\n#\ninclude <linux/vmalloc.h>\n#\ninclude <linux/compiler.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\noid jffs2_sum_exit(struct jffs2_sb_info *c)\n{\n\tdbg_summary(\"called\\n\");\n\n\tjffs2_sum_disable_collecting(c->summary);\n\n\tkfree(c->summary->sum_buf);\n\tc->summary->sum_buf = NULL;\n\n\tkfree(c->summary);\n\tc->summary = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "utex_unlock(",
          "args": [
            "c->alloc_sem)"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_flush_wbuf_pad(",
          "args": [
            ")"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utex_lock(",
          "args": [
            "c->alloc_sem)"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_dbg(",
          "args": [
            ",",
            "%s()\\n\",",
            "_func__)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FFS2_SB_INFO(",
          "args": [
            "b)"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\n\ntatic void jffs2_put_super (struct super_block *sb)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\n\tjffs2_dbg(2, \"%s()\\n\", __func__);\n\n\tmutex_lock(&c->alloc_sem);\n\tjffs2_flush_wbuf_pad(c);\n\tmutex_unlock(&c->alloc_sem);\n\n\tjffs2_sum_exit(c);\n\n\tjffs2_free_ino_caches(c);\n\tjffs2_free_raw_node_refs(c);\n\tif (jffs2_blocks_use_vmalloc(c))\n\t\tvfree(c->blocks);\n\telse\n\t\tkfree(c->blocks);\n\tjffs2_flash_cleanup(c);\n\tkfree(c->inocache_list);\n\tjffs2_clear_xattr_subsystem(c);\n\tmtd_sync(c->mtd);\n\tjffs2_dbg(1, \"%s(): returning\\n\", __func__);\n}"
  },
  {
    "function_name": "ffs2_mount(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "313-318",
    "snippet": "tatic struct dentry *jffs2_mount(struct file_system_type *fs_type,\n\t\t\tint flags, const char *dev_name,\n\t\t\tvoid *data)\n{\n\treturn mount_mtd(fs_type, flags, dev_name, data, jffs2_fill_super);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ount_mtd(",
          "args": [
            "s_type,",
            "lags,",
            "ev_name,",
            "ata,",
            "ffs2_fill_super)"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct dentry *jffs2_mount(struct file_system_type *fs_type,\n\t\t\tint flags, const char *dev_name,\n\t\t\tvoid *data)\n{\n\treturn mount_mtd(fs_type, flags, dev_name, data, jffs2_fill_super);\n}"
  },
  {
    "function_name": "ffs2_fill_super(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "270-311",
    "snippet": "tatic int jffs2_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstruct jffs2_sb_info *c;\n\tint ret;\n\n\tjffs2_dbg(1, \"jffs2_get_sb_mtd():\"\n\t\t  \" New superblock for device %d (\\\"%s\\\")\\n\",\n\t\t  sb->s_mtd->index, sb->s_mtd->name);\n\n\tc = kzalloc(sizeof(*c), GFP_KERNEL);\n\tif (!c)\n\t\treturn -ENOMEM;\n\n\tc->mtd = sb->s_mtd;\n\tc->os_priv = sb;\n\tsb->s_fs_info = c;\n\n\tret = jffs2_parse_options(c, data);\n\tif (ret) {\n\t\tkfree(c);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Initialize JFFS2 superblock locks, the further initialization will\n\t * be done later */\n\tmutex_init(&c->alloc_sem);\n\tmutex_init(&c->erase_free_sem);\n\tinit_waitqueue_head(&c->erase_wait);\n\tinit_waitqueue_head(&c->inocache_wq);\n\tspin_lock_init(&c->erase_completion_lock);\n\tspin_lock_init(&c->inocache_lock);\n\n\tsb->s_op = &jffs2_super_operations;\n\tsb->s_export_op = &jffs2_export_ops;\n\tsb->s_flags = sb->s_flags | MS_NOATIME;\n\tsb->s_xattr = jffs2_xattr_handlers;\n#ifdef CONFIG_JFFS2_FS_POSIX_ACL\n\tsb->s_flags |= MS_POSIXACL;\n#endif\n\tret = jffs2_do_fill_super(sb, data, silent);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);",
      "tatic const struct export_operations jffs2_export_ops = {\n\t.get_parent = jffs2_get_parent,\n\t.fh_to_dentry = jffs2_fh_to_dentry,\n\t.fh_to_parent = jffs2_fh_to_parent,\n};",
      "tatic const struct super_operations jffs2_super_operations =\n{\n\t.alloc_inode =\tjffs2_alloc_inode,\n\t.destroy_inode =jffs2_destroy_inode,\n\t.put_super =\tjffs2_put_super,\n\t.statfs =\tjffs2_statfs,\n\t.remount_fs =\tjffs2_remount_fs,\n\t.evict_inode =\tjffs2_evict_inode,\n\t.dirty_inode =\tjffs2_dirty_inode,\n\t.show_options =\tjffs2_show_options,\n\t.sync_fs =\tjffs2_sync_fs,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ffs2_do_fill_super(",
          "args": [
            "b,",
            "ata,",
            "ilent)"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pin_lock_init(",
          "args": [
            "c->inocache_lock)"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pin_lock_init(",
          "args": [
            "c->erase_completion_lock)"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nit_waitqueue_head(",
          "args": [
            "c->inocache_wq)"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nit_waitqueue_head(",
          "args": [
            "c->erase_wait)"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utex_init(",
          "args": [
            "c->erase_free_sem)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utex_init(",
          "args": [
            "c->alloc_sem)"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free(",
          "args": [
            ")"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "in_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/scan.c",
          "lines": "51-60",
          "snippet": "tatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}",
          "includes": [
            "include \"debug.h\"",
            "include \"summary.h\"\n#",
            "include \"nodelist.h\"\n#",
            "include <linux/compiler.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/sched.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"debug.h\"\ninclude \"summary.h\"\n#\ninclude \"nodelist.h\"\n#\ninclude <linux/compiler.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/sched.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "ffs2_parse_options(",
          "args": [
            ",",
            "ata)"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_parse_options(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
          "lines": "178-239",
          "snippet": "tatic int jffs2_parse_options(struct jffs2_sb_info *c, char *data)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tchar *p, *name;\n\tunsigned int opt;\n\n\tif (!data)\n\t\treturn 0;\n\n\twhile ((p = strsep(&data, \",\"))) {\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase Opt_override_compr:\n\t\t\tname = match_strdup(&args[0]);\n\n\t\t\tif (!name)\n\t\t\t\treturn -ENOMEM;\n\t\t\tif (!strcmp(name, \"none\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_NONE;\n#ifdef CONFIG_JFFS2_LZO\n\t\t\telse if (!strcmp(name, \"lzo\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_FORCELZO;\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\t\t\telse if (!strcmp(name, \"zlib\"))\n\t\t\t\tc->mount_opts.compr =\n\t\t\t\t\t\tJFFS2_COMPR_MODE_FORCEZLIB;\n#endif\n\t\t\telse {\n\t\t\t\tpr_err(\"Error: unknown compressor \\\"%s\\\"\\n\",\n\t\t\t\t       name);\n\t\t\t\tkfree(name);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tkfree(name);\n\t\t\tc->mount_opts.override_compr = true;\n\t\t\tbreak;\n\t\tcase Opt_rp_size:\n\t\t\tif (match_int(&args[0], &opt))\n\t\t\t\treturn -EINVAL;\n\t\t\topt *= 1024;\n\t\t\tif (opt > c->mtd->size) {\n\t\t\t\tpr_warn(\"Too large reserve pool specified, max \"\n\t\t\t\t\t\"is %llu KB\\n\", c->mtd->size / 1024);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tc->mount_opts.rp_size = opt;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"Error: unrecognized mount option '%s' or missing value\\n\",\n\t\t\t       p);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "include \"nodelist.h\"",
            "include \"compr.h\"\n#",
            "include <linux/exportfs.h>\n#",
            "include <linux/seq_file.h>\n#",
            "include <linux/namei.h>\n#",
            "include <linux/ctype.h>\n#",
            "include <linux/mtd/super.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/jffs2.h>\n#",
            "include <linux/parser.h>\n#",
            "include <linux/mount.h>\n#",
            "include <linux/err.h>\n#",
            "include <linux/fs.h>\n#",
            "include <linux/list.h>\n#",
            "include <linux/init.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/module.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [
            "tatic const match_table_t tokens = {\n\t{Opt_override_compr, \"compr=%s\"},\n\t{Opt_rp_size, \"rp_size=%u\"},\n\t{Opt_err, NULL},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic const match_table_t tokens = {\n\t{Opt_override_compr, \"compr=%s\"},\n\t{Opt_rp_size, \"rp_size=%u\"},\n\t{Opt_err, NULL},\n};\n\ntatic int jffs2_parse_options(struct jffs2_sb_info *c, char *data)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tchar *p, *name;\n\tunsigned int opt;\n\n\tif (!data)\n\t\treturn 0;\n\n\twhile ((p = strsep(&data, \",\"))) {\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase Opt_override_compr:\n\t\t\tname = match_strdup(&args[0]);\n\n\t\t\tif (!name)\n\t\t\t\treturn -ENOMEM;\n\t\t\tif (!strcmp(name, \"none\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_NONE;\n#ifdef CONFIG_JFFS2_LZO\n\t\t\telse if (!strcmp(name, \"lzo\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_FORCELZO;\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\t\t\telse if (!strcmp(name, \"zlib\"))\n\t\t\t\tc->mount_opts.compr =\n\t\t\t\t\t\tJFFS2_COMPR_MODE_FORCEZLIB;\n#endif\n\t\t\telse {\n\t\t\t\tpr_err(\"Error: unknown compressor \\\"%s\\\"\\n\",\n\t\t\t\t       name);\n\t\t\t\tkfree(name);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tkfree(name);\n\t\t\tc->mount_opts.override_compr = true;\n\t\t\tbreak;\n\t\tcase Opt_rp_size:\n\t\t\tif (match_int(&args[0], &opt))\n\t\t\t\treturn -EINVAL;\n\t\t\topt *= 1024;\n\t\t\tif (opt > c->mtd->size) {\n\t\t\t\tpr_warn(\"Too large reserve pool specified, max \"\n\t\t\t\t\t\"is %llu KB\\n\", c->mtd->size / 1024);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tc->mount_opts.rp_size = opt;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"Error: unrecognized mount option '%s' or missing value\\n\",\n\t\t\t       p);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zalloc(",
          "args": [
            "izeof(*c),",
            "FP_KERNEL)"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_dbg(",
          "args": [
            ",",
            "jffs2_get_sb_mtd():\"\n\t\t  \" New superblock for device %d (\\\"%s\\\")\\n\",",
            "b->s_mtd->index,",
            "b->s_mtd->name)"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\ntatic const struct export_operations jffs2_export_ops = {\n\t.get_parent = jffs2_get_parent,\n\t.fh_to_dentry = jffs2_fh_to_dentry,\n\t.fh_to_parent = jffs2_fh_to_parent,\n};\ntatic const struct super_operations jffs2_super_operations =\n{\n\t.alloc_inode =\tjffs2_alloc_inode,\n\t.destroy_inode =jffs2_destroy_inode,\n\t.put_super =\tjffs2_put_super,\n\t.statfs =\tjffs2_statfs,\n\t.remount_fs =\tjffs2_remount_fs,\n\t.evict_inode =\tjffs2_evict_inode,\n\t.dirty_inode =\tjffs2_dirty_inode,\n\t.show_options =\tjffs2_show_options,\n\t.sync_fs =\tjffs2_sync_fs,\n};\n\ntatic int jffs2_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstruct jffs2_sb_info *c;\n\tint ret;\n\n\tjffs2_dbg(1, \"jffs2_get_sb_mtd():\"\n\t\t  \" New superblock for device %d (\\\"%s\\\")\\n\",\n\t\t  sb->s_mtd->index, sb->s_mtd->name);\n\n\tc = kzalloc(sizeof(*c), GFP_KERNEL);\n\tif (!c)\n\t\treturn -ENOMEM;\n\n\tc->mtd = sb->s_mtd;\n\tc->os_priv = sb;\n\tsb->s_fs_info = c;\n\n\tret = jffs2_parse_options(c, data);\n\tif (ret) {\n\t\tkfree(c);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Initialize JFFS2 superblock locks, the further initialization will\n\t * be done later */\n\tmutex_init(&c->alloc_sem);\n\tmutex_init(&c->erase_free_sem);\n\tinit_waitqueue_head(&c->erase_wait);\n\tinit_waitqueue_head(&c->inocache_wq);\n\tspin_lock_init(&c->erase_completion_lock);\n\tspin_lock_init(&c->inocache_lock);\n\n\tsb->s_op = &jffs2_super_operations;\n\tsb->s_export_op = &jffs2_export_ops;\n\tsb->s_flags = sb->s_flags | MS_NOATIME;\n\tsb->s_xattr = jffs2_xattr_handlers;\n#ifdef CONFIG_JFFS2_FS_POSIX_ACL\n\tsb->s_flags |= MS_POSIXACL;\n#endif\n\tret = jffs2_do_fill_super(sb, data, silent);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_remount_fs(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "241-252",
    "snippet": "tatic int jffs2_remount_fs(struct super_block *sb, int *flags, char *data)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\tint err;\n\n\tsync_filesystem(sb);\n\terr = jffs2_parse_options(c, data);\n\tif (err)\n\t\treturn -EINVAL;\n\n\treturn jffs2_do_remount_fs(sb, flags, data);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ffs2_do_remount_fs(",
          "args": [
            "b,",
            "lags,",
            "ata)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_parse_options(",
          "args": [
            ",",
            "ata)"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_parse_options(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
          "lines": "178-239",
          "snippet": "tatic int jffs2_parse_options(struct jffs2_sb_info *c, char *data)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tchar *p, *name;\n\tunsigned int opt;\n\n\tif (!data)\n\t\treturn 0;\n\n\twhile ((p = strsep(&data, \",\"))) {\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase Opt_override_compr:\n\t\t\tname = match_strdup(&args[0]);\n\n\t\t\tif (!name)\n\t\t\t\treturn -ENOMEM;\n\t\t\tif (!strcmp(name, \"none\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_NONE;\n#ifdef CONFIG_JFFS2_LZO\n\t\t\telse if (!strcmp(name, \"lzo\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_FORCELZO;\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\t\t\telse if (!strcmp(name, \"zlib\"))\n\t\t\t\tc->mount_opts.compr =\n\t\t\t\t\t\tJFFS2_COMPR_MODE_FORCEZLIB;\n#endif\n\t\t\telse {\n\t\t\t\tpr_err(\"Error: unknown compressor \\\"%s\\\"\\n\",\n\t\t\t\t       name);\n\t\t\t\tkfree(name);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tkfree(name);\n\t\t\tc->mount_opts.override_compr = true;\n\t\t\tbreak;\n\t\tcase Opt_rp_size:\n\t\t\tif (match_int(&args[0], &opt))\n\t\t\t\treturn -EINVAL;\n\t\t\topt *= 1024;\n\t\t\tif (opt > c->mtd->size) {\n\t\t\t\tpr_warn(\"Too large reserve pool specified, max \"\n\t\t\t\t\t\"is %llu KB\\n\", c->mtd->size / 1024);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tc->mount_opts.rp_size = opt;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"Error: unrecognized mount option '%s' or missing value\\n\",\n\t\t\t       p);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "include \"nodelist.h\"",
            "include \"compr.h\"\n#",
            "include <linux/exportfs.h>\n#",
            "include <linux/seq_file.h>\n#",
            "include <linux/namei.h>\n#",
            "include <linux/ctype.h>\n#",
            "include <linux/mtd/super.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/jffs2.h>\n#",
            "include <linux/parser.h>\n#",
            "include <linux/mount.h>\n#",
            "include <linux/err.h>\n#",
            "include <linux/fs.h>\n#",
            "include <linux/list.h>\n#",
            "include <linux/init.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/module.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [
            "tatic const match_table_t tokens = {\n\t{Opt_override_compr, \"compr=%s\"},\n\t{Opt_rp_size, \"rp_size=%u\"},\n\t{Opt_err, NULL},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic const match_table_t tokens = {\n\t{Opt_override_compr, \"compr=%s\"},\n\t{Opt_rp_size, \"rp_size=%u\"},\n\t{Opt_err, NULL},\n};\n\ntatic int jffs2_parse_options(struct jffs2_sb_info *c, char *data)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tchar *p, *name;\n\tunsigned int opt;\n\n\tif (!data)\n\t\treturn 0;\n\n\twhile ((p = strsep(&data, \",\"))) {\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase Opt_override_compr:\n\t\t\tname = match_strdup(&args[0]);\n\n\t\t\tif (!name)\n\t\t\t\treturn -ENOMEM;\n\t\t\tif (!strcmp(name, \"none\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_NONE;\n#ifdef CONFIG_JFFS2_LZO\n\t\t\telse if (!strcmp(name, \"lzo\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_FORCELZO;\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\t\t\telse if (!strcmp(name, \"zlib\"))\n\t\t\t\tc->mount_opts.compr =\n\t\t\t\t\t\tJFFS2_COMPR_MODE_FORCEZLIB;\n#endif\n\t\t\telse {\n\t\t\t\tpr_err(\"Error: unknown compressor \\\"%s\\\"\\n\",\n\t\t\t\t       name);\n\t\t\t\tkfree(name);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tkfree(name);\n\t\t\tc->mount_opts.override_compr = true;\n\t\t\tbreak;\n\t\tcase Opt_rp_size:\n\t\t\tif (match_int(&args[0], &opt))\n\t\t\t\treturn -EINVAL;\n\t\t\topt *= 1024;\n\t\t\tif (opt > c->mtd->size) {\n\t\t\t\tpr_warn(\"Too large reserve pool specified, max \"\n\t\t\t\t\t\"is %llu KB\\n\", c->mtd->size / 1024);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tc->mount_opts.rp_size = opt;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"Error: unrecognized mount option '%s' or missing value\\n\",\n\t\t\t       p);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ync_filesystem(",
          "args": [
            "b)"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FFS2_SB_INFO(",
          "args": [
            "b)"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\n\ntatic int jffs2_remount_fs(struct super_block *sb, int *flags, char *data)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\tint err;\n\n\tsync_filesystem(sb);\n\terr = jffs2_parse_options(c, data);\n\tif (err)\n\t\treturn -EINVAL;\n\n\treturn jffs2_do_remount_fs(sb, flags, data);\n}"
  },
  {
    "function_name": "ffs2_parse_options(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "178-239",
    "snippet": "tatic int jffs2_parse_options(struct jffs2_sb_info *c, char *data)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tchar *p, *name;\n\tunsigned int opt;\n\n\tif (!data)\n\t\treturn 0;\n\n\twhile ((p = strsep(&data, \",\"))) {\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase Opt_override_compr:\n\t\t\tname = match_strdup(&args[0]);\n\n\t\t\tif (!name)\n\t\t\t\treturn -ENOMEM;\n\t\t\tif (!strcmp(name, \"none\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_NONE;\n#ifdef CONFIG_JFFS2_LZO\n\t\t\telse if (!strcmp(name, \"lzo\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_FORCELZO;\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\t\t\telse if (!strcmp(name, \"zlib\"))\n\t\t\t\tc->mount_opts.compr =\n\t\t\t\t\t\tJFFS2_COMPR_MODE_FORCEZLIB;\n#endif\n\t\t\telse {\n\t\t\t\tpr_err(\"Error: unknown compressor \\\"%s\\\"\\n\",\n\t\t\t\t       name);\n\t\t\t\tkfree(name);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tkfree(name);\n\t\t\tc->mount_opts.override_compr = true;\n\t\t\tbreak;\n\t\tcase Opt_rp_size:\n\t\t\tif (match_int(&args[0], &opt))\n\t\t\t\treturn -EINVAL;\n\t\t\topt *= 1024;\n\t\t\tif (opt > c->mtd->size) {\n\t\t\t\tpr_warn(\"Too large reserve pool specified, max \"\n\t\t\t\t\t\"is %llu KB\\n\", c->mtd->size / 1024);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tc->mount_opts.rp_size = opt;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"Error: unrecognized mount option '%s' or missing value\\n\",\n\t\t\t       p);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic const match_table_t tokens = {\n\t{Opt_override_compr, \"compr=%s\"},\n\t{Opt_rp_size, \"rp_size=%u\"},\n\t{Opt_err, NULL},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "r_err(",
          "args": [
            "Error: unrecognized mount option '%s' or missing value\\n\",",
            ")"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r_warn(",
          "args": [
            "Too large reserve pool specified, max \"\n\t\t\t\t\t\"is %llu KB\\n\",",
            "->mtd->size / 1024)"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atch_int(",
          "args": [
            "args[0],",
            "opt)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free(",
          "args": [
            "ame)"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "in_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/scan.c",
          "lines": "51-60",
          "snippet": "tatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}",
          "includes": [
            "include \"debug.h\"",
            "include \"summary.h\"\n#",
            "include \"nodelist.h\"\n#",
            "include <linux/compiler.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/sched.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"debug.h\"\ninclude \"summary.h\"\n#\ninclude \"nodelist.h\"\n#\ninclude <linux/compiler.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/sched.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "r_err(",
          "args": [
            "Error: unknown compressor \\\"%s\\\"\\n\",",
            "ame)"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "ame,",
            "zlib\")"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "ame,",
            "lzo\")"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "ame,",
            "none\")"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atch_strdup(",
          "args": [
            "args[0])"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atch_token(",
          "args": [
            ",",
            "okens,",
            "rgs)"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trsep(",
          "args": [
            "data,",
            ",\")"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic const match_table_t tokens = {\n\t{Opt_override_compr, \"compr=%s\"},\n\t{Opt_rp_size, \"rp_size=%u\"},\n\t{Opt_err, NULL},\n};\n\ntatic int jffs2_parse_options(struct jffs2_sb_info *c, char *data)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tchar *p, *name;\n\tunsigned int opt;\n\n\tif (!data)\n\t\treturn 0;\n\n\twhile ((p = strsep(&data, \",\"))) {\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase Opt_override_compr:\n\t\t\tname = match_strdup(&args[0]);\n\n\t\t\tif (!name)\n\t\t\t\treturn -ENOMEM;\n\t\t\tif (!strcmp(name, \"none\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_NONE;\n#ifdef CONFIG_JFFS2_LZO\n\t\t\telse if (!strcmp(name, \"lzo\"))\n\t\t\t\tc->mount_opts.compr = JFFS2_COMPR_MODE_FORCELZO;\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\t\t\telse if (!strcmp(name, \"zlib\"))\n\t\t\t\tc->mount_opts.compr =\n\t\t\t\t\t\tJFFS2_COMPR_MODE_FORCEZLIB;\n#endif\n\t\t\telse {\n\t\t\t\tpr_err(\"Error: unknown compressor \\\"%s\\\"\\n\",\n\t\t\t\t       name);\n\t\t\t\tkfree(name);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tkfree(name);\n\t\t\tc->mount_opts.override_compr = true;\n\t\t\tbreak;\n\t\tcase Opt_rp_size:\n\t\t\tif (match_int(&args[0], &opt))\n\t\t\t\treturn -EINVAL;\n\t\t\topt *= 1024;\n\t\t\tif (opt > c->mtd->size) {\n\t\t\t\tpr_warn(\"Too large reserve pool specified, max \"\n\t\t\t\t\t\"is %llu KB\\n\", c->mtd->size / 1024);\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t\tc->mount_opts.rp_size = opt;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"Error: unrecognized mount option '%s' or missing value\\n\",\n\t\t\t       p);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ffs2_get_parent(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "136-151",
    "snippet": "tatic struct dentry *jffs2_get_parent(struct dentry *child)\n{\n\tstruct jffs2_inode_info *f;\n\tuint32_t pino;\n\n\tBUG_ON(!d_is_dir(child));\n\n\tf = JFFS2_INODE_INFO(child->d_inode);\n\n\tpino = f->inocache->pino_nlink;\n\n\tJFFS2_DEBUG(\"Parent of directory ino #%u is #%u\\n\",\n\t\t    f->inocache->ino, pino);\n\n\treturn d_obtain_alias(jffs2_iget(child->d_inode->i_sb, pino));\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_obtain_alias(",
          "args": [
            "ffs2_iget(child->d_inode->i_sb, pino))"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_iget(",
          "args": [
            "hild->d_inode->i_sb,",
            "ino)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FFS2_DEBUG(",
          "args": [
            "Parent of directory ino #%u is #%u\\n\",",
            "->inocache->ino,",
            "ino)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FFS2_INODE_INFO(",
          "args": [
            "hild->d_inode)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UG_ON(",
          "args": [
            "d_is_dir(child))"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_is_dir(",
          "args": [
            "hild)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct dentry *jffs2_get_parent(struct dentry *child)\n{\n\tstruct jffs2_inode_info *f;\n\tuint32_t pino;\n\n\tBUG_ON(!d_is_dir(child));\n\n\tf = JFFS2_INODE_INFO(child->d_inode);\n\n\tpino = f->inocache->pino_nlink;\n\n\tJFFS2_DEBUG(\"Parent of directory ino #%u is #%u\\n\",\n\t\t    f->inocache->ino, pino);\n\n\treturn d_obtain_alias(jffs2_iget(child->d_inode->i_sb, pino));\n}"
  },
  {
    "function_name": "ffs2_fh_to_parent(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "129-134",
    "snippet": "tatic struct dentry *jffs2_fh_to_parent(struct super_block *sb, struct fid *fid,\n\t\t\t\t\t int fh_len, int fh_type)\n{\n        return generic_fh_to_parent(sb, fid, fh_len, fh_type,\n                                    jffs2_nfs_get_inode);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eneric_fh_to_parent(",
          "args": [
            "b,",
            "id,",
            "h_len,",
            "h_type,",
            "ffs2_nfs_get_inode)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\n\ntatic struct dentry *jffs2_fh_to_parent(struct super_block *sb, struct fid *fid,\n\t\t\t\t\t int fh_len, int fh_type)\n{\n        return generic_fh_to_parent(sb, fid, fh_len, fh_type,\n                                    jffs2_nfs_get_inode);\n}"
  },
  {
    "function_name": "ffs2_fh_to_dentry(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "122-127",
    "snippet": "tatic struct dentry *jffs2_fh_to_dentry(struct super_block *sb, struct fid *fid,\n\t\t\t\t\t int fh_len, int fh_type)\n{\n        return generic_fh_to_dentry(sb, fid, fh_len, fh_type,\n                                    jffs2_nfs_get_inode);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eneric_fh_to_dentry(",
          "args": [
            "b,",
            "id,",
            "h_len,",
            "h_type,",
            "ffs2_nfs_get_inode)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\n\ntatic struct dentry *jffs2_fh_to_dentry(struct super_block *sb, struct fid *fid,\n\t\t\t\t\t int fh_len, int fh_type)\n{\n        return generic_fh_to_dentry(sb, fid, fh_len, fh_type,\n                                    jffs2_nfs_get_inode);\n}"
  },
  {
    "function_name": "ffs2_nfs_get_inode(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "113-120",
    "snippet": "tatic struct inode *jffs2_nfs_get_inode(struct super_block *sb, uint64_t ino,\n\t\t\t\t\t uint32_t generation)\n{\n\t/* We don't care about i_generation. We'll destroy the flash\n\t   before we start re-using inode numbers anyway. And even\n\t   if that wasn't true, we'd have other problems...*/\n\treturn jffs2_iget(sb, ino);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ffs2_iget(",
          "args": [
            "b,",
            "no)"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\n\ntatic struct inode *jffs2_nfs_get_inode(struct super_block *sb, uint64_t ino,\n\t\t\t\t\t uint32_t generation)\n{\n\t/* We don't care about i_generation. We'll destroy the flash\n\t   before we start re-using inode numbers anyway. And even\n\t   if that wasn't true, we'd have other problems...*/\n\treturn jffs2_iget(sb, ino);\n}"
  },
  {
    "function_name": "ffs2_sync_fs(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "99-111",
    "snippet": "tatic int jffs2_sync_fs(struct super_block *sb, int wait)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tcancel_delayed_work_sync(&c->wbuf_dwork);\n#endif\n\n\tmutex_lock(&c->alloc_sem);\n\tjffs2_flush_wbuf_pad(c);\n\tmutex_unlock(&c->alloc_sem);\n\treturn 0;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "utex_unlock(",
          "args": [
            "c->alloc_sem)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_flush_wbuf_pad(",
          "args": [
            ")"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utex_lock(",
          "args": [
            "c->alloc_sem)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ancel_delayed_work_sync(",
          "args": [
            "c->wbuf_dwork)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FFS2_SB_INFO(",
          "args": [
            "b)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\n\ntatic int jffs2_sync_fs(struct super_block *sb, int wait)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(sb);\n\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tcancel_delayed_work_sync(&c->wbuf_dwork);\n#endif\n\n\tmutex_lock(&c->alloc_sem);\n\tjffs2_flush_wbuf_pad(c);\n\tmutex_unlock(&c->alloc_sem);\n\treturn 0;\n}"
  },
  {
    "function_name": "ffs2_show_options(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "86-97",
    "snippet": "tatic int jffs2_show_options(struct seq_file *s, struct dentry *root)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(root->d_sb);\n\tstruct jffs2_mount_opts *opts = &c->mount_opts;\n\n\tif (opts->override_compr)\n\t\tseq_printf(s, \",compr=%s\", jffs2_compr_name(opts->compr));\n\tif (opts->rp_size)\n\t\tseq_printf(s, \",rp_size=%u\", opts->rp_size / 1024);\n\n\treturn 0;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eq_printf(",
          "args": [
            ",",
            ",rp_size=%u\",",
            "pts->rp_size / 1024)"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eq_printf(",
          "args": [
            ",",
            ",compr=%s\",",
            "ffs2_compr_name(opts->compr))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_compr_name(",
          "args": [
            "pts->compr)"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "ffs2_compr_name(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
          "lines": "66-84",
          "snippet": "tatic const char *jffs2_compr_name(unsigned int compr)\n{\n\tswitch (compr) {\n\tcase JFFS2_COMPR_MODE_NONE:\n\t\treturn \"none\";\n#ifdef CONFIG_JFFS2_LZO\n\tcase JFFS2_COMPR_MODE_FORCELZO:\n\t\treturn \"lzo\";\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\tcase JFFS2_COMPR_MODE_FORCEZLIB:\n\t\treturn \"zlib\";\n#endif\n\tdefault:\n\t\t/* should never happen; programmer error */\n\t\tWARN_ON(1);\n\t\treturn \"\";\n\t}\n}",
          "includes": [
            "include \"nodelist.h\"",
            "include \"compr.h\"\n#",
            "include <linux/exportfs.h>\n#",
            "include <linux/seq_file.h>\n#",
            "include <linux/namei.h>\n#",
            "include <linux/ctype.h>\n#",
            "include <linux/mtd/super.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/jffs2.h>\n#",
            "include <linux/parser.h>\n#",
            "include <linux/mount.h>\n#",
            "include <linux/err.h>\n#",
            "include <linux/fs.h>\n#",
            "include <linux/list.h>\n#",
            "include <linux/init.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/module.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic const char *jffs2_compr_name(unsigned int compr)\n{\n\tswitch (compr) {\n\tcase JFFS2_COMPR_MODE_NONE:\n\t\treturn \"none\";\n#ifdef CONFIG_JFFS2_LZO\n\tcase JFFS2_COMPR_MODE_FORCELZO:\n\t\treturn \"lzo\";\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\tcase JFFS2_COMPR_MODE_FORCEZLIB:\n\t\treturn \"zlib\";\n#endif\n\tdefault:\n\t\t/* should never happen; programmer error */\n\t\tWARN_ON(1);\n\t\treturn \"\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "FFS2_SB_INFO(",
          "args": [
            "oot->d_sb)"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic int jffs2_show_options(struct seq_file *s, struct dentry *root)\n{\n\tstruct jffs2_sb_info *c = JFFS2_SB_INFO(root->d_sb);\n\tstruct jffs2_mount_opts *opts = &c->mount_opts;\n\n\tif (opts->override_compr)\n\t\tseq_printf(s, \",compr=%s\", jffs2_compr_name(opts->compr));\n\tif (opts->rp_size)\n\t\tseq_printf(s, \",rp_size=%u\", opts->rp_size / 1024);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ffs2_compr_name(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "66-84",
    "snippet": "tatic const char *jffs2_compr_name(unsigned int compr)\n{\n\tswitch (compr) {\n\tcase JFFS2_COMPR_MODE_NONE:\n\t\treturn \"none\";\n#ifdef CONFIG_JFFS2_LZO\n\tcase JFFS2_COMPR_MODE_FORCELZO:\n\t\treturn \"lzo\";\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\tcase JFFS2_COMPR_MODE_FORCEZLIB:\n\t\treturn \"zlib\";\n#endif\n\tdefault:\n\t\t/* should never happen; programmer error */\n\t\tWARN_ON(1);\n\t\treturn \"\";\n\t}\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ARN_ON(",
          "args": [
            ")"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic const char *jffs2_compr_name(unsigned int compr)\n{\n\tswitch (compr) {\n\tcase JFFS2_COMPR_MODE_NONE:\n\t\treturn \"none\";\n#ifdef CONFIG_JFFS2_LZO\n\tcase JFFS2_COMPR_MODE_FORCELZO:\n\t\treturn \"lzo\";\n#endif\n#ifdef CONFIG_JFFS2_ZLIB\n\tcase JFFS2_COMPR_MODE_FORCEZLIB:\n\t\treturn \"zlib\";\n#endif\n\tdefault:\n\t\t/* should never happen; programmer error */\n\t\tWARN_ON(1);\n\t\treturn \"\";\n\t}\n}"
  },
  {
    "function_name": "ffs2_i_init_once(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "58-64",
    "snippet": "tatic void jffs2_i_init_once(void *foo)\n{\n\tstruct jffs2_inode_info *f = foo;\n\n\tmutex_init(&f->sem);\n\tinode_init_once(&f->vfs_inode);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "node_init_once(",
          "args": [
            "f->vfs_inode)"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utex_init(",
          "args": [
            "f->sem)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_i_init_once(void *foo)\n{\n\tstruct jffs2_inode_info *f = foo;\n\n\tmutex_init(&f->sem);\n\tinode_init_once(&f->vfs_inode);\n}"
  },
  {
    "function_name": "ffs2_destroy_inode(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "53-56",
    "snippet": "tatic void jffs2_destroy_inode(struct inode *inode)\n{\n\tcall_rcu(&inode->i_rcu, jffs2_i_callback);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "all_rcu(",
          "args": [
            "inode->i_rcu,",
            "ffs2_i_callback)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_destroy_inode(struct inode *inode)\n{\n\tcall_rcu(&inode->i_rcu, jffs2_i_callback);\n}"
  },
  {
    "function_name": "ffs2_i_callback(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "47-51",
    "snippet": "tatic void jffs2_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tkmem_cache_free(jffs2_inode_cachep, JFFS2_INODE_INFO(inode));\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *jffs2_inode_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "ffs2_inode_cachep,",
            "FFS2_INODE_INFO(inode))"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FFS2_INODE_INFO(",
          "args": [
            "node)"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ontainer_of(",
          "args": [
            "ead,",
            "truct node,",
            "_rcu)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *jffs2_inode_cachep;\n\ntatic void jffs2_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tkmem_cache_free(jffs2_inode_cachep, JFFS2_INODE_INFO(inode));\n}"
  },
  {
    "function_name": "ffs2_alloc_inode(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/super.c",
    "lines": "37-45",
    "snippet": "tatic struct inode *jffs2_alloc_inode(struct super_block *sb)\n{\n\tstruct jffs2_inode_info *f;\n\n\tf = kmem_cache_alloc(jffs2_inode_cachep, GFP_KERNEL);\n\tif (!f)\n\t\treturn NULL;\n\treturn &f->vfs_inode;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include \"compr.h\"\n#",
      "include <linux/exportfs.h>\n#",
      "include <linux/seq_file.h>\n#",
      "include <linux/namei.h>\n#",
      "include <linux/ctype.h>\n#",
      "include <linux/mtd/super.h>\n#",
      "include <linux/pagemap.h>\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/parser.h>\n#",
      "include <linux/mount.h>\n#",
      "include <linux/err.h>\n#",
      "include <linux/fs.h>\n#",
      "include <linux/list.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/module.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic void jffs2_put_super(struct super_block *);",
      "tatic struct kmem_cache *jffs2_inode_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "ffs2_inode_cachep,",
            "FP_KERNEL)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude \"compr.h\"\n#\ninclude <linux/exportfs.h>\n#\ninclude <linux/seq_file.h>\n#\ninclude <linux/namei.h>\n#\ninclude <linux/ctype.h>\n#\ninclude <linux/mtd/super.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/parser.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/err.h>\n#\ninclude <linux/fs.h>\n#\ninclude <linux/list.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/module.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic void jffs2_put_super(struct super_block *);\ntatic struct kmem_cache *jffs2_inode_cachep;\n\ntatic struct inode *jffs2_alloc_inode(struct super_block *sb)\n{\n\tstruct jffs2_inode_info *f;\n\n\tf = kmem_cache_alloc(jffs2_inode_cachep, GFP_KERNEL);\n\tif (!f)\n\t\treturn NULL;\n\treturn &f->vfs_inode;\n}"
  }
]