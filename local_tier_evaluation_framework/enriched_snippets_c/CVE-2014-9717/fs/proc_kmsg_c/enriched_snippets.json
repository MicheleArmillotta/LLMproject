[
  {
    "function_name": "proc_kmsg_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/kmsg.c",
    "lines": "59-63",
    "snippet": "static int __init proc_kmsg_init(void)\n{\n\tproc_create(\"kmsg\", S_IRUSR, NULL, &proc_kmsg_operations);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/io.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/syslog.h>",
      "#include <linux/fs.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/poll.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations proc_kmsg_operations = {\n\t.read\t\t= kmsg_read,\n\t.poll\t\t= kmsg_poll,\n\t.open\t\t= kmsg_open,\n\t.release\t= kmsg_release,\n\t.llseek\t\t= generic_file_llseek,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"kmsg\"",
            "S_IRUSR",
            "NULL",
            "&proc_kmsg_operations"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "__proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "355-391",
          "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/syslog.h>\n#include <linux/fs.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic const struct file_operations proc_kmsg_operations = {\n\t.read\t\t= kmsg_read,\n\t.poll\t\t= kmsg_poll,\n\t.open\t\t= kmsg_open,\n\t.release\t= kmsg_release,\n\t.llseek\t\t= generic_file_llseek,\n};\n\nstatic int __init proc_kmsg_init(void)\n{\n\tproc_create(\"kmsg\", S_IRUSR, NULL, &proc_kmsg_operations);\n\treturn 0;\n}"
  },
  {
    "function_name": "kmsg_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/kmsg.c",
    "lines": "42-48",
    "snippet": "static unsigned int kmsg_poll(struct file *file, poll_table *wait)\n{\n\tpoll_wait(file, &log_wait, wait);\n\tif (do_syslog(SYSLOG_ACTION_SIZE_UNREAD, NULL, 0, SYSLOG_FROM_PROC))\n\t\treturn POLLIN | POLLRDNORM;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/io.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/syslog.h>",
      "#include <linux/fs.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/poll.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern wait_queue_head_t log_wait;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_syslog",
          "args": [
            "SYSLOG_ACTION_SIZE_UNREAD",
            "NULL",
            "0",
            "SYSLOG_FROM_PROC"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "poll_wait",
          "args": [
            "file",
            "&log_wait",
            "wait"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/syslog.h>\n#include <linux/fs.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nextern wait_queue_head_t log_wait;\n\nstatic unsigned int kmsg_poll(struct file *file, poll_table *wait)\n{\n\tpoll_wait(file, &log_wait, wait);\n\tif (do_syslog(SYSLOG_ACTION_SIZE_UNREAD, NULL, 0, SYSLOG_FROM_PROC))\n\t\treturn POLLIN | POLLRDNORM;\n\treturn 0;\n}"
  },
  {
    "function_name": "kmsg_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/kmsg.c",
    "lines": "33-40",
    "snippet": "static ssize_t kmsg_read(struct file *file, char __user *buf,\n\t\t\t size_t count, loff_t *ppos)\n{\n\tif ((file->f_flags & O_NONBLOCK) &&\n\t    !do_syslog(SYSLOG_ACTION_SIZE_UNREAD, NULL, 0, SYSLOG_FROM_PROC))\n\t\treturn -EAGAIN;\n\treturn do_syslog(SYSLOG_ACTION_READ, buf, count, SYSLOG_FROM_PROC);\n}",
    "includes": [
      "#include <asm/io.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/syslog.h>",
      "#include <linux/fs.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/poll.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_syslog",
          "args": [
            "SYSLOG_ACTION_READ",
            "buf",
            "count",
            "SYSLOG_FROM_PROC"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_syslog",
          "args": [
            "SYSLOG_ACTION_SIZE_UNREAD",
            "NULL",
            "0",
            "SYSLOG_FROM_PROC"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/syslog.h>\n#include <linux/fs.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic ssize_t kmsg_read(struct file *file, char __user *buf,\n\t\t\t size_t count, loff_t *ppos)\n{\n\tif ((file->f_flags & O_NONBLOCK) &&\n\t    !do_syslog(SYSLOG_ACTION_SIZE_UNREAD, NULL, 0, SYSLOG_FROM_PROC))\n\t\treturn -EAGAIN;\n\treturn do_syslog(SYSLOG_ACTION_READ, buf, count, SYSLOG_FROM_PROC);\n}"
  },
  {
    "function_name": "kmsg_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/kmsg.c",
    "lines": "27-31",
    "snippet": "static int kmsg_release(struct inode * inode, struct file * file)\n{\n\t(void) do_syslog(SYSLOG_ACTION_CLOSE, NULL, 0, SYSLOG_FROM_PROC);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/io.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/syslog.h>",
      "#include <linux/fs.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/poll.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_syslog",
          "args": [
            "SYSLOG_ACTION_CLOSE",
            "NULL",
            "0",
            "SYSLOG_FROM_PROC"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/syslog.h>\n#include <linux/fs.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic int kmsg_release(struct inode * inode, struct file * file)\n{\n\t(void) do_syslog(SYSLOG_ACTION_CLOSE, NULL, 0, SYSLOG_FROM_PROC);\n\treturn 0;\n}"
  },
  {
    "function_name": "kmsg_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/kmsg.c",
    "lines": "22-25",
    "snippet": "static int kmsg_open(struct inode * inode, struct file * file)\n{\n\treturn do_syslog(SYSLOG_ACTION_OPEN, NULL, 0, SYSLOG_FROM_PROC);\n}",
    "includes": [
      "#include <asm/io.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/syslog.h>",
      "#include <linux/fs.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/poll.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_syslog",
          "args": [
            "SYSLOG_ACTION_OPEN",
            "NULL",
            "0",
            "SYSLOG_FROM_PROC"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/syslog.h>\n#include <linux/fs.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic int kmsg_open(struct inode * inode, struct file * file)\n{\n\treturn do_syslog(SYSLOG_ACTION_OPEN, NULL, 0, SYSLOG_FROM_PROC);\n}"
  }
]