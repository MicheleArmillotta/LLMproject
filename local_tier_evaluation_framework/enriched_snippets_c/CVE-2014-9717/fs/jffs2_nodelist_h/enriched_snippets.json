[
  {
    "function_name": "rag_last(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.h",
    "lines": "333-341",
    "snippet": "tatic inline struct jffs2_node_frag *frag_last(struct rb_root *root)\n{\n\tstruct rb_node *node = rb_last(root);\n\n\tif (!node)\n\t\treturn NULL;\n\n\treturn rb_entry(node, struct jffs2_node_frag, rb);\n}",
    "includes": [
      "include \"debug.h\"",
      "include \"os-linux.h\"\n#",
      "include \"os-ecos.h\"\n#",
      "include \"summary.h\"",
      "include \"acl.h\"\n#",
      "include \"xattr.h\"\n#",
      "include \"jffs2_fs_i.h\"\n#",
      "include \"jffs2_fs_sb.h\"\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/types.h>\n#",
      "include <linux/fs.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b_entry(",
          "args": [
            "ode,",
            "truct ffs2_node_frag,",
            "b)"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b_last(",
          "args": [
            "oot)"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"debug.h\"\ninclude \"os-linux.h\"\n#\ninclude \"os-ecos.h\"\n#\ninclude \"summary.h\"\ninclude \"acl.h\"\n#\ninclude \"xattr.h\"\n#\ninclude \"jffs2_fs_i.h\"\n#\ninclude \"jffs2_fs_sb.h\"\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/types.h>\n#\ninclude <linux/fs.h>\n#\n\ntatic inline struct jffs2_node_frag *frag_last(struct rb_root *root)\n{\n\tstruct rb_node *node = rb_last(root);\n\n\tif (!node)\n\t\treturn NULL;\n\n\treturn rb_entry(node, struct jffs2_node_frag, rb);\n}"
  },
  {
    "function_name": "rag_first(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.h",
    "lines": "323-331",
    "snippet": "tatic inline struct jffs2_node_frag *frag_first(struct rb_root *root)\n{\n\tstruct rb_node *node = rb_first(root);\n\n\tif (!node)\n\t\treturn NULL;\n\n\treturn rb_entry(node, struct jffs2_node_frag, rb);\n}",
    "includes": [
      "include \"debug.h\"",
      "include \"os-linux.h\"\n#",
      "include \"os-ecos.h\"\n#",
      "include \"summary.h\"",
      "include \"acl.h\"\n#",
      "include \"xattr.h\"\n#",
      "include \"jffs2_fs_i.h\"\n#",
      "include \"jffs2_fs_sb.h\"\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/types.h>\n#",
      "include <linux/fs.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b_entry(",
          "args": [
            "ode,",
            "truct ffs2_node_frag,",
            "b)"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b_first(",
          "args": [
            "oot)"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"debug.h\"\ninclude \"os-linux.h\"\n#\ninclude \"os-ecos.h\"\n#\ninclude \"summary.h\"\ninclude \"acl.h\"\n#\ninclude \"xattr.h\"\n#\ninclude \"jffs2_fs_i.h\"\n#\ninclude \"jffs2_fs_sb.h\"\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/types.h>\n#\ninclude <linux/fs.h>\n#\n\ntatic inline struct jffs2_node_frag *frag_first(struct rb_root *root)\n{\n\tstruct rb_node *node = rb_first(root);\n\n\tif (!node)\n\t\treturn NULL;\n\n\treturn rb_entry(node, struct jffs2_node_frag, rb);\n}"
  },
  {
    "function_name": "ffs2_encode_dev(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.h",
    "lines": "312-321",
    "snippet": "tatic inline int jffs2_encode_dev(union jffs2_device_node *jdev, dev_t rdev)\n{\n\tif (old_valid_dev(rdev)) {\n\t\tjdev->old_id = cpu_to_je16(old_encode_dev(rdev));\n\t\treturn sizeof(jdev->old_id);\n\t} else {\n\t\tjdev->new_id = cpu_to_je32(new_encode_dev(rdev));\n\t\treturn sizeof(jdev->new_id);\n\t}\n}",
    "includes": [
      "include \"debug.h\"",
      "include \"os-linux.h\"\n#",
      "include \"os-ecos.h\"\n#",
      "include \"summary.h\"",
      "include \"acl.h\"\n#",
      "include \"xattr.h\"\n#",
      "include \"jffs2_fs_i.h\"\n#",
      "include \"jffs2_fs_sb.h\"\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/types.h>\n#",
      "include <linux/fs.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pu_to_je32(",
          "args": [
            "ew_encode_dev(rdev))"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ew_encode_dev(",
          "args": [
            "dev)"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pu_to_je16(",
          "args": [
            "ld_encode_dev(rdev))"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ld_encode_dev(",
          "args": [
            "dev)"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ld_valid_dev(",
          "args": [
            "dev)"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"debug.h\"\ninclude \"os-linux.h\"\n#\ninclude \"os-ecos.h\"\n#\ninclude \"summary.h\"\ninclude \"acl.h\"\n#\ninclude \"xattr.h\"\n#\ninclude \"jffs2_fs_i.h\"\n#\ninclude \"jffs2_fs_sb.h\"\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/types.h>\n#\ninclude <linux/fs.h>\n#\n\ntatic inline int jffs2_encode_dev(union jffs2_device_node *jdev, dev_t rdev)\n{\n\tif (old_valid_dev(rdev)) {\n\t\tjdev->old_id = cpu_to_je16(old_encode_dev(rdev));\n\t\treturn sizeof(jdev->old_id);\n\t} else {\n\t\tjdev->new_id = cpu_to_je32(new_encode_dev(rdev));\n\t\treturn sizeof(jdev->new_id);\n\t}\n}"
  },
  {
    "function_name": "ffs2_blocks_use_vmalloc(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.h",
    "lines": "292-295",
    "snippet": "tatic inline int jffs2_blocks_use_vmalloc(struct jffs2_sb_info *c)\n{\n\treturn ((c->flash_size / c->sector_size) * sizeof (struct jffs2_eraseblock)) > (128 * 1024);\n}",
    "includes": [
      "include \"debug.h\"",
      "include \"os-linux.h\"\n#",
      "include \"os-ecos.h\"\n#",
      "include \"summary.h\"",
      "include \"acl.h\"\n#",
      "include \"xattr.h\"\n#",
      "include \"jffs2_fs_i.h\"\n#",
      "include \"jffs2_fs_sb.h\"\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/types.h>\n#",
      "include <linux/fs.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"debug.h\"\ninclude \"os-linux.h\"\n#\ninclude \"os-ecos.h\"\n#\ninclude \"summary.h\"\ninclude \"acl.h\"\n#\ninclude \"xattr.h\"\n#\ninclude \"jffs2_fs_i.h\"\n#\ninclude \"jffs2_fs_sb.h\"\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/types.h>\n#\ninclude <linux/fs.h>\n#\n\ntatic inline int jffs2_blocks_use_vmalloc(struct jffs2_sb_info *c)\n{\n\treturn ((c->flash_size / c->sector_size) * sizeof (struct jffs2_eraseblock)) > (128 * 1024);\n}"
  },
  {
    "function_name": "ffs2_raw_ref_to_ic(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.h",
    "lines": "119-127",
    "snippet": "tatic inline struct jffs2_inode_cache *jffs2_raw_ref_to_ic(struct jffs2_raw_node_ref *raw)\n{\n\twhile(raw->next_in_ino)\n\t\traw = raw->next_in_ino;\n\n\t/* NB. This can be a jffs2_xattr_datum or jffs2_xattr_ref and\n\t   not actually a jffs2_inode_cache. Check ->class */\n\treturn ((struct jffs2_inode_cache *)raw);\n}",
    "includes": [
      "include \"debug.h\"",
      "include \"os-linux.h\"\n#",
      "include \"os-ecos.h\"\n#",
      "include \"summary.h\"",
      "include \"acl.h\"\n#",
      "include \"xattr.h\"\n#",
      "include \"jffs2_fs_i.h\"\n#",
      "include \"jffs2_fs_sb.h\"\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/types.h>\n#",
      "include <linux/fs.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"debug.h\"\ninclude \"os-linux.h\"\n#\ninclude \"os-ecos.h\"\n#\ninclude \"summary.h\"\ninclude \"acl.h\"\n#\ninclude \"xattr.h\"\n#\ninclude \"jffs2_fs_i.h\"\n#\ninclude \"jffs2_fs_sb.h\"\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/types.h>\n#\ninclude <linux/fs.h>\n#\n\ntatic inline struct jffs2_inode_cache *jffs2_raw_ref_to_ic(struct jffs2_raw_node_ref *raw)\n{\n\twhile(raw->next_in_ino)\n\t\traw = raw->next_in_ino;\n\n\t/* NB. This can be a jffs2_xattr_datum or jffs2_xattr_ref and\n\t   not actually a jffs2_inode_cache. Check ->class */\n\treturn ((struct jffs2_inode_cache *)raw);\n}"
  },
  {
    "function_name": "ef_next(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/nodelist.h",
    "lines": "101-117",
    "snippet": "tatic inline struct jffs2_raw_node_ref *ref_next(struct jffs2_raw_node_ref *ref)\n{\n\tref++;\n\n\t/* Link to another block of refs */\n\tif (ref->flash_offset == REF_LINK_NODE) {\n\t\tref = ref->next_in_ino;\n\t\tif (!ref)\n\t\t\treturn ref;\n\t}\n\n\t/* End of chain */\n\tif (ref->flash_offset == REF_EMPTY_NODE)\n\t\treturn NULL;\n\n\treturn ref;\n}",
    "includes": [
      "include \"debug.h\"",
      "include \"os-linux.h\"\n#",
      "include \"os-ecos.h\"\n#",
      "include \"summary.h\"",
      "include \"acl.h\"\n#",
      "include \"xattr.h\"\n#",
      "include \"jffs2_fs_i.h\"\n#",
      "include \"jffs2_fs_sb.h\"\n#",
      "include <linux/jffs2.h>\n#",
      "include <linux/types.h>\n#",
      "include <linux/fs.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"debug.h\"\ninclude \"os-linux.h\"\n#\ninclude \"os-ecos.h\"\n#\ninclude \"summary.h\"\ninclude \"acl.h\"\n#\ninclude \"xattr.h\"\n#\ninclude \"jffs2_fs_i.h\"\n#\ninclude \"jffs2_fs_sb.h\"\n#\ninclude <linux/jffs2.h>\n#\ninclude <linux/types.h>\n#\ninclude <linux/fs.h>\n#\n\ntatic inline struct jffs2_raw_node_ref *ref_next(struct jffs2_raw_node_ref *ref)\n{\n\tref++;\n\n\t/* Link to another block of refs */\n\tif (ref->flash_offset == REF_LINK_NODE) {\n\t\tref = ref->next_in_ino;\n\t\tif (!ref)\n\t\t\treturn ref;\n\t}\n\n\t/* End of chain */\n\tif (ref->flash_offset == REF_EMPTY_NODE)\n\t\treturn NULL;\n\n\treturn ref;\n}"
  }
]