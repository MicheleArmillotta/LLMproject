[
  {
    "function_name": "ncp_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
    "lines": "75-77",
    "snippet": "static inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}",
    "includes": [
      "#include \"ncplib_kernel.h\"",
      "#include \"ncp_fs_sb.h\"",
      "#include \"ncp_fs_i.h\"",
      "#include <linux/ncp_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int ncp_connect(struct ncp_server *server);",
      "int ncp_disconnect(struct ncp_server *server);",
      "void ncp_lock_server(struct ncp_server *server);",
      "void ncp_unlock_server(struct ncp_server *server);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ncp_request2",
          "args": [
            "server",
            "function",
            "server->packet",
            "server->packet_size"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "ncp_request2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/sock.c",
          "lines": "794-829",
          "snippet": "int ncp_request2(struct ncp_server *server, int function, \n\t\tvoid* rpl, int size)\n{\n\tstruct ncp_request_header *h;\n\tstruct ncp_reply_header* reply = rpl;\n\tint result;\n\n\th = (struct ncp_request_header *) (server->packet);\n\tif (server->has_subfunction != 0) {\n\t\t*(__u16 *) & (h->data[0]) = htons(server->current_size - sizeof(*h) - 2);\n\t}\n\th->type = NCP_REQUEST;\n\t/*\n\t * The server shouldn't know or care what task is making a\n\t * request, so we always use the same task number.\n\t */\n\th->task = 2; /* (current->pid) & 0xff; */\n\th->function = function;\n\n\tresult = ncp_do_request(server, server->current_size, reply, size);\n\tif (result < 0) {\n\t\tncp_dbg(1, \"ncp_request_error: %d\\n\", result);\n\t\tgoto out;\n\t}\n\tserver->completion = reply->completion_code;\n\tserver->conn_status = reply->connection_state;\n\tserver->reply_size = result;\n\tserver->ncp_reply_size = result - sizeof(struct ncp_reply_header);\n\n\tresult = reply->completion_code;\n\n\tif (result != 0)\n\t\tncp_vdbg(\"completion code=%x\\n\", result);\nout:\n\treturn result;\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/file.h>",
            "#include <linux/poll.h>",
            "#include <linux/ipx.h>",
            "#include <net/sock.h>",
            "#include <net/scm.h>",
            "#include <linux/slab.h>",
            "#include <linux/signal.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/mm.h>",
            "#include <linux/net.h>",
            "#include <linux/in.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/socket.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/file.h>\n#include <linux/poll.h>\n#include <linux/ipx.h>\n#include <net/sock.h>\n#include <net/scm.h>\n#include <linux/slab.h>\n#include <linux/signal.h>\n#include <linux/netdevice.h>\n#include <linux/mm.h>\n#include <linux/net.h>\n#include <linux/in.h>\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/socket.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n\nint ncp_request2(struct ncp_server *server, int function, \n\t\tvoid* rpl, int size)\n{\n\tstruct ncp_request_header *h;\n\tstruct ncp_reply_header* reply = rpl;\n\tint result;\n\n\th = (struct ncp_request_header *) (server->packet);\n\tif (server->has_subfunction != 0) {\n\t\t*(__u16 *) & (h->data[0]) = htons(server->current_size - sizeof(*h) - 2);\n\t}\n\th->type = NCP_REQUEST;\n\t/*\n\t * The server shouldn't know or care what task is making a\n\t * request, so we always use the same task number.\n\t */\n\th->task = 2; /* (current->pid) & 0xff; */\n\th->function = function;\n\n\tresult = ncp_do_request(server, server->current_size, reply, size);\n\tif (result < 0) {\n\t\tncp_dbg(1, \"ncp_request_error: %d\\n\", result);\n\t\tgoto out;\n\t}\n\tserver->completion = reply->completion_code;\n\tserver->conn_status = reply->connection_state;\n\tserver->reply_size = result;\n\tserver->ncp_reply_size = result - sizeof(struct ncp_reply_header);\n\n\tresult = reply->completion_code;\n\n\tif (result != 0)\n\t\tncp_vdbg(\"completion code=%x\\n\", result);\nout:\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_connect(struct ncp_server *server);\nint ncp_disconnect(struct ncp_server *server);\nvoid ncp_lock_server(struct ncp_server *server);\nvoid ncp_unlock_server(struct ncp_server *server);\n\nstatic inline int ncp_request(struct ncp_server *server, int function) {\n\treturn ncp_request2(server, function, server->packet, server->packet_size);\n}"
  },
  {
    "function_name": "NCP_FINFO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
    "lines": "49-52",
    "snippet": "static inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}",
    "includes": [
      "#include \"ncplib_kernel.h\"",
      "#include \"ncp_fs_sb.h\"",
      "#include \"ncp_fs_i.h\"",
      "#include <linux/ncp_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int ncp_make_open(struct inode *, int);",
      "int ncp_make_closed(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "inode",
            "structncp_inode_info",
            "vfs_inode"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_make_open(struct inode *, int);\nint ncp_make_closed(struct inode *);\n\nstatic inline struct ncp_inode_info *NCP_FINFO(const struct inode *inode)\n{\n\treturn container_of(inode, struct ncp_inode_info, vfs_inode);\n}"
  },
  {
    "function_name": "NCP_SBP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncp_fs.h",
    "lines": "43-46",
    "snippet": "static inline struct ncp_server *NCP_SBP(const struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
    "includes": [
      "#include \"ncplib_kernel.h\"",
      "#include \"ncp_fs_sb.h\"",
      "#include \"ncp_fs_i.h\"",
      "#include <linux/ncp_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int ncp_conn_logged_in(struct super_block *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"ncplib_kernel.h\"\n#include \"ncp_fs_sb.h\"\n#include \"ncp_fs_i.h\"\n#include <linux/ncp_fs.h>\n\nint ncp_conn_logged_in(struct super_block *);\n\nstatic inline struct ncp_server *NCP_SBP(const struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
  }
]