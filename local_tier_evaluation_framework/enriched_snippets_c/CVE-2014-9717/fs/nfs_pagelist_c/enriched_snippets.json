[
  {
    "function_name": "nfs_destroy_nfspagecache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1295-1298",
    "snippet": "void nfs_destroy_nfspagecache(void)\n{\n\tkmem_cache_destroy(nfs_page_cachep);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_page_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "nfs_page_cachep"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nvoid nfs_destroy_nfspagecache(void)\n{\n\tkmem_cache_destroy(nfs_page_cachep);\n}"
  },
  {
    "function_name": "nfs_init_nfspagecache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1283-1293",
    "snippet": "int __init nfs_init_nfspagecache(void)\n{\n\tnfs_page_cachep = kmem_cache_create(\"nfs_page\",\n\t\t\t\t\t    sizeof(struct nfs_page),\n\t\t\t\t\t    0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t    NULL);\n\tif (nfs_page_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_page_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"nfs_page\"",
            "sizeof(struct nfs_page)",
            "0",
            "SLAB_HWCACHE_ALIGN",
            "NULL"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nint __init nfs_init_nfspagecache(void)\n{\n\tnfs_page_cachep = kmem_cache_create(\"nfs_page\",\n\t\t\t\t\t    sizeof(struct nfs_page),\n\t\t\t\t\t    0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t    NULL);\n\tif (nfs_page_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_pageio_cond_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1267-1281",
    "snippet": "void nfs_pageio_cond_complete(struct nfs_pageio_descriptor *desc, pgoff_t index)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tstruct nfs_page *prev;\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tmirror = &desc->pg_mirrors[midx];\n\t\tif (!list_empty(&mirror->pg_list)) {\n\t\t\tprev = nfs_list_entry(mirror->pg_list.prev);\n\t\t\tif (index != prev->wb_index + 1)\n\t\t\t\tnfs_pageio_complete_mirror(desc, midx);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_pageio_complete_mirror",
          "args": [
            "desc",
            "midx"
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_complete_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1190-1206",
          "snippet": "static void nfs_pageio_complete_mirror(struct nfs_pageio_descriptor *desc,\n\t\t\t\t       u32 mirror_idx)\n{\n\tstruct nfs_pgio_mirror *mirror = &desc->pg_mirrors[mirror_idx];\n\tu32 restore_idx = desc->pg_mirror_idx;\n\n\tif (nfs_pgio_has_mirroring(desc))\n\t\tdesc->pg_mirror_idx = mirror_idx;\n\tfor (;;) {\n\t\tnfs_pageio_doio(desc);\n\t\tif (!mirror->pg_recoalesce)\n\t\t\tbreak;\n\t\tif (!nfs_do_recoalesce(desc))\n\t\t\tbreak;\n\t}\n\tdesc->pg_mirror_idx = restore_idx;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_complete_mirror(struct nfs_pageio_descriptor *desc,\n\t\t\t\t       u32 mirror_idx)\n{\n\tstruct nfs_pgio_mirror *mirror = &desc->pg_mirrors[mirror_idx];\n\tu32 restore_idx = desc->pg_mirror_idx;\n\n\tif (nfs_pgio_has_mirroring(desc))\n\t\tdesc->pg_mirror_idx = mirror_idx;\n\tfor (;;) {\n\t\tnfs_pageio_doio(desc);\n\t\tif (!mirror->pg_recoalesce)\n\t\t\tbreak;\n\t\tif (!nfs_do_recoalesce(desc))\n\t\t\tbreak;\n\t}\n\tdesc->pg_mirror_idx = restore_idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "mirror->pg_list.prev"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&mirror->pg_list"
          ],
          "line": 1275
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_cond_complete(struct nfs_pageio_descriptor *desc, pgoff_t index)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tstruct nfs_page *prev;\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tmirror = &desc->pg_mirrors[midx];\n\t\tif (!list_empty(&mirror->pg_list)) {\n\t\t\tprev = nfs_list_entry(mirror->pg_list.prev);\n\t\t\tif (index != prev->wb_index + 1)\n\t\t\t\tnfs_pageio_complete_mirror(desc, midx);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "nfs_pageio_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1244-1254",
    "snippet": "void nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_pageio_cleanup_mirroring",
          "args": [
            "desc"
          ],
          "line": 1253
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_cleanup_mirroring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "898-905",
          "snippet": "static void nfs_pageio_cleanup_mirroring(struct nfs_pageio_descriptor *pgio)\n{\n\tpgio->pg_mirror_count = 1;\n\tpgio->pg_mirror_idx = 0;\n\tpgio->pg_mirrors = pgio->pg_mirrors_static;\n\tkfree(pgio->pg_mirrors_dynamic);\n\tpgio->pg_mirrors_dynamic = NULL;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_cleanup_mirroring(struct nfs_pageio_descriptor *pgio)\n{\n\tpgio->pg_mirror_count = 1;\n\tpgio->pg_mirror_idx = 0;\n\tpgio->pg_mirrors = pgio->pg_mirrors_static;\n\tkfree(pgio->pg_mirrors_dynamic);\n\tpgio->pg_mirrors_dynamic = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "desc->pg_ops->pg_cleanup",
          "args": [
            "desc"
          ],
          "line": 1252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pageio_complete_mirror",
          "args": [
            "desc",
            "midx"
          ],
          "line": 1249
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_complete_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1190-1206",
          "snippet": "static void nfs_pageio_complete_mirror(struct nfs_pageio_descriptor *desc,\n\t\t\t\t       u32 mirror_idx)\n{\n\tstruct nfs_pgio_mirror *mirror = &desc->pg_mirrors[mirror_idx];\n\tu32 restore_idx = desc->pg_mirror_idx;\n\n\tif (nfs_pgio_has_mirroring(desc))\n\t\tdesc->pg_mirror_idx = mirror_idx;\n\tfor (;;) {\n\t\tnfs_pageio_doio(desc);\n\t\tif (!mirror->pg_recoalesce)\n\t\t\tbreak;\n\t\tif (!nfs_do_recoalesce(desc))\n\t\t\tbreak;\n\t}\n\tdesc->pg_mirror_idx = restore_idx;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_complete_mirror(struct nfs_pageio_descriptor *desc,\n\t\t\t\t       u32 mirror_idx)\n{\n\tstruct nfs_pgio_mirror *mirror = &desc->pg_mirrors[mirror_idx];\n\tu32 restore_idx = desc->pg_mirror_idx;\n\n\tif (nfs_pgio_has_mirroring(desc))\n\t\tdesc->pg_mirror_idx = mirror_idx;\n\tfor (;;) {\n\t\tnfs_pageio_doio(desc);\n\t\tif (!mirror->pg_recoalesce)\n\t\t\tbreak;\n\t\tif (!nfs_do_recoalesce(desc))\n\t\t\tbreak;\n\t}\n\tdesc->pg_mirror_idx = restore_idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}"
  },
  {
    "function_name": "nfs_pageio_resend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1218-1237",
    "snippet": "int nfs_pageio_resend(struct nfs_pageio_descriptor *desc,\n\t\t      struct nfs_pgio_header *hdr)\n{\n\tLIST_HEAD(failed);\n\n\tdesc->pg_dreq = hdr->dreq;\n\twhile (!list_empty(&hdr->pages)) {\n\t\tstruct nfs_page *req = nfs_list_entry(hdr->pages.next);\n\n\t\tnfs_list_remove_request(req);\n\t\tif (!nfs_pageio_add_request(desc, req))\n\t\t\tnfs_list_add_request(req, &failed);\n\t}\n\tnfs_pageio_complete(desc);\n\tif (!list_empty(&failed)) {\n\t\tlist_move(&failed, &hdr->pages);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_move",
          "args": [
            "&failed",
            "&hdr->pages"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&failed"
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_complete",
          "args": [
            "desc"
          ],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1244-1254",
          "snippet": "void nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_add_request",
          "args": [
            "req",
            "&failed"
          ],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pageio_add_request",
          "args": [
            "desc",
            "req"
          ],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1138-1183",
          "snippet": "int nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "hdr->pages.next"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "failed"
          ],
          "line": 1221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_pageio_resend(struct nfs_pageio_descriptor *desc,\n\t\t      struct nfs_pgio_header *hdr)\n{\n\tLIST_HEAD(failed);\n\n\tdesc->pg_dreq = hdr->dreq;\n\twhile (!list_empty(&hdr->pages)) {\n\t\tstruct nfs_page *req = nfs_list_entry(hdr->pages.next);\n\n\t\tnfs_list_remove_request(req);\n\t\tif (!nfs_pageio_add_request(desc, req))\n\t\t\tnfs_list_add_request(req, &failed);\n\t}\n\tnfs_pageio_complete(desc);\n\tif (!list_empty(&failed)) {\n\t\tlist_move(&failed, &hdr->pages);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_pageio_complete_mirror",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1190-1206",
    "snippet": "static void nfs_pageio_complete_mirror(struct nfs_pageio_descriptor *desc,\n\t\t\t\t       u32 mirror_idx)\n{\n\tstruct nfs_pgio_mirror *mirror = &desc->pg_mirrors[mirror_idx];\n\tu32 restore_idx = desc->pg_mirror_idx;\n\n\tif (nfs_pgio_has_mirroring(desc))\n\t\tdesc->pg_mirror_idx = mirror_idx;\n\tfor (;;) {\n\t\tnfs_pageio_doio(desc);\n\t\tif (!mirror->pg_recoalesce)\n\t\t\tbreak;\n\t\tif (!nfs_do_recoalesce(desc))\n\t\t\tbreak;\n\t}\n\tdesc->pg_mirror_idx = restore_idx;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_do_recoalesce",
          "args": [
            "desc"
          ],
          "line": 1202
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_do_recoalesce",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1092-1119",
          "snippet": "static int nfs_do_recoalesce(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\tLIST_HEAD(head);\n\n\tdo {\n\t\tlist_splice_init(&mirror->pg_list, &head);\n\t\tmirror->pg_bytes_written -= mirror->pg_count;\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t\tmirror->pg_recoalesce = 0;\n\n\t\tdesc->pg_moreio = 0;\n\n\t\twhile (!list_empty(&head)) {\n\t\t\tstruct nfs_page *req;\n\n\t\t\treq = list_first_entry(&head, struct nfs_page, wb_list);\n\t\t\tnfs_list_remove_request(req);\n\t\t\tif (__nfs_pageio_add_request(desc, req))\n\t\t\t\tcontinue;\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\t\t}\n\t} while (mirror->pg_recoalesce);\n\treturn 1;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_do_recoalesce(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\tLIST_HEAD(head);\n\n\tdo {\n\t\tlist_splice_init(&mirror->pg_list, &head);\n\t\tmirror->pg_bytes_written -= mirror->pg_count;\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t\tmirror->pg_recoalesce = 0;\n\n\t\tdesc->pg_moreio = 0;\n\n\t\twhile (!list_empty(&head)) {\n\t\t\tstruct nfs_page *req;\n\n\t\t\treq = list_first_entry(&head, struct nfs_page, wb_list);\n\t\t\tnfs_list_remove_request(req);\n\t\t\tif (__nfs_pageio_add_request(desc, req))\n\t\t\t\tcontinue;\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\t\t}\n\t} while (mirror->pg_recoalesce);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_doio",
          "args": [
            "desc"
          ],
          "line": 1199
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_doio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "999-1015",
          "snippet": "static void nfs_pageio_doio(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (!list_empty(&mirror->pg_list)) {\n\t\tint error = desc->pg_ops->pg_doio(desc);\n\t\tif (error < 0)\n\t\t\tdesc->pg_error = error;\n\t\telse\n\t\t\tmirror->pg_bytes_written += mirror->pg_count;\n\t}\n\tif (list_empty(&mirror->pg_list)) {\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_doio(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (!list_empty(&mirror->pg_list)) {\n\t\tint error = desc->pg_ops->pg_doio(desc);\n\t\tif (error < 0)\n\t\t\tdesc->pg_error = error;\n\t\telse\n\t\t\tmirror->pg_bytes_written += mirror->pg_count;\n\t}\n\tif (list_empty(&mirror->pg_list)) {\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgio_has_mirroring",
          "args": [
            "desc"
          ],
          "line": 1196
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_has_mirroring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "265-269",
          "snippet": "static inline bool nfs_pgio_has_mirroring(struct nfs_pageio_descriptor *desc)\n{\n\tWARN_ON_ONCE(desc->pg_mirror_count < 1);\n\treturn desc->pg_mirror_count > 1;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc);\n\nstatic inline bool nfs_pgio_has_mirroring(struct nfs_pageio_descriptor *desc)\n{\n\tWARN_ON_ONCE(desc->pg_mirror_count < 1);\n\treturn desc->pg_mirror_count > 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_complete_mirror(struct nfs_pageio_descriptor *desc,\n\t\t\t\t       u32 mirror_idx)\n{\n\tstruct nfs_pgio_mirror *mirror = &desc->pg_mirrors[mirror_idx];\n\tu32 restore_idx = desc->pg_mirror_idx;\n\n\tif (nfs_pgio_has_mirroring(desc))\n\t\tdesc->pg_mirror_idx = mirror_idx;\n\tfor (;;) {\n\t\tnfs_pageio_doio(desc);\n\t\tif (!mirror->pg_recoalesce)\n\t\t\tbreak;\n\t\tif (!nfs_do_recoalesce(desc))\n\t\t\tbreak;\n\t}\n\tdesc->pg_mirror_idx = restore_idx;\n}"
  },
  {
    "function_name": "nfs_pageio_add_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1138-1183",
    "snippet": "int nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_pageio_add_request_mirror",
          "args": [
            "desc",
            "dupreq"
          ],
          "line": 1178
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_add_request_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1121-1136",
          "snippet": "static int nfs_pageio_add_request_mirror(struct nfs_pageio_descriptor *desc,\n\t\tstruct nfs_page *req)\n{\n\tint ret;\n\n\tdo {\n\t\tret = __nfs_pageio_add_request(desc, req);\n\t\tif (ret)\n\t\t\tbreak;\n\t\tif (desc->pg_error < 0)\n\t\t\tbreak;\n\t\tret = nfs_do_recoalesce(desc);\n\t} while (ret);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pageio_add_request_mirror(struct nfs_pageio_descriptor *desc,\n\t\tstruct nfs_page *req)\n{\n\tint ret;\n\n\tdo {\n\t\tret = __nfs_pageio_add_request(desc, req);\n\t\tif (ret)\n\t\t\tbreak;\n\t\tif (desc->pg_error < 0)\n\t\t\tbreak;\n\t\tret = nfs_do_recoalesce(desc);\n\t} while (ret);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgio_has_mirroring",
          "args": [
            "desc"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_has_mirroring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "265-269",
          "snippet": "static inline bool nfs_pgio_has_mirroring(struct nfs_pageio_descriptor *desc)\n{\n\tWARN_ON_ONCE(desc->pg_mirror_count < 1);\n\treturn desc->pg_mirror_count > 1;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc);\n\nstatic inline bool nfs_pgio_has_mirroring(struct nfs_pageio_descriptor *desc)\n{\n\tWARN_ON_ONCE(desc->pg_mirror_count < 1);\n\treturn desc->pg_mirror_count > 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_page_group_unlock",
          "args": [
            "req"
          ],
          "line": 1170
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "205-216",
          "snippet": "void\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_lock_request",
          "args": [
            "dupreq"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "dupreq"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_create_request",
          "args": [
            "req->wb_context",
            "req->wb_page",
            "lastreq",
            "pgbase",
            "bytes"
          ],
          "line": 1161
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_create_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "351-388",
          "snippet": "struct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_page_group_lock",
          "args": [
            "req",
            "false"
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "167-182",
          "snippet": "int\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_setup_mirroring",
          "args": [
            "desc",
            "req"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_setup_mirroring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "868-887",
          "snippet": "static int nfs_pageio_setup_mirroring(struct nfs_pageio_descriptor *pgio,\n\t\t\t\t       struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (!pgio->pg_ops->pg_get_mirror_count)\n\t\treturn 0;\n\n\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tif (!mirror_count || mirror_count > NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX)\n\t\treturn -EINVAL;\n\n\tif (WARN_ON_ONCE(!pgio->pg_mirrors_dynamic))\n\t\treturn -EINVAL;\n\n\tpgio->pg_mirror_count = mirror_count;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pageio_setup_mirroring(struct nfs_pageio_descriptor *pgio,\n\t\t\t\t       struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (!pgio->pg_ops->pg_get_mirror_count)\n\t\treturn 0;\n\n\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tif (!mirror_count || mirror_count > NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX)\n\t\treturn -EINVAL;\n\n\tif (WARN_ON_ONCE(!pgio->pg_mirrors_dynamic))\n\t\treturn -EINVAL;\n\n\tpgio->pg_mirror_count = mirror_count;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_pageio_add_request_mirror",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1121-1136",
    "snippet": "static int nfs_pageio_add_request_mirror(struct nfs_pageio_descriptor *desc,\n\t\tstruct nfs_page *req)\n{\n\tint ret;\n\n\tdo {\n\t\tret = __nfs_pageio_add_request(desc, req);\n\t\tif (ret)\n\t\t\tbreak;\n\t\tif (desc->pg_error < 0)\n\t\t\tbreak;\n\t\tret = nfs_do_recoalesce(desc);\n\t} while (ret);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_do_recoalesce",
          "args": [
            "desc"
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_do_recoalesce",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1092-1119",
          "snippet": "static int nfs_do_recoalesce(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\tLIST_HEAD(head);\n\n\tdo {\n\t\tlist_splice_init(&mirror->pg_list, &head);\n\t\tmirror->pg_bytes_written -= mirror->pg_count;\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t\tmirror->pg_recoalesce = 0;\n\n\t\tdesc->pg_moreio = 0;\n\n\t\twhile (!list_empty(&head)) {\n\t\t\tstruct nfs_page *req;\n\n\t\t\treq = list_first_entry(&head, struct nfs_page, wb_list);\n\t\t\tnfs_list_remove_request(req);\n\t\t\tif (__nfs_pageio_add_request(desc, req))\n\t\t\t\tcontinue;\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\t\t}\n\t} while (mirror->pg_recoalesce);\n\treturn 1;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_do_recoalesce(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\tLIST_HEAD(head);\n\n\tdo {\n\t\tlist_splice_init(&mirror->pg_list, &head);\n\t\tmirror->pg_bytes_written -= mirror->pg_count;\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t\tmirror->pg_recoalesce = 0;\n\n\t\tdesc->pg_moreio = 0;\n\n\t\twhile (!list_empty(&head)) {\n\t\t\tstruct nfs_page *req;\n\n\t\t\treq = list_first_entry(&head, struct nfs_page, wb_list);\n\t\t\tnfs_list_remove_request(req);\n\t\t\tif (__nfs_pageio_add_request(desc, req))\n\t\t\t\tcontinue;\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\t\t}\n\t} while (mirror->pg_recoalesce);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__nfs_pageio_add_request",
          "args": [
            "desc",
            "req"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_pageio_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1028-1090",
          "snippet": "static int __nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *subreq;\n\tunsigned int bytes_left = 0;\n\tunsigned int offset, pgbase;\n\n\tnfs_page_group_lock(req, false);\n\n\tsubreq = req;\n\tbytes_left = subreq->wb_bytes;\n\toffset = subreq->wb_offset;\n\tpgbase = subreq->wb_pgbase;\n\n\tdo {\n\t\tif (!nfs_pageio_do_add_request(desc, subreq)) {\n\t\t\t/* make sure pg_test call(s) did nothing */\n\t\t\tWARN_ON_ONCE(subreq->wb_bytes != bytes_left);\n\t\t\tWARN_ON_ONCE(subreq->wb_offset != offset);\n\t\t\tWARN_ON_ONCE(subreq->wb_pgbase != pgbase);\n\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdesc->pg_moreio = 1;\n\t\t\tnfs_pageio_doio(desc);\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tif (mirror->pg_recoalesce)\n\t\t\t\treturn 0;\n\t\t\t/* retry add_request for this subreq */\n\t\t\tnfs_page_group_lock(req, false);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check for buggy pg_test call(s) */\n\t\tWARN_ON_ONCE(subreq->wb_bytes + subreq->wb_pgbase > PAGE_SIZE);\n\t\tWARN_ON_ONCE(subreq->wb_bytes > bytes_left);\n\t\tWARN_ON_ONCE(subreq->wb_bytes == 0);\n\n\t\tbytes_left -= subreq->wb_bytes;\n\t\toffset += subreq->wb_bytes;\n\t\tpgbase += subreq->wb_bytes;\n\n\t\tif (bytes_left) {\n\t\t\tsubreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page,\n\t\t\t\t\tsubreq, pgbase, bytes_left);\n\t\t\tif (IS_ERR(subreq))\n\t\t\t\tgoto err_ptr;\n\t\t\tnfs_lock_request(subreq);\n\t\t\tsubreq->wb_offset  = offset;\n\t\t\tsubreq->wb_index = req->wb_index;\n\t\t}\n\t} while (bytes_left > 0);\n\n\tnfs_page_group_unlock(req);\n\treturn 1;\nerr_ptr:\n\tdesc->pg_error = PTR_ERR(subreq);\n\tnfs_page_group_unlock(req);\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int __nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *subreq;\n\tunsigned int bytes_left = 0;\n\tunsigned int offset, pgbase;\n\n\tnfs_page_group_lock(req, false);\n\n\tsubreq = req;\n\tbytes_left = subreq->wb_bytes;\n\toffset = subreq->wb_offset;\n\tpgbase = subreq->wb_pgbase;\n\n\tdo {\n\t\tif (!nfs_pageio_do_add_request(desc, subreq)) {\n\t\t\t/* make sure pg_test call(s) did nothing */\n\t\t\tWARN_ON_ONCE(subreq->wb_bytes != bytes_left);\n\t\t\tWARN_ON_ONCE(subreq->wb_offset != offset);\n\t\t\tWARN_ON_ONCE(subreq->wb_pgbase != pgbase);\n\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdesc->pg_moreio = 1;\n\t\t\tnfs_pageio_doio(desc);\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tif (mirror->pg_recoalesce)\n\t\t\t\treturn 0;\n\t\t\t/* retry add_request for this subreq */\n\t\t\tnfs_page_group_lock(req, false);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check for buggy pg_test call(s) */\n\t\tWARN_ON_ONCE(subreq->wb_bytes + subreq->wb_pgbase > PAGE_SIZE);\n\t\tWARN_ON_ONCE(subreq->wb_bytes > bytes_left);\n\t\tWARN_ON_ONCE(subreq->wb_bytes == 0);\n\n\t\tbytes_left -= subreq->wb_bytes;\n\t\toffset += subreq->wb_bytes;\n\t\tpgbase += subreq->wb_bytes;\n\n\t\tif (bytes_left) {\n\t\t\tsubreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page,\n\t\t\t\t\tsubreq, pgbase, bytes_left);\n\t\t\tif (IS_ERR(subreq))\n\t\t\t\tgoto err_ptr;\n\t\t\tnfs_lock_request(subreq);\n\t\t\tsubreq->wb_offset  = offset;\n\t\t\tsubreq->wb_index = req->wb_index;\n\t\t}\n\t} while (bytes_left > 0);\n\n\tnfs_page_group_unlock(req);\n\treturn 1;\nerr_ptr:\n\tdesc->pg_error = PTR_ERR(subreq);\n\tnfs_page_group_unlock(req);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pageio_add_request_mirror(struct nfs_pageio_descriptor *desc,\n\t\tstruct nfs_page *req)\n{\n\tint ret;\n\n\tdo {\n\t\tret = __nfs_pageio_add_request(desc, req);\n\t\tif (ret)\n\t\t\tbreak;\n\t\tif (desc->pg_error < 0)\n\t\t\tbreak;\n\t\tret = nfs_do_recoalesce(desc);\n\t} while (ret);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_do_recoalesce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1092-1119",
    "snippet": "static int nfs_do_recoalesce(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\tLIST_HEAD(head);\n\n\tdo {\n\t\tlist_splice_init(&mirror->pg_list, &head);\n\t\tmirror->pg_bytes_written -= mirror->pg_count;\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t\tmirror->pg_recoalesce = 0;\n\n\t\tdesc->pg_moreio = 0;\n\n\t\twhile (!list_empty(&head)) {\n\t\t\tstruct nfs_page *req;\n\n\t\t\treq = list_first_entry(&head, struct nfs_page, wb_list);\n\t\t\tnfs_list_remove_request(req);\n\t\t\tif (__nfs_pageio_add_request(desc, req))\n\t\t\t\tcontinue;\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\t\t}\n\t} while (mirror->pg_recoalesce);\n\treturn 1;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_pageio_add_request",
          "args": [
            "desc",
            "req"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_pageio_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1028-1090",
          "snippet": "static int __nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *subreq;\n\tunsigned int bytes_left = 0;\n\tunsigned int offset, pgbase;\n\n\tnfs_page_group_lock(req, false);\n\n\tsubreq = req;\n\tbytes_left = subreq->wb_bytes;\n\toffset = subreq->wb_offset;\n\tpgbase = subreq->wb_pgbase;\n\n\tdo {\n\t\tif (!nfs_pageio_do_add_request(desc, subreq)) {\n\t\t\t/* make sure pg_test call(s) did nothing */\n\t\t\tWARN_ON_ONCE(subreq->wb_bytes != bytes_left);\n\t\t\tWARN_ON_ONCE(subreq->wb_offset != offset);\n\t\t\tWARN_ON_ONCE(subreq->wb_pgbase != pgbase);\n\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdesc->pg_moreio = 1;\n\t\t\tnfs_pageio_doio(desc);\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tif (mirror->pg_recoalesce)\n\t\t\t\treturn 0;\n\t\t\t/* retry add_request for this subreq */\n\t\t\tnfs_page_group_lock(req, false);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check for buggy pg_test call(s) */\n\t\tWARN_ON_ONCE(subreq->wb_bytes + subreq->wb_pgbase > PAGE_SIZE);\n\t\tWARN_ON_ONCE(subreq->wb_bytes > bytes_left);\n\t\tWARN_ON_ONCE(subreq->wb_bytes == 0);\n\n\t\tbytes_left -= subreq->wb_bytes;\n\t\toffset += subreq->wb_bytes;\n\t\tpgbase += subreq->wb_bytes;\n\n\t\tif (bytes_left) {\n\t\t\tsubreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page,\n\t\t\t\t\tsubreq, pgbase, bytes_left);\n\t\t\tif (IS_ERR(subreq))\n\t\t\t\tgoto err_ptr;\n\t\t\tnfs_lock_request(subreq);\n\t\t\tsubreq->wb_offset  = offset;\n\t\t\tsubreq->wb_index = req->wb_index;\n\t\t}\n\t} while (bytes_left > 0);\n\n\tnfs_page_group_unlock(req);\n\treturn 1;\nerr_ptr:\n\tdesc->pg_error = PTR_ERR(subreq);\n\tnfs_page_group_unlock(req);\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int __nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *subreq;\n\tunsigned int bytes_left = 0;\n\tunsigned int offset, pgbase;\n\n\tnfs_page_group_lock(req, false);\n\n\tsubreq = req;\n\tbytes_left = subreq->wb_bytes;\n\toffset = subreq->wb_offset;\n\tpgbase = subreq->wb_pgbase;\n\n\tdo {\n\t\tif (!nfs_pageio_do_add_request(desc, subreq)) {\n\t\t\t/* make sure pg_test call(s) did nothing */\n\t\t\tWARN_ON_ONCE(subreq->wb_bytes != bytes_left);\n\t\t\tWARN_ON_ONCE(subreq->wb_offset != offset);\n\t\t\tWARN_ON_ONCE(subreq->wb_pgbase != pgbase);\n\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdesc->pg_moreio = 1;\n\t\t\tnfs_pageio_doio(desc);\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tif (mirror->pg_recoalesce)\n\t\t\t\treturn 0;\n\t\t\t/* retry add_request for this subreq */\n\t\t\tnfs_page_group_lock(req, false);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check for buggy pg_test call(s) */\n\t\tWARN_ON_ONCE(subreq->wb_bytes + subreq->wb_pgbase > PAGE_SIZE);\n\t\tWARN_ON_ONCE(subreq->wb_bytes > bytes_left);\n\t\tWARN_ON_ONCE(subreq->wb_bytes == 0);\n\n\t\tbytes_left -= subreq->wb_bytes;\n\t\toffset += subreq->wb_bytes;\n\t\tpgbase += subreq->wb_bytes;\n\n\t\tif (bytes_left) {\n\t\t\tsubreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page,\n\t\t\t\t\tsubreq, pgbase, bytes_left);\n\t\t\tif (IS_ERR(subreq))\n\t\t\t\tgoto err_ptr;\n\t\t\tnfs_lock_request(subreq);\n\t\t\tsubreq->wb_offset  = offset;\n\t\t\tsubreq->wb_index = req->wb_index;\n\t\t}\n\t} while (bytes_left > 0);\n\n\tnfs_page_group_unlock(req);\n\treturn 1;\nerr_ptr:\n\tdesc->pg_error = PTR_ERR(subreq);\n\tnfs_page_group_unlock(req);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry",
          "args": [
            "&head",
            "structnfs_page",
            "wb_list"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&head"
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_splice_init",
          "args": [
            "&mirror->pg_list",
            "&head"
          ],
          "line": 1098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "head"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_do_recoalesce(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\tLIST_HEAD(head);\n\n\tdo {\n\t\tlist_splice_init(&mirror->pg_list, &head);\n\t\tmirror->pg_bytes_written -= mirror->pg_count;\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t\tmirror->pg_recoalesce = 0;\n\n\t\tdesc->pg_moreio = 0;\n\n\t\twhile (!list_empty(&head)) {\n\t\t\tstruct nfs_page *req;\n\n\t\t\treq = list_first_entry(&head, struct nfs_page, wb_list);\n\t\t\tnfs_list_remove_request(req);\n\t\t\tif (__nfs_pageio_add_request(desc, req))\n\t\t\t\tcontinue;\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tbreak;\n\t\t}\n\t} while (mirror->pg_recoalesce);\n\treturn 1;\n}"
  },
  {
    "function_name": "__nfs_pageio_add_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "1028-1090",
    "snippet": "static int __nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *subreq;\n\tunsigned int bytes_left = 0;\n\tunsigned int offset, pgbase;\n\n\tnfs_page_group_lock(req, false);\n\n\tsubreq = req;\n\tbytes_left = subreq->wb_bytes;\n\toffset = subreq->wb_offset;\n\tpgbase = subreq->wb_pgbase;\n\n\tdo {\n\t\tif (!nfs_pageio_do_add_request(desc, subreq)) {\n\t\t\t/* make sure pg_test call(s) did nothing */\n\t\t\tWARN_ON_ONCE(subreq->wb_bytes != bytes_left);\n\t\t\tWARN_ON_ONCE(subreq->wb_offset != offset);\n\t\t\tWARN_ON_ONCE(subreq->wb_pgbase != pgbase);\n\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdesc->pg_moreio = 1;\n\t\t\tnfs_pageio_doio(desc);\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tif (mirror->pg_recoalesce)\n\t\t\t\treturn 0;\n\t\t\t/* retry add_request for this subreq */\n\t\t\tnfs_page_group_lock(req, false);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check for buggy pg_test call(s) */\n\t\tWARN_ON_ONCE(subreq->wb_bytes + subreq->wb_pgbase > PAGE_SIZE);\n\t\tWARN_ON_ONCE(subreq->wb_bytes > bytes_left);\n\t\tWARN_ON_ONCE(subreq->wb_bytes == 0);\n\n\t\tbytes_left -= subreq->wb_bytes;\n\t\toffset += subreq->wb_bytes;\n\t\tpgbase += subreq->wb_bytes;\n\n\t\tif (bytes_left) {\n\t\t\tsubreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page,\n\t\t\t\t\tsubreq, pgbase, bytes_left);\n\t\t\tif (IS_ERR(subreq))\n\t\t\t\tgoto err_ptr;\n\t\t\tnfs_lock_request(subreq);\n\t\t\tsubreq->wb_offset  = offset;\n\t\t\tsubreq->wb_index = req->wb_index;\n\t\t}\n\t} while (bytes_left > 0);\n\n\tnfs_page_group_unlock(req);\n\treturn 1;\nerr_ptr:\n\tdesc->pg_error = PTR_ERR(subreq);\n\tnfs_page_group_unlock(req);\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_page_group_unlock",
          "args": [
            "req"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "205-216",
          "snippet": "void\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "subreq"
          ],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_lock_request",
          "args": [
            "subreq"
          ],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "subreq"
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_create_request",
          "args": [
            "req->wb_context",
            "req->wb_page",
            "subreq",
            "pgbase",
            "bytes_left"
          ],
          "line": 1073
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_create_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "351-388",
          "snippet": "struct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "subreq->wb_bytes == 0"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "subreq->wb_bytes > bytes_left"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "subreq->wb_bytes + subreq->wb_pgbase > PAGE_SIZE"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_page_group_lock",
          "args": [
            "req",
            "false"
          ],
          "line": 1059
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "167-182",
          "snippet": "int\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_doio",
          "args": [
            "desc"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_doio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "999-1015",
          "snippet": "static void nfs_pageio_doio(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (!list_empty(&mirror->pg_list)) {\n\t\tint error = desc->pg_ops->pg_doio(desc);\n\t\tif (error < 0)\n\t\t\tdesc->pg_error = error;\n\t\telse\n\t\t\tmirror->pg_bytes_written += mirror->pg_count;\n\t}\n\tif (list_empty(&mirror->pg_list)) {\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_doio(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (!list_empty(&mirror->pg_list)) {\n\t\tint error = desc->pg_ops->pg_doio(desc);\n\t\tif (error < 0)\n\t\t\tdesc->pg_error = error;\n\t\telse\n\t\t\tmirror->pg_bytes_written += mirror->pg_count;\n\t}\n\tif (list_empty(&mirror->pg_list)) {\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "subreq->wb_pgbase != pgbase"
          ],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "subreq->wb_offset != offset"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "subreq->wb_bytes != bytes_left"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pageio_do_add_request",
          "args": [
            "desc",
            "subreq"
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_do_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "974-994",
          "snippet": "static int nfs_pageio_do_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t\t     struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *prev = NULL;\n\n\tif (mirror->pg_count != 0) {\n\t\tprev = nfs_list_entry(mirror->pg_list.prev);\n\t} else {\n\t\tif (desc->pg_ops->pg_init)\n\t\t\tdesc->pg_ops->pg_init(desc, req);\n\t\tmirror->pg_base = req->wb_pgbase;\n\t}\n\tif (!nfs_can_coalesce_requests(prev, req, desc))\n\t\treturn 0;\n\tnfs_list_remove_request(req);\n\tnfs_list_add_request(req, &mirror->pg_list);\n\tmirror->pg_count += req->wb_bytes;\n\treturn 1;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pageio_do_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t\t     struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *prev = NULL;\n\n\tif (mirror->pg_count != 0) {\n\t\tprev = nfs_list_entry(mirror->pg_list.prev);\n\t} else {\n\t\tif (desc->pg_ops->pg_init)\n\t\t\tdesc->pg_ops->pg_init(desc, req);\n\t\tmirror->pg_base = req->wb_pgbase;\n\t}\n\tif (!nfs_can_coalesce_requests(prev, req, desc))\n\t\treturn 0;\n\tnfs_list_remove_request(req);\n\tnfs_list_add_request(req, &mirror->pg_list);\n\tmirror->pg_count += req->wb_bytes;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int __nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *subreq;\n\tunsigned int bytes_left = 0;\n\tunsigned int offset, pgbase;\n\n\tnfs_page_group_lock(req, false);\n\n\tsubreq = req;\n\tbytes_left = subreq->wb_bytes;\n\toffset = subreq->wb_offset;\n\tpgbase = subreq->wb_pgbase;\n\n\tdo {\n\t\tif (!nfs_pageio_do_add_request(desc, subreq)) {\n\t\t\t/* make sure pg_test call(s) did nothing */\n\t\t\tWARN_ON_ONCE(subreq->wb_bytes != bytes_left);\n\t\t\tWARN_ON_ONCE(subreq->wb_offset != offset);\n\t\t\tWARN_ON_ONCE(subreq->wb_pgbase != pgbase);\n\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdesc->pg_moreio = 1;\n\t\t\tnfs_pageio_doio(desc);\n\t\t\tif (desc->pg_error < 0)\n\t\t\t\treturn 0;\n\t\t\tif (mirror->pg_recoalesce)\n\t\t\t\treturn 0;\n\t\t\t/* retry add_request for this subreq */\n\t\t\tnfs_page_group_lock(req, false);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* check for buggy pg_test call(s) */\n\t\tWARN_ON_ONCE(subreq->wb_bytes + subreq->wb_pgbase > PAGE_SIZE);\n\t\tWARN_ON_ONCE(subreq->wb_bytes > bytes_left);\n\t\tWARN_ON_ONCE(subreq->wb_bytes == 0);\n\n\t\tbytes_left -= subreq->wb_bytes;\n\t\toffset += subreq->wb_bytes;\n\t\tpgbase += subreq->wb_bytes;\n\n\t\tif (bytes_left) {\n\t\t\tsubreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page,\n\t\t\t\t\tsubreq, pgbase, bytes_left);\n\t\t\tif (IS_ERR(subreq))\n\t\t\t\tgoto err_ptr;\n\t\t\tnfs_lock_request(subreq);\n\t\t\tsubreq->wb_offset  = offset;\n\t\t\tsubreq->wb_index = req->wb_index;\n\t\t}\n\t} while (bytes_left > 0);\n\n\tnfs_page_group_unlock(req);\n\treturn 1;\nerr_ptr:\n\tdesc->pg_error = PTR_ERR(subreq);\n\tnfs_page_group_unlock(req);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_pageio_doio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "999-1015",
    "snippet": "static void nfs_pageio_doio(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (!list_empty(&mirror->pg_list)) {\n\t\tint error = desc->pg_ops->pg_doio(desc);\n\t\tif (error < 0)\n\t\t\tdesc->pg_error = error;\n\t\telse\n\t\t\tmirror->pg_bytes_written += mirror->pg_count;\n\t}\n\tif (list_empty(&mirror->pg_list)) {\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&mirror->pg_list"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "desc->pg_ops->pg_doio",
          "args": [
            "desc"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 1001
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_doio(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (!list_empty(&mirror->pg_list)) {\n\t\tint error = desc->pg_ops->pg_doio(desc);\n\t\tif (error < 0)\n\t\t\tdesc->pg_error = error;\n\t\telse\n\t\t\tmirror->pg_bytes_written += mirror->pg_count;\n\t}\n\tif (list_empty(&mirror->pg_list)) {\n\t\tmirror->pg_count = 0;\n\t\tmirror->pg_base = 0;\n\t}\n}"
  },
  {
    "function_name": "nfs_pageio_do_add_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "974-994",
    "snippet": "static int nfs_pageio_do_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t\t     struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *prev = NULL;\n\n\tif (mirror->pg_count != 0) {\n\t\tprev = nfs_list_entry(mirror->pg_list.prev);\n\t} else {\n\t\tif (desc->pg_ops->pg_init)\n\t\t\tdesc->pg_ops->pg_init(desc, req);\n\t\tmirror->pg_base = req->wb_pgbase;\n\t}\n\tif (!nfs_can_coalesce_requests(prev, req, desc))\n\t\treturn 0;\n\tnfs_list_remove_request(req);\n\tnfs_list_add_request(req, &mirror->pg_list);\n\tmirror->pg_count += req->wb_bytes;\n\treturn 1;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_list_add_request",
          "args": [
            "req",
            "&mirror->pg_list"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_can_coalesce_requests",
          "args": [
            "prev",
            "req",
            "desc"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_can_coalesce_requests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "931-964",
          "snippet": "static bool nfs_can_coalesce_requests(struct nfs_page *prev,\n\t\t\t\t      struct nfs_page *req,\n\t\t\t\t      struct nfs_pageio_descriptor *pgio)\n{\n\tsize_t size;\n\tstruct file_lock_context *flctx;\n\n\tif (prev) {\n\t\tif (!nfs_match_open_context(req->wb_context, prev->wb_context))\n\t\t\treturn false;\n\t\tflctx = req->wb_context->dentry->d_inode->i_flctx;\n\t\tif (flctx != NULL &&\n\t\t    !(list_empty_careful(&flctx->flc_posix) &&\n\t\t      list_empty_careful(&flctx->flc_flock)) &&\n\t\t    !nfs_match_lock_context(req->wb_lock_context,\n\t\t\t\t\t    prev->wb_lock_context))\n\t\t\treturn false;\n\t\tif (req_offset(req) != req_offset(prev) + prev->wb_bytes)\n\t\t\treturn false;\n\t\tif (req->wb_page == prev->wb_page) {\n\t\t\tif (req->wb_pgbase != prev->wb_pgbase + prev->wb_bytes)\n\t\t\t\treturn false;\n\t\t} else {\n\t\t\tif (req->wb_pgbase != 0 ||\n\t\t\t    prev->wb_pgbase + prev->wb_bytes != PAGE_CACHE_SIZE)\n\t\t\t\treturn false;\n\t\t}\n\t}\n\tsize = pgio->pg_ops->pg_test(pgio, prev, req);\n\tWARN_ON_ONCE(size > req->wb_bytes);\n\tif (size && size < req->wb_bytes)\n\t\treq->wb_bytes = size;\n\treturn size > 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_can_coalesce_requests(struct nfs_page *prev,\n\t\t\t\t      struct nfs_page *req,\n\t\t\t\t      struct nfs_pageio_descriptor *pgio)\n{\n\tsize_t size;\n\tstruct file_lock_context *flctx;\n\n\tif (prev) {\n\t\tif (!nfs_match_open_context(req->wb_context, prev->wb_context))\n\t\t\treturn false;\n\t\tflctx = req->wb_context->dentry->d_inode->i_flctx;\n\t\tif (flctx != NULL &&\n\t\t    !(list_empty_careful(&flctx->flc_posix) &&\n\t\t      list_empty_careful(&flctx->flc_flock)) &&\n\t\t    !nfs_match_lock_context(req->wb_lock_context,\n\t\t\t\t\t    prev->wb_lock_context))\n\t\t\treturn false;\n\t\tif (req_offset(req) != req_offset(prev) + prev->wb_bytes)\n\t\t\treturn false;\n\t\tif (req->wb_page == prev->wb_page) {\n\t\t\tif (req->wb_pgbase != prev->wb_pgbase + prev->wb_bytes)\n\t\t\t\treturn false;\n\t\t} else {\n\t\t\tif (req->wb_pgbase != 0 ||\n\t\t\t    prev->wb_pgbase + prev->wb_bytes != PAGE_CACHE_SIZE)\n\t\t\t\treturn false;\n\t\t}\n\t}\n\tsize = pgio->pg_ops->pg_test(pgio, prev, req);\n\tWARN_ON_ONCE(size > req->wb_bytes);\n\tif (size && size < req->wb_bytes)\n\t\treq->wb_bytes = size;\n\treturn size > 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "desc->pg_ops->pg_init",
          "args": [
            "desc",
            "req"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "mirror->pg_list.prev"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pageio_do_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t\t     struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page *prev = NULL;\n\n\tif (mirror->pg_count != 0) {\n\t\tprev = nfs_list_entry(mirror->pg_list.prev);\n\t} else {\n\t\tif (desc->pg_ops->pg_init)\n\t\t\tdesc->pg_ops->pg_init(desc, req);\n\t\tmirror->pg_base = req->wb_pgbase;\n\t}\n\tif (!nfs_can_coalesce_requests(prev, req, desc))\n\t\treturn 0;\n\tnfs_list_remove_request(req);\n\tnfs_list_add_request(req, &mirror->pg_list);\n\tmirror->pg_count += req->wb_bytes;\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_can_coalesce_requests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "931-964",
    "snippet": "static bool nfs_can_coalesce_requests(struct nfs_page *prev,\n\t\t\t\t      struct nfs_page *req,\n\t\t\t\t      struct nfs_pageio_descriptor *pgio)\n{\n\tsize_t size;\n\tstruct file_lock_context *flctx;\n\n\tif (prev) {\n\t\tif (!nfs_match_open_context(req->wb_context, prev->wb_context))\n\t\t\treturn false;\n\t\tflctx = req->wb_context->dentry->d_inode->i_flctx;\n\t\tif (flctx != NULL &&\n\t\t    !(list_empty_careful(&flctx->flc_posix) &&\n\t\t      list_empty_careful(&flctx->flc_flock)) &&\n\t\t    !nfs_match_lock_context(req->wb_lock_context,\n\t\t\t\t\t    prev->wb_lock_context))\n\t\t\treturn false;\n\t\tif (req_offset(req) != req_offset(prev) + prev->wb_bytes)\n\t\t\treturn false;\n\t\tif (req->wb_page == prev->wb_page) {\n\t\t\tif (req->wb_pgbase != prev->wb_pgbase + prev->wb_bytes)\n\t\t\t\treturn false;\n\t\t} else {\n\t\t\tif (req->wb_pgbase != 0 ||\n\t\t\t    prev->wb_pgbase + prev->wb_bytes != PAGE_CACHE_SIZE)\n\t\t\t\treturn false;\n\t\t}\n\t}\n\tsize = pgio->pg_ops->pg_test(pgio, prev, req);\n\tWARN_ON_ONCE(size > req->wb_bytes);\n\tif (size && size < req->wb_bytes)\n\t\treq->wb_bytes = size;\n\treturn size > 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "size > req->wb_bytes"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgio->pg_ops->pg_test",
          "args": [
            "pgio",
            "prev",
            "req"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "req_offset",
          "args": [
            "prev"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "req_offset",
          "args": [
            "req"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_match_lock_context",
          "args": [
            "req->wb_lock_context",
            "prev->wb_lock_context"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_match_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "913-918",
          "snippet": "static bool nfs_match_lock_context(const struct nfs_lock_context *l1,\n\t\tconst struct nfs_lock_context *l2)\n{\n\treturn l1->lockowner.l_owner == l2->lockowner.l_owner\n\t\t&& l1->lockowner.l_pid == l2->lockowner.l_pid;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_match_lock_context(const struct nfs_lock_context *l1,\n\t\tconst struct nfs_lock_context *l2)\n{\n\treturn l1->lockowner.l_owner == l2->lockowner.l_owner\n\t\t&& l1->lockowner.l_pid == l2->lockowner.l_pid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty_careful",
          "args": [
            "&flctx->flc_flock"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty_careful",
          "args": [
            "&flctx->flc_posix"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_match_open_context",
          "args": [
            "req->wb_context",
            "prev->wb_context"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_match_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "907-911",
          "snippet": "static bool nfs_match_open_context(const struct nfs_open_context *ctx1,\n\t\tconst struct nfs_open_context *ctx2)\n{\n\treturn ctx1->cred == ctx2->cred && ctx1->state == ctx2->state;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_match_open_context(const struct nfs_open_context *ctx1,\n\t\tconst struct nfs_open_context *ctx2)\n{\n\treturn ctx1->cred == ctx2->cred && ctx1->state == ctx2->state;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_can_coalesce_requests(struct nfs_page *prev,\n\t\t\t\t      struct nfs_page *req,\n\t\t\t\t      struct nfs_pageio_descriptor *pgio)\n{\n\tsize_t size;\n\tstruct file_lock_context *flctx;\n\n\tif (prev) {\n\t\tif (!nfs_match_open_context(req->wb_context, prev->wb_context))\n\t\t\treturn false;\n\t\tflctx = req->wb_context->dentry->d_inode->i_flctx;\n\t\tif (flctx != NULL &&\n\t\t    !(list_empty_careful(&flctx->flc_posix) &&\n\t\t      list_empty_careful(&flctx->flc_flock)) &&\n\t\t    !nfs_match_lock_context(req->wb_lock_context,\n\t\t\t\t\t    prev->wb_lock_context))\n\t\t\treturn false;\n\t\tif (req_offset(req) != req_offset(prev) + prev->wb_bytes)\n\t\t\treturn false;\n\t\tif (req->wb_page == prev->wb_page) {\n\t\t\tif (req->wb_pgbase != prev->wb_pgbase + prev->wb_bytes)\n\t\t\t\treturn false;\n\t\t} else {\n\t\t\tif (req->wb_pgbase != 0 ||\n\t\t\t    prev->wb_pgbase + prev->wb_bytes != PAGE_CACHE_SIZE)\n\t\t\t\treturn false;\n\t\t}\n\t}\n\tsize = pgio->pg_ops->pg_test(pgio, prev, req);\n\tWARN_ON_ONCE(size > req->wb_bytes);\n\tif (size && size < req->wb_bytes)\n\t\treq->wb_bytes = size;\n\treturn size > 0;\n}"
  },
  {
    "function_name": "nfs_match_lock_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "913-918",
    "snippet": "static bool nfs_match_lock_context(const struct nfs_lock_context *l1,\n\t\tconst struct nfs_lock_context *l2)\n{\n\treturn l1->lockowner.l_owner == l2->lockowner.l_owner\n\t\t&& l1->lockowner.l_pid == l2->lockowner.l_pid;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_match_lock_context(const struct nfs_lock_context *l1,\n\t\tconst struct nfs_lock_context *l2)\n{\n\treturn l1->lockowner.l_owner == l2->lockowner.l_owner\n\t\t&& l1->lockowner.l_pid == l2->lockowner.l_pid;\n}"
  },
  {
    "function_name": "nfs_match_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "907-911",
    "snippet": "static bool nfs_match_open_context(const struct nfs_open_context *ctx1,\n\t\tconst struct nfs_open_context *ctx2)\n{\n\treturn ctx1->cred == ctx2->cred && ctx1->state == ctx2->state;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_match_open_context(const struct nfs_open_context *ctx1,\n\t\tconst struct nfs_open_context *ctx2)\n{\n\treturn ctx1->cred == ctx2->cred && ctx1->state == ctx2->state;\n}"
  },
  {
    "function_name": "nfs_pageio_cleanup_mirroring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "898-905",
    "snippet": "static void nfs_pageio_cleanup_mirroring(struct nfs_pageio_descriptor *pgio)\n{\n\tpgio->pg_mirror_count = 1;\n\tpgio->pg_mirror_idx = 0;\n\tpgio->pg_mirrors = pgio->pg_mirrors_static;\n\tkfree(pgio->pg_mirrors_dynamic);\n\tpgio->pg_mirrors_dynamic = NULL;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pgio->pg_mirrors_dynamic"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_cleanup_mirroring(struct nfs_pageio_descriptor *pgio)\n{\n\tpgio->pg_mirror_count = 1;\n\tpgio->pg_mirror_idx = 0;\n\tpgio->pg_mirrors = pgio->pg_mirrors_static;\n\tkfree(pgio->pg_mirrors_dynamic);\n\tpgio->pg_mirrors_dynamic = NULL;\n}"
  },
  {
    "function_name": "nfs_pageio_stop_mirroring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "892-896",
    "snippet": "void nfs_pageio_stop_mirroring(struct nfs_pageio_descriptor *pgio)\n{\n\tpgio->pg_mirror_count = 1;\n\tpgio->pg_mirror_idx = 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_stop_mirroring(struct nfs_pageio_descriptor *pgio)\n{\n\tpgio->pg_mirror_count = 1;\n\tpgio->pg_mirror_idx = 0;\n}"
  },
  {
    "function_name": "nfs_pageio_setup_mirroring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "868-887",
    "snippet": "static int nfs_pageio_setup_mirroring(struct nfs_pageio_descriptor *pgio,\n\t\t\t\t       struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (!pgio->pg_ops->pg_get_mirror_count)\n\t\treturn 0;\n\n\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tif (!mirror_count || mirror_count > NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX)\n\t\treturn -EINVAL;\n\n\tif (WARN_ON_ONCE(!pgio->pg_mirrors_dynamic))\n\t\treturn -EINVAL;\n\n\tpgio->pg_mirror_count = mirror_count;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!pgio->pg_mirrors_dynamic"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgio->pg_ops->pg_get_mirror_count",
          "args": [
            "pgio",
            "req"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pageio_setup_mirroring(struct nfs_pageio_descriptor *pgio,\n\t\t\t\t       struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (!pgio->pg_ops->pg_get_mirror_count)\n\t\treturn 0;\n\n\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tif (!mirror_count || mirror_count > NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX)\n\t\treturn -EINVAL;\n\n\tif (WARN_ON_ONCE(!pgio->pg_mirrors_dynamic))\n\t\treturn -EINVAL;\n\n\tpgio->pg_mirror_count = mirror_count;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_generic_pg_pgios",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "837-862",
    "snippet": "static int nfs_generic_pg_pgios(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tstruct nfs_pgio_header *hdr;\n\tint ret;\n\n\tmirror = nfs_pgio_current_mirror(desc);\n\n\thdr = nfs_pgio_header_alloc(desc->pg_rw_ops);\n\tif (!hdr) {\n\t\t/* TODO: make sure this is right with mirroring - or\n\t\t *       should it back out all mirrors? */\n\t\tdesc->pg_completion_ops->error_cleanup(&mirror->pg_list);\n\t\treturn -ENOMEM;\n\t}\n\tnfs_pgheader_init(desc, hdr, nfs_pgio_header_free);\n\tret = nfs_generic_pgio(desc, hdr);\n\tif (ret == 0)\n\t\tret = nfs_initiate_pgio(NFS_CLIENT(hdr->inode),\n\t\t\t\t\thdr,\n\t\t\t\t\thdr->cred,\n\t\t\t\t\tNFS_PROTO(hdr->inode),\n\t\t\t\t\tdesc->pg_rpc_callops,\n\t\t\t\t\tdesc->pg_ioflags, 0);\n\treturn ret;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_initiate_pgio",
          "args": [
            "NFS_CLIENT(hdr->inode)",
            "hdr",
            "hdr->cred",
            "NFS_PROTO(hdr->inode)",
            "desc->pg_rpc_callops",
            "desc->pg_ioflags",
            "0"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_initiate_pgio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "616-660",
          "snippet": "int nfs_initiate_pgio(struct rpc_clnt *clnt, struct nfs_pgio_header *hdr,\n\t\t      struct rpc_cred *cred, const struct nfs_rpc_ops *rpc_ops,\n\t\t      const struct rpc_call_ops *call_ops, int how, int flags)\n{\n\tstruct rpc_task *task;\n\tstruct rpc_message msg = {\n\t\t.rpc_argp = &hdr->args,\n\t\t.rpc_resp = &hdr->res,\n\t\t.rpc_cred = cred,\n\t};\n\tstruct rpc_task_setup task_setup_data = {\n\t\t.rpc_client = clnt,\n\t\t.task = &hdr->task,\n\t\t.rpc_message = &msg,\n\t\t.callback_ops = call_ops,\n\t\t.callback_data = hdr,\n\t\t.workqueue = nfsiod_workqueue,\n\t\t.flags = RPC_TASK_ASYNC | flags,\n\t};\n\tint ret = 0;\n\n\thdr->rw_ops->rw_initiate(hdr, &msg, rpc_ops, &task_setup_data, how);\n\n\tdprintk(\"NFS: %5u initiated pgio call \"\n\t\t\"(req %s/%llu, %u bytes @ offset %llu)\\n\",\n\t\thdr->task.tk_pid,\n\t\thdr->inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(hdr->inode),\n\t\thdr->args.count,\n\t\t(unsigned long long)hdr->args.offset);\n\n\ttask = rpc_run_task(&task_setup_data);\n\tif (IS_ERR(task)) {\n\t\tret = PTR_ERR(task);\n\t\tgoto out;\n\t}\n\tif (how & FLUSH_SYNC) {\n\t\tret = rpc_wait_for_completion_task(task);\n\t\tif (ret == 0)\n\t\t\tret = task->tk_status;\n\t}\n\trpc_put_task(task);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_initiate_pgio(struct rpc_clnt *clnt, struct nfs_pgio_header *hdr,\n\t\t      struct rpc_cred *cred, const struct nfs_rpc_ops *rpc_ops,\n\t\t      const struct rpc_call_ops *call_ops, int how, int flags)\n{\n\tstruct rpc_task *task;\n\tstruct rpc_message msg = {\n\t\t.rpc_argp = &hdr->args,\n\t\t.rpc_resp = &hdr->res,\n\t\t.rpc_cred = cred,\n\t};\n\tstruct rpc_task_setup task_setup_data = {\n\t\t.rpc_client = clnt,\n\t\t.task = &hdr->task,\n\t\t.rpc_message = &msg,\n\t\t.callback_ops = call_ops,\n\t\t.callback_data = hdr,\n\t\t.workqueue = nfsiod_workqueue,\n\t\t.flags = RPC_TASK_ASYNC | flags,\n\t};\n\tint ret = 0;\n\n\thdr->rw_ops->rw_initiate(hdr, &msg, rpc_ops, &task_setup_data, how);\n\n\tdprintk(\"NFS: %5u initiated pgio call \"\n\t\t\"(req %s/%llu, %u bytes @ offset %llu)\\n\",\n\t\thdr->task.tk_pid,\n\t\thdr->inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(hdr->inode),\n\t\thdr->args.count,\n\t\t(unsigned long long)hdr->args.offset);\n\n\ttask = rpc_run_task(&task_setup_data);\n\tif (IS_ERR(task)) {\n\t\tret = PTR_ERR(task);\n\t\tgoto out;\n\t}\n\tif (how & FLUSH_SYNC) {\n\t\tret = rpc_wait_for_completion_task(task);\n\t\tif (ret == 0)\n\t\t\tret = task->tk_status;\n\t}\n\trpc_put_task(task);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "hdr->inode"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "hdr->inode"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_generic_pgio",
          "args": [
            "desc",
            "hdr"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_generic_pgio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "791-834",
          "snippet": "int nfs_generic_pgio(struct nfs_pageio_descriptor *desc,\n\t\t     struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page\t\t*req;\n\tstruct page\t\t**pages,\n\t\t\t\t*last_page;\n\tstruct list_head *head = &mirror->pg_list;\n\tstruct nfs_commit_info cinfo;\n\tunsigned int pagecount, pageused;\n\n\tpagecount = nfs_page_array_len(mirror->pg_base, mirror->pg_count);\n\tif (!nfs_pgarray_set(&hdr->page_array, pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tnfs_init_cinfo(&cinfo, desc->pg_inode, desc->pg_dreq);\n\tpages = hdr->page_array.pagevec;\n\tlast_page = NULL;\n\tpageused = 0;\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_list_add_request(req, &hdr->pages);\n\n\t\tif (!last_page || last_page != req->wb_page) {\n\t\t\tpageused++;\n\t\t\tif (pageused > pagecount)\n\t\t\t\tbreak;\n\t\t\t*pages++ = last_page = req->wb_page;\n\t\t}\n\t}\n\tif (WARN_ON_ONCE(pageused != pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tif ((desc->pg_ioflags & FLUSH_COND_STABLE) &&\n\t    (desc->pg_moreio || nfs_reqs_to_commit(&cinfo)))\n\t\tdesc->pg_ioflags &= ~FLUSH_COND_STABLE;\n\n\t/* Set up the argument struct */\n\tnfs_pgio_rpcsetup(hdr, mirror->pg_count, 0, desc->pg_ioflags, &cinfo);\n\tdesc->pg_rpc_callops = &nfs_pgio_common_ops;\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct rpc_call_ops nfs_pgio_common_ops;",
            "static const struct rpc_call_ops nfs_pgio_common_ops = {\n\t.rpc_call_prepare = nfs_pgio_prepare,\n\t.rpc_call_done = nfs_pgio_result,\n\t.rpc_release = nfs_pgio_release,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const struct rpc_call_ops nfs_pgio_common_ops;\nstatic const struct rpc_call_ops nfs_pgio_common_ops = {\n\t.rpc_call_prepare = nfs_pgio_prepare,\n\t.rpc_call_done = nfs_pgio_result,\n\t.rpc_release = nfs_pgio_release,\n};\n\nint nfs_generic_pgio(struct nfs_pageio_descriptor *desc,\n\t\t     struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page\t\t*req;\n\tstruct page\t\t**pages,\n\t\t\t\t*last_page;\n\tstruct list_head *head = &mirror->pg_list;\n\tstruct nfs_commit_info cinfo;\n\tunsigned int pagecount, pageused;\n\n\tpagecount = nfs_page_array_len(mirror->pg_base, mirror->pg_count);\n\tif (!nfs_pgarray_set(&hdr->page_array, pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tnfs_init_cinfo(&cinfo, desc->pg_inode, desc->pg_dreq);\n\tpages = hdr->page_array.pagevec;\n\tlast_page = NULL;\n\tpageused = 0;\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_list_add_request(req, &hdr->pages);\n\n\t\tif (!last_page || last_page != req->wb_page) {\n\t\t\tpageused++;\n\t\t\tif (pageused > pagecount)\n\t\t\t\tbreak;\n\t\t\t*pages++ = last_page = req->wb_page;\n\t\t}\n\t}\n\tif (WARN_ON_ONCE(pageused != pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tif ((desc->pg_ioflags & FLUSH_COND_STABLE) &&\n\t    (desc->pg_moreio || nfs_reqs_to_commit(&cinfo)))\n\t\tdesc->pg_ioflags &= ~FLUSH_COND_STABLE;\n\n\t/* Set up the argument struct */\n\tnfs_pgio_rpcsetup(hdr, mirror->pg_count, 0, desc->pg_ioflags, &cinfo);\n\tdesc->pg_rpc_callops = &nfs_pgio_common_ops;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgheader_init",
          "args": [
            "desc",
            "hdr",
            "nfs_pgio_header_free"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgheader_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "54-74",
          "snippet": "void nfs_pgheader_init(struct nfs_pageio_descriptor *desc,\n\t\t       struct nfs_pgio_header *hdr,\n\t\t       void (*release)(struct nfs_pgio_header *hdr))\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\thdr->req = nfs_list_entry(mirror->pg_list.next);\n\thdr->inode = desc->pg_inode;\n\thdr->cred = hdr->req->wb_context->cred;\n\thdr->io_start = req_offset(hdr->req);\n\thdr->good_bytes = mirror->pg_count;\n\thdr->dreq = desc->pg_dreq;\n\thdr->layout_private = desc->pg_layout_private;\n\thdr->release = release;\n\thdr->completion_ops = desc->pg_completion_ops;\n\tif (hdr->completion_ops->init_hdr)\n\t\thdr->completion_ops->init_hdr(hdr);\n\n\thdr->pgio_mirror_idx = desc->pg_mirror_idx;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pgheader_init(struct nfs_pageio_descriptor *desc,\n\t\t       struct nfs_pgio_header *hdr,\n\t\t       void (*release)(struct nfs_pgio_header *hdr))\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\thdr->req = nfs_list_entry(mirror->pg_list.next);\n\thdr->inode = desc->pg_inode;\n\thdr->cred = hdr->req->wb_context->cred;\n\thdr->io_start = req_offset(hdr->req);\n\thdr->good_bytes = mirror->pg_count;\n\thdr->dreq = desc->pg_dreq;\n\thdr->layout_private = desc->pg_layout_private;\n\thdr->release = release;\n\thdr->completion_ops = desc->pg_completion_ops;\n\tif (hdr->completion_ops->init_hdr)\n\t\thdr->completion_ops->init_hdr(hdr);\n\n\thdr->pgio_mirror_idx = desc->pg_mirror_idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "desc->pg_completion_ops->error_cleanup",
          "args": [
            "&mirror->pg_list"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_header_alloc",
          "args": [
            "desc->pg_rw_ops"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_header_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "518-528",
          "snippet": "struct nfs_pgio_header *nfs_pgio_header_alloc(const struct nfs_rw_ops *ops)\n{\n\tstruct nfs_pgio_header *hdr = ops->rw_alloc_header();\n\n\tif (hdr) {\n\t\tINIT_LIST_HEAD(&hdr->pages);\n\t\tspin_lock_init(&hdr->lock);\n\t\thdr->rw_ops = ops;\n\t}\n\treturn hdr;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_header *nfs_pgio_header_alloc(const struct nfs_rw_ops *ops)\n{\n\tstruct nfs_pgio_header *hdr = ops->rw_alloc_header();\n\n\tif (hdr) {\n\t\tINIT_LIST_HEAD(&hdr->pages);\n\t\tspin_lock_init(&hdr->lock);\n\t\thdr->rw_ops = ops;\n\t}\n\treturn hdr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_generic_pg_pgios(struct nfs_pageio_descriptor *desc)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tstruct nfs_pgio_header *hdr;\n\tint ret;\n\n\tmirror = nfs_pgio_current_mirror(desc);\n\n\thdr = nfs_pgio_header_alloc(desc->pg_rw_ops);\n\tif (!hdr) {\n\t\t/* TODO: make sure this is right with mirroring - or\n\t\t *       should it back out all mirrors? */\n\t\tdesc->pg_completion_ops->error_cleanup(&mirror->pg_list);\n\t\treturn -ENOMEM;\n\t}\n\tnfs_pgheader_init(desc, hdr, nfs_pgio_header_free);\n\tret = nfs_generic_pgio(desc, hdr);\n\tif (ret == 0)\n\t\tret = nfs_initiate_pgio(NFS_CLIENT(hdr->inode),\n\t\t\t\t\thdr,\n\t\t\t\t\thdr->cred,\n\t\t\t\t\tNFS_PROTO(hdr->inode),\n\t\t\t\t\tdesc->pg_rpc_callops,\n\t\t\t\t\tdesc->pg_ioflags, 0);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_generic_pgio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "791-834",
    "snippet": "int nfs_generic_pgio(struct nfs_pageio_descriptor *desc,\n\t\t     struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page\t\t*req;\n\tstruct page\t\t**pages,\n\t\t\t\t*last_page;\n\tstruct list_head *head = &mirror->pg_list;\n\tstruct nfs_commit_info cinfo;\n\tunsigned int pagecount, pageused;\n\n\tpagecount = nfs_page_array_len(mirror->pg_base, mirror->pg_count);\n\tif (!nfs_pgarray_set(&hdr->page_array, pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tnfs_init_cinfo(&cinfo, desc->pg_inode, desc->pg_dreq);\n\tpages = hdr->page_array.pagevec;\n\tlast_page = NULL;\n\tpageused = 0;\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_list_add_request(req, &hdr->pages);\n\n\t\tif (!last_page || last_page != req->wb_page) {\n\t\t\tpageused++;\n\t\t\tif (pageused > pagecount)\n\t\t\t\tbreak;\n\t\t\t*pages++ = last_page = req->wb_page;\n\t\t}\n\t}\n\tif (WARN_ON_ONCE(pageused != pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tif ((desc->pg_ioflags & FLUSH_COND_STABLE) &&\n\t    (desc->pg_moreio || nfs_reqs_to_commit(&cinfo)))\n\t\tdesc->pg_ioflags &= ~FLUSH_COND_STABLE;\n\n\t/* Set up the argument struct */\n\tnfs_pgio_rpcsetup(hdr, mirror->pg_count, 0, desc->pg_ioflags, &cinfo);\n\tdesc->pg_rpc_callops = &nfs_pgio_common_ops;\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct rpc_call_ops nfs_pgio_common_ops;",
      "static const struct rpc_call_ops nfs_pgio_common_ops = {\n\t.rpc_call_prepare = nfs_pgio_prepare,\n\t.rpc_call_done = nfs_pgio_result,\n\t.rpc_release = nfs_pgio_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_pgio_rpcsetup",
          "args": [
            "hdr",
            "mirror->pg_count",
            "0",
            "desc->pg_ioflags",
            "&cinfo"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_rpcsetup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "566-600",
          "snippet": "static void nfs_pgio_rpcsetup(struct nfs_pgio_header *hdr,\n\t\t\t      unsigned int count, unsigned int offset,\n\t\t\t      int how, struct nfs_commit_info *cinfo)\n{\n\tstruct nfs_page *req = hdr->req;\n\n\t/* Set up the RPC argument and reply structs\n\t * NB: take care not to mess about with hdr->commit et al. */\n\n\thdr->args.fh     = NFS_FH(hdr->inode);\n\thdr->args.offset = req_offset(req) + offset;\n\t/* pnfs_set_layoutcommit needs this */\n\thdr->mds_offset = hdr->args.offset;\n\thdr->args.pgbase = req->wb_pgbase + offset;\n\thdr->args.pages  = hdr->page_array.pagevec;\n\thdr->args.count  = count;\n\thdr->args.context = get_nfs_open_context(req->wb_context);\n\thdr->args.lock_context = req->wb_lock_context;\n\thdr->args.stable  = NFS_UNSTABLE;\n\tswitch (how & (FLUSH_STABLE | FLUSH_COND_STABLE)) {\n\tcase 0:\n\t\tbreak;\n\tcase FLUSH_COND_STABLE:\n\t\tif (nfs_reqs_to_commit(cinfo))\n\t\t\tbreak;\n\tdefault:\n\t\thdr->args.stable = NFS_FILE_SYNC;\n\t}\n\n\thdr->res.fattr   = &hdr->fattr;\n\thdr->res.count   = count;\n\thdr->res.eof     = 0;\n\thdr->res.verf    = &hdr->verf;\n\tnfs_fattr_init(&hdr->fattr);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pgio_rpcsetup(struct nfs_pgio_header *hdr,\n\t\t\t      unsigned int count, unsigned int offset,\n\t\t\t      int how, struct nfs_commit_info *cinfo)\n{\n\tstruct nfs_page *req = hdr->req;\n\n\t/* Set up the RPC argument and reply structs\n\t * NB: take care not to mess about with hdr->commit et al. */\n\n\thdr->args.fh     = NFS_FH(hdr->inode);\n\thdr->args.offset = req_offset(req) + offset;\n\t/* pnfs_set_layoutcommit needs this */\n\thdr->mds_offset = hdr->args.offset;\n\thdr->args.pgbase = req->wb_pgbase + offset;\n\thdr->args.pages  = hdr->page_array.pagevec;\n\thdr->args.count  = count;\n\thdr->args.context = get_nfs_open_context(req->wb_context);\n\thdr->args.lock_context = req->wb_lock_context;\n\thdr->args.stable  = NFS_UNSTABLE;\n\tswitch (how & (FLUSH_STABLE | FLUSH_COND_STABLE)) {\n\tcase 0:\n\t\tbreak;\n\tcase FLUSH_COND_STABLE:\n\t\tif (nfs_reqs_to_commit(cinfo))\n\t\t\tbreak;\n\tdefault:\n\t\thdr->args.stable = NFS_FILE_SYNC;\n\t}\n\n\thdr->res.fattr   = &hdr->fattr;\n\thdr->res.count   = count;\n\thdr->res.eof     = 0;\n\thdr->res.verf    = &hdr->verf;\n\tnfs_fattr_init(&hdr->fattr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_reqs_to_commit",
          "args": [
            "&cinfo"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_reqs_to_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "918-922",
          "snippet": "unsigned long\nnfs_reqs_to_commit(struct nfs_commit_info *cinfo)\n{\n\treturn cinfo->mds->ncommit;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nunsigned long\nnfs_reqs_to_commit(struct nfs_commit_info *cinfo)\n{\n\treturn cinfo->mds->ncommit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgio_error",
          "args": [
            "desc",
            "hdr"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "668-684",
          "snippet": "static int nfs_pgio_error(struct nfs_pageio_descriptor *desc,\n\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tu32 midx;\n\n\tset_bit(NFS_IOHDR_REDO, &hdr->flags);\n\tnfs_pgio_data_destroy(hdr);\n\thdr->completion_ops->completion(hdr);\n\t/* TODO: Make sure it's right to clean up all mirrors here\n\t *       and not just hdr->pgio_mirror_idx */\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tmirror = &desc->pg_mirrors[midx];\n\t\tdesc->pg_completion_ops->error_cleanup(&mirror->pg_list);\n\t}\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pgio_error(struct nfs_pageio_descriptor *desc,\n\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tu32 midx;\n\n\tset_bit(NFS_IOHDR_REDO, &hdr->flags);\n\tnfs_pgio_data_destroy(hdr);\n\thdr->completion_ops->completion(hdr);\n\t/* TODO: Make sure it's right to clean up all mirrors here\n\t *       and not just hdr->pgio_mirror_idx */\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tmirror = &desc->pg_mirrors[midx];\n\t\tdesc->pg_completion_ops->error_cleanup(&mirror->pg_list);\n\t}\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "pageused != pagecount"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_add_request",
          "args": [
            "req",
            "&hdr->pages"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "head->next"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "head"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_cinfo",
          "args": [
            "&cinfo",
            "desc->pg_inode",
            "desc->pg_dreq"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_cinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "829-837",
          "snippet": "void nfs_init_cinfo(struct nfs_commit_info *cinfo,\n\t\t    struct inode *inode,\n\t\t    struct nfs_direct_req *dreq)\n{\n\tif (dreq)\n\t\tnfs_init_cinfo_from_dreq(cinfo, dreq);\n\telse\n\t\tnfs_init_cinfo_from_inode(cinfo, inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nvoid nfs_init_cinfo(struct nfs_commit_info *cinfo,\n\t\t    struct inode *inode,\n\t\t    struct nfs_direct_req *dreq)\n{\n\tif (dreq)\n\t\tnfs_init_cinfo_from_dreq(cinfo, dreq);\n\telse\n\t\tnfs_init_cinfo_from_inode(cinfo, inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgarray_set",
          "args": [
            "&hdr->page_array",
            "pagecount"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgarray_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "32-43",
          "snippet": "static bool nfs_pgarray_set(struct nfs_page_array *p, unsigned int pagecount)\n{\n\tp->npages = pagecount;\n\tif (pagecount <= ARRAY_SIZE(p->page_array))\n\t\tp->pagevec = p->page_array;\n\telse {\n\t\tp->pagevec = kcalloc(pagecount, sizeof(struct page *), GFP_KERNEL);\n\t\tif (!p->pagevec)\n\t\t\tp->npages = 0;\n\t}\n\treturn p->pagevec != NULL;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_pgarray_set(struct nfs_page_array *p, unsigned int pagecount)\n{\n\tp->npages = pagecount;\n\tif (pagecount <= ARRAY_SIZE(p->page_array))\n\t\tp->pagevec = p->page_array;\n\telse {\n\t\tp->pagevec = kcalloc(pagecount, sizeof(struct page *), GFP_KERNEL);\n\t\tif (!p->pagevec)\n\t\t\tp->npages = 0;\n\t}\n\treturn p->pagevec != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_page_array_len",
          "args": [
            "mirror->pg_base",
            "mirror->pg_count"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_array_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "646-651",
          "snippet": "static inline\nunsigned int nfs_page_array_len(unsigned int base, size_t len)\n{\n\treturn ((unsigned long)len + (unsigned long)base +\n\t\tPAGE_SIZE - 1) >> PAGE_SHIFT;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "ssize_t nfs_file_splice_read(struct file *, loff_t *, struct pipe_inode_info *,\n\t\t\t     size_t, unsigned int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nssize_t nfs_file_splice_read(struct file *, loff_t *, struct pipe_inode_info *,\n\t\t\t     size_t, unsigned int);\n\nstatic inline\nunsigned int nfs_page_array_len(unsigned int base, size_t len)\n{\n\treturn ((unsigned long)len + (unsigned long)base +\n\t\tPAGE_SIZE - 1) >> PAGE_SHIFT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const struct rpc_call_ops nfs_pgio_common_ops;\nstatic const struct rpc_call_ops nfs_pgio_common_ops = {\n\t.rpc_call_prepare = nfs_pgio_prepare,\n\t.rpc_call_done = nfs_pgio_result,\n\t.rpc_release = nfs_pgio_release,\n};\n\nint nfs_generic_pgio(struct nfs_pageio_descriptor *desc,\n\t\t     struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\tstruct nfs_page\t\t*req;\n\tstruct page\t\t**pages,\n\t\t\t\t*last_page;\n\tstruct list_head *head = &mirror->pg_list;\n\tstruct nfs_commit_info cinfo;\n\tunsigned int pagecount, pageused;\n\n\tpagecount = nfs_page_array_len(mirror->pg_base, mirror->pg_count);\n\tif (!nfs_pgarray_set(&hdr->page_array, pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tnfs_init_cinfo(&cinfo, desc->pg_inode, desc->pg_dreq);\n\tpages = hdr->page_array.pagevec;\n\tlast_page = NULL;\n\tpageused = 0;\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_list_add_request(req, &hdr->pages);\n\n\t\tif (!last_page || last_page != req->wb_page) {\n\t\t\tpageused++;\n\t\t\tif (pageused > pagecount)\n\t\t\t\tbreak;\n\t\t\t*pages++ = last_page = req->wb_page;\n\t\t}\n\t}\n\tif (WARN_ON_ONCE(pageused != pagecount))\n\t\treturn nfs_pgio_error(desc, hdr);\n\n\tif ((desc->pg_ioflags & FLUSH_COND_STABLE) &&\n\t    (desc->pg_moreio || nfs_reqs_to_commit(&cinfo)))\n\t\tdesc->pg_ioflags &= ~FLUSH_COND_STABLE;\n\n\t/* Set up the argument struct */\n\tnfs_pgio_rpcsetup(hdr, mirror->pg_count, 0, desc->pg_ioflags, &cinfo);\n\tdesc->pg_rpc_callops = &nfs_pgio_common_ops;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_pgio_result",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "767-781",
    "snippet": "static void nfs_pgio_result(struct rpc_task *task, void *calldata)\n{\n\tstruct nfs_pgio_header *hdr = calldata;\n\tstruct inode *inode = hdr->inode;\n\n\tdprintk(\"NFS: %s: %5u, (status %d)\\n\", __func__,\n\t\ttask->tk_pid, task->tk_status);\n\n\tif (hdr->rw_ops->rw_done(task, hdr, inode) != 0)\n\t\treturn;\n\tif (task->tk_status < 0)\n\t\tnfs_set_pgio_error(hdr, task->tk_status, hdr->args.offset);\n\telse\n\t\thdr->rw_ops->rw_result(task, hdr);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hdr->rw_ops->rw_result",
          "args": [
            "task",
            "hdr"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_set_pgio_error",
          "args": [
            "hdr",
            "task->tk_status",
            "hdr->args.offset"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_pgio_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "77-87",
          "snippet": "void nfs_set_pgio_error(struct nfs_pgio_header *hdr, int error, loff_t pos)\n{\n\tspin_lock(&hdr->lock);\n\tif (pos < hdr->io_start + hdr->good_bytes) {\n\t\tset_bit(NFS_IOHDR_ERROR, &hdr->flags);\n\t\tclear_bit(NFS_IOHDR_EOF, &hdr->flags);\n\t\thdr->good_bytes = pos - hdr->io_start;\n\t\thdr->error = error;\n\t}\n\tspin_unlock(&hdr->lock);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_set_pgio_error(struct nfs_pgio_header *hdr, int error, loff_t pos)\n{\n\tspin_lock(&hdr->lock);\n\tif (pos < hdr->io_start + hdr->good_bytes) {\n\t\tset_bit(NFS_IOHDR_ERROR, &hdr->flags);\n\t\tclear_bit(NFS_IOHDR_EOF, &hdr->flags);\n\t\thdr->good_bytes = pos - hdr->io_start;\n\t\thdr->error = error;\n\t}\n\tspin_unlock(&hdr->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hdr->rw_ops->rw_done",
          "args": [
            "task",
            "hdr",
            "inode"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: %s: %5u, (status %d)\\n\"",
            "__func__",
            "task->tk_pid",
            "task->tk_status"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pgio_result(struct rpc_task *task, void *calldata)\n{\n\tstruct nfs_pgio_header *hdr = calldata;\n\tstruct inode *inode = hdr->inode;\n\n\tdprintk(\"NFS: %s: %5u, (status %d)\\n\", __func__,\n\t\ttask->tk_pid, task->tk_status);\n\n\tif (hdr->rw_ops->rw_done(task, hdr, inode) != 0)\n\t\treturn;\n\tif (task->tk_status < 0)\n\t\tnfs_set_pgio_error(hdr, task->tk_status, hdr->args.offset);\n\telse\n\t\thdr->rw_ops->rw_result(task, hdr);\n}"
  },
  {
    "function_name": "nfs_pageio_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "718-759",
    "snippet": "void nfs_pageio_init(struct nfs_pageio_descriptor *desc,\n\t\t     struct inode *inode,\n\t\t     const struct nfs_pageio_ops *pg_ops,\n\t\t     const struct nfs_pgio_completion_ops *compl_ops,\n\t\t     const struct nfs_rw_ops *rw_ops,\n\t\t     size_t bsize,\n\t\t     int io_flags)\n{\n\tstruct nfs_pgio_mirror *new;\n\tint i;\n\n\tdesc->pg_moreio = 0;\n\tdesc->pg_inode = inode;\n\tdesc->pg_ops = pg_ops;\n\tdesc->pg_completion_ops = compl_ops;\n\tdesc->pg_rw_ops = rw_ops;\n\tdesc->pg_ioflags = io_flags;\n\tdesc->pg_error = 0;\n\tdesc->pg_lseg = NULL;\n\tdesc->pg_dreq = NULL;\n\tdesc->pg_layout_private = NULL;\n\tdesc->pg_bsize = bsize;\n\n\tdesc->pg_mirror_count = 1;\n\tdesc->pg_mirror_idx = 0;\n\n\tif (pg_ops->pg_get_mirror_count) {\n\t\t/* until we have a request, we don't have an lseg and no\n\t\t * idea how many mirrors there will be */\n\t\tnew = kcalloc(NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX,\n\t\t\t      sizeof(struct nfs_pgio_mirror), GFP_KERNEL);\n\t\tdesc->pg_mirrors_dynamic = new;\n\t\tdesc->pg_mirrors = new;\n\n\t\tfor (i = 0; i < NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX; i++)\n\t\t\tnfs_pageio_mirror_init(&desc->pg_mirrors[i], bsize);\n\t} else {\n\t\tdesc->pg_mirrors_dynamic = NULL;\n\t\tdesc->pg_mirrors = desc->pg_mirrors_static;\n\t\tnfs_pageio_mirror_init(&desc->pg_mirrors[0], bsize);\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_pageio_mirror_init",
          "args": [
            "&desc->pg_mirrors[0]",
            "bsize"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_mirror_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "699-708",
          "snippet": "static void nfs_pageio_mirror_init(struct nfs_pgio_mirror *mirror,\n\t\t\t\t   unsigned int bsize)\n{\n\tINIT_LIST_HEAD(&mirror->pg_list);\n\tmirror->pg_bytes_written = 0;\n\tmirror->pg_count = 0;\n\tmirror->pg_bsize = bsize;\n\tmirror->pg_base = 0;\n\tmirror->pg_recoalesce = 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_mirror_init(struct nfs_pgio_mirror *mirror,\n\t\t\t\t   unsigned int bsize)\n{\n\tINIT_LIST_HEAD(&mirror->pg_list);\n\tmirror->pg_bytes_written = 0;\n\tmirror->pg_count = 0;\n\tmirror->pg_bsize = bsize;\n\tmirror->pg_base = 0;\n\tmirror->pg_recoalesce = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX",
            "sizeof(struct nfs_pgio_mirror)",
            "GFP_KERNEL"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_init(struct nfs_pageio_descriptor *desc,\n\t\t     struct inode *inode,\n\t\t     const struct nfs_pageio_ops *pg_ops,\n\t\t     const struct nfs_pgio_completion_ops *compl_ops,\n\t\t     const struct nfs_rw_ops *rw_ops,\n\t\t     size_t bsize,\n\t\t     int io_flags)\n{\n\tstruct nfs_pgio_mirror *new;\n\tint i;\n\n\tdesc->pg_moreio = 0;\n\tdesc->pg_inode = inode;\n\tdesc->pg_ops = pg_ops;\n\tdesc->pg_completion_ops = compl_ops;\n\tdesc->pg_rw_ops = rw_ops;\n\tdesc->pg_ioflags = io_flags;\n\tdesc->pg_error = 0;\n\tdesc->pg_lseg = NULL;\n\tdesc->pg_dreq = NULL;\n\tdesc->pg_layout_private = NULL;\n\tdesc->pg_bsize = bsize;\n\n\tdesc->pg_mirror_count = 1;\n\tdesc->pg_mirror_idx = 0;\n\n\tif (pg_ops->pg_get_mirror_count) {\n\t\t/* until we have a request, we don't have an lseg and no\n\t\t * idea how many mirrors there will be */\n\t\tnew = kcalloc(NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX,\n\t\t\t      sizeof(struct nfs_pgio_mirror), GFP_KERNEL);\n\t\tdesc->pg_mirrors_dynamic = new;\n\t\tdesc->pg_mirrors = new;\n\n\t\tfor (i = 0; i < NFS_PAGEIO_DESCRIPTOR_MIRROR_MAX; i++)\n\t\t\tnfs_pageio_mirror_init(&desc->pg_mirrors[i], bsize);\n\t} else {\n\t\tdesc->pg_mirrors_dynamic = NULL;\n\t\tdesc->pg_mirrors = desc->pg_mirrors_static;\n\t\tnfs_pageio_mirror_init(&desc->pg_mirrors[0], bsize);\n\t}\n}"
  },
  {
    "function_name": "nfs_pageio_mirror_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "699-708",
    "snippet": "static void nfs_pageio_mirror_init(struct nfs_pgio_mirror *mirror,\n\t\t\t\t   unsigned int bsize)\n{\n\tINIT_LIST_HEAD(&mirror->pg_list);\n\tmirror->pg_bytes_written = 0;\n\tmirror->pg_count = 0;\n\tmirror->pg_bsize = bsize;\n\tmirror->pg_base = 0;\n\tmirror->pg_recoalesce = 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&mirror->pg_list"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pageio_mirror_init(struct nfs_pgio_mirror *mirror,\n\t\t\t\t   unsigned int bsize)\n{\n\tINIT_LIST_HEAD(&mirror->pg_list);\n\tmirror->pg_bytes_written = 0;\n\tmirror->pg_count = 0;\n\tmirror->pg_bsize = bsize;\n\tmirror->pg_base = 0;\n\tmirror->pg_recoalesce = 0;\n}"
  },
  {
    "function_name": "nfs_pgio_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "690-697",
    "snippet": "static void nfs_pgio_release(void *calldata)\n{\n\tstruct nfs_pgio_header *hdr = calldata;\n\tif (hdr->rw_ops->rw_release)\n\t\thdr->rw_ops->rw_release(hdr);\n\tnfs_pgio_data_destroy(hdr);\n\thdr->completion_ops->completion(hdr);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hdr->completion_ops->completion",
          "args": [
            "hdr"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_data_destroy",
          "args": [
            "hdr"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_data_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "549-555",
          "snippet": "void nfs_pgio_data_destroy(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->args.context)\n\t\tput_nfs_open_context(hdr->args.context);\n\tif (hdr->page_array.pagevec != hdr->page_array.page_array)\n\t\tkfree(hdr->page_array.pagevec);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pgio_data_destroy(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->args.context)\n\t\tput_nfs_open_context(hdr->args.context);\n\tif (hdr->page_array.pagevec != hdr->page_array.page_array)\n\t\tkfree(hdr->page_array.pagevec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hdr->rw_ops->rw_release",
          "args": [
            "hdr"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pgio_release(void *calldata)\n{\n\tstruct nfs_pgio_header *hdr = calldata;\n\tif (hdr->rw_ops->rw_release)\n\t\thdr->rw_ops->rw_release(hdr);\n\tnfs_pgio_data_destroy(hdr);\n\thdr->completion_ops->completion(hdr);\n}"
  },
  {
    "function_name": "nfs_pgio_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "668-684",
    "snippet": "static int nfs_pgio_error(struct nfs_pageio_descriptor *desc,\n\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tu32 midx;\n\n\tset_bit(NFS_IOHDR_REDO, &hdr->flags);\n\tnfs_pgio_data_destroy(hdr);\n\thdr->completion_ops->completion(hdr);\n\t/* TODO: Make sure it's right to clean up all mirrors here\n\t *       and not just hdr->pgio_mirror_idx */\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tmirror = &desc->pg_mirrors[midx];\n\t\tdesc->pg_completion_ops->error_cleanup(&mirror->pg_list);\n\t}\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "desc->pg_completion_ops->error_cleanup",
          "args": [
            "&mirror->pg_list"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hdr->completion_ops->completion",
          "args": [
            "hdr"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_data_destroy",
          "args": [
            "hdr"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_data_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "549-555",
          "snippet": "void nfs_pgio_data_destroy(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->args.context)\n\t\tput_nfs_open_context(hdr->args.context);\n\tif (hdr->page_array.pagevec != hdr->page_array.page_array)\n\t\tkfree(hdr->page_array.pagevec);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pgio_data_destroy(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->args.context)\n\t\tput_nfs_open_context(hdr->args.context);\n\tif (hdr->page_array.pagevec != hdr->page_array.page_array)\n\t\tkfree(hdr->page_array.pagevec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_IOHDR_REDO",
            "&hdr->flags"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int nfs_pgio_error(struct nfs_pageio_descriptor *desc,\n\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_pgio_mirror *mirror;\n\tu32 midx;\n\n\tset_bit(NFS_IOHDR_REDO, &hdr->flags);\n\tnfs_pgio_data_destroy(hdr);\n\thdr->completion_ops->completion(hdr);\n\t/* TODO: Make sure it's right to clean up all mirrors here\n\t *       and not just hdr->pgio_mirror_idx */\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tmirror = &desc->pg_mirrors[midx];\n\t\tdesc->pg_completion_ops->error_cleanup(&mirror->pg_list);\n\t}\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "nfs_initiate_pgio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "616-660",
    "snippet": "int nfs_initiate_pgio(struct rpc_clnt *clnt, struct nfs_pgio_header *hdr,\n\t\t      struct rpc_cred *cred, const struct nfs_rpc_ops *rpc_ops,\n\t\t      const struct rpc_call_ops *call_ops, int how, int flags)\n{\n\tstruct rpc_task *task;\n\tstruct rpc_message msg = {\n\t\t.rpc_argp = &hdr->args,\n\t\t.rpc_resp = &hdr->res,\n\t\t.rpc_cred = cred,\n\t};\n\tstruct rpc_task_setup task_setup_data = {\n\t\t.rpc_client = clnt,\n\t\t.task = &hdr->task,\n\t\t.rpc_message = &msg,\n\t\t.callback_ops = call_ops,\n\t\t.callback_data = hdr,\n\t\t.workqueue = nfsiod_workqueue,\n\t\t.flags = RPC_TASK_ASYNC | flags,\n\t};\n\tint ret = 0;\n\n\thdr->rw_ops->rw_initiate(hdr, &msg, rpc_ops, &task_setup_data, how);\n\n\tdprintk(\"NFS: %5u initiated pgio call \"\n\t\t\"(req %s/%llu, %u bytes @ offset %llu)\\n\",\n\t\thdr->task.tk_pid,\n\t\thdr->inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(hdr->inode),\n\t\thdr->args.count,\n\t\t(unsigned long long)hdr->args.offset);\n\n\ttask = rpc_run_task(&task_setup_data);\n\tif (IS_ERR(task)) {\n\t\tret = PTR_ERR(task);\n\t\tgoto out;\n\t}\n\tif (how & FLUSH_SYNC) {\n\t\tret = rpc_wait_for_completion_task(task);\n\t\tif (ret == 0)\n\t\t\tret = task->tk_status;\n\t}\n\trpc_put_task(task);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_put_task",
          "args": [
            "task"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_wait_for_completion_task",
          "args": [
            "task"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "task"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "task"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_run_task",
          "args": [
            "&task_setup_data"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: %5u initiated pgio call \"\n\t\t\"(req %s/%llu, %u bytes @ offset %llu)\\n\"",
            "hdr->task.tk_pid",
            "hdr->inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(hdr->inode)",
            "hdr->args.count",
            "(unsigned long long)hdr->args.offset"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "hdr->inode"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hdr->rw_ops->rw_initiate",
          "args": [
            "hdr",
            "&msg",
            "rpc_ops",
            "&task_setup_data",
            "how"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_initiate_pgio(struct rpc_clnt *clnt, struct nfs_pgio_header *hdr,\n\t\t      struct rpc_cred *cred, const struct nfs_rpc_ops *rpc_ops,\n\t\t      const struct rpc_call_ops *call_ops, int how, int flags)\n{\n\tstruct rpc_task *task;\n\tstruct rpc_message msg = {\n\t\t.rpc_argp = &hdr->args,\n\t\t.rpc_resp = &hdr->res,\n\t\t.rpc_cred = cred,\n\t};\n\tstruct rpc_task_setup task_setup_data = {\n\t\t.rpc_client = clnt,\n\t\t.task = &hdr->task,\n\t\t.rpc_message = &msg,\n\t\t.callback_ops = call_ops,\n\t\t.callback_data = hdr,\n\t\t.workqueue = nfsiod_workqueue,\n\t\t.flags = RPC_TASK_ASYNC | flags,\n\t};\n\tint ret = 0;\n\n\thdr->rw_ops->rw_initiate(hdr, &msg, rpc_ops, &task_setup_data, how);\n\n\tdprintk(\"NFS: %5u initiated pgio call \"\n\t\t\"(req %s/%llu, %u bytes @ offset %llu)\\n\",\n\t\thdr->task.tk_pid,\n\t\thdr->inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(hdr->inode),\n\t\thdr->args.count,\n\t\t(unsigned long long)hdr->args.offset);\n\n\ttask = rpc_run_task(&task_setup_data);\n\tif (IS_ERR(task)) {\n\t\tret = PTR_ERR(task);\n\t\tgoto out;\n\t}\n\tif (how & FLUSH_SYNC) {\n\t\tret = rpc_wait_for_completion_task(task);\n\t\tif (ret == 0)\n\t\t\tret = task->tk_status;\n\t}\n\trpc_put_task(task);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_pgio_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "607-614",
    "snippet": "static void nfs_pgio_prepare(struct rpc_task *task, void *calldata)\n{\n\tstruct nfs_pgio_header *hdr = calldata;\n\tint err;\n\terr = NFS_PROTO(hdr->inode)->pgio_rpc_prepare(task, hdr);\n\tif (err)\n\t\trpc_exit(task, err);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_exit",
          "args": [
            "task",
            "err"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "task",
            "hdr"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "hdr->inode"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pgio_prepare(struct rpc_task *task, void *calldata)\n{\n\tstruct nfs_pgio_header *hdr = calldata;\n\tint err;\n\terr = NFS_PROTO(hdr->inode)->pgio_rpc_prepare(task, hdr);\n\tif (err)\n\t\trpc_exit(task, err);\n}"
  },
  {
    "function_name": "nfs_pgio_rpcsetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "566-600",
    "snippet": "static void nfs_pgio_rpcsetup(struct nfs_pgio_header *hdr,\n\t\t\t      unsigned int count, unsigned int offset,\n\t\t\t      int how, struct nfs_commit_info *cinfo)\n{\n\tstruct nfs_page *req = hdr->req;\n\n\t/* Set up the RPC argument and reply structs\n\t * NB: take care not to mess about with hdr->commit et al. */\n\n\thdr->args.fh     = NFS_FH(hdr->inode);\n\thdr->args.offset = req_offset(req) + offset;\n\t/* pnfs_set_layoutcommit needs this */\n\thdr->mds_offset = hdr->args.offset;\n\thdr->args.pgbase = req->wb_pgbase + offset;\n\thdr->args.pages  = hdr->page_array.pagevec;\n\thdr->args.count  = count;\n\thdr->args.context = get_nfs_open_context(req->wb_context);\n\thdr->args.lock_context = req->wb_lock_context;\n\thdr->args.stable  = NFS_UNSTABLE;\n\tswitch (how & (FLUSH_STABLE | FLUSH_COND_STABLE)) {\n\tcase 0:\n\t\tbreak;\n\tcase FLUSH_COND_STABLE:\n\t\tif (nfs_reqs_to_commit(cinfo))\n\t\t\tbreak;\n\tdefault:\n\t\thdr->args.stable = NFS_FILE_SYNC;\n\t}\n\n\thdr->res.fattr   = &hdr->fattr;\n\thdr->res.count   = count;\n\thdr->res.eof     = 0;\n\thdr->res.verf    = &hdr->verf;\n\tnfs_fattr_init(&hdr->fattr);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "&hdr->fattr"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_reqs_to_commit",
          "args": [
            "cinfo"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_reqs_to_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "918-922",
          "snippet": "unsigned long\nnfs_reqs_to_commit(struct nfs_commit_info *cinfo)\n{\n\treturn cinfo->mds->ncommit;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nunsigned long\nnfs_reqs_to_commit(struct nfs_commit_info *cinfo)\n{\n\treturn cinfo->mds->ncommit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_nfs_open_context",
          "args": [
            "req->wb_context"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "803-808",
          "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "req_offset",
          "args": [
            "req"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "hdr->inode"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_pgio_rpcsetup(struct nfs_pgio_header *hdr,\n\t\t\t      unsigned int count, unsigned int offset,\n\t\t\t      int how, struct nfs_commit_info *cinfo)\n{\n\tstruct nfs_page *req = hdr->req;\n\n\t/* Set up the RPC argument and reply structs\n\t * NB: take care not to mess about with hdr->commit et al. */\n\n\thdr->args.fh     = NFS_FH(hdr->inode);\n\thdr->args.offset = req_offset(req) + offset;\n\t/* pnfs_set_layoutcommit needs this */\n\thdr->mds_offset = hdr->args.offset;\n\thdr->args.pgbase = req->wb_pgbase + offset;\n\thdr->args.pages  = hdr->page_array.pagevec;\n\thdr->args.count  = count;\n\thdr->args.context = get_nfs_open_context(req->wb_context);\n\thdr->args.lock_context = req->wb_lock_context;\n\thdr->args.stable  = NFS_UNSTABLE;\n\tswitch (how & (FLUSH_STABLE | FLUSH_COND_STABLE)) {\n\tcase 0:\n\t\tbreak;\n\tcase FLUSH_COND_STABLE:\n\t\tif (nfs_reqs_to_commit(cinfo))\n\t\t\tbreak;\n\tdefault:\n\t\thdr->args.stable = NFS_FILE_SYNC;\n\t}\n\n\thdr->res.fattr   = &hdr->fattr;\n\thdr->res.count   = count;\n\thdr->res.eof     = 0;\n\thdr->res.verf    = &hdr->verf;\n\tnfs_fattr_init(&hdr->fattr);\n}"
  },
  {
    "function_name": "nfs_pgio_data_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "549-555",
    "snippet": "void nfs_pgio_data_destroy(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->args.context)\n\t\tput_nfs_open_context(hdr->args.context);\n\tif (hdr->page_array.pagevec != hdr->page_array.page_array)\n\t\tkfree(hdr->page_array.pagevec);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "hdr->page_array.pagevec"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_nfs_open_context",
          "args": [
            "hdr->args.context"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "833-836",
          "snippet": "void put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pgio_data_destroy(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->args.context)\n\t\tput_nfs_open_context(hdr->args.context);\n\tif (hdr->page_array.pagevec != hdr->page_array.page_array)\n\t\tkfree(hdr->page_array.pagevec);\n}"
  },
  {
    "function_name": "nfs_pgio_header_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "535-538",
    "snippet": "void nfs_pgio_header_free(struct nfs_pgio_header *hdr)\n{\n\thdr->rw_ops->rw_free_header(hdr);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hdr->rw_ops->rw_free_header",
          "args": [
            "hdr"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pgio_header_free(struct nfs_pgio_header *hdr)\n{\n\thdr->rw_ops->rw_free_header(hdr);\n}"
  },
  {
    "function_name": "nfs_pgio_header_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "518-528",
    "snippet": "struct nfs_pgio_header *nfs_pgio_header_alloc(const struct nfs_rw_ops *ops)\n{\n\tstruct nfs_pgio_header *hdr = ops->rw_alloc_header();\n\n\tif (hdr) {\n\t\tINIT_LIST_HEAD(&hdr->pages);\n\t\tspin_lock_init(&hdr->lock);\n\t\thdr->rw_ops = ops;\n\t}\n\treturn hdr;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&hdr->lock"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&hdr->pages"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ops->rw_alloc_header",
          "args": [],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_header *nfs_pgio_header_alloc(const struct nfs_rw_ops *ops)\n{\n\tstruct nfs_pgio_header *hdr = ops->rw_alloc_header();\n\n\tif (hdr) {\n\t\tINIT_LIST_HEAD(&hdr->pages);\n\t\tspin_lock_init(&hdr->lock);\n\t\thdr->rw_ops = ops;\n\t}\n\treturn hdr;\n}"
  },
  {
    "function_name": "nfs_generic_pg_test",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "494-515",
    "snippet": "size_t nfs_generic_pg_test(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *prev, struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (mirror->pg_count > mirror->pg_bsize) {\n\t\t/* should never happen */\n\t\tWARN_ON_ONCE(1);\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Limit the request size so that we can still allocate a page array\n\t * for it without upsetting the slab allocator.\n\t */\n\tif (((mirror->pg_count + req->wb_bytes) >> PAGE_SHIFT) *\n\t\t\tsizeof(struct page) > PAGE_SIZE)\n\t\treturn 0;\n\n\treturn min(mirror->pg_bsize - mirror->pg_count, (size_t)req->wb_bytes);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min",
          "args": [
            "mirror->pg_bsize - mirror->pg_count",
            "(size_t)req->wb_bytes"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nsize_t nfs_generic_pg_test(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *prev, struct nfs_page *req)\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\tif (mirror->pg_count > mirror->pg_bsize) {\n\t\t/* should never happen */\n\t\tWARN_ON_ONCE(1);\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Limit the request size so that we can still allocate a page array\n\t * for it without upsetting the slab allocator.\n\t */\n\tif (((mirror->pg_count + req->wb_bytes) >> PAGE_SHIFT) *\n\t\t\tsizeof(struct page) > PAGE_SIZE)\n\t\treturn 0;\n\n\treturn min(mirror->pg_bsize - mirror->pg_count, (size_t)req->wb_bytes);\n}"
  },
  {
    "function_name": "nfs_wait_on_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "478-483",
    "snippet": "int\nnfs_wait_on_request(struct nfs_page *req)\n{\n\treturn wait_on_bit_io(&req->wb_flags, PG_BUSY,\n\t\t\t      TASK_UNINTERRUPTIBLE);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_on_bit_io",
          "args": [
            "&req->wb_flags",
            "PG_BUSY",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint\nnfs_wait_on_request(struct nfs_page *req)\n{\n\treturn wait_on_bit_io(&req->wb_flags, PG_BUSY,\n\t\t\t      TASK_UNINTERRUPTIBLE);\n}"
  },
  {
    "function_name": "nfs_release_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "466-469",
    "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&req->wb_kref",
            "nfs_page_group_destroy"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
  },
  {
    "function_name": "nfs_free_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "450-464",
    "snippet": "void nfs_free_request(struct nfs_page *req)\n{\n\tWARN_ON_ONCE(req->wb_this_page != req);\n\n\t/* extra debug: make sure no sync bits are still set */\n\tWARN_ON_ONCE(test_bit(PG_TEARDOWN, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UNLOCKPAGE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UPTODATE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_WB_END, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_REMOVE, &req->wb_flags));\n\n\t/* Release struct file and open context */\n\tnfs_clear_request(req);\n\tnfs_page_free(req);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_page_free",
          "args": [
            "req"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "98-102",
          "snippet": "static inline void\nnfs_page_free(struct nfs_page *p)\n{\n\tkmem_cache_free(nfs_page_cachep, p);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_page_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nstatic inline void\nnfs_page_free(struct nfs_page *p)\n{\n\tkmem_cache_free(nfs_page_cachep, p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_clear_request",
          "args": [
            "req"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_clear_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "423-442",
          "snippet": "static void nfs_clear_request(struct nfs_page *req)\n{\n\tstruct page *page = req->wb_page;\n\tstruct nfs_open_context *ctx = req->wb_context;\n\tstruct nfs_lock_context *l_ctx = req->wb_lock_context;\n\n\tif (page != NULL) {\n\t\tpage_cache_release(page);\n\t\treq->wb_page = NULL;\n\t}\n\tif (l_ctx != NULL) {\n\t\tnfs_iocounter_dec(&l_ctx->io_count);\n\t\tnfs_put_lock_context(l_ctx);\n\t\treq->wb_lock_context = NULL;\n\t}\n\tif (ctx != NULL) {\n\t\tput_nfs_open_context(ctx);\n\t\treq->wb_context = NULL;\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_clear_request(struct nfs_page *req)\n{\n\tstruct page *page = req->wb_page;\n\tstruct nfs_open_context *ctx = req->wb_context;\n\tstruct nfs_lock_context *l_ctx = req->wb_lock_context;\n\n\tif (page != NULL) {\n\t\tpage_cache_release(page);\n\t\treq->wb_page = NULL;\n\t}\n\tif (l_ctx != NULL) {\n\t\tnfs_iocounter_dec(&l_ctx->io_count);\n\t\tnfs_put_lock_context(l_ctx);\n\t\treq->wb_lock_context = NULL;\n\t}\n\tif (ctx != NULL) {\n\t\tput_nfs_open_context(ctx);\n\t\treq->wb_context = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "test_bit(PG_REMOVE, &req->wb_flags)"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "PG_REMOVE",
            "&req->wb_flags"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "test_bit(PG_WB_END, &req->wb_flags)"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "test_bit(PG_UPTODATE, &req->wb_flags)"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "test_bit(PG_UNLOCKPAGE, &req->wb_flags)"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "test_bit(PG_TEARDOWN, &req->wb_flags)"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "req->wb_this_page != req"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_free_request(struct nfs_page *req)\n{\n\tWARN_ON_ONCE(req->wb_this_page != req);\n\n\t/* extra debug: make sure no sync bits are still set */\n\tWARN_ON_ONCE(test_bit(PG_TEARDOWN, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UNLOCKPAGE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UPTODATE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_WB_END, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_REMOVE, &req->wb_flags));\n\n\t/* Release struct file and open context */\n\tnfs_clear_request(req);\n\tnfs_page_free(req);\n}"
  },
  {
    "function_name": "nfs_clear_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "423-442",
    "snippet": "static void nfs_clear_request(struct nfs_page *req)\n{\n\tstruct page *page = req->wb_page;\n\tstruct nfs_open_context *ctx = req->wb_context;\n\tstruct nfs_lock_context *l_ctx = req->wb_lock_context;\n\n\tif (page != NULL) {\n\t\tpage_cache_release(page);\n\t\treq->wb_page = NULL;\n\t}\n\tif (l_ctx != NULL) {\n\t\tnfs_iocounter_dec(&l_ctx->io_count);\n\t\tnfs_put_lock_context(l_ctx);\n\t\treq->wb_lock_context = NULL;\n\t}\n\tif (ctx != NULL) {\n\t\tput_nfs_open_context(ctx);\n\t\treq->wb_context = NULL;\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_nfs_open_context",
          "args": [
            "ctx"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "833-836",
          "snippet": "void put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_put_lock_context",
          "args": [
            "l_ctx"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "736-746",
          "snippet": "void nfs_put_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tstruct nfs_open_context *ctx = l_ctx->open_context;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tif (!atomic_dec_and_lock(&l_ctx->count, &inode->i_lock))\n\t\treturn;\n\tlist_del(&l_ctx->list);\n\tspin_unlock(&inode->i_lock);\n\tkfree(l_ctx);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_put_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tstruct nfs_open_context *ctx = l_ctx->open_context;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tif (!atomic_dec_and_lock(&l_ctx->count, &inode->i_lock))\n\t\treturn;\n\tlist_del(&l_ctx->list);\n\tspin_unlock(&inode->i_lock);\n\tkfree(l_ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_iocounter_dec",
          "args": [
            "&l_ctx->io_count"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_iocounter_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "110-118",
          "snippet": "static void\nnfs_iocounter_dec(struct nfs_io_counter *c)\n{\n\tif (atomic_dec_and_test(&c->io_count)) {\n\t\tclear_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tsmp_mb__after_atomic();\n\t\twake_up_bit(&c->flags, NFS_IO_INPROGRESS);\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void\nnfs_iocounter_dec(struct nfs_io_counter *c)\n{\n\tif (atomic_dec_and_test(&c->io_count)) {\n\t\tclear_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tsmp_mb__after_atomic();\n\t\twake_up_bit(&c->flags, NFS_IO_INPROGRESS);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_cache_release",
          "args": [
            "page"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void nfs_clear_request(struct nfs_page *req)\n{\n\tstruct page *page = req->wb_page;\n\tstruct nfs_open_context *ctx = req->wb_context;\n\tstruct nfs_lock_context *l_ctx = req->wb_lock_context;\n\n\tif (page != NULL) {\n\t\tpage_cache_release(page);\n\t\treq->wb_page = NULL;\n\t}\n\tif (l_ctx != NULL) {\n\t\tnfs_iocounter_dec(&l_ctx->io_count);\n\t\tnfs_put_lock_context(l_ctx);\n\t\treq->wb_lock_context = NULL;\n\t}\n\tif (ctx != NULL) {\n\t\tput_nfs_open_context(ctx);\n\t\treq->wb_context = NULL;\n\t}\n}"
  },
  {
    "function_name": "nfs_unlock_and_release_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "410-414",
    "snippet": "void nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_release_request",
          "args": [
            "req"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "466-469",
          "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_unlock_request",
          "args": [
            "req"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_unlock_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "394-404",
          "snippet": "void nfs_unlock_request(struct nfs_page *req)\n{\n\tif (!NFS_WBACK_BUSY(req)) {\n\t\tprintk(KERN_ERR \"NFS: Invalid unlock attempted\\n\");\n\t\tBUG();\n\t}\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_BUSY, &req->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&req->wb_flags, PG_BUSY);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_request(struct nfs_page *req)\n{\n\tif (!NFS_WBACK_BUSY(req)) {\n\t\tprintk(KERN_ERR \"NFS: Invalid unlock attempted\\n\");\n\t\tBUG();\n\t}\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_BUSY, &req->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&req->wb_flags, PG_BUSY);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}"
  },
  {
    "function_name": "nfs_unlock_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "394-404",
    "snippet": "void nfs_unlock_request(struct nfs_page *req)\n{\n\tif (!NFS_WBACK_BUSY(req)) {\n\t\tprintk(KERN_ERR \"NFS: Invalid unlock attempted\\n\");\n\t\tBUG();\n\t}\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_BUSY, &req->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&req->wb_flags, PG_BUSY);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_bit",
          "args": [
            "&req->wb_flags",
            "PG_BUSY"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "PG_BUSY",
            "&req->wb_flags"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_mb__before_atomic",
          "args": [],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"NFS: Invalid unlock attempted\\n\""
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_WBACK_BUSY",
          "args": [
            "req"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_request(struct nfs_page *req)\n{\n\tif (!NFS_WBACK_BUSY(req)) {\n\t\tprintk(KERN_ERR \"NFS: Invalid unlock attempted\\n\");\n\t\tBUG();\n\t}\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_BUSY, &req->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&req->wb_flags, PG_BUSY);\n}"
  },
  {
    "function_name": "nfs_create_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "351-388",
    "snippet": "struct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_page_group_init",
          "args": [
            "req",
            "last"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "272-306",
          "snippet": "static inline void\nnfs_page_group_init(struct nfs_page *req, struct nfs_page *prev)\n{\n\tstruct inode *inode;\n\tWARN_ON_ONCE(prev == req);\n\n\tif (!prev) {\n\t\t/* a head request */\n\t\treq->wb_head = req;\n\t\treq->wb_this_page = req;\n\t} else {\n\t\t/* a subrequest */\n\t\tWARN_ON_ONCE(prev->wb_this_page != prev->wb_head);\n\t\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &prev->wb_head->wb_flags));\n\t\treq->wb_head = prev->wb_head;\n\t\treq->wb_this_page = prev->wb_this_page;\n\t\tprev->wb_this_page = req;\n\n\t\t/* All subrequests take a ref on the head request until\n\t\t * nfs_page_group_destroy is called */\n\t\tkref_get(&req->wb_head->wb_kref);\n\n\t\t/* grab extra ref and bump the request count if head request\n\t\t * has extra ref from the write/commit path to handle handoff\n\t\t * between write and commit lists. */\n\t\tif (test_bit(PG_INODE_REF, &prev->wb_head->wb_flags)) {\n\t\t\tinode = page_file_mapping(req->wb_page)->host;\n\t\t\tset_bit(PG_INODE_REF, &req->wb_flags);\n\t\t\tkref_get(&req->wb_kref);\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tNFS_I(inode)->nrequests++;\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic inline void\nnfs_page_group_init(struct nfs_page *req, struct nfs_page *prev)\n{\n\tstruct inode *inode;\n\tWARN_ON_ONCE(prev == req);\n\n\tif (!prev) {\n\t\t/* a head request */\n\t\treq->wb_head = req;\n\t\treq->wb_this_page = req;\n\t} else {\n\t\t/* a subrequest */\n\t\tWARN_ON_ONCE(prev->wb_this_page != prev->wb_head);\n\t\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &prev->wb_head->wb_flags));\n\t\treq->wb_head = prev->wb_head;\n\t\treq->wb_this_page = prev->wb_this_page;\n\t\tprev->wb_this_page = req;\n\n\t\t/* All subrequests take a ref on the head request until\n\t\t * nfs_page_group_destroy is called */\n\t\tkref_get(&req->wb_head->wb_kref);\n\n\t\t/* grab extra ref and bump the request count if head request\n\t\t * has extra ref from the write/commit path to handle handoff\n\t\t * between write and commit lists. */\n\t\tif (test_bit(PG_INODE_REF, &prev->wb_head->wb_flags)) {\n\t\t\tinode = page_file_mapping(req->wb_page)->host;\n\t\t\tset_bit(PG_INODE_REF, &req->wb_flags);\n\t\t\tkref_get(&req->wb_kref);\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tNFS_I(inode)->nrequests++;\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kref_init",
          "args": [
            "&req->wb_kref"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_nfs_open_context",
          "args": [
            "ctx"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "803-808",
          "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_cache_get",
          "args": [
            "page"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_file_index",
          "args": [
            "page"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_iocounter_inc",
          "args": [
            "&l_ctx->io_count"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_iocounter_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "104-108",
          "snippet": "static void\nnfs_iocounter_inc(struct nfs_io_counter *c)\n{\n\tatomic_inc(&c->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void\nnfs_iocounter_inc(struct nfs_io_counter *c)\n{\n\tatomic_inc(&c->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "l_ctx"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_page_free",
          "args": [
            "req"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "98-102",
          "snippet": "static inline void\nnfs_page_free(struct nfs_page *p)\n{\n\tkmem_cache_free(nfs_page_cachep, p);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_page_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nstatic inline void\nnfs_page_free(struct nfs_page *p)\n{\n\tkmem_cache_free(nfs_page_cachep, p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "l_ctx"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_lock_context",
          "args": [
            "ctx"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "708-733",
          "snippet": "struct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstruct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_page_alloc",
          "args": [],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "89-96",
          "snippet": "static inline struct nfs_page *\nnfs_page_alloc(void)\n{\n\tstruct nfs_page\t*p = kmem_cache_zalloc(nfs_page_cachep, GFP_NOIO);\n\tif (p)\n\t\tINIT_LIST_HEAD(&p->wb_list);\n\treturn p;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_page_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nstatic inline struct nfs_page *\nnfs_page_alloc(void)\n{\n\tstruct nfs_page\t*p = kmem_cache_zalloc(nfs_page_cachep, GFP_NOIO);\n\tif (p)\n\t\tINIT_LIST_HEAD(&p->wb_list);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EBADF"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_CONTEXT_BAD",
            "&ctx->flags"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}"
  },
  {
    "function_name": "nfs_page_group_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "315-337",
    "snippet": "static void\nnfs_page_group_destroy(struct kref *kref)\n{\n\tstruct nfs_page *req = container_of(kref, struct nfs_page, wb_kref);\n\tstruct nfs_page *tmp, *next;\n\n\t/* subrequests must release the ref on the head request */\n\tif (req->wb_head != req)\n\t\tnfs_release_request(req->wb_head);\n\n\tif (!nfs_page_group_sync_on_bit(req, PG_TEARDOWN))\n\t\treturn;\n\n\ttmp = req;\n\tdo {\n\t\tnext = tmp->wb_this_page;\n\t\t/* unlink and free */\n\t\ttmp->wb_this_page = tmp;\n\t\ttmp->wb_head = tmp;\n\t\tnfs_free_request(tmp);\n\t\ttmp = next;\n\t} while (tmp != req);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_request",
          "args": [
            "tmp"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "450-464",
          "snippet": "void nfs_free_request(struct nfs_page *req)\n{\n\tWARN_ON_ONCE(req->wb_this_page != req);\n\n\t/* extra debug: make sure no sync bits are still set */\n\tWARN_ON_ONCE(test_bit(PG_TEARDOWN, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UNLOCKPAGE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UPTODATE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_WB_END, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_REMOVE, &req->wb_flags));\n\n\t/* Release struct file and open context */\n\tnfs_clear_request(req);\n\tnfs_page_free(req);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_free_request(struct nfs_page *req)\n{\n\tWARN_ON_ONCE(req->wb_this_page != req);\n\n\t/* extra debug: make sure no sync bits are still set */\n\tWARN_ON_ONCE(test_bit(PG_TEARDOWN, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UNLOCKPAGE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_UPTODATE, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_WB_END, &req->wb_flags));\n\tWARN_ON_ONCE(test_bit(PG_REMOVE, &req->wb_flags));\n\n\t/* Release struct file and open context */\n\tnfs_clear_request(req);\n\tnfs_page_free(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_page_group_sync_on_bit",
          "args": [
            "req",
            "PG_TEARDOWN"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_sync_on_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "255-264",
          "snippet": "bool nfs_page_group_sync_on_bit(struct nfs_page *req, unsigned int bit)\n{\n\tbool ret;\n\n\tnfs_page_group_lock(req, false);\n\tret = nfs_page_group_sync_on_bit_locked(req, bit);\n\tnfs_page_group_unlock(req);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nbool nfs_page_group_sync_on_bit(struct nfs_page *req, unsigned int bit)\n{\n\tbool ret;\n\n\tnfs_page_group_lock(req, false);\n\tret = nfs_page_group_sync_on_bit_locked(req, bit);\n\tnfs_page_group_unlock(req);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_release_request",
          "args": [
            "req->wb_head"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "466-469",
          "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kref",
            "structnfs_page",
            "wb_kref"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void\nnfs_page_group_destroy(struct kref *kref)\n{\n\tstruct nfs_page *req = container_of(kref, struct nfs_page, wb_kref);\n\tstruct nfs_page *tmp, *next;\n\n\t/* subrequests must release the ref on the head request */\n\tif (req->wb_head != req)\n\t\tnfs_release_request(req->wb_head);\n\n\tif (!nfs_page_group_sync_on_bit(req, PG_TEARDOWN))\n\t\treturn;\n\n\ttmp = req;\n\tdo {\n\t\tnext = tmp->wb_this_page;\n\t\t/* unlink and free */\n\t\ttmp->wb_this_page = tmp;\n\t\ttmp->wb_head = tmp;\n\t\tnfs_free_request(tmp);\n\t\ttmp = next;\n\t} while (tmp != req);\n}"
  },
  {
    "function_name": "nfs_page_group_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "272-306",
    "snippet": "static inline void\nnfs_page_group_init(struct nfs_page *req, struct nfs_page *prev)\n{\n\tstruct inode *inode;\n\tWARN_ON_ONCE(prev == req);\n\n\tif (!prev) {\n\t\t/* a head request */\n\t\treq->wb_head = req;\n\t\treq->wb_this_page = req;\n\t} else {\n\t\t/* a subrequest */\n\t\tWARN_ON_ONCE(prev->wb_this_page != prev->wb_head);\n\t\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &prev->wb_head->wb_flags));\n\t\treq->wb_head = prev->wb_head;\n\t\treq->wb_this_page = prev->wb_this_page;\n\t\tprev->wb_this_page = req;\n\n\t\t/* All subrequests take a ref on the head request until\n\t\t * nfs_page_group_destroy is called */\n\t\tkref_get(&req->wb_head->wb_kref);\n\n\t\t/* grab extra ref and bump the request count if head request\n\t\t * has extra ref from the write/commit path to handle handoff\n\t\t * between write and commit lists. */\n\t\tif (test_bit(PG_INODE_REF, &prev->wb_head->wb_flags)) {\n\t\t\tinode = page_file_mapping(req->wb_page)->host;\n\t\t\tset_bit(PG_INODE_REF, &req->wb_flags);\n\t\t\tkref_get(&req->wb_kref);\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tNFS_I(inode)->nrequests++;\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&req->wb_kref"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "PG_INODE_REF",
            "&req->wb_flags"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_file_mapping",
          "args": [
            "req->wb_page"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "PG_INODE_REF",
            "&prev->wb_head->wb_flags"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&req->wb_head->wb_kref"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!test_bit(PG_HEADLOCK, &prev->wb_head->wb_flags)"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "prev->wb_this_page != prev->wb_head"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "prev == req"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic inline void\nnfs_page_group_init(struct nfs_page *req, struct nfs_page *prev)\n{\n\tstruct inode *inode;\n\tWARN_ON_ONCE(prev == req);\n\n\tif (!prev) {\n\t\t/* a head request */\n\t\treq->wb_head = req;\n\t\treq->wb_this_page = req;\n\t} else {\n\t\t/* a subrequest */\n\t\tWARN_ON_ONCE(prev->wb_this_page != prev->wb_head);\n\t\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &prev->wb_head->wb_flags));\n\t\treq->wb_head = prev->wb_head;\n\t\treq->wb_this_page = prev->wb_this_page;\n\t\tprev->wb_this_page = req;\n\n\t\t/* All subrequests take a ref on the head request until\n\t\t * nfs_page_group_destroy is called */\n\t\tkref_get(&req->wb_head->wb_kref);\n\n\t\t/* grab extra ref and bump the request count if head request\n\t\t * has extra ref from the write/commit path to handle handoff\n\t\t * between write and commit lists. */\n\t\tif (test_bit(PG_INODE_REF, &prev->wb_head->wb_flags)) {\n\t\t\tinode = page_file_mapping(req->wb_page)->host;\n\t\t\tset_bit(PG_INODE_REF, &req->wb_flags);\n\t\t\tkref_get(&req->wb_kref);\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tNFS_I(inode)->nrequests++;\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "nfs_page_group_sync_on_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "255-264",
    "snippet": "bool nfs_page_group_sync_on_bit(struct nfs_page *req, unsigned int bit)\n{\n\tbool ret;\n\n\tnfs_page_group_lock(req, false);\n\tret = nfs_page_group_sync_on_bit_locked(req, bit);\n\tnfs_page_group_unlock(req);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_page_group_unlock",
          "args": [
            "req"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "205-216",
          "snippet": "void\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_page_group_sync_on_bit_locked",
          "args": [
            "req",
            "bit"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_sync_on_bit_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "223-247",
          "snippet": "static bool\nnfs_page_group_sync_on_bit_locked(struct nfs_page *req, unsigned int bit)\n{\n\tstruct nfs_page *head = req->wb_head;\n\tstruct nfs_page *tmp;\n\n\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &head->wb_flags));\n\tWARN_ON_ONCE(test_and_set_bit(bit, &req->wb_flags));\n\n\ttmp = req->wb_this_page;\n\twhile (tmp != req) {\n\t\tif (!test_bit(bit, &tmp->wb_flags))\n\t\t\treturn false;\n\t\ttmp = tmp->wb_this_page;\n\t}\n\n\t/* true! reset all bits */\n\ttmp = req;\n\tdo {\n\t\tclear_bit(bit, &tmp->wb_flags);\n\t\ttmp = tmp->wb_this_page;\n\t} while (tmp != req);\n\n\treturn true;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool\nnfs_page_group_sync_on_bit_locked(struct nfs_page *req, unsigned int bit)\n{\n\tstruct nfs_page *head = req->wb_head;\n\tstruct nfs_page *tmp;\n\n\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &head->wb_flags));\n\tWARN_ON_ONCE(test_and_set_bit(bit, &req->wb_flags));\n\n\ttmp = req->wb_this_page;\n\twhile (tmp != req) {\n\t\tif (!test_bit(bit, &tmp->wb_flags))\n\t\t\treturn false;\n\t\ttmp = tmp->wb_this_page;\n\t}\n\n\t/* true! reset all bits */\n\ttmp = req;\n\tdo {\n\t\tclear_bit(bit, &tmp->wb_flags);\n\t\ttmp = tmp->wb_this_page;\n\t} while (tmp != req);\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_page_group_lock",
          "args": [
            "req",
            "false"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_page_group_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "167-182",
          "snippet": "int\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nbool nfs_page_group_sync_on_bit(struct nfs_page *req, unsigned int bit)\n{\n\tbool ret;\n\n\tnfs_page_group_lock(req, false);\n\tret = nfs_page_group_sync_on_bit_locked(req, bit);\n\tnfs_page_group_unlock(req);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_page_group_sync_on_bit_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "223-247",
    "snippet": "static bool\nnfs_page_group_sync_on_bit_locked(struct nfs_page *req, unsigned int bit)\n{\n\tstruct nfs_page *head = req->wb_head;\n\tstruct nfs_page *tmp;\n\n\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &head->wb_flags));\n\tWARN_ON_ONCE(test_and_set_bit(bit, &req->wb_flags));\n\n\ttmp = req->wb_this_page;\n\twhile (tmp != req) {\n\t\tif (!test_bit(bit, &tmp->wb_flags))\n\t\t\treturn false;\n\t\ttmp = tmp->wb_this_page;\n\t}\n\n\t/* true! reset all bits */\n\ttmp = req;\n\tdo {\n\t\tclear_bit(bit, &tmp->wb_flags);\n\t\ttmp = tmp->wb_this_page;\n\t} while (tmp != req);\n\n\treturn true;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "bit",
            "&tmp->wb_flags"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "bit",
            "&tmp->wb_flags"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "test_and_set_bit(bit, &req->wb_flags)"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "bit",
            "&req->wb_flags"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!test_bit(PG_HEADLOCK, &head->wb_flags)"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool\nnfs_page_group_sync_on_bit_locked(struct nfs_page *req, unsigned int bit)\n{\n\tstruct nfs_page *head = req->wb_head;\n\tstruct nfs_page *tmp;\n\n\tWARN_ON_ONCE(!test_bit(PG_HEADLOCK, &head->wb_flags));\n\tWARN_ON_ONCE(test_and_set_bit(bit, &req->wb_flags));\n\n\ttmp = req->wb_this_page;\n\twhile (tmp != req) {\n\t\tif (!test_bit(bit, &tmp->wb_flags))\n\t\t\treturn false;\n\t\ttmp = tmp->wb_this_page;\n\t}\n\n\t/* true! reset all bits */\n\ttmp = req;\n\tdo {\n\t\tclear_bit(bit, &tmp->wb_flags);\n\t\ttmp = tmp->wb_this_page;\n\t} while (tmp != req);\n\n\treturn true;\n}"
  },
  {
    "function_name": "nfs_page_group_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "205-216",
    "snippet": "void\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_bit",
          "args": [
            "&head->wb_flags",
            "PG_HEADLOCK"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "PG_HEADLOCK",
            "&head->wb_flags"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_mb__before_atomic",
          "args": [],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "head != head->wb_head"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid\nnfs_page_group_unlock(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tsmp_mb__before_atomic();\n\tclear_bit(PG_HEADLOCK, &head->wb_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&head->wb_flags, PG_HEADLOCK);\n}"
  },
  {
    "function_name": "nfs_page_group_lock_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "190-199",
    "snippet": "void\nnfs_page_group_lock_wait(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\twait_on_bit(&head->wb_flags, PG_HEADLOCK,\n\t\tTASK_UNINTERRUPTIBLE);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_on_bit",
          "args": [
            "&head->wb_flags",
            "PG_HEADLOCK",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "head != head->wb_head"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid\nnfs_page_group_lock_wait(struct nfs_page *req)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\twait_on_bit(&head->wb_flags, PG_HEADLOCK,\n\t\tTASK_UNINTERRUPTIBLE);\n}"
  },
  {
    "function_name": "nfs_page_group_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "167-182",
    "snippet": "int\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_on_bit_lock",
          "args": [
            "&head->wb_flags",
            "PG_HEADLOCK",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "PG_HEADLOCK",
            "&head->wb_flags"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "head != head->wb_head"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint\nnfs_page_group_lock(struct nfs_page *req, bool nonblock)\n{\n\tstruct nfs_page *head = req->wb_head;\n\n\tWARN_ON_ONCE(head != head->wb_head);\n\n\tif (!test_and_set_bit(PG_HEADLOCK, &head->wb_flags))\n\t\treturn 0;\n\n\tif (!nonblock)\n\t\treturn wait_on_bit_lock(&head->wb_flags, PG_HEADLOCK,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\n\treturn -EAGAIN;\n}"
  },
  {
    "function_name": "nfs_iocounter_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "145-151",
    "snippet": "int\nnfs_iocounter_wait(struct nfs_io_counter *c)\n{\n\tif (atomic_read(&c->io_count) == 0)\n\t\treturn 0;\n\treturn __nfs_iocounter_wait(c);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_iocounter_wait",
          "args": [
            "c"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_iocounter_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "120-136",
          "snippet": "static int\n__nfs_iocounter_wait(struct nfs_io_counter *c)\n{\n\twait_queue_head_t *wq = bit_waitqueue(&c->flags, NFS_IO_INPROGRESS);\n\tDEFINE_WAIT_BIT(q, &c->flags, NFS_IO_INPROGRESS);\n\tint ret = 0;\n\n\tdo {\n\t\tprepare_to_wait(wq, &q.wait, TASK_KILLABLE);\n\t\tset_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tif (atomic_read(&c->io_count) == 0)\n\t\t\tbreak;\n\t\tret = nfs_wait_bit_killable(&q.key);\n\t} while (atomic_read(&c->io_count) != 0 && !ret);\n\tfinish_wait(wq, &q.wait);\n\treturn ret;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int\n__nfs_iocounter_wait(struct nfs_io_counter *c)\n{\n\twait_queue_head_t *wq = bit_waitqueue(&c->flags, NFS_IO_INPROGRESS);\n\tDEFINE_WAIT_BIT(q, &c->flags, NFS_IO_INPROGRESS);\n\tint ret = 0;\n\n\tdo {\n\t\tprepare_to_wait(wq, &q.wait, TASK_KILLABLE);\n\t\tset_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tif (atomic_read(&c->io_count) == 0)\n\t\t\tbreak;\n\t\tret = nfs_wait_bit_killable(&q.key);\n\t} while (atomic_read(&c->io_count) != 0 && !ret);\n\tfinish_wait(wq, &q.wait);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&c->io_count"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint\nnfs_iocounter_wait(struct nfs_io_counter *c)\n{\n\tif (atomic_read(&c->io_count) == 0)\n\t\treturn 0;\n\treturn __nfs_iocounter_wait(c);\n}"
  },
  {
    "function_name": "__nfs_iocounter_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "120-136",
    "snippet": "static int\n__nfs_iocounter_wait(struct nfs_io_counter *c)\n{\n\twait_queue_head_t *wq = bit_waitqueue(&c->flags, NFS_IO_INPROGRESS);\n\tDEFINE_WAIT_BIT(q, &c->flags, NFS_IO_INPROGRESS);\n\tint ret = 0;\n\n\tdo {\n\t\tprepare_to_wait(wq, &q.wait, TASK_KILLABLE);\n\t\tset_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tif (atomic_read(&c->io_count) == 0)\n\t\t\tbreak;\n\t\tret = nfs_wait_bit_killable(&q.key);\n\t} while (atomic_read(&c->io_count) != 0 && !ret);\n\tfinish_wait(wq, &q.wait);\n\treturn ret;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "finish_wait",
          "args": [
            "wq",
            "&q.wait"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&c->io_count"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_wait_bit_killable",
          "args": [
            "&q.key"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wait_bit_killable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "78-84",
          "snippet": "int nfs_wait_bit_killable(struct wait_bit_key *key)\n{\n\tif (fatal_signal_pending(current))\n\t\treturn -ERESTARTSYS;\n\tfreezable_schedule_unsafe();\n\treturn 0;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_wait_bit_killable(struct wait_bit_key *key)\n{\n\tif (fatal_signal_pending(current))\n\t\treturn -ERESTARTSYS;\n\tfreezable_schedule_unsafe();\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&c->io_count"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_IO_INPROGRESS",
            "&c->flags"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prepare_to_wait",
          "args": [
            "wq",
            "&q.wait",
            "TASK_KILLABLE"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEFINE_WAIT_BIT",
          "args": [
            "q",
            "&c->flags",
            "NFS_IO_INPROGRESS"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_waitqueue",
          "args": [
            "&c->flags",
            "NFS_IO_INPROGRESS"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int\n__nfs_iocounter_wait(struct nfs_io_counter *c)\n{\n\twait_queue_head_t *wq = bit_waitqueue(&c->flags, NFS_IO_INPROGRESS);\n\tDEFINE_WAIT_BIT(q, &c->flags, NFS_IO_INPROGRESS);\n\tint ret = 0;\n\n\tdo {\n\t\tprepare_to_wait(wq, &q.wait, TASK_KILLABLE);\n\t\tset_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tif (atomic_read(&c->io_count) == 0)\n\t\t\tbreak;\n\t\tret = nfs_wait_bit_killable(&q.key);\n\t} while (atomic_read(&c->io_count) != 0 && !ret);\n\tfinish_wait(wq, &q.wait);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_iocounter_dec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "110-118",
    "snippet": "static void\nnfs_iocounter_dec(struct nfs_io_counter *c)\n{\n\tif (atomic_dec_and_test(&c->io_count)) {\n\t\tclear_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tsmp_mb__after_atomic();\n\t\twake_up_bit(&c->flags, NFS_IO_INPROGRESS);\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_bit",
          "args": [
            "&c->flags",
            "NFS_IO_INPROGRESS"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "NFS_IO_INPROGRESS",
            "&c->flags"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&c->io_count"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void\nnfs_iocounter_dec(struct nfs_io_counter *c)\n{\n\tif (atomic_dec_and_test(&c->io_count)) {\n\t\tclear_bit(NFS_IO_INPROGRESS, &c->flags);\n\t\tsmp_mb__after_atomic();\n\t\twake_up_bit(&c->flags, NFS_IO_INPROGRESS);\n\t}\n}"
  },
  {
    "function_name": "nfs_iocounter_inc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "104-108",
    "snippet": "static void\nnfs_iocounter_inc(struct nfs_io_counter *c)\n{\n\tatomic_inc(&c->io_count);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&c->io_count"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic void\nnfs_iocounter_inc(struct nfs_io_counter *c)\n{\n\tatomic_inc(&c->io_count);\n}"
  },
  {
    "function_name": "nfs_page_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "98-102",
    "snippet": "static inline void\nnfs_page_free(struct nfs_page *p)\n{\n\tkmem_cache_free(nfs_page_cachep, p);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_page_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "nfs_page_cachep",
            "p"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nstatic inline void\nnfs_page_free(struct nfs_page *p)\n{\n\tkmem_cache_free(nfs_page_cachep, p);\n}"
  },
  {
    "function_name": "nfs_page_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "89-96",
    "snippet": "static inline struct nfs_page *\nnfs_page_alloc(void)\n{\n\tstruct nfs_page\t*p = kmem_cache_zalloc(nfs_page_cachep, GFP_NOIO);\n\tif (p)\n\t\tINIT_LIST_HEAD(&p->wb_list);\n\treturn p;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_page_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&p->wb_list"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_zalloc",
          "args": [
            "nfs_page_cachep",
            "GFP_NOIO"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nstatic inline struct nfs_page *\nnfs_page_alloc(void)\n{\n\tstruct nfs_page\t*p = kmem_cache_zalloc(nfs_page_cachep, GFP_NOIO);\n\tif (p)\n\t\tINIT_LIST_HEAD(&p->wb_list);\n\treturn p;\n}"
  },
  {
    "function_name": "nfs_set_pgio_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "77-87",
    "snippet": "void nfs_set_pgio_error(struct nfs_pgio_header *hdr, int error, loff_t pos)\n{\n\tspin_lock(&hdr->lock);\n\tif (pos < hdr->io_start + hdr->good_bytes) {\n\t\tset_bit(NFS_IOHDR_ERROR, &hdr->flags);\n\t\tclear_bit(NFS_IOHDR_EOF, &hdr->flags);\n\t\thdr->good_bytes = pos - hdr->io_start;\n\t\thdr->error = error;\n\t}\n\tspin_unlock(&hdr->lock);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&hdr->lock"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "NFS_IOHDR_EOF",
            "&hdr->flags"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_IOHDR_ERROR",
            "&hdr->flags"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&hdr->lock"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_set_pgio_error(struct nfs_pgio_header *hdr, int error, loff_t pos)\n{\n\tspin_lock(&hdr->lock);\n\tif (pos < hdr->io_start + hdr->good_bytes) {\n\t\tset_bit(NFS_IOHDR_ERROR, &hdr->flags);\n\t\tclear_bit(NFS_IOHDR_EOF, &hdr->flags);\n\t\thdr->good_bytes = pos - hdr->io_start;\n\t\thdr->error = error;\n\t}\n\tspin_unlock(&hdr->lock);\n}"
  },
  {
    "function_name": "nfs_pgheader_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "54-74",
    "snippet": "void nfs_pgheader_init(struct nfs_pageio_descriptor *desc,\n\t\t       struct nfs_pgio_header *hdr,\n\t\t       void (*release)(struct nfs_pgio_header *hdr))\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\thdr->req = nfs_list_entry(mirror->pg_list.next);\n\thdr->inode = desc->pg_inode;\n\thdr->cred = hdr->req->wb_context->cred;\n\thdr->io_start = req_offset(hdr->req);\n\thdr->good_bytes = mirror->pg_count;\n\thdr->dreq = desc->pg_dreq;\n\thdr->layout_private = desc->pg_layout_private;\n\thdr->release = release;\n\thdr->completion_ops = desc->pg_completion_ops;\n\tif (hdr->completion_ops->init_hdr)\n\t\thdr->completion_ops->init_hdr(hdr);\n\n\thdr->pgio_mirror_idx = desc->pg_mirror_idx;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hdr->completion_ops->init_hdr",
          "args": [
            "hdr"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "req_offset",
          "args": [
            "hdr->req"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "mirror->pg_list.next"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pgio_current_mirror",
          "args": [
            "desc"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_current_mirror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "45-51",
          "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pgheader_init(struct nfs_pageio_descriptor *desc,\n\t\t       struct nfs_pgio_header *hdr,\n\t\t       void (*release)(struct nfs_pgio_header *hdr))\n{\n\tstruct nfs_pgio_mirror *mirror = nfs_pgio_current_mirror(desc);\n\n\n\thdr->req = nfs_list_entry(mirror->pg_list.next);\n\thdr->inode = desc->pg_inode;\n\thdr->cred = hdr->req->wb_context->cred;\n\thdr->io_start = req_offset(hdr->req);\n\thdr->good_bytes = mirror->pg_count;\n\thdr->dreq = desc->pg_dreq;\n\thdr->layout_private = desc->pg_layout_private;\n\thdr->release = release;\n\thdr->completion_ops = desc->pg_completion_ops;\n\tif (hdr->completion_ops->init_hdr)\n\t\thdr->completion_ops->init_hdr(hdr);\n\n\thdr->pgio_mirror_idx = desc->pg_mirror_idx;\n}"
  },
  {
    "function_name": "nfs_pgio_current_mirror",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "45-51",
    "snippet": "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_pgio_has_mirroring",
          "args": [
            "desc"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pgio_has_mirroring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "265-269",
          "snippet": "static inline bool nfs_pgio_has_mirroring(struct nfs_pageio_descriptor *desc)\n{\n\tWARN_ON_ONCE(desc->pg_mirror_count < 1);\n\treturn desc->pg_mirror_count > 1;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "struct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc);\n\nstatic inline bool nfs_pgio_has_mirroring(struct nfs_pageio_descriptor *desc)\n{\n\tWARN_ON_ONCE(desc->pg_mirror_count < 1);\n\treturn desc->pg_mirror_count > 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_pgio_mirror *\nnfs_pgio_current_mirror(struct nfs_pageio_descriptor *desc)\n{\n\treturn nfs_pgio_has_mirroring(desc) ?\n\t\t&desc->pg_mirrors[desc->pg_mirror_idx] :\n\t\t&desc->pg_mirrors[0];\n}"
  },
  {
    "function_name": "nfs_pgarray_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
    "lines": "32-43",
    "snippet": "static bool nfs_pgarray_set(struct nfs_page_array *p, unsigned int pagecount)\n{\n\tp->npages = pagecount;\n\tif (pagecount <= ARRAY_SIZE(p->page_array))\n\t\tp->pagevec = p->page_array;\n\telse {\n\t\tp->pagevec = kcalloc(pagecount, sizeof(struct page *), GFP_KERNEL);\n\t\tif (!p->pagevec)\n\t\t\tp->npages = 0;\n\t}\n\treturn p->pagevec != NULL;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"internal.h\"",
      "#include <linux/export.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sched.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "pagecount",
            "sizeof(struct page *)",
            "GFP_KERNEL"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "p->page_array"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic bool nfs_pgarray_set(struct nfs_page_array *p, unsigned int pagecount)\n{\n\tp->npages = pagecount;\n\tif (pagecount <= ARRAY_SIZE(p->page_array))\n\t\tp->pagevec = p->page_array;\n\telse {\n\t\tp->pagevec = kcalloc(pagecount, sizeof(struct page *), GFP_KERNEL);\n\t\tif (!p->pagevec)\n\t\t\tp->npages = 0;\n\t}\n\treturn p->pagevec != NULL;\n}"
  }
]