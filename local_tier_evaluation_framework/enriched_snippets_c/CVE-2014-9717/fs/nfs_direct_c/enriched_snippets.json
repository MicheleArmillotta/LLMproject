[
  {
    "function_name": "nfs_destroy_directcache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "1078-1081",
    "snippet": "void nfs_destroy_directcache(void)\n{\n\tkmem_cache_destroy(nfs_direct_cachep);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_direct_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "nfs_direct_cachep"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\n\nvoid nfs_destroy_directcache(void)\n{\n\tkmem_cache_destroy(nfs_direct_cachep);\n}"
  },
  {
    "function_name": "nfs_init_directcache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "1061-1072",
    "snippet": "int __init nfs_init_directcache(void)\n{\n\tnfs_direct_cachep = kmem_cache_create(\"nfs_direct_cache\",\n\t\t\t\t\t\tsizeof(struct nfs_direct_req),\n\t\t\t\t\t\t0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t\tNULL);\n\tif (nfs_direct_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_direct_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"nfs_direct_cache\"",
            "sizeof(struct nfs_direct_req)",
            "0",
            "(SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\t\tSLAB_MEM_SPREAD)",
            "NULL"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\n\nint __init nfs_init_directcache(void)\n{\n\tnfs_direct_cachep = kmem_cache_create(\"nfs_direct_cache\",\n\t\t\t\t\t\tsizeof(struct nfs_direct_req),\n\t\t\t\t\t\t0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t\tNULL);\n\tif (nfs_direct_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_file_direct_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "963-1055",
    "snippet": "ssize_t nfs_file_direct_write(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tssize_t result = -EINVAL;\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tloff_t end;\n\tsize_t count = iov_iter_count(iter);\n\tend = (pos + count - 1) >> PAGE_CACHE_SHIFT;\n\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTWRITTENBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct write(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = generic_write_checks(file, &pos, &count, 0);\n\tif (result)\n\t\tgoto out;\n\n\tresult = -EINVAL;\n\tif ((ssize_t) count < 0)\n\t\tgoto out;\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\tif (mapping->nrpages) {\n\t\tresult = invalidate_inode_pages2_range(mapping,\n\t\t\t\t\tpos >> PAGE_CACHE_SHIFT, end);\n\t\tif (result)\n\t\t\tgoto out_unlock;\n\t}\n\n\ttask_io_account_write(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (!dreq)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tresult = nfs_direct_write_schedule_iovec(dreq, iter, pos);\n\n\tif (mapping->nrpages) {\n\t\tinvalidate_inode_pages2_range(mapping,\n\t\t\t\t\t      pos >> PAGE_CACHE_SHIFT, end);\n\t}\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0) {\n\t\t\tstruct inode *inode = mapping->host;\n\n\t\t\tiocb->ki_pos = pos + result;\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tif (i_size_read(inode) < iocb->ki_pos)\n\t\t\t\ti_size_write(inode, iocb->ki_pos);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_req_release",
          "args": [
            "dreq"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_req_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "337-340",
          "snippet": "static void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1043
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "iocb->ki_pos"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_wait",
          "args": [
            "dreq"
          ],
          "line": 1035
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "351-368",
          "snippet": "static ssize_t nfs_direct_wait(struct nfs_direct_req *dreq)\n{\n\tssize_t result = -EIOCBQUEUED;\n\n\t/* Async requests don't wait here */\n\tif (dreq->iocb)\n\t\tgoto out;\n\n\tresult = wait_for_completion_killable(&dreq->completion);\n\n\tif (!result)\n\t\tresult = dreq->error;\n\tif (!result)\n\t\tresult = dreq->count;\n\nout:\n\treturn (ssize_t) result;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic ssize_t nfs_direct_wait(struct nfs_direct_req *dreq)\n{\n\tssize_t result = -EIOCBQUEUED;\n\n\t/* Async requests don't wait here */\n\tif (dreq->iocb)\n\t\tgoto out;\n\n\tresult = wait_for_completion_killable(&dreq->completion);\n\n\tif (!result)\n\t\tresult = dreq->error;\n\tif (!result)\n\t\tresult = dreq->count;\n\nout:\n\treturn (ssize_t) result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "invalidate_inode_pages2_range",
          "args": [
            "mapping",
            "pos >> PAGE_CACHE_SHIFT",
            "end"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_write_schedule_iovec",
          "args": [
            "dreq",
            "iter",
            "pos"
          ],
          "line": 1025
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_schedule_iovec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "862-940",
          "snippet": "static ssize_t nfs_direct_write_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t       struct iov_iter *iter,\n\t\t\t\t\t       loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = 0;\n\tsize_t requested_bytes = 0;\n\tsize_t wsize = max_t(size_t, NFS_SERVER(inode)->wsize, PAGE_SIZE);\n\n\tnfs_pageio_init_write(&desc, inode, FLUSH_COND_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\tget_dreq(dreq);\n\tatomic_inc(&inode->i_dio_count);\n\n\tNFS_I(inode)->write_io += iov_iter_count(iter);\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  wsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\t\t\tnfs_lock_request(req);\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_unlock_and_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;",
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};\n\nstatic ssize_t nfs_direct_write_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t       struct iov_iter *iter,\n\t\t\t\t\t       loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = 0;\n\tsize_t requested_bytes = 0;\n\tsize_t wsize = max_t(size_t, NFS_SERVER(inode)->wsize, PAGE_SIZE);\n\n\tnfs_pageio_init_write(&desc, inode, FLUSH_COND_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\tget_dreq(dreq);\n\tatomic_inc(&inode->i_dio_count);\n\n\tNFS_I(inode)->write_io += iov_iter_count(iter);\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  wsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\t\t\tnfs_lock_request(req);\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_unlock_and_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_sync_kiocb",
          "args": [
            "iocb"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "l_ctx"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "l_ctx"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_lock_context",
          "args": [
            "dreq->ctx"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "708-733",
          "snippet": "struct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstruct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_nfs_open_context",
          "args": [
            "nfs_file_open_context(iocb->ki_filp)"
          ],
          "line": 1015
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "803-808",
          "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_open_context",
          "args": [
            "iocb->ki_filp"
          ],
          "line": 1015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_req_alloc",
          "args": [],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_req_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "305-323",
          "snippet": "static inline struct nfs_direct_req *nfs_direct_req_alloc(void)\n{\n\tstruct nfs_direct_req *dreq;\n\n\tdreq = kmem_cache_zalloc(nfs_direct_cachep, GFP_KERNEL);\n\tif (!dreq)\n\t\treturn NULL;\n\n\tkref_init(&dreq->kref);\n\tkref_get(&dreq->kref);\n\tinit_completion(&dreq->completion);\n\tINIT_LIST_HEAD(&dreq->mds_cinfo.list);\n\tdreq->verf.committed = NFS_INVALID_STABLE_HOW;\t/* not set yet */\n\tINIT_WORK(&dreq->work, nfs_direct_write_schedule_work);\n\tdreq->mirror_count = 1;\n\tspin_lock_init(&dreq->lock);\n\n\treturn dreq;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_direct_cachep;",
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic inline struct nfs_direct_req *nfs_direct_req_alloc(void)\n{\n\tstruct nfs_direct_req *dreq;\n\n\tdreq = kmem_cache_zalloc(nfs_direct_cachep, GFP_KERNEL);\n\tif (!dreq)\n\t\treturn NULL;\n\n\tkref_init(&dreq->kref);\n\tkref_get(&dreq->kref);\n\tinit_completion(&dreq->completion);\n\tINIT_LIST_HEAD(&dreq->mds_cinfo.list);\n\tdreq->verf.committed = NFS_INVALID_STABLE_HOW;\t/* not set yet */\n\tINIT_WORK(&dreq->work, nfs_direct_write_schedule_work);\n\tdreq->mirror_count = 1;\n\tspin_lock_init(&dreq->lock);\n\n\treturn dreq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_io_account_write",
          "args": [
            "count"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "invalidate_inode_pages2_range",
          "args": [
            "mapping",
            "pos >> PAGE_CACHE_SHIFT",
            "end"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_sync_mapping",
          "args": [
            "mapping"
          ],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sync_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "139-148",
          "snippet": "int nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_write_checks",
          "args": [
            "file",
            "&pos",
            "&count",
            "0"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "FILE",
            "\"NFS: direct write(%pD2, %zd@%Ld)\\n\"",
            "file",
            "count",
            "(long long) pos"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_add_stats",
          "args": [
            "mapping->host",
            "NFSIOS_DIRECTWRITTENBYTES",
            "count"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_add_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "44-49",
          "snippet": "static inline void nfs_add_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_bytecounters stat,\n\t\t\t\t long addend)\n{\n\tnfs_add_server_stats(NFS_SERVER(inode), stat, addend);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_add_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_bytecounters stat,\n\t\t\t\t long addend)\n{\n\tnfs_add_server_stats(NFS_SERVER(inode), stat, addend);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iov_iter_count",
          "args": [
            "iter"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nssize_t nfs_file_direct_write(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tssize_t result = -EINVAL;\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tloff_t end;\n\tsize_t count = iov_iter_count(iter);\n\tend = (pos + count - 1) >> PAGE_CACHE_SHIFT;\n\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTWRITTENBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct write(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = generic_write_checks(file, &pos, &count, 0);\n\tif (result)\n\t\tgoto out;\n\n\tresult = -EINVAL;\n\tif ((ssize_t) count < 0)\n\t\tgoto out;\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\tif (mapping->nrpages) {\n\t\tresult = invalidate_inode_pages2_range(mapping,\n\t\t\t\t\tpos >> PAGE_CACHE_SHIFT, end);\n\t\tif (result)\n\t\t\tgoto out_unlock;\n\t}\n\n\ttask_io_account_write(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (!dreq)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tresult = nfs_direct_write_schedule_iovec(dreq, iter, pos);\n\n\tif (mapping->nrpages) {\n\t\tinvalidate_inode_pages2_range(mapping,\n\t\t\t\t\t      pos >> PAGE_CACHE_SHIFT, end);\n\t}\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0) {\n\t\t\tstruct inode *inode = mapping->host;\n\n\t\t\tiocb->ki_pos = pos + result;\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tif (i_size_read(inode) < iocb->ki_pos)\n\t\t\t\ti_size_write(inode, iocb->ki_pos);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}"
  },
  {
    "function_name": "nfs_direct_write_schedule_iovec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "862-940",
    "snippet": "static ssize_t nfs_direct_write_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t       struct iov_iter *iter,\n\t\t\t\t\t       loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = 0;\n\tsize_t requested_bytes = 0;\n\tsize_t wsize = max_t(size_t, NFS_SERVER(inode)->wsize, PAGE_SIZE);\n\n\tnfs_pageio_init_write(&desc, inode, FLUSH_COND_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\tget_dreq(dreq);\n\tatomic_inc(&inode->i_dio_count);\n\n\tNFS_I(inode)->write_io += iov_iter_count(iter);\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  wsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\t\t\tnfs_lock_request(req);\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_unlock_and_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;",
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
      "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_direct_write_complete",
          "args": [
            "dreq",
            "dreq->inode"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "773-776",
          "snippet": "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_dreq",
          "args": [
            "dreq"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "put_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "115-118",
          "snippet": "static inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_req_release",
          "args": [
            "dreq"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_req_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "337-340",
          "snippet": "static void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_dio_done",
          "args": [
            "inode"
          ],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "inode_dio_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1955-1959",
          "snippet": "void inode_dio_done(struct inode *inode)\n{\n\tif (atomic_dec_and_test(&inode->i_dio_count))\n\t\twake_up_bit(&inode->i_state, __I_DIO_WAKEUP);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid inode_dio_done(struct inode *inode)\n{\n\tif (atomic_dec_and_test(&inode->i_dio_count))\n\t\twake_up_bit(&inode->i_state, __I_DIO_WAKEUP);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_complete",
          "args": [
            "&desc"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1244-1254",
          "snippet": "void nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvfree",
          "args": [
            "pagevec"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_release_pages",
          "args": [
            "pagevec",
            "npages"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_release_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "276-281",
          "snippet": "static void nfs_direct_release_pages(struct page **pages, unsigned int npages)\n{\n\tunsigned int i;\n\tfor (i = 0; i < npages; i++)\n\t\tpage_cache_release(pages[i]);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_release_pages(struct page **pages, unsigned int npages)\n{\n\tunsigned int i;\n\tfor (i = 0; i < npages; i++)\n\t\tpage_cache_release(pages[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_unlock_and_release_request",
          "args": [
            "req"
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_unlock_and_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "410-414",
          "snippet": "void nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_add_request",
          "args": [
            "&desc",
            "req"
          ],
          "line": 909
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1138-1183",
          "snippet": "int nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_lock_request",
          "args": [
            "req"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_setup_mirroring",
          "args": [
            "dreq",
            "&desc",
            "req"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_setup_mirroring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "293-303",
          "snippet": "static inline void nfs_direct_setup_mirroring(struct nfs_direct_req *dreq,\n\t\t\t\t\t     struct nfs_pageio_descriptor *pgio,\n\t\t\t\t\t     struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (pgio->pg_ops->pg_get_mirror_count)\n\t\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tdreq->mirror_count = mirror_count;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void nfs_direct_setup_mirroring(struct nfs_direct_req *dreq,\n\t\t\t\t\t     struct nfs_pageio_descriptor *pgio,\n\t\t\t\t\t     struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (pgio->pg_ops->pg_get_mirror_count)\n\t\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tdreq->mirror_count = mirror_count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "req"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "req"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_create_request",
          "args": [
            "dreq->ctx",
            "pagevec[i]",
            "NULL",
            "pgbase",
            "req_len"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_create_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "351-388",
          "snippet": "struct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "size_t",
            "bytes",
            "PAGE_SIZE - pgbase"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_advance",
          "args": [
            "iter",
            "bytes"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_get_pages_alloc",
          "args": [
            "iter",
            "&pagevec",
            "wsize",
            "&pgbase"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_count",
          "args": [
            "iter"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_count",
          "args": [
            "iter"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&inode->i_dio_count"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_dreq",
          "args": [
            "dreq"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "get_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "110-113",
          "snippet": "static inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_init_write",
          "args": [
            "&desc",
            "inode",
            "FLUSH_COND_STABLE",
            "false",
            "&nfs_direct_write_completion_ops"
          ],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_init_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1313-1326",
          "snippet": "void nfs_pageio_init_write(struct nfs_pageio_descriptor *pgio,\n\t\t\t       struct inode *inode, int ioflags, bool force_mds,\n\t\t\t       const struct nfs_pgio_completion_ops *compl_ops)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tconst struct nfs_pageio_ops *pg_ops = &nfs_pgio_rw_ops;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (server->pnfs_curr_ld && !force_mds)\n\t\tpg_ops = server->pnfs_curr_ld->pg_write_ops;\n#endif\n\tnfs_pageio_init(pgio, inode, pg_ops, compl_ops, &nfs_rw_write_ops,\n\t\t\tserver->wsize, ioflags);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_rw_ops nfs_rw_write_ops;",
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);",
            "static const struct nfs_rw_ops nfs_rw_write_ops = {\n\t.rw_mode\t\t= FMODE_WRITE,\n\t.rw_alloc_header\t= nfs_writehdr_alloc,\n\t.rw_free_header\t\t= nfs_writehdr_free,\n\t.rw_release\t\t= nfs_writeback_release_common,\n\t.rw_done\t\t= nfs_writeback_done,\n\t.rw_result\t\t= nfs_writeback_result,\n\t.rw_initiate\t\t= nfs_initiate_write,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic const struct nfs_rw_ops nfs_rw_write_ops;\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\nstatic const struct nfs_rw_ops nfs_rw_write_ops = {\n\t.rw_mode\t\t= FMODE_WRITE,\n\t.rw_alloc_header\t= nfs_writehdr_alloc,\n\t.rw_free_header\t\t= nfs_writehdr_free,\n\t.rw_release\t\t= nfs_writeback_release_common,\n\t.rw_done\t\t= nfs_writeback_done,\n\t.rw_result\t\t= nfs_writeback_result,\n\t.rw_initiate\t\t= nfs_initiate_write,\n};\n\nvoid nfs_pageio_init_write(struct nfs_pageio_descriptor *pgio,\n\t\t\t       struct inode *inode, int ioflags, bool force_mds,\n\t\t\t       const struct nfs_pgio_completion_ops *compl_ops)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tconst struct nfs_pageio_ops *pg_ops = &nfs_pgio_rw_ops;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (server->pnfs_curr_ld && !force_mds)\n\t\tpg_ops = server->pnfs_curr_ld->pg_write_ops;\n#endif\n\tnfs_pageio_init(pgio, inode, pg_ops, compl_ops, &nfs_rw_write_ops,\n\t\t\tserver->wsize, ioflags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "max_t",
          "args": [
            "size_t",
            "NFS_SERVER(inode)->wsize",
            "PAGE_SIZE"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};\n\nstatic ssize_t nfs_direct_write_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t       struct iov_iter *iter,\n\t\t\t\t\t       loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = 0;\n\tsize_t requested_bytes = 0;\n\tsize_t wsize = max_t(size_t, NFS_SERVER(inode)->wsize, PAGE_SIZE);\n\n\tnfs_pageio_init_write(&desc, inode, FLUSH_COND_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\tget_dreq(dreq);\n\tatomic_inc(&inode->i_dio_count);\n\n\tNFS_I(inode)->write_io += iov_iter_count(iter);\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  wsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\t\t\tnfs_lock_request(req);\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_unlock_and_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_write_sync_pgio_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "833-842",
    "snippet": "static void nfs_write_sync_pgio_error(struct list_head *head)\n{\n\tstruct nfs_page *req;\n\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_unlock_and_release_request",
          "args": [
            "req"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_unlock_and_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "410-414",
          "snippet": "void nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "head->next"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "head"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_write_sync_pgio_error(struct list_head *head)\n{\n\tstruct nfs_page *req;\n\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n}"
  },
  {
    "function_name": "nfs_direct_write_completion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "778-831",
    "snippet": "static void nfs_direct_write_completion(struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_direct_req *dreq = hdr->dreq;\n\tstruct nfs_commit_info cinfo;\n\tbool request_commit = false;\n\tstruct nfs_page *req = nfs_list_entry(hdr->pages.next);\n\n\tif (test_bit(NFS_IOHDR_REDO, &hdr->flags))\n\t\tgoto out_put;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\n\tspin_lock(&dreq->lock);\n\n\tif (test_bit(NFS_IOHDR_ERROR, &hdr->flags)) {\n\t\tdreq->flags = 0;\n\t\tdreq->error = hdr->error;\n\t}\n\tif (dreq->error == 0) {\n\t\tnfs_direct_good_bytes(dreq, hdr);\n\t\tif (nfs_write_need_commit(hdr)) {\n\t\t\tif (dreq->flags == NFS_ODIRECT_RESCHED_WRITES)\n\t\t\t\trequest_commit = true;\n\t\t\telse if (dreq->flags == 0) {\n\t\t\t\tnfs_direct_set_hdr_verf(dreq, hdr);\n\t\t\t\trequest_commit = true;\n\t\t\t\tdreq->flags = NFS_ODIRECT_DO_COMMIT;\n\t\t\t} else if (dreq->flags == NFS_ODIRECT_DO_COMMIT) {\n\t\t\t\trequest_commit = true;\n\t\t\t\tif (nfs_direct_set_or_cmp_hdr_verf(dreq, hdr))\n\t\t\t\t\tdreq->flags =\n\t\t\t\t\t\tNFS_ODIRECT_RESCHED_WRITES;\n\t\t\t}\n\t\t}\n\t}\n\tspin_unlock(&dreq->lock);\n\n\twhile (!list_empty(&hdr->pages)) {\n\n\t\treq = nfs_list_entry(hdr->pages.next);\n\t\tnfs_list_remove_request(req);\n\t\tif (request_commit) {\n\t\t\tkref_get(&req->wb_kref);\n\t\t\tnfs_mark_request_commit(req, hdr->lseg, &cinfo,\n\t\t\t\thdr->ds_commit_idx);\n\t\t}\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\nout_put:\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, hdr->inode);\n\thdr->release(hdr);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */",
      "#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */"
    ],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hdr->release",
          "args": [
            "hdr"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_write_complete",
          "args": [
            "dreq",
            "hdr->inode"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "773-776",
          "snippet": "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_dreq",
          "args": [
            "dreq"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "put_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "115-118",
          "snippet": "static inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_unlock_and_release_request",
          "args": [
            "req"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_unlock_and_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "410-414",
          "snippet": "void nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mark_request_commit",
          "args": [
            "req",
            "hdr->lseg",
            "&cinfo",
            "hdr->ds_commit_idx"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_request_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "843-850",
          "snippet": "void\nnfs_mark_request_commit(struct nfs_page *req, struct pnfs_layout_segment *lseg,\n\t\t\tstruct nfs_commit_info *cinfo, u32 ds_commit_idx)\n{\n\tif (pnfs_mark_request_commit(req, lseg, cinfo, ds_commit_idx))\n\t\treturn;\n\tnfs_request_add_commit_list(req, &cinfo->mds->list, cinfo);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_redirty_request(struct nfs_page *req);",
            "static void nfs_clear_request_commit(struct nfs_page *req);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_redirty_request(struct nfs_page *req);\nstatic void nfs_clear_request_commit(struct nfs_page *req);\n\nvoid\nnfs_mark_request_commit(struct nfs_page *req, struct pnfs_layout_segment *lseg,\n\t\t\tstruct nfs_commit_info *cinfo, u32 ds_commit_idx)\n{\n\tif (pnfs_mark_request_commit(req, lseg, cinfo, ds_commit_idx))\n\t\treturn;\n\tnfs_request_add_commit_list(req, &cinfo->mds->list, cinfo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&req->wb_kref"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "hdr->pages.next"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&hdr->pages"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dreq->lock"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_set_or_cmp_hdr_verf",
          "args": [
            "dreq",
            "hdr"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_set_or_cmp_hdr_verf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "205-216",
          "snippet": "static int nfs_direct_set_or_cmp_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tif (verfp->committed < 0) {\n\t\tnfs_direct_set_hdr_verf(dreq, hdr);\n\t\treturn 0;\n\t}\n\treturn memcmp(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic int nfs_direct_set_or_cmp_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tif (verfp->committed < 0) {\n\t\tnfs_direct_set_hdr_verf(dreq, hdr);\n\t\treturn 0;\n\t}\n\treturn memcmp(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_set_hdr_verf",
          "args": [
            "dreq",
            "hdr"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_set_hdr_verf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "185-194",
          "snippet": "static void nfs_direct_set_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t    struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tWARN_ON_ONCE(verfp->committed >= 0);\n\tmemcpy(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n\tWARN_ON_ONCE(verfp->committed < 0);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_set_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t    struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tWARN_ON_ONCE(verfp->committed >= 0);\n\tmemcpy(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n\tWARN_ON_ONCE(verfp->committed < 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_write_need_commit",
          "args": [
            "hdr"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_write_need_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "875-880",
          "snippet": "int nfs_write_need_commit(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->verf.committed == NFS_DATA_SYNC)\n\t\treturn hdr->lseg == NULL;\n\treturn hdr->verf.committed != NFS_FILE_SYNC;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nint nfs_write_need_commit(struct nfs_pgio_header *hdr)\n{\n\tif (hdr->verf.committed == NFS_DATA_SYNC)\n\t\treturn hdr->lseg == NULL;\n\treturn hdr->verf.committed != NFS_FILE_SYNC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_good_bytes",
          "args": [
            "dreq",
            "hdr"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_good_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "126-148",
          "snippet": "static void\nnfs_direct_good_bytes(struct nfs_direct_req *dreq, struct nfs_pgio_header *hdr)\n{\n\tint i;\n\tssize_t count;\n\n\tWARN_ON_ONCE(hdr->pgio_mirror_idx >= dreq->mirror_count);\n\n\tcount = dreq->mirrors[hdr->pgio_mirror_idx].count;\n\tif (count + dreq->io_start < hdr->io_start + hdr->good_bytes) {\n\t\tcount = hdr->io_start + hdr->good_bytes - dreq->io_start;\n\t\tdreq->mirrors[hdr->pgio_mirror_idx].count = count;\n\t}\n\n\t/* update the dreq->count by finding the minimum agreed count from all\n\t * mirrors */\n\tcount = dreq->mirrors[0].count;\n\n\tfor (i = 1; i < dreq->mirror_count; i++)\n\t\tcount = min(count, dreq->mirrors[i].count);\n\n\tdreq->count = count;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void\nnfs_direct_good_bytes(struct nfs_direct_req *dreq, struct nfs_pgio_header *hdr)\n{\n\tint i;\n\tssize_t count;\n\n\tWARN_ON_ONCE(hdr->pgio_mirror_idx >= dreq->mirror_count);\n\n\tcount = dreq->mirrors[hdr->pgio_mirror_idx].count;\n\tif (count + dreq->io_start < hdr->io_start + hdr->good_bytes) {\n\t\tcount = hdr->io_start + hdr->good_bytes - dreq->io_start;\n\t\tdreq->mirrors[hdr->pgio_mirror_idx].count = count;\n\t}\n\n\t/* update the dreq->count by finding the minimum agreed count from all\n\t * mirrors */\n\tcount = dreq->mirrors[0].count;\n\n\tfor (i = 1; i < dreq->mirror_count; i++)\n\t\tcount = min(count, dreq->mirrors[i].count);\n\n\tdreq->count = count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_IOHDR_ERROR",
            "&hdr->flags"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dreq->lock"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_cinfo_from_dreq",
          "args": [
            "&cinfo",
            "dreq"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_cinfo_from_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "283-291",
          "snippet": "void nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;",
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};\n\nvoid nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "hdr->pages.next"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */\n#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_write_completion(struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_direct_req *dreq = hdr->dreq;\n\tstruct nfs_commit_info cinfo;\n\tbool request_commit = false;\n\tstruct nfs_page *req = nfs_list_entry(hdr->pages.next);\n\n\tif (test_bit(NFS_IOHDR_REDO, &hdr->flags))\n\t\tgoto out_put;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\n\tspin_lock(&dreq->lock);\n\n\tif (test_bit(NFS_IOHDR_ERROR, &hdr->flags)) {\n\t\tdreq->flags = 0;\n\t\tdreq->error = hdr->error;\n\t}\n\tif (dreq->error == 0) {\n\t\tnfs_direct_good_bytes(dreq, hdr);\n\t\tif (nfs_write_need_commit(hdr)) {\n\t\t\tif (dreq->flags == NFS_ODIRECT_RESCHED_WRITES)\n\t\t\t\trequest_commit = true;\n\t\t\telse if (dreq->flags == 0) {\n\t\t\t\tnfs_direct_set_hdr_verf(dreq, hdr);\n\t\t\t\trequest_commit = true;\n\t\t\t\tdreq->flags = NFS_ODIRECT_DO_COMMIT;\n\t\t\t} else if (dreq->flags == NFS_ODIRECT_DO_COMMIT) {\n\t\t\t\trequest_commit = true;\n\t\t\t\tif (nfs_direct_set_or_cmp_hdr_verf(dreq, hdr))\n\t\t\t\t\tdreq->flags =\n\t\t\t\t\t\tNFS_ODIRECT_RESCHED_WRITES;\n\t\t\t}\n\t\t}\n\t}\n\tspin_unlock(&dreq->lock);\n\n\twhile (!list_empty(&hdr->pages)) {\n\n\t\treq = nfs_list_entry(hdr->pages.next);\n\t\tnfs_list_remove_request(req);\n\t\tif (request_commit) {\n\t\t\tkref_get(&req->wb_kref);\n\t\t\tnfs_mark_request_commit(req, hdr->lseg, &cinfo,\n\t\t\t\thdr->ds_commit_idx);\n\t\t}\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\nout_put:\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, hdr->inode);\n\thdr->release(hdr);\n}"
  },
  {
    "function_name": "nfs_direct_write_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "773-776",
    "snippet": "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
      "static void nfs_direct_write_schedule_work(struct work_struct *work);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&dreq->work"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_schedule_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "755-771",
          "snippet": "static void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_direct_complete(dreq, true);\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */",
            "#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */"
          ],
          "globals_used": [
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */\n#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */\n\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_direct_complete(dreq, true);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}"
  },
  {
    "function_name": "nfs_direct_write_schedule_work",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "755-771",
    "snippet": "static void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_direct_complete(dreq, true);\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */",
      "#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */"
    ],
    "globals_used": [
      "static void nfs_direct_write_schedule_work(struct work_struct *work);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_direct_complete",
          "args": [
            "dreq",
            "true"
          ],
          "line": 769
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "374-402",
          "snippet": "static void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_write_reschedule",
          "args": [
            "dreq"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_reschedule",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "652-697",
          "snippet": "static void nfs_direct_write_reschedule(struct nfs_direct_req *dreq)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct nfs_page *req, *tmp;\n\tLIST_HEAD(reqs);\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(failed);\n\tint i;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_direct_write_scan_commit_list(dreq->inode, &reqs, &cinfo);\n\n\tdreq->count = 0;\n\tfor (i = 0; i < dreq->mirror_count; i++)\n\t\tdreq->mirrors[i].count = 0;\n\tget_dreq(dreq);\n\n\tnfs_pageio_init_write(&desc, dreq->inode, FLUSH_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\n\treq = nfs_list_entry(reqs.next);\n\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\tlist_for_each_entry_safe(req, tmp, &reqs, wb_list) {\n\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\tnfs_list_remove_request(req);\n\t\t\tnfs_list_add_request(req, &failed);\n\t\t\tspin_lock(cinfo.lock);\n\t\t\tdreq->flags = 0;\n\t\t\tdreq->error = -EIO;\n\t\t\tspin_unlock(cinfo.lock);\n\t\t}\n\t\tnfs_release_request(req);\n\t}\n\tnfs_pageio_complete(&desc);\n\n\twhile (!list_empty(&failed)) {\n\t\treq = nfs_list_entry(failed.next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;",
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};\n\nstatic void nfs_direct_write_reschedule(struct nfs_direct_req *dreq)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct nfs_page *req, *tmp;\n\tLIST_HEAD(reqs);\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(failed);\n\tint i;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_direct_write_scan_commit_list(dreq->inode, &reqs, &cinfo);\n\n\tdreq->count = 0;\n\tfor (i = 0; i < dreq->mirror_count; i++)\n\t\tdreq->mirrors[i].count = 0;\n\tget_dreq(dreq);\n\n\tnfs_pageio_init_write(&desc, dreq->inode, FLUSH_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\n\treq = nfs_list_entry(reqs.next);\n\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\tlist_for_each_entry_safe(req, tmp, &reqs, wb_list) {\n\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\tnfs_list_remove_request(req);\n\t\t\tnfs_list_add_request(req, &failed);\n\t\t\tspin_lock(cinfo.lock);\n\t\t\tdreq->flags = 0;\n\t\t\tdreq->error = -EIO;\n\t\t\tspin_unlock(cinfo.lock);\n\t\t}\n\t\tnfs_release_request(req);\n\t}\n\tnfs_pageio_complete(&desc);\n\n\twhile (!list_empty(&failed)) {\n\t\treq = nfs_list_entry(failed.next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_commit_schedule",
          "args": [
            "dreq"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_commit_schedule",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "742-753",
          "snippet": "static void nfs_direct_commit_schedule(struct nfs_direct_req *dreq)\n{\n\tint res;\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(mds_list);\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_scan_commit(dreq->inode, &mds_list, &cinfo);\n\tres = nfs_generic_commit_list(dreq->inode, &mds_list, 0, &cinfo);\n\tif (res < 0) /* res == -ENOMEM */\n\t\tnfs_direct_write_reschedule(dreq);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_commit_schedule(struct nfs_direct_req *dreq)\n{\n\tint res;\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(mds_list);\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_scan_commit(dreq->inode, &mds_list, &cinfo);\n\tres = nfs_generic_commit_list(dreq->inode, &mds_list, 0, &cinfo);\n\tif (res < 0) /* res == -ENOMEM */\n\t\tnfs_direct_write_reschedule(dreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "structnfs_direct_req",
            "work"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */\n#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */\n\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_direct_complete(dreq, true);\n\t}\n}"
  },
  {
    "function_name": "nfs_direct_commit_schedule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "742-753",
    "snippet": "static void nfs_direct_commit_schedule(struct nfs_direct_req *dreq)\n{\n\tint res;\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(mds_list);\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_scan_commit(dreq->inode, &mds_list, &cinfo);\n\tres = nfs_generic_commit_list(dreq->inode, &mds_list, 0, &cinfo);\n\tif (res < 0) /* res == -ENOMEM */\n\t\tnfs_direct_write_reschedule(dreq);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_direct_write_reschedule",
          "args": [
            "dreq"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_reschedule",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "652-697",
          "snippet": "static void nfs_direct_write_reschedule(struct nfs_direct_req *dreq)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct nfs_page *req, *tmp;\n\tLIST_HEAD(reqs);\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(failed);\n\tint i;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_direct_write_scan_commit_list(dreq->inode, &reqs, &cinfo);\n\n\tdreq->count = 0;\n\tfor (i = 0; i < dreq->mirror_count; i++)\n\t\tdreq->mirrors[i].count = 0;\n\tget_dreq(dreq);\n\n\tnfs_pageio_init_write(&desc, dreq->inode, FLUSH_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\n\treq = nfs_list_entry(reqs.next);\n\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\tlist_for_each_entry_safe(req, tmp, &reqs, wb_list) {\n\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\tnfs_list_remove_request(req);\n\t\t\tnfs_list_add_request(req, &failed);\n\t\t\tspin_lock(cinfo.lock);\n\t\t\tdreq->flags = 0;\n\t\t\tdreq->error = -EIO;\n\t\t\tspin_unlock(cinfo.lock);\n\t\t}\n\t\tnfs_release_request(req);\n\t}\n\tnfs_pageio_complete(&desc);\n\n\twhile (!list_empty(&failed)) {\n\t\treq = nfs_list_entry(failed.next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;",
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};\n\nstatic void nfs_direct_write_reschedule(struct nfs_direct_req *dreq)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct nfs_page *req, *tmp;\n\tLIST_HEAD(reqs);\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(failed);\n\tint i;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_direct_write_scan_commit_list(dreq->inode, &reqs, &cinfo);\n\n\tdreq->count = 0;\n\tfor (i = 0; i < dreq->mirror_count; i++)\n\t\tdreq->mirrors[i].count = 0;\n\tget_dreq(dreq);\n\n\tnfs_pageio_init_write(&desc, dreq->inode, FLUSH_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\n\treq = nfs_list_entry(reqs.next);\n\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\tlist_for_each_entry_safe(req, tmp, &reqs, wb_list) {\n\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\tnfs_list_remove_request(req);\n\t\t\tnfs_list_add_request(req, &failed);\n\t\t\tspin_lock(cinfo.lock);\n\t\t\tdreq->flags = 0;\n\t\t\tdreq->error = -EIO;\n\t\t\tspin_unlock(cinfo.lock);\n\t\t}\n\t\tnfs_release_request(req);\n\t}\n\tnfs_pageio_complete(&desc);\n\n\twhile (!list_empty(&failed)) {\n\t\treq = nfs_list_entry(failed.next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_generic_commit_list",
          "args": [
            "dreq->inode",
            "&mds_list",
            "0",
            "&cinfo"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_generic_commit_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1746-1755",
          "snippet": "int nfs_generic_commit_list(struct inode *inode, struct list_head *head,\n\t\t\t    int how, struct nfs_commit_info *cinfo)\n{\n\tint status;\n\n\tstatus = pnfs_commit_list(inode, head, how, cinfo);\n\tif (status == PNFS_NOT_ATTEMPTED)\n\t\tstatus = nfs_commit_list(inode, head, how, cinfo);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint nfs_generic_commit_list(struct inode *inode, struct list_head *head,\n\t\t\t    int how, struct nfs_commit_info *cinfo)\n{\n\tint status;\n\n\tstatus = pnfs_commit_list(inode, head, how, cinfo);\n\tif (status == PNFS_NOT_ATTEMPTED)\n\t\tstatus = nfs_commit_list(inode, head, how, cinfo);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_scan_commit",
          "args": [
            "dreq->inode",
            "&mds_list",
            "&cinfo"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_scan_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "956-972",
          "snippet": "int\nnfs_scan_commit(struct inode *inode, struct list_head *dst,\n\t\tstruct nfs_commit_info *cinfo)\n{\n\tint ret = 0;\n\n\tspin_lock(cinfo->lock);\n\tif (cinfo->mds->ncommit > 0) {\n\t\tconst int max = INT_MAX;\n\n\t\tret = nfs_scan_commit_list(&cinfo->mds->list, dst,\n\t\t\t\t\t   cinfo, max);\n\t\tret += pnfs_scan_commit_lists(inode, cinfo, max - ret);\n\t}\n\tspin_unlock(cinfo->lock);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint\nnfs_scan_commit(struct inode *inode, struct list_head *dst,\n\t\tstruct nfs_commit_info *cinfo)\n{\n\tint ret = 0;\n\n\tspin_lock(cinfo->lock);\n\tif (cinfo->mds->ncommit > 0) {\n\t\tconst int max = INT_MAX;\n\n\t\tret = nfs_scan_commit_list(&cinfo->mds->list, dst,\n\t\t\t\t\t   cinfo, max);\n\t\tret += pnfs_scan_commit_lists(inode, cinfo, max - ret);\n\t}\n\tspin_unlock(cinfo->lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_cinfo_from_dreq",
          "args": [
            "&cinfo",
            "dreq"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_cinfo_from_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "283-291",
          "snippet": "void nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;",
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};\n\nvoid nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "mds_list"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_commit_schedule(struct nfs_direct_req *dreq)\n{\n\tint res;\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(mds_list);\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_scan_commit(dreq->inode, &mds_list, &cinfo);\n\tres = nfs_generic_commit_list(dreq->inode, &mds_list, 0, &cinfo);\n\tif (res < 0) /* res == -ENOMEM */\n\t\tnfs_direct_write_reschedule(dreq);\n}"
  },
  {
    "function_name": "nfs_direct_error_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "732-735",
    "snippet": "static void nfs_direct_error_cleanup(struct nfs_inode *nfsi)\n{\n\t/* There is no lock to clear */\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_error_cleanup(struct nfs_inode *nfsi)\n{\n\t/* There is no lock to clear */\n}"
  },
  {
    "function_name": "nfs_direct_commit_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "699-730",
    "snippet": "static void nfs_direct_commit_complete(struct nfs_commit_data *data)\n{\n\tstruct nfs_direct_req *dreq = data->dreq;\n\tstruct nfs_commit_info cinfo;\n\tstruct nfs_page *req;\n\tint status = data->task.tk_status;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tif (status < 0) {\n\t\tdprintk(\"NFS: %5u commit failed with error %d.\\n\",\n\t\t\tdata->task.tk_pid, status);\n\t\tdreq->flags = NFS_ODIRECT_RESCHED_WRITES;\n\t} else if (nfs_direct_cmp_commit_data_verf(dreq, data)) {\n\t\tdprintk(\"NFS: %5u commit verify failed\\n\", data->task.tk_pid);\n\t\tdreq->flags = NFS_ODIRECT_RESCHED_WRITES;\n\t}\n\n\tdprintk(\"NFS: %5u commit returned %d\\n\", data->task.tk_pid, status);\n\twhile (!list_empty(&data->pages)) {\n\t\treq = nfs_list_entry(data->pages.next);\n\t\tnfs_list_remove_request(req);\n\t\tif (dreq->flags == NFS_ODIRECT_RESCHED_WRITES) {\n\t\t\t/* Note the rewrite will go through mds */\n\t\t\tnfs_mark_request_commit(req, NULL, &cinfo, 0);\n\t\t} else\n\t\t\tnfs_release_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (atomic_dec_and_test(&cinfo.mds->rpcs_out))\n\t\tnfs_direct_write_complete(dreq, data->inode);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */"
    ],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_direct_write_complete",
          "args": [
            "dreq",
            "data->inode"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "773-776",
          "snippet": "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&cinfo.mds->rpcs_out"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_unlock_and_release_request",
          "args": [
            "req"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_unlock_and_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "410-414",
          "snippet": "void nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_release_request",
          "args": [
            "req"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "466-469",
          "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mark_request_commit",
          "args": [
            "req",
            "NULL",
            "&cinfo",
            "0"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_request_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "843-850",
          "snippet": "void\nnfs_mark_request_commit(struct nfs_page *req, struct pnfs_layout_segment *lseg,\n\t\t\tstruct nfs_commit_info *cinfo, u32 ds_commit_idx)\n{\n\tif (pnfs_mark_request_commit(req, lseg, cinfo, ds_commit_idx))\n\t\treturn;\n\tnfs_request_add_commit_list(req, &cinfo->mds->list, cinfo);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_redirty_request(struct nfs_page *req);",
            "static void nfs_clear_request_commit(struct nfs_page *req);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_redirty_request(struct nfs_page *req);\nstatic void nfs_clear_request_commit(struct nfs_page *req);\n\nvoid\nnfs_mark_request_commit(struct nfs_page *req, struct pnfs_layout_segment *lseg,\n\t\t\tstruct nfs_commit_info *cinfo, u32 ds_commit_idx)\n{\n\tif (pnfs_mark_request_commit(req, lseg, cinfo, ds_commit_idx))\n\t\treturn;\n\tnfs_request_add_commit_list(req, &cinfo->mds->list, cinfo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "data->pages.next"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&data->pages"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: %5u commit returned %d\\n\"",
            "data->task.tk_pid",
            "status"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: %5u commit verify failed\\n\"",
            "data->task.tk_pid"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_cmp_commit_data_verf",
          "args": [
            "dreq",
            "data"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_cmp_commit_data_verf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "226-239",
          "snippet": "static int nfs_direct_cmp_commit_data_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t   struct nfs_commit_data *data)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, data->ds_clp,\n\t\t\t\t\t data->ds_commit_index);\n\n\t/* verifier not set so always fail */\n\tif (verfp->committed < 0)\n\t\treturn 1;\n\n\treturn memcmp(verfp, &data->verf, sizeof(struct nfs_writeverf));\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic int nfs_direct_cmp_commit_data_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t   struct nfs_commit_data *data)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, data->ds_clp,\n\t\t\t\t\t data->ds_commit_index);\n\n\t/* verifier not set so always fail */\n\tif (verfp->committed < 0)\n\t\treturn 1;\n\n\treturn memcmp(verfp, &data->verf, sizeof(struct nfs_writeverf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: %5u commit failed with error %d.\\n\"",
            "data->task.tk_pid",
            "status"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_init_cinfo_from_dreq",
          "args": [
            "&cinfo",
            "dreq"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_cinfo_from_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "283-291",
          "snippet": "void nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;",
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};\n\nvoid nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_commit_complete(struct nfs_commit_data *data)\n{\n\tstruct nfs_direct_req *dreq = data->dreq;\n\tstruct nfs_commit_info cinfo;\n\tstruct nfs_page *req;\n\tint status = data->task.tk_status;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tif (status < 0) {\n\t\tdprintk(\"NFS: %5u commit failed with error %d.\\n\",\n\t\t\tdata->task.tk_pid, status);\n\t\tdreq->flags = NFS_ODIRECT_RESCHED_WRITES;\n\t} else if (nfs_direct_cmp_commit_data_verf(dreq, data)) {\n\t\tdprintk(\"NFS: %5u commit verify failed\\n\", data->task.tk_pid);\n\t\tdreq->flags = NFS_ODIRECT_RESCHED_WRITES;\n\t}\n\n\tdprintk(\"NFS: %5u commit returned %d\\n\", data->task.tk_pid, status);\n\twhile (!list_empty(&data->pages)) {\n\t\treq = nfs_list_entry(data->pages.next);\n\t\tnfs_list_remove_request(req);\n\t\tif (dreq->flags == NFS_ODIRECT_RESCHED_WRITES) {\n\t\t\t/* Note the rewrite will go through mds */\n\t\t\tnfs_mark_request_commit(req, NULL, &cinfo, 0);\n\t\t} else\n\t\t\tnfs_release_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (atomic_dec_and_test(&cinfo.mds->rpcs_out))\n\t\tnfs_direct_write_complete(dreq, data->inode);\n}"
  },
  {
    "function_name": "nfs_direct_write_reschedule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "652-697",
    "snippet": "static void nfs_direct_write_reschedule(struct nfs_direct_req *dreq)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct nfs_page *req, *tmp;\n\tLIST_HEAD(reqs);\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(failed);\n\tint i;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_direct_write_scan_commit_list(dreq->inode, &reqs, &cinfo);\n\n\tdreq->count = 0;\n\tfor (i = 0; i < dreq->mirror_count; i++)\n\t\tdreq->mirrors[i].count = 0;\n\tget_dreq(dreq);\n\n\tnfs_pageio_init_write(&desc, dreq->inode, FLUSH_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\n\treq = nfs_list_entry(reqs.next);\n\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\tlist_for_each_entry_safe(req, tmp, &reqs, wb_list) {\n\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\tnfs_list_remove_request(req);\n\t\t\tnfs_list_add_request(req, &failed);\n\t\t\tspin_lock(cinfo.lock);\n\t\t\tdreq->flags = 0;\n\t\t\tdreq->error = -EIO;\n\t\t\tspin_unlock(cinfo.lock);\n\t\t}\n\t\tnfs_release_request(req);\n\t}\n\tnfs_pageio_complete(&desc);\n\n\twhile (!list_empty(&failed)) {\n\t\treq = nfs_list_entry(failed.next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;",
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
      "static const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_direct_write_complete",
          "args": [
            "dreq",
            "dreq->inode"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "773-776",
          "snippet": "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode)\n{\n\tschedule_work(&dreq->work); /* Calls nfs_direct_write_schedule_work */\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_dreq",
          "args": [
            "dreq"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "put_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "115-118",
          "snippet": "static inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_unlock_and_release_request",
          "args": [
            "req"
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_unlock_and_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "410-414",
          "snippet": "void nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_unlock_and_release_request(struct nfs_page *req)\n{\n\tnfs_unlock_request(req);\n\tnfs_release_request(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "failed.next"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&failed"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_complete",
          "args": [
            "&desc"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1244-1254",
          "snippet": "void nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_release_request",
          "args": [
            "req"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "466-469",
          "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "cinfo.lock"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "cinfo.lock"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_add_request",
          "args": [
            "req",
            "&failed"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pageio_add_request",
          "args": [
            "&desc",
            "req"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1138-1183",
          "snippet": "int nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "req",
            "tmp",
            "&reqs",
            "wb_list"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_setup_mirroring",
          "args": [
            "dreq",
            "&desc",
            "req"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_setup_mirroring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "293-303",
          "snippet": "static inline void nfs_direct_setup_mirroring(struct nfs_direct_req *dreq,\n\t\t\t\t\t     struct nfs_pageio_descriptor *pgio,\n\t\t\t\t\t     struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (pgio->pg_ops->pg_get_mirror_count)\n\t\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tdreq->mirror_count = mirror_count;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void nfs_direct_setup_mirroring(struct nfs_direct_req *dreq,\n\t\t\t\t\t     struct nfs_pageio_descriptor *pgio,\n\t\t\t\t\t     struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (pgio->pg_ops->pg_get_mirror_count)\n\t\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tdreq->mirror_count = mirror_count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "reqs.next"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_pageio_init_write",
          "args": [
            "&desc",
            "dreq->inode",
            "FLUSH_STABLE",
            "false",
            "&nfs_direct_write_completion_ops"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_init_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1313-1326",
          "snippet": "void nfs_pageio_init_write(struct nfs_pageio_descriptor *pgio,\n\t\t\t       struct inode *inode, int ioflags, bool force_mds,\n\t\t\t       const struct nfs_pgio_completion_ops *compl_ops)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tconst struct nfs_pageio_ops *pg_ops = &nfs_pgio_rw_ops;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (server->pnfs_curr_ld && !force_mds)\n\t\tpg_ops = server->pnfs_curr_ld->pg_write_ops;\n#endif\n\tnfs_pageio_init(pgio, inode, pg_ops, compl_ops, &nfs_rw_write_ops,\n\t\t\tserver->wsize, ioflags);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_rw_ops nfs_rw_write_ops;",
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);",
            "static const struct nfs_rw_ops nfs_rw_write_ops = {\n\t.rw_mode\t\t= FMODE_WRITE,\n\t.rw_alloc_header\t= nfs_writehdr_alloc,\n\t.rw_free_header\t\t= nfs_writehdr_free,\n\t.rw_release\t\t= nfs_writeback_release_common,\n\t.rw_done\t\t= nfs_writeback_done,\n\t.rw_result\t\t= nfs_writeback_result,\n\t.rw_initiate\t\t= nfs_initiate_write,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic const struct nfs_rw_ops nfs_rw_write_ops;\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\nstatic const struct nfs_rw_ops nfs_rw_write_ops = {\n\t.rw_mode\t\t= FMODE_WRITE,\n\t.rw_alloc_header\t= nfs_writehdr_alloc,\n\t.rw_free_header\t\t= nfs_writehdr_free,\n\t.rw_release\t\t= nfs_writeback_release_common,\n\t.rw_done\t\t= nfs_writeback_done,\n\t.rw_result\t\t= nfs_writeback_result,\n\t.rw_initiate\t\t= nfs_initiate_write,\n};\n\nvoid nfs_pageio_init_write(struct nfs_pageio_descriptor *pgio,\n\t\t\t       struct inode *inode, int ioflags, bool force_mds,\n\t\t\t       const struct nfs_pgio_completion_ops *compl_ops)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tconst struct nfs_pageio_ops *pg_ops = &nfs_pgio_rw_ops;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (server->pnfs_curr_ld && !force_mds)\n\t\tpg_ops = server->pnfs_curr_ld->pg_write_ops;\n#endif\n\tnfs_pageio_init(pgio, inode, pg_ops, compl_ops, &nfs_rw_write_ops,\n\t\t\tserver->wsize, ioflags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_dreq",
          "args": [
            "dreq"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "get_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "110-113",
          "snippet": "static inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_write_scan_commit_list",
          "args": [
            "dreq->inode",
            "&reqs",
            "&cinfo"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_scan_commit_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "638-650",
          "snippet": "static void\nnfs_direct_write_scan_commit_list(struct inode *inode,\n\t\t\t\t  struct list_head *list,\n\t\t\t\t  struct nfs_commit_info *cinfo)\n{\n\tspin_lock(cinfo->lock);\n#ifdef CONFIG_NFS_V4_1\n\tif (cinfo->ds != NULL && cinfo->ds->nwritten != 0)\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->recover_commit_reqs(list, cinfo);\n#endif\n\tnfs_scan_commit_list(&cinfo->mds->list, list, cinfo, 0);\n\tspin_unlock(cinfo->lock);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void\nnfs_direct_write_scan_commit_list(struct inode *inode,\n\t\t\t\t  struct list_head *list,\n\t\t\t\t  struct nfs_commit_info *cinfo)\n{\n\tspin_lock(cinfo->lock);\n#ifdef CONFIG_NFS_V4_1\n\tif (cinfo->ds != NULL && cinfo->ds->nwritten != 0)\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->recover_commit_reqs(list, cinfo);\n#endif\n\tnfs_scan_commit_list(&cinfo->mds->list, list, cinfo, 0);\n\tspin_unlock(cinfo->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_cinfo_from_dreq",
          "args": [
            "&cinfo",
            "dreq"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_cinfo_from_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "283-291",
          "snippet": "void nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;",
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};\n\nvoid nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "failed"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "reqs"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_pgio_completion_ops nfs_direct_write_completion_ops = {\n\t.error_cleanup = nfs_write_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_write_completion,\n};\n\nstatic void nfs_direct_write_reschedule(struct nfs_direct_req *dreq)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct nfs_page *req, *tmp;\n\tLIST_HEAD(reqs);\n\tstruct nfs_commit_info cinfo;\n\tLIST_HEAD(failed);\n\tint i;\n\n\tnfs_init_cinfo_from_dreq(&cinfo, dreq);\n\tnfs_direct_write_scan_commit_list(dreq->inode, &reqs, &cinfo);\n\n\tdreq->count = 0;\n\tfor (i = 0; i < dreq->mirror_count; i++)\n\t\tdreq->mirrors[i].count = 0;\n\tget_dreq(dreq);\n\n\tnfs_pageio_init_write(&desc, dreq->inode, FLUSH_STABLE, false,\n\t\t\t      &nfs_direct_write_completion_ops);\n\tdesc.pg_dreq = dreq;\n\n\treq = nfs_list_entry(reqs.next);\n\tnfs_direct_setup_mirroring(dreq, &desc, req);\n\n\tlist_for_each_entry_safe(req, tmp, &reqs, wb_list) {\n\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\tnfs_list_remove_request(req);\n\t\t\tnfs_list_add_request(req, &failed);\n\t\t\tspin_lock(cinfo.lock);\n\t\t\tdreq->flags = 0;\n\t\t\tdreq->error = -EIO;\n\t\t\tspin_unlock(cinfo.lock);\n\t\t}\n\t\tnfs_release_request(req);\n\t}\n\tnfs_pageio_complete(&desc);\n\n\twhile (!list_empty(&failed)) {\n\t\treq = nfs_list_entry(failed.next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_unlock_and_release_request(req);\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_write_complete(dreq, dreq->inode);\n}"
  },
  {
    "function_name": "nfs_direct_write_scan_commit_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "638-650",
    "snippet": "static void\nnfs_direct_write_scan_commit_list(struct inode *inode,\n\t\t\t\t  struct list_head *list,\n\t\t\t\t  struct nfs_commit_info *cinfo)\n{\n\tspin_lock(cinfo->lock);\n#ifdef CONFIG_NFS_V4_1\n\tif (cinfo->ds != NULL && cinfo->ds->nwritten != 0)\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->recover_commit_reqs(list, cinfo);\n#endif\n\tnfs_scan_commit_list(&cinfo->mds->list, list, cinfo, 0);\n\tspin_unlock(cinfo->lock);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "cinfo->lock"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_scan_commit_list",
          "args": [
            "&cinfo->mds->list",
            "list",
            "cinfo",
            "0"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_scan_commit_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "925-945",
          "snippet": "int\nnfs_scan_commit_list(struct list_head *src, struct list_head *dst,\n\t\t     struct nfs_commit_info *cinfo, int max)\n{\n\tstruct nfs_page *req, *tmp;\n\tint ret = 0;\n\n\tlist_for_each_entry_safe(req, tmp, src, wb_list) {\n\t\tif (!nfs_lock_request(req))\n\t\t\tcontinue;\n\t\tkref_get(&req->wb_kref);\n\t\tif (cond_resched_lock(cinfo->lock))\n\t\t\tlist_safe_reset_next(req, tmp, wb_list);\n\t\tnfs_request_remove_commit_list(req, cinfo);\n\t\tnfs_list_add_request(req, dst);\n\t\tret++;\n\t\tif ((ret == max) && !cinfo->dreq)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_redirty_request(struct nfs_page *req);",
            "static void nfs_clear_request_commit(struct nfs_page *req);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_redirty_request(struct nfs_page *req);\nstatic void nfs_clear_request_commit(struct nfs_page *req);\n\nint\nnfs_scan_commit_list(struct list_head *src, struct list_head *dst,\n\t\t     struct nfs_commit_info *cinfo, int max)\n{\n\tstruct nfs_page *req, *tmp;\n\tint ret = 0;\n\n\tlist_for_each_entry_safe(req, tmp, src, wb_list) {\n\t\tif (!nfs_lock_request(req))\n\t\t\tcontinue;\n\t\tkref_get(&req->wb_kref);\n\t\tif (cond_resched_lock(cinfo->lock))\n\t\t\tlist_safe_reset_next(req, tmp, wb_list);\n\t\tnfs_request_remove_commit_list(req, cinfo);\n\t\tnfs_list_add_request(req, dst);\n\t\tret++;\n\t\tif ((ret == max) && !cinfo->dreq)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "list",
            "cinfo"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "cinfo->lock"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void\nnfs_direct_write_scan_commit_list(struct inode *inode,\n\t\t\t\t  struct list_head *list,\n\t\t\t\t  struct nfs_commit_info *cinfo)\n{\n\tspin_lock(cinfo->lock);\n#ifdef CONFIG_NFS_V4_1\n\tif (cinfo->ds != NULL && cinfo->ds->nwritten != 0)\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->recover_commit_reqs(list, cinfo);\n#endif\n\tnfs_scan_commit_list(&cinfo->mds->list, list, cinfo, 0);\n\tspin_unlock(cinfo->lock);\n}"
  },
  {
    "function_name": "nfs_file_direct_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "572-636",
    "snippet": "ssize_t nfs_file_direct_read(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tssize_t result = -EINVAL;\n\tsize_t count = iov_iter_count(iter);\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTREADBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct read(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\ttask_io_account_read(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (dreq == NULL)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tNFS_I(inode)->read_io += count;\n\tresult = nfs_direct_read_schedule_iovec(dreq, iter, pos);\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0)\n\t\t\tiocb->ki_pos = pos + result;\n\t}\n\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_req_release",
          "args": [
            "dreq"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_req_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "337-340",
          "snippet": "static void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_wait",
          "args": [
            "dreq"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "351-368",
          "snippet": "static ssize_t nfs_direct_wait(struct nfs_direct_req *dreq)\n{\n\tssize_t result = -EIOCBQUEUED;\n\n\t/* Async requests don't wait here */\n\tif (dreq->iocb)\n\t\tgoto out;\n\n\tresult = wait_for_completion_killable(&dreq->completion);\n\n\tif (!result)\n\t\tresult = dreq->error;\n\tif (!result)\n\t\tresult = dreq->count;\n\nout:\n\treturn (ssize_t) result;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic ssize_t nfs_direct_wait(struct nfs_direct_req *dreq)\n{\n\tssize_t result = -EIOCBQUEUED;\n\n\t/* Async requests don't wait here */\n\tif (dreq->iocb)\n\t\tgoto out;\n\n\tresult = wait_for_completion_killable(&dreq->completion);\n\n\tif (!result)\n\t\tresult = dreq->error;\n\tif (!result)\n\t\tresult = dreq->count;\n\nout:\n\treturn (ssize_t) result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_read_schedule_iovec",
          "args": [
            "dreq",
            "iter",
            "pos"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_read_schedule_iovec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "476-550",
          "snippet": "static ssize_t nfs_direct_read_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t      struct iov_iter *iter,\n\t\t\t\t\t      loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = -EINVAL;\n\tsize_t requested_bytes = 0;\n\tsize_t rsize = max_t(size_t, NFS_SERVER(inode)->rsize, PAGE_SIZE);\n\n\tnfs_pageio_init_read(&desc, dreq->inode, false,\n\t\t\t     &nfs_direct_read_completion_ops);\n\tget_dreq(dreq);\n\tdesc.pg_dreq = dreq;\n\tatomic_inc(&inode->i_dio_count);\n\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  rsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\t\t\t/* XXX do we need to do the eof zeroing found in async_filler? */\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_complete(dreq, false);\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
            "static const struct nfs_pgio_completion_ops nfs_direct_read_completion_ops = {\n\t.error_cleanup = nfs_read_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_read_completion,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_pgio_completion_ops nfs_direct_read_completion_ops = {\n\t.error_cleanup = nfs_read_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_read_completion,\n};\n\nstatic ssize_t nfs_direct_read_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t      struct iov_iter *iter,\n\t\t\t\t\t      loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = -EINVAL;\n\tsize_t requested_bytes = 0;\n\tsize_t rsize = max_t(size_t, NFS_SERVER(inode)->rsize, PAGE_SIZE);\n\n\tnfs_pageio_init_read(&desc, dreq->inode, false,\n\t\t\t     &nfs_direct_read_completion_ops);\n\tget_dreq(dreq);\n\tdesc.pg_dreq = dreq;\n\tatomic_inc(&inode->i_dio_count);\n\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  rsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\t\t\t/* XXX do we need to do the eof zeroing found in async_filler? */\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_complete(dreq, false);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_sync_kiocb",
          "args": [
            "iocb"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "l_ctx"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "l_ctx"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_lock_context",
          "args": [
            "dreq->ctx"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "708-733",
          "snippet": "struct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstruct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_nfs_open_context",
          "args": [
            "nfs_file_open_context(iocb->ki_filp)"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "803-808",
          "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_open_context",
          "args": [
            "iocb->ki_filp"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_req_alloc",
          "args": [],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_req_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "305-323",
          "snippet": "static inline struct nfs_direct_req *nfs_direct_req_alloc(void)\n{\n\tstruct nfs_direct_req *dreq;\n\n\tdreq = kmem_cache_zalloc(nfs_direct_cachep, GFP_KERNEL);\n\tif (!dreq)\n\t\treturn NULL;\n\n\tkref_init(&dreq->kref);\n\tkref_get(&dreq->kref);\n\tinit_completion(&dreq->completion);\n\tINIT_LIST_HEAD(&dreq->mds_cinfo.list);\n\tdreq->verf.committed = NFS_INVALID_STABLE_HOW;\t/* not set yet */\n\tINIT_WORK(&dreq->work, nfs_direct_write_schedule_work);\n\tdreq->mirror_count = 1;\n\tspin_lock_init(&dreq->lock);\n\n\treturn dreq;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_direct_cachep;",
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic inline struct nfs_direct_req *nfs_direct_req_alloc(void)\n{\n\tstruct nfs_direct_req *dreq;\n\n\tdreq = kmem_cache_zalloc(nfs_direct_cachep, GFP_KERNEL);\n\tif (!dreq)\n\t\treturn NULL;\n\n\tkref_init(&dreq->kref);\n\tkref_get(&dreq->kref);\n\tinit_completion(&dreq->completion);\n\tINIT_LIST_HEAD(&dreq->mds_cinfo.list);\n\tdreq->verf.committed = NFS_INVALID_STABLE_HOW;\t/* not set yet */\n\tINIT_WORK(&dreq->work, nfs_direct_write_schedule_work);\n\tdreq->mirror_count = 1;\n\tspin_lock_init(&dreq->lock);\n\n\treturn dreq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_io_account_read",
          "args": [
            "count"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_sync_mapping",
          "args": [
            "mapping"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sync_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "139-148",
          "snippet": "int nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "FILE",
            "\"NFS: direct read(%pD2, %zd@%Ld)\\n\"",
            "file",
            "count",
            "(long long) pos"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_add_stats",
          "args": [
            "mapping->host",
            "NFSIOS_DIRECTREADBYTES",
            "count"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_add_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "44-49",
          "snippet": "static inline void nfs_add_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_bytecounters stat,\n\t\t\t\t long addend)\n{\n\tnfs_add_server_stats(NFS_SERVER(inode), stat, addend);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_add_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_bytecounters stat,\n\t\t\t\t long addend)\n{\n\tnfs_add_server_stats(NFS_SERVER(inode), stat, addend);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iov_iter_count",
          "args": [
            "iter"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nssize_t nfs_file_direct_read(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tssize_t result = -EINVAL;\n\tsize_t count = iov_iter_count(iter);\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTREADBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct read(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\ttask_io_account_read(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (dreq == NULL)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tNFS_I(inode)->read_io += count;\n\tresult = nfs_direct_read_schedule_iovec(dreq, iter, pos);\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0)\n\t\t\tiocb->ki_pos = pos + result;\n\t}\n\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}"
  },
  {
    "function_name": "nfs_direct_read_schedule_iovec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "476-550",
    "snippet": "static ssize_t nfs_direct_read_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t      struct iov_iter *iter,\n\t\t\t\t\t      loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = -EINVAL;\n\tsize_t requested_bytes = 0;\n\tsize_t rsize = max_t(size_t, NFS_SERVER(inode)->rsize, PAGE_SIZE);\n\n\tnfs_pageio_init_read(&desc, dreq->inode, false,\n\t\t\t     &nfs_direct_read_completion_ops);\n\tget_dreq(dreq);\n\tdesc.pg_dreq = dreq;\n\tatomic_inc(&inode->i_dio_count);\n\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  rsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\t\t\t/* XXX do we need to do the eof zeroing found in async_filler? */\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_complete(dreq, false);\n\treturn 0;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
      "static const struct nfs_pgio_completion_ops nfs_direct_read_completion_ops = {\n\t.error_cleanup = nfs_read_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_read_completion,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_direct_complete",
          "args": [
            "dreq",
            "false"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "374-402",
          "snippet": "static void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_dreq",
          "args": [
            "dreq"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "put_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "115-118",
          "snippet": "static inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_req_release",
          "args": [
            "dreq"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_req_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "337-340",
          "snippet": "static void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_dio_done",
          "args": [
            "inode"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "inode_dio_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1955-1959",
          "snippet": "void inode_dio_done(struct inode *inode)\n{\n\tif (atomic_dec_and_test(&inode->i_dio_count))\n\t\twake_up_bit(&inode->i_state, __I_DIO_WAKEUP);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid inode_dio_done(struct inode *inode)\n{\n\tif (atomic_dec_and_test(&inode->i_dio_count))\n\t\twake_up_bit(&inode->i_state, __I_DIO_WAKEUP);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_complete",
          "args": [
            "&desc"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1244-1254",
          "snippet": "void nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_pageio_complete(struct nfs_pageio_descriptor *desc)\n{\n\tu32 midx;\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++)\n\t\tnfs_pageio_complete_mirror(desc, midx);\n\n\tif (desc->pg_ops->pg_cleanup)\n\t\tdesc->pg_ops->pg_cleanup(desc);\n\tnfs_pageio_cleanup_mirroring(desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvfree",
          "args": [
            "pagevec"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_release_pages",
          "args": [
            "pagevec",
            "npages"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_release_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "276-281",
          "snippet": "static void nfs_direct_release_pages(struct page **pages, unsigned int npages)\n{\n\tunsigned int i;\n\tfor (i = 0; i < npages; i++)\n\t\tpage_cache_release(pages[i]);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_release_pages(struct page **pages, unsigned int npages)\n{\n\tunsigned int i;\n\tfor (i = 0; i < npages; i++)\n\t\tpage_cache_release(pages[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_release_request",
          "args": [
            "req"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "466-469",
          "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_add_request",
          "args": [
            "&desc",
            "req"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1138-1183",
          "snippet": "int nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint nfs_pageio_add_request(struct nfs_pageio_descriptor *desc,\n\t\t\t   struct nfs_page *req)\n{\n\tu32 midx;\n\tunsigned int pgbase, offset, bytes;\n\tstruct nfs_page *dupreq, *lastreq;\n\n\tpgbase = req->wb_pgbase;\n\toffset = req->wb_offset;\n\tbytes = req->wb_bytes;\n\n\tnfs_pageio_setup_mirroring(desc, req);\n\n\tfor (midx = 0; midx < desc->pg_mirror_count; midx++) {\n\t\tif (midx) {\n\t\t\tnfs_page_group_lock(req, false);\n\n\t\t\t/* find the last request */\n\t\t\tfor (lastreq = req->wb_head;\n\t\t\t     lastreq->wb_this_page != req->wb_head;\n\t\t\t     lastreq = lastreq->wb_this_page)\n\t\t\t\t;\n\n\t\t\tdupreq = nfs_create_request(req->wb_context,\n\t\t\t\t\treq->wb_page, lastreq, pgbase, bytes);\n\n\t\t\tif (IS_ERR(dupreq)) {\n\t\t\t\tnfs_page_group_unlock(req);\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tnfs_lock_request(dupreq);\n\t\t\tnfs_page_group_unlock(req);\n\t\t\tdupreq->wb_offset = offset;\n\t\t\tdupreq->wb_index = req->wb_index;\n\t\t} else\n\t\t\tdupreq = req;\n\n\t\tif (nfs_pgio_has_mirroring(desc))\n\t\t\tdesc->pg_mirror_idx = midx;\n\t\tif (!nfs_pageio_add_request_mirror(desc, dupreq))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "req"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "req"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_create_request",
          "args": [
            "dreq->ctx",
            "pagevec[i]",
            "NULL",
            "pgbase",
            "req_len"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_create_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "351-388",
          "snippet": "struct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstruct nfs_page *\nnfs_create_request(struct nfs_open_context *ctx, struct page *page,\n\t\t   struct nfs_page *last, unsigned int offset,\n\t\t   unsigned int count)\n{\n\tstruct nfs_page\t\t*req;\n\tstruct nfs_lock_context *l_ctx;\n\n\tif (test_bit(NFS_CONTEXT_BAD, &ctx->flags))\n\t\treturn ERR_PTR(-EBADF);\n\t/* try to allocate the request struct */\n\treq = nfs_page_alloc();\n\tif (req == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get lock context early so we can deal with alloc failures */\n\tl_ctx = nfs_get_lock_context(ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tnfs_page_free(req);\n\t\treturn ERR_CAST(l_ctx);\n\t}\n\treq->wb_lock_context = l_ctx;\n\tnfs_iocounter_inc(&l_ctx->io_count);\n\n\t/* Initialize the request struct. Initially, we assume a\n\t * long write-back delay. This will be adjusted in\n\t * update_nfs_request below if the region is not locked. */\n\treq->wb_page    = page;\n\treq->wb_index\t= page_file_index(page);\n\tpage_cache_get(page);\n\treq->wb_offset  = offset;\n\treq->wb_pgbase\t= offset;\n\treq->wb_bytes   = count;\n\treq->wb_context = get_nfs_open_context(ctx);\n\tkref_init(&req->wb_kref);\n\tnfs_page_group_init(req, last);\n\treturn req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "size_t",
            "bytes",
            "PAGE_SIZE - pgbase"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_advance",
          "args": [
            "iter",
            "bytes"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_get_pages_alloc",
          "args": [
            "iter",
            "&pagevec",
            "rsize",
            "&pgbase"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_count",
          "args": [
            "iter"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&inode->i_dio_count"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_dreq",
          "args": [
            "dreq"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "get_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "110-113",
          "snippet": "static inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pageio_init_read",
          "args": [
            "&desc",
            "dreq->inode",
            "false",
            "&nfs_direct_read_completion_ops"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pageio_init_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/read.c",
          "lines": "55-68",
          "snippet": "void nfs_pageio_init_read(struct nfs_pageio_descriptor *pgio,\n\t\t\t      struct inode *inode, bool force_mds,\n\t\t\t      const struct nfs_pgio_completion_ops *compl_ops)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tconst struct nfs_pageio_ops *pg_ops = &nfs_pgio_rw_ops;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (server->pnfs_curr_ld && !force_mds)\n\t\tpg_ops = server->pnfs_curr_ld->pg_read_ops;\n#endif\n\tnfs_pageio_init(pgio, inode, pg_ops, compl_ops, &nfs_rw_read_ops,\n\t\t\tserver->rsize, 0);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nfs_rw_ops nfs_rw_read_ops;",
            "static const struct nfs_rw_ops nfs_rw_read_ops = {\n\t.rw_mode\t\t= FMODE_READ,\n\t.rw_alloc_header\t= nfs_readhdr_alloc,\n\t.rw_free_header\t\t= nfs_readhdr_free,\n\t.rw_done\t\t= nfs_readpage_done,\n\t.rw_result\t\t= nfs_readpage_result,\n\t.rw_initiate\t\t= nfs_initiate_read,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n\nstatic const struct nfs_rw_ops nfs_rw_read_ops;\nstatic const struct nfs_rw_ops nfs_rw_read_ops = {\n\t.rw_mode\t\t= FMODE_READ,\n\t.rw_alloc_header\t= nfs_readhdr_alloc,\n\t.rw_free_header\t\t= nfs_readhdr_free,\n\t.rw_done\t\t= nfs_readpage_done,\n\t.rw_result\t\t= nfs_readpage_result,\n\t.rw_initiate\t\t= nfs_initiate_read,\n};\n\nvoid nfs_pageio_init_read(struct nfs_pageio_descriptor *pgio,\n\t\t\t      struct inode *inode, bool force_mds,\n\t\t\t      const struct nfs_pgio_completion_ops *compl_ops)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tconst struct nfs_pageio_ops *pg_ops = &nfs_pgio_rw_ops;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (server->pnfs_curr_ld && !force_mds)\n\t\tpg_ops = server->pnfs_curr_ld->pg_read_ops;\n#endif\n\tnfs_pageio_init(pgio, inode, pg_ops, compl_ops, &nfs_rw_read_ops,\n\t\t\tserver->rsize, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "max_t",
          "args": [
            "size_t",
            "NFS_SERVER(inode)->rsize",
            "PAGE_SIZE"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_pgio_completion_ops nfs_direct_read_completion_ops = {\n\t.error_cleanup = nfs_read_sync_pgio_error,\n\t.init_hdr = nfs_direct_pgio_init,\n\t.completion = nfs_direct_read_completion,\n};\n\nstatic ssize_t nfs_direct_read_schedule_iovec(struct nfs_direct_req *dreq,\n\t\t\t\t\t      struct iov_iter *iter,\n\t\t\t\t\t      loff_t pos)\n{\n\tstruct nfs_pageio_descriptor desc;\n\tstruct inode *inode = dreq->inode;\n\tssize_t result = -EINVAL;\n\tsize_t requested_bytes = 0;\n\tsize_t rsize = max_t(size_t, NFS_SERVER(inode)->rsize, PAGE_SIZE);\n\n\tnfs_pageio_init_read(&desc, dreq->inode, false,\n\t\t\t     &nfs_direct_read_completion_ops);\n\tget_dreq(dreq);\n\tdesc.pg_dreq = dreq;\n\tatomic_inc(&inode->i_dio_count);\n\n\twhile (iov_iter_count(iter)) {\n\t\tstruct page **pagevec;\n\t\tsize_t bytes;\n\t\tsize_t pgbase;\n\t\tunsigned npages, i;\n\n\t\tresult = iov_iter_get_pages_alloc(iter, &pagevec, \n\t\t\t\t\t\t  rsize, &pgbase);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t\n\t\tbytes = result;\n\t\tiov_iter_advance(iter, bytes);\n\t\tnpages = (result + pgbase + PAGE_SIZE - 1) / PAGE_SIZE;\n\t\tfor (i = 0; i < npages; i++) {\n\t\t\tstruct nfs_page *req;\n\t\t\tunsigned int req_len = min_t(size_t, bytes, PAGE_SIZE - pgbase);\n\t\t\t/* XXX do we need to do the eof zeroing found in async_filler? */\n\t\t\treq = nfs_create_request(dreq->ctx, pagevec[i], NULL,\n\t\t\t\t\t\t pgbase, req_len);\n\t\t\tif (IS_ERR(req)) {\n\t\t\t\tresult = PTR_ERR(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treq->wb_index = pos >> PAGE_SHIFT;\n\t\t\treq->wb_offset = pos & ~PAGE_MASK;\n\t\t\tif (!nfs_pageio_add_request(&desc, req)) {\n\t\t\t\tresult = desc.pg_error;\n\t\t\t\tnfs_release_request(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpgbase = 0;\n\t\t\tbytes -= req_len;\n\t\t\trequested_bytes += req_len;\n\t\t\tpos += req_len;\n\t\t\tdreq->bytes_left -= req_len;\n\t\t}\n\t\tnfs_direct_release_pages(pagevec, npages);\n\t\tkvfree(pagevec);\n\t\tif (result < 0)\n\t\t\tbreak;\n\t}\n\n\tnfs_pageio_complete(&desc);\n\n\t/*\n\t * If no bytes were started, return the error, and let the\n\t * generic layer handle the completion.\n\t */\n\tif (requested_bytes == 0) {\n\t\tinode_dio_done(inode);\n\t\tnfs_direct_req_release(dreq);\n\t\treturn result < 0 ? result : -EIO;\n\t}\n\n\tif (put_dreq(dreq))\n\t\tnfs_direct_complete(dreq, false);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_direct_pgio_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "457-460",
    "snippet": "static void nfs_direct_pgio_init(struct nfs_pgio_header *hdr)\n{\n\tget_dreq(hdr->dreq);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_dreq",
          "args": [
            "hdr->dreq"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "get_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "110-113",
          "snippet": "static inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_pgio_init(struct nfs_pgio_header *hdr)\n{\n\tget_dreq(hdr->dreq);\n}"
  },
  {
    "function_name": "nfs_read_sync_pgio_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "446-455",
    "snippet": "static void nfs_read_sync_pgio_error(struct list_head *head)\n{\n\tstruct nfs_page *req;\n\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_release_request(req);\n\t}\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_release_request",
          "args": [
            "req"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "466-469",
          "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "head->next"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "head"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_read_sync_pgio_error(struct list_head *head)\n{\n\tstruct nfs_page *req;\n\n\twhile (!list_empty(head)) {\n\t\treq = nfs_list_entry(head->next);\n\t\tnfs_list_remove_request(req);\n\t\tnfs_release_request(req);\n\t}\n}"
  },
  {
    "function_name": "nfs_direct_read_completion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "414-444",
    "snippet": "static void nfs_direct_read_completion(struct nfs_pgio_header *hdr)\n{\n\tunsigned long bytes = 0;\n\tstruct nfs_direct_req *dreq = hdr->dreq;\n\n\tif (test_bit(NFS_IOHDR_REDO, &hdr->flags))\n\t\tgoto out_put;\n\n\tspin_lock(&dreq->lock);\n\tif (test_bit(NFS_IOHDR_ERROR, &hdr->flags) && (hdr->good_bytes == 0))\n\t\tdreq->error = hdr->error;\n\telse\n\t\tnfs_direct_good_bytes(dreq, hdr);\n\n\tspin_unlock(&dreq->lock);\n\n\twhile (!list_empty(&hdr->pages)) {\n\t\tstruct nfs_page *req = nfs_list_entry(hdr->pages.next);\n\t\tstruct page *page = req->wb_page;\n\n\t\tif (!PageCompound(page) && bytes < hdr->good_bytes)\n\t\t\tset_page_dirty(page);\n\t\tbytes += req->wb_bytes;\n\t\tnfs_list_remove_request(req);\n\t\tnfs_direct_readpage_release(req);\n\t}\nout_put:\n\tif (put_dreq(dreq))\n\t\tnfs_direct_complete(dreq, false);\n\thdr->release(hdr);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hdr->release",
          "args": [
            "hdr"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_complete",
          "args": [
            "dreq",
            "false"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "374-402",
          "snippet": "static void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_dreq",
          "args": [
            "dreq"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "put_dreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "115-118",
          "snippet": "static inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_readpage_release",
          "args": [
            "req"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_readpage_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "404-412",
          "snippet": "static void nfs_direct_readpage_release(struct nfs_page *req)\n{\n\tdprintk(\"NFS: direct read done (%s/%llu %d@%lld)\\n\",\n\t\treq->wb_context->dentry->d_inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(req->wb_context->dentry->d_inode),\n\t\treq->wb_bytes,\n\t\t(long long)req_offset(req));\n\tnfs_release_request(req);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_readpage_release(struct nfs_page *req)\n{\n\tdprintk(\"NFS: direct read done (%s/%llu %d@%lld)\\n\",\n\t\treq->wb_context->dentry->d_inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(req->wb_context->dentry->d_inode),\n\t\treq->wb_bytes,\n\t\t(long long)req_offset(req));\n\tnfs_release_request(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_list_remove_request",
          "args": [
            "req"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "anon_set_page_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/libfs.c",
          "lines": "1040-1043",
          "snippet": "static int anon_set_page_dirty(struct page *page)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nstatic int anon_set_page_dirty(struct page *page)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageCompound",
          "args": [
            "page"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_list_entry",
          "args": [
            "hdr->pages.next"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&hdr->pages"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dreq->lock"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_good_bytes",
          "args": [
            "dreq",
            "hdr"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_good_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "126-148",
          "snippet": "static void\nnfs_direct_good_bytes(struct nfs_direct_req *dreq, struct nfs_pgio_header *hdr)\n{\n\tint i;\n\tssize_t count;\n\n\tWARN_ON_ONCE(hdr->pgio_mirror_idx >= dreq->mirror_count);\n\n\tcount = dreq->mirrors[hdr->pgio_mirror_idx].count;\n\tif (count + dreq->io_start < hdr->io_start + hdr->good_bytes) {\n\t\tcount = hdr->io_start + hdr->good_bytes - dreq->io_start;\n\t\tdreq->mirrors[hdr->pgio_mirror_idx].count = count;\n\t}\n\n\t/* update the dreq->count by finding the minimum agreed count from all\n\t * mirrors */\n\tcount = dreq->mirrors[0].count;\n\n\tfor (i = 1; i < dreq->mirror_count; i++)\n\t\tcount = min(count, dreq->mirrors[i].count);\n\n\tdreq->count = count;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void\nnfs_direct_good_bytes(struct nfs_direct_req *dreq, struct nfs_pgio_header *hdr)\n{\n\tint i;\n\tssize_t count;\n\n\tWARN_ON_ONCE(hdr->pgio_mirror_idx >= dreq->mirror_count);\n\n\tcount = dreq->mirrors[hdr->pgio_mirror_idx].count;\n\tif (count + dreq->io_start < hdr->io_start + hdr->good_bytes) {\n\t\tcount = hdr->io_start + hdr->good_bytes - dreq->io_start;\n\t\tdreq->mirrors[hdr->pgio_mirror_idx].count = count;\n\t}\n\n\t/* update the dreq->count by finding the minimum agreed count from all\n\t * mirrors */\n\tcount = dreq->mirrors[0].count;\n\n\tfor (i = 1; i < dreq->mirror_count; i++)\n\t\tcount = min(count, dreq->mirrors[i].count);\n\n\tdreq->count = count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_IOHDR_ERROR",
            "&hdr->flags"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dreq->lock"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_read_completion(struct nfs_pgio_header *hdr)\n{\n\tunsigned long bytes = 0;\n\tstruct nfs_direct_req *dreq = hdr->dreq;\n\n\tif (test_bit(NFS_IOHDR_REDO, &hdr->flags))\n\t\tgoto out_put;\n\n\tspin_lock(&dreq->lock);\n\tif (test_bit(NFS_IOHDR_ERROR, &hdr->flags) && (hdr->good_bytes == 0))\n\t\tdreq->error = hdr->error;\n\telse\n\t\tnfs_direct_good_bytes(dreq, hdr);\n\n\tspin_unlock(&dreq->lock);\n\n\twhile (!list_empty(&hdr->pages)) {\n\t\tstruct nfs_page *req = nfs_list_entry(hdr->pages.next);\n\t\tstruct page *page = req->wb_page;\n\n\t\tif (!PageCompound(page) && bytes < hdr->good_bytes)\n\t\t\tset_page_dirty(page);\n\t\tbytes += req->wb_bytes;\n\t\tnfs_list_remove_request(req);\n\t\tnfs_direct_readpage_release(req);\n\t}\nout_put:\n\tif (put_dreq(dreq))\n\t\tnfs_direct_complete(dreq, false);\n\thdr->release(hdr);\n}"
  },
  {
    "function_name": "nfs_direct_readpage_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "404-412",
    "snippet": "static void nfs_direct_readpage_release(struct nfs_page *req)\n{\n\tdprintk(\"NFS: direct read done (%s/%llu %d@%lld)\\n\",\n\t\treq->wb_context->dentry->d_inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(req->wb_context->dentry->d_inode),\n\t\treq->wb_bytes,\n\t\t(long long)req_offset(req));\n\tnfs_release_request(req);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_release_request",
          "args": [
            "req"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "466-469",
          "snippet": "void nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nvoid nfs_release_request(struct nfs_page *req)\n{\n\tkref_put(&req->wb_kref, nfs_page_group_destroy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: direct read done (%s/%llu %d@%lld)\\n\"",
            "req->wb_context->dentry->d_inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(req->wb_context->dentry->d_inode)",
            "req->wb_bytes",
            "(long long)req_offset(req)"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "req_offset",
          "args": [
            "req"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "req->wb_context->dentry->d_inode"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_readpage_release(struct nfs_page *req)\n{\n\tdprintk(\"NFS: direct read done (%s/%llu %d@%lld)\\n\",\n\t\treq->wb_context->dentry->d_inode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(req->wb_context->dentry->d_inode),\n\t\treq->wb_bytes,\n\t\t(long long)req_offset(req));\n\tnfs_release_request(req);\n}"
  },
  {
    "function_name": "nfs_direct_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "374-402",
    "snippet": "static void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_direct_req_release",
          "args": [
            "dreq"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_req_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "337-340",
          "snippet": "static void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "complete_all",
          "args": [
            "&dreq->completion"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aio_complete",
          "args": [
            "dreq->iocb",
            "res",
            "0"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "aio_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/aio.c",
          "lines": "1013-1115",
          "snippet": "void aio_complete(struct kiocb *iocb, long res, long res2)\n{\n\tstruct kioctx\t*ctx = iocb->ki_ctx;\n\tstruct aio_ring\t*ring;\n\tstruct io_event\t*ev_page, *event;\n\tunsigned tail, pos, head;\n\tunsigned long\tflags;\n\n\t/*\n\t * Special case handling for sync iocbs:\n\t *  - events go directly into the iocb for fast handling\n\t *  - the sync task with the iocb in its stack holds the single iocb\n\t *    ref, no other paths have a way to get another ref\n\t *  - the sync task helpfully left a reference to itself in the iocb\n\t */\n\tif (is_sync_kiocb(iocb)) {\n\t\tiocb->ki_user_data = res;\n\t\tsmp_wmb();\n\t\tiocb->ki_ctx = ERR_PTR(-EXDEV);\n\t\twake_up_process(iocb->ki_obj.tsk);\n\t\treturn;\n\t}\n\n\tif (iocb->ki_list.next) {\n\t\tunsigned long flags;\n\n\t\tspin_lock_irqsave(&ctx->ctx_lock, flags);\n\t\tlist_del(&iocb->ki_list);\n\t\tspin_unlock_irqrestore(&ctx->ctx_lock, flags);\n\t}\n\n\t/*\n\t * Add a completion event to the ring buffer. Must be done holding\n\t * ctx->completion_lock to prevent other code from messing with the tail\n\t * pointer since we might be called from irq context.\n\t */\n\tspin_lock_irqsave(&ctx->completion_lock, flags);\n\n\ttail = ctx->tail;\n\tpos = tail + AIO_EVENTS_OFFSET;\n\n\tif (++tail >= ctx->nr_events)\n\t\ttail = 0;\n\n\tev_page = kmap_atomic(ctx->ring_pages[pos / AIO_EVENTS_PER_PAGE]);\n\tevent = ev_page + pos % AIO_EVENTS_PER_PAGE;\n\n\tevent->obj = (u64)(unsigned long)iocb->ki_obj.user;\n\tevent->data = iocb->ki_user_data;\n\tevent->res = res;\n\tevent->res2 = res2;\n\n\tkunmap_atomic(ev_page);\n\tflush_dcache_page(ctx->ring_pages[pos / AIO_EVENTS_PER_PAGE]);\n\n\tpr_debug(\"%p[%u]: %p: %p %Lx %lx %lx\\n\",\n\t\t ctx, tail, iocb, iocb->ki_obj.user, iocb->ki_user_data,\n\t\t res, res2);\n\n\t/* after flagging the request as done, we\n\t * must never even look at it again\n\t */\n\tsmp_wmb();\t/* make event visible before updating tail */\n\n\tctx->tail = tail;\n\n\tring = kmap_atomic(ctx->ring_pages[0]);\n\thead = ring->head;\n\tring->tail = tail;\n\tkunmap_atomic(ring);\n\tflush_dcache_page(ctx->ring_pages[0]);\n\n\tctx->completed_events++;\n\tif (ctx->completed_events > 1)\n\t\trefill_reqs_available(ctx, head, tail);\n\tspin_unlock_irqrestore(&ctx->completion_lock, flags);\n\n\tpr_debug(\"added to ring %p at [%u]\\n\", iocb, tail);\n\n\t/*\n\t * Check if the user asked us to deliver the result through an\n\t * eventfd. The eventfd_signal() function is safe to be called\n\t * from IRQ context.\n\t */\n\tif (iocb->ki_eventfd != NULL)\n\t\teventfd_signal(iocb->ki_eventfd, 1);\n\n\t/* everything turned out well, dispose of the aiocb. */\n\tkiocb_free(iocb);\n\n\t/*\n\t * We have to order our ring_info tail store above and test\n\t * of the wait list below outside the wait lock.  This is\n\t * like in wake_up_bit() where clearing a bit has to be\n\t * ordered with the unlocked test.\n\t */\n\tsmp_mb();\n\n\tif (waitqueue_active(&ctx->wait))\n\t\twake_up(&ctx->wait);\n\n\tpercpu_ref_put(&ctx->reqs);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <asm/kmap_types.h>",
            "#include <linux/mount.h>",
            "#include <linux/percpu-refcount.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/migrate.h>",
            "#include <linux/compat.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/highmem.h>",
            "#include <linux/aio.h>",
            "#include <linux/timer.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/mman.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sched.h>",
            "#include <linux/uio.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/aio_abi.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define AIO_EVENTS_OFFSET\t(AIO_EVENTS_PER_PAGE - AIO_EVENTS_FIRST_PAGE)",
            "#define AIO_EVENTS_PER_PAGE\t(PAGE_SIZE / sizeof(struct io_event))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <asm/kmap_types.h>\n#include <linux/mount.h>\n#include <linux/percpu-refcount.h>\n#include <linux/ramfs.h>\n#include <linux/migrate.h>\n#include <linux/compat.h>\n#include <linux/blkdev.h>\n#include <linux/eventfd.h>\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/highmem.h>\n#include <linux/aio.h>\n#include <linux/timer.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mmu_context.h>\n#include <linux/mman.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/sched.h>\n#include <linux/uio.h>\n#include <linux/backing-dev.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/aio_abi.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n\n#define AIO_EVENTS_OFFSET\t(AIO_EVENTS_PER_PAGE - AIO_EVENTS_FIRST_PAGE)\n#define AIO_EVENTS_PER_PAGE\t(PAGE_SIZE / sizeof(struct io_event))\n\nvoid aio_complete(struct kiocb *iocb, long res, long res2)\n{\n\tstruct kioctx\t*ctx = iocb->ki_ctx;\n\tstruct aio_ring\t*ring;\n\tstruct io_event\t*ev_page, *event;\n\tunsigned tail, pos, head;\n\tunsigned long\tflags;\n\n\t/*\n\t * Special case handling for sync iocbs:\n\t *  - events go directly into the iocb for fast handling\n\t *  - the sync task with the iocb in its stack holds the single iocb\n\t *    ref, no other paths have a way to get another ref\n\t *  - the sync task helpfully left a reference to itself in the iocb\n\t */\n\tif (is_sync_kiocb(iocb)) {\n\t\tiocb->ki_user_data = res;\n\t\tsmp_wmb();\n\t\tiocb->ki_ctx = ERR_PTR(-EXDEV);\n\t\twake_up_process(iocb->ki_obj.tsk);\n\t\treturn;\n\t}\n\n\tif (iocb->ki_list.next) {\n\t\tunsigned long flags;\n\n\t\tspin_lock_irqsave(&ctx->ctx_lock, flags);\n\t\tlist_del(&iocb->ki_list);\n\t\tspin_unlock_irqrestore(&ctx->ctx_lock, flags);\n\t}\n\n\t/*\n\t * Add a completion event to the ring buffer. Must be done holding\n\t * ctx->completion_lock to prevent other code from messing with the tail\n\t * pointer since we might be called from irq context.\n\t */\n\tspin_lock_irqsave(&ctx->completion_lock, flags);\n\n\ttail = ctx->tail;\n\tpos = tail + AIO_EVENTS_OFFSET;\n\n\tif (++tail >= ctx->nr_events)\n\t\ttail = 0;\n\n\tev_page = kmap_atomic(ctx->ring_pages[pos / AIO_EVENTS_PER_PAGE]);\n\tevent = ev_page + pos % AIO_EVENTS_PER_PAGE;\n\n\tevent->obj = (u64)(unsigned long)iocb->ki_obj.user;\n\tevent->data = iocb->ki_user_data;\n\tevent->res = res;\n\tevent->res2 = res2;\n\n\tkunmap_atomic(ev_page);\n\tflush_dcache_page(ctx->ring_pages[pos / AIO_EVENTS_PER_PAGE]);\n\n\tpr_debug(\"%p[%u]: %p: %p %Lx %lx %lx\\n\",\n\t\t ctx, tail, iocb, iocb->ki_obj.user, iocb->ki_user_data,\n\t\t res, res2);\n\n\t/* after flagging the request as done, we\n\t * must never even look at it again\n\t */\n\tsmp_wmb();\t/* make event visible before updating tail */\n\n\tctx->tail = tail;\n\n\tring = kmap_atomic(ctx->ring_pages[0]);\n\thead = ring->head;\n\tring->tail = tail;\n\tkunmap_atomic(ring);\n\tflush_dcache_page(ctx->ring_pages[0]);\n\n\tctx->completed_events++;\n\tif (ctx->completed_events > 1)\n\t\trefill_reqs_available(ctx, head, tail);\n\tspin_unlock_irqrestore(&ctx->completion_lock, flags);\n\n\tpr_debug(\"added to ring %p at [%u]\\n\", iocb, tail);\n\n\t/*\n\t * Check if the user asked us to deliver the result through an\n\t * eventfd. The eventfd_signal() function is safe to be called\n\t * from IRQ context.\n\t */\n\tif (iocb->ki_eventfd != NULL)\n\t\teventfd_signal(iocb->ki_eventfd, 1);\n\n\t/* everything turned out well, dispose of the aiocb. */\n\tkiocb_free(iocb);\n\n\t/*\n\t * We have to order our ring_info tail store above and test\n\t * of the wait list below outside the wait lock.  This is\n\t * like in wake_up_bit() where clearing a bit has to be\n\t * ordered with the unlocked test.\n\t */\n\tsmp_mb();\n\n\tif (waitqueue_active(&ctx->wait))\n\t\twake_up(&ctx->wait);\n\n\tpercpu_ref_put(&ctx->reqs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_dio_done",
          "args": [
            "inode"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "inode_dio_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1955-1959",
          "snippet": "void inode_dio_done(struct inode *inode)\n{\n\tif (atomic_dec_and_test(&inode->i_dio_count))\n\t\twake_up_bit(&inode->i_state, __I_DIO_WAKEUP);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid inode_dio_done(struct inode *inode)\n{\n\tif (atomic_dec_and_test(&inode->i_dio_count))\n\t\twake_up_bit(&inode->i_state, __I_DIO_WAKEUP);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_zap_mapping",
          "args": [
            "inode",
            "inode->i_mapping"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "197-204",
          "snippet": "void nfs_zap_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tif (mapping->nrpages != 0) {\n\t\tspin_lock(&inode->i_lock);\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tif (mapping->nrpages != 0) {\n\t\tspin_lock(&inode->i_lock);\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "pos"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nstatic void nfs_direct_complete(struct nfs_direct_req *dreq, bool write)\n{\n\tstruct inode *inode = dreq->inode;\n\n\tif (dreq->iocb && write) {\n\t\tloff_t pos = dreq->iocb->ki_pos + dreq->count;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tif (i_size_read(inode) < pos)\n\t\t\ti_size_write(inode, pos);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tif (write)\n\t\tnfs_zap_mapping(inode, inode->i_mapping);\n\n\tinode_dio_done(inode);\n\n\tif (dreq->iocb) {\n\t\tlong res = (long) dreq->error;\n\t\tif (!res)\n\t\t\tres = (long) dreq->count;\n\t\taio_complete(dreq->iocb, res, 0);\n\t}\n\n\tcomplete_all(&dreq->completion);\n\n\tnfs_direct_req_release(dreq);\n}"
  },
  {
    "function_name": "nfs_direct_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "351-368",
    "snippet": "static ssize_t nfs_direct_wait(struct nfs_direct_req *dreq)\n{\n\tssize_t result = -EIOCBQUEUED;\n\n\t/* Async requests don't wait here */\n\tif (dreq->iocb)\n\t\tgoto out;\n\n\tresult = wait_for_completion_killable(&dreq->completion);\n\n\tif (!result)\n\t\tresult = dreq->error;\n\tif (!result)\n\t\tresult = dreq->count;\n\nout:\n\treturn (ssize_t) result;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_completion_killable",
          "args": [
            "&dreq->completion"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic ssize_t nfs_direct_wait(struct nfs_direct_req *dreq)\n{\n\tssize_t result = -EIOCBQUEUED;\n\n\t/* Async requests don't wait here */\n\tif (dreq->iocb)\n\t\tgoto out;\n\n\tresult = wait_for_completion_killable(&dreq->completion);\n\n\tif (!result)\n\t\tresult = dreq->error;\n\tif (!result)\n\t\tresult = dreq->count;\n\nout:\n\treturn (ssize_t) result;\n}"
  },
  {
    "function_name": "nfs_dreq_bytes_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "342-345",
    "snippet": "ssize_t nfs_dreq_bytes_left(struct nfs_direct_req *dreq)\n{\n\treturn dreq->bytes_left;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nssize_t nfs_dreq_bytes_left(struct nfs_direct_req *dreq)\n{\n\treturn dreq->bytes_left;\n}"
  },
  {
    "function_name": "nfs_direct_req_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "337-340",
    "snippet": "static void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&dreq->kref",
            "nfs_direct_req_free"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_req_release(struct nfs_direct_req *dreq)\n{\n\tkref_put(&dreq->kref, nfs_direct_req_free);\n}"
  },
  {
    "function_name": "nfs_direct_req_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "325-335",
    "snippet": "static void nfs_direct_req_free(struct kref *kref)\n{\n\tstruct nfs_direct_req *dreq = container_of(kref, struct nfs_direct_req, kref);\n\n\tnfs_free_pnfs_ds_cinfo(&dreq->ds_cinfo);\n\tif (dreq->l_ctx != NULL)\n\t\tnfs_put_lock_context(dreq->l_ctx);\n\tif (dreq->ctx != NULL)\n\t\tput_nfs_open_context(dreq->ctx);\n\tkmem_cache_free(nfs_direct_cachep, dreq);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_direct_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "nfs_direct_cachep",
            "dreq"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_nfs_open_context",
          "args": [
            "dreq->ctx"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "833-836",
          "snippet": "void put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_put_lock_context",
          "args": [
            "dreq->l_ctx"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "736-746",
          "snippet": "void nfs_put_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tstruct nfs_open_context *ctx = l_ctx->open_context;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tif (!atomic_dec_and_lock(&l_ctx->count, &inode->i_lock))\n\t\treturn;\n\tlist_del(&l_ctx->list);\n\tspin_unlock(&inode->i_lock);\n\tkfree(l_ctx);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_put_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tstruct nfs_open_context *ctx = l_ctx->open_context;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tif (!atomic_dec_and_lock(&l_ctx->count, &inode->i_lock))\n\t\treturn;\n\tlist_del(&l_ctx->list);\n\tspin_unlock(&inode->i_lock);\n\tkfree(l_ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_free_pnfs_ds_cinfo",
          "args": [
            "&dreq->ds_cinfo"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kref",
            "structnfs_direct_req",
            "kref"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\n\nstatic void nfs_direct_req_free(struct kref *kref)\n{\n\tstruct nfs_direct_req *dreq = container_of(kref, struct nfs_direct_req, kref);\n\n\tnfs_free_pnfs_ds_cinfo(&dreq->ds_cinfo);\n\tif (dreq->l_ctx != NULL)\n\t\tnfs_put_lock_context(dreq->l_ctx);\n\tif (dreq->ctx != NULL)\n\t\tput_nfs_open_context(dreq->ctx);\n\tkmem_cache_free(nfs_direct_cachep, dreq);\n}"
  },
  {
    "function_name": "nfs_direct_req_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "305-323",
    "snippet": "static inline struct nfs_direct_req *nfs_direct_req_alloc(void)\n{\n\tstruct nfs_direct_req *dreq;\n\n\tdreq = kmem_cache_zalloc(nfs_direct_cachep, GFP_KERNEL);\n\tif (!dreq)\n\t\treturn NULL;\n\n\tkref_init(&dreq->kref);\n\tkref_get(&dreq->kref);\n\tinit_completion(&dreq->completion);\n\tINIT_LIST_HEAD(&dreq->mds_cinfo.list);\n\tdreq->verf.committed = NFS_INVALID_STABLE_HOW;\t/* not set yet */\n\tINIT_WORK(&dreq->work, nfs_direct_write_schedule_work);\n\tdreq->mirror_count = 1;\n\tspin_lock_init(&dreq->lock);\n\n\treturn dreq;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *nfs_direct_cachep;",
      "static void nfs_direct_write_schedule_work(struct work_struct *work);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&dreq->lock"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&dreq->work",
            "nfs_direct_write_schedule_work"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dreq->mds_cinfo.list"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&dreq->completion"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&dreq->kref"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kref_init",
          "args": [
            "&dreq->kref"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_zalloc",
          "args": [
            "nfs_direct_cachep",
            "GFP_KERNEL"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic inline struct nfs_direct_req *nfs_direct_req_alloc(void)\n{\n\tstruct nfs_direct_req *dreq;\n\n\tdreq = kmem_cache_zalloc(nfs_direct_cachep, GFP_KERNEL);\n\tif (!dreq)\n\t\treturn NULL;\n\n\tkref_init(&dreq->kref);\n\tkref_get(&dreq->kref);\n\tinit_completion(&dreq->completion);\n\tINIT_LIST_HEAD(&dreq->mds_cinfo.list);\n\tdreq->verf.committed = NFS_INVALID_STABLE_HOW;\t/* not set yet */\n\tINIT_WORK(&dreq->work, nfs_direct_write_schedule_work);\n\tdreq->mirror_count = 1;\n\tspin_lock_init(&dreq->lock);\n\n\treturn dreq;\n}"
  },
  {
    "function_name": "nfs_direct_setup_mirroring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "293-303",
    "snippet": "static inline void nfs_direct_setup_mirroring(struct nfs_direct_req *dreq,\n\t\t\t\t\t     struct nfs_pageio_descriptor *pgio,\n\t\t\t\t\t     struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (pgio->pg_ops->pg_get_mirror_count)\n\t\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tdreq->mirror_count = mirror_count;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pgio->pg_ops->pg_get_mirror_count",
          "args": [
            "pgio",
            "req"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void nfs_direct_setup_mirroring(struct nfs_direct_req *dreq,\n\t\t\t\t\t     struct nfs_pageio_descriptor *pgio,\n\t\t\t\t\t     struct nfs_page *req)\n{\n\tint mirror_count = 1;\n\n\tif (pgio->pg_ops->pg_get_mirror_count)\n\t\tmirror_count = pgio->pg_ops->pg_get_mirror_count(pgio, req);\n\n\tdreq->mirror_count = mirror_count;\n}"
  },
  {
    "function_name": "nfs_init_cinfo_from_dreq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "283-291",
    "snippet": "void nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;",
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);",
      "static const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops;\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\nstatic const struct nfs_commit_completion_ops nfs_direct_commit_completion_ops = {\n\t.completion = nfs_direct_commit_complete,\n\t.error_cleanup = nfs_direct_error_cleanup,\n};\n\nvoid nfs_init_cinfo_from_dreq(struct nfs_commit_info *cinfo,\n\t\t\t      struct nfs_direct_req *dreq)\n{\n\tcinfo->lock = &dreq->inode->i_lock;\n\tcinfo->mds = &dreq->mds_cinfo;\n\tcinfo->ds = &dreq->ds_cinfo;\n\tcinfo->dreq = dreq;\n\tcinfo->completion_ops = &nfs_direct_commit_completion_ops;\n}"
  },
  {
    "function_name": "nfs_direct_release_pages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "276-281",
    "snippet": "static void nfs_direct_release_pages(struct page **pages, unsigned int npages)\n{\n\tunsigned int i;\n\tfor (i = 0; i < npages; i++)\n\t\tpage_cache_release(pages[i]);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_cache_release",
          "args": [
            "pages[i]"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_release_pages(struct page **pages, unsigned int npages)\n{\n\tunsigned int i;\n\tfor (i = 0; i < npages; i++)\n\t\tpage_cache_release(pages[i]);\n}"
  },
  {
    "function_name": "nfs_direct_IO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "254-274",
    "snippet": "ssize_t nfs_direct_IO(int rw, struct kiocb *iocb, struct iov_iter *iter, loff_t pos)\n{\n\tstruct inode *inode = iocb->ki_filp->f_mapping->host;\n\n\t/* we only support swap file calling nfs_direct_IO */\n\tif (!IS_SWAPFILE(inode))\n\t\treturn 0;\n\n#ifndef CONFIG_NFS_SWAP\n\tdprintk(\"NFS: nfs_direct_IO (%pD) off/no(%Ld/%lu) EINVAL\\n\",\n\t\t\tiocb->ki_filp, (long long) pos, iter->nr_segs);\n\n\treturn -EINVAL;\n#else\n\tVM_BUG_ON(iocb->ki_nbytes != PAGE_SIZE);\n\n\tif (rw == READ)\n\t\treturn nfs_file_direct_read(iocb, iter, pos);\n\treturn nfs_file_direct_write(iocb, iter, pos);\n#endif /* CONFIG_NFS_SWAP */\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_file_direct_write",
          "args": [
            "iocb",
            "iter",
            "pos"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_file_direct_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "963-1055",
          "snippet": "ssize_t nfs_file_direct_write(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tssize_t result = -EINVAL;\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tloff_t end;\n\tsize_t count = iov_iter_count(iter);\n\tend = (pos + count - 1) >> PAGE_CACHE_SHIFT;\n\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTWRITTENBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct write(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = generic_write_checks(file, &pos, &count, 0);\n\tif (result)\n\t\tgoto out;\n\n\tresult = -EINVAL;\n\tif ((ssize_t) count < 0)\n\t\tgoto out;\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\tif (mapping->nrpages) {\n\t\tresult = invalidate_inode_pages2_range(mapping,\n\t\t\t\t\tpos >> PAGE_CACHE_SHIFT, end);\n\t\tif (result)\n\t\t\tgoto out_unlock;\n\t}\n\n\ttask_io_account_write(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (!dreq)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tresult = nfs_direct_write_schedule_iovec(dreq, iter, pos);\n\n\tif (mapping->nrpages) {\n\t\tinvalidate_inode_pages2_range(mapping,\n\t\t\t\t\t      pos >> PAGE_CACHE_SHIFT, end);\n\t}\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0) {\n\t\t\tstruct inode *inode = mapping->host;\n\n\t\t\tiocb->ki_pos = pos + result;\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tif (i_size_read(inode) < iocb->ki_pos)\n\t\t\t\ti_size_write(inode, iocb->ki_pos);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nssize_t nfs_file_direct_write(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tssize_t result = -EINVAL;\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tloff_t end;\n\tsize_t count = iov_iter_count(iter);\n\tend = (pos + count - 1) >> PAGE_CACHE_SHIFT;\n\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTWRITTENBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct write(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = generic_write_checks(file, &pos, &count, 0);\n\tif (result)\n\t\tgoto out;\n\n\tresult = -EINVAL;\n\tif ((ssize_t) count < 0)\n\t\tgoto out;\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\tif (mapping->nrpages) {\n\t\tresult = invalidate_inode_pages2_range(mapping,\n\t\t\t\t\tpos >> PAGE_CACHE_SHIFT, end);\n\t\tif (result)\n\t\t\tgoto out_unlock;\n\t}\n\n\ttask_io_account_write(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (!dreq)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tresult = nfs_direct_write_schedule_iovec(dreq, iter, pos);\n\n\tif (mapping->nrpages) {\n\t\tinvalidate_inode_pages2_range(mapping,\n\t\t\t\t\t      pos >> PAGE_CACHE_SHIFT, end);\n\t}\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0) {\n\t\t\tstruct inode *inode = mapping->host;\n\n\t\t\tiocb->ki_pos = pos + result;\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tif (i_size_read(inode) < iocb->ki_pos)\n\t\t\t\ti_size_write(inode, iocb->ki_pos);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t}\n\t}\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_direct_read",
          "args": [
            "iocb",
            "iter",
            "pos"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_file_direct_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "572-636",
          "snippet": "ssize_t nfs_file_direct_read(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tssize_t result = -EINVAL;\n\tsize_t count = iov_iter_count(iter);\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTREADBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct read(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\ttask_io_account_read(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (dreq == NULL)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tNFS_I(inode)->read_io += count;\n\tresult = nfs_direct_read_schedule_iovec(dreq, iter, pos);\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0)\n\t\t\tiocb->ki_pos = pos + result;\n\t}\n\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nssize_t nfs_file_direct_read(struct kiocb *iocb, struct iov_iter *iter,\n\t\t\t\tloff_t pos)\n{\n\tstruct file *file = iocb->ki_filp;\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tstruct nfs_direct_req *dreq;\n\tstruct nfs_lock_context *l_ctx;\n\tssize_t result = -EINVAL;\n\tsize_t count = iov_iter_count(iter);\n\tnfs_add_stats(mapping->host, NFSIOS_DIRECTREADBYTES, count);\n\n\tdfprintk(FILE, \"NFS: direct read(%pD2, %zd@%Ld)\\n\",\n\t\tfile, count, (long long) pos);\n\n\tresult = 0;\n\tif (!count)\n\t\tgoto out;\n\n\tmutex_lock(&inode->i_mutex);\n\tresult = nfs_sync_mapping(mapping);\n\tif (result)\n\t\tgoto out_unlock;\n\n\ttask_io_account_read(count);\n\n\tresult = -ENOMEM;\n\tdreq = nfs_direct_req_alloc();\n\tif (dreq == NULL)\n\t\tgoto out_unlock;\n\n\tdreq->inode = inode;\n\tdreq->bytes_left = count;\n\tdreq->io_start = pos;\n\tdreq->ctx = get_nfs_open_context(nfs_file_open_context(iocb->ki_filp));\n\tl_ctx = nfs_get_lock_context(dreq->ctx);\n\tif (IS_ERR(l_ctx)) {\n\t\tresult = PTR_ERR(l_ctx);\n\t\tgoto out_release;\n\t}\n\tdreq->l_ctx = l_ctx;\n\tif (!is_sync_kiocb(iocb))\n\t\tdreq->iocb = iocb;\n\n\tNFS_I(inode)->read_io += count;\n\tresult = nfs_direct_read_schedule_iovec(dreq, iter, pos);\n\n\tmutex_unlock(&inode->i_mutex);\n\n\tif (!result) {\n\t\tresult = nfs_direct_wait(dreq);\n\t\tif (result > 0)\n\t\t\tiocb->ki_pos = pos + result;\n\t}\n\n\tnfs_direct_req_release(dreq);\n\treturn result;\n\nout_release:\n\tnfs_direct_req_release(dreq);\nout_unlock:\n\tmutex_unlock(&inode->i_mutex);\nout:\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "iocb->ki_nbytes != PAGE_SIZE"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: nfs_direct_IO (%pD) off/no(%Ld/%lu) EINVAL\\n\"",
            "iocb->ki_filp",
            "(long long) pos",
            "iter->nr_segs"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_SWAPFILE",
          "args": [
            "inode"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq, struct inode *inode);\n\nssize_t nfs_direct_IO(int rw, struct kiocb *iocb, struct iov_iter *iter, loff_t pos)\n{\n\tstruct inode *inode = iocb->ki_filp->f_mapping->host;\n\n\t/* we only support swap file calling nfs_direct_IO */\n\tif (!IS_SWAPFILE(inode))\n\t\treturn 0;\n\n#ifndef CONFIG_NFS_SWAP\n\tdprintk(\"NFS: nfs_direct_IO (%pD) off/no(%Ld/%lu) EINVAL\\n\",\n\t\t\tiocb->ki_filp, (long long) pos, iter->nr_segs);\n\n\treturn -EINVAL;\n#else\n\tVM_BUG_ON(iocb->ki_nbytes != PAGE_SIZE);\n\n\tif (rw == READ)\n\t\treturn nfs_file_direct_read(iocb, iter, pos);\n\treturn nfs_file_direct_write(iocb, iter, pos);\n#endif /* CONFIG_NFS_SWAP */\n}"
  },
  {
    "function_name": "nfs_direct_cmp_commit_data_verf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "226-239",
    "snippet": "static int nfs_direct_cmp_commit_data_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t   struct nfs_commit_data *data)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, data->ds_clp,\n\t\t\t\t\t data->ds_commit_index);\n\n\t/* verifier not set so always fail */\n\tif (verfp->committed < 0)\n\t\treturn 1;\n\n\treturn memcmp(verfp, &data->verf, sizeof(struct nfs_writeverf));\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "verfp",
            "&data->verf",
            "sizeof(struct nfs_writeverf)"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_select_verf",
          "args": [
            "dreq",
            "data->ds_clp",
            "data->ds_commit_index"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_select_verf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "158-175",
          "snippet": "static struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic int nfs_direct_cmp_commit_data_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t   struct nfs_commit_data *data)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, data->ds_clp,\n\t\t\t\t\t data->ds_commit_index);\n\n\t/* verifier not set so always fail */\n\tif (verfp->committed < 0)\n\t\treturn 1;\n\n\treturn memcmp(verfp, &data->verf, sizeof(struct nfs_writeverf));\n}"
  },
  {
    "function_name": "nfs_direct_set_or_cmp_hdr_verf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "205-216",
    "snippet": "static int nfs_direct_set_or_cmp_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tif (verfp->committed < 0) {\n\t\tnfs_direct_set_hdr_verf(dreq, hdr);\n\t\treturn 0;\n\t}\n\treturn memcmp(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "verfp",
            "&hdr->verf",
            "sizeof(struct nfs_writeverf)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_set_hdr_verf",
          "args": [
            "dreq",
            "hdr"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_set_hdr_verf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "185-194",
          "snippet": "static void nfs_direct_set_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t    struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tWARN_ON_ONCE(verfp->committed >= 0);\n\tmemcpy(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n\tWARN_ON_ONCE(verfp->committed < 0);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_set_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t    struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tWARN_ON_ONCE(verfp->committed >= 0);\n\tmemcpy(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n\tWARN_ON_ONCE(verfp->committed < 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_direct_select_verf",
          "args": [
            "dreq",
            "hdr->ds_clp",
            "hdr->ds_commit_idx"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_select_verf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "158-175",
          "snippet": "static struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic int nfs_direct_set_or_cmp_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t\t  struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tif (verfp->committed < 0) {\n\t\tnfs_direct_set_hdr_verf(dreq, hdr);\n\t\treturn 0;\n\t}\n\treturn memcmp(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n}"
  },
  {
    "function_name": "nfs_direct_set_hdr_verf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "185-194",
    "snippet": "static void nfs_direct_set_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t    struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tWARN_ON_ONCE(verfp->committed >= 0);\n\tmemcpy(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n\tWARN_ON_ONCE(verfp->committed < 0);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "verfp->committed < 0"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "verfp",
            "&hdr->verf",
            "sizeof(struct nfs_writeverf)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "verfp->committed >= 0"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_direct_select_verf",
          "args": [
            "dreq",
            "hdr->ds_clp",
            "hdr->ds_commit_idx"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_select_verf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "158-175",
          "snippet": "static struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void nfs_direct_set_hdr_verf(struct nfs_direct_req *dreq,\n\t\t\t\t    struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_writeverf *verfp;\n\n\tverfp = nfs_direct_select_verf(dreq, hdr->ds_clp, hdr->ds_commit_idx);\n\tWARN_ON_ONCE(verfp->committed >= 0);\n\tmemcpy(verfp, &hdr->verf, sizeof(struct nfs_writeverf));\n\tWARN_ON_ONCE(verfp->committed < 0);\n}"
  },
  {
    "function_name": "nfs_direct_select_verf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "158-175",
    "snippet": "static struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct nfs_writeverf *\nnfs_direct_select_verf(struct nfs_direct_req *dreq,\n\t\t       struct nfs_client *ds_clp,\n\t\t       int commit_idx)\n{\n\tstruct nfs_writeverf *verfp = &dreq->verf;\n\n#ifdef CONFIG_NFS_V4_1\n\tif (ds_clp) {\n\t\t/* pNFS is in use, use the DS verf */\n\t\tif (commit_idx >= 0 && commit_idx < dreq->ds_cinfo.nbuckets)\n\t\t\tverfp = &dreq->ds_cinfo.buckets[commit_idx].direct_verf;\n\t\telse\n\t\t\tWARN_ON_ONCE(1);\n\t}\n#endif\n\treturn verfp;\n}"
  },
  {
    "function_name": "nfs_direct_good_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "126-148",
    "snippet": "static void\nnfs_direct_good_bytes(struct nfs_direct_req *dreq, struct nfs_pgio_header *hdr)\n{\n\tint i;\n\tssize_t count;\n\n\tWARN_ON_ONCE(hdr->pgio_mirror_idx >= dreq->mirror_count);\n\n\tcount = dreq->mirrors[hdr->pgio_mirror_idx].count;\n\tif (count + dreq->io_start < hdr->io_start + hdr->good_bytes) {\n\t\tcount = hdr->io_start + hdr->good_bytes - dreq->io_start;\n\t\tdreq->mirrors[hdr->pgio_mirror_idx].count = count;\n\t}\n\n\t/* update the dreq->count by finding the minimum agreed count from all\n\t * mirrors */\n\tcount = dreq->mirrors[0].count;\n\n\tfor (i = 1; i < dreq->mirror_count; i++)\n\t\tcount = min(count, dreq->mirrors[i].count);\n\n\tdreq->count = count;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min",
          "args": [
            "count",
            "dreq->mirrors[i].count"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "hdr->pgio_mirror_idx >= dreq->mirror_count"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void\nnfs_direct_good_bytes(struct nfs_direct_req *dreq, struct nfs_pgio_header *hdr)\n{\n\tint i;\n\tssize_t count;\n\n\tWARN_ON_ONCE(hdr->pgio_mirror_idx >= dreq->mirror_count);\n\n\tcount = dreq->mirrors[hdr->pgio_mirror_idx].count;\n\tif (count + dreq->io_start < hdr->io_start + hdr->good_bytes) {\n\t\tcount = hdr->io_start + hdr->good_bytes - dreq->io_start;\n\t\tdreq->mirrors[hdr->pgio_mirror_idx].count = count;\n\t}\n\n\t/* update the dreq->count by finding the minimum agreed count from all\n\t * mirrors */\n\tcount = dreq->mirrors[0].count;\n\n\tfor (i = 1; i < dreq->mirror_count; i++)\n\t\tcount = min(count, dreq->mirrors[i].count);\n\n\tdreq->count = count;\n}"
  },
  {
    "function_name": "nfs_direct_set_resched_writes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "120-123",
    "snippet": "void nfs_direct_set_resched_writes(struct nfs_direct_req *dreq)\n{\n\tdreq->flags = NFS_ODIRECT_RESCHED_WRITES;\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */\n\nvoid nfs_direct_set_resched_writes(struct nfs_direct_req *dreq)\n{\n\tdreq->flags = NFS_ODIRECT_RESCHED_WRITES;\n}"
  },
  {
    "function_name": "put_dreq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "115-118",
    "snippet": "static inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&dreq->io_count"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int put_dreq(struct nfs_direct_req *dreq)\n{\n\treturn atomic_dec_and_test(&dreq->io_count);\n}"
  },
  {
    "function_name": "get_dreq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
    "lines": "110-113",
    "snippet": "static inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}",
    "includes": [
      "#include \"pnfs.h\"",
      "#include \"iostat.h\"",
      "#include \"internal.h\"",
      "#include <linux/atomic.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/slab.h>",
      "#include <linux/kref.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/file.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&dreq->io_count"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void get_dreq(struct nfs_direct_req *dreq)\n{\n\tatomic_inc(&dreq->io_count);\n}"
  }
]