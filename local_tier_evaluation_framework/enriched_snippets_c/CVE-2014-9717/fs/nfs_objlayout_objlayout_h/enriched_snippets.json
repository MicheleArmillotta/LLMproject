[
  {
    "function_name": "objlayout_add_delta_space_used",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/objlayout.h",
    "lines": "132-145",
    "snippet": "static inline void\nobjlayout_add_delta_space_used(struct objlayout *objlay, s64 space_used)\n{\n\t/* If one of the I/Os errored out and the delta_space_used was\n\t * invalid we render the complete report as invalid. Protocol mandate\n\t * the DSU be accurate or not reported.\n\t */\n\tspin_lock(&objlay->lock);\n\tif (objlay->delta_space_valid != OBJ_DSU_INVALID) {\n\t\tobjlay->delta_space_valid = OBJ_DSU_VALID;\n\t\tobjlay->delta_space_used += space_used;\n\t}\n\tspin_unlock(&objlay->lock);\n}",
    "includes": [
      "#include \"../pnfs.h\"",
      "#include <linux/pnfs_osd_xdr.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&objlay->lock"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&objlay->lock"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n#include <linux/pnfs_osd_xdr.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void\nobjlayout_add_delta_space_used(struct objlayout *objlay, s64 space_used)\n{\n\t/* If one of the I/Os errored out and the delta_space_used was\n\t * invalid we render the complete report as invalid. Protocol mandate\n\t * the DSU be accurate or not reported.\n\t */\n\tspin_lock(&objlay->lock);\n\tif (objlay->delta_space_valid != OBJ_DSU_INVALID) {\n\t\tobjlay->delta_space_valid = OBJ_DSU_VALID;\n\t\tobjlay->delta_space_used += space_used;\n\t}\n\tspin_unlock(&objlay->lock);\n}"
  },
  {
    "function_name": "objlayout_init_ioerrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/objlayout.h",
    "lines": "95-105",
    "snippet": "static inline\nvoid objlayout_init_ioerrs(struct objlayout_io_res *oir, unsigned num_comps,\n\t\t\tstruct pnfs_osd_ioerr *ioerrs, void *rpcdata,\n\t\t\tstruct pnfs_layout_hdr *pnfs_layout_type)\n{\n\toir->objlay = OBJLAYOUT(pnfs_layout_type);\n\toir->rpcdata = rpcdata;\n\tINIT_LIST_HEAD(&oir->err_list);\n\toir->num_comps = num_comps;\n\toir->ioerrs = ioerrs;\n}",
    "includes": [
      "#include \"../pnfs.h\"",
      "#include <linux/pnfs_osd_xdr.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&oir->err_list"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OBJLAYOUT",
          "args": [
            "pnfs_layout_type"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "OBJLAYOUT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/objlayout.h",
          "lines": "67-71",
          "snippet": "static inline struct objlayout *\nOBJLAYOUT(struct pnfs_layout_hdr *lo)\n{\n\treturn container_of(lo, struct objlayout, pnfs_layout);\n}",
          "includes": [
            "#include \"../pnfs.h\"",
            "#include <linux/pnfs_osd_xdr.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../pnfs.h\"\n#include <linux/pnfs_osd_xdr.h>\n#include <linux/nfs_fs.h>\n\nstatic inline struct objlayout *\nOBJLAYOUT(struct pnfs_layout_hdr *lo)\n{\n\treturn container_of(lo, struct objlayout, pnfs_layout);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n#include <linux/pnfs_osd_xdr.h>\n#include <linux/nfs_fs.h>\n\nstatic inline\nvoid objlayout_init_ioerrs(struct objlayout_io_res *oir, unsigned num_comps,\n\t\t\tstruct pnfs_osd_ioerr *ioerrs, void *rpcdata,\n\t\t\tstruct pnfs_layout_hdr *pnfs_layout_type)\n{\n\toir->objlay = OBJLAYOUT(pnfs_layout_type);\n\toir->rpcdata = rpcdata;\n\tINIT_LIST_HEAD(&oir->err_list);\n\toir->num_comps = num_comps;\n\toir->ioerrs = ioerrs;\n}"
  },
  {
    "function_name": "OBJLAYOUT",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/objlayout.h",
    "lines": "67-71",
    "snippet": "static inline struct objlayout *\nOBJLAYOUT(struct pnfs_layout_hdr *lo)\n{\n\treturn container_of(lo, struct objlayout, pnfs_layout);\n}",
    "includes": [
      "#include \"../pnfs.h\"",
      "#include <linux/pnfs_osd_xdr.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "lo",
            "structobjlayout",
            "pnfs_layout"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n#include <linux/pnfs_osd_xdr.h>\n#include <linux/nfs_fs.h>\n\nstatic inline struct objlayout *\nOBJLAYOUT(struct pnfs_layout_hdr *lo)\n{\n\treturn container_of(lo, struct objlayout, pnfs_layout);\n}"
  }
]