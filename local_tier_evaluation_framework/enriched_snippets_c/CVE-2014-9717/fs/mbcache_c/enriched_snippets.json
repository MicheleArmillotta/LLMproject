[
  {
    "function_name": "exit_mbcache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "851-854",
    "snippet": "static void __exit exit_mbcache(void)\n{\n\tunregister_shrinker(&mb_cache_shrinker);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct shrinker mb_cache_shrinker = {\n\t.count_objects = mb_cache_shrink_count,\n\t.scan_objects = mb_cache_shrink_scan,\n\t.seeks = DEFAULT_SEEKS,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_shrinker",
          "args": [
            "&mb_cache_shrinker"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct shrinker mb_cache_shrinker = {\n\t.count_objects = mb_cache_shrink_count,\n\t.scan_objects = mb_cache_shrink_scan,\n\t.seeks = DEFAULT_SEEKS,\n};\n\nstatic void __exit exit_mbcache(void)\n{\n\tunregister_shrinker(&mb_cache_shrinker);\n}"
  },
  {
    "function_name": "init_mbcache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "845-849",
    "snippet": "static int __init init_mbcache(void)\n{\n\tregister_shrinker(&mb_cache_shrinker);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct shrinker mb_cache_shrinker = {\n\t.count_objects = mb_cache_shrink_count,\n\t.scan_objects = mb_cache_shrink_scan,\n\t.seeks = DEFAULT_SEEKS,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_shrinker",
          "args": [
            "&mb_cache_shrinker"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct shrinker mb_cache_shrinker = {\n\t.count_objects = mb_cache_shrink_count,\n\t.scan_objects = mb_cache_shrink_scan,\n\t.seeks = DEFAULT_SEEKS,\n};\n\nstatic int __init init_mbcache(void)\n{\n\tregister_shrinker(&mb_cache_shrinker);\n\treturn 0;\n}"
  },
  {
    "function_name": "mb_cache_entry_find_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "823-841",
    "snippet": "struct mb_cache_entry *\nmb_cache_entry_find_next(struct mb_cache_entry *prev,\n\t\t\t struct block_device *bdev, unsigned int key)\n{\n\tstruct mb_cache *cache = prev->e_cache;\n\tunsigned int bucket = hash_long(key, cache->c_bucket_bits);\n\tstruct hlist_bl_node *l;\n\tstruct mb_cache_entry *ce;\n\tstruct hlist_bl_head *index_hash_p;\n\n\tindex_hash_p = &cache->c_index_hash[bucket];\n\tmb_assert(prev->e_index_hash_p == index_hash_p);\n\thlist_bl_lock(index_hash_p);\n\tmb_assert(!hlist_bl_empty(index_hash_p));\n\tl = prev->e_index.o_list.next;\n\tce = __mb_cache_entry_find(l, index_hash_p, bdev, key);\n\t__mb_cache_entry_release(prev);\n\treturn ce;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mb_cache_entry_release",
          "args": [
            "prev"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "200-234",
          "snippet": "static void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
          ],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
            "static LIST_HEAD(mb_cache_lru_list);",
            "static DEFINE_SPINLOCK(mb_cache_spinlock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_find",
          "args": [
            "l",
            "index_hash_p",
            "bdev",
            "key"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "718-770",
          "snippet": "static struct mb_cache_entry *\n__mb_cache_entry_find(struct hlist_bl_node *l, struct hlist_bl_head *head,\n\t\t      struct block_device *bdev, unsigned int key)\n{\n\n\t/* The index hash chain is alredy acquire by caller. */\n\twhile (l != NULL) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\thlist_bl_entry(l, struct mb_cache_entry,\n\t\t\t\te_index.o_list);\n\t\tmb_assert(ce->e_index_hash_p == head);\n\t\tif (ce->e_bdev == bdev && ce->e_index.o_key == key) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(head);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tce->e_used++;\n\t\t\t/* Incrementing before holding the lock gives readers\n\t\t\t   priority over writers. */\n\t\t\tif (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\tDEFINE_WAIT(wait);\n\n\t\t\t\twhile (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn ERR_PTR(-EAGAIN);\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t\tl = l->next;\n\t}\n\thlist_bl_unlock(head);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
          ],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
            "static DEFINE_SPINLOCK(mb_cache_spinlock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic struct mb_cache_entry *\n__mb_cache_entry_find(struct hlist_bl_node *l, struct hlist_bl_head *head,\n\t\t      struct block_device *bdev, unsigned int key)\n{\n\n\t/* The index hash chain is alredy acquire by caller. */\n\twhile (l != NULL) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\thlist_bl_entry(l, struct mb_cache_entry,\n\t\t\t\te_index.o_list);\n\t\tmb_assert(ce->e_index_hash_p == head);\n\t\tif (ce->e_bdev == bdev && ce->e_index.o_key == key) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(head);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tce->e_used++;\n\t\t\t/* Incrementing before holding the lock gives readers\n\t\t\t   priority over writers. */\n\t\t\tif (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\tDEFINE_WAIT(wait);\n\n\t\t\t\twhile (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn ERR_PTR(-EAGAIN);\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t\tl = l->next;\n\t}\n\thlist_bl_unlock(head);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "!hlist_bl_empty(index_hash_p)"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_empty",
          "args": [
            "index_hash_p"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "index_hash_p"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "prev->e_index_hash_p == index_hash_p"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_long",
          "args": [
            "key",
            "cache->c_bucket_bits"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstruct mb_cache_entry *\nmb_cache_entry_find_next(struct mb_cache_entry *prev,\n\t\t\t struct block_device *bdev, unsigned int key)\n{\n\tstruct mb_cache *cache = prev->e_cache;\n\tunsigned int bucket = hash_long(key, cache->c_bucket_bits);\n\tstruct hlist_bl_node *l;\n\tstruct mb_cache_entry *ce;\n\tstruct hlist_bl_head *index_hash_p;\n\n\tindex_hash_p = &cache->c_index_hash[bucket];\n\tmb_assert(prev->e_index_hash_p == index_hash_p);\n\thlist_bl_lock(index_hash_p);\n\tmb_assert(!hlist_bl_empty(index_hash_p));\n\tl = prev->e_index.o_list.next;\n\tce = __mb_cache_entry_find(l, index_hash_p, bdev, key);\n\t__mb_cache_entry_release(prev);\n\treturn ce;\n}"
  },
  {
    "function_name": "mb_cache_entry_find_first",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "785-802",
    "snippet": "struct mb_cache_entry *\nmb_cache_entry_find_first(struct mb_cache *cache, struct block_device *bdev,\n\t\t\t  unsigned int key)\n{\n\tunsigned int bucket = hash_long(key, cache->c_bucket_bits);\n\tstruct hlist_bl_node *l;\n\tstruct mb_cache_entry *ce = NULL;\n\tstruct hlist_bl_head *index_hash_p;\n\n\tindex_hash_p = &cache->c_index_hash[bucket];\n\thlist_bl_lock(index_hash_p);\n\tif (!hlist_bl_empty(index_hash_p)) {\n\t\tl = hlist_bl_first(index_hash_p);\n\t\tce = __mb_cache_entry_find(l, index_hash_p, bdev, key);\n\t} else\n\t\thlist_bl_unlock(index_hash_p);\n\treturn ce;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "index_hash_p"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_find",
          "args": [
            "l",
            "index_hash_p",
            "bdev",
            "key"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "718-770",
          "snippet": "static struct mb_cache_entry *\n__mb_cache_entry_find(struct hlist_bl_node *l, struct hlist_bl_head *head,\n\t\t      struct block_device *bdev, unsigned int key)\n{\n\n\t/* The index hash chain is alredy acquire by caller. */\n\twhile (l != NULL) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\thlist_bl_entry(l, struct mb_cache_entry,\n\t\t\t\te_index.o_list);\n\t\tmb_assert(ce->e_index_hash_p == head);\n\t\tif (ce->e_bdev == bdev && ce->e_index.o_key == key) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(head);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tce->e_used++;\n\t\t\t/* Incrementing before holding the lock gives readers\n\t\t\t   priority over writers. */\n\t\t\tif (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\tDEFINE_WAIT(wait);\n\n\t\t\t\twhile (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn ERR_PTR(-EAGAIN);\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t\tl = l->next;\n\t}\n\thlist_bl_unlock(head);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
          ],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
            "static DEFINE_SPINLOCK(mb_cache_spinlock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic struct mb_cache_entry *\n__mb_cache_entry_find(struct hlist_bl_node *l, struct hlist_bl_head *head,\n\t\t      struct block_device *bdev, unsigned int key)\n{\n\n\t/* The index hash chain is alredy acquire by caller. */\n\twhile (l != NULL) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\thlist_bl_entry(l, struct mb_cache_entry,\n\t\t\t\te_index.o_list);\n\t\tmb_assert(ce->e_index_hash_p == head);\n\t\tif (ce->e_bdev == bdev && ce->e_index.o_key == key) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(head);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tce->e_used++;\n\t\t\t/* Incrementing before holding the lock gives readers\n\t\t\t   priority over writers. */\n\t\t\tif (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\tDEFINE_WAIT(wait);\n\n\t\t\t\twhile (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn ERR_PTR(-EAGAIN);\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t\tl = l->next;\n\t}\n\thlist_bl_unlock(head);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_first",
          "args": [
            "index_hash_p"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_empty",
          "args": [
            "index_hash_p"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "index_hash_p"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_long",
          "args": [
            "key",
            "cache->c_bucket_bits"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstruct mb_cache_entry *\nmb_cache_entry_find_first(struct mb_cache *cache, struct block_device *bdev,\n\t\t\t  unsigned int key)\n{\n\tunsigned int bucket = hash_long(key, cache->c_bucket_bits);\n\tstruct hlist_bl_node *l;\n\tstruct mb_cache_entry *ce = NULL;\n\tstruct hlist_bl_head *index_hash_p;\n\n\tindex_hash_p = &cache->c_index_hash[bucket];\n\thlist_bl_lock(index_hash_p);\n\tif (!hlist_bl_empty(index_hash_p)) {\n\t\tl = hlist_bl_first(index_hash_p);\n\t\tce = __mb_cache_entry_find(l, index_hash_p, bdev, key);\n\t} else\n\t\thlist_bl_unlock(index_hash_p);\n\treturn ce;\n}"
  },
  {
    "function_name": "__mb_cache_entry_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "718-770",
    "snippet": "static struct mb_cache_entry *\n__mb_cache_entry_find(struct hlist_bl_node *l, struct hlist_bl_head *head,\n\t\t      struct block_device *bdev, unsigned int key)\n{\n\n\t/* The index hash chain is alredy acquire by caller. */\n\twhile (l != NULL) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\thlist_bl_entry(l, struct mb_cache_entry,\n\t\t\t\te_index.o_list);\n\t\tmb_assert(ce->e_index_hash_p == head);\n\t\tif (ce->e_bdev == bdev && ce->e_index.o_key == key) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(head);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tce->e_used++;\n\t\t\t/* Incrementing before holding the lock gives readers\n\t\t\t   priority over writers. */\n\t\t\tif (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\tDEFINE_WAIT(wait);\n\n\t\t\t\twhile (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn ERR_PTR(-EAGAIN);\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t\tl = l->next;\n\t}\n\thlist_bl_unlock(head);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
    ],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EAGAIN"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_release",
          "args": [
            "ce"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "200-234",
          "snippet": "static void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
          ],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
            "static LIST_HEAD(mb_cache_lru_list);",
            "static DEFINE_SPINLOCK(mb_cache_spinlock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_is_block_hashed",
          "args": [
            "ce"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_is_block_hashed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "146-150",
          "snippet": "static inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "finish_wait",
          "args": [
            "&mb_cache_queue",
            "&wait"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule",
          "args": [],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_to_wait",
          "args": [
            "&mb_cache_queue",
            "&wait",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEFINE_WAIT",
          "args": [
            "wait"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "ce->e_index_hash_p == head"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_entry",
          "args": [
            "l",
            "structmb_cache_entry",
            "e_index.o_list"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic struct mb_cache_entry *\n__mb_cache_entry_find(struct hlist_bl_node *l, struct hlist_bl_head *head,\n\t\t      struct block_device *bdev, unsigned int key)\n{\n\n\t/* The index hash chain is alredy acquire by caller. */\n\twhile (l != NULL) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\thlist_bl_entry(l, struct mb_cache_entry,\n\t\t\t\te_index.o_list);\n\t\tmb_assert(ce->e_index_hash_p == head);\n\t\tif (ce->e_bdev == bdev && ce->e_index.o_key == key) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(head);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tce->e_used++;\n\t\t\t/* Incrementing before holding the lock gives readers\n\t\t\t   priority over writers. */\n\t\t\tif (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\tDEFINE_WAIT(wait);\n\n\t\t\t\twhile (ce->e_used >= MB_CACHE_WRITER) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn ERR_PTR(-EAGAIN);\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t\tl = l->next;\n\t}\n\thlist_bl_unlock(head);\n\treturn NULL;\n}"
  },
  {
    "function_name": "mb_cache_entry_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "660-714",
    "snippet": "struct mb_cache_entry *\nmb_cache_entry_get(struct mb_cache *cache, struct block_device *bdev,\n\t\t   sector_t block)\n{\n\tunsigned int bucket;\n\tstruct hlist_bl_node *l;\n\tstruct mb_cache_entry *ce;\n\tstruct hlist_bl_head *block_hash_p;\n\n\tbucket = hash_long((unsigned long)bdev + (block & 0xffffffff),\n\t\t\t   cache->c_bucket_bits);\n\tblock_hash_p = &cache->c_block_hash[bucket];\n\t/* First serialize access to the block corresponding hash chain. */\n\thlist_bl_lock(block_hash_p);\n\thlist_bl_for_each_entry(ce, l, block_hash_p, e_block_list) {\n\t\tmb_assert(ce->e_block_hash_p == block_hash_p);\n\t\tif (ce->e_bdev == bdev && ce->e_block == block) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(block_hash_p);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tif (ce->e_used > 0) {\n\t\t\t\tDEFINE_WAIT(wait);\n\t\t\t\twhile (ce->e_used > 0) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\tce->e_used += 1 + MB_CACHE_WRITER;\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn NULL;\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t}\n\thlist_bl_unlock(block_hash_p);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
    ],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "block_hash_p"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_release",
          "args": [
            "ce"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "200-234",
          "snippet": "static void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
          ],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
            "static LIST_HEAD(mb_cache_lru_list);",
            "static DEFINE_SPINLOCK(mb_cache_spinlock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_is_block_hashed",
          "args": [
            "ce"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_is_block_hashed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "146-150",
          "snippet": "static inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "finish_wait",
          "args": [
            "&mb_cache_queue",
            "&wait"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule",
          "args": [],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_to_wait",
          "args": [
            "&mb_cache_queue",
            "&wait",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEFINE_WAIT",
          "args": [
            "wait"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "block_hash_p"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "ce->e_block_hash_p == block_hash_p"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_for_each_entry",
          "args": [
            "ce",
            "l",
            "block_hash_p",
            "e_block_list"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "block_hash_p"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_long",
          "args": [
            "(unsigned long)bdev + (block & 0xffffffff)",
            "cache->c_bucket_bits"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstruct mb_cache_entry *\nmb_cache_entry_get(struct mb_cache *cache, struct block_device *bdev,\n\t\t   sector_t block)\n{\n\tunsigned int bucket;\n\tstruct hlist_bl_node *l;\n\tstruct mb_cache_entry *ce;\n\tstruct hlist_bl_head *block_hash_p;\n\n\tbucket = hash_long((unsigned long)bdev + (block & 0xffffffff),\n\t\t\t   cache->c_bucket_bits);\n\tblock_hash_p = &cache->c_block_hash[bucket];\n\t/* First serialize access to the block corresponding hash chain. */\n\thlist_bl_lock(block_hash_p);\n\thlist_bl_for_each_entry(ce, l, block_hash_p, e_block_list) {\n\t\tmb_assert(ce->e_block_hash_p == block_hash_p);\n\t\tif (ce->e_bdev == bdev && ce->e_block == block) {\n\t\t\t/*\n\t\t\t * Prevent a free from removing the entry.\n\t\t\t */\n\t\t\tatomic_inc(&ce->e_refcnt);\n\t\t\thlist_bl_unlock(block_hash_p);\n\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\tatomic_dec(&ce->e_refcnt);\n\t\t\tif (ce->e_used > 0) {\n\t\t\t\tDEFINE_WAIT(wait);\n\t\t\t\twhile (ce->e_used > 0) {\n\t\t\t\t\tce->e_queued++;\n\t\t\t\t\tprepare_to_wait(&mb_cache_queue, &wait,\n\t\t\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\t\t\tschedule();\n\t\t\t\t\t__spin_lock_mb_cache_entry(ce);\n\t\t\t\t\tce->e_queued--;\n\t\t\t\t}\n\t\t\t\tfinish_wait(&mb_cache_queue, &wait);\n\t\t\t}\n\t\t\tce->e_used += 1 + MB_CACHE_WRITER;\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\n\t\t\tif (!list_empty(&ce->e_lru_list)) {\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t}\n\t\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t\t__mb_cache_entry_release(ce);\n\t\t\t\treturn NULL;\n\t\t\t}\n\t\t\treturn ce;\n\t\t}\n\t}\n\thlist_bl_unlock(block_hash_p);\n\treturn NULL;\n}"
  },
  {
    "function_name": "mb_cache_entry_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "637-649",
    "snippet": "void\nmb_cache_entry_free(struct mb_cache_entry *ce)\n{\n\tmb_assert(ce);\n\tmb_assert(list_empty(&ce->e_lru_list));\n\thlist_bl_lock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\thlist_bl_lock(ce->e_block_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n\t__mb_cache_entry_release(ce);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mb_cache_entry_release",
          "args": [
            "ce"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "200-234",
          "snippet": "static void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
          ],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
            "static LIST_HEAD(mb_cache_lru_list);",
            "static DEFINE_SPINLOCK(mb_cache_spinlock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_block",
          "args": [
            "ce"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "153-158",
          "snippet": "static inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_index",
          "args": [
            "ce"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "166-171",
          "snippet": "static inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "list_empty(&ce->e_lru_list)"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "ce"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nvoid\nmb_cache_entry_free(struct mb_cache_entry *ce)\n{\n\tmb_assert(ce);\n\tmb_assert(list_empty(&ce->e_lru_list));\n\thlist_bl_lock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\thlist_bl_lock(ce->e_block_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n\t__mb_cache_entry_release(ce);\n}"
  },
  {
    "function_name": "mb_cache_entry_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "626-630",
    "snippet": "void\nmb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_release(ce);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mb_cache_entry_release",
          "args": [
            "ce"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "200-234",
          "snippet": "static void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
          ],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
            "static LIST_HEAD(mb_cache_lru_list);",
            "static DEFINE_SPINLOCK(mb_cache_spinlock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nvoid\nmb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_release(ce);\n}"
  },
  {
    "function_name": "mb_cache_entry_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "578-616",
    "snippet": "int\nmb_cache_entry_insert(struct mb_cache_entry *ce, struct block_device *bdev,\n\t\t      sector_t block, unsigned int key)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\tunsigned int bucket;\n\tstruct hlist_bl_node *l;\n\tstruct hlist_bl_head *block_hash_p;\n\tstruct hlist_bl_head *index_hash_p;\n\tstruct mb_cache_entry *lce;\n\n\tmb_assert(ce);\n\tbucket = hash_long((unsigned long)bdev + (block & 0xffffffff), \n\t\t\t   cache->c_bucket_bits);\n\tblock_hash_p = &cache->c_block_hash[bucket];\n\thlist_bl_lock(block_hash_p);\n\thlist_bl_for_each_entry(lce, l, block_hash_p, e_block_list) {\n\t\tif (lce->e_bdev == bdev && lce->e_block == block) {\n\t\t\thlist_bl_unlock(block_hash_p);\n\t\t\treturn -EBUSY;\n\t\t}\n\t}\n\tmb_assert(!__mb_cache_entry_is_block_hashed(ce));\n\t__mb_cache_entry_unhash_block(ce);\n\t__mb_cache_entry_unhash_index(ce);\n\tce->e_bdev = bdev;\n\tce->e_block = block;\n\tce->e_block_hash_p = block_hash_p;\n\tce->e_index.o_key = key;\n\thlist_bl_add_head(&ce->e_block_list, block_hash_p);\n\thlist_bl_unlock(block_hash_p);\n\tbucket = hash_long(key, cache->c_bucket_bits);\n\tindex_hash_p = &cache->c_index_hash[bucket];\n\thlist_bl_lock(index_hash_p);\n\tce->e_index_hash_p = index_hash_p;\n\thlist_bl_add_head(&ce->e_index.o_list, index_hash_p);\n\thlist_bl_unlock(index_hash_p);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "index_hash_p"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_add_head",
          "args": [
            "&ce->e_index.o_list",
            "index_hash_p"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "index_hash_p"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_long",
          "args": [
            "key",
            "cache->c_bucket_bits"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "block_hash_p"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_add_head",
          "args": [
            "&ce->e_block_list",
            "block_hash_p"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_index",
          "args": [
            "ce"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "166-171",
          "snippet": "static inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_block",
          "args": [
            "ce"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "153-158",
          "snippet": "static inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "!__mb_cache_entry_is_block_hashed(ce)"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_is_block_hashed",
          "args": [
            "ce"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_is_block_hashed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "146-150",
          "snippet": "static inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "block_hash_p"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_for_each_entry",
          "args": [
            "lce",
            "l",
            "block_hash_p",
            "e_block_list"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "block_hash_p"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_long",
          "args": [
            "(unsigned long)bdev + (block & 0xffffffff)",
            "cache->c_bucket_bits"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "ce"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nint\nmb_cache_entry_insert(struct mb_cache_entry *ce, struct block_device *bdev,\n\t\t      sector_t block, unsigned int key)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\tunsigned int bucket;\n\tstruct hlist_bl_node *l;\n\tstruct hlist_bl_head *block_hash_p;\n\tstruct hlist_bl_head *index_hash_p;\n\tstruct mb_cache_entry *lce;\n\n\tmb_assert(ce);\n\tbucket = hash_long((unsigned long)bdev + (block & 0xffffffff), \n\t\t\t   cache->c_bucket_bits);\n\tblock_hash_p = &cache->c_block_hash[bucket];\n\thlist_bl_lock(block_hash_p);\n\thlist_bl_for_each_entry(lce, l, block_hash_p, e_block_list) {\n\t\tif (lce->e_bdev == bdev && lce->e_block == block) {\n\t\t\thlist_bl_unlock(block_hash_p);\n\t\t\treturn -EBUSY;\n\t\t}\n\t}\n\tmb_assert(!__mb_cache_entry_is_block_hashed(ce));\n\t__mb_cache_entry_unhash_block(ce);\n\t__mb_cache_entry_unhash_index(ce);\n\tce->e_bdev = bdev;\n\tce->e_block = block;\n\tce->e_block_hash_p = block_hash_p;\n\tce->e_index.o_key = key;\n\thlist_bl_add_head(&ce->e_block_list, block_hash_p);\n\thlist_bl_unlock(block_hash_p);\n\tbucket = hash_long(key, cache->c_bucket_bits);\n\tindex_hash_p = &cache->c_index_hash[bucket];\n\thlist_bl_lock(index_hash_p);\n\tce->e_index_hash_p = index_hash_p;\n\thlist_bl_add_head(&ce->e_index.o_list, index_hash_p);\n\thlist_bl_unlock(index_hash_p);\n\treturn 0;\n}"
  },
  {
    "function_name": "mb_cache_entry_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "501-561",
    "snippet": "struct mb_cache_entry *\nmb_cache_entry_alloc(struct mb_cache *cache, gfp_t gfp_flags)\n{\n\tstruct mb_cache_entry *ce;\n\n\tif (atomic_read(&cache->c_entry_count) >= cache->c_max_entries) {\n\t\tstruct list_head *l;\n\n\t\tl = &mb_cache_lru_list;\n\t\tspin_lock(&mb_cache_spinlock);\n\t\twhile (!list_is_last(l, &mb_cache_lru_list)) {\n\t\t\tl = l->next;\n\t\t\tce = list_entry(l, struct mb_cache_entry, e_lru_list);\n\t\t\tif (ce->e_cache == cache) {\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\t\tatomic_read(&ce->e_refcnt))\n\t\t\t\t\tcontinue;\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t\t/*\n\t\t\t\t * Prevent any find or get operation on the\n\t\t\t\t * entry.\n\t\t\t\t */\n\t\t\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\t\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\t\t\t/* Ignore if it is touched by a find/get */\n\t\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\t\tatomic_read(&ce->e_refcnt) ||\n\t\t\t\t\t!list_empty(&ce->e_lru_list)) {\n\t\t\t\t\thlist_bl_unlock(ce->e_index_hash_p);\n\t\t\t\t\thlist_bl_unlock(ce->e_block_hash_p);\n\t\t\t\t\tl = &mb_cache_lru_list;\n\t\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tmb_assert(list_empty(&ce->e_lru_list));\n\t\t\t\tmb_assert(!(ce->e_used || ce->e_queued ||\n\t\t\t\t\tatomic_read(&ce->e_refcnt)));\n\t\t\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\t\t\tgoto found;\n\t\t\t}\n\t\t}\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\n\tce = kmem_cache_alloc(cache->c_entry_cache, gfp_flags);\n\tif (!ce)\n\t\treturn NULL;\n\tatomic_inc(&cache->c_entry_count);\n\tINIT_LIST_HEAD(&ce->e_lru_list);\n\tINIT_HLIST_BL_NODE(&ce->e_block_list);\n\tINIT_HLIST_BL_NODE(&ce->e_index.o_list);\n\tce->e_cache = cache;\n\tce->e_queued = 0;\n\tatomic_set(&ce->e_refcnt, 0);\nfound:\n\tce->e_block_hash_p = &cache->c_block_hash[0];\n\tce->e_index_hash_p = &cache->c_index_hash[0];\n\tce->e_used = 1 + MB_CACHE_WRITER;\n\treturn ce;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
    ],
    "globals_used": [
      "static LIST_HEAD(mb_cache_lru_list);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&ce->e_refcnt",
            "0"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_BL_NODE",
          "args": [
            "&ce->e_index.o_list"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_BL_NODE",
          "args": [
            "&ce->e_block_list"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&cache->c_entry_count"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "cache->c_entry_cache",
            "gfp_flags"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_unlock",
          "args": [
            "ce"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "181-188",
          "snippet": "static inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "!(ce->e_used || ce->e_queued ||\n\t\t\t\t\tatomic_read(&ce->e_refcnt))"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "list_empty(&ce->e_lru_list)"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "l",
            "structmb_cache_entry",
            "e_lru_list"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "l",
            "&mb_cache_lru_list"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&cache->c_entry_count"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstruct mb_cache_entry *\nmb_cache_entry_alloc(struct mb_cache *cache, gfp_t gfp_flags)\n{\n\tstruct mb_cache_entry *ce;\n\n\tif (atomic_read(&cache->c_entry_count) >= cache->c_max_entries) {\n\t\tstruct list_head *l;\n\n\t\tl = &mb_cache_lru_list;\n\t\tspin_lock(&mb_cache_spinlock);\n\t\twhile (!list_is_last(l, &mb_cache_lru_list)) {\n\t\t\tl = l->next;\n\t\t\tce = list_entry(l, struct mb_cache_entry, e_lru_list);\n\t\t\tif (ce->e_cache == cache) {\n\t\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\t\tatomic_read(&ce->e_refcnt))\n\t\t\t\t\tcontinue;\n\t\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t\t/*\n\t\t\t\t * Prevent any find or get operation on the\n\t\t\t\t * entry.\n\t\t\t\t */\n\t\t\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\t\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\t\t\t/* Ignore if it is touched by a find/get */\n\t\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\t\tatomic_read(&ce->e_refcnt) ||\n\t\t\t\t\t!list_empty(&ce->e_lru_list)) {\n\t\t\t\t\thlist_bl_unlock(ce->e_index_hash_p);\n\t\t\t\t\thlist_bl_unlock(ce->e_block_hash_p);\n\t\t\t\t\tl = &mb_cache_lru_list;\n\t\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tmb_assert(list_empty(&ce->e_lru_list));\n\t\t\t\tmb_assert(!(ce->e_used || ce->e_queued ||\n\t\t\t\t\tatomic_read(&ce->e_refcnt)));\n\t\t\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\t\t\tgoto found;\n\t\t\t}\n\t\t}\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\n\tce = kmem_cache_alloc(cache->c_entry_cache, gfp_flags);\n\tif (!ce)\n\t\treturn NULL;\n\tatomic_inc(&cache->c_entry_count);\n\tINIT_LIST_HEAD(&ce->e_lru_list);\n\tINIT_HLIST_BL_NODE(&ce->e_block_list);\n\tINIT_HLIST_BL_NODE(&ce->e_index.o_list);\n\tce->e_cache = cache;\n\tce->e_queued = 0;\n\tatomic_set(&ce->e_refcnt, 0);\nfound:\n\tce->e_block_hash_p = &cache->c_block_hash[0];\n\tce->e_index_hash_p = &cache->c_index_hash[0];\n\tce->e_used = 1 + MB_CACHE_WRITER;\n\treturn ce;\n}"
  },
  {
    "function_name": "mb_cache_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "451-491",
    "snippet": "void\nmb_cache_destroy(struct mb_cache *cache)\n{\n\tLIST_HEAD(free_list);\n\tstruct mb_cache_entry *ce, *tmp;\n\n\tspin_lock(&mb_cache_spinlock);\n\tlist_for_each_entry_safe(ce, tmp, &mb_cache_lru_list, e_lru_list) {\n\t\tif (ce->e_cache == cache)\n\t\t\tlist_move_tail(&ce->e_lru_list, &free_list);\n\t}\n\tlist_del(&cache->c_cache_list);\n\tspin_unlock(&mb_cache_spinlock);\n\n\tlist_for_each_entry_safe(ce, tmp, &free_list, e_lru_list) {\n\t\tlist_del_init(&ce->e_lru_list);\n\t\t/*\n\t\t * Prevent any find or get operation on the entry.\n\t\t */\n\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\tmb_assert(!(ce->e_used || ce->e_queued ||\n\t\t\tatomic_read(&ce->e_refcnt)));\n\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n\t}\n\n\tif (atomic_read(&cache->c_entry_count) > 0) {\n\t\tmb_error(\"cache %s: %d orphaned entries\",\n\t\t\t  cache->c_name,\n\t\t\t  atomic_read(&cache->c_entry_count));\n\t}\n\n\tif (list_empty(&mb_cache_list)) {\n\t\tkmem_cache_destroy(mb_cache_kmem_cache);\n\t\tmb_cache_kmem_cache = NULL;\n\t}\n\tkfree(cache->c_index_hash);\n\tkfree(cache->c_block_hash);\n\tkfree(cache);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *mb_cache_kmem_cache;",
      "static LIST_HEAD(mb_cache_list);",
      "static LIST_HEAD(mb_cache_lru_list);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache->c_block_hash"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache->c_index_hash"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "mb_cache_kmem_cache"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&mb_cache_list"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_error",
          "args": [
            "\"cache %s: %d orphaned entries\"",
            "cache->c_name",
            "atomic_read(&cache->c_entry_count)"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&cache->c_entry_count"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&cache->c_entry_count"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_forget",
          "args": [
            "ce",
            "GFP_KERNEL"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_forget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "190-198",
          "snippet": "static void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_unlock",
          "args": [
            "ce"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "181-188",
          "snippet": "static inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "!(ce->e_used || ce->e_queued ||\n\t\t\tatomic_read(&ce->e_refcnt))"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "ce",
            "tmp",
            "&free_list",
            "e_lru_list"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&cache->c_cache_list"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_move_tail",
          "args": [
            "&ce->e_lru_list",
            "&free_list"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "ce",
            "tmp",
            "&mb_cache_lru_list",
            "e_lru_list"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "free_list"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *mb_cache_kmem_cache;\nstatic LIST_HEAD(mb_cache_list);\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nvoid\nmb_cache_destroy(struct mb_cache *cache)\n{\n\tLIST_HEAD(free_list);\n\tstruct mb_cache_entry *ce, *tmp;\n\n\tspin_lock(&mb_cache_spinlock);\n\tlist_for_each_entry_safe(ce, tmp, &mb_cache_lru_list, e_lru_list) {\n\t\tif (ce->e_cache == cache)\n\t\t\tlist_move_tail(&ce->e_lru_list, &free_list);\n\t}\n\tlist_del(&cache->c_cache_list);\n\tspin_unlock(&mb_cache_spinlock);\n\n\tlist_for_each_entry_safe(ce, tmp, &free_list, e_lru_list) {\n\t\tlist_del_init(&ce->e_lru_list);\n\t\t/*\n\t\t * Prevent any find or get operation on the entry.\n\t\t */\n\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\tmb_assert(!(ce->e_used || ce->e_queued ||\n\t\t\tatomic_read(&ce->e_refcnt)));\n\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n\t}\n\n\tif (atomic_read(&cache->c_entry_count) > 0) {\n\t\tmb_error(\"cache %s: %d orphaned entries\",\n\t\t\t  cache->c_name,\n\t\t\t  atomic_read(&cache->c_entry_count));\n\t}\n\n\tif (list_empty(&mb_cache_list)) {\n\t\tkmem_cache_destroy(mb_cache_kmem_cache);\n\t\tmb_cache_kmem_cache = NULL;\n\t}\n\tkfree(cache->c_index_hash);\n\tkfree(cache->c_block_hash);\n\tkfree(cache);\n}"
  },
  {
    "function_name": "mb_cache_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "395-441",
    "snippet": "void\nmb_cache_shrink(struct block_device *bdev)\n{\n\tLIST_HEAD(free_list);\n\tstruct list_head *l;\n\tstruct mb_cache_entry *ce, *tmp;\n\n\tl = &mb_cache_lru_list;\n\tspin_lock(&mb_cache_spinlock);\n\twhile (!list_is_last(l, &mb_cache_lru_list)) {\n\t\tl = l->next;\n\t\tce = list_entry(l, struct mb_cache_entry, e_lru_list);\n\t\tif (ce->e_bdev == bdev) {\n\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\tatomic_read(&ce->e_refcnt))\n\t\t\t\tcontinue;\n\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t/*\n\t\t\t * Prevent any find or get operation on the entry.\n\t\t\t */\n\t\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\t\t/* Ignore if it is touched by a find/get */\n\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\tatomic_read(&ce->e_refcnt) ||\n\t\t\t\t!list_empty(&ce->e_lru_list)) {\n\t\t\t\thlist_bl_unlock(ce->e_index_hash_p);\n\t\t\t\thlist_bl_unlock(ce->e_block_hash_p);\n\t\t\t\tl = &mb_cache_lru_list;\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\t\tmb_assert(!(ce->e_used || ce->e_queued ||\n\t\t\t\tatomic_read(&ce->e_refcnt)));\n\t\t\tlist_add_tail(&ce->e_lru_list, &free_list);\n\t\t\tl = &mb_cache_lru_list;\n\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t}\n\t}\n\tspin_unlock(&mb_cache_spinlock);\n\n\tlist_for_each_entry_safe(ce, tmp, &free_list, e_lru_list) {\n\t\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n\t}\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(mb_cache_lru_list);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mb_cache_entry_forget",
          "args": [
            "ce",
            "GFP_KERNEL"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_forget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "190-198",
          "snippet": "static void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "ce",
            "tmp",
            "&free_list",
            "e_lru_list"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&ce->e_lru_list",
            "&free_list"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "!(ce->e_used || ce->e_queued ||\n\t\t\t\tatomic_read(&ce->e_refcnt))"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_unlock",
          "args": [
            "ce"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "181-188",
          "snippet": "static inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "l",
            "structmb_cache_entry",
            "e_lru_list"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "l",
            "&mb_cache_lru_list"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "free_list"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nvoid\nmb_cache_shrink(struct block_device *bdev)\n{\n\tLIST_HEAD(free_list);\n\tstruct list_head *l;\n\tstruct mb_cache_entry *ce, *tmp;\n\n\tl = &mb_cache_lru_list;\n\tspin_lock(&mb_cache_spinlock);\n\twhile (!list_is_last(l, &mb_cache_lru_list)) {\n\t\tl = l->next;\n\t\tce = list_entry(l, struct mb_cache_entry, e_lru_list);\n\t\tif (ce->e_bdev == bdev) {\n\t\t\tlist_del_init(&ce->e_lru_list);\n\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\tatomic_read(&ce->e_refcnt))\n\t\t\t\tcontinue;\n\t\t\tspin_unlock(&mb_cache_spinlock);\n\t\t\t/*\n\t\t\t * Prevent any find or get operation on the entry.\n\t\t\t */\n\t\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\t\t/* Ignore if it is touched by a find/get */\n\t\t\tif (ce->e_used || ce->e_queued ||\n\t\t\t\tatomic_read(&ce->e_refcnt) ||\n\t\t\t\t!list_empty(&ce->e_lru_list)) {\n\t\t\t\thlist_bl_unlock(ce->e_index_hash_p);\n\t\t\t\thlist_bl_unlock(ce->e_block_hash_p);\n\t\t\t\tl = &mb_cache_lru_list;\n\t\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\t\tmb_assert(!(ce->e_used || ce->e_queued ||\n\t\t\t\tatomic_read(&ce->e_refcnt)));\n\t\t\tlist_add_tail(&ce->e_lru_list, &free_list);\n\t\t\tl = &mb_cache_lru_list;\n\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t}\n\t}\n\tspin_unlock(&mb_cache_spinlock);\n\n\tlist_for_each_entry_safe(ce, tmp, &free_list, e_lru_list) {\n\t\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n\t}\n}"
  },
  {
    "function_name": "mb_cache_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "324-383",
    "snippet": "struct mb_cache *\nmb_cache_create(const char *name, int bucket_bits)\n{\n\tint n, bucket_count = 1 << bucket_bits;\n\tstruct mb_cache *cache = NULL;\n\n\tif (!mb_cache_bg_lock) {\n\t\tmb_cache_bg_lock = kmalloc(sizeof(struct blockgroup_lock),\n\t\t\tGFP_KERNEL);\n\t\tif (!mb_cache_bg_lock)\n\t\t\treturn NULL;\n\t\tbgl_lock_init(mb_cache_bg_lock);\n\t}\n\n\tcache = kmalloc(sizeof(struct mb_cache), GFP_KERNEL);\n\tif (!cache)\n\t\treturn NULL;\n\tcache->c_name = name;\n\tatomic_set(&cache->c_entry_count, 0);\n\tcache->c_bucket_bits = bucket_bits;\n\tcache->c_block_hash = kmalloc(bucket_count *\n\t\tsizeof(struct hlist_bl_head), GFP_KERNEL);\n\tif (!cache->c_block_hash)\n\t\tgoto fail;\n\tfor (n=0; n<bucket_count; n++)\n\t\tINIT_HLIST_BL_HEAD(&cache->c_block_hash[n]);\n\tcache->c_index_hash = kmalloc(bucket_count *\n\t\tsizeof(struct hlist_bl_head), GFP_KERNEL);\n\tif (!cache->c_index_hash)\n\t\tgoto fail;\n\tfor (n=0; n<bucket_count; n++)\n\t\tINIT_HLIST_BL_HEAD(&cache->c_index_hash[n]);\n\tif (!mb_cache_kmem_cache) {\n\t\tmb_cache_kmem_cache = kmem_cache_create(name,\n\t\t\tsizeof(struct mb_cache_entry), 0,\n\t\t\tSLAB_RECLAIM_ACCOUNT|SLAB_MEM_SPREAD, NULL);\n\t\tif (!mb_cache_kmem_cache)\n\t\t\tgoto fail2;\n\t}\n\tcache->c_entry_cache = mb_cache_kmem_cache;\n\n\t/*\n\t * Set an upper limit on the number of cache entries so that the hash\n\t * chains won't grow too long.\n\t */\n\tcache->c_max_entries = bucket_count << 4;\n\n\tspin_lock(&mb_cache_spinlock);\n\tlist_add(&cache->c_cache_list, &mb_cache_list);\n\tspin_unlock(&mb_cache_spinlock);\n\treturn cache;\n\nfail2:\n\tkfree(cache->c_index_hash);\n\nfail:\n\tkfree(cache->c_block_hash);\n\tkfree(cache);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct blockgroup_lock *mb_cache_bg_lock;",
      "static struct kmem_cache *mb_cache_kmem_cache;",
      "static LIST_HEAD(mb_cache_list);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache->c_block_hash"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache->c_index_hash"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&cache->c_cache_list",
            "&mb_cache_list"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "name",
            "sizeof(struct mb_cache_entry)",
            "0",
            "SLAB_RECLAIM_ACCOUNT|SLAB_MEM_SPREAD",
            "NULL"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_BL_HEAD",
          "args": [
            "&cache->c_index_hash[n]"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "bucket_count *\n\t\tsizeof(struct hlist_bl_head)",
            "GFP_KERNEL"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_BL_HEAD",
          "args": [
            "&cache->c_block_hash[n]"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&cache->c_entry_count",
            "0"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bgl_lock_init",
          "args": [
            "mb_cache_bg_lock"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\nstatic struct kmem_cache *mb_cache_kmem_cache;\nstatic LIST_HEAD(mb_cache_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstruct mb_cache *\nmb_cache_create(const char *name, int bucket_bits)\n{\n\tint n, bucket_count = 1 << bucket_bits;\n\tstruct mb_cache *cache = NULL;\n\n\tif (!mb_cache_bg_lock) {\n\t\tmb_cache_bg_lock = kmalloc(sizeof(struct blockgroup_lock),\n\t\t\tGFP_KERNEL);\n\t\tif (!mb_cache_bg_lock)\n\t\t\treturn NULL;\n\t\tbgl_lock_init(mb_cache_bg_lock);\n\t}\n\n\tcache = kmalloc(sizeof(struct mb_cache), GFP_KERNEL);\n\tif (!cache)\n\t\treturn NULL;\n\tcache->c_name = name;\n\tatomic_set(&cache->c_entry_count, 0);\n\tcache->c_bucket_bits = bucket_bits;\n\tcache->c_block_hash = kmalloc(bucket_count *\n\t\tsizeof(struct hlist_bl_head), GFP_KERNEL);\n\tif (!cache->c_block_hash)\n\t\tgoto fail;\n\tfor (n=0; n<bucket_count; n++)\n\t\tINIT_HLIST_BL_HEAD(&cache->c_block_hash[n]);\n\tcache->c_index_hash = kmalloc(bucket_count *\n\t\tsizeof(struct hlist_bl_head), GFP_KERNEL);\n\tif (!cache->c_index_hash)\n\t\tgoto fail;\n\tfor (n=0; n<bucket_count; n++)\n\t\tINIT_HLIST_BL_HEAD(&cache->c_index_hash[n]);\n\tif (!mb_cache_kmem_cache) {\n\t\tmb_cache_kmem_cache = kmem_cache_create(name,\n\t\t\tsizeof(struct mb_cache_entry), 0,\n\t\t\tSLAB_RECLAIM_ACCOUNT|SLAB_MEM_SPREAD, NULL);\n\t\tif (!mb_cache_kmem_cache)\n\t\t\tgoto fail2;\n\t}\n\tcache->c_entry_cache = mb_cache_kmem_cache;\n\n\t/*\n\t * Set an upper limit on the number of cache entries so that the hash\n\t * chains won't grow too long.\n\t */\n\tcache->c_max_entries = bucket_count << 4;\n\n\tspin_lock(&mb_cache_spinlock);\n\tlist_add(&cache->c_cache_list, &mb_cache_list);\n\tspin_unlock(&mb_cache_spinlock);\n\treturn cache;\n\nfail2:\n\tkfree(cache->c_index_hash);\n\nfail:\n\tkfree(cache->c_block_hash);\n\tkfree(cache);\n\treturn NULL;\n}"
  },
  {
    "function_name": "mb_cache_shrink_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "290-305",
    "snippet": "static unsigned long\nmb_cache_shrink_count(struct shrinker *shrink, struct shrink_control *sc)\n{\n\tstruct mb_cache *cache;\n\tunsigned long count = 0;\n\n\tspin_lock(&mb_cache_spinlock);\n\tlist_for_each_entry(cache, &mb_cache_list, c_cache_list) {\n\t\tmb_debug(\"cache %s (%d)\", cache->c_name,\n\t\t\t  atomic_read(&cache->c_entry_count));\n\t\tcount += atomic_read(&cache->c_entry_count);\n\t}\n\tspin_unlock(&mb_cache_spinlock);\n\n\treturn vfs_pressure_ratio(count);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(mb_cache_list);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_pressure_ratio",
          "args": [
            "count"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&cache->c_entry_count"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_debug",
          "args": [
            "\"cache %s (%d)\"",
            "cache->c_name",
            "atomic_read(&cache->c_entry_count)"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&cache->c_entry_count"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "cache",
            "&mb_cache_list",
            "c_cache_list"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(mb_cache_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic unsigned long\nmb_cache_shrink_count(struct shrinker *shrink, struct shrink_control *sc)\n{\n\tstruct mb_cache *cache;\n\tunsigned long count = 0;\n\n\tspin_lock(&mb_cache_spinlock);\n\tlist_for_each_entry(cache, &mb_cache_list, c_cache_list) {\n\t\tmb_debug(\"cache %s (%d)\", cache->c_name,\n\t\t\t  atomic_read(&cache->c_entry_count));\n\t\tcount += atomic_read(&cache->c_entry_count);\n\t}\n\tspin_unlock(&mb_cache_spinlock);\n\n\treturn vfs_pressure_ratio(count);\n}"
  },
  {
    "function_name": "mb_cache_shrink_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "247-288",
    "snippet": "static unsigned long\nmb_cache_shrink_scan(struct shrinker *shrink, struct shrink_control *sc)\n{\n\tLIST_HEAD(free_list);\n\tstruct mb_cache_entry *entry, *tmp;\n\tint nr_to_scan = sc->nr_to_scan;\n\tgfp_t gfp_mask = sc->gfp_mask;\n\tunsigned long freed = 0;\n\n\tmb_debug(\"trying to free %d entries\", nr_to_scan);\n\tspin_lock(&mb_cache_spinlock);\n\twhile ((nr_to_scan-- > 0) && !list_empty(&mb_cache_lru_list)) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\tlist_entry(mb_cache_lru_list.next,\n\t\t\t\tstruct mb_cache_entry, e_lru_list);\n\t\tlist_del_init(&ce->e_lru_list);\n\t\tif (ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))\n\t\t\tcontinue;\n\t\tspin_unlock(&mb_cache_spinlock);\n\t\t/* Prevent any find or get operation on the entry */\n\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\t/* Ignore if it is touched by a find/get */\n\t\tif (ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt) ||\n\t\t\t!list_empty(&ce->e_lru_list)) {\n\t\t\thlist_bl_unlock(ce->e_index_hash_p);\n\t\t\thlist_bl_unlock(ce->e_block_hash_p);\n\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\tcontinue;\n\t\t}\n\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\tlist_add_tail(&ce->e_lru_list, &free_list);\n\t\tspin_lock(&mb_cache_spinlock);\n\t}\n\tspin_unlock(&mb_cache_spinlock);\n\n\tlist_for_each_entry_safe(entry, tmp, &free_list, e_lru_list) {\n\t\t__mb_cache_entry_forget(entry, gfp_mask);\n\t\tfreed++;\n\t}\n\treturn freed;\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(mb_cache_lru_list);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mb_cache_entry_forget",
          "args": [
            "entry",
            "gfp_mask"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_forget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "190-198",
          "snippet": "static void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "entry",
            "tmp",
            "&free_list",
            "e_lru_list"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&ce->e_lru_list",
            "&free_list"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_unlock",
          "args": [
            "ce"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "181-188",
          "snippet": "static inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "mb_cache_lru_list.next",
            "structmb_cache_entry",
            "e_lru_list"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_debug",
          "args": [
            "\"trying to free %d entries\"",
            "nr_to_scan"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "free_list"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic unsigned long\nmb_cache_shrink_scan(struct shrinker *shrink, struct shrink_control *sc)\n{\n\tLIST_HEAD(free_list);\n\tstruct mb_cache_entry *entry, *tmp;\n\tint nr_to_scan = sc->nr_to_scan;\n\tgfp_t gfp_mask = sc->gfp_mask;\n\tunsigned long freed = 0;\n\n\tmb_debug(\"trying to free %d entries\", nr_to_scan);\n\tspin_lock(&mb_cache_spinlock);\n\twhile ((nr_to_scan-- > 0) && !list_empty(&mb_cache_lru_list)) {\n\t\tstruct mb_cache_entry *ce =\n\t\t\tlist_entry(mb_cache_lru_list.next,\n\t\t\t\tstruct mb_cache_entry, e_lru_list);\n\t\tlist_del_init(&ce->e_lru_list);\n\t\tif (ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))\n\t\t\tcontinue;\n\t\tspin_unlock(&mb_cache_spinlock);\n\t\t/* Prevent any find or get operation on the entry */\n\t\thlist_bl_lock(ce->e_block_hash_p);\n\t\thlist_bl_lock(ce->e_index_hash_p);\n\t\t/* Ignore if it is touched by a find/get */\n\t\tif (ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt) ||\n\t\t\t!list_empty(&ce->e_lru_list)) {\n\t\t\thlist_bl_unlock(ce->e_index_hash_p);\n\t\t\thlist_bl_unlock(ce->e_block_hash_p);\n\t\t\tspin_lock(&mb_cache_spinlock);\n\t\t\tcontinue;\n\t\t}\n\t\t__mb_cache_entry_unhash_unlock(ce);\n\t\tlist_add_tail(&ce->e_lru_list, &free_list);\n\t\tspin_lock(&mb_cache_spinlock);\n\t}\n\tspin_unlock(&mb_cache_spinlock);\n\n\tlist_for_each_entry_safe(entry, tmp, &free_list, e_lru_list) {\n\t\t__mb_cache_entry_forget(entry, gfp_mask);\n\t\tfreed++;\n\t}\n\treturn freed;\n}"
  },
  {
    "function_name": "__mb_cache_entry_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "200-234",
    "snippet": "static void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)"
    ],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);",
      "static LIST_HEAD(mb_cache_lru_list);",
      "static DEFINE_SPINLOCK(mb_cache_spinlock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mb_cache_entry_forget",
          "args": [
            "ce",
            "GFP_KERNEL"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_forget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "190-198",
          "snippet": "static void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "list_empty(&ce->e_lru_list)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ce->e_lru_list"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__spin_unlock_mb_cache_entry",
          "args": [
            "ce"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&ce->e_lru_list",
            "&mb_cache_lru_list"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mb_cache_spinlock"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_is_block_hashed",
          "args": [
            "ce"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_is_block_hashed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "146-150",
          "snippet": "static inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_all",
          "args": [
            "&mb_cache_queue"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define MB_CACHE_WRITER ((unsigned short)~0U >> 1)\n\nstatic DECLARE_WAIT_QUEUE_HEAD(mb_cache_queue);\nstatic LIST_HEAD(mb_cache_lru_list);\nstatic DEFINE_SPINLOCK(mb_cache_spinlock);\n\nstatic void\n__mb_cache_entry_release(struct mb_cache_entry *ce)\n{\n\t/* First lock the entry to serialize access to its local data. */\n\t__spin_lock_mb_cache_entry(ce);\n\t/* Wake up all processes queuing for this cache entry. */\n\tif (ce->e_queued)\n\t\twake_up_all(&mb_cache_queue);\n\tif (ce->e_used >= MB_CACHE_WRITER)\n\t\tce->e_used -= MB_CACHE_WRITER;\n\t/*\n\t * Make sure that all cache entries on lru_list have\n\t * both e_used and e_qued of 0s.\n\t */\n\tce->e_used--;\n\tif (!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))) {\n\t\tif (!__mb_cache_entry_is_block_hashed(ce)) {\n\t\t\t__spin_unlock_mb_cache_entry(ce);\n\t\t\tgoto forget;\n\t\t}\n\t\t/*\n\t\t * Need access to lru list, first drop entry lock,\n\t\t * then reacquire the lock in the proper order.\n\t\t */\n\t\tspin_lock(&mb_cache_spinlock);\n\t\tif (list_empty(&ce->e_lru_list))\n\t\t\tlist_add_tail(&ce->e_lru_list, &mb_cache_lru_list);\n\t\tspin_unlock(&mb_cache_spinlock);\n\t}\n\t__spin_unlock_mb_cache_entry(ce);\n\treturn;\nforget:\n\tmb_assert(list_empty(&ce->e_lru_list));\n\t__mb_cache_entry_forget(ce, GFP_KERNEL);\n}"
  },
  {
    "function_name": "__mb_cache_entry_forget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "190-198",
    "snippet": "static void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&cache->c_entry_count"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "cache->c_entry_cache",
            "ce"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_assert",
          "args": [
            "!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt))"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ce->e_refcnt"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void\n__mb_cache_entry_forget(struct mb_cache_entry *ce, gfp_t gfp_mask)\n{\n\tstruct mb_cache *cache = ce->e_cache;\n\n\tmb_assert(!(ce->e_used || ce->e_queued || atomic_read(&ce->e_refcnt)));\n\tkmem_cache_free(cache->c_entry_cache, ce);\n\tatomic_dec(&cache->c_entry_count);\n}"
  },
  {
    "function_name": "__mb_cache_entry_unhash_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "181-188",
    "snippet": "static inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_block_hash_p"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_block",
          "args": [
            "ce"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "153-158",
          "snippet": "static inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "ce->e_index_hash_p"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_unhash_index",
          "args": [
            "ce"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_unhash_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "166-171",
          "snippet": "static inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_unlock(struct mb_cache_entry *ce)\n{\n\t__mb_cache_entry_unhash_index(ce);\n\thlist_bl_unlock(ce->e_index_hash_p);\n\t__mb_cache_entry_unhash_block(ce);\n\thlist_bl_unlock(ce->e_block_hash_p);\n}"
  },
  {
    "function_name": "__mb_cache_entry_unhash_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "166-171",
    "snippet": "static inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_del_init",
          "args": [
            "&ce->e_index.o_list"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_is_index_hashed",
          "args": [
            "ce"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_is_index_hashed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "160-164",
          "snippet": "static inline int\n__mb_cache_entry_is_index_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_index.o_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_index_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_index.o_list);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_index(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_index_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_index.o_list);\n}"
  },
  {
    "function_name": "__mb_cache_entry_is_index_hashed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "160-164",
    "snippet": "static inline int\n__mb_cache_entry_is_index_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_index.o_list);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unhashed",
          "args": [
            "&ce->e_index.o_list"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_index_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_index.o_list);\n}"
  },
  {
    "function_name": "__mb_cache_entry_unhash_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "153-158",
    "snippet": "static inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_del_init",
          "args": [
            "&ce->e_block_list"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mb_cache_entry_is_block_hashed",
          "args": [
            "ce"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "__mb_cache_entry_is_block_hashed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "146-150",
          "snippet": "static inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline void\n__mb_cache_entry_unhash_block(struct mb_cache_entry *ce)\n{\n\tif (__mb_cache_entry_is_block_hashed(ce))\n\t\thlist_bl_del_init(&ce->e_block_list);\n}"
  },
  {
    "function_name": "__mb_cache_entry_is_block_hashed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "146-150",
    "snippet": "static inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unhashed",
          "args": [
            "&ce->e_block_list"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic inline int\n__mb_cache_entry_is_block_hashed(struct mb_cache_entry *ce)\n{\n\treturn !hlist_bl_unhashed(&ce->e_block_list);\n}"
  },
  {
    "function_name": "__spin_unlock_mb_cache_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "139-144",
    "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct blockgroup_lock *mb_cache_bg_lock;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce))"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "bgl_lock_ptr",
          "args": [
            "mb_cache_bg_lock",
            "MB_CACHE_ENTRY_LOCK_INDEX(ce)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MB_CACHE_ENTRY_LOCK_INDEX",
          "args": [
            "ce"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
  },
  {
    "function_name": "__spin_lock_mb_cache_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
    "lines": "132-137",
    "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
    "includes": [
      "#include <linux/log2.h>",
      "#include <linux/blockgroup_lock.h>",
      "#include <linux/init.h>",
      "#include <linux/mbcache.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/fs.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct blockgroup_lock *mb_cache_bg_lock;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce))"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "bgl_lock_ptr",
          "args": [
            "mb_cache_bg_lock",
            "MB_CACHE_ENTRY_LOCK_INDEX(ce)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MB_CACHE_ENTRY_LOCK_INDEX",
          "args": [
            "ce"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
  }
]