[
  {
    "function_name": "btrfs_delayed_node_to_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "260-265",
    "snippet": "static inline struct btrfs_delayed_ref_head *\nbtrfs_delayed_node_to_head(struct btrfs_delayed_ref_node *node)\n{\n\tWARN_ON(!btrfs_delayed_ref_is_head(node));\n\treturn container_of(node, struct btrfs_delayed_ref_head, node);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "node",
            "structbtrfs_delayed_ref_head",
            "node"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!btrfs_delayed_ref_is_head(node)"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_delayed_ref_is_head",
          "args": [
            "node"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_delayed_ref_is_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
          "lines": "238-241",
          "snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline struct btrfs_delayed_ref_head *\nbtrfs_delayed_node_to_head(struct btrfs_delayed_ref_node *node)\n{\n\tWARN_ON(!btrfs_delayed_ref_is_head(node));\n\treturn container_of(node, struct btrfs_delayed_ref_head, node);\n}"
  },
  {
    "function_name": "btrfs_delayed_node_to_data_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "253-258",
    "snippet": "static inline struct btrfs_delayed_data_ref *\nbtrfs_delayed_node_to_data_ref(struct btrfs_delayed_ref_node *node)\n{\n\tWARN_ON(btrfs_delayed_ref_is_head(node));\n\treturn container_of(node, struct btrfs_delayed_data_ref, node);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "node",
            "structbtrfs_delayed_data_ref",
            "node"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "btrfs_delayed_ref_is_head(node)"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_delayed_ref_is_head",
          "args": [
            "node"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_delayed_ref_is_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
          "lines": "238-241",
          "snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline struct btrfs_delayed_data_ref *\nbtrfs_delayed_node_to_data_ref(struct btrfs_delayed_ref_node *node)\n{\n\tWARN_ON(btrfs_delayed_ref_is_head(node));\n\treturn container_of(node, struct btrfs_delayed_data_ref, node);\n}"
  },
  {
    "function_name": "btrfs_delayed_node_to_tree_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "246-251",
    "snippet": "static inline struct btrfs_delayed_tree_ref *\nbtrfs_delayed_node_to_tree_ref(struct btrfs_delayed_ref_node *node)\n{\n\tWARN_ON(btrfs_delayed_ref_is_head(node));\n\treturn container_of(node, struct btrfs_delayed_tree_ref, node);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "node",
            "structbtrfs_delayed_tree_ref",
            "node"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "btrfs_delayed_ref_is_head(node)"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_delayed_ref_is_head",
          "args": [
            "node"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_delayed_ref_is_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
          "lines": "238-241",
          "snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline struct btrfs_delayed_tree_ref *\nbtrfs_delayed_node_to_tree_ref(struct btrfs_delayed_ref_node *node)\n{\n\tWARN_ON(btrfs_delayed_ref_is_head(node));\n\treturn container_of(node, struct btrfs_delayed_tree_ref, node);\n}"
  },
  {
    "function_name": "btrfs_delayed_ref_is_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "238-241",
    "snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static int btrfs_delayed_ref_is_head(struct btrfs_delayed_ref_node *node)\n{\n\treturn node->is_head;\n}"
  },
  {
    "function_name": "btrfs_delayed_ref_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "221-224",
    "snippet": "static inline void btrfs_delayed_ref_unlock(struct btrfs_delayed_ref_head *head)\n{\n\tmutex_unlock(&head->mutex);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&head->mutex"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void btrfs_delayed_ref_unlock(struct btrfs_delayed_ref_head *head)\n{\n\tmutex_unlock(&head->mutex);\n}"
  },
  {
    "function_name": "btrfs_put_delayed_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "172-193",
    "snippet": "static inline void btrfs_put_delayed_ref(struct btrfs_delayed_ref_node *ref)\n{\n\tWARN_ON(atomic_read(&ref->refs) == 0);\n\tif (atomic_dec_and_test(&ref->refs)) {\n\t\tWARN_ON(ref->in_tree);\n\t\tswitch (ref->type) {\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tkmem_cache_free(btrfs_delayed_tree_ref_cachep, ref);\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tkmem_cache_free(btrfs_delayed_data_ref_cachep, ref);\n\t\t\tbreak;\n\t\tcase 0:\n\t\t\tkmem_cache_free(btrfs_delayed_ref_head_cachep, ref);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "btrfs_delayed_ref_head_cachep",
            "ref"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "btrfs_delayed_data_ref_cachep",
            "ref"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "btrfs_delayed_tree_ref_cachep",
            "ref"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ref->in_tree"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&ref->refs"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "atomic_read(&ref->refs) == 0"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ref->refs"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void btrfs_put_delayed_ref(struct btrfs_delayed_ref_node *ref)\n{\n\tWARN_ON(atomic_read(&ref->refs) == 0);\n\tif (atomic_dec_and_test(&ref->refs)) {\n\t\tWARN_ON(ref->in_tree);\n\t\tswitch (ref->type) {\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tkmem_cache_free(btrfs_delayed_tree_ref_cachep, ref);\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tkmem_cache_free(btrfs_delayed_data_ref_cachep, ref);\n\t\t\tbreak;\n\t\tcase 0:\n\t\t\tkmem_cache_free(btrfs_delayed_ref_head_cachep, ref);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "btrfs_free_delayed_extent_op",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "165-170",
    "snippet": "static inline void\nbtrfs_free_delayed_extent_op(struct btrfs_delayed_extent_op *op)\n{\n\tif (op)\n\t\tkmem_cache_free(btrfs_delayed_extent_op_cachep, op);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "btrfs_delayed_extent_op_cachep",
            "op"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void\nbtrfs_free_delayed_extent_op(struct btrfs_delayed_extent_op *op)\n{\n\tif (op)\n\t\tkmem_cache_free(btrfs_delayed_extent_op_cachep, op);\n}"
  },
  {
    "function_name": "btrfs_alloc_delayed_extent_op",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/delayed-ref.h",
    "lines": "159-163",
    "snippet": "static inline struct btrfs_delayed_extent_op *\nbtrfs_alloc_delayed_extent_op(void)\n{\n\treturn kmem_cache_alloc(btrfs_delayed_extent_op_cachep, GFP_NOFS);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "btrfs_delayed_extent_op_cachep",
            "GFP_NOFS"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline struct btrfs_delayed_extent_op *\nbtrfs_alloc_delayed_extent_op(void)\n{\n\treturn kmem_cache_alloc(btrfs_delayed_extent_op_cachep, GFP_NOFS);\n}"
  }
]