[
  {
    "function_name": "qid_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
    "lines": "119-131",
    "snippet": "bool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "projid_valid",
          "args": [
            "qid.projid"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "qid.gid"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "qid.uid"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "from_kqid_munged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
    "lines": "100-112",
    "snippet": "qid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kprojid_munged",
          "args": [
            "targ",
            "kqid.projid"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "targ",
            "kqid.gid"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "targ",
            "kqid.uid"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "from_kqid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
    "lines": "67-79",
    "snippet": "qid_t from_kqid(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kprojid",
          "args": [
            "targ",
            "kqid.projid"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid",
          "args": [
            "targ",
            "kqid.gid"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid",
          "args": [
            "targ",
            "kqid.uid"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "qid_lt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
    "lines": "36-52",
    "snippet": "bool qid_lt(struct kqid left, struct kqid right)\n{\n\tif (left.type < right.type)\n\t\treturn true;\n\tif (left.type > right.type)\n\t\treturn false;\n\tswitch (left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_lt(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_lt(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_lt(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "projid_lt",
          "args": [
            "left.projid",
            "right.projid"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_lt",
          "args": [
            "left.gid",
            "right.gid"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_lt",
          "args": [
            "left.uid",
            "right.uid"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_lt(struct kqid left, struct kqid right)\n{\n\tif (left.type < right.type)\n\t\treturn true;\n\tif (left.type > right.type)\n\t\treturn false;\n\tswitch (left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_lt(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_lt(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_lt(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "qid_eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
    "lines": "12-26",
    "snippet": "bool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "projid_eq",
          "args": [
            "left.projid",
            "right.projid"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "left.gid",
            "right.gid"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "left.uid",
            "right.uid"
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/uuid.c",
          "lines": "59-63",
          "snippet": "int\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}",
          "includes": [
            "#include <xfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <xfs.h>\n\nint\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
  }
]