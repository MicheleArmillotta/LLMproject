[
  {
    "function_name": "exofs_sysfs_uninit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "202-205",
    "snippet": "void exofs_sysfs_uninit(void)\n{\n\tkset_unregister(exofs_kset);\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *exofs_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "exofs_kset"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic struct kset *exofs_kset;\n\nvoid exofs_sysfs_uninit(void)\n{\n\tkset_unregister(exofs_kset);\n}"
  },
  {
    "function_name": "exofs_sysfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "192-200",
    "snippet": "int exofs_sysfs_init(void)\n{\n\texofs_kset = kset_create_and_add(\"exofs\", NULL, fs_kobj);\n\tif (!exofs_kset) {\n\t\tEXOFS_ERR(\"ERROR: kset_create_and_add exofs failed\\n\");\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *exofs_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXOFS_ERR",
          "args": [
            "\"ERROR: kset_create_and_add exofs failed\\n\""
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kset_create_and_add",
          "args": [
            "\"exofs\"",
            "NULL",
            "fs_kobj"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic struct kset *exofs_kset;\n\nint exofs_sysfs_init(void)\n{\n\texofs_kset = kset_create_and_add(\"exofs\", NULL, fs_kobj);\n\tif (!exofs_kset) {\n\t\tEXOFS_ERR(\"ERROR: kset_create_and_add exofs failed\\n\");\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "exofs_sysfs_odev_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "172-190",
    "snippet": "int exofs_sysfs_odev_add(struct exofs_dev *edev, struct exofs_sb_info *sbi)\n{\n\tstruct kobject *d_kobj;\n\tint retval = 0;\n\n\t/* create osd device group which contains following attributes\n\t * osdname, systemid & uri\n\t */\n\td_kobj = &edev->ed_kobj;\n\td_kobj->kset = exofs_kset;\n\tretval = kobject_init_and_add(d_kobj, &odev_ktype,\n\t\t\t&sbi->s_kobj, \"dev%u\", edev->did);\n\tif (retval) {\n\t\tEXOFS_ERR(\"ERROR: Failed to create sysfs entry for \"\n\t\t\t\t\"device dev%u\\n\", edev->did);\n\t\treturn retval;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *exofs_kset;",
      "static struct kobj_type odev_ktype = {\n\t.default_attrs\t= odev_attrs,\n\t.sysfs_ops\t= &odev_attr_ops,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXOFS_ERR",
          "args": [
            "\"ERROR: Failed to create sysfs entry for \"\n\t\t\t\t\"device dev%u\\n\"",
            "edev->did"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "d_kobj",
            "&odev_ktype",
            "&sbi->s_kobj",
            "\"dev%u\"",
            "edev->did"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic struct kset *exofs_kset;\nstatic struct kobj_type odev_ktype = {\n\t.default_attrs\t= odev_attrs,\n\t.sysfs_ops\t= &odev_attr_ops,\n};\n\nint exofs_sysfs_odev_add(struct exofs_dev *edev, struct exofs_sb_info *sbi)\n{\n\tstruct kobject *d_kobj;\n\tint retval = 0;\n\n\t/* create osd device group which contains following attributes\n\t * osdname, systemid & uri\n\t */\n\td_kobj = &edev->ed_kobj;\n\td_kobj->kset = exofs_kset;\n\tretval = kobject_init_and_add(d_kobj, &odev_ktype,\n\t\t\t&sbi->s_kobj, \"dev%u\", edev->did);\n\tif (retval) {\n\t\tEXOFS_ERR(\"ERROR: Failed to create sysfs entry for \"\n\t\t\t\t\"device dev%u\\n\", edev->did);\n\t\treturn retval;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "exofs_sysfs_sb_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "152-170",
    "snippet": "int exofs_sysfs_sb_add(struct exofs_sb_info *sbi,\n\t\t       struct exofs_dt_device_info *dt_dev)\n{\n\tstruct kobject *s_kobj;\n\tint retval = 0;\n\tuint64_t pid = sbi->one_comp.obj.partition;\n\n\t/* allocate new uuid dirent */\n\ts_kobj = &sbi->s_kobj;\n\ts_kobj->kset = exofs_kset;\n\tretval = kobject_init_and_add(s_kobj, &uuid_ktype,\n\t\t\t&exofs_kset->kobj,  \"%s_%llx\", dt_dev->osdname, pid);\n\tif (retval) {\n\t\tEXOFS_ERR(\"ERROR: Failed to create sysfs entry for \"\n\t\t\t  \"uuid-%s_%llx => %d\\n\", dt_dev->osdname, pid, retval);\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *exofs_kset;",
      "static struct kobj_type uuid_ktype = {\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXOFS_ERR",
          "args": [
            "\"ERROR: Failed to create sysfs entry for \"\n\t\t\t  \"uuid-%s_%llx => %d\\n\"",
            "dt_dev->osdname",
            "pid",
            "retval"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "s_kobj",
            "&uuid_ktype",
            "&exofs_kset->kobj",
            "\"%s_%llx\"",
            "dt_dev->osdname",
            "pid"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic struct kset *exofs_kset;\nstatic struct kobj_type uuid_ktype = {\n};\n\nint exofs_sysfs_sb_add(struct exofs_sb_info *sbi,\n\t\t       struct exofs_dt_device_info *dt_dev)\n{\n\tstruct kobject *s_kobj;\n\tint retval = 0;\n\tuint64_t pid = sbi->one_comp.obj.partition;\n\n\t/* allocate new uuid dirent */\n\ts_kobj = &sbi->s_kobj;\n\ts_kobj->kset = exofs_kset;\n\tretval = kobject_init_and_add(s_kobj, &uuid_ktype,\n\t\t\t&exofs_kset->kobj,  \"%s_%llx\", dt_dev->osdname, pid);\n\tif (retval) {\n\t\tEXOFS_ERR(\"ERROR: Failed to create sysfs entry for \"\n\t\t\t  \"uuid-%s_%llx => %d\\n\", dt_dev->osdname, pid, retval);\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "exofs_sysfs_sb_del",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "134-145",
    "snippet": "void exofs_sysfs_sb_del(struct exofs_sb_info *sbi)\n{\n\tstruct kobject *k_name, *k_tmp;\n\tstruct kobject *s_kobj = &sbi->s_kobj;\n\n\tlist_for_each_entry_safe(k_name, k_tmp, &exofs_kset->list, entry) {\n\t\t/* Remove all that are children of this SBI */\n\t\tif (k_name->parent == s_kobj)\n\t\t\tkobject_put(k_name);\n\t}\n\tkobject_put(s_kobj);\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *exofs_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "s_kobj"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "k_name"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "k_name",
            "k_tmp",
            "&exofs_kset->list",
            "entry"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic struct kset *exofs_kset;\n\nvoid exofs_sysfs_sb_del(struct exofs_sb_info *sbi)\n{\n\tstruct kobject *k_name, *k_tmp;\n\tstruct kobject *s_kobj = &sbi->s_kobj;\n\n\tlist_for_each_entry_safe(k_name, k_tmp, &exofs_kset->list, entry) {\n\t\t/* Remove all that are children of this SBI */\n\t\tif (k_name->parent == s_kobj)\n\t\t\tkobject_put(k_name);\n\t}\n\tkobject_put(s_kobj);\n}"
  },
  {
    "function_name": "exofs_sysfs_dbg_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "117-128",
    "snippet": "void exofs_sysfs_dbg_print(void)\n{\n#ifdef CONFIG_EXOFS_DEBUG\n\tstruct kobject *k_name, *k_tmp;\n\n\tlist_for_each_entry_safe(k_name, k_tmp, &exofs_kset->list, entry) {\n\t\tprintk(KERN_INFO \"%s: name %s ref %d\\n\",\n\t\t\t__func__, kobject_name(k_name),\n\t\t\t(int)atomic_read(&k_name->kref.refcount));\n\t}\n#endif\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *exofs_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"%s: name %s ref %d\\n\"",
            "__func__",
            "kobject_name(k_name)",
            "(int)atomic_read(&k_name->kref.refcount)"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&k_name->kref.refcount"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_name",
          "args": [
            "k_name"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "k_name",
            "k_tmp",
            "&exofs_kset->list",
            "entry"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic struct kset *exofs_kset;\n\nvoid exofs_sysfs_dbg_print(void)\n{\n#ifdef CONFIG_EXOFS_DEBUG\n\tstruct kobject *k_name, *k_tmp;\n\n\tlist_for_each_entry_safe(k_name, k_tmp, &exofs_kset->list, entry) {\n\t\tprintk(KERN_INFO \"%s: name %s ref %d\\n\",\n\t\t\t__func__, kobject_name(k_name),\n\t\t\t(int)atomic_read(&k_name->kref.refcount));\n\t}\n#endif\n}"
  },
  {
    "function_name": "uri_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "81-92",
    "snippet": "static ssize_t uri_store(struct exofs_dev *edp, const char *buf, size_t len)\n{\n\tuint8_t *new_uri;\n\n\tedp->urilen = strlen(buf) + 1;\n\tnew_uri = krealloc(edp->uri, edp->urilen, GFP_KERNEL);\n\tif (new_uri == NULL)\n\t\treturn -ENOMEM;\n\tedp->uri = new_uri;\n\tstrncpy(edp->uri, buf, edp->urilen);\n\treturn edp->urilen;\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "edp->uri",
            "buf",
            "edp->urilen"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krealloc",
          "args": [
            "edp->uri",
            "edp->urilen",
            "GFP_KERNEL"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "buf"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic ssize_t uri_store(struct exofs_dev *edp, const char *buf, size_t len)\n{\n\tuint8_t *new_uri;\n\n\tedp->urilen = strlen(buf) + 1;\n\tnew_uri = krealloc(edp->uri, edp->urilen, GFP_KERNEL);\n\tif (new_uri == NULL)\n\t\treturn -ENOMEM;\n\tedp->uri = new_uri;\n\tstrncpy(edp->uri, buf, edp->urilen);\n\treturn edp->urilen;\n}"
  },
  {
    "function_name": "uri_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "76-79",
    "snippet": "static ssize_t uri_show(struct exofs_dev *edp, char *buf)\n{\n\treturn snprintf(buf, edp->urilen, \"%s\", edp->uri);\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "edp->urilen",
            "\"%s\"",
            "edp->uri"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic ssize_t uri_show(struct exofs_dev *edp, char *buf)\n{\n\treturn snprintf(buf, edp->urilen, \"%s\", edp->uri);\n}"
  },
  {
    "function_name": "systemid_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "67-74",
    "snippet": "static ssize_t systemid_show(struct exofs_dev *edp, char *buf)\n{\n\tstruct osd_dev *odev = edp->ored.od;\n\tconst struct osd_dev_info *odi = osduld_device_info(odev);\n\n\tmemcpy(buf, odi->systemid, odi->systemid_len);\n\treturn odi->systemid_len;\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "odi->systemid",
            "odi->systemid_len"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "osduld_device_info",
          "args": [
            "odev"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic ssize_t systemid_show(struct exofs_dev *edp, char *buf)\n{\n\tstruct osd_dev *odev = edp->ored.od;\n\tconst struct osd_dev_info *odi = osduld_device_info(odev);\n\n\tmemcpy(buf, odi->systemid, odi->systemid_len);\n\treturn odi->systemid_len;\n}"
  },
  {
    "function_name": "osdname_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "59-65",
    "snippet": "static ssize_t osdname_show(struct exofs_dev *edp, char *buf)\n{\n\tstruct osd_dev *odev = edp->ored.od;\n\tconst struct osd_dev_info *odi = osduld_device_info(odev);\n\n\treturn snprintf(buf, odi->osdname_len + 1, \"%s\", odi->osdname);\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "odi->osdname_len + 1",
            "\"%s\"",
            "odi->osdname"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "osduld_device_info",
          "args": [
            "odev"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic ssize_t osdname_show(struct exofs_dev *edp, char *buf)\n{\n\tstruct osd_dev *odev = edp->ored.od;\n\tconst struct osd_dev_info *odi = osduld_device_info(odev);\n\n\treturn snprintf(buf, odi->osdname_len + 1, \"%s\", odi->osdname);\n}"
  },
  {
    "function_name": "odev_attr_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "42-49",
    "snippet": "static ssize_t odev_attr_store(struct kobject *kobj, struct attribute *attr,\n\t\tconst char *buf, size_t len)\n{\n\tstruct exofs_dev *edp = container_of(kobj, struct exofs_dev, ed_kobj);\n\tstruct odev_attr *a = container_of(attr, struct odev_attr, attr);\n\n\treturn a->store ? a->store(edp, buf, len) : len;\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->store",
          "args": [
            "edp",
            "buf",
            "len"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structodev_attr",
            "attr"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structexofs_dev",
            "ed_kobj"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic ssize_t odev_attr_store(struct kobject *kobj, struct attribute *attr,\n\t\tconst char *buf, size_t len)\n{\n\tstruct exofs_dev *edp = container_of(kobj, struct exofs_dev, ed_kobj);\n\tstruct odev_attr *a = container_of(attr, struct odev_attr, attr);\n\n\treturn a->store ? a->store(edp, buf, len) : len;\n}"
  },
  {
    "function_name": "odev_attr_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/sys.c",
    "lines": "33-40",
    "snippet": "static ssize_t odev_attr_show(struct kobject *kobj, struct attribute *attr,\n\t\tchar *buf)\n{\n\tstruct exofs_dev *edp = container_of(kobj, struct exofs_dev, ed_kobj);\n\tstruct odev_attr *a = container_of(attr, struct odev_attr, attr);\n\n\treturn a->show ? a->show(edp, buf) : 0;\n}",
    "includes": [
      "#include \"exofs.h\"",
      "#include <linux/device.h>",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->show",
          "args": [
            "edp",
            "buf"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structodev_attr",
            "attr"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structexofs_dev",
            "ed_kobj"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exofs.h\"\n#include <linux/device.h>\n#include <linux/kobject.h>\n\nstatic ssize_t odev_attr_show(struct kobject *kobj, struct attribute *attr,\n\t\tchar *buf)\n{\n\tstruct exofs_dev *edp = container_of(kobj, struct exofs_dev, ed_kobj);\n\tstruct odev_attr *a = container_of(attr, struct odev_attr, attr);\n\n\treturn a->show ? a->show(edp, buf) : 0;\n}"
  }
]