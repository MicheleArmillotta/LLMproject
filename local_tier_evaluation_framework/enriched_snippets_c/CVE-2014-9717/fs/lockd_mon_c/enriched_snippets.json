[
  {
    "function_name": "nsm_xdr_dec_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "559-572",
    "snippet": "static int nsm_xdr_dec_stat(struct rpc_rqst *rqstp,\n\t\t\t    struct xdr_stream *xdr,\n\t\t\t    struct nsm_res *resp)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\treturn -EIO;\n\tresp->state = be32_to_cpup(p);\n\n\tdprintk(\"lockd: %s state %d\\n\", __func__, resp->state);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: %s state %d\\n\"",
            "__func__",
            "resp->state"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic int nsm_xdr_dec_stat(struct rpc_rqst *rqstp,\n\t\t\t    struct xdr_stream *xdr,\n\t\t\t    struct nsm_res *resp)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\treturn -EIO;\n\tresp->state = be32_to_cpup(p);\n\n\tdprintk(\"lockd: %s state %d\\n\", __func__, resp->state);\n\treturn 0;\n}"
  },
  {
    "function_name": "nsm_xdr_dec_stat_res",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "542-557",
    "snippet": "static int nsm_xdr_dec_stat_res(struct rpc_rqst *rqstp,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nsm_res *resp)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4 + 4);\n\tif (unlikely(p == NULL))\n\t\treturn -EIO;\n\tresp->status = be32_to_cpup(p++);\n\tresp->state = be32_to_cpup(p);\n\n\tdprintk(\"lockd: %s status %d state %d\\n\",\n\t\t__func__, resp->status, resp->state);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: %s status %d state %d\\n\"",
            "__func__",
            "resp->status",
            "resp->state"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4 + 4"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic int nsm_xdr_dec_stat_res(struct rpc_rqst *rqstp,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nsm_res *resp)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4 + 4);\n\tif (unlikely(p == NULL))\n\t\treturn -EIO;\n\tresp->status = be32_to_cpup(p++);\n\tresp->state = be32_to_cpup(p);\n\n\tdprintk(\"lockd: %s status %d state %d\\n\",\n\t\t__func__, resp->status, resp->state);\n\treturn 0;\n}"
  },
  {
    "function_name": "nsm_xdr_enc_unmon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "536-540",
    "snippet": "static void nsm_xdr_enc_unmon(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      const struct nsm_args *argp)\n{\n\tencode_mon_id(xdr, argp);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_mon_id",
          "args": [
            "xdr",
            "argp"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "encode_mon_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "510-514",
          "snippet": "static void encode_mon_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_mon_name(xdr, argp);\n\tencode_my_id(xdr, argp);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_mon_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_mon_name(xdr, argp);\n\tencode_my_id(xdr, argp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void nsm_xdr_enc_unmon(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      const struct nsm_args *argp)\n{\n\tencode_mon_id(xdr, argp);\n}"
  },
  {
    "function_name": "nsm_xdr_enc_mon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "529-534",
    "snippet": "static void nsm_xdr_enc_mon(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t    const struct nsm_args *argp)\n{\n\tencode_mon_id(xdr, argp);\n\tencode_priv(xdr, argp);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_priv",
          "args": [
            "xdr",
            "argp"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "encode_priv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "521-527",
          "snippet": "static void encode_priv(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, SM_PRIV_SIZE);\n\txdr_encode_opaque_fixed(p, argp->priv->data, SM_PRIV_SIZE);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_priv(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, SM_PRIV_SIZE);\n\txdr_encode_opaque_fixed(p, argp->priv->data, SM_PRIV_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_mon_id",
          "args": [
            "xdr",
            "argp"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "encode_mon_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "510-514",
          "snippet": "static void encode_mon_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_mon_name(xdr, argp);\n\tencode_my_id(xdr, argp);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_mon_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_mon_name(xdr, argp);\n\tencode_my_id(xdr, argp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void nsm_xdr_enc_mon(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t    const struct nsm_args *argp)\n{\n\tencode_mon_id(xdr, argp);\n\tencode_priv(xdr, argp);\n}"
  },
  {
    "function_name": "encode_priv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "521-527",
    "snippet": "static void encode_priv(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, SM_PRIV_SIZE);\n\txdr_encode_opaque_fixed(p, argp->priv->data, SM_PRIV_SIZE);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "argp->priv->data",
            "SM_PRIV_SIZE"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "SM_PRIV_SIZE"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_priv(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, SM_PRIV_SIZE);\n\txdr_encode_opaque_fixed(p, argp->priv->data, SM_PRIV_SIZE);\n}"
  },
  {
    "function_name": "encode_mon_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "510-514",
    "snippet": "static void encode_mon_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_mon_name(xdr, argp);\n\tencode_my_id(xdr, argp);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_my_id",
          "args": [
            "xdr",
            "argp"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "encode_my_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "495-504",
          "snippet": "static void encode_my_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tencode_nsm_string(xdr, argp->nodename);\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(argp->prog);\n\t*p++ = cpu_to_be32(argp->vers);\n\t*p = cpu_to_be32(argp->proc);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_my_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tencode_nsm_string(xdr, argp->nodename);\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(argp->prog);\n\t*p++ = cpu_to_be32(argp->vers);\n\t*p = cpu_to_be32(argp->proc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_mon_name",
          "args": [
            "xdr",
            "argp"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "encode_mon_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "484-487",
          "snippet": "static void encode_mon_name(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_nsm_string(xdr, argp->mon_name);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_mon_name(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_nsm_string(xdr, argp->mon_name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_mon_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_mon_name(xdr, argp);\n\tencode_my_id(xdr, argp);\n}"
  },
  {
    "function_name": "encode_my_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "495-504",
    "snippet": "static void encode_my_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tencode_nsm_string(xdr, argp->nodename);\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(argp->prog);\n\t*p++ = cpu_to_be32(argp->vers);\n\t*p = cpu_to_be32(argp->proc);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "argp->proc"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "argp->vers"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "argp->prog"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + 4 + 4"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_nsm_string",
          "args": [
            "xdr",
            "argp->nodename"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nsm_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "472-479",
          "snippet": "static void encode_nsm_string(struct xdr_stream *xdr, const char *string)\n{\n\tconst u32 len = strlen(string);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, string, len);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_nsm_string(struct xdr_stream *xdr, const char *string)\n{\n\tconst u32 len = strlen(string);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, string, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_my_id(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\t__be32 *p;\n\n\tencode_nsm_string(xdr, argp->nodename);\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(argp->prog);\n\t*p++ = cpu_to_be32(argp->vers);\n\t*p = cpu_to_be32(argp->proc);\n}"
  },
  {
    "function_name": "encode_mon_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "484-487",
    "snippet": "static void encode_mon_name(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_nsm_string(xdr, argp->mon_name);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nsm_string",
          "args": [
            "xdr",
            "argp->mon_name"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nsm_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "472-479",
          "snippet": "static void encode_nsm_string(struct xdr_stream *xdr, const char *string)\n{\n\tconst u32 len = strlen(string);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, string, len);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_nsm_string(struct xdr_stream *xdr, const char *string)\n{\n\tconst u32 len = strlen(string);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, string, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_mon_name(struct xdr_stream *xdr, const struct nsm_args *argp)\n{\n\tencode_nsm_string(xdr, argp->mon_name);\n}"
  },
  {
    "function_name": "encode_nsm_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "472-479",
    "snippet": "static void encode_nsm_string(struct xdr_stream *xdr, const char *string)\n{\n\tconst u32 len = strlen(string);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, string, len);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "string",
            "len"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + len"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void encode_nsm_string(struct xdr_stream *xdr, const char *string)\n{\n\tconst u32 len = strlen(string);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, string, len);\n}"
  },
  {
    "function_name": "nsm_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "454-463",
    "snippet": "void nsm_release(struct nsm_handle *nsm)\n{\n\tif (atomic_dec_and_lock(&nsm->sm_count, &nsm_lock)) {\n\t\tlist_del(&nsm->sm_link);\n\t\tspin_unlock(&nsm_lock);\n\t\tdprintk(\"lockd: destroyed nsm_handle for %s (%s)\\n\",\n\t\t\t\tnsm->sm_name, nsm->sm_addrbuf);\n\t\tkfree(nsm);\n\t}\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\t\t\t\tDEFINE_SPINLOCK(nsm_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "nsm"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: destroyed nsm_handle for %s (%s)\\n\"",
            "nsm->sm_name",
            "nsm->sm_addrbuf"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nsm_lock"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&nsm->sm_link"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_lock",
          "args": [
            "&nsm->sm_count",
            "&nsm_lock"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tDEFINE_SPINLOCK(nsm_lock);\n\nvoid nsm_release(struct nsm_handle *nsm)\n{\n\tif (atomic_dec_and_lock(&nsm->sm_count, &nsm_lock)) {\n\t\tlist_del(&nsm->sm_link);\n\t\tspin_unlock(&nsm_lock);\n\t\tdprintk(\"lockd: destroyed nsm_handle for %s (%s)\\n\",\n\t\t\t\tnsm->sm_name, nsm->sm_addrbuf);\n\t\tkfree(nsm);\n\t}\n}"
  },
  {
    "function_name": "nsm_reboot_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "426-447",
    "snippet": "struct nsm_handle *nsm_reboot_lookup(const struct nlm_reboot *info)\n{\n\tstruct nsm_handle *cached;\n\n\tspin_lock(&nsm_lock);\n\n\tcached = nsm_lookup_priv(&info->priv);\n\tif (unlikely(cached == NULL)) {\n\t\tspin_unlock(&nsm_lock);\n\t\tdprintk(\"lockd: never saw rebooted peer '%.*s' before\\n\",\n\t\t\t\tinfo->len, info->mon);\n\t\treturn cached;\n\t}\n\n\tatomic_inc(&cached->sm_count);\n\tspin_unlock(&nsm_lock);\n\n\tdprintk(\"lockd: host %s (%s) rebooted, cnt %d\\n\",\n\t\t\tcached->sm_name, cached->sm_addrbuf,\n\t\t\tatomic_read(&cached->sm_count));\n\treturn cached;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\t\t\t\tDEFINE_SPINLOCK(nsm_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: host %s (%s) rebooted, cnt %d\\n\"",
            "cached->sm_name",
            "cached->sm_addrbuf",
            "atomic_read(&cached->sm_count)"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&cached->sm_count"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nsm_lock"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&cached->sm_count"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: never saw rebooted peer '%.*s' before\\n\"",
            "info->len",
            "info->mon"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "cached == NULL"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_lookup_priv",
          "args": [
            "&info->priv"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_lookup_priv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "289-298",
          "snippet": "static struct nsm_handle *nsm_lookup_priv(const struct nsm_private *priv)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (memcmp(nsm->sm_priv.data, priv->data,\n\t\t\t\t\tsizeof(priv->data)) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\t\t\t\tLIST_HEAD(nsm_handles);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tLIST_HEAD(nsm_handles);\n\nstatic struct nsm_handle *nsm_lookup_priv(const struct nsm_private *priv)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (memcmp(nsm->sm_priv.data, priv->data,\n\t\t\t\t\tsizeof(priv->data)) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nsm_lock"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tDEFINE_SPINLOCK(nsm_lock);\n\nstruct nsm_handle *nsm_reboot_lookup(const struct nlm_reboot *info)\n{\n\tstruct nsm_handle *cached;\n\n\tspin_lock(&nsm_lock);\n\n\tcached = nsm_lookup_priv(&info->priv);\n\tif (unlikely(cached == NULL)) {\n\t\tspin_unlock(&nsm_lock);\n\t\tdprintk(\"lockd: never saw rebooted peer '%.*s' before\\n\",\n\t\t\t\tinfo->len, info->mon);\n\t\treturn cached;\n\t}\n\n\tatomic_inc(&cached->sm_count);\n\tspin_unlock(&nsm_lock);\n\n\tdprintk(\"lockd: host %s (%s) rebooted, cnt %d\\n\",\n\t\t\tcached->sm_name, cached->sm_addrbuf,\n\t\t\tatomic_read(&cached->sm_count));\n\treturn cached;\n}"
  },
  {
    "function_name": "nsm_get_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "368-416",
    "snippet": "struct nsm_handle *nsm_get_handle(const struct sockaddr *sap,\n\t\t\t\t  const size_t salen, const char *hostname,\n\t\t\t\t  const size_t hostname_len)\n{\n\tstruct nsm_handle *cached, *new = NULL;\n\n\tif (hostname && memchr(hostname, '/', hostname_len) != NULL) {\n\t\tif (printk_ratelimit()) {\n\t\t\tprintk(KERN_WARNING \"Invalid hostname \\\"%.*s\\\" \"\n\t\t\t\t\t    \"in NFS lock request\\n\",\n\t\t\t\t(int)hostname_len, hostname);\n\t\t}\n\t\treturn NULL;\n\t}\n\nretry:\n\tspin_lock(&nsm_lock);\n\n\tif (nsm_use_hostnames && hostname != NULL)\n\t\tcached = nsm_lookup_hostname(hostname, hostname_len);\n\telse\n\t\tcached = nsm_lookup_addr(sap);\n\n\tif (cached != NULL) {\n\t\tatomic_inc(&cached->sm_count);\n\t\tspin_unlock(&nsm_lock);\n\t\tkfree(new);\n\t\tdprintk(\"lockd: found nsm_handle for %s (%s), \"\n\t\t\t\t\"cnt %d\\n\", cached->sm_name,\n\t\t\t\tcached->sm_addrbuf,\n\t\t\t\tatomic_read(&cached->sm_count));\n\t\treturn cached;\n\t}\n\n\tif (new != NULL) {\n\t\tlist_add(&new->sm_link, &nsm_handles);\n\t\tspin_unlock(&nsm_lock);\n\t\tdprintk(\"lockd: created nsm_handle for %s (%s)\\n\",\n\t\t\t\tnew->sm_name, new->sm_addrbuf);\n\t\treturn new;\n\t}\n\n\tspin_unlock(&nsm_lock);\n\n\tnew = nsm_create_handle(sap, salen, hostname, hostname_len);\n\tif (unlikely(new == NULL))\n\t\treturn NULL;\n\tgoto retry;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\t\t\t\tLIST_HEAD(nsm_handles);",
      "static\t\t\t\tDEFINE_SPINLOCK(nsm_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "new == NULL"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_create_handle",
          "args": [
            "sap",
            "salen",
            "hostname",
            "hostname_len"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_create_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "327-352",
          "snippet": "static struct nsm_handle *nsm_create_handle(const struct sockaddr *sap,\n\t\t\t\t\t    const size_t salen,\n\t\t\t\t\t    const char *hostname,\n\t\t\t\t\t    const size_t hostname_len)\n{\n\tstruct nsm_handle *new;\n\n\tnew = kzalloc(sizeof(*new) + hostname_len + 1, GFP_KERNEL);\n\tif (unlikely(new == NULL))\n\t\treturn NULL;\n\n\tatomic_set(&new->sm_count, 1);\n\tnew->sm_name = (char *)(new + 1);\n\tmemcpy(nsm_addr(new), sap, salen);\n\tnew->sm_addrlen = salen;\n\tnsm_init_private(new);\n\n\tif (rpc_ntop(nsm_addr(new), new->sm_addrbuf,\n\t\t\t\t\tsizeof(new->sm_addrbuf)) == 0)\n\t\t(void)snprintf(new->sm_addrbuf, sizeof(new->sm_addrbuf),\n\t\t\t\t\"unsupported address family\");\n\tmemcpy(new->sm_name, hostname, hostname_len);\n\tnew->sm_name[hostname_len] = '\\0';\n\n\treturn new;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic struct nsm_handle *nsm_create_handle(const struct sockaddr *sap,\n\t\t\t\t\t    const size_t salen,\n\t\t\t\t\t    const char *hostname,\n\t\t\t\t\t    const size_t hostname_len)\n{\n\tstruct nsm_handle *new;\n\n\tnew = kzalloc(sizeof(*new) + hostname_len + 1, GFP_KERNEL);\n\tif (unlikely(new == NULL))\n\t\treturn NULL;\n\n\tatomic_set(&new->sm_count, 1);\n\tnew->sm_name = (char *)(new + 1);\n\tmemcpy(nsm_addr(new), sap, salen);\n\tnew->sm_addrlen = salen;\n\tnsm_init_private(new);\n\n\tif (rpc_ntop(nsm_addr(new), new->sm_addrbuf,\n\t\t\t\t\tsizeof(new->sm_addrbuf)) == 0)\n\t\t(void)snprintf(new->sm_addrbuf, sizeof(new->sm_addrbuf),\n\t\t\t\t\"unsupported address family\");\n\tmemcpy(new->sm_name, hostname, hostname_len);\n\tnew->sm_name[hostname_len] = '\\0';\n\n\treturn new;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nsm_lock"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: created nsm_handle for %s (%s)\\n\"",
            "new->sm_name",
            "new->sm_addrbuf"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&new->sm_link",
            "&nsm_handles"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: found nsm_handle for %s (%s), \"\n\t\t\t\t\"cnt %d\\n\"",
            "cached->sm_name",
            "cached->sm_addrbuf",
            "atomic_read(&cached->sm_count)"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&cached->sm_count"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "new"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&cached->sm_count"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_lookup_addr",
          "args": [
            "sap"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_lookup_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "279-287",
          "snippet": "static struct nsm_handle *nsm_lookup_addr(const struct sockaddr *sap)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (rpc_cmp_addr(nsm_addr(nsm), sap))\n\t\t\treturn nsm;\n\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\t\t\t\tLIST_HEAD(nsm_handles);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tLIST_HEAD(nsm_handles);\n\nstatic struct nsm_handle *nsm_lookup_addr(const struct sockaddr *sap)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (rpc_cmp_addr(nsm_addr(nsm), sap))\n\t\t\treturn nsm;\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nsm_lookup_hostname",
          "args": [
            "hostname",
            "hostname_len"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_lookup_hostname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "267-277",
          "snippet": "static struct nsm_handle *nsm_lookup_hostname(const char *hostname,\n\t\t\t\t\t      const size_t len)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (strlen(nsm->sm_name) == len &&\n\t\t    memcmp(nsm->sm_name, hostname, len) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\t\t\t\tLIST_HEAD(nsm_handles);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tLIST_HEAD(nsm_handles);\n\nstatic struct nsm_handle *nsm_lookup_hostname(const char *hostname,\n\t\t\t\t\t      const size_t len)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (strlen(nsm->sm_name) == len &&\n\t\t    memcmp(nsm->sm_name, hostname, len) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nsm_lock"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"Invalid hostname \\\"%.*s\\\" \"\n\t\t\t\t\t    \"in NFS lock request\\n\"",
            "(int)hostname_len",
            "hostname"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_ratelimit",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "hostname",
            "'/'",
            "hostname_len"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tLIST_HEAD(nsm_handles);\nstatic\t\t\t\tDEFINE_SPINLOCK(nsm_lock);\n\nstruct nsm_handle *nsm_get_handle(const struct sockaddr *sap,\n\t\t\t\t  const size_t salen, const char *hostname,\n\t\t\t\t  const size_t hostname_len)\n{\n\tstruct nsm_handle *cached, *new = NULL;\n\n\tif (hostname && memchr(hostname, '/', hostname_len) != NULL) {\n\t\tif (printk_ratelimit()) {\n\t\t\tprintk(KERN_WARNING \"Invalid hostname \\\"%.*s\\\" \"\n\t\t\t\t\t    \"in NFS lock request\\n\",\n\t\t\t\t(int)hostname_len, hostname);\n\t\t}\n\t\treturn NULL;\n\t}\n\nretry:\n\tspin_lock(&nsm_lock);\n\n\tif (nsm_use_hostnames && hostname != NULL)\n\t\tcached = nsm_lookup_hostname(hostname, hostname_len);\n\telse\n\t\tcached = nsm_lookup_addr(sap);\n\n\tif (cached != NULL) {\n\t\tatomic_inc(&cached->sm_count);\n\t\tspin_unlock(&nsm_lock);\n\t\tkfree(new);\n\t\tdprintk(\"lockd: found nsm_handle for %s (%s), \"\n\t\t\t\t\"cnt %d\\n\", cached->sm_name,\n\t\t\t\tcached->sm_addrbuf,\n\t\t\t\tatomic_read(&cached->sm_count));\n\t\treturn cached;\n\t}\n\n\tif (new != NULL) {\n\t\tlist_add(&new->sm_link, &nsm_handles);\n\t\tspin_unlock(&nsm_lock);\n\t\tdprintk(\"lockd: created nsm_handle for %s (%s)\\n\",\n\t\t\t\tnew->sm_name, new->sm_addrbuf);\n\t\treturn new;\n\t}\n\n\tspin_unlock(&nsm_lock);\n\n\tnew = nsm_create_handle(sap, salen, hostname, hostname_len);\n\tif (unlikely(new == NULL))\n\t\treturn NULL;\n\tgoto retry;\n}"
  },
  {
    "function_name": "nsm_create_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "327-352",
    "snippet": "static struct nsm_handle *nsm_create_handle(const struct sockaddr *sap,\n\t\t\t\t\t    const size_t salen,\n\t\t\t\t\t    const char *hostname,\n\t\t\t\t\t    const size_t hostname_len)\n{\n\tstruct nsm_handle *new;\n\n\tnew = kzalloc(sizeof(*new) + hostname_len + 1, GFP_KERNEL);\n\tif (unlikely(new == NULL))\n\t\treturn NULL;\n\n\tatomic_set(&new->sm_count, 1);\n\tnew->sm_name = (char *)(new + 1);\n\tmemcpy(nsm_addr(new), sap, salen);\n\tnew->sm_addrlen = salen;\n\tnsm_init_private(new);\n\n\tif (rpc_ntop(nsm_addr(new), new->sm_addrbuf,\n\t\t\t\t\tsizeof(new->sm_addrbuf)) == 0)\n\t\t(void)snprintf(new->sm_addrbuf, sizeof(new->sm_addrbuf),\n\t\t\t\t\"unsupported address family\");\n\tmemcpy(new->sm_name, hostname, hostname_len);\n\tnew->sm_name[hostname_len] = '\\0';\n\n\treturn new;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new->sm_name",
            "hostname",
            "hostname_len"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "new->sm_addrbuf",
            "sizeof(new->sm_addrbuf)",
            "\"unsupported address family\""
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_ntop",
          "args": [
            "nsm_addr(new)",
            "new->sm_addrbuf",
            "sizeof(new->sm_addrbuf)"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_addr",
          "args": [
            "new"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "63-66",
          "snippet": "static inline struct sockaddr *nsm_addr(const struct nsm_handle *nsm)\n{\n\treturn (struct sockaddr *)&nsm->sm_addr;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic inline struct sockaddr *nsm_addr(const struct nsm_handle *nsm)\n{\n\treturn (struct sockaddr *)&nsm->sm_addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nsm_init_private",
          "args": [
            "new"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_init_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "317-325",
          "snippet": "static void nsm_init_private(struct nsm_handle *nsm)\n{\n\tu64 *p = (u64 *)&nsm->sm_priv.data;\n\ts64 ns;\n\n\tns = ktime_get_ns();\n\tput_unaligned(ns, p);\n\tput_unaligned((unsigned long)nsm, p + 1);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void nsm_init_private(struct nsm_handle *nsm)\n{\n\tu64 *p = (u64 *)&nsm->sm_priv.data;\n\ts64 ns;\n\n\tns = ktime_get_ns();\n\tput_unaligned(ns, p);\n\tput_unaligned((unsigned long)nsm, p + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "nsm_addr(new)",
            "sap",
            "salen"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&new->sm_count",
            "1"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "new == NULL"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*new) + hostname_len + 1",
            "GFP_KERNEL"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic struct nsm_handle *nsm_create_handle(const struct sockaddr *sap,\n\t\t\t\t\t    const size_t salen,\n\t\t\t\t\t    const char *hostname,\n\t\t\t\t\t    const size_t hostname_len)\n{\n\tstruct nsm_handle *new;\n\n\tnew = kzalloc(sizeof(*new) + hostname_len + 1, GFP_KERNEL);\n\tif (unlikely(new == NULL))\n\t\treturn NULL;\n\n\tatomic_set(&new->sm_count, 1);\n\tnew->sm_name = (char *)(new + 1);\n\tmemcpy(nsm_addr(new), sap, salen);\n\tnew->sm_addrlen = salen;\n\tnsm_init_private(new);\n\n\tif (rpc_ntop(nsm_addr(new), new->sm_addrbuf,\n\t\t\t\t\tsizeof(new->sm_addrbuf)) == 0)\n\t\t(void)snprintf(new->sm_addrbuf, sizeof(new->sm_addrbuf),\n\t\t\t\t\"unsupported address family\");\n\tmemcpy(new->sm_name, hostname, hostname_len);\n\tnew->sm_name[hostname_len] = '\\0';\n\n\treturn new;\n}"
  },
  {
    "function_name": "nsm_init_private",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "317-325",
    "snippet": "static void nsm_init_private(struct nsm_handle *nsm)\n{\n\tu64 *p = (u64 *)&nsm->sm_priv.data;\n\ts64 ns;\n\n\tns = ktime_get_ns();\n\tput_unaligned(ns, p);\n\tput_unaligned((unsigned long)nsm, p + 1);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_unaligned",
          "args": [
            "(unsigned long)nsm",
            "p + 1"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "put_unaligned_le8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/struct-funcs.c",
          "lines": "29-32",
          "snippet": "static inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/highmem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/highmem.h>\n\nstatic inline void put_unaligned_le8(u8 val, void *p)\n{\n       *(u8 *)p = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ktime_get_ns",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void nsm_init_private(struct nsm_handle *nsm)\n{\n\tu64 *p = (u64 *)&nsm->sm_priv.data;\n\ts64 ns;\n\n\tns = ktime_get_ns();\n\tput_unaligned(ns, p);\n\tput_unaligned((unsigned long)nsm, p + 1);\n}"
  },
  {
    "function_name": "nsm_lookup_priv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "289-298",
    "snippet": "static struct nsm_handle *nsm_lookup_priv(const struct nsm_private *priv)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (memcmp(nsm->sm_priv.data, priv->data,\n\t\t\t\t\tsizeof(priv->data)) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\t\t\t\tLIST_HEAD(nsm_handles);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "nsm->sm_priv.data",
            "priv->data",
            "sizeof(priv->data)"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "nsm",
            "&nsm_handles",
            "sm_link"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tLIST_HEAD(nsm_handles);\n\nstatic struct nsm_handle *nsm_lookup_priv(const struct nsm_private *priv)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (memcmp(nsm->sm_priv.data, priv->data,\n\t\t\t\t\tsizeof(priv->data)) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}"
  },
  {
    "function_name": "nsm_lookup_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "279-287",
    "snippet": "static struct nsm_handle *nsm_lookup_addr(const struct sockaddr *sap)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (rpc_cmp_addr(nsm_addr(nsm), sap))\n\t\t\treturn nsm;\n\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\t\t\t\tLIST_HEAD(nsm_handles);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_cmp_addr",
          "args": [
            "nsm_addr(nsm)",
            "sap"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_addr",
          "args": [
            "nsm"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "63-66",
          "snippet": "static inline struct sockaddr *nsm_addr(const struct nsm_handle *nsm)\n{\n\treturn (struct sockaddr *)&nsm->sm_addr;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic inline struct sockaddr *nsm_addr(const struct nsm_handle *nsm)\n{\n\treturn (struct sockaddr *)&nsm->sm_addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "nsm",
            "&nsm_handles",
            "sm_link"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tLIST_HEAD(nsm_handles);\n\nstatic struct nsm_handle *nsm_lookup_addr(const struct sockaddr *sap)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (rpc_cmp_addr(nsm_addr(nsm), sap))\n\t\t\treturn nsm;\n\treturn NULL;\n}"
  },
  {
    "function_name": "nsm_lookup_hostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "267-277",
    "snippet": "static struct nsm_handle *nsm_lookup_hostname(const char *hostname,\n\t\t\t\t\t      const size_t len)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (strlen(nsm->sm_name) == len &&\n\t\t    memcmp(nsm->sm_name, hostname, len) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\t\t\t\tLIST_HEAD(nsm_handles);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "nsm->sm_name",
            "hostname",
            "len"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "nsm->sm_name"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "nsm",
            "&nsm_handles",
            "sm_link"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic\t\t\t\tLIST_HEAD(nsm_handles);\n\nstatic struct nsm_handle *nsm_lookup_hostname(const char *hostname,\n\t\t\t\t\t      const size_t len)\n{\n\tstruct nsm_handle *nsm;\n\n\tlist_for_each_entry(nsm, &nsm_handles, sm_link)\n\t\tif (strlen(nsm->sm_name) == len &&\n\t\t    memcmp(nsm->sm_name, hostname, len) == 0)\n\t\t\treturn nsm;\n\treturn NULL;\n}"
  },
  {
    "function_name": "nsm_unmonitor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "242-265",
    "snippet": "void nsm_unmonitor(const struct nlm_host *host)\n{\n\tstruct nsm_handle *nsm = host->h_nsmhandle;\n\tstruct nsm_res\tres;\n\tint status;\n\n\tif (atomic_read(&nsm->sm_count) == 1\n\t && nsm->sm_monitored && !nsm->sm_sticky) {\n\t\tstruct lockd_net *ln = net_generic(host->net, lockd_net_id);\n\n\t\tdprintk(\"lockd: nsm_unmonitor(%s)\\n\", nsm->sm_name);\n\n\t\tstatus = nsm_mon_unmon(nsm, NSMPROC_UNMON, &res, ln->nsm_clnt);\n\t\tif (res.status != 0)\n\t\t\tstatus = -EIO;\n\t\tif (status < 0)\n\t\t\tprintk(KERN_NOTICE \"lockd: cannot unmonitor %s\\n\",\n\t\t\t\t\tnsm->sm_name);\n\t\telse\n\t\t\tnsm->sm_monitored = 0;\n\n\t\tnsm_client_put(host->net);\n\t}\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nsm_client_put",
          "args": [
            "host->net"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_client_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "126-140",
          "snippet": "static void nsm_client_put(struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tstruct rpc_clnt\t*clnt = NULL;\n\n\tspin_lock(&ln->nsm_clnt_lock);\n\tln->nsm_users--;\n\tif (ln->nsm_users == 0) {\n\t\tclnt = ln->nsm_clnt;\n\t\tln->nsm_clnt = NULL;\n\t}\n\tspin_unlock(&ln->nsm_clnt_lock);\n\tif (clnt != NULL)\n\t\trpc_shutdown_client(clnt);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void nsm_client_put(struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tstruct rpc_clnt\t*clnt = NULL;\n\n\tspin_lock(&ln->nsm_clnt_lock);\n\tln->nsm_users--;\n\tif (ln->nsm_users == 0) {\n\t\tclnt = ln->nsm_clnt;\n\t\tln->nsm_clnt = NULL;\n\t}\n\tspin_unlock(&ln->nsm_clnt_lock);\n\tif (clnt != NULL)\n\t\trpc_shutdown_client(clnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"lockd: cannot unmonitor %s\\n\"",
            "nsm->sm_name"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nsm_mon_unmon",
          "args": [
            "nsm",
            "NSMPROC_UNMON",
            "&res",
            "ln->nsm_clnt"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_mon_unmon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "142-175",
          "snippet": "static int nsm_mon_unmon(struct nsm_handle *nsm, u32 proc, struct nsm_res *res,\n\t\t\t struct rpc_clnt *clnt)\n{\n\tint\t\tstatus;\n\tstruct nsm_args args = {\n\t\t.priv\t\t= &nsm->sm_priv,\n\t\t.prog\t\t= NLM_PROGRAM,\n\t\t.vers\t\t= 3,\n\t\t.proc\t\t= NLMPROC_NSM_NOTIFY,\n\t\t.mon_name\t= nsm->sm_mon_name,\n\t\t.nodename\t= clnt->cl_nodename,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_argp\t= &args,\n\t\t.rpc_resp\t= res,\n\t};\n\n\tmemset(res, 0, sizeof(*res));\n\n\tmsg.rpc_proc = &clnt->cl_procinfo[proc];\n\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\tif (status == -ECONNREFUSED) {\n\t\tdprintk(\"lockd:\tNSM upcall RPC failed, status=%d, forcing rebind\\n\",\n\t\t\t\tstatus);\n\t\trpc_force_rebind(clnt);\n\t\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\t}\n\tif (status < 0)\n\t\tdprintk(\"lockd: NSM upcall RPC failed, status=%d\\n\",\n\t\t\t\tstatus);\n\telse\n\t\tstatus = 0;\n\treturn status;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic int nsm_mon_unmon(struct nsm_handle *nsm, u32 proc, struct nsm_res *res,\n\t\t\t struct rpc_clnt *clnt)\n{\n\tint\t\tstatus;\n\tstruct nsm_args args = {\n\t\t.priv\t\t= &nsm->sm_priv,\n\t\t.prog\t\t= NLM_PROGRAM,\n\t\t.vers\t\t= 3,\n\t\t.proc\t\t= NLMPROC_NSM_NOTIFY,\n\t\t.mon_name\t= nsm->sm_mon_name,\n\t\t.nodename\t= clnt->cl_nodename,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_argp\t= &args,\n\t\t.rpc_resp\t= res,\n\t};\n\n\tmemset(res, 0, sizeof(*res));\n\n\tmsg.rpc_proc = &clnt->cl_procinfo[proc];\n\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\tif (status == -ECONNREFUSED) {\n\t\tdprintk(\"lockd:\tNSM upcall RPC failed, status=%d, forcing rebind\\n\",\n\t\t\t\tstatus);\n\t\trpc_force_rebind(clnt);\n\t\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\t}\n\tif (status < 0)\n\t\tdprintk(\"lockd: NSM upcall RPC failed, status=%d\\n\",\n\t\t\t\tstatus);\n\telse\n\t\tstatus = 0;\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: nsm_unmonitor(%s)\\n\"",
            "nsm->sm_name"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "host->net",
            "lockd_net_id"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&nsm->sm_count"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid nsm_unmonitor(const struct nlm_host *host)\n{\n\tstruct nsm_handle *nsm = host->h_nsmhandle;\n\tstruct nsm_res\tres;\n\tint status;\n\n\tif (atomic_read(&nsm->sm_count) == 1\n\t && nsm->sm_monitored && !nsm->sm_sticky) {\n\t\tstruct lockd_net *ln = net_generic(host->net, lockd_net_id);\n\n\t\tdprintk(\"lockd: nsm_unmonitor(%s)\\n\", nsm->sm_name);\n\n\t\tstatus = nsm_mon_unmon(nsm, NSMPROC_UNMON, &res, ln->nsm_clnt);\n\t\tif (res.status != 0)\n\t\t\tstatus = -EIO;\n\t\tif (status < 0)\n\t\t\tprintk(KERN_NOTICE \"lockd: cannot unmonitor %s\\n\",\n\t\t\t\t\tnsm->sm_name);\n\t\telse\n\t\t\tnsm->sm_monitored = 0;\n\n\t\tnsm_client_put(host->net);\n\t}\n}"
  },
  {
    "function_name": "nsm_monitor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "188-232",
    "snippet": "int nsm_monitor(const struct nlm_host *host)\n{\n\tstruct nsm_handle *nsm = host->h_nsmhandle;\n\tstruct nsm_res\tres;\n\tint\t\tstatus;\n\tstruct rpc_clnt *clnt;\n\tconst char *nodename = NULL;\n\n\tdprintk(\"lockd: nsm_monitor(%s)\\n\", nsm->sm_name);\n\n\tif (nsm->sm_monitored)\n\t\treturn 0;\n\n\tif (host->h_rpcclnt)\n\t\tnodename = host->h_rpcclnt->cl_nodename;\n\n\t/*\n\t * Choose whether to record the caller_name or IP address of\n\t * this peer in the local rpc.statd's database.\n\t */\n\tnsm->sm_mon_name = nsm_use_hostnames ? nsm->sm_name : nsm->sm_addrbuf;\n\n\tclnt = nsm_client_get(host->net, nodename);\n\tif (IS_ERR(clnt)) {\n\t\tstatus = PTR_ERR(clnt);\n\t\tdprintk(\"lockd: failed to create NSM upcall transport, \"\n\t\t\t\t\"status=%d, net=%p\\n\", status, host->net);\n\t\treturn status;\n\t}\n\n\tstatus = nsm_mon_unmon(nsm, NSMPROC_MON, &res, clnt);\n\tif (unlikely(res.status != 0))\n\t\tstatus = -EIO;\n\tif (unlikely(status < 0)) {\n\t\tpr_notice_ratelimited(\"lockd: cannot monitor %s\\n\", nsm->sm_name);\n\t\treturn status;\n\t}\n\n\tnsm->sm_monitored = 1;\n\tif (unlikely(nsm_local_state != res.state)) {\n\t\tnsm_local_state = res.state;\n\t\tdprintk(\"lockd: NSM state changed to %d\\n\", nsm_local_state);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: NSM state changed to %d\\n\"",
            "nsm_local_state"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "nsm_local_state != res.state"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_notice_ratelimited",
          "args": [
            "\"lockd: cannot monitor %s\\n\"",
            "nsm->sm_name"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status < 0"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "res.status != 0"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_mon_unmon",
          "args": [
            "nsm",
            "NSMPROC_MON",
            "&res",
            "clnt"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_mon_unmon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "142-175",
          "snippet": "static int nsm_mon_unmon(struct nsm_handle *nsm, u32 proc, struct nsm_res *res,\n\t\t\t struct rpc_clnt *clnt)\n{\n\tint\t\tstatus;\n\tstruct nsm_args args = {\n\t\t.priv\t\t= &nsm->sm_priv,\n\t\t.prog\t\t= NLM_PROGRAM,\n\t\t.vers\t\t= 3,\n\t\t.proc\t\t= NLMPROC_NSM_NOTIFY,\n\t\t.mon_name\t= nsm->sm_mon_name,\n\t\t.nodename\t= clnt->cl_nodename,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_argp\t= &args,\n\t\t.rpc_resp\t= res,\n\t};\n\n\tmemset(res, 0, sizeof(*res));\n\n\tmsg.rpc_proc = &clnt->cl_procinfo[proc];\n\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\tif (status == -ECONNREFUSED) {\n\t\tdprintk(\"lockd:\tNSM upcall RPC failed, status=%d, forcing rebind\\n\",\n\t\t\t\tstatus);\n\t\trpc_force_rebind(clnt);\n\t\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\t}\n\tif (status < 0)\n\t\tdprintk(\"lockd: NSM upcall RPC failed, status=%d\\n\",\n\t\t\t\tstatus);\n\telse\n\t\tstatus = 0;\n\treturn status;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic int nsm_mon_unmon(struct nsm_handle *nsm, u32 proc, struct nsm_res *res,\n\t\t\t struct rpc_clnt *clnt)\n{\n\tint\t\tstatus;\n\tstruct nsm_args args = {\n\t\t.priv\t\t= &nsm->sm_priv,\n\t\t.prog\t\t= NLM_PROGRAM,\n\t\t.vers\t\t= 3,\n\t\t.proc\t\t= NLMPROC_NSM_NOTIFY,\n\t\t.mon_name\t= nsm->sm_mon_name,\n\t\t.nodename\t= clnt->cl_nodename,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_argp\t= &args,\n\t\t.rpc_resp\t= res,\n\t};\n\n\tmemset(res, 0, sizeof(*res));\n\n\tmsg.rpc_proc = &clnt->cl_procinfo[proc];\n\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\tif (status == -ECONNREFUSED) {\n\t\tdprintk(\"lockd:\tNSM upcall RPC failed, status=%d, forcing rebind\\n\",\n\t\t\t\tstatus);\n\t\trpc_force_rebind(clnt);\n\t\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\t}\n\tif (status < 0)\n\t\tdprintk(\"lockd: NSM upcall RPC failed, status=%d\\n\",\n\t\t\t\tstatus);\n\telse\n\t\tstatus = 0;\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: failed to create NSM upcall transport, \"\n\t\t\t\t\"status=%d, net=%p\\n\"",
            "status",
            "host->net"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "clnt"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clnt"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_client_get",
          "args": [
            "host->net",
            "nodename"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_client_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "106-124",
          "snippet": "static struct rpc_clnt *nsm_client_get(struct net *net, const char *nodename)\n{\n\tstruct rpc_clnt\t*clnt, *new;\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tclnt = nsm_client_set(ln, NULL);\n\tif (clnt != NULL)\n\t\tgoto out;\n\n\tclnt = new = nsm_create(net, nodename);\n\tif (IS_ERR(clnt))\n\t\tgoto out;\n\n\tclnt = nsm_client_set(ln, new);\n\tif (clnt != new)\n\t\trpc_shutdown_client(new);\nout:\n\treturn clnt;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic struct rpc_clnt *nsm_client_get(struct net *net, const char *nodename)\n{\n\tstruct rpc_clnt\t*clnt, *new;\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tclnt = nsm_client_set(ln, NULL);\n\tif (clnt != NULL)\n\t\tgoto out;\n\n\tclnt = new = nsm_create(net, nodename);\n\tif (IS_ERR(clnt))\n\t\tgoto out;\n\n\tclnt = nsm_client_set(ln, new);\n\tif (clnt != new)\n\t\trpc_shutdown_client(new);\nout:\n\treturn clnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: nsm_monitor(%s)\\n\"",
            "nsm->sm_name"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint nsm_monitor(const struct nlm_host *host)\n{\n\tstruct nsm_handle *nsm = host->h_nsmhandle;\n\tstruct nsm_res\tres;\n\tint\t\tstatus;\n\tstruct rpc_clnt *clnt;\n\tconst char *nodename = NULL;\n\n\tdprintk(\"lockd: nsm_monitor(%s)\\n\", nsm->sm_name);\n\n\tif (nsm->sm_monitored)\n\t\treturn 0;\n\n\tif (host->h_rpcclnt)\n\t\tnodename = host->h_rpcclnt->cl_nodename;\n\n\t/*\n\t * Choose whether to record the caller_name or IP address of\n\t * this peer in the local rpc.statd's database.\n\t */\n\tnsm->sm_mon_name = nsm_use_hostnames ? nsm->sm_name : nsm->sm_addrbuf;\n\n\tclnt = nsm_client_get(host->net, nodename);\n\tif (IS_ERR(clnt)) {\n\t\tstatus = PTR_ERR(clnt);\n\t\tdprintk(\"lockd: failed to create NSM upcall transport, \"\n\t\t\t\t\"status=%d, net=%p\\n\", status, host->net);\n\t\treturn status;\n\t}\n\n\tstatus = nsm_mon_unmon(nsm, NSMPROC_MON, &res, clnt);\n\tif (unlikely(res.status != 0))\n\t\tstatus = -EIO;\n\tif (unlikely(status < 0)) {\n\t\tpr_notice_ratelimited(\"lockd: cannot monitor %s\\n\", nsm->sm_name);\n\t\treturn status;\n\t}\n\n\tnsm->sm_monitored = 1;\n\tif (unlikely(nsm_local_state != res.state)) {\n\t\tnsm_local_state = res.state;\n\t\tdprintk(\"lockd: NSM state changed to %d\\n\", nsm_local_state);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "nsm_mon_unmon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "142-175",
    "snippet": "static int nsm_mon_unmon(struct nsm_handle *nsm, u32 proc, struct nsm_res *res,\n\t\t\t struct rpc_clnt *clnt)\n{\n\tint\t\tstatus;\n\tstruct nsm_args args = {\n\t\t.priv\t\t= &nsm->sm_priv,\n\t\t.prog\t\t= NLM_PROGRAM,\n\t\t.vers\t\t= 3,\n\t\t.proc\t\t= NLMPROC_NSM_NOTIFY,\n\t\t.mon_name\t= nsm->sm_mon_name,\n\t\t.nodename\t= clnt->cl_nodename,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_argp\t= &args,\n\t\t.rpc_resp\t= res,\n\t};\n\n\tmemset(res, 0, sizeof(*res));\n\n\tmsg.rpc_proc = &clnt->cl_procinfo[proc];\n\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\tif (status == -ECONNREFUSED) {\n\t\tdprintk(\"lockd:\tNSM upcall RPC failed, status=%d, forcing rebind\\n\",\n\t\t\t\tstatus);\n\t\trpc_force_rebind(clnt);\n\t\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\t}\n\tif (status < 0)\n\t\tdprintk(\"lockd: NSM upcall RPC failed, status=%d\\n\",\n\t\t\t\tstatus);\n\telse\n\t\tstatus = 0;\n\treturn status;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: NSM upcall RPC failed, status=%d\\n\"",
            "status"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "clnt",
            "&msg",
            "RPC_TASK_SOFTCONN"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_force_rebind",
          "args": [
            "clnt"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd:\tNSM upcall RPC failed, status=%d, forcing rebind\\n\"",
            "status"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "clnt",
            "&msg",
            "RPC_TASK_SOFTCONN"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "res",
            "0",
            "sizeof(*res)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic int nsm_mon_unmon(struct nsm_handle *nsm, u32 proc, struct nsm_res *res,\n\t\t\t struct rpc_clnt *clnt)\n{\n\tint\t\tstatus;\n\tstruct nsm_args args = {\n\t\t.priv\t\t= &nsm->sm_priv,\n\t\t.prog\t\t= NLM_PROGRAM,\n\t\t.vers\t\t= 3,\n\t\t.proc\t\t= NLMPROC_NSM_NOTIFY,\n\t\t.mon_name\t= nsm->sm_mon_name,\n\t\t.nodename\t= clnt->cl_nodename,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_argp\t= &args,\n\t\t.rpc_resp\t= res,\n\t};\n\n\tmemset(res, 0, sizeof(*res));\n\n\tmsg.rpc_proc = &clnt->cl_procinfo[proc];\n\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\tif (status == -ECONNREFUSED) {\n\t\tdprintk(\"lockd:\tNSM upcall RPC failed, status=%d, forcing rebind\\n\",\n\t\t\t\tstatus);\n\t\trpc_force_rebind(clnt);\n\t\tstatus = rpc_call_sync(clnt, &msg, RPC_TASK_SOFTCONN);\n\t}\n\tif (status < 0)\n\t\tdprintk(\"lockd: NSM upcall RPC failed, status=%d\\n\",\n\t\t\t\tstatus);\n\telse\n\t\tstatus = 0;\n\treturn status;\n}"
  },
  {
    "function_name": "nsm_client_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "126-140",
    "snippet": "static void nsm_client_put(struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tstruct rpc_clnt\t*clnt = NULL;\n\n\tspin_lock(&ln->nsm_clnt_lock);\n\tln->nsm_users--;\n\tif (ln->nsm_users == 0) {\n\t\tclnt = ln->nsm_clnt;\n\t\tln->nsm_clnt = NULL;\n\t}\n\tspin_unlock(&ln->nsm_clnt_lock);\n\tif (clnt != NULL)\n\t\trpc_shutdown_client(clnt);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_shutdown_client",
          "args": [
            "clnt"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ln->nsm_clnt_lock"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ln->nsm_clnt_lock"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "lockd_net_id"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void nsm_client_put(struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tstruct rpc_clnt\t*clnt = NULL;\n\n\tspin_lock(&ln->nsm_clnt_lock);\n\tln->nsm_users--;\n\tif (ln->nsm_users == 0) {\n\t\tclnt = ln->nsm_clnt;\n\t\tln->nsm_clnt = NULL;\n\t}\n\tspin_unlock(&ln->nsm_clnt_lock);\n\tif (clnt != NULL)\n\t\trpc_shutdown_client(clnt);\n}"
  },
  {
    "function_name": "nsm_client_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "106-124",
    "snippet": "static struct rpc_clnt *nsm_client_get(struct net *net, const char *nodename)\n{\n\tstruct rpc_clnt\t*clnt, *new;\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tclnt = nsm_client_set(ln, NULL);\n\tif (clnt != NULL)\n\t\tgoto out;\n\n\tclnt = new = nsm_create(net, nodename);\n\tif (IS_ERR(clnt))\n\t\tgoto out;\n\n\tclnt = nsm_client_set(ln, new);\n\tif (clnt != new)\n\t\trpc_shutdown_client(new);\nout:\n\treturn clnt;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_shutdown_client",
          "args": [
            "new"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_client_set",
          "args": [
            "ln",
            "new"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_client_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "90-104",
          "snippet": "static struct rpc_clnt *nsm_client_set(struct lockd_net *ln,\n\t\tstruct rpc_clnt *clnt)\n{\n\tspin_lock(&ln->nsm_clnt_lock);\n\tif (ln->nsm_users == 0) {\n\t\tif (clnt == NULL)\n\t\t\tgoto out;\n\t\tln->nsm_clnt = clnt;\n\t}\n\tclnt = ln->nsm_clnt;\n\tln->nsm_users++;\nout:\n\tspin_unlock(&ln->nsm_clnt_lock);\n\treturn clnt;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic struct rpc_clnt *nsm_client_set(struct lockd_net *ln,\n\t\tstruct rpc_clnt *clnt)\n{\n\tspin_lock(&ln->nsm_clnt_lock);\n\tif (ln->nsm_users == 0) {\n\t\tif (clnt == NULL)\n\t\t\tgoto out;\n\t\tln->nsm_clnt = clnt;\n\t}\n\tclnt = ln->nsm_clnt;\n\tln->nsm_users++;\nout:\n\tspin_unlock(&ln->nsm_clnt_lock);\n\treturn clnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clnt"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nsm_create",
          "args": [
            "net",
            "nodename"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "nsm_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
          "lines": "68-88",
          "snippet": "static struct rpc_clnt *nsm_create(struct net *net, const char *nodename)\n{\n\tstruct sockaddr_in sin = {\n\t\t.sin_family\t\t= AF_INET,\n\t\t.sin_addr.s_addr\t= htonl(INADDR_LOOPBACK),\n\t};\n\tstruct rpc_create_args args = {\n\t\t.net\t\t\t= net,\n\t\t.protocol\t\t= XPRT_TRANSPORT_TCP,\n\t\t.address\t\t= (struct sockaddr *)&sin,\n\t\t.addrsize\t\t= sizeof(sin),\n\t\t.servername\t\t= \"rpc.statd\",\n\t\t.nodename\t\t= nodename,\n\t\t.program\t\t= &nsm_program,\n\t\t.version\t\t= NSM_VERSION,\n\t\t.authflavor\t\t= RPC_AUTH_NULL,\n\t\t.flags\t\t\t= RPC_CLNT_CREATE_NOPING,\n\t};\n\n\treturn rpc_create(&args);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/ktime.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NSM_VERSION\t\t1"
          ],
          "globals_used": [
            "static const struct rpc_program\tnsm_program;",
            "static const struct rpc_program nsm_program = {\n\t\t.name\t\t= \"statd\",\n\t\t.number\t\t= NSM_PROGRAM,\n\t\t.nrvers\t\t= ARRAY_SIZE(nsm_version),\n\t\t.version\t= nsm_version,\n\t\t.stats\t\t= &nsm_stats\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\n#define NSM_VERSION\t\t1\n\nstatic const struct rpc_program\tnsm_program;\nstatic const struct rpc_program nsm_program = {\n\t\t.name\t\t= \"statd\",\n\t\t.number\t\t= NSM_PROGRAM,\n\t\t.nrvers\t\t= ARRAY_SIZE(nsm_version),\n\t\t.version\t= nsm_version,\n\t\t.stats\t\t= &nsm_stats\n};\n\nstatic struct rpc_clnt *nsm_create(struct net *net, const char *nodename)\n{\n\tstruct sockaddr_in sin = {\n\t\t.sin_family\t\t= AF_INET,\n\t\t.sin_addr.s_addr\t= htonl(INADDR_LOOPBACK),\n\t};\n\tstruct rpc_create_args args = {\n\t\t.net\t\t\t= net,\n\t\t.protocol\t\t= XPRT_TRANSPORT_TCP,\n\t\t.address\t\t= (struct sockaddr *)&sin,\n\t\t.addrsize\t\t= sizeof(sin),\n\t\t.servername\t\t= \"rpc.statd\",\n\t\t.nodename\t\t= nodename,\n\t\t.program\t\t= &nsm_program,\n\t\t.version\t\t= NSM_VERSION,\n\t\t.authflavor\t\t= RPC_AUTH_NULL,\n\t\t.flags\t\t\t= RPC_CLNT_CREATE_NOPING,\n\t};\n\n\treturn rpc_create(&args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "lockd_net_id"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic struct rpc_clnt *nsm_client_get(struct net *net, const char *nodename)\n{\n\tstruct rpc_clnt\t*clnt, *new;\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tclnt = nsm_client_set(ln, NULL);\n\tif (clnt != NULL)\n\t\tgoto out;\n\n\tclnt = new = nsm_create(net, nodename);\n\tif (IS_ERR(clnt))\n\t\tgoto out;\n\n\tclnt = nsm_client_set(ln, new);\n\tif (clnt != new)\n\t\trpc_shutdown_client(new);\nout:\n\treturn clnt;\n}"
  },
  {
    "function_name": "nsm_client_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "90-104",
    "snippet": "static struct rpc_clnt *nsm_client_set(struct lockd_net *ln,\n\t\tstruct rpc_clnt *clnt)\n{\n\tspin_lock(&ln->nsm_clnt_lock);\n\tif (ln->nsm_users == 0) {\n\t\tif (clnt == NULL)\n\t\t\tgoto out;\n\t\tln->nsm_clnt = clnt;\n\t}\n\tclnt = ln->nsm_clnt;\n\tln->nsm_users++;\nout:\n\tspin_unlock(&ln->nsm_clnt_lock);\n\treturn clnt;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ln->nsm_clnt_lock"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ln->nsm_clnt_lock"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic struct rpc_clnt *nsm_client_set(struct lockd_net *ln,\n\t\tstruct rpc_clnt *clnt)\n{\n\tspin_lock(&ln->nsm_clnt_lock);\n\tif (ln->nsm_users == 0) {\n\t\tif (clnt == NULL)\n\t\t\tgoto out;\n\t\tln->nsm_clnt = clnt;\n\t}\n\tclnt = ln->nsm_clnt;\n\tln->nsm_users++;\nout:\n\tspin_unlock(&ln->nsm_clnt_lock);\n\treturn clnt;\n}"
  },
  {
    "function_name": "nsm_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "68-88",
    "snippet": "static struct rpc_clnt *nsm_create(struct net *net, const char *nodename)\n{\n\tstruct sockaddr_in sin = {\n\t\t.sin_family\t\t= AF_INET,\n\t\t.sin_addr.s_addr\t= htonl(INADDR_LOOPBACK),\n\t};\n\tstruct rpc_create_args args = {\n\t\t.net\t\t\t= net,\n\t\t.protocol\t\t= XPRT_TRANSPORT_TCP,\n\t\t.address\t\t= (struct sockaddr *)&sin,\n\t\t.addrsize\t\t= sizeof(sin),\n\t\t.servername\t\t= \"rpc.statd\",\n\t\t.nodename\t\t= nodename,\n\t\t.program\t\t= &nsm_program,\n\t\t.version\t\t= NSM_VERSION,\n\t\t.authflavor\t\t= RPC_AUTH_NULL,\n\t\t.flags\t\t\t= RPC_CLNT_CREATE_NOPING,\n\t};\n\n\treturn rpc_create(&args);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NSM_VERSION\t\t1"
    ],
    "globals_used": [
      "static const struct rpc_program\tnsm_program;",
      "static const struct rpc_program nsm_program = {\n\t\t.name\t\t= \"statd\",\n\t\t.number\t\t= NSM_PROGRAM,\n\t\t.nrvers\t\t= ARRAY_SIZE(nsm_version),\n\t\t.version\t= nsm_version,\n\t\t.stats\t\t= &nsm_stats\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_create",
          "args": [
            "&args"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "INADDR_LOOPBACK"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\n#define NSM_VERSION\t\t1\n\nstatic const struct rpc_program\tnsm_program;\nstatic const struct rpc_program nsm_program = {\n\t\t.name\t\t= \"statd\",\n\t\t.number\t\t= NSM_PROGRAM,\n\t\t.nrvers\t\t= ARRAY_SIZE(nsm_version),\n\t\t.version\t= nsm_version,\n\t\t.stats\t\t= &nsm_stats\n};\n\nstatic struct rpc_clnt *nsm_create(struct net *net, const char *nodename)\n{\n\tstruct sockaddr_in sin = {\n\t\t.sin_family\t\t= AF_INET,\n\t\t.sin_addr.s_addr\t= htonl(INADDR_LOOPBACK),\n\t};\n\tstruct rpc_create_args args = {\n\t\t.net\t\t\t= net,\n\t\t.protocol\t\t= XPRT_TRANSPORT_TCP,\n\t\t.address\t\t= (struct sockaddr *)&sin,\n\t\t.addrsize\t\t= sizeof(sin),\n\t\t.servername\t\t= \"rpc.statd\",\n\t\t.nodename\t\t= nodename,\n\t\t.program\t\t= &nsm_program,\n\t\t.version\t\t= NSM_VERSION,\n\t\t.authflavor\t\t= RPC_AUTH_NULL,\n\t\t.flags\t\t\t= RPC_CLNT_CREATE_NOPING,\n\t};\n\n\treturn rpc_create(&args);\n}"
  },
  {
    "function_name": "nsm_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/mon.c",
    "lines": "63-66",
    "snippet": "static inline struct sockaddr *nsm_addr(const struct nsm_handle *nsm)\n{\n\treturn (struct sockaddr *)&nsm->sm_addr;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include <asm/unaligned.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/slab.h>",
      "#include <linux/ktime.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include <asm/unaligned.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/ktime.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic inline struct sockaddr *nsm_addr(const struct nsm_handle *nsm)\n{\n\treturn (struct sockaddr *)&nsm->sm_addr;\n}"
  }
]