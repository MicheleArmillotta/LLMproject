[
  {
    "function_name": "fh_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "282-290",
    "snippet": "static inline void\nfh_unlock(struct svc_fh *fhp)\n{\n\tif (fhp->fh_locked) {\n\t\tfill_post_wcc(fhp);\n\t\tmutex_unlock(&fhp->fh_dentry->d_inode->i_mutex);\n\t\tfhp->fh_locked = 0;\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&fhp->fh_dentry->d_inode->i_mutex"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fill_post_wcc",
          "args": [
            "fhp"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "fill_post_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs3xdr.c",
          "lines": "255-270",
          "snippet": "void fill_post_wcc(struct svc_fh *fhp)\n{\n\t__be32 err;\n\n\tif (fhp->fh_post_saved)\n\t\tprintk(\"nfsd: inode locked twice during operation.\\n\");\n\n\terr = fh_getattr(fhp, &fhp->fh_post_attr);\n\tfhp->fh_post_change = fhp->fh_dentry->d_inode->i_version;\n\tif (err) {\n\t\tfhp->fh_post_saved = 0;\n\t\t/* Grab the ctime anyway - set_change_info might use it */\n\t\tfhp->fh_post_attr.ctime = fhp->fh_dentry->d_inode->i_ctime;\n\t} else\n\t\tfhp->fh_post_saved = 1;\n}",
          "includes": [
            "#include \"vfs.h\"",
            "#include \"netns.h\"",
            "#include \"auth.h\"",
            "#include \"xdr3.h\"",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/namei.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vfs.h\"\n#include \"netns.h\"\n#include \"auth.h\"\n#include \"xdr3.h\"\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/namei.h>\n\nvoid fill_post_wcc(struct svc_fh *fhp)\n{\n\t__be32 err;\n\n\tif (fhp->fh_post_saved)\n\t\tprintk(\"nfsd: inode locked twice during operation.\\n\");\n\n\terr = fh_getattr(fhp, &fhp->fh_post_attr);\n\tfhp->fh_post_change = fhp->fh_dentry->d_inode->i_version;\n\tif (err) {\n\t\tfhp->fh_post_saved = 0;\n\t\t/* Grab the ctime anyway - set_change_info might use it */\n\t\tfhp->fh_post_attr.ctime = fhp->fh_dentry->d_inode->i_ctime;\n\t} else\n\t\tfhp->fh_post_saved = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfh_unlock(struct svc_fh *fhp)\n{\n\tif (fhp->fh_locked) {\n\t\tfill_post_wcc(fhp);\n\t\tmutex_unlock(&fhp->fh_dentry->d_inode->i_mutex);\n\t\tfhp->fh_locked = 0;\n\t}\n}"
  },
  {
    "function_name": "fh_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "273-277",
    "snippet": "static inline void\nfh_lock(struct svc_fh *fhp)\n{\n\tfh_lock_nested(fhp, I_MUTEX_NORMAL);\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fh_lock_nested",
          "args": [
            "fhp",
            "I_MUTEX_NORMAL"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "fh_lock_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
          "lines": "253-271",
          "snippet": "static inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = dentry->d_inode;\n\tmutex_lock_nested(&inode->i_mutex, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = 1;\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = dentry->d_inode;\n\tmutex_lock_nested(&inode->i_mutex, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfh_lock(struct svc_fh *fhp)\n{\n\tfh_lock_nested(fhp, I_MUTEX_NORMAL);\n}"
  },
  {
    "function_name": "fh_lock_nested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "253-271",
    "snippet": "static inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = dentry->d_inode;\n\tmutex_lock_nested(&inode->i_mutex, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = 1;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fill_pre_wcc",
          "args": [
            "fhp"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "fill_pre_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
          "lines": "223-236",
          "snippet": "static inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = fhp->fh_dentry->d_inode;\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = 1;\n\t}\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = fhp->fh_dentry->d_inode;\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock_nested",
          "args": [
            "&inode->i_mutex",
            "subclass"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"fh_lock: %pd2 already locked!\\n\"",
            "dentry"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!dentry"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = dentry->d_inode;\n\tmutex_lock_nested(&inode->i_mutex, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = 1;\n}"
  },
  {
    "function_name": "fill_pre_wcc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "223-236",
    "snippet": "static inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = fhp->fh_dentry->d_inode;\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = 1;\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = fhp->fh_dentry->d_inode;\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = 1;\n\t}\n}"
  },
  {
    "function_name": "fh_clear_wcc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "213-218",
    "snippet": "static inline void\nfh_clear_wcc(struct svc_fh *fhp)\n{\n\tfhp->fh_post_saved = 0;\n\tfhp->fh_pre_saved = 0;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfh_clear_wcc(struct svc_fh *fhp)\n{\n\tfhp->fh_post_saved = 0;\n\tfhp->fh_pre_saved = 0;\n}"
  },
  {
    "function_name": "fh_fsid_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "199-206",
    "snippet": "static inline bool fh_fsid_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_fsid_type != fh2->fh_fsid_type)\n\t\treturn false;\n\tif (memcmp(fh1->fh_fsid, fh2->fh_fsid, key_len(fh1->fh_fsid_type)) != 0)\n\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "fh1->fh_fsid",
            "fh2->fh_fsid",
            "key_len(fh1->fh_fsid_type)"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_len",
          "args": [
            "fh1->fh_fsid_type"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "key_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
          "lines": "138-151",
          "snippet": "static inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline bool fh_fsid_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_fsid_type != fh2->fh_fsid_type)\n\t\treturn false;\n\tif (memcmp(fh1->fh_fsid, fh2->fh_fsid, key_len(fh1->fh_fsid_type)) != 0)\n\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "fh_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "190-197",
    "snippet": "static inline bool fh_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_size != fh2->fh_size)\n\t\treturn false;\n\tif (memcmp(fh1->fh_base.fh_pad, fh2->fh_base.fh_pad, fh1->fh_size) != 0)\n\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "fh1->fh_base.fh_pad",
            "fh2->fh_base.fh_pad",
            "fh1->fh_size"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline bool fh_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_size != fh2->fh_size)\n\t\treturn false;\n\tif (memcmp(fh1->fh_base.fh_pad, fh2->fh_base.fh_pad, fh1->fh_size) != 0)\n\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "fh_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "182-188",
    "snippet": "static __inline__ struct svc_fh *\nfh_init(struct svc_fh *fhp, int maxsize)\n{\n\tmemset(fhp, 0, sizeof(*fhp));\n\tfhp->fh_maxsize = maxsize;\n\treturn fhp;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "fhp",
            "0",
            "sizeof(*fhp)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic __inline__ struct svc_fh *\nfh_init(struct svc_fh *fhp, int maxsize)\n{\n\tmemset(fhp, 0, sizeof(*fhp));\n\tfhp->fh_maxsize = maxsize;\n\treturn fhp;\n}"
  },
  {
    "function_name": "fh_copy_shallow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "175-180",
    "snippet": "static inline void\nfh_copy_shallow(struct knfsd_fh *dst, struct knfsd_fh *src)\n{\n\tdst->fh_size = src->fh_size;\n\tmemcpy(&dst->fh_base, &src->fh_base, src->fh_size);\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&dst->fh_base",
            "&src->fh_base",
            "src->fh_size"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void\nfh_copy_shallow(struct knfsd_fh *dst, struct knfsd_fh *src)\n{\n\tdst->fh_size = src->fh_size;\n\tmemcpy(&dst->fh_base, &src->fh_base, src->fh_size);\n}"
  },
  {
    "function_name": "fh_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "166-173",
    "snippet": "static __inline__ struct svc_fh *\nfh_copy(struct svc_fh *dst, struct svc_fh *src)\n{\n\tWARN_ON(src->fh_dentry || src->fh_locked);\n\t\t\t\n\t*dst = *src;\n\treturn dst;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "src->fh_dentry || src->fh_locked"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic __inline__ struct svc_fh *\nfh_copy(struct svc_fh *dst, struct svc_fh *src)\n{\n\tWARN_ON(src->fh_dentry || src->fh_locked);\n\t\t\t\n\t*dst = *src;\n\treturn dst;\n}"
  },
  {
    "function_name": "key_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "138-151",
    "snippet": "static inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}"
  },
  {
    "function_name": "mk_fsid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "86-136",
    "snippet": "static inline void mk_fsid(int vers, u32 *fsidv, dev_t dev, ino_t ino,\n\t\t\t   u32 fsid, unsigned char *uuid)\n{\n\tu32 *up;\n\tswitch(vers) {\n\tcase FSID_DEV:\n\t\tfsidv[0] = (__force __u32)htonl((MAJOR(dev)<<16) |\n\t\t\t\t MINOR(dev));\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\tcase FSID_NUM:\n\t\tfsidv[0] = fsid;\n\t\tbreak;\n\tcase FSID_MAJOR_MINOR:\n\t\tfsidv[0] = (__force __u32)htonl(MAJOR(dev));\n\t\tfsidv[1] = (__force __u32)htonl(MINOR(dev));\n\t\tfsidv[2] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_ENCODE_DEV:\n\t\tfsidv[0] = new_encode_dev(dev);\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_UUID4_INUM:\n\t\t/* 4 byte fsid and inode number */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = ino_t_to_u32(ino);\n\t\tfsidv[1] = up[0] ^ up[1] ^ up[2] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID8:\n\t\t/* 8 byte fsid  */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = up[0] ^ up[2];\n\t\tfsidv[1] = up[1] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID16:\n\t\t/* 16 byte fsid - NFSv3+ only */\n\t\tmemcpy(fsidv, uuid, 16);\n\t\tbreak;\n\n\tcase FSID_UUID16_INUM:\n\t\t/* 8 byte inode and 16 byte fsid */\n\t\t*(u64*)fsidv = (u64)ino;\n\t\tmemcpy(fsidv+2, uuid, 16);\n\t\tbreak;\n\tdefault: BUG();\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fsidv+2",
            "uuid",
            "16"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fsidv",
            "uuid",
            "16"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ino_t_to_u32",
          "args": [
            "ino"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "ino_t_to_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
          "lines": "13-16",
          "snippet": "static inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_encode_dev",
          "args": [
            "dev"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "MINOR(dev)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "dev"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "MAJOR(dev)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "(MAJOR(dev)<<16) |\n\t\t\t\t MINOR(dev)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "dev"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline void mk_fsid(int vers, u32 *fsidv, dev_t dev, ino_t ino,\n\t\t\t   u32 fsid, unsigned char *uuid)\n{\n\tu32 *up;\n\tswitch(vers) {\n\tcase FSID_DEV:\n\t\tfsidv[0] = (__force __u32)htonl((MAJOR(dev)<<16) |\n\t\t\t\t MINOR(dev));\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\tcase FSID_NUM:\n\t\tfsidv[0] = fsid;\n\t\tbreak;\n\tcase FSID_MAJOR_MINOR:\n\t\tfsidv[0] = (__force __u32)htonl(MAJOR(dev));\n\t\tfsidv[1] = (__force __u32)htonl(MINOR(dev));\n\t\tfsidv[2] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_ENCODE_DEV:\n\t\tfsidv[0] = new_encode_dev(dev);\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_UUID4_INUM:\n\t\t/* 4 byte fsid and inode number */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = ino_t_to_u32(ino);\n\t\tfsidv[1] = up[0] ^ up[1] ^ up[2] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID8:\n\t\t/* 8 byte fsid  */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = up[0] ^ up[2];\n\t\tfsidv[1] = up[1] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID16:\n\t\t/* 16 byte fsid - NFSv3+ only */\n\t\tmemcpy(fsidv, uuid, 16);\n\t\tbreak;\n\n\tcase FSID_UUID16_INUM:\n\t\t/* 8 byte inode and 16 byte fsid */\n\t\t*(u64*)fsidv = (u64)ino;\n\t\tmemcpy(fsidv+2, uuid, 16);\n\t\tbreak;\n\tdefault: BUG();\n\t}\n}"
  },
  {
    "function_name": "u32_to_ino_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "18-21",
    "snippet": "static inline ino_t u32_to_ino_t(__u32 uino)\n{\n\treturn (ino_t) uino;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline ino_t u32_to_ino_t(__u32 uino)\n{\n\treturn (ino_t) uino;\n}"
  },
  {
    "function_name": "ino_t_to_u32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsfh.h",
    "lines": "13-16",
    "snippet": "static inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n\nstatic inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}"
  }
]