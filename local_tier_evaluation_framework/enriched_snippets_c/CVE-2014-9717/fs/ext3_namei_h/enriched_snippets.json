[
  {
    "function_name": "ext3_dir_bread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/namei.h",
    "lines": "10-27",
    "snippet": "static inline struct buffer_head *ext3_dir_bread(handle_t *handle,\n\t\t\t\t\t\t struct inode *inode,\n\t\t\t\t\t\t int block, int create,\n\t\t\t\t\t\t int *err)\n{\n\tstruct buffer_head *bh;\n\n\tbh = ext3_bread(handle, inode, block, create, err);\n\n\tif (!bh && !(*err)) {\n\t\t*err = -EIO;\n\t\text3_error(inode->i_sb, __func__,\n\t\t\t   \"Directory hole detected on inode %lu\\n\",\n\t\t\t   inode->i_ino);\n\t\treturn NULL;\n\t}\n\treturn bh;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ext3_error",
          "args": [
            "inode->i_sb",
            "__func__",
            "\"Directory hole detected on inode %lu\\n\"",
            "inode->i_ino"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "ext3_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/super.c",
          "lines": "191-208",
          "snippet": "void ext3_error(struct super_block *sb, const char *function,\n\t\tconst char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(KERN_CRIT \"EXT3-fs error (device %s): %s: %pV\\n\",\n\t       sb->s_id, function, &vaf);\n\n\tva_end(args);\n\n\text3_handle_error(sb);\n}",
          "includes": [
            "#include \"namei.h\"",
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"ext3.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/namei.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/mount.h>",
            "#include <linux/random.h>",
            "#include <linux/statfs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/parser.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int ext3_unfreeze(struct super_block *sb);",
            "static int ext3_freeze(struct super_block *sb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"namei.h\"\n#include \"acl.h\"\n#include \"xattr.h\"\n#include \"ext3.h\"\n#include <asm/uaccess.h>\n#include <linux/namei.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/seq_file.h>\n#include <linux/quotaops.h>\n#include <linux/mount.h>\n#include <linux/random.h>\n#include <linux/statfs.h>\n#include <linux/exportfs.h>\n#include <linux/parser.h>\n#include <linux/blkdev.h>\n#include <linux/module.h>\n\nstatic int ext3_unfreeze(struct super_block *sb);\nstatic int ext3_freeze(struct super_block *sb);\n\nvoid ext3_error(struct super_block *sb, const char *function,\n\t\tconst char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(KERN_CRIT \"EXT3-fs error (device %s): %s: %pV\\n\",\n\t       sb->s_id, function, &vaf);\n\n\tva_end(args);\n\n\text3_handle_error(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ext3_bread",
          "args": [
            "handle",
            "inode",
            "block",
            "create",
            "err"
          ],
          "line": 17
        },
        "resolved": true,
        "details": {
          "function_name": "ext3_bread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/inode.c",
          "lines": "1128-1147",
          "snippet": "struct buffer_head *ext3_bread(handle_t *handle, struct inode *inode,\n\t\t\t       int block, int create, int *err)\n{\n\tstruct buffer_head * bh;\n\n\tbh = ext3_getblk(handle, inode, block, create, err);\n\tif (!bh)\n\t\treturn bh;\n\tif (bh_uptodate_or_lock(bh))\n\t\treturn bh;\n\tget_bh(bh);\n\tbh->b_end_io = end_buffer_read_sync;\n\tsubmit_bh(READ | REQ_META | REQ_PRIO, bh);\n\twait_on_buffer(bh);\n\tif (buffer_uptodate(bh))\n\t\treturn bh;\n\tput_bh(bh);\n\t*err = -EIO;\n\treturn NULL;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"ext3.h\"",
            "#include <linux/aio.h>",
            "#include <linux/namei.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highuid.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int ext3_writepage_trans_blocks(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include \"ext3.h\"\n#include <linux/aio.h>\n#include <linux/namei.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/quotaops.h>\n#include <linux/highuid.h>\n\nstatic int ext3_writepage_trans_blocks(struct inode *inode);\n\nstruct buffer_head *ext3_bread(handle_t *handle, struct inode *inode,\n\t\t\t       int block, int create, int *err)\n{\n\tstruct buffer_head * bh;\n\n\tbh = ext3_getblk(handle, inode, block, create, err);\n\tif (!bh)\n\t\treturn bh;\n\tif (bh_uptodate_or_lock(bh))\n\t\treturn bh;\n\tget_bh(bh);\n\tbh->b_end_io = end_buffer_read_sync;\n\tsubmit_bh(READ | REQ_META | REQ_PRIO, bh);\n\twait_on_buffer(bh);\n\tif (buffer_uptodate(bh))\n\t\treturn bh;\n\tput_bh(bh);\n\t*err = -EIO;\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline struct buffer_head *ext3_dir_bread(handle_t *handle,\n\t\t\t\t\t\t struct inode *inode,\n\t\t\t\t\t\t int block, int create,\n\t\t\t\t\t\t int *err)\n{\n\tstruct buffer_head *bh;\n\n\tbh = ext3_bread(handle, inode, block, create, err);\n\n\tif (!bh && !(*err)) {\n\t\t*err = -EIO;\n\t\text3_error(inode->i_sb, __func__,\n\t\t\t   \"Directory hole detected on inode %lu\\n\",\n\t\t\t   inode->i_ino);\n\t\treturn NULL;\n\t}\n\treturn bh;\n}"
  }
]