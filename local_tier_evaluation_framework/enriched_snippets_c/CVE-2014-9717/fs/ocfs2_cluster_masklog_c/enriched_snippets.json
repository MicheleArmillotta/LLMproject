[
  {
    "function_name": "mlog_sys_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
    "lines": "152-155",
    "snippet": "void mlog_sys_shutdown(void)\n{\n\tkset_unregister(&mlog_kset);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/string.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset mlog_kset = {\n\t.kobj   = {.ktype = &mlog_ktype},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "&mlog_kset"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct kset mlog_kset = {\n\t.kobj   = {.ktype = &mlog_ktype},\n};\n\nvoid mlog_sys_shutdown(void)\n{\n\tkset_unregister(&mlog_kset);\n}"
  },
  {
    "function_name": "mlog_sys_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
    "lines": "137-150",
    "snippet": "int mlog_sys_init(struct kset *o2cb_kset)\n{\n\tint i = 0;\n\n\twhile (mlog_attrs[i].attr.mode) {\n\t\tmlog_attr_ptrs[i] = &mlog_attrs[i].attr;\n\t\ti++;\n\t}\n\tmlog_attr_ptrs[i] = NULL;\n\n\tkobject_set_name(&mlog_kset.kobj, \"logmask\");\n\tmlog_kset.kobj.kset = o2cb_kset;\n\treturn kset_register(&mlog_kset);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/string.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct mlog_attribute mlog_attrs[MLOG_MAX_BITS] = {\n\tdefine_mask(TCP),\n\tdefine_mask(MSG),\n\tdefine_mask(SOCKET),\n\tdefine_mask(HEARTBEAT),\n\tdefine_mask(HB_BIO),\n\tdefine_mask(DLMFS),\n\tdefine_mask(DLM),\n\tdefine_mask(DLM_DOMAIN),\n\tdefine_mask(DLM_THREAD),\n\tdefine_mask(DLM_MASTER),\n\tdefine_mask(DLM_RECOVERY),\n\tdefine_mask(DLM_GLUE),\n\tdefine_mask(VOTE),\n\tdefine_mask(CONN),\n\tdefine_mask(QUORUM),\n\tdefine_mask(BASTS),\n\tdefine_mask(CLUSTER),\n\tdefine_mask(ERROR),\n\tdefine_mask(NOTICE),\n\tdefine_mask(KTHREAD),\n};",
      "static struct attribute *mlog_attr_ptrs[MLOG_MAX_BITS] = {NULL, };",
      "static struct kset mlog_kset = {\n\t.kobj   = {.ktype = &mlog_ktype},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_register",
          "args": [
            "&mlog_kset"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_set_name",
          "args": [
            "&mlog_kset.kobj",
            "\"logmask\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct mlog_attribute mlog_attrs[MLOG_MAX_BITS] = {\n\tdefine_mask(TCP),\n\tdefine_mask(MSG),\n\tdefine_mask(SOCKET),\n\tdefine_mask(HEARTBEAT),\n\tdefine_mask(HB_BIO),\n\tdefine_mask(DLMFS),\n\tdefine_mask(DLM),\n\tdefine_mask(DLM_DOMAIN),\n\tdefine_mask(DLM_THREAD),\n\tdefine_mask(DLM_MASTER),\n\tdefine_mask(DLM_RECOVERY),\n\tdefine_mask(DLM_GLUE),\n\tdefine_mask(VOTE),\n\tdefine_mask(CONN),\n\tdefine_mask(QUORUM),\n\tdefine_mask(BASTS),\n\tdefine_mask(CLUSTER),\n\tdefine_mask(ERROR),\n\tdefine_mask(NOTICE),\n\tdefine_mask(KTHREAD),\n};\nstatic struct attribute *mlog_attr_ptrs[MLOG_MAX_BITS] = {NULL, };\nstatic struct kset mlog_kset = {\n\t.kobj   = {.ktype = &mlog_ktype},\n};\n\nint mlog_sys_init(struct kset *o2cb_kset)\n{\n\tint i = 0;\n\n\twhile (mlog_attrs[i].attr.mode) {\n\t\tmlog_attr_ptrs[i] = &mlog_attrs[i].attr;\n\t\ti++;\n\t}\n\tmlog_attr_ptrs[i] = NULL;\n\n\tkobject_set_name(&mlog_kset.kobj, \"logmask\");\n\tmlog_kset.kobj.kset = o2cb_kset;\n\treturn kset_register(&mlog_kset);\n}"
  },
  {
    "function_name": "mlog_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
    "lines": "115-121",
    "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/string.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog_mask_store",
          "args": [
            "mlog_attr->mask",
            "buf",
            "count"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_mask_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "50-65",
          "snippet": "static ssize_t mlog_mask_store(u64 mask, const char *buf, size_t count)\n{\n\tif (!strncasecmp(buf, \"allow\", 5)) {\n\t\t__mlog_set_u64(mask, mlog_and_bits);\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t} else if (!strncasecmp(buf, \"deny\", 4)) {\n\t\t__mlog_set_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else if (!strncasecmp(buf, \"off\", 3)) {\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else\n\t\treturn -EINVAL;\n\n\treturn count;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
            "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_store(u64 mask, const char *buf, size_t count)\n{\n\tif (!strncasecmp(buf, \"allow\", 5)) {\n\t\t__mlog_set_u64(mask, mlog_and_bits);\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t} else if (!strncasecmp(buf, \"deny\", 4)) {\n\t\t__mlog_set_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else if (!strncasecmp(buf, \"off\", 3)) {\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else\n\t\treturn -EINVAL;\n\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_mlog_attr",
          "args": [
            "attr"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
  },
  {
    "function_name": "mlog_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
    "lines": "107-113",
    "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/string.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog_mask_show",
          "args": [
            "mlog_attr->mask",
            "buf"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_mask_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "36-48",
          "snippet": "static ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
            "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_mlog_attr",
          "args": [
            "attr"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
  },
  {
    "function_name": "mlog_mask_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
    "lines": "50-65",
    "snippet": "static ssize_t mlog_mask_store(u64 mask, const char *buf, size_t count)\n{\n\tif (!strncasecmp(buf, \"allow\", 5)) {\n\t\t__mlog_set_u64(mask, mlog_and_bits);\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t} else if (!strncasecmp(buf, \"deny\", 4)) {\n\t\t__mlog_set_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else if (!strncasecmp(buf, \"off\", 3)) {\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else\n\t\treturn -EINVAL;\n\n\treturn count;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/string.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
      "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mlog_clear_u64",
          "args": [
            "mask",
            "mlog_and_bits"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mlog_clear_u64",
          "args": [
            "mask",
            "mlog_not_bits"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "buf",
            "\"off\"",
            "3"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mlog_clear_u64",
          "args": [
            "mask",
            "mlog_and_bits"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mlog_set_u64",
          "args": [
            "mask",
            "mlog_not_bits"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "buf",
            "\"deny\"",
            "4"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mlog_clear_u64",
          "args": [
            "mask",
            "mlog_not_bits"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mlog_set_u64",
          "args": [
            "mask",
            "mlog_and_bits"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "buf",
            "\"allow\"",
            "5"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_store(u64 mask, const char *buf, size_t count)\n{\n\tif (!strncasecmp(buf, \"allow\", 5)) {\n\t\t__mlog_set_u64(mask, mlog_and_bits);\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t} else if (!strncasecmp(buf, \"deny\", 4)) {\n\t\t__mlog_set_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else if (!strncasecmp(buf, \"off\", 3)) {\n\t\t__mlog_clear_u64(mask, mlog_not_bits);\n\t\t__mlog_clear_u64(mask, mlog_and_bits);\n\t} else\n\t\treturn -EINVAL;\n\n\treturn count;\n}"
  },
  {
    "function_name": "mlog_mask_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
    "lines": "36-48",
    "snippet": "static ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/string.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
      "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%s\\n\"",
            "state"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mlog_test_u64",
          "args": [
            "mask",
            "mlog_not_bits"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mlog_test_u64",
          "args": [
            "mask",
            "mlog_and_bits"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}"
  }
]