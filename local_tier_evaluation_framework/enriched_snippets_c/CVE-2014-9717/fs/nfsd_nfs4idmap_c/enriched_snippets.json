[
  {
    "function_name": "nfsd4_encode_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "661-666",
    "snippet": "__be32 nfsd4_encode_group(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t  kgid_t gid)\n{\n\tu32 id = from_kgid(&init_user_ns, gid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_GROUP, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_name_from_id",
          "args": [
            "xdr",
            "rqstp",
            "IDMAP_TYPE_GROUP",
            "id"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "encode_name_from_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "620-626",
          "snippet": "static __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kgid",
          "args": [
            "&init_user_ns",
            "gid"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n\n__be32 nfsd4_encode_group(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t  kgid_t gid)\n{\n\tu32 id = from_kgid(&init_user_ns, gid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_GROUP, id);\n}"
  },
  {
    "function_name": "nfsd4_encode_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "654-659",
    "snippet": "__be32 nfsd4_encode_user(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t kuid_t uid)\n{\n\tu32 id = from_kuid(&init_user_ns, uid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_USER, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_USER  0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_name_from_id",
          "args": [
            "xdr",
            "rqstp",
            "IDMAP_TYPE_USER",
            "id"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "encode_name_from_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "620-626",
          "snippet": "static __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kuid",
          "args": [
            "&init_user_ns",
            "uid"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_USER  0\n\n__be32 nfsd4_encode_user(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t kuid_t uid)\n{\n\tu32 id = from_kuid(&init_user_ns, uid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_USER, id);\n}"
  },
  {
    "function_name": "nfsd_map_name_to_gid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "641-652",
    "snippet": "__be32\nnfsd_map_name_to_gid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkgid_t *gid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_GROUP, name, namelen, &id);\n\t*gid = make_kgid(&init_user_ns, id);\n\tif (!gid_valid(*gid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "*gid"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "&init_user_ns",
            "id"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_name_to_id",
          "args": [
            "rqstp",
            "IDMAP_TYPE_GROUP",
            "name",
            "namelen",
            "&id"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "do_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "607-618",
          "snippet": "static __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n\n__be32\nnfsd_map_name_to_gid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkgid_t *gid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_GROUP, name, namelen, &id);\n\t*gid = make_kgid(&init_user_ns, id);\n\tif (!gid_valid(*gid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}"
  },
  {
    "function_name": "nfsd_map_name_to_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "628-639",
    "snippet": "__be32\nnfsd_map_name_to_uid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkuid_t *uid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_USER, name, namelen, &id);\n\t*uid = make_kuid(&init_user_ns, id);\n\tif (!uid_valid(*uid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_USER  0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "*uid"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "&init_user_ns",
            "id"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_name_to_id",
          "args": [
            "rqstp",
            "IDMAP_TYPE_USER",
            "name",
            "namelen",
            "&id"
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "do_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "607-618",
          "snippet": "static __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_USER  0\n\n__be32\nnfsd_map_name_to_uid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkuid_t *uid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_USER, name, namelen, &id);\n\t*uid = make_kuid(&init_user_ns, id);\n\tif (!uid_valid(*uid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}"
  },
  {
    "function_name": "encode_name_from_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "620-626",
    "snippet": "static __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool nfs4_disable_idmapping = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "idmap_id_to_name",
          "args": [
            "xdr",
            "rqstp",
            "type",
            "id"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_id_to_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "564-589",
          "snippet": "static __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_ascii_id",
          "args": [
            "xdr",
            "id"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "encode_ascii_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "550-562",
          "snippet": "static __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}"
  },
  {
    "function_name": "do_name_to_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "607-618",
    "snippet": "static __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool nfs4_disable_idmapping = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "idmap_name_to_id",
          "args": [
            "rqstp",
            "type",
            "name",
            "namelen",
            "id"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "525-548",
          "snippet": "static __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "numeric_name_to_id",
          "args": [
            "rqstp",
            "type",
            "name",
            "namelen",
            "id"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "numeric_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "591-605",
          "snippet": "static bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}"
  },
  {
    "function_name": "numeric_name_to_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "591-605",
    "snippet": "static bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtouint",
          "args": [
            "buf",
            "10",
            "id"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "name",
            "namelen"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}"
  },
  {
    "function_name": "idmap_id_to_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "564-589",
    "snippet": "static __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&item->h",
            "nn->idtoname_cache"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "item->name",
            "ret"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "ret + 4"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "ret > IDMAP_NAMESZ"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "item->name"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfserrno",
          "args": [
            "ret"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "nfserrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsproc.c",
          "lines": "708-758",
          "snippet": "__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}",
          "includes": [
            "#include \"vfs.h\"",
            "#include \"xdr.h\"",
            "#include \"cache.h\"",
            "#include <linux/namei.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vfs.h\"\n#include \"xdr.h\"\n#include \"cache.h\"\n#include <linux/namei.h>\n\n__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_ascii_id",
          "args": [
            "xdr",
            "id"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "encode_ascii_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "550-562",
          "snippet": "static __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "idmap_lookup",
          "args": [
            "rqstp",
            "idtoname_lookup",
            "&key",
            "nn->idtoname_cache",
            "&item"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "493-514",
          "snippet": "static int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "key.authname",
            "rqst_authname(rqstp)",
            "sizeof(key.authname)"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rqst_authname",
          "args": [
            "rqstp"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "rqst_authname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "516-523",
          "snippet": "static char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "SVC_NET(rqstp)",
            "nfsd_net_id"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SVC_NET",
          "args": [
            "rqstp"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}"
  },
  {
    "function_name": "encode_ascii_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "550-562",
    "snippet": "static __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "buf",
            "len"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "len + 4"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\"",
            "id"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}"
  },
  {
    "function_name": "idmap_name_to_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "525-548",
    "snippet": "static __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&item->h",
            "nn->nametoid_cache"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfserrno",
          "args": [
            "ret"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "nfserrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfsproc.c",
          "lines": "708-758",
          "snippet": "__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}",
          "includes": [
            "#include \"vfs.h\"",
            "#include \"xdr.h\"",
            "#include \"cache.h\"",
            "#include <linux/namei.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vfs.h\"\n#include \"xdr.h\"\n#include \"cache.h\"\n#include <linux/namei.h>\n\n__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}"
        }
      },
      {
        "call_info": {
          "callee": "idmap_lookup",
          "args": [
            "rqstp",
            "nametoid_lookup",
            "&key",
            "nn->nametoid_cache",
            "&item"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "493-514",
          "snippet": "static int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "key.authname",
            "rqst_authname(rqstp)",
            "sizeof(key.authname)"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rqst_authname",
          "args": [
            "rqstp"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "rqst_authname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "516-523",
          "snippet": "static char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "key.name",
            "name",
            "namelen"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "SVC_NET(rqstp)",
            "nfsd_net_id"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SVC_NET",
          "args": [
            "rqstp"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}"
  },
  {
    "function_name": "rqst_authname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "516-523",
    "snippet": "static char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}"
  },
  {
    "function_name": "idmap_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "493-514",
    "snippet": "static int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&(*item)->h",
            "detail"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lookup_fn",
          "args": [
            "detail",
            "key"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_check",
          "args": [
            "detail",
            "&(*item)->h",
            "&rqstp->rq_chandle"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "afs_vnode_cache_check_aux",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/afs/cache.c",
          "lines": "314-361",
          "snippet": "static enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen)\n{\n\tstruct afs_vnode *vnode = cookie_netfs_data;\n\tuint16_t dlen;\n\n\t_enter(\"{%x,%x,%llx},%p,%u\",\n\t       vnode->fid.vnode, vnode->fid.unique, vnode->status.data_version,\n\t       buffer, buflen);\n\n\t/* check the size of the data is what we're expecting */\n\tdlen = sizeof(vnode->fid.unique) + sizeof(vnode->status.data_version);\n\tif (dlen != buflen) {\n\t\t_leave(\" = OBSOLETE [len %hx != %hx]\", dlen, buflen);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer,\n\t\t   &vnode->fid.unique,\n\t\t   sizeof(vnode->fid.unique)\n\t\t   ) != 0) {\n\t\tunsigned unique;\n\n\t\tmemcpy(&unique, buffer, sizeof(unique));\n\n\t\t_leave(\" = OBSOLETE [uniq %x != %x]\",\n\t\t       unique, vnode->fid.unique);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer + sizeof(vnode->fid.unique),\n\t\t   &vnode->status.data_version,\n\t\t   sizeof(vnode->status.data_version)\n\t\t   ) != 0) {\n\t\tafs_dataversion_t version;\n\n\t\tmemcpy(&version, buffer + sizeof(vnode->fid.unique),\n\t\t       sizeof(version));\n\n\t\t_leave(\" = OBSOLETE [vers %llx != %llx]\",\n\t\t       version, vnode->status.data_version);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\t_leave(\" = SUCCESS\");\n\treturn FSCACHE_CHECKAUX_OKAY;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static uint16_t afs_cell_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);",
            "static uint16_t afs_cell_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);",
            "static enum fscache_checkaux afs_cell_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t      const void *buffer,\n\t\t\t\t\t\t      uint16_t buflen);",
            "static uint16_t afs_vlocation_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);",
            "static uint16_t afs_vlocation_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);",
            "static enum fscache_checkaux afs_vlocation_cache_check_aux(\n\tvoid *cookie_netfs_data, const void *buffer, uint16_t buflen);",
            "static uint16_t afs_volume_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t void *buffer, uint16_t buflen);",
            "static uint16_t afs_vnode_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);",
            "static void afs_vnode_cache_get_attr(const void *cookie_netfs_data,\n\t\t\t\t     uint64_t *size);",
            "static uint16_t afs_vnode_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);",
            "static enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen);",
            "static void afs_vnode_cache_now_uncached(void *cookie_netfs_data);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/sched.h>\n\nstatic uint16_t afs_cell_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);\nstatic uint16_t afs_cell_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);\nstatic enum fscache_checkaux afs_cell_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t      const void *buffer,\n\t\t\t\t\t\t      uint16_t buflen);\nstatic uint16_t afs_vlocation_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);\nstatic uint16_t afs_vlocation_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);\nstatic enum fscache_checkaux afs_vlocation_cache_check_aux(\n\tvoid *cookie_netfs_data, const void *buffer, uint16_t buflen);\nstatic uint16_t afs_volume_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t void *buffer, uint16_t buflen);\nstatic uint16_t afs_vnode_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);\nstatic void afs_vnode_cache_get_attr(const void *cookie_netfs_data,\n\t\t\t\t     uint64_t *size);\nstatic uint16_t afs_vnode_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);\nstatic enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen);\nstatic void afs_vnode_cache_now_uncached(void *cookie_netfs_data);\n\nstatic enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen)\n{\n\tstruct afs_vnode *vnode = cookie_netfs_data;\n\tuint16_t dlen;\n\n\t_enter(\"{%x,%x,%llx},%p,%u\",\n\t       vnode->fid.vnode, vnode->fid.unique, vnode->status.data_version,\n\t       buffer, buflen);\n\n\t/* check the size of the data is what we're expecting */\n\tdlen = sizeof(vnode->fid.unique) + sizeof(vnode->status.data_version);\n\tif (dlen != buflen) {\n\t\t_leave(\" = OBSOLETE [len %hx != %hx]\", dlen, buflen);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer,\n\t\t   &vnode->fid.unique,\n\t\t   sizeof(vnode->fid.unique)\n\t\t   ) != 0) {\n\t\tunsigned unique;\n\n\t\tmemcpy(&unique, buffer, sizeof(unique));\n\n\t\t_leave(\" = OBSOLETE [uniq %x != %x]\",\n\t\t       unique, vnode->fid.unique);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer + sizeof(vnode->fid.unique),\n\t\t   &vnode->status.data_version,\n\t\t   sizeof(vnode->status.data_version)\n\t\t   ) != 0) {\n\t\tafs_dataversion_t version;\n\n\t\tmemcpy(&version, buffer + sizeof(vnode->fid.unique),\n\t\t       sizeof(version));\n\n\t\t_leave(\" = OBSOLETE [vers %llx != %llx]\",\n\t\t       version, vnode->status.data_version);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\t_leave(\" = SUCCESS\");\n\treturn FSCACHE_CHECKAUX_OKAY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lookup_fn",
          "args": [
            "detail",
            "key"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nfsd_idmap_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "482-491",
    "snippet": "void\nnfsd_idmap_shutdown(struct net *net)\n{\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tcache_unregister_net(nn->idtoname_cache, net);\n\tcache_unregister_net(nn->nametoid_cache, net);\n\tcache_destroy_net(nn->idtoname_cache, net);\n\tcache_destroy_net(nn->nametoid_cache, net);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_unregister_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_unregister_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "148-158",
          "snippet": "void nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfsd_net_id"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nvoid\nnfsd_idmap_shutdown(struct net *net)\n{\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tcache_unregister_net(nn->idtoname_cache, net);\n\tcache_unregister_net(nn->nametoid_cache, net);\n\tcache_destroy_net(nn->idtoname_cache, net);\n\tcache_destroy_net(nn->nametoid_cache, net);\n}"
  },
  {
    "function_name": "nfsd_idmap_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "451-480",
    "snippet": "int\nnfsd_idmap_init(struct net *net)\n{\n\tint rv;\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tnn->idtoname_cache = cache_create_net(&idtoname_cache_template, net);\n\tif (IS_ERR(nn->idtoname_cache))\n\t\treturn PTR_ERR(nn->idtoname_cache);\n\trv = cache_register_net(nn->idtoname_cache, net);\n\tif (rv)\n\t\tgoto destroy_idtoname_cache;\n\tnn->nametoid_cache = cache_create_net(&nametoid_cache_template, net);\n\tif (IS_ERR(nn->nametoid_cache)) {\n\t\trv = PTR_ERR(nn->nametoid_cache);\n\t\tgoto unregister_idtoname_cache;\n\t}\n\trv = cache_register_net(nn->nametoid_cache, net);\n\tif (rv)\n\t\tgoto destroy_nametoid_cache;\n\treturn 0;\n\ndestroy_nametoid_cache:\n\tcache_destroy_net(nn->nametoid_cache, net);\nunregister_idtoname_cache:\n\tcache_unregister_net(nn->idtoname_cache, net);\ndestroy_idtoname_cache:\n\tcache_destroy_net(nn->idtoname_cache, net);\n\treturn rv;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct cache_detail idtoname_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.idtoname\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= idtoname_request,\n\t.cache_parse\t= idtoname_parse,\n\t.cache_show\t= idtoname_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= idtoname_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};",
      "static struct cache_detail nametoid_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.nametoid\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= nametoid_request,\n\t.cache_parse\t= nametoid_parse,\n\t.cache_show\t= nametoid_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= nametoid_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_unregister_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_unregister_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "148-158",
          "snippet": "void nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_register_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_register_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "126-140",
          "snippet": "int nfs_cache_register_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\tint ret = 0;\n\n\tsunrpc_init_cache_detail(cd);\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tret = nfs_cache_register_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t\tif (ret)\n\t\t\tsunrpc_destroy_cache_detail(cd);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nint nfs_cache_register_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\tint ret = 0;\n\n\tsunrpc_init_cache_detail(cd);\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tret = nfs_cache_register_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t\tif (ret)\n\t\t\tsunrpc_destroy_cache_detail(cd);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "nn->nametoid_cache"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nn->nametoid_cache"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_create_net",
          "args": [
            "&nametoid_cache_template",
            "net"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "nn->idtoname_cache"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nn->idtoname_cache"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_create_net",
          "args": [
            "&idtoname_cache_template",
            "net"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfsd_net_id"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct cache_detail idtoname_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.idtoname\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= idtoname_request,\n\t.cache_parse\t= idtoname_parse,\n\t.cache_show\t= idtoname_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= idtoname_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};\nstatic struct cache_detail nametoid_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.nametoid\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= nametoid_request,\n\t.cache_parse\t= nametoid_parse,\n\t.cache_show\t= nametoid_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= nametoid_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};\n\nint\nnfsd_idmap_init(struct net *net)\n{\n\tint rv;\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tnn->idtoname_cache = cache_create_net(&idtoname_cache_template, net);\n\tif (IS_ERR(nn->idtoname_cache))\n\t\treturn PTR_ERR(nn->idtoname_cache);\n\trv = cache_register_net(nn->idtoname_cache, net);\n\tif (rv)\n\t\tgoto destroy_idtoname_cache;\n\tnn->nametoid_cache = cache_create_net(&nametoid_cache_template, net);\n\tif (IS_ERR(nn->nametoid_cache)) {\n\t\trv = PTR_ERR(nn->nametoid_cache);\n\t\tgoto unregister_idtoname_cache;\n\t}\n\trv = cache_register_net(nn->nametoid_cache, net);\n\tif (rv)\n\t\tgoto destroy_nametoid_cache;\n\treturn 0;\n\ndestroy_nametoid_cache:\n\tcache_destroy_net(nn->nametoid_cache, net);\nunregister_idtoname_cache:\n\tcache_unregister_net(nn->idtoname_cache, net);\ndestroy_idtoname_cache:\n\tcache_destroy_net(nn->idtoname_cache, net);\n\treturn rv;\n}"
  },
  {
    "function_name": "nametoid_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "436-445",
    "snippet": "static struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_update",
          "args": [
            "cd",
            "&new->h",
            "&old->h",
            "nametoid_hash(new)"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nametoid_hash",
          "args": [
            "new"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "294-298",
          "snippet": "static inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "nametoid_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "425-434",
    "snippet": "static struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_lookup",
          "args": [
            "cd",
            "&item->h",
            "nametoid_hash(item)"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nametoid_hash",
          "args": [
            "item"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "294-298",
          "snippet": "static inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "nametoid_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "362-422",
    "snippet": "static int\nnametoid_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1;\n\tint len, error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* Name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\t/* ID */\n\terror = get_int(&buf, &ent.id);\n\tif (error == -EINVAL)\n\t\tgoto out;\n\tif (error == -ENOENT)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\n\terror = -ENOMEM;\n\tres = nametoid_lookup(cd, &ent);\n\tif (res == NULL)\n\t\tgoto out;\n\tres = nametoid_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn (error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1",
      "#define IDMAP_TYPE_USER  0"
    ],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "buf1"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&res->h",
            "cd"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nametoid_update",
          "args": [
            "cd",
            "&ent",
            "res"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "436-445",
          "snippet": "static struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nametoid_lookup",
          "args": [
            "cd",
            "&ent"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "425-434",
          "snippet": "static struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "CACHE_NEGATIVE",
            "&ent.h.flags"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_int",
          "args": [
            "&buf",
            "&ent.id"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_expiry",
          "args": [
            "&buf"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.name",
            "buf1",
            "sizeof(ent.name)"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "buf1",
            "\"user\""
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.authname",
            "buf1",
            "sizeof(ent.authname)"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ent",
            "0",
            "sizeof(ent)"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n#define IDMAP_TYPE_USER  0\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nnametoid_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1;\n\tint len, error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* Name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\t/* ID */\n\terror = get_int(&buf, &ent.id);\n\tif (error == -EINVAL)\n\t\tgoto out;\n\tif (error == -ENOENT)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\n\terror = -ENOMEM;\n\tres = nametoid_lookup(cd, &ent);\n\tif (res == NULL)\n\t\tgoto out;\n\tres = nametoid_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn (error);\n}"
  },
  {
    "function_name": "nametoid_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "323-340",
    "snippet": "static int\nnametoid_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type name [id]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %s\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->name);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %u\", ent->id);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1"
    ],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "CACHE_VALID",
            "&h->flags"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "h",
            "structent",
            "h"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"#domain type name [id]\\n\""
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nnametoid_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type name [id]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %s\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->name);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %u\", ent->id);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}"
  },
  {
    "function_name": "nametoid_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "313-321",
    "snippet": "static int\nnametoid_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->type == b->type && strcmp(a->name, b->name) == 0 &&\n\t    strcmp(a->authname, b->authname) == 0);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "a->authname",
            "b->authname"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cb",
            "structent",
            "h"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ca",
            "structent",
            "h"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic int\nnametoid_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->type == b->type && strcmp(a->name, b->name) == 0 &&\n\t    strcmp(a->authname, b->authname) == 0);\n}"
  },
  {
    "function_name": "nametoid_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "300-311",
    "snippet": "static void\nnametoid_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\n\tqword_add(bpp, blen, ent->authname);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, ent->name);\n\n\t(*bpp)[-1] = '\\n';\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1"
    ],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->name"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\""
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->authname"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic void\nnametoid_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\n\tqword_add(bpp, blen, ent->authname);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, ent->name);\n\n\t(*bpp)[-1] = '\\n';\n}"
  },
  {
    "function_name": "nametoid_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "294-298",
    "snippet": "static inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ENT_HASHBITS          8"
    ],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_str",
          "args": [
            "ent->name",
            "ENT_HASHBITS"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}"
  },
  {
    "function_name": "idtoname_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "278-287",
    "snippet": "static struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_update",
          "args": [
            "cd",
            "&new->h",
            "&old->h",
            "idtoname_hash(new)"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idtoname_hash",
          "args": [
            "new"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "112-125",
          "snippet": "static uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8",
            "#define IDMAP_TYPE_GROUP 1"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n#define IDMAP_TYPE_GROUP 1\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "idtoname_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "267-276",
    "snippet": "static struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_lookup",
          "args": [
            "cd",
            "&item->h",
            "idtoname_hash(item)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idtoname_hash",
          "args": [
            "item"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "112-125",
          "snippet": "static uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8",
            "#define IDMAP_TYPE_GROUP 1"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n#define IDMAP_TYPE_GROUP 1\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "idtoname_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "199-265",
    "snippet": "static int\nidtoname_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1, *bp;\n\tint len;\n\tint error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* ID */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.id = simple_strtoul(buf1, &bp, 10);\n\tif (bp == buf1)\n\t\tgoto out;\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\terror = -ENOMEM;\n\tres = idtoname_lookup(cd, &ent);\n\tif (!res)\n\t\tgoto out;\n\n\t/* Name */\n\terror = -EINVAL;\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len < 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tif (len == 0)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\telse\n\t\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\terror = -ENOMEM;\n\tres = idtoname_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1",
      "#define IDMAP_TYPE_USER  0"
    ],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "buf1"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&res->h",
            "cd"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "idtoname_update",
          "args": [
            "cd",
            "&ent",
            "res"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "278-287",
          "snippet": "static struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.name",
            "buf1",
            "sizeof(ent.name)"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "CACHE_NEGATIVE",
            "&ent.h.flags"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idtoname_lookup",
          "args": [
            "cd",
            "&ent"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
          "lines": "267-276",
          "snippet": "static struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_expiry",
          "args": [
            "&buf"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "buf1",
            "&bp",
            "10"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "buf1",
            "\"user\""
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.authname",
            "buf1",
            "sizeof(ent.authname)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ent",
            "0",
            "sizeof(ent)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n#define IDMAP_TYPE_USER  0\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidtoname_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1, *bp;\n\tint len;\n\tint error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* ID */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.id = simple_strtoul(buf1, &bp, 10);\n\tif (bp == buf1)\n\t\tgoto out;\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\terror = -ENOMEM;\n\tres = idtoname_lookup(cd, &ent);\n\tif (!res)\n\t\tgoto out;\n\n\t/* Name */\n\terror = -EINVAL;\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len < 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tif (len == 0)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\telse\n\t\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\terror = -ENOMEM;\n\tres = idtoname_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn error;\n}"
  },
  {
    "function_name": "warn_no_idmapd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "171-176",
    "snippet": "static void\nwarn_no_idmapd(struct cache_detail *detail, int has_died)\n{\n\tprintk(\"nfsd: nfsv4 idmapping failing: has idmapd %s?\\n\",\n\t\t\thas_died ? \"died\" : \"not been started\");\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"nfsd: nfsv4 idmapping failing: has idmapd %s?\\n\"",
            "has_died ? \"died\" : \"not been started\""
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic void\nwarn_no_idmapd(struct cache_detail *detail, int has_died)\n{\n\tprintk(\"nfsd: nfsv4 idmapping failing: has idmapd %s?\\n\",\n\t\t\thas_died ? \"died\" : \"not been started\");\n}"
  },
  {
    "function_name": "idtoname_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "152-169",
    "snippet": "static int\nidtoname_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type id [name]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %u\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->id);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %s\", ent->name);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1"
    ],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "CACHE_VALID",
            "&h->flags"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "h",
            "structent",
            "h"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"#domain type id [name]\\n\""
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidtoname_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type id [name]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %u\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->id);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %s\", ent->name);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}"
  },
  {
    "function_name": "idtoname_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "142-150",
    "snippet": "static int\nidtoname_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->id == b->id && a->type == b->type &&\n\t    strcmp(a->authname, b->authname) == 0);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "a->authname",
            "b->authname"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cb",
            "structent",
            "h"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ca",
            "structent",
            "h"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic int\nidtoname_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->id == b->id && a->type == b->type &&\n\t    strcmp(a->authname, b->authname) == 0);\n}"
  },
  {
    "function_name": "idtoname_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "127-140",
    "snippet": "static void\nidtoname_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\tchar idstr[11];\n\n\tqword_add(bpp, blen, ent->authname);\n\tsnprintf(idstr, sizeof(idstr), \"%u\", ent->id);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, idstr);\n\n\t(*bpp)[-1] = '\\n';\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define IDMAP_TYPE_GROUP 1"
    ],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "idstr"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\""
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "idstr",
            "sizeof(idstr)",
            "\"%u\"",
            "ent->id"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->authname"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define IDMAP_TYPE_GROUP 1\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic void\nidtoname_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\tchar idstr[11];\n\n\tqword_add(bpp, blen, ent->authname);\n\tsnprintf(idstr, sizeof(idstr), \"%u\", ent->id);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, idstr);\n\n\t(*bpp)[-1] = '\\n';\n}"
  },
  {
    "function_name": "idtoname_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "112-125",
    "snippet": "static uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ENT_HASHBITS          8",
      "#define IDMAP_TYPE_GROUP 1"
    ],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_long",
          "args": [
            "hash ^ ent->id",
            "ENT_HASHBITS"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_str",
          "args": [
            "ent->authname",
            "ENT_HASHBITS"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n#define IDMAP_TYPE_GROUP 1\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}"
  },
  {
    "function_name": "ent_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "98-106",
    "snippet": "static struct cache_head *\nent_alloc(void)\n{\n\tstruct ent *e = kmalloc(sizeof(*e), GFP_KERNEL);\n\tif (e)\n\t\treturn &e->h;\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*e)",
            "GFP_KERNEL"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic struct cache_head *\nent_alloc(void)\n{\n\tstruct ent *e = kmalloc(sizeof(*e), GFP_KERNEL);\n\tif (e)\n\t\treturn &e->h;\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "ent_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "91-96",
    "snippet": "static void\nent_put(struct kref *ref)\n{\n\tstruct ent *map = container_of(ref, struct ent, h.ref);\n\tkfree(map);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "map"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ref",
            "structent",
            "h.ref"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic void\nent_put(struct kref *ref)\n{\n\tstruct ent *map = container_of(ref, struct ent, h.ref);\n\tkfree(map);\n}"
  },
  {
    "function_name": "ent_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4idmap.c",
    "lines": "78-89",
    "snippet": "static void\nent_init(struct cache_head *cnew, struct cache_head *citm)\n{\n\tstruct ent *new = container_of(cnew, struct ent, h);\n\tstruct ent *itm = container_of(citm, struct ent, h);\n\n\tnew->id = itm->id;\n\tnew->type = itm->type;\n\n\tstrlcpy(new->name, itm->name, sizeof(new->name));\n\tstrlcpy(new->authname, itm->authname, sizeof(new->name));\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "new->authname",
            "itm->authname",
            "sizeof(new->name)"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "new->name",
            "itm->name",
            "sizeof(new->name)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "citm",
            "structent",
            "h"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cnew",
            "structent",
            "h"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic void\nent_init(struct cache_head *cnew, struct cache_head *citm)\n{\n\tstruct ent *new = container_of(cnew, struct ent, h);\n\tstruct ent *itm = container_of(citm, struct ent, h);\n\n\tnew->id = itm->id;\n\tnew->type = itm->type;\n\n\tstrlcpy(new->name, itm->name, sizeof(new->name));\n\tstrlcpy(new->authname, itm->authname, sizeof(new->name));\n}"
  }
]