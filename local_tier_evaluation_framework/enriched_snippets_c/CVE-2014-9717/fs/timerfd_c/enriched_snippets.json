[
  {
    "function_name": "do_timerfd_gettime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "482-512",
    "snippet": "static int do_timerfd_gettime(int ufd, struct itimerspec *t)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (ctx->expired && ctx->tintv.tv64) {\n\t\tctx->expired = 0;\n\n\t\tif (isalarm(ctx)) {\n\t\t\tctx->ticks +=\n\t\t\t\talarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\talarm_restart(&ctx->t.alarm);\n\t\t} else {\n\t\t\tctx->ticks +=\n\t\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv)\n\t\t\t\t- 1;\n\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t}\n\t}\n\tt->it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\tt->it_interval = ktime_to_timespec(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "fdput_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/read_write.c",
          "lines": "273-278",
          "snippet": "static inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/splice.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/aio.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/splice.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fsnotify.h>\n#include <linux/aio.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n\nstatic inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "ctx->tintv"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "timerfd_get_remaining(ctx)"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_get_remaining",
          "args": [
            "ctx"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_get_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "149-159",
          "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_restart",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_forward_now",
          "args": [
            "&ctx->t.tmr",
            "ctx->tintv"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_restart",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_forward_now",
          "args": [
            "&ctx->t.alarm",
            "ctx->tintv"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "49-53",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_fget",
          "args": [
            "ufd",
            "&f"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_fget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "363-374",
          "snippet": "static int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};\n\nstatic int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int do_timerfd_gettime(int ufd, struct itimerspec *t)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (ctx->expired && ctx->tintv.tv64) {\n\t\tctx->expired = 0;\n\n\t\tif (isalarm(ctx)) {\n\t\t\tctx->ticks +=\n\t\t\t\talarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\talarm_restart(&ctx->t.alarm);\n\t\t} else {\n\t\t\tctx->ticks +=\n\t\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv)\n\t\t\t\t- 1;\n\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t}\n\t}\n\tt->it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\tt->it_interval = ktime_to_timespec(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn 0;\n}"
  },
  {
    "function_name": "do_timerfd_settime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "418-480",
    "snippet": "static int do_timerfd_settime(int ufd, int flags, \n\t\tconst struct itimerspec *new,\n\t\tstruct itimerspec *old)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret;\n\n\tif ((flags & ~TFD_SETTIME_FLAGS) ||\n\t    !timespec_valid(&new->it_value) ||\n\t    !timespec_valid(&new->it_interval))\n\t\treturn -EINVAL;\n\n\tret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\ttimerfd_setup_cancel(ctx, flags);\n\n\t/*\n\t * We need to stop the existing timer before reprogramming\n\t * it to the new values.\n\t */\n\tfor (;;) {\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\n\t\tif (isalarm(ctx)) {\n\t\t\tif (alarm_try_to_cancel(&ctx->t.alarm) >= 0)\n\t\t\t\tbreak;\n\t\t} else {\n\t\t\tif (hrtimer_try_to_cancel(&ctx->t.tmr) >= 0)\n\t\t\t\tbreak;\n\t\t}\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tcpu_relax();\n\t}\n\n\t/*\n\t * If the timer is expired and it's periodic, we need to advance it\n\t * because the caller may want to know the previous expiration time.\n\t * We do not update \"ticks\" and \"expired\" since the timer will be\n\t * re-programmed again in the following timerfd_setup() call.\n\t */\n\tif (ctx->expired && ctx->tintv.tv64) {\n\t\tif (isalarm(ctx))\n\t\t\talarm_forward_now(&ctx->t.alarm, ctx->tintv);\n\t\telse\n\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv);\n\t}\n\n\told->it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\told->it_interval = ktime_to_timespec(ctx->tintv);\n\n\t/*\n\t * Re-program the timer to the new value ...\n\t */\n\tret = timerfd_setup(ctx, flags, new);\n\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "fdput_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/read_write.c",
          "lines": "273-278",
          "snippet": "static inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/splice.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/aio.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/splice.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fsnotify.h>\n#include <linux/aio.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n\nstatic inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_setup",
          "args": [
            "ctx",
            "flags",
            "new"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "161-203",
          "snippet": "static int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp.tv64 != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp.tv64 != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "ctx->tintv"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "timerfd_get_remaining(ctx)"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_get_remaining",
          "args": [
            "ctx"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_get_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "149-159",
          "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_forward_now",
          "args": [
            "&ctx->t.tmr",
            "ctx->tintv"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_forward_now",
          "args": [
            "&ctx->t.alarm",
            "ctx->tintv"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "49-53",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_try_to_cancel",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_try_to_cancel",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_setup_cancel",
          "args": [
            "ctx",
            "flags"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_setup_cancel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "133-147",
          "snippet": "static void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else if (ctx->might_cancel) {\n\t\ttimerfd_remove_cancel(ctx);\n\t}\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(cancel_list);",
            "static DEFINE_SPINLOCK(cancel_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic LIST_HEAD(cancel_list);\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else if (ctx->might_cancel) {\n\t\ttimerfd_remove_cancel(ctx);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "timerfd_fget",
          "args": [
            "ufd",
            "&f"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_fget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "363-374",
          "snippet": "static int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};\n\nstatic int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timespec_valid",
          "args": [
            "&new->it_interval"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec_valid",
          "args": [
            "&new->it_value"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int do_timerfd_settime(int ufd, int flags, \n\t\tconst struct itimerspec *new,\n\t\tstruct itimerspec *old)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret;\n\n\tif ((flags & ~TFD_SETTIME_FLAGS) ||\n\t    !timespec_valid(&new->it_value) ||\n\t    !timespec_valid(&new->it_interval))\n\t\treturn -EINVAL;\n\n\tret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\ttimerfd_setup_cancel(ctx, flags);\n\n\t/*\n\t * We need to stop the existing timer before reprogramming\n\t * it to the new values.\n\t */\n\tfor (;;) {\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\n\t\tif (isalarm(ctx)) {\n\t\t\tif (alarm_try_to_cancel(&ctx->t.alarm) >= 0)\n\t\t\t\tbreak;\n\t\t} else {\n\t\t\tif (hrtimer_try_to_cancel(&ctx->t.tmr) >= 0)\n\t\t\t\tbreak;\n\t\t}\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tcpu_relax();\n\t}\n\n\t/*\n\t * If the timer is expired and it's periodic, we need to advance it\n\t * because the caller may want to know the previous expiration time.\n\t * We do not update \"ticks\" and \"expired\" since the timer will be\n\t * re-programmed again in the following timerfd_setup() call.\n\t */\n\tif (ctx->expired && ctx->tintv.tv64) {\n\t\tif (isalarm(ctx))\n\t\t\talarm_forward_now(&ctx->t.alarm, ctx->tintv);\n\t\telse\n\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv);\n\t}\n\n\told->it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\told->it_interval = ktime_to_timespec(ctx->tintv);\n\n\t/*\n\t * Re-program the timer to the new value ...\n\t */\n\tret = timerfd_setup(ctx, flags, new);\n\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn ret;\n}"
  },
  {
    "function_name": "timerfd_fget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "363-374",
    "snippet": "static int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "fdput_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/read_write.c",
          "lines": "273-278",
          "snippet": "static inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/splice.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/aio.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/splice.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fsnotify.h>\n#include <linux/aio.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n\nstatic inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdget",
          "args": [
            "fd"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "__fdget_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/file.c",
          "lines": "706-718",
          "snippet": "unsigned long __fdget_pos(unsigned int fd)\n{\n\tunsigned long v = __fdget(fd);\n\tstruct file *file = (struct file *)(v & ~3);\n\n\tif (file && (file->f_mode & FMODE_ATOMIC_POS)) {\n\t\tif (file_count(file) > 1) {\n\t\t\tv |= FDPUT_POS_UNLOCK;\n\t\t\tmutex_lock(&file->f_pos_lock);\n\t\t}\n\t}\n\treturn v;\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/time.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/rcupdate.h>\n#include <linux/spinlock.h>\n#include <linux/interrupt.h>\n#include <linux/bitops.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/time.h>\n#include <linux/mmzone.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nunsigned long __fdget_pos(unsigned int fd)\n{\n\tunsigned long v = __fdget(fd);\n\tstruct file *file = (struct file *)(v & ~3);\n\n\tif (file && (file->f_mode & FMODE_ATOMIC_POS)) {\n\t\tif (file_count(file) > 1) {\n\t\t\tv |= FDPUT_POS_UNLOCK;\n\t\t\tmutex_lock(&file->f_pos_lock);\n\t\t}\n\t}\n\treturn v;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};\n\nstatic int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}"
  },
  {
    "function_name": "timerfd_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "320-349",
    "snippet": "static long timerfd_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tint ret = 0;\n\n\tswitch (cmd) {\n\tcase TFD_IOC_SET_TICKS: {\n\t\tu64 ticks;\n\n\t\tif (copy_from_user(&ticks, (u64 __user *)arg, sizeof(ticks)))\n\t\t\treturn -EFAULT;\n\t\tif (!ticks)\n\t\t\treturn -EINVAL;\n\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\t\tif (!timerfd_canceled(ctx)) {\n\t\t\tctx->ticks = ticks;\n\t\t\twake_up_locked(&ctx->wqh);\n\t\t} else\n\t\t\tret = -ECANCELED;\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tret = -ENOTTY;\n\t\tbreak;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [
      "#define timerfd_ioctl NULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_locked",
          "args": [
            "&ctx->wqh"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_canceled",
          "args": [
            "ctx"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_canceled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "125-131",
          "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&ticks",
            "(u64 __user *)arg",
            "sizeof(ticks)"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\n#define timerfd_ioctl NULL\n\nstatic long timerfd_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tint ret = 0;\n\n\tswitch (cmd) {\n\tcase TFD_IOC_SET_TICKS: {\n\t\tu64 ticks;\n\n\t\tif (copy_from_user(&ticks, (u64 __user *)arg, sizeof(ticks)))\n\t\t\treturn -EFAULT;\n\t\tif (!ticks)\n\t\t\treturn -EINVAL;\n\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\t\tif (!timerfd_canceled(ctx)) {\n\t\t\tctx->ticks = ticks;\n\t\t\twake_up_locked(&ctx->wqh);\n\t\t} else\n\t\t\tret = -ECANCELED;\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tret = -ENOTTY;\n\t\tbreak;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "timerfd_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "291-314",
    "snippet": "static void timerfd_show(struct seq_file *m, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tstruct itimerspec t;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tt.it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\tt.it_interval = ktime_to_timespec(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\n\tseq_printf(m,\n\t\t   \"clockid: %d\\n\"\n\t\t   \"ticks: %llu\\n\"\n\t\t   \"settime flags: 0%o\\n\"\n\t\t   \"it_value: (%llu, %llu)\\n\"\n\t\t   \"it_interval: (%llu, %llu)\\n\",\n\t\t   ctx->clockid,\n\t\t   (unsigned long long)ctx->ticks,\n\t\t   ctx->settime_flags,\n\t\t   (unsigned long long)t.it_value.tv_sec,\n\t\t   (unsigned long long)t.it_value.tv_nsec,\n\t\t   (unsigned long long)t.it_interval.tv_sec,\n\t\t   (unsigned long long)t.it_interval.tv_nsec);\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [
      "#define timerfd_show NULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"clockid: %d\\n\"\n\t\t   \"ticks: %llu\\n\"\n\t\t   \"settime flags: 0%o\\n\"\n\t\t   \"it_value: (%llu, %llu)\\n\"\n\t\t   \"it_interval: (%llu, %llu)\\n\"",
            "ctx->clockid",
            "(unsigned long long)ctx->ticks",
            "ctx->settime_flags",
            "(unsigned long long)t.it_value.tv_sec",
            "(unsigned long long)t.it_value.tv_nsec",
            "(unsigned long long)t.it_interval.tv_sec",
            "(unsigned long long)t.it_interval.tv_nsec"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "ctx->tintv"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "timerfd_get_remaining(ctx)"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_get_remaining",
          "args": [
            "ctx"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_get_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "149-159",
          "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\n#define timerfd_show NULL\n\nstatic void timerfd_show(struct seq_file *m, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tstruct itimerspec t;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tt.it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\tt.it_interval = ktime_to_timespec(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\n\tseq_printf(m,\n\t\t   \"clockid: %d\\n\"\n\t\t   \"ticks: %llu\\n\"\n\t\t   \"settime flags: 0%o\\n\"\n\t\t   \"it_value: (%llu, %llu)\\n\"\n\t\t   \"it_interval: (%llu, %llu)\\n\",\n\t\t   ctx->clockid,\n\t\t   (unsigned long long)ctx->ticks,\n\t\t   ctx->settime_flags,\n\t\t   (unsigned long long)t.it_value.tv_sec,\n\t\t   (unsigned long long)t.it_value.tv_nsec,\n\t\t   (unsigned long long)t.it_interval.tv_sec,\n\t\t   (unsigned long long)t.it_interval.tv_nsec);\n}"
  },
  {
    "function_name": "timerfd_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "235-288",
    "snippet": "static ssize_t timerfd_read(struct file *file, char __user *buf, size_t count,\n\t\t\t    loff_t *ppos)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tssize_t res;\n\tu64 ticks = 0;\n\n\tif (count < sizeof(ticks))\n\t\treturn -EINVAL;\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (file->f_flags & O_NONBLOCK)\n\t\tres = -EAGAIN;\n\telse\n\t\tres = wait_event_interruptible_locked_irq(ctx->wqh, ctx->ticks);\n\n\t/*\n\t * If clock has changed, we do not care about the\n\t * ticks and we do not rearm the timer. Userspace must\n\t * reevaluate anyway.\n\t */\n\tif (timerfd_canceled(ctx)) {\n\t\tctx->ticks = 0;\n\t\tctx->expired = 0;\n\t\tres = -ECANCELED;\n\t}\n\n\tif (ctx->ticks) {\n\t\tticks = ctx->ticks;\n\n\t\tif (ctx->expired && ctx->tintv.tv64) {\n\t\t\t/*\n\t\t\t * If tintv.tv64 != 0, this is a periodic timer that\n\t\t\t * needs to be re-armed. We avoid doing it in the timer\n\t\t\t * callback to avoid DoS attacks specifying a very\n\t\t\t * short timer period.\n\t\t\t */\n\t\t\tif (isalarm(ctx)) {\n\t\t\t\tticks += alarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\t\talarm_restart(&ctx->t.alarm);\n\t\t\t} else {\n\t\t\t\tticks += hrtimer_forward_now(&ctx->t.tmr,\n\t\t\t\t\t\t\t     ctx->tintv) - 1;\n\t\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t\t}\n\t\t}\n\t\tctx->expired = 0;\n\t\tctx->ticks = 0;\n\t}\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tif (ticks)\n\t\tres = put_user(ticks, (u64 __user *) buf) ? -EFAULT: sizeof(ticks);\n\treturn res;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "ticks",
            "(u64 __user *) buf"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_restart",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_forward_now",
          "args": [
            "&ctx->t.tmr",
            "ctx->tintv"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_restart",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_forward_now",
          "args": [
            "&ctx->t.alarm",
            "ctx->tintv"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "49-53",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timerfd_canceled",
          "args": [
            "ctx"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_canceled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "125-131",
          "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_event_interruptible_locked_irq",
          "args": [
            "ctx->wqh",
            "ctx->ticks"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ssize_t timerfd_read(struct file *file, char __user *buf, size_t count,\n\t\t\t    loff_t *ppos)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tssize_t res;\n\tu64 ticks = 0;\n\n\tif (count < sizeof(ticks))\n\t\treturn -EINVAL;\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (file->f_flags & O_NONBLOCK)\n\t\tres = -EAGAIN;\n\telse\n\t\tres = wait_event_interruptible_locked_irq(ctx->wqh, ctx->ticks);\n\n\t/*\n\t * If clock has changed, we do not care about the\n\t * ticks and we do not rearm the timer. Userspace must\n\t * reevaluate anyway.\n\t */\n\tif (timerfd_canceled(ctx)) {\n\t\tctx->ticks = 0;\n\t\tctx->expired = 0;\n\t\tres = -ECANCELED;\n\t}\n\n\tif (ctx->ticks) {\n\t\tticks = ctx->ticks;\n\n\t\tif (ctx->expired && ctx->tintv.tv64) {\n\t\t\t/*\n\t\t\t * If tintv.tv64 != 0, this is a periodic timer that\n\t\t\t * needs to be re-armed. We avoid doing it in the timer\n\t\t\t * callback to avoid DoS attacks specifying a very\n\t\t\t * short timer period.\n\t\t\t */\n\t\t\tif (isalarm(ctx)) {\n\t\t\t\tticks += alarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\t\talarm_restart(&ctx->t.alarm);\n\t\t\t} else {\n\t\t\t\tticks += hrtimer_forward_now(&ctx->t.tmr,\n\t\t\t\t\t\t\t     ctx->tintv) - 1;\n\t\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t\t}\n\t\t}\n\t\tctx->expired = 0;\n\t\tctx->ticks = 0;\n\t}\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tif (ticks)\n\t\tres = put_user(ticks, (u64 __user *) buf) ? -EFAULT: sizeof(ticks);\n\treturn res;\n}"
  },
  {
    "function_name": "timerfd_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "219-233",
    "snippet": "static unsigned int timerfd_poll(struct file *file, poll_table *wait)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tunsigned int events = 0;\n\tunsigned long flags;\n\n\tpoll_wait(file, &ctx->wqh, wait);\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tif (ctx->ticks)\n\t\tevents |= POLLIN;\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\n\treturn events;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "poll_wait",
          "args": [
            "file",
            "&ctx->wqh",
            "wait"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic unsigned int timerfd_poll(struct file *file, poll_table *wait)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tunsigned int events = 0;\n\tunsigned long flags;\n\n\tpoll_wait(file, &ctx->wqh, wait);\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tif (ctx->ticks)\n\t\tevents |= POLLIN;\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\n\treturn events;\n}"
  },
  {
    "function_name": "timerfd_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "205-217",
    "snippet": "static int timerfd_release(struct inode *inode, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\n\ttimerfd_remove_cancel(ctx);\n\n\tif (isalarm(ctx))\n\t\talarm_cancel(&ctx->t.alarm);\n\telse\n\t\thrtimer_cancel(&ctx->t.tmr);\n\tkfree_rcu(ctx, rcu);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree_rcu",
          "args": [
            "ctx",
            "rcu"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_cancel",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_cancel",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "49-53",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timerfd_remove_cancel",
          "args": [
            "ctx"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_remove_cancel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "115-123",
          "snippet": "static void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cancel_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int timerfd_release(struct inode *inode, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\n\ttimerfd_remove_cancel(ctx);\n\n\tif (isalarm(ctx))\n\t\talarm_cancel(&ctx->t.alarm);\n\telse\n\t\thrtimer_cancel(&ctx->t.tmr);\n\tkfree_rcu(ctx, rcu);\n\treturn 0;\n}"
  },
  {
    "function_name": "timerfd_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "161-203",
    "snippet": "static int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp.tv64 != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerfd_canceled",
          "args": [
            "ctx"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_canceled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "125-131",
          "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_start",
          "args": [
            "&ctx->t.tmr",
            "texp",
            "htmode"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_start_relative",
          "args": [
            "&ctx->t.alarm",
            "texp"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_start",
          "args": [
            "&ctx->t.alarm",
            "texp"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "49-53",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_set_expires",
          "args": [
            "&ctx->t.tmr",
            "texp"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_init",
          "args": [
            "&ctx->t.tmr",
            "clockid",
            "htmode"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_init",
          "args": [
            "&ctx->t.alarm",
            "ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME",
            "timerfd_alarmproc"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec_to_ktime",
          "args": [
            "ktmr->it_interval"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec_to_ktime",
          "args": [
            "ktmr->it_value"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp.tv64 != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}"
  },
  {
    "function_name": "timerfd_get_remaining",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "149-159",
    "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ktime_set",
          "args": [
            "0",
            "0"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_expires_remaining",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_expires_remaining",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "49-53",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining(&ctx->t.tmr);\n\n\treturn remaining.tv64 < 0 ? ktime_set(0, 0): remaining;\n}"
  },
  {
    "function_name": "timerfd_setup_cancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "133-147",
    "snippet": "static void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else if (ctx->might_cancel) {\n\t\ttimerfd_remove_cancel(ctx);\n\t}\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cancel_list);",
      "static DEFINE_SPINLOCK(cancel_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerfd_remove_cancel",
          "args": [
            "ctx"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_remove_cancel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "115-123",
          "snippet": "static void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cancel_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cancel_lock"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_rcu",
          "args": [
            "&ctx->clist",
            "&cancel_list"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cancel_lock"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic LIST_HEAD(cancel_list);\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else if (ctx->might_cancel) {\n\t\ttimerfd_remove_cancel(ctx);\n\t}\n}"
  },
  {
    "function_name": "timerfd_canceled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "125-131",
    "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ktime_mono_to_real",
          "args": [
            "(ktime_t){ .tv64 = 0 }"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs.tv64 != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\treturn true;\n}"
  },
  {
    "function_name": "timerfd_remove_cancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "115-123",
    "snippet": "static void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cancel_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cancel_lock"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&ctx->clist"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cancel_lock"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}"
  },
  {
    "function_name": "timerfd_clock_was_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "94-113",
    "snippet": "void timerfd_clock_was_set(void)\n{\n\tktime_t moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\tstruct timerfd_ctx *ctx;\n\tunsigned long flags;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(ctx, &cancel_list, clist) {\n\t\tif (!ctx->might_cancel)\n\t\t\tcontinue;\n\t\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\t\tif (ctx->moffs.tv64 != moffs.tv64) {\n\t\t\tctx->moffs.tv64 = KTIME_MAX;\n\t\t\tctx->ticks++;\n\t\t\twake_up_locked(&ctx->wqh);\n\t\t}\n\t\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\t}\n\trcu_read_unlock();\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cancel_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_locked",
          "args": [
            "&ctx->wqh"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "ctx",
            "&cancel_list",
            "clist"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_mono_to_real",
          "args": [
            "(ktime_t){ .tv64 = 0 }"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic LIST_HEAD(cancel_list);\n\nvoid timerfd_clock_was_set(void)\n{\n\tktime_t moffs = ktime_mono_to_real((ktime_t){ .tv64 = 0 });\n\tstruct timerfd_ctx *ctx;\n\tunsigned long flags;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(ctx, &cancel_list, clist) {\n\t\tif (!ctx->might_cancel)\n\t\t\tcontinue;\n\t\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\t\tif (ctx->moffs.tv64 != moffs.tv64) {\n\t\t\tctx->moffs.tv64 = KTIME_MAX;\n\t\t\tctx->ticks++;\n\t\t\twake_up_locked(&ctx->wqh);\n\t\t}\n\t\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\t}\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "timerfd_alarmproc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "79-86",
    "snippet": "static enum alarmtimer_restart timerfd_alarmproc(struct alarm *alarm,\n\tktime_t now)\n{\n\tstruct timerfd_ctx *ctx = container_of(alarm, struct timerfd_ctx,\n\t\t\t\t\t       t.alarm);\n\ttimerfd_triggered(ctx);\n\treturn ALARMTIMER_NORESTART;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerfd_triggered",
          "args": [
            "ctx"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_triggered",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "60-69",
          "snippet": "static void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked(&ctx->wqh);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked(&ctx->wqh);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "alarm",
            "structtimerfd_ctx",
            "t.alarm"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic enum alarmtimer_restart timerfd_alarmproc(struct alarm *alarm,\n\tktime_t now)\n{\n\tstruct timerfd_ctx *ctx = container_of(alarm, struct timerfd_ctx,\n\t\t\t\t\t       t.alarm);\n\ttimerfd_triggered(ctx);\n\treturn ALARMTIMER_NORESTART;\n}"
  },
  {
    "function_name": "timerfd_tmrproc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "71-77",
    "snippet": "static enum hrtimer_restart timerfd_tmrproc(struct hrtimer *htmr)\n{\n\tstruct timerfd_ctx *ctx = container_of(htmr, struct timerfd_ctx,\n\t\t\t\t\t       t.tmr);\n\ttimerfd_triggered(ctx);\n\treturn HRTIMER_NORESTART;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerfd_triggered",
          "args": [
            "ctx"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_triggered",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
          "lines": "60-69",
          "snippet": "static void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked(&ctx->wqh);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked(&ctx->wqh);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "htmr",
            "structtimerfd_ctx",
            "t.tmr"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic enum hrtimer_restart timerfd_tmrproc(struct hrtimer *htmr)\n{\n\tstruct timerfd_ctx *ctx = container_of(htmr, struct timerfd_ctx,\n\t\t\t\t\t       t.tmr);\n\ttimerfd_triggered(ctx);\n\treturn HRTIMER_NORESTART;\n}"
  },
  {
    "function_name": "timerfd_triggered",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "60-69",
    "snippet": "static void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked(&ctx->wqh);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_locked",
          "args": [
            "&ctx->wqh"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked(&ctx->wqh);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}"
  },
  {
    "function_name": "isalarm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/timerfd.c",
    "lines": "49-53",
    "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
  }
]