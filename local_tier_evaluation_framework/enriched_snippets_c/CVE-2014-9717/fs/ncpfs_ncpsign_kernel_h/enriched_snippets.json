[
  {
    "function_name": "sign_packet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncpsign_kernel.h",
    "lines": "16-24",
    "snippet": "static inline size_t sign_packet(struct ncp_server *server, const char *data, size_t size, __u32 totalsize, void *sign_buff) {\n#ifdef CONFIG_NCPFS_PACKET_SIGNING\n\tif (server->sign_active) {\n\t\t__sign_packet(server, data, size, totalsize, sign_buff);\n\t\treturn 8;\n\t}\n#endif\n\treturn 0;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__sign_packet",
          "args": [
            "server",
            "data",
            "size",
            "totalsize",
            "sign_buff"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "__sign_packet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ncpfs/ncpsign_kernel.c",
          "lines": "95-108",
          "snippet": "void __sign_packet(struct ncp_server *server, const char *packet, size_t size, __u32 totalsize, void *sign_buff) {\n\tunsigned char data[64];\n\n\tmemcpy(data, server->sign_root, 8);\n\t*(__u32*)(data + 8) = totalsize;\n\tif (size < 52) {\n\t\tmemcpy(data + 12, packet, size);\n\t\tmemset(data + 12 + size, 0, 52 - size);\n\t} else {\n\t\tmemcpy(data + 12, packet, 52);\n\t}\n\tnwsign(server->sign_last, data, server->sign_last);\n\tmemcpy(sign_buff, server->sign_last, 8);\n}",
          "includes": [
            "#include \"ncpsign_kernel.h\"",
            "#include \"ncp_fs.h\"",
            "#include <linux/bitops.h>",
            "#include <linux/ncp.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ncpsign_kernel.h\"\n#include \"ncp_fs.h\"\n#include <linux/bitops.h>\n#include <linux/ncp.h>\n#include <linux/string.h>\n\nvoid __sign_packet(struct ncp_server *server, const char *packet, size_t size, __u32 totalsize, void *sign_buff) {\n\tunsigned char data[64];\n\n\tmemcpy(data, server->sign_root, 8);\n\t*(__u32*)(data + 8) = totalsize;\n\tif (size < 52) {\n\t\tmemcpy(data + 12, packet, size);\n\t\tmemset(data + 12 + size, 0, 52 - size);\n\t} else {\n\t\tmemcpy(data + 12, packet, 52);\n\t}\n\tnwsign(server->sign_last, data, server->sign_last);\n\tmemcpy(sign_buff, server->sign_last, 8);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline size_t sign_packet(struct ncp_server *server, const char *data, size_t size, __u32 totalsize, void *sign_buff) {\n#ifdef CONFIG_NCPFS_PACKET_SIGNING\n\tif (server->sign_active) {\n\t\t__sign_packet(server, data, size, totalsize, sign_buff);\n\t\treturn 8;\n\t}\n#endif\n\treturn 0;\n}"
  }
]