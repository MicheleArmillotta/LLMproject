[
  {
    "function_name": "nlm4svc_encode_void",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "330-334",
    "snippet": "int\nnlm4svc_encode_void(struct svc_rqst *rqstp, __be32 *p, void *dummy)\n{\n\treturn xdr_ressize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_ressize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_encode_void(struct svc_rqst *rqstp, __be32 *p, void *dummy)\n{\n\treturn xdr_ressize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_void",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "324-328",
    "snippet": "int\nnlm4svc_decode_void(struct svc_rqst *rqstp, __be32 *p, void *dummy)\n{\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_void(struct svc_rqst *rqstp, __be32 *p, void *dummy)\n{\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_res",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "315-322",
    "snippet": "int\nnlm4svc_decode_res(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_decode_cookie(p, &resp->cookie)))\n\t\treturn 0;\n\tresp->status = *p++;\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_cookie",
          "args": [
            "p",
            "&resp->cookie"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "45-71",
          "snippet": "static __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_res(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_decode_cookie(p, &resp->cookie)))\n\t\treturn 0;\n\tresp->status = *p++;\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_reboot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "304-313",
    "snippet": "int\nnlm4svc_decode_reboot(struct svc_rqst *rqstp, __be32 *p, struct nlm_reboot *argp)\n{\n\tif (!(p = xdr_decode_string_inplace(p, &argp->mon, &argp->len, SM_MAXSTRLEN)))\n\t\treturn 0;\n\targp->state = ntohl(*p++);\n\tmemcpy(&argp->priv.data, p, sizeof(argp->priv.data));\n\tp += XDR_QUADLEN(SM_PRIV_SIZE);\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "SM_PRIV_SIZE"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&argp->priv.data",
            "p",
            "sizeof(argp->priv.data)"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_string_inplace",
          "args": [
            "p",
            "&argp->mon",
            "&argp->len",
            "SM_MAXSTRLEN"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_reboot(struct svc_rqst *rqstp, __be32 *p, struct nlm_reboot *argp)\n{\n\tif (!(p = xdr_decode_string_inplace(p, &argp->mon, &argp->len, SM_MAXSTRLEN)))\n\t\treturn 0;\n\targp->state = ntohl(*p++);\n\tmemcpy(&argp->priv.data, p, sizeof(argp->priv.data));\n\tp += XDR_QUADLEN(SM_PRIV_SIZE);\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_notify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "292-302",
    "snippet": "int\nnlm4svc_decode_notify(struct svc_rqst *rqstp, __be32 *p, struct nlm_args *argp)\n{\n\tstruct nlm_lock\t*lock = &argp->lock;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN)))\n\t\treturn 0;\n\targp->state = ntohl(*p++);\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_string_inplace",
          "args": [
            "p",
            "&lock->caller",
            "&lock->len",
            "NLM_MAXSTRLEN"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_notify(struct svc_rqst *rqstp, __be32 *p, struct nlm_args *argp)\n{\n\tstruct nlm_lock\t*lock = &argp->lock;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN)))\n\t\treturn 0;\n\targp->state = ntohl(*p++);\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_encode_res",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "283-290",
    "snippet": "int\nnlm4svc_encode_res(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn 0;\n\t*p++ = resp->status;\n\treturn xdr_ressize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_ressize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_encode_cookie",
          "args": [
            "p",
            "&resp->cookie"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "73-80",
          "snippet": "static __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_encode_res(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn 0;\n\t*p++ = resp->status;\n\treturn xdr_ressize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_encode_shareres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "273-281",
    "snippet": "int\nnlm4svc_encode_shareres(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn 0;\n\t*p++ = resp->status;\n\t*p++ = xdr_zero;\t\t/* sequence argument */\n\treturn xdr_ressize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_ressize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_encode_cookie",
          "args": [
            "p",
            "&resp->cookie"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "73-80",
          "snippet": "static __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_encode_shareres(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn 0;\n\t*p++ = resp->status;\n\t*p++ = xdr_zero;\t\t/* sequence argument */\n\treturn xdr_ressize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_shareargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "252-271",
    "snippet": "int\nnlm4svc_decode_shareargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tstruct nlm_lock\t*lock = &argp->lock;\n\n\tmemset(lock, 0, sizeof(*lock));\n\tlocks_init_lock(&lock->fl);\n\tlock->svid = ~(u32) 0;\n\tlock->fl.fl_pid = (pid_t)lock->svid;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie))\n\t || !(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn 0;\n\targp->fsm_mode = ntohl(*p++);\n\targp->fsm_access = ntohl(*p++);\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_oh",
          "args": [
            "p",
            "&lock->oh"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_oh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "99-103",
          "snippet": "static __be32 *\nnlm4_decode_oh(__be32 *p, struct xdr_netobj *oh)\n{\n\treturn xdr_decode_netobj(p, oh);\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_oh(__be32 *p, struct xdr_netobj *oh)\n{\n\treturn xdr_decode_netobj(p, oh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlm4_decode_fh",
          "args": [
            "p",
            "&lock->fh"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_fh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "82-94",
          "snippet": "static __be32 *\nnlm4_decode_fh(__be32 *p, struct nfs_fh *f)\n{\n\tmemset(f->data, 0, sizeof(f->data));\n\tf->size = ntohl(*p++);\n\tif (f->size > NFS_MAXFHSIZE) {\n\t\tdprintk(\"lockd: bad fhandle size %d (should be <=%d)\\n\",\n\t\t\tf->size, NFS_MAXFHSIZE);\n\t\treturn NULL;\n\t}\n      \tmemcpy(f->data, p, f->size);\n\treturn p + XDR_QUADLEN(f->size);\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_fh(__be32 *p, struct nfs_fh *f)\n{\n\tmemset(f->data, 0, sizeof(f->data));\n\tf->size = ntohl(*p++);\n\tif (f->size > NFS_MAXFHSIZE) {\n\t\tdprintk(\"lockd: bad fhandle size %d (should be <=%d)\\n\",\n\t\t\tf->size, NFS_MAXFHSIZE);\n\t\treturn NULL;\n\t}\n      \tmemcpy(f->data, p, f->size);\n\treturn p + XDR_QUADLEN(f->size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_string_inplace",
          "args": [
            "p",
            "&lock->caller",
            "&lock->len",
            "NLM_MAXSTRLEN"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_cookie",
          "args": [
            "p",
            "&argp->cookie"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "45-71",
          "snippet": "static __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "locks_init_lock",
          "args": [
            "&lock->fl"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "locks_init_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/locks.c",
          "lines": "311-315",
          "snippet": "void locks_init_lock(struct file_lock *fl)\n{\n\tmemset(fl, 0, sizeof(struct file_lock));\n\tlocks_init_lock_heads(fl);\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <asm/uaccess.h>",
            "#include <trace/events/filelock.h>",
            "#include <linux/lglock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/time.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <asm/uaccess.h>\n#include <trace/events/filelock.h>\n#include <linux/lglock.h>\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include <linux/pid_namespace.h>\n#include <linux/rcupdate.h>\n#include <linux/time.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n\nvoid locks_init_lock(struct file_lock *fl)\n{\n\tmemset(fl, 0, sizeof(struct file_lock));\n\tlocks_init_lock_heads(fl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "lock",
            "0",
            "sizeof(*lock)"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_shareargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tstruct nlm_lock\t*lock = &argp->lock;\n\n\tmemset(lock, 0, sizeof(*lock));\n\tlocks_init_lock(&lock->fl);\n\tlock->svid = ~(u32) 0;\n\tlock->fl.fl_pid = (pid_t)lock->svid;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie))\n\t || !(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn 0;\n\targp->fsm_mode = ntohl(*p++);\n\targp->fsm_access = ntohl(*p++);\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_unlockargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "242-250",
    "snippet": "int\nnlm4svc_decode_unlockargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie))\n\t || !(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\targp->lock.fl.fl_type = F_UNLCK;\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_lock",
          "args": [
            "p",
            "&argp->lock"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "105-135",
          "snippet": "static __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlm4_decode_cookie",
          "args": [
            "p",
            "&argp->cookie"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "45-71",
          "snippet": "static __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_unlockargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie))\n\t || !(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\targp->lock.fl.fl_type = F_UNLCK;\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_cancargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "226-240",
    "snippet": "int\nnlm4svc_decode_cancargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tu32\texclusive;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie)))\n\t\treturn 0;\n\targp->block = ntohl(*p++);\n\texclusive = ntohl(*p++);\n\tif (!(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\tif (exclusive)\n\t\targp->lock.fl.fl_type = F_WRLCK;\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_lock",
          "args": [
            "p",
            "&argp->lock"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "105-135",
          "snippet": "static __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_cookie",
          "args": [
            "p",
            "&argp->cookie"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "45-71",
          "snippet": "static __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_cancargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tu32\texclusive;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie)))\n\t\treturn 0;\n\targp->block = ntohl(*p++);\n\texclusive = ntohl(*p++);\n\tif (!(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\tif (exclusive)\n\t\targp->lock.fl.fl_type = F_WRLCK;\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_lockargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "206-224",
    "snippet": "int\nnlm4svc_decode_lockargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tu32\texclusive;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie)))\n\t\treturn 0;\n\targp->block  = ntohl(*p++);\n\texclusive    = ntohl(*p++);\n\tif (!(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\tif (exclusive)\n\t\targp->lock.fl.fl_type = F_WRLCK;\n\targp->reclaim = ntohl(*p++);\n\targp->state   = ntohl(*p++);\n\targp->monitor = 1;\t\t/* monitor client by default */\n\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_lock",
          "args": [
            "p",
            "&argp->lock"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "105-135",
          "snippet": "static __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_cookie",
          "args": [
            "p",
            "&argp->cookie"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "45-71",
          "snippet": "static __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_lockargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tu32\texclusive;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie)))\n\t\treturn 0;\n\targp->block  = ntohl(*p++);\n\texclusive    = ntohl(*p++);\n\tif (!(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\tif (exclusive)\n\t\targp->lock.fl.fl_type = F_WRLCK;\n\targp->reclaim = ntohl(*p++);\n\targp->state   = ntohl(*p++);\n\targp->monitor = 1;\t\t/* monitor client by default */\n\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_encode_testres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "198-204",
    "snippet": "int\nnlm4svc_encode_testres(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_encode_testres(p, resp)))\n\t\treturn 0;\n\treturn xdr_ressize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_ressize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_encode_testres",
          "args": [
            "p",
            "resp"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_encode_testres",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "140-175",
          "snippet": "static __be32 *\nnlm4_encode_testres(__be32 *p, struct nlm_res *resp)\n{\n\ts64\t\tstart, len;\n\n\tdprintk(\"xdr: before encode_testres (p %p resp %p)\\n\", p, resp);\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn NULL;\n\t*p++ = resp->status;\n\n\tif (resp->status == nlm_lck_denied) {\n\t\tstruct file_lock\t*fl = &resp->lock.fl;\n\n\t\t*p++ = (fl->fl_type == F_RDLCK)? xdr_zero : xdr_one;\n\t\t*p++ = htonl(resp->lock.svid);\n\n\t\t/* Encode owner handle. */\n\t\tif (!(p = xdr_encode_netobj(p, &resp->lock.oh)))\n\t\t\treturn NULL;\n\n\t\tstart = loff_t_to_s64(fl->fl_start);\n\t\tif (fl->fl_end == OFFSET_MAX)\n\t\t\tlen = 0;\n\t\telse\n\t\t\tlen = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n\t\t\n\t\tp = xdr_encode_hyper(p, start);\n\t\tp = xdr_encode_hyper(p, len);\n\t\tdprintk(\"xdr: encode_testres (status %u pid %d type %d start %Ld end %Ld)\\n\",\n\t\t\tresp->status, (int)resp->lock.svid, fl->fl_type,\n\t\t\t(long long)fl->fl_start,  (long long)fl->fl_end);\n\t}\n\n\tdprintk(\"xdr: after encode_testres (p %p resp %p)\\n\", p, resp);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_encode_testres(__be32 *p, struct nlm_res *resp)\n{\n\ts64\t\tstart, len;\n\n\tdprintk(\"xdr: before encode_testres (p %p resp %p)\\n\", p, resp);\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn NULL;\n\t*p++ = resp->status;\n\n\tif (resp->status == nlm_lck_denied) {\n\t\tstruct file_lock\t*fl = &resp->lock.fl;\n\n\t\t*p++ = (fl->fl_type == F_RDLCK)? xdr_zero : xdr_one;\n\t\t*p++ = htonl(resp->lock.svid);\n\n\t\t/* Encode owner handle. */\n\t\tif (!(p = xdr_encode_netobj(p, &resp->lock.oh)))\n\t\t\treturn NULL;\n\n\t\tstart = loff_t_to_s64(fl->fl_start);\n\t\tif (fl->fl_end == OFFSET_MAX)\n\t\t\tlen = 0;\n\t\telse\n\t\t\tlen = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n\t\t\n\t\tp = xdr_encode_hyper(p, start);\n\t\tp = xdr_encode_hyper(p, len);\n\t\tdprintk(\"xdr: encode_testres (status %u pid %d type %d start %Ld end %Ld)\\n\",\n\t\t\tresp->status, (int)resp->lock.svid, fl->fl_type,\n\t\t\t(long long)fl->fl_start,  (long long)fl->fl_end);\n\t}\n\n\tdprintk(\"xdr: after encode_testres (p %p resp %p)\\n\", p, resp);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_encode_testres(struct svc_rqst *rqstp, __be32 *p, struct nlm_res *resp)\n{\n\tif (!(p = nlm4_encode_testres(p, resp)))\n\t\treturn 0;\n\treturn xdr_ressize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4svc_decode_testargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "181-196",
    "snippet": "int\nnlm4svc_decode_testargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tu32\texclusive;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie)))\n\t\treturn 0;\n\n\texclusive = ntohl(*p++);\n\tif (!(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\tif (exclusive)\n\t\targp->lock.fl.fl_type = F_WRLCK;\n\n\treturn xdr_argsize_check(rqstp, p);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_argsize_check",
          "args": [
            "rqstp",
            "p"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_lock",
          "args": [
            "p",
            "&argp->lock"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "105-135",
          "snippet": "static __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_cookie",
          "args": [
            "p",
            "&argp->cookie"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "45-71",
          "snippet": "static __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nint\nnlm4svc_decode_testargs(struct svc_rqst *rqstp, __be32 *p, nlm_args *argp)\n{\n\tu32\texclusive;\n\n\tif (!(p = nlm4_decode_cookie(p, &argp->cookie)))\n\t\treturn 0;\n\n\texclusive = ntohl(*p++);\n\tif (!(p = nlm4_decode_lock(p, &argp->lock)))\n\t\treturn 0;\n\tif (exclusive)\n\t\targp->lock.fl.fl_type = F_WRLCK;\n\n\treturn xdr_argsize_check(rqstp, p);\n}"
  },
  {
    "function_name": "nlm4_encode_testres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "140-175",
    "snippet": "static __be32 *\nnlm4_encode_testres(__be32 *p, struct nlm_res *resp)\n{\n\ts64\t\tstart, len;\n\n\tdprintk(\"xdr: before encode_testres (p %p resp %p)\\n\", p, resp);\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn NULL;\n\t*p++ = resp->status;\n\n\tif (resp->status == nlm_lck_denied) {\n\t\tstruct file_lock\t*fl = &resp->lock.fl;\n\n\t\t*p++ = (fl->fl_type == F_RDLCK)? xdr_zero : xdr_one;\n\t\t*p++ = htonl(resp->lock.svid);\n\n\t\t/* Encode owner handle. */\n\t\tif (!(p = xdr_encode_netobj(p, &resp->lock.oh)))\n\t\t\treturn NULL;\n\n\t\tstart = loff_t_to_s64(fl->fl_start);\n\t\tif (fl->fl_end == OFFSET_MAX)\n\t\t\tlen = 0;\n\t\telse\n\t\t\tlen = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n\t\t\n\t\tp = xdr_encode_hyper(p, start);\n\t\tp = xdr_encode_hyper(p, len);\n\t\tdprintk(\"xdr: encode_testres (status %u pid %d type %d start %Ld end %Ld)\\n\",\n\t\t\tresp->status, (int)resp->lock.svid, fl->fl_type,\n\t\t\t(long long)fl->fl_start,  (long long)fl->fl_end);\n\t}\n\n\tdprintk(\"xdr: after encode_testres (p %p resp %p)\\n\", p, resp);\n\treturn p;\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"xdr: after encode_testres (p %p resp %p)\\n\"",
            "p",
            "resp"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"xdr: encode_testres (status %u pid %d type %d start %Ld end %Ld)\\n\"",
            "resp->status",
            "(int)resp->lock.svid",
            "fl->fl_type",
            "(long long)fl->fl_start",
            "(long long)fl->fl_end"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "len"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "start"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loff_t_to_s64",
          "args": [
            "fl->fl_end - fl->fl_start + 1"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "loff_t_to_s64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "29-40",
          "snippet": "static inline s64\nloff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\tif (offset > NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset < -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic inline s64\nloff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\tif (offset > NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset < -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_netobj",
          "args": [
            "p",
            "&resp->lock.oh"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "resp->lock.svid"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_encode_cookie",
          "args": [
            "p",
            "&resp->cookie"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "73-80",
          "snippet": "static __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"xdr: before encode_testres (p %p resp %p)\\n\"",
            "p",
            "resp"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_encode_testres(__be32 *p, struct nlm_res *resp)\n{\n\ts64\t\tstart, len;\n\n\tdprintk(\"xdr: before encode_testres (p %p resp %p)\\n\", p, resp);\n\tif (!(p = nlm4_encode_cookie(p, &resp->cookie)))\n\t\treturn NULL;\n\t*p++ = resp->status;\n\n\tif (resp->status == nlm_lck_denied) {\n\t\tstruct file_lock\t*fl = &resp->lock.fl;\n\n\t\t*p++ = (fl->fl_type == F_RDLCK)? xdr_zero : xdr_one;\n\t\t*p++ = htonl(resp->lock.svid);\n\n\t\t/* Encode owner handle. */\n\t\tif (!(p = xdr_encode_netobj(p, &resp->lock.oh)))\n\t\t\treturn NULL;\n\n\t\tstart = loff_t_to_s64(fl->fl_start);\n\t\tif (fl->fl_end == OFFSET_MAX)\n\t\t\tlen = 0;\n\t\telse\n\t\t\tlen = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n\t\t\n\t\tp = xdr_encode_hyper(p, start);\n\t\tp = xdr_encode_hyper(p, len);\n\t\tdprintk(\"xdr: encode_testres (status %u pid %d type %d start %Ld end %Ld)\\n\",\n\t\t\tresp->status, (int)resp->lock.svid, fl->fl_type,\n\t\t\t(long long)fl->fl_start,  (long long)fl->fl_end);\n\t}\n\n\tdprintk(\"xdr: after encode_testres (p %p resp %p)\\n\", p, resp);\n\treturn p;\n}"
  },
  {
    "function_name": "nlm4_decode_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "105-135",
    "snippet": "static __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s64_to_loff_t",
          "args": [
            "end"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "s64_to_loff_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "22-26",
          "snippet": "static inline loff_t\ns64_to_loff_t(__s64 offset)\n{\n\treturn (loff_t)offset;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic inline loff_t\ns64_to_loff_t(__s64 offset)\n{\n\treturn (loff_t)offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&len"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&start"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locks_init_lock",
          "args": [
            "fl"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "locks_init_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/locks.c",
          "lines": "311-315",
          "snippet": "void locks_init_lock(struct file_lock *fl)\n{\n\tmemset(fl, 0, sizeof(struct file_lock));\n\tlocks_init_lock_heads(fl);\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <asm/uaccess.h>",
            "#include <trace/events/filelock.h>",
            "#include <linux/lglock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/time.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <asm/uaccess.h>\n#include <trace/events/filelock.h>\n#include <linux/lglock.h>\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include <linux/pid_namespace.h>\n#include <linux/rcupdate.h>\n#include <linux/time.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n\nvoid locks_init_lock(struct file_lock *fl)\n{\n\tmemset(fl, 0, sizeof(struct file_lock));\n\tlocks_init_lock_heads(fl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_decode_oh",
          "args": [
            "p",
            "&lock->oh"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_oh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "99-103",
          "snippet": "static __be32 *\nnlm4_decode_oh(__be32 *p, struct xdr_netobj *oh)\n{\n\treturn xdr_decode_netobj(p, oh);\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_oh(__be32 *p, struct xdr_netobj *oh)\n{\n\treturn xdr_decode_netobj(p, oh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlm4_decode_fh",
          "args": [
            "p",
            "&lock->fh"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_decode_fh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
          "lines": "82-94",
          "snippet": "static __be32 *\nnlm4_decode_fh(__be32 *p, struct nfs_fh *f)\n{\n\tmemset(f->data, 0, sizeof(f->data));\n\tf->size = ntohl(*p++);\n\tif (f->size > NFS_MAXFHSIZE) {\n\t\tdprintk(\"lockd: bad fhandle size %d (should be <=%d)\\n\",\n\t\t\tf->size, NFS_MAXFHSIZE);\n\t\treturn NULL;\n\t}\n      \tmemcpy(f->data, p, f->size);\n\treturn p + XDR_QUADLEN(f->size);\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_fh(__be32 *p, struct nfs_fh *f)\n{\n\tmemset(f->data, 0, sizeof(f->data));\n\tf->size = ntohl(*p++);\n\tif (f->size > NFS_MAXFHSIZE) {\n\t\tdprintk(\"lockd: bad fhandle size %d (should be <=%d)\\n\",\n\t\t\tf->size, NFS_MAXFHSIZE);\n\t\treturn NULL;\n\t}\n      \tmemcpy(f->data, p, f->size);\n\treturn p + XDR_QUADLEN(f->size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_string_inplace",
          "args": [
            "p",
            "&lock->caller",
            "&lock->len",
            "NLM_MAXSTRLEN"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_lock(__be32 *p, struct nlm_lock *lock)\n{\n\tstruct file_lock\t*fl = &lock->fl;\n\t__u64\t\t\tlen, start;\n\t__s64\t\t\tend;\n\n\tif (!(p = xdr_decode_string_inplace(p, &lock->caller,\n\t\t\t\t\t    &lock->len, NLM_MAXSTRLEN))\n\t || !(p = nlm4_decode_fh(p, &lock->fh))\n\t || !(p = nlm4_decode_oh(p, &lock->oh)))\n\t\treturn NULL;\n\tlock->svid  = ntohl(*p++);\n\n\tlocks_init_lock(fl);\n\tfl->fl_owner = current->files;\n\tfl->fl_pid   = (pid_t)lock->svid;\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = F_RDLCK;\t\t/* as good as anything else */\n\tp = xdr_decode_hyper(p, &start);\n\tp = xdr_decode_hyper(p, &len);\n\tend = start + len - 1;\n\n\tfl->fl_start = s64_to_loff_t(start);\n\n\tif (len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = s64_to_loff_t(end);\n\treturn p;\n}"
  },
  {
    "function_name": "nlm4_decode_oh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "99-103",
    "snippet": "static __be32 *\nnlm4_decode_oh(__be32 *p, struct xdr_netobj *oh)\n{\n\treturn xdr_decode_netobj(p, oh);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_decode_netobj",
          "args": [
            "p",
            "oh"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_oh(__be32 *p, struct xdr_netobj *oh)\n{\n\treturn xdr_decode_netobj(p, oh);\n}"
  },
  {
    "function_name": "nlm4_decode_fh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "82-94",
    "snippet": "static __be32 *\nnlm4_decode_fh(__be32 *p, struct nfs_fh *f)\n{\n\tmemset(f->data, 0, sizeof(f->data));\n\tf->size = ntohl(*p++);\n\tif (f->size > NFS_MAXFHSIZE) {\n\t\tdprintk(\"lockd: bad fhandle size %d (should be <=%d)\\n\",\n\t\t\tf->size, NFS_MAXFHSIZE);\n\t\treturn NULL;\n\t}\n      \tmemcpy(f->data, p, f->size);\n\treturn p + XDR_QUADLEN(f->size);\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "f->size"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "f->data",
            "p",
            "f->size"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: bad fhandle size %d (should be <=%d)\\n\"",
            "f->size",
            "NFS_MAXFHSIZE"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "f->data",
            "0",
            "sizeof(f->data)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_fh(__be32 *p, struct nfs_fh *f)\n{\n\tmemset(f->data, 0, sizeof(f->data));\n\tf->size = ntohl(*p++);\n\tif (f->size > NFS_MAXFHSIZE) {\n\t\tdprintk(\"lockd: bad fhandle size %d (should be <=%d)\\n\",\n\t\t\tf->size, NFS_MAXFHSIZE);\n\t\treturn NULL;\n\t}\n      \tmemcpy(f->data, p, f->size);\n\treturn p + XDR_QUADLEN(f->size);\n}"
  },
  {
    "function_name": "nlm4_encode_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "73-80",
    "snippet": "static __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "c->len"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "p",
            "c->data",
            "c->len"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "c->len"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_encode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\t*p++ = htonl(c->len);\n\tmemcpy(p, c->data, c->len);\n\tp+=XDR_QUADLEN(c->len);\n\treturn p;\n}"
  },
  {
    "function_name": "nlm4_decode_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "45-71",
    "snippet": "static __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\"",
            "len",
            "NLM_MAXCOOKIELEN"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "len"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "c->data",
            "p",
            "len"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "c->data",
            "0",
            "4"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p++"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic __be32 *\nnlm4_decode_cookie(__be32 *p, struct nlm_cookie *c)\n{\n\tunsigned int\tlen;\n\n\tlen = ntohl(*p++);\n\t\n\tif(len==0)\n\t{\n\t\tc->len=4;\n\t\tmemset(c->data, 0, 4);\t/* hockeypux brain damage */\n\t}\n\telse if(len<=NLM_MAXCOOKIELEN)\n\t{\n\t\tc->len=len;\n\t\tmemcpy(c->data, p, len);\n\t\tp+=XDR_QUADLEN(len);\n\t}\n\telse \n\t{\n\t\tdprintk(\"lockd: bad cookie size %d (only cookies under \"\n\t\t\t\"%d bytes are supported.)\\n\",\n\t\t\t\tlen, NLM_MAXCOOKIELEN);\n\t\treturn NULL;\n\t}\n\treturn p;\n}"
  },
  {
    "function_name": "loff_t_to_s64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "29-40",
    "snippet": "static inline s64\nloff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\tif (offset > NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset < -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic inline s64\nloff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\tif (offset > NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset < -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}"
  },
  {
    "function_name": "s64_to_loff_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/xdr4.c",
    "lines": "22-26",
    "snippet": "static inline loff_t\ns64_to_loff_t(__s64 offset)\n{\n\treturn (loff_t)offset;\n}",
    "includes": [
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sched.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/nfs.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n\nstatic inline loff_t\ns64_to_loff_t(__s64 offset)\n{\n\treturn (loff_t)offset;\n}"
  }
]