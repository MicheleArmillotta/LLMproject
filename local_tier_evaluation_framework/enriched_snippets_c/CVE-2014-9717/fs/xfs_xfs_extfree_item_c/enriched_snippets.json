[
  {
    "function_name": "xfs_efd_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "482-507",
    "snippet": "struct xfs_efd_log_item *\nxfs_efd_init(\n\tstruct xfs_mount\t*mp,\n\tstruct xfs_efi_log_item\t*efip,\n\tuint\t\t\tnextents)\n\n{\n\tstruct xfs_efd_log_item\t*efdp;\n\tuint\t\t\tsize;\n\n\tASSERT(nextents > 0);\n\tif (nextents > XFS_EFD_MAX_FAST_EXTENTS) {\n\t\tsize = (uint)(sizeof(xfs_efd_log_item_t) +\n\t\t\t((nextents - 1) * sizeof(xfs_extent_t)));\n\t\tefdp = kmem_zalloc(size, KM_SLEEP);\n\t} else {\n\t\tefdp = kmem_zone_zalloc(xfs_efd_zone, KM_SLEEP);\n\t}\n\n\txfs_log_item_init(mp, &efdp->efd_item, XFS_LI_EFD, &xfs_efd_item_ops);\n\tefdp->efd_efip = efip;\n\tefdp->efd_format.efd_nextents = nextents;\n\tefdp->efd_format.efd_efi_id = efip->efi_format.efi_id;\n\n\treturn efdp;\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "kmem_zone_t\t*xfs_efd_zone;",
      "static const struct xfs_item_ops xfs_efd_item_ops = {\n\t.iop_size\t= xfs_efd_item_size,\n\t.iop_format\t= xfs_efd_item_format,\n\t.iop_pin\t= xfs_efd_item_pin,\n\t.iop_unpin\t= xfs_efd_item_unpin,\n\t.iop_unlock\t= xfs_efd_item_unlock,\n\t.iop_committed\t= xfs_efd_item_committed,\n\t.iop_push\t= xfs_efd_item_push,\n\t.iop_committing = xfs_efd_item_committing\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_log_item_init",
          "args": [
            "mp",
            "&efdp->efd_item",
            "XFS_LI_EFD",
            "&xfs_efd_item_ops"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_log_item_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_log.c",
          "lines": "961-976",
          "snippet": "void\nxfs_log_item_init(\n\tstruct xfs_mount\t*mp,\n\tstruct xfs_log_item\t*item,\n\tint\t\t\ttype,\n\tconst struct xfs_item_ops *ops)\n{\n\titem->li_mountp = mp;\n\titem->li_ailp = mp->m_ail;\n\titem->li_type = type;\n\titem->li_ops = ops;\n\titem->li_lv = NULL;\n\n\tINIT_LIST_HEAD(&item->li_ail);\n\tINIT_LIST_HEAD(&item->li_cil);\n}",
          "includes": [
            "#include \"xfs_sb.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs_cksum.h\"",
            "#include \"xfs_fsops.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_log_recover.h\"",
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_error.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "STATIC struct",
            "STATIC struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_sb.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs_cksum.h\"\n#include \"xfs_fsops.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_log_recover.h\"\n#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_error.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC struct;\nSTATIC struct;\n\nvoid\nxfs_log_item_init(\n\tstruct xfs_mount\t*mp,\n\tstruct xfs_log_item\t*item,\n\tint\t\t\ttype,\n\tconst struct xfs_item_ops *ops)\n{\n\titem->li_mountp = mp;\n\titem->li_ailp = mp->m_ail;\n\titem->li_type = type;\n\titem->li_ops = ops;\n\titem->li_lv = NULL;\n\n\tINIT_LIST_HEAD(&item->li_ail);\n\tINIT_LIST_HEAD(&item->li_cil);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_zone_zalloc",
          "args": [
            "xfs_efd_zone",
            "KM_SLEEP"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_zone_zalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.h",
          "lines": "119-123",
          "snippet": "static inline void *\nkmem_zone_zalloc(kmem_zone_t *zone, xfs_km_flags_t flags)\n{\n\treturn kmem_zone_alloc(zone, flags | KM_ZERO);\n}",
          "includes": [
            "#include <linux/vmalloc.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define kmem_zone_t\tstruct kmem_cache",
            "#define KM_ZERO\t\t((__force xfs_km_flags_t)0x0010u)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/vmalloc.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n\n#define kmem_zone_t\tstruct kmem_cache\n#define KM_ZERO\t\t((__force xfs_km_flags_t)0x0010u)\n\nstatic inline void *\nkmem_zone_zalloc(kmem_zone_t *zone, xfs_km_flags_t flags)\n{\n\treturn kmem_zone_alloc(zone, flags | KM_ZERO);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_zalloc",
          "args": [
            "size",
            "KM_SLEEP"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_zalloc_large",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.c",
          "lines": "64-92",
          "snippet": "void *\nkmem_zalloc_large(size_t size, xfs_km_flags_t flags)\n{\n\tunsigned noio_flag = 0;\n\tvoid\t*ptr;\n\tgfp_t\tlflags;\n\n\tptr = kmem_zalloc(size, flags | KM_MAYFAIL);\n\tif (ptr)\n\t\treturn ptr;\n\n\t/*\n\t * __vmalloc() will allocate data pages and auxillary structures (e.g.\n\t * pagetables) with GFP_KERNEL, yet we may be under GFP_NOFS context\n\t * here. Hence we need to tell memory reclaim that we are in such a\n\t * context via PF_MEMALLOC_NOIO to prevent memory reclaim re-entering\n\t * the filesystem here and potentially deadlocking.\n\t */\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tnoio_flag = memalloc_noio_save();\n\n\tlflags = kmem_flags_convert(flags);\n\tptr = __vmalloc(size, lflags | __GFP_HIGHMEM | __GFP_ZERO, PAGE_KERNEL);\n\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tmemalloc_noio_restore(noio_flag);\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"xfs_message.h\"",
            "#include \"kmem.h\"",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_message.h\"\n#include \"kmem.h\"\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nvoid *\nkmem_zalloc_large(size_t size, xfs_km_flags_t flags)\n{\n\tunsigned noio_flag = 0;\n\tvoid\t*ptr;\n\tgfp_t\tlflags;\n\n\tptr = kmem_zalloc(size, flags | KM_MAYFAIL);\n\tif (ptr)\n\t\treturn ptr;\n\n\t/*\n\t * __vmalloc() will allocate data pages and auxillary structures (e.g.\n\t * pagetables) with GFP_KERNEL, yet we may be under GFP_NOFS context\n\t * here. Hence we need to tell memory reclaim that we are in such a\n\t * context via PF_MEMALLOC_NOIO to prevent memory reclaim re-entering\n\t * the filesystem here and potentially deadlocking.\n\t */\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tnoio_flag = memalloc_noio_save();\n\n\tlflags = kmem_flags_convert(flags);\n\tptr = __vmalloc(size, lflags | __GFP_HIGHMEM | __GFP_ZERO, PAGE_KERNEL);\n\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tmemalloc_noio_restore(noio_flag);\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sizeof(xfs_efd_log_item_t) +\n\t\t\t((nextents - 1) * sizeof(xfs_extent_t))"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "nextents > 0"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efd_zone;\nstatic const struct xfs_item_ops xfs_efd_item_ops = {\n\t.iop_size\t= xfs_efd_item_size,\n\t.iop_format\t= xfs_efd_item_format,\n\t.iop_pin\t= xfs_efd_item_pin,\n\t.iop_unpin\t= xfs_efd_item_unpin,\n\t.iop_unlock\t= xfs_efd_item_unlock,\n\t.iop_committed\t= xfs_efd_item_committed,\n\t.iop_push\t= xfs_efd_item_push,\n\t.iop_committing = xfs_efd_item_committing\n};\n\nstruct xfs_efd_log_item *\nxfs_efd_init(\n\tstruct xfs_mount\t*mp,\n\tstruct xfs_efi_log_item\t*efip,\n\tuint\t\t\tnextents)\n\n{\n\tstruct xfs_efd_log_item\t*efdp;\n\tuint\t\t\tsize;\n\n\tASSERT(nextents > 0);\n\tif (nextents > XFS_EFD_MAX_FAST_EXTENTS) {\n\t\tsize = (uint)(sizeof(xfs_efd_log_item_t) +\n\t\t\t((nextents - 1) * sizeof(xfs_extent_t)));\n\t\tefdp = kmem_zalloc(size, KM_SLEEP);\n\t} else {\n\t\tefdp = kmem_zone_zalloc(xfs_efd_zone, KM_SLEEP);\n\t}\n\n\txfs_log_item_init(mp, &efdp->efd_item, XFS_LI_EFD, &xfs_efd_item_ops);\n\tefdp->efd_efip = efip;\n\tefdp->efd_format.efd_nextents = nextents;\n\tefdp->efd_format.efd_efi_id = efip->efi_format.efi_id;\n\n\treturn efdp;\n}"
  },
  {
    "function_name": "xfs_efd_item_committing",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "458-463",
    "snippet": "STATIC void\nxfs_efd_item_committing(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efd_item_committing(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n}"
  },
  {
    "function_name": "xfs_efd_item_committed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "433-449",
    "snippet": "STATIC xfs_lsn_t\nxfs_efd_item_committed(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n\tstruct xfs_efd_log_item\t*efdp = EFD_ITEM(lip);\n\n\t/*\n\t * If we got a log I/O error, it's always the case that the LR with the\n\t * EFI got unpinned and freed before the EFD got aborted.\n\t */\n\tif (!(lip->li_flags & XFS_LI_ABORTED))\n\t\txfs_efi_release(efdp->efd_efip, efdp->efd_format.efd_nextents);\n\n\txfs_efd_item_free(efdp);\n\treturn (xfs_lsn_t)-1;\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_efd_item_free",
          "args": [
            "efdp"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efd_item_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "329-336",
          "snippet": "STATIC void\nxfs_efd_item_free(struct xfs_efd_log_item *efdp)\n{\n\tif (efdp->efd_format.efd_nextents > XFS_EFD_MAX_FAST_EXTENTS)\n\t\tkmem_free(efdp);\n\telse\n\t\tkmem_zone_free(xfs_efd_zone, efdp);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kmem_zone_t\t*xfs_efd_zone;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efd_zone;\n\nSTATIC void\nxfs_efd_item_free(struct xfs_efd_log_item *efdp)\n{\n\tif (efdp->efd_format.efd_nextents > XFS_EFD_MAX_FAST_EXTENTS)\n\t\tkmem_free(efdp);\n\telse\n\t\tkmem_zone_free(xfs_efd_zone, efdp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_efi_release",
          "args": [
            "efdp->efd_efip",
            "efdp->efd_format.efd_nextents"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efi_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "309-322",
          "snippet": "void\nxfs_efi_release(xfs_efi_log_item_t\t*efip,\n\t\tuint\t\t\tnextents)\n{\n\tASSERT(atomic_read(&efip->efi_next_extent) >= nextents);\n\tif (atomic_sub_and_test(nextents, &efip->efi_next_extent)) {\n\t\t/* recovery needs us to drop the EFI reference, too */\n\t\tif (test_bit(XFS_EFI_RECOVERED, &efip->efi_flags))\n\t\t\t__xfs_efi_release(efip);\n\n\t\t__xfs_efi_release(efip);\n\t\t/* efip may now have been freed, do not reference it again. */\n\t}\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nvoid\nxfs_efi_release(xfs_efi_log_item_t\t*efip,\n\t\tuint\t\t\tnextents)\n{\n\tASSERT(atomic_read(&efip->efi_next_extent) >= nextents);\n\tif (atomic_sub_and_test(nextents, &efip->efi_next_extent)) {\n\t\t/* recovery needs us to drop the EFI reference, too */\n\t\tif (test_bit(XFS_EFI_RECOVERED, &efip->efi_flags))\n\t\t\t__xfs_efi_release(efip);\n\n\t\t__xfs_efi_release(efip);\n\t\t/* efip may now have been freed, do not reference it again. */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "EFD_ITEM",
          "args": [
            "lip"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "EFD_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "324-327",
          "snippet": "static inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC xfs_lsn_t\nxfs_efd_item_committed(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n\tstruct xfs_efd_log_item\t*efdp = EFD_ITEM(lip);\n\n\t/*\n\t * If we got a log I/O error, it's always the case that the LR with the\n\t * EFI got unpinned and freed before the EFD got aborted.\n\t */\n\tif (!(lip->li_flags & XFS_LI_ABORTED))\n\t\txfs_efi_release(efdp->efd_efip, efdp->efd_format.efd_nextents);\n\n\txfs_efd_item_free(efdp);\n\treturn (xfs_lsn_t)-1;\n}"
  },
  {
    "function_name": "xfs_efd_item_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "418-424",
    "snippet": "STATIC void\nxfs_efd_item_unlock(\n\tstruct xfs_log_item\t*lip)\n{\n\tif (lip->li_flags & XFS_LI_ABORTED)\n\t\txfs_efd_item_free(EFD_ITEM(lip));\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_efd_item_free",
          "args": [
            "EFD_ITEM(lip)"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efd_item_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "329-336",
          "snippet": "STATIC void\nxfs_efd_item_free(struct xfs_efd_log_item *efdp)\n{\n\tif (efdp->efd_format.efd_nextents > XFS_EFD_MAX_FAST_EXTENTS)\n\t\tkmem_free(efdp);\n\telse\n\t\tkmem_zone_free(xfs_efd_zone, efdp);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kmem_zone_t\t*xfs_efd_zone;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efd_zone;\n\nSTATIC void\nxfs_efd_item_free(struct xfs_efd_log_item *efdp)\n{\n\tif (efdp->efd_format.efd_nextents > XFS_EFD_MAX_FAST_EXTENTS)\n\t\tkmem_free(efdp);\n\telse\n\t\tkmem_zone_free(xfs_efd_zone, efdp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EFD_ITEM",
          "args": [
            "lip"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "EFD_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "324-327",
          "snippet": "static inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efd_item_unlock(\n\tstruct xfs_log_item\t*lip)\n{\n\tif (lip->li_flags & XFS_LI_ABORTED)\n\t\txfs_efd_item_free(EFD_ITEM(lip));\n}"
  },
  {
    "function_name": "xfs_efd_item_push",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "410-416",
    "snippet": "STATIC uint\nxfs_efd_item_push(\n\tstruct xfs_log_item\t*lip,\n\tstruct list_head\t*buffer_list)\n{\n\treturn XFS_ITEM_PINNED;\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC uint\nxfs_efd_item_push(\n\tstruct xfs_log_item\t*lip,\n\tstruct list_head\t*buffer_list)\n{\n\treturn XFS_ITEM_PINNED;\n}"
  },
  {
    "function_name": "xfs_efd_item_unpin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "399-404",
    "snippet": "STATIC void\nxfs_efd_item_unpin(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\tremove)\n{\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efd_item_unpin(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\tremove)\n{\n}"
  },
  {
    "function_name": "xfs_efd_item_pin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "389-393",
    "snippet": "STATIC void\nxfs_efd_item_pin(\n\tstruct xfs_log_item\t*lip)\n{\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efd_item_pin(\n\tstruct xfs_log_item\t*lip)\n{\n}"
  },
  {
    "function_name": "xfs_efd_item_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "368-384",
    "snippet": "STATIC void\nxfs_efd_item_format(\n\tstruct xfs_log_item\t*lip,\n\tstruct xfs_log_vec\t*lv)\n{\n\tstruct xfs_efd_log_item\t*efdp = EFD_ITEM(lip);\n\tstruct xfs_log_iovec\t*vecp = NULL;\n\n\tASSERT(efdp->efd_next_extent == efdp->efd_format.efd_nextents);\n\n\tefdp->efd_format.efd_type = XFS_LI_EFD;\n\tefdp->efd_format.efd_size = 1;\n\n\txlog_copy_iovec(lv, &vecp, XLOG_REG_TYPE_EFD_FORMAT,\n\t\t\t&efdp->efd_format,\n\t\t\txfs_efd_item_sizeof(efdp));\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xlog_copy_iovec",
          "args": [
            "lv",
            "&vecp",
            "XLOG_REG_TYPE_EFD_FORMAT",
            "&efdp->efd_format",
            "xfs_efd_item_sizeof(efdp)"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "xlog_copy_iovec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_log.h",
          "lines": "74-84",
          "snippet": "static inline void *\nxlog_copy_iovec(struct xfs_log_vec *lv, struct xfs_log_iovec **vecp,\n\t\tuint type, void *data, int len)\n{\n\tvoid *buf;\n\n\tbuf = xlog_prepare_iovec(lv, vecp, type);\n\tmemcpy(buf, data, len);\n\txlog_finish_iovec(lv, *vecp, len);\n\treturn buf;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void *\nxlog_copy_iovec(struct xfs_log_vec *lv, struct xfs_log_iovec **vecp,\n\t\tuint type, void *data, int len)\n{\n\tvoid *buf;\n\n\tbuf = xlog_prepare_iovec(lv, vecp, type);\n\tmemcpy(buf, data, len);\n\txlog_finish_iovec(lv, *vecp, len);\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_efd_item_sizeof",
          "args": [
            "efdp"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efd_item_sizeof",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "343-349",
          "snippet": "static inline int\nxfs_efd_item_sizeof(\n\tstruct xfs_efd_log_item *efdp)\n{\n\treturn sizeof(xfs_efd_log_format_t) +\n\t       (efdp->efd_format.efd_nextents - 1) * sizeof(xfs_extent_t);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline int\nxfs_efd_item_sizeof(\n\tstruct xfs_efd_log_item *efdp)\n{\n\treturn sizeof(xfs_efd_log_format_t) +\n\t       (efdp->efd_format.efd_nextents - 1) * sizeof(xfs_extent_t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "efdp->efd_next_extent == efdp->efd_format.efd_nextents"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EFD_ITEM",
          "args": [
            "lip"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "EFD_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "324-327",
          "snippet": "static inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efd_item_format(\n\tstruct xfs_log_item\t*lip,\n\tstruct xfs_log_vec\t*lv)\n{\n\tstruct xfs_efd_log_item\t*efdp = EFD_ITEM(lip);\n\tstruct xfs_log_iovec\t*vecp = NULL;\n\n\tASSERT(efdp->efd_next_extent == efdp->efd_format.efd_nextents);\n\n\tefdp->efd_format.efd_type = XFS_LI_EFD;\n\tefdp->efd_format.efd_size = 1;\n\n\txlog_copy_iovec(lv, &vecp, XLOG_REG_TYPE_EFD_FORMAT,\n\t\t\t&efdp->efd_format,\n\t\t\txfs_efd_item_sizeof(efdp));\n}"
  },
  {
    "function_name": "xfs_efd_item_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "351-359",
    "snippet": "STATIC void\nxfs_efd_item_size(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\t*nvecs,\n\tint\t\t\t*nbytes)\n{\n\t*nvecs += 1;\n\t*nbytes += xfs_efd_item_sizeof(EFD_ITEM(lip));\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_efd_item_sizeof",
          "args": [
            "EFD_ITEM(lip)"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efd_item_sizeof",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "343-349",
          "snippet": "static inline int\nxfs_efd_item_sizeof(\n\tstruct xfs_efd_log_item *efdp)\n{\n\treturn sizeof(xfs_efd_log_format_t) +\n\t       (efdp->efd_format.efd_nextents - 1) * sizeof(xfs_extent_t);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline int\nxfs_efd_item_sizeof(\n\tstruct xfs_efd_log_item *efdp)\n{\n\treturn sizeof(xfs_efd_log_format_t) +\n\t       (efdp->efd_format.efd_nextents - 1) * sizeof(xfs_extent_t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EFD_ITEM",
          "args": [
            "lip"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "EFD_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "324-327",
          "snippet": "static inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efd_item_size(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\t*nvecs,\n\tint\t\t\t*nbytes)\n{\n\t*nvecs += 1;\n\t*nbytes += xfs_efd_item_sizeof(EFD_ITEM(lip));\n}"
  },
  {
    "function_name": "xfs_efd_item_sizeof",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "343-349",
    "snippet": "static inline int\nxfs_efd_item_sizeof(\n\tstruct xfs_efd_log_item *efdp)\n{\n\treturn sizeof(xfs_efd_log_format_t) +\n\t       (efdp->efd_format.efd_nextents - 1) * sizeof(xfs_extent_t);\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline int\nxfs_efd_item_sizeof(\n\tstruct xfs_efd_log_item *efdp)\n{\n\treturn sizeof(xfs_efd_log_format_t) +\n\t       (efdp->efd_format.efd_nextents - 1) * sizeof(xfs_extent_t);\n}"
  },
  {
    "function_name": "xfs_efd_item_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "329-336",
    "snippet": "STATIC void\nxfs_efd_item_free(struct xfs_efd_log_item *efdp)\n{\n\tif (efdp->efd_format.efd_nextents > XFS_EFD_MAX_FAST_EXTENTS)\n\t\tkmem_free(efdp);\n\telse\n\t\tkmem_zone_free(xfs_efd_zone, efdp);\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "kmem_zone_t\t*xfs_efd_zone;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_zone_free",
          "args": [
            "xfs_efd_zone",
            "efdp"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_zone_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.h",
          "lines": "104-108",
          "snippet": "static inline void\nkmem_zone_free(kmem_zone_t *zone, void *ptr)\n{\n\tkmem_cache_free(zone, ptr);\n}",
          "includes": [
            "#include <linux/vmalloc.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define kmem_zone_t\tstruct kmem_cache"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/vmalloc.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n\n#define kmem_zone_t\tstruct kmem_cache\n\nstatic inline void\nkmem_zone_free(kmem_zone_t *zone, void *ptr)\n{\n\tkmem_cache_free(zone, ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_free",
          "args": [
            "efdp"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.h",
          "lines": "66-69",
          "snippet": "static inline void  kmem_free(const void *ptr)\n{\n\tkvfree(ptr);\n}",
          "includes": [
            "#include <linux/vmalloc.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/vmalloc.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n\nstatic inline void  kmem_free(const void *ptr)\n{\n\tkvfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efd_zone;\n\nSTATIC void\nxfs_efd_item_free(struct xfs_efd_log_item *efdp)\n{\n\tif (efdp->efd_format.efd_nextents > XFS_EFD_MAX_FAST_EXTENTS)\n\t\tkmem_free(efdp);\n\telse\n\t\tkmem_zone_free(xfs_efd_zone, efdp);\n}"
  },
  {
    "function_name": "EFD_ITEM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "324-327",
    "snippet": "static inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "lip",
            "structxfs_efd_log_item",
            "efd_item"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efd_log_item *EFD_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efd_log_item, efd_item);\n}"
  },
  {
    "function_name": "xfs_efi_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "309-322",
    "snippet": "void\nxfs_efi_release(xfs_efi_log_item_t\t*efip,\n\t\tuint\t\t\tnextents)\n{\n\tASSERT(atomic_read(&efip->efi_next_extent) >= nextents);\n\tif (atomic_sub_and_test(nextents, &efip->efi_next_extent)) {\n\t\t/* recovery needs us to drop the EFI reference, too */\n\t\tif (test_bit(XFS_EFI_RECOVERED, &efip->efi_flags))\n\t\t\t__xfs_efi_release(efip);\n\n\t\t__xfs_efi_release(efip);\n\t\t/* efip may now have been freed, do not reference it again. */\n\t}\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__xfs_efi_release",
          "args": [
            "efip"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "__xfs_efi_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "56-69",
          "snippet": "STATIC void\n__xfs_efi_release(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tstruct xfs_ail\t\t*ailp = efip->efi_item.li_ailp;\n\n\tif (atomic_dec_and_test(&efip->efi_refcount)) {\n\t\tspin_lock(&ailp->xa_lock);\n\t\t/* xfs_trans_ail_delete() drops the AIL lock. */\n\t\txfs_trans_ail_delete(ailp, &efip->efi_item,\n\t\t\t\t     SHUTDOWN_LOG_IO_ERROR);\n\t\txfs_efi_item_free(efip);\n\t}\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\n__xfs_efi_release(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tstruct xfs_ail\t\t*ailp = efip->efi_item.li_ailp;\n\n\tif (atomic_dec_and_test(&efip->efi_refcount)) {\n\t\tspin_lock(&ailp->xa_lock);\n\t\t/* xfs_trans_ail_delete() drops the AIL lock. */\n\t\txfs_trans_ail_delete(ailp, &efip->efi_item,\n\t\t\t\t     SHUTDOWN_LOG_IO_ERROR);\n\t\txfs_efi_item_free(efip);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "XFS_EFI_RECOVERED",
            "&efip->efi_flags"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_sub_and_test",
          "args": [
            "nextents",
            "&efip->efi_next_extent"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "atomic_read(&efip->efi_next_extent) >= nextents"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&efip->efi_next_extent"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nvoid\nxfs_efi_release(xfs_efi_log_item_t\t*efip,\n\t\tuint\t\t\tnextents)\n{\n\tASSERT(atomic_read(&efip->efi_next_extent) >= nextents);\n\tif (atomic_sub_and_test(nextents, &efip->efi_next_extent)) {\n\t\t/* recovery needs us to drop the EFI reference, too */\n\t\tif (test_bit(XFS_EFI_RECOVERED, &efip->efi_flags))\n\t\t\t__xfs_efi_release(efip);\n\n\t\t__xfs_efi_release(efip);\n\t\t/* efip may now have been freed, do not reference it again. */\n\t}\n}"
  },
  {
    "function_name": "xfs_efi_copy_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "256-301",
    "snippet": "int\nxfs_efi_copy_format(xfs_log_iovec_t *buf, xfs_efi_log_format_t *dst_efi_fmt)\n{\n\txfs_efi_log_format_t *src_efi_fmt = buf->i_addr;\n\tuint i;\n\tuint len = sizeof(xfs_efi_log_format_t) + \n\t\t(src_efi_fmt->efi_nextents - 1) * sizeof(xfs_extent_t);  \n\tuint len32 = sizeof(xfs_efi_log_format_32_t) + \n\t\t(src_efi_fmt->efi_nextents - 1) * sizeof(xfs_extent_32_t);  \n\tuint len64 = sizeof(xfs_efi_log_format_64_t) + \n\t\t(src_efi_fmt->efi_nextents - 1) * sizeof(xfs_extent_64_t);  \n\n\tif (buf->i_len == len) {\n\t\tmemcpy((char *)dst_efi_fmt, (char*)src_efi_fmt, len);\n\t\treturn 0;\n\t} else if (buf->i_len == len32) {\n\t\txfs_efi_log_format_32_t *src_efi_fmt_32 = buf->i_addr;\n\n\t\tdst_efi_fmt->efi_type     = src_efi_fmt_32->efi_type;\n\t\tdst_efi_fmt->efi_size     = src_efi_fmt_32->efi_size;\n\t\tdst_efi_fmt->efi_nextents = src_efi_fmt_32->efi_nextents;\n\t\tdst_efi_fmt->efi_id       = src_efi_fmt_32->efi_id;\n\t\tfor (i = 0; i < dst_efi_fmt->efi_nextents; i++) {\n\t\t\tdst_efi_fmt->efi_extents[i].ext_start =\n\t\t\t\tsrc_efi_fmt_32->efi_extents[i].ext_start;\n\t\t\tdst_efi_fmt->efi_extents[i].ext_len =\n\t\t\t\tsrc_efi_fmt_32->efi_extents[i].ext_len;\n\t\t}\n\t\treturn 0;\n\t} else if (buf->i_len == len64) {\n\t\txfs_efi_log_format_64_t *src_efi_fmt_64 = buf->i_addr;\n\n\t\tdst_efi_fmt->efi_type     = src_efi_fmt_64->efi_type;\n\t\tdst_efi_fmt->efi_size     = src_efi_fmt_64->efi_size;\n\t\tdst_efi_fmt->efi_nextents = src_efi_fmt_64->efi_nextents;\n\t\tdst_efi_fmt->efi_id       = src_efi_fmt_64->efi_id;\n\t\tfor (i = 0; i < dst_efi_fmt->efi_nextents; i++) {\n\t\t\tdst_efi_fmt->efi_extents[i].ext_start =\n\t\t\t\tsrc_efi_fmt_64->efi_extents[i].ext_start;\n\t\t\tdst_efi_fmt->efi_extents[i].ext_len =\n\t\t\t\tsrc_efi_fmt_64->efi_extents[i].ext_len;\n\t\t}\n\t\treturn 0;\n\t}\n\treturn -EFSCORRUPTED;\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(char *)dst_efi_fmt",
            "(char*)src_efi_fmt",
            "len"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nint\nxfs_efi_copy_format(xfs_log_iovec_t *buf, xfs_efi_log_format_t *dst_efi_fmt)\n{\n\txfs_efi_log_format_t *src_efi_fmt = buf->i_addr;\n\tuint i;\n\tuint len = sizeof(xfs_efi_log_format_t) + \n\t\t(src_efi_fmt->efi_nextents - 1) * sizeof(xfs_extent_t);  \n\tuint len32 = sizeof(xfs_efi_log_format_32_t) + \n\t\t(src_efi_fmt->efi_nextents - 1) * sizeof(xfs_extent_32_t);  \n\tuint len64 = sizeof(xfs_efi_log_format_64_t) + \n\t\t(src_efi_fmt->efi_nextents - 1) * sizeof(xfs_extent_64_t);  \n\n\tif (buf->i_len == len) {\n\t\tmemcpy((char *)dst_efi_fmt, (char*)src_efi_fmt, len);\n\t\treturn 0;\n\t} else if (buf->i_len == len32) {\n\t\txfs_efi_log_format_32_t *src_efi_fmt_32 = buf->i_addr;\n\n\t\tdst_efi_fmt->efi_type     = src_efi_fmt_32->efi_type;\n\t\tdst_efi_fmt->efi_size     = src_efi_fmt_32->efi_size;\n\t\tdst_efi_fmt->efi_nextents = src_efi_fmt_32->efi_nextents;\n\t\tdst_efi_fmt->efi_id       = src_efi_fmt_32->efi_id;\n\t\tfor (i = 0; i < dst_efi_fmt->efi_nextents; i++) {\n\t\t\tdst_efi_fmt->efi_extents[i].ext_start =\n\t\t\t\tsrc_efi_fmt_32->efi_extents[i].ext_start;\n\t\t\tdst_efi_fmt->efi_extents[i].ext_len =\n\t\t\t\tsrc_efi_fmt_32->efi_extents[i].ext_len;\n\t\t}\n\t\treturn 0;\n\t} else if (buf->i_len == len64) {\n\t\txfs_efi_log_format_64_t *src_efi_fmt_64 = buf->i_addr;\n\n\t\tdst_efi_fmt->efi_type     = src_efi_fmt_64->efi_type;\n\t\tdst_efi_fmt->efi_size     = src_efi_fmt_64->efi_size;\n\t\tdst_efi_fmt->efi_nextents = src_efi_fmt_64->efi_nextents;\n\t\tdst_efi_fmt->efi_id       = src_efi_fmt_64->efi_id;\n\t\tfor (i = 0; i < dst_efi_fmt->efi_nextents; i++) {\n\t\t\tdst_efi_fmt->efi_extents[i].ext_start =\n\t\t\t\tsrc_efi_fmt_64->efi_extents[i].ext_start;\n\t\t\tdst_efi_fmt->efi_extents[i].ext_len =\n\t\t\t\tsrc_efi_fmt_64->efi_extents[i].ext_len;\n\t\t}\n\t\treturn 0;\n\t}\n\treturn -EFSCORRUPTED;\n}"
  },
  {
    "function_name": "xfs_efi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "222-247",
    "snippet": "struct xfs_efi_log_item *\nxfs_efi_init(\n\tstruct xfs_mount\t*mp,\n\tuint\t\t\tnextents)\n\n{\n\tstruct xfs_efi_log_item\t*efip;\n\tuint\t\t\tsize;\n\n\tASSERT(nextents > 0);\n\tif (nextents > XFS_EFI_MAX_FAST_EXTENTS) {\n\t\tsize = (uint)(sizeof(xfs_efi_log_item_t) +\n\t\t\t((nextents - 1) * sizeof(xfs_extent_t)));\n\t\tefip = kmem_zalloc(size, KM_SLEEP);\n\t} else {\n\t\tefip = kmem_zone_zalloc(xfs_efi_zone, KM_SLEEP);\n\t}\n\n\txfs_log_item_init(mp, &efip->efi_item, XFS_LI_EFI, &xfs_efi_item_ops);\n\tefip->efi_format.efi_nextents = nextents;\n\tefip->efi_format.efi_id = (__psint_t)(void*)efip;\n\tatomic_set(&efip->efi_next_extent, 0);\n\tatomic_set(&efip->efi_refcount, 2);\n\n\treturn efip;\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "kmem_zone_t\t*xfs_efi_zone;",
      "static const struct xfs_item_ops xfs_efi_item_ops = {\n\t.iop_size\t= xfs_efi_item_size,\n\t.iop_format\t= xfs_efi_item_format,\n\t.iop_pin\t= xfs_efi_item_pin,\n\t.iop_unpin\t= xfs_efi_item_unpin,\n\t.iop_unlock\t= xfs_efi_item_unlock,\n\t.iop_committed\t= xfs_efi_item_committed,\n\t.iop_push\t= xfs_efi_item_push,\n\t.iop_committing = xfs_efi_item_committing\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&efip->efi_refcount",
            "2"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&efip->efi_next_extent",
            "0"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfs_log_item_init",
          "args": [
            "mp",
            "&efip->efi_item",
            "XFS_LI_EFI",
            "&xfs_efi_item_ops"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_log_item_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_log.c",
          "lines": "961-976",
          "snippet": "void\nxfs_log_item_init(\n\tstruct xfs_mount\t*mp,\n\tstruct xfs_log_item\t*item,\n\tint\t\t\ttype,\n\tconst struct xfs_item_ops *ops)\n{\n\titem->li_mountp = mp;\n\titem->li_ailp = mp->m_ail;\n\titem->li_type = type;\n\titem->li_ops = ops;\n\titem->li_lv = NULL;\n\n\tINIT_LIST_HEAD(&item->li_ail);\n\tINIT_LIST_HEAD(&item->li_cil);\n}",
          "includes": [
            "#include \"xfs_sb.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs_cksum.h\"",
            "#include \"xfs_fsops.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_log_recover.h\"",
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_error.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "STATIC struct",
            "STATIC struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_sb.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs_cksum.h\"\n#include \"xfs_fsops.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_log_recover.h\"\n#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_error.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC struct;\nSTATIC struct;\n\nvoid\nxfs_log_item_init(\n\tstruct xfs_mount\t*mp,\n\tstruct xfs_log_item\t*item,\n\tint\t\t\ttype,\n\tconst struct xfs_item_ops *ops)\n{\n\titem->li_mountp = mp;\n\titem->li_ailp = mp->m_ail;\n\titem->li_type = type;\n\titem->li_ops = ops;\n\titem->li_lv = NULL;\n\n\tINIT_LIST_HEAD(&item->li_ail);\n\tINIT_LIST_HEAD(&item->li_cil);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_zone_zalloc",
          "args": [
            "xfs_efi_zone",
            "KM_SLEEP"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_zone_zalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.h",
          "lines": "119-123",
          "snippet": "static inline void *\nkmem_zone_zalloc(kmem_zone_t *zone, xfs_km_flags_t flags)\n{\n\treturn kmem_zone_alloc(zone, flags | KM_ZERO);\n}",
          "includes": [
            "#include <linux/vmalloc.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define kmem_zone_t\tstruct kmem_cache",
            "#define KM_ZERO\t\t((__force xfs_km_flags_t)0x0010u)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/vmalloc.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n\n#define kmem_zone_t\tstruct kmem_cache\n#define KM_ZERO\t\t((__force xfs_km_flags_t)0x0010u)\n\nstatic inline void *\nkmem_zone_zalloc(kmem_zone_t *zone, xfs_km_flags_t flags)\n{\n\treturn kmem_zone_alloc(zone, flags | KM_ZERO);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_zalloc",
          "args": [
            "size",
            "KM_SLEEP"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_zalloc_large",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.c",
          "lines": "64-92",
          "snippet": "void *\nkmem_zalloc_large(size_t size, xfs_km_flags_t flags)\n{\n\tunsigned noio_flag = 0;\n\tvoid\t*ptr;\n\tgfp_t\tlflags;\n\n\tptr = kmem_zalloc(size, flags | KM_MAYFAIL);\n\tif (ptr)\n\t\treturn ptr;\n\n\t/*\n\t * __vmalloc() will allocate data pages and auxillary structures (e.g.\n\t * pagetables) with GFP_KERNEL, yet we may be under GFP_NOFS context\n\t * here. Hence we need to tell memory reclaim that we are in such a\n\t * context via PF_MEMALLOC_NOIO to prevent memory reclaim re-entering\n\t * the filesystem here and potentially deadlocking.\n\t */\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tnoio_flag = memalloc_noio_save();\n\n\tlflags = kmem_flags_convert(flags);\n\tptr = __vmalloc(size, lflags | __GFP_HIGHMEM | __GFP_ZERO, PAGE_KERNEL);\n\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tmemalloc_noio_restore(noio_flag);\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"xfs_message.h\"",
            "#include \"kmem.h\"",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_message.h\"\n#include \"kmem.h\"\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nvoid *\nkmem_zalloc_large(size_t size, xfs_km_flags_t flags)\n{\n\tunsigned noio_flag = 0;\n\tvoid\t*ptr;\n\tgfp_t\tlflags;\n\n\tptr = kmem_zalloc(size, flags | KM_MAYFAIL);\n\tif (ptr)\n\t\treturn ptr;\n\n\t/*\n\t * __vmalloc() will allocate data pages and auxillary structures (e.g.\n\t * pagetables) with GFP_KERNEL, yet we may be under GFP_NOFS context\n\t * here. Hence we need to tell memory reclaim that we are in such a\n\t * context via PF_MEMALLOC_NOIO to prevent memory reclaim re-entering\n\t * the filesystem here and potentially deadlocking.\n\t */\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tnoio_flag = memalloc_noio_save();\n\n\tlflags = kmem_flags_convert(flags);\n\tptr = __vmalloc(size, lflags | __GFP_HIGHMEM | __GFP_ZERO, PAGE_KERNEL);\n\n\tif ((current->flags & PF_FSTRANS) || (flags & KM_NOFS))\n\t\tmemalloc_noio_restore(noio_flag);\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sizeof(xfs_efi_log_item_t) +\n\t\t\t((nextents - 1) * sizeof(xfs_extent_t))"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "nextents > 0"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efi_zone;\nstatic const struct xfs_item_ops xfs_efi_item_ops = {\n\t.iop_size\t= xfs_efi_item_size,\n\t.iop_format\t= xfs_efi_item_format,\n\t.iop_pin\t= xfs_efi_item_pin,\n\t.iop_unpin\t= xfs_efi_item_unpin,\n\t.iop_unlock\t= xfs_efi_item_unlock,\n\t.iop_committed\t= xfs_efi_item_committed,\n\t.iop_push\t= xfs_efi_item_push,\n\t.iop_committing = xfs_efi_item_committing\n};\n\nstruct xfs_efi_log_item *\nxfs_efi_init(\n\tstruct xfs_mount\t*mp,\n\tuint\t\t\tnextents)\n\n{\n\tstruct xfs_efi_log_item\t*efip;\n\tuint\t\t\tsize;\n\n\tASSERT(nextents > 0);\n\tif (nextents > XFS_EFI_MAX_FAST_EXTENTS) {\n\t\tsize = (uint)(sizeof(xfs_efi_log_item_t) +\n\t\t\t((nextents - 1) * sizeof(xfs_extent_t)));\n\t\tefip = kmem_zalloc(size, KM_SLEEP);\n\t} else {\n\t\tefip = kmem_zone_zalloc(xfs_efi_zone, KM_SLEEP);\n\t}\n\n\txfs_log_item_init(mp, &efip->efi_item, XFS_LI_EFI, &xfs_efi_item_ops);\n\tefip->efi_format.efi_nextents = nextents;\n\tefip->efi_format.efi_id = (__psint_t)(void*)efip;\n\tatomic_set(&efip->efi_next_extent, 0);\n\tatomic_set(&efip->efi_refcount, 2);\n\n\treturn efip;\n}"
  },
  {
    "function_name": "xfs_efi_item_committing",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "197-202",
    "snippet": "STATIC void\nxfs_efi_item_committing(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efi_item_committing(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n}"
  },
  {
    "function_name": "xfs_efi_item_committed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "182-188",
    "snippet": "STATIC xfs_lsn_t\nxfs_efi_item_committed(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n\treturn lsn;\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC xfs_lsn_t\nxfs_efi_item_committed(\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn)\n{\n\treturn lsn;\n}"
  },
  {
    "function_name": "xfs_efi_item_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "170-176",
    "snippet": "STATIC void\nxfs_efi_item_unlock(\n\tstruct xfs_log_item\t*lip)\n{\n\tif (lip->li_flags & XFS_LI_ABORTED)\n\t\txfs_efi_item_free(EFI_ITEM(lip));\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_efi_item_free",
          "args": [
            "EFI_ITEM(lip)"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efi_item_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "39-47",
          "snippet": "void\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kmem_zone_t\t*xfs_efi_zone;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efi_zone;\n\nvoid\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EFI_ITEM",
          "args": [
            "lip"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "EFI_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "34-37",
          "snippet": "static inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efi_item_unlock(\n\tstruct xfs_log_item\t*lip)\n{\n\tif (lip->li_flags & XFS_LI_ABORTED)\n\t\txfs_efi_item_free(EFI_ITEM(lip));\n}"
  },
  {
    "function_name": "xfs_efi_item_push",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "162-168",
    "snippet": "STATIC uint\nxfs_efi_item_push(\n\tstruct xfs_log_item\t*lip,\n\tstruct list_head\t*buffer_list)\n{\n\treturn XFS_ITEM_PINNED;\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC uint\nxfs_efi_item_push(\n\tstruct xfs_log_item\t*lip,\n\tstruct list_head\t*buffer_list)\n{\n\treturn XFS_ITEM_PINNED;\n}"
  },
  {
    "function_name": "xfs_efi_item_unpin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "138-153",
    "snippet": "STATIC void\nxfs_efi_item_unpin(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\tremove)\n{\n\tstruct xfs_efi_log_item\t*efip = EFI_ITEM(lip);\n\n\tif (remove) {\n\t\tASSERT(!(lip->li_flags & XFS_LI_IN_AIL));\n\t\tif (lip->li_desc)\n\t\t\txfs_trans_del_item(lip);\n\t\txfs_efi_item_free(efip);\n\t\treturn;\n\t}\n\t__xfs_efi_release(efip);\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__xfs_efi_release",
          "args": [
            "efip"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "__xfs_efi_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "56-69",
          "snippet": "STATIC void\n__xfs_efi_release(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tstruct xfs_ail\t\t*ailp = efip->efi_item.li_ailp;\n\n\tif (atomic_dec_and_test(&efip->efi_refcount)) {\n\t\tspin_lock(&ailp->xa_lock);\n\t\t/* xfs_trans_ail_delete() drops the AIL lock. */\n\t\txfs_trans_ail_delete(ailp, &efip->efi_item,\n\t\t\t\t     SHUTDOWN_LOG_IO_ERROR);\n\t\txfs_efi_item_free(efip);\n\t}\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\n__xfs_efi_release(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tstruct xfs_ail\t\t*ailp = efip->efi_item.li_ailp;\n\n\tif (atomic_dec_and_test(&efip->efi_refcount)) {\n\t\tspin_lock(&ailp->xa_lock);\n\t\t/* xfs_trans_ail_delete() drops the AIL lock. */\n\t\txfs_trans_ail_delete(ailp, &efip->efi_item,\n\t\t\t\t     SHUTDOWN_LOG_IO_ERROR);\n\t\txfs_efi_item_free(efip);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_efi_item_free",
          "args": [
            "efip"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efi_item_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "39-47",
          "snippet": "void\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kmem_zone_t\t*xfs_efi_zone;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efi_zone;\n\nvoid\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_trans_del_item",
          "args": [
            "lip"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_trans_del_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_trans.c",
          "lines": "681-687",
          "snippet": "void\nxfs_trans_del_item(\n\tstruct xfs_log_item\t*lip)\n{\n\txfs_trans_free_item_desc(lip->li_desc);\n\tlip->li_desc = NULL;\n}",
          "includes": [
            "#include \"xfs_error.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_quota.h\"",
            "#include \"xfs_extent_busy.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_error.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_log.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_quota.h\"\n#include \"xfs_extent_busy.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nvoid\nxfs_trans_del_item(\n\tstruct xfs_log_item\t*lip)\n{\n\txfs_trans_free_item_desc(lip->li_desc);\n\tlip->li_desc = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "!(lip->li_flags & XFS_LI_IN_AIL)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EFI_ITEM",
          "args": [
            "lip"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "EFI_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "34-37",
          "snippet": "static inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efi_item_unpin(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\tremove)\n{\n\tstruct xfs_efi_log_item\t*efip = EFI_ITEM(lip);\n\n\tif (remove) {\n\t\tASSERT(!(lip->li_flags & XFS_LI_IN_AIL));\n\t\tif (lip->li_desc)\n\t\t\txfs_trans_del_item(lip);\n\t\txfs_efi_item_free(efip);\n\t\treturn;\n\t}\n\t__xfs_efi_release(efip);\n}"
  },
  {
    "function_name": "xfs_efi_item_pin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "124-128",
    "snippet": "STATIC void\nxfs_efi_item_pin(\n\tstruct xfs_log_item\t*lip)\n{\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efi_item_pin(\n\tstruct xfs_log_item\t*lip)\n{\n}"
  },
  {
    "function_name": "xfs_efi_item_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "101-118",
    "snippet": "STATIC void\nxfs_efi_item_format(\n\tstruct xfs_log_item\t*lip,\n\tstruct xfs_log_vec\t*lv)\n{\n\tstruct xfs_efi_log_item\t*efip = EFI_ITEM(lip);\n\tstruct xfs_log_iovec\t*vecp = NULL;\n\n\tASSERT(atomic_read(&efip->efi_next_extent) ==\n\t\t\t\tefip->efi_format.efi_nextents);\n\n\tefip->efi_format.efi_type = XFS_LI_EFI;\n\tefip->efi_format.efi_size = 1;\n\n\txlog_copy_iovec(lv, &vecp, XLOG_REG_TYPE_EFI_FORMAT,\n\t\t\t&efip->efi_format,\n\t\t\txfs_efi_item_sizeof(efip));\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xlog_copy_iovec",
          "args": [
            "lv",
            "&vecp",
            "XLOG_REG_TYPE_EFI_FORMAT",
            "&efip->efi_format",
            "xfs_efi_item_sizeof(efip)"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "xlog_copy_iovec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_log.h",
          "lines": "74-84",
          "snippet": "static inline void *\nxlog_copy_iovec(struct xfs_log_vec *lv, struct xfs_log_iovec **vecp,\n\t\tuint type, void *data, int len)\n{\n\tvoid *buf;\n\n\tbuf = xlog_prepare_iovec(lv, vecp, type);\n\tmemcpy(buf, data, len);\n\txlog_finish_iovec(lv, *vecp, len);\n\treturn buf;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void *\nxlog_copy_iovec(struct xfs_log_vec *lv, struct xfs_log_iovec **vecp,\n\t\tuint type, void *data, int len)\n{\n\tvoid *buf;\n\n\tbuf = xlog_prepare_iovec(lv, vecp, type);\n\tmemcpy(buf, data, len);\n\txlog_finish_iovec(lv, *vecp, len);\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_efi_item_sizeof",
          "args": [
            "efip"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efi_item_sizeof",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "76-82",
          "snippet": "static inline int\nxfs_efi_item_sizeof(\n\tstruct xfs_efi_log_item *efip)\n{\n\treturn sizeof(struct xfs_efi_log_format) +\n\t       (efip->efi_format.efi_nextents - 1) * sizeof(xfs_extent_t);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline int\nxfs_efi_item_sizeof(\n\tstruct xfs_efi_log_item *efip)\n{\n\treturn sizeof(struct xfs_efi_log_format) +\n\t       (efip->efi_format.efi_nextents - 1) * sizeof(xfs_extent_t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "atomic_read(&efip->efi_next_extent) ==\n\t\t\t\tefip->efi_format.efi_nextents"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&efip->efi_next_extent"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EFI_ITEM",
          "args": [
            "lip"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "EFI_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "34-37",
          "snippet": "static inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efi_item_format(\n\tstruct xfs_log_item\t*lip,\n\tstruct xfs_log_vec\t*lv)\n{\n\tstruct xfs_efi_log_item\t*efip = EFI_ITEM(lip);\n\tstruct xfs_log_iovec\t*vecp = NULL;\n\n\tASSERT(atomic_read(&efip->efi_next_extent) ==\n\t\t\t\tefip->efi_format.efi_nextents);\n\n\tefip->efi_format.efi_type = XFS_LI_EFI;\n\tefip->efi_format.efi_size = 1;\n\n\txlog_copy_iovec(lv, &vecp, XLOG_REG_TYPE_EFI_FORMAT,\n\t\t\t&efip->efi_format,\n\t\t\txfs_efi_item_sizeof(efip));\n}"
  },
  {
    "function_name": "xfs_efi_item_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "84-92",
    "snippet": "STATIC void\nxfs_efi_item_size(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\t*nvecs,\n\tint\t\t\t*nbytes)\n{\n\t*nvecs += 1;\n\t*nbytes += xfs_efi_item_sizeof(EFI_ITEM(lip));\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_efi_item_sizeof",
          "args": [
            "EFI_ITEM(lip)"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efi_item_sizeof",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "76-82",
          "snippet": "static inline int\nxfs_efi_item_sizeof(\n\tstruct xfs_efi_log_item *efip)\n{\n\treturn sizeof(struct xfs_efi_log_format) +\n\t       (efip->efi_format.efi_nextents - 1) * sizeof(xfs_extent_t);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline int\nxfs_efi_item_sizeof(\n\tstruct xfs_efi_log_item *efip)\n{\n\treturn sizeof(struct xfs_efi_log_format) +\n\t       (efip->efi_format.efi_nextents - 1) * sizeof(xfs_extent_t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EFI_ITEM",
          "args": [
            "lip"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "EFI_ITEM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "34-37",
          "snippet": "static inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\nxfs_efi_item_size(\n\tstruct xfs_log_item\t*lip,\n\tint\t\t\t*nvecs,\n\tint\t\t\t*nbytes)\n{\n\t*nvecs += 1;\n\t*nbytes += xfs_efi_item_sizeof(EFI_ITEM(lip));\n}"
  },
  {
    "function_name": "xfs_efi_item_sizeof",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "76-82",
    "snippet": "static inline int\nxfs_efi_item_sizeof(\n\tstruct xfs_efi_log_item *efip)\n{\n\treturn sizeof(struct xfs_efi_log_format) +\n\t       (efip->efi_format.efi_nextents - 1) * sizeof(xfs_extent_t);\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline int\nxfs_efi_item_sizeof(\n\tstruct xfs_efi_log_item *efip)\n{\n\treturn sizeof(struct xfs_efi_log_format) +\n\t       (efip->efi_format.efi_nextents - 1) * sizeof(xfs_extent_t);\n}"
  },
  {
    "function_name": "__xfs_efi_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "56-69",
    "snippet": "STATIC void\n__xfs_efi_release(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tstruct xfs_ail\t\t*ailp = efip->efi_item.li_ailp;\n\n\tif (atomic_dec_and_test(&efip->efi_refcount)) {\n\t\tspin_lock(&ailp->xa_lock);\n\t\t/* xfs_trans_ail_delete() drops the AIL lock. */\n\t\txfs_trans_ail_delete(ailp, &efip->efi_item,\n\t\t\t\t     SHUTDOWN_LOG_IO_ERROR);\n\t\txfs_efi_item_free(efip);\n\t}\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_efi_item_free",
          "args": [
            "efip"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_efi_item_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
          "lines": "39-47",
          "snippet": "void\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans_priv.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_fs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kmem_zone_t\t*xfs_efi_zone;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efi_zone;\n\nvoid\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_trans_ail_delete",
          "args": [
            "ailp",
            "&efip->efi_item",
            "SHUTDOWN_LOG_IO_ERROR"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_trans_ail_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_trans_priv.h",
          "lines": "113-120",
          "snippet": "static inline void\nxfs_trans_ail_delete(\n\tstruct xfs_ail\t*ailp,\n\txfs_log_item_t\t*lip,\n\tint\t\tshutdown_type) __releases(ailp->xa_lock)\n{\n\txfs_trans_ail_delete_bulk(ailp, &lip, 1, shutdown_type);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\nxfs_trans_ail_delete(\n\tstruct xfs_ail\t*ailp,\n\txfs_log_item_t\t*lip,\n\tint\t\tshutdown_type) __releases(ailp->xa_lock)\n{\n\txfs_trans_ail_delete_bulk(ailp, &lip, 1, shutdown_type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ailp->xa_lock"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&efip->efi_refcount"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nSTATIC void\n__xfs_efi_release(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tstruct xfs_ail\t\t*ailp = efip->efi_item.li_ailp;\n\n\tif (atomic_dec_and_test(&efip->efi_refcount)) {\n\t\tspin_lock(&ailp->xa_lock);\n\t\t/* xfs_trans_ail_delete() drops the AIL lock. */\n\t\txfs_trans_ail_delete(ailp, &efip->efi_item,\n\t\t\t\t     SHUTDOWN_LOG_IO_ERROR);\n\t\txfs_efi_item_free(efip);\n\t}\n}"
  },
  {
    "function_name": "xfs_efi_item_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "39-47",
    "snippet": "void\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "kmem_zone_t\t*xfs_efi_zone;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_zone_free",
          "args": [
            "xfs_efi_zone",
            "efip"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_zone_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.h",
          "lines": "104-108",
          "snippet": "static inline void\nkmem_zone_free(kmem_zone_t *zone, void *ptr)\n{\n\tkmem_cache_free(zone, ptr);\n}",
          "includes": [
            "#include <linux/vmalloc.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define kmem_zone_t\tstruct kmem_cache"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/vmalloc.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n\n#define kmem_zone_t\tstruct kmem_cache\n\nstatic inline void\nkmem_zone_free(kmem_zone_t *zone, void *ptr)\n{\n\tkmem_cache_free(zone, ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_free",
          "args": [
            "efip"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/kmem.h",
          "lines": "66-69",
          "snippet": "static inline void  kmem_free(const void *ptr)\n{\n\tkvfree(ptr);\n}",
          "includes": [
            "#include <linux/vmalloc.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/vmalloc.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n\nstatic inline void  kmem_free(const void *ptr)\n{\n\tkvfree(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nkmem_zone_t\t*xfs_efi_zone;\n\nvoid\nxfs_efi_item_free(\n\tstruct xfs_efi_log_item\t*efip)\n{\n\tif (efip->efi_format.efi_nextents > XFS_EFI_MAX_FAST_EXTENTS)\n\t\tkmem_free(efip);\n\telse\n\t\tkmem_zone_free(xfs_efi_zone, efip);\n}"
  },
  {
    "function_name": "EFI_ITEM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_extfree_item.c",
    "lines": "34-37",
    "snippet": "static inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}",
    "includes": [
      "#include \"xfs_log.h\"",
      "#include \"xfs_extfree_item.h\"",
      "#include \"xfs_buf_item.h\"",
      "#include \"xfs_trans_priv.h\"",
      "#include \"xfs_trans.h\"",
      "#include \"xfs_mount.h\"",
      "#include \"xfs_trans_resv.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_format.h\"",
      "#include \"xfs_fs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "lip",
            "structxfs_efi_log_item",
            "efi_item"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_fs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_efi_log_item *EFI_ITEM(struct xfs_log_item *lip)\n{\n\treturn container_of(lip, struct xfs_efi_log_item, efi_item);\n}"
  }
]