[
  {
    "function_name": "print_statistics",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "766-777",
    "snippet": "void print_statistics(struct super_block *s)\n{\n\n\t/*\n\t   printk (\"reiserfs_put_super: session statistics: balances %d, fix_nodes %d, \\\n\t   bmap with search %d, without %d, dir2ind %d, ind2dir %d\\n\",\n\t   REISERFS_SB(s)->s_do_balance, REISERFS_SB(s)->s_fix_nodes,\n\t   REISERFS_SB(s)->s_bmaps, REISERFS_SB(s)->s_bmaps_without_search,\n\t   REISERFS_SB(s)->s_direct2indirect, REISERFS_SB(s)->s_indirect2direct);\n\t */\n\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nvoid print_statistics(struct super_block *s)\n{\n\n\t/*\n\t   printk (\"reiserfs_put_super: session statistics: balances %d, fix_nodes %d, \\\n\t   bmap with search %d, without %d, dir2ind %d, ind2dir %d\\n\",\n\t   REISERFS_SB(s)->s_do_balance, REISERFS_SB(s)->s_fix_nodes,\n\t   REISERFS_SB(s)->s_bmaps, REISERFS_SB(s)->s_bmaps_without_search,\n\t   REISERFS_SB(s)->s_direct2indirect, REISERFS_SB(s)->s_indirect2direct);\n\t */\n\n}"
  },
  {
    "function_name": "check_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "759-764",
    "snippet": "void check_internal(struct buffer_head *bh)\n{\n\tif (!bh)\n\t\treturn;\n\tcheck_internal_block_head(bh);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_internal_block_head",
          "args": [
            "bh"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "check_internal_block_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "729-745",
          "snippet": "static void check_internal_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\n\tblkh = B_BLK_HEAD(bh);\n\tif (!(B_LEVEL(bh) > DISK_LEAF_NODE_LEVEL && B_LEVEL(bh) <= MAX_HEIGHT))\n\t\treiserfs_panic(NULL, \"vs-6025\", \"invalid level %z\", bh);\n\n\tif (B_NR_ITEMS(bh) > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6030\", \"invalid item number %z\", bh);\n\n\tif (B_FREE_SPACE(bh) !=\n\t    bh->b_size - BLKH_SIZE - KEY_SIZE * B_NR_ITEMS(bh) -\n\t    DC_SIZE * (B_NR_ITEMS(bh) + 1))\n\t\treiserfs_panic(NULL, \"vs-6040\", \"invalid free space %z\", bh);\n\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void check_internal_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\n\tblkh = B_BLK_HEAD(bh);\n\tif (!(B_LEVEL(bh) > DISK_LEAF_NODE_LEVEL && B_LEVEL(bh) <= MAX_HEIGHT))\n\t\treiserfs_panic(NULL, \"vs-6025\", \"invalid level %z\", bh);\n\n\tif (B_NR_ITEMS(bh) > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6030\", \"invalid item number %z\", bh);\n\n\tif (B_FREE_SPACE(bh) !=\n\t    bh->b_size - BLKH_SIZE - KEY_SIZE * B_NR_ITEMS(bh) -\n\t    DC_SIZE * (B_NR_ITEMS(bh) + 1))\n\t\treiserfs_panic(NULL, \"vs-6040\", \"invalid free space %z\", bh);\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nvoid check_internal(struct buffer_head *bh)\n{\n\tif (!bh)\n\t\treturn;\n\tcheck_internal_block_head(bh);\n}"
  },
  {
    "function_name": "check_leaf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "747-757",
    "snippet": "void check_leaf(struct buffer_head *bh)\n{\n\tint i;\n\tstruct item_head *ih;\n\n\tif (!bh)\n\t\treturn;\n\tcheck_leaf_block_head(bh);\n\tfor (i = 0, ih = item_head(bh, 0); i < B_NR_ITEMS(bh); i++, ih++)\n\t\top_check_item(ih, ih_item_body(bh, ih));\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "op_check_item",
          "args": [
            "ih",
            "ih_item_body(bh, ih)"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_item_body",
          "args": [
            "bh",
            "ih"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "ih_item_body",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "2213-2217",
          "snippet": "static inline void *ih_item_body(const struct buffer_head *bh,\n\t\t\t\t const struct item_head *ih)\n{\n\treturn bh->b_data + ih_location(ih);\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void reiserfs_free_jh(struct buffer_head *bh);",
            "int reiserfs_add_tail_list(struct inode *inode, struct buffer_head *bh);",
            "int reiserfs_add_ordered_list(struct inode *inode, struct buffer_head *bh);",
            "int journal_mark_dirty(struct reiserfs_transaction_handle *,\n\t\t       struct buffer_head *bh);",
            "void reiserfs_restore_prepared_buffer(struct super_block *,\n\t\t\t\t      struct buffer_head *bh);",
            "int B_IS_IN_TREE(const struct buffer_head *);",
            "extern void decrement_bcount(struct buffer_head *bh);",
            "void reiserfs_unmap_buffer(struct buffer_head *);",
            "void print_block(struct buffer_head *bh, ...);",
            "void check_leaf(struct buffer_head *bh);",
            "void check_internal(struct buffer_head *bh);",
            "int balance_internal(struct tree_balance *, int, int, struct item_head *,\n\t\t     struct buffer_head **);",
            "void reiserfs_invalidate_buffer(struct tree_balance *tb,\n\t\t\t\tstruct buffer_head *bh);",
            "void replace_key(struct tree_balance *tb, struct buffer_head *, int,\n\t\t struct buffer_head *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nvoid reiserfs_free_jh(struct buffer_head *bh);\nint reiserfs_add_tail_list(struct inode *inode, struct buffer_head *bh);\nint reiserfs_add_ordered_list(struct inode *inode, struct buffer_head *bh);\nint journal_mark_dirty(struct reiserfs_transaction_handle *,\n\t\t       struct buffer_head *bh);\nvoid reiserfs_restore_prepared_buffer(struct super_block *,\n\t\t\t\t      struct buffer_head *bh);\nint B_IS_IN_TREE(const struct buffer_head *);\nextern void decrement_bcount(struct buffer_head *bh);\nvoid reiserfs_unmap_buffer(struct buffer_head *);\nvoid print_block(struct buffer_head *bh, ...);\nvoid check_leaf(struct buffer_head *bh);\nvoid check_internal(struct buffer_head *bh);\nint balance_internal(struct tree_balance *, int, int, struct item_head *,\n\t\t     struct buffer_head **);\nvoid reiserfs_invalidate_buffer(struct tree_balance *tb,\n\t\t\t\tstruct buffer_head *bh);\nvoid replace_key(struct tree_balance *tb, struct buffer_head *, int,\n\t\t struct buffer_head *, int);\n\nstatic inline void *ih_item_body(const struct buffer_head *bh,\n\t\t\t\t const struct item_head *ih)\n{\n\treturn bh->b_data + ih_location(ih);\n}"
        }
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item_head",
          "args": [
            "bh",
            "0"
          ],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_item_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "112-123",
          "snippet": "static void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_leaf_block_head",
          "args": [
            "bh"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "check_leaf_block_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "713-727",
          "snippet": "static void check_leaf_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\tint nr;\n\n\tblkh = B_BLK_HEAD(bh);\n\tnr = blkh_nr_item(blkh);\n\tif (nr > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6010\", \"invalid item number %z\",\n\t\t\t       bh);\n\tif (blkh_free_space(blkh) > bh->b_size - BLKH_SIZE - IH_SIZE * nr)\n\t\treiserfs_panic(NULL, \"vs-6020\", \"invalid free space %z\",\n\t\t\t       bh);\n\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void check_leaf_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\tint nr;\n\n\tblkh = B_BLK_HEAD(bh);\n\tnr = blkh_nr_item(blkh);\n\tif (nr > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6010\", \"invalid item number %z\",\n\t\t\t       bh);\n\tif (blkh_free_space(blkh) > bh->b_size - BLKH_SIZE - IH_SIZE * nr)\n\t\treiserfs_panic(NULL, \"vs-6020\", \"invalid free space %z\",\n\t\t\t       bh);\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nvoid check_leaf(struct buffer_head *bh)\n{\n\tint i;\n\tstruct item_head *ih;\n\n\tif (!bh)\n\t\treturn;\n\tcheck_leaf_block_head(bh);\n\tfor (i = 0, ih = item_head(bh, 0); i < B_NR_ITEMS(bh); i++, ih++)\n\t\top_check_item(ih, ih_item_body(bh, ih));\n}"
  },
  {
    "function_name": "check_internal_block_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "729-745",
    "snippet": "static void check_internal_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\n\tblkh = B_BLK_HEAD(bh);\n\tif (!(B_LEVEL(bh) > DISK_LEAF_NODE_LEVEL && B_LEVEL(bh) <= MAX_HEIGHT))\n\t\treiserfs_panic(NULL, \"vs-6025\", \"invalid level %z\", bh);\n\n\tif (B_NR_ITEMS(bh) > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6030\", \"invalid item number %z\", bh);\n\n\tif (B_FREE_SPACE(bh) !=\n\t    bh->b_size - BLKH_SIZE - KEY_SIZE * B_NR_ITEMS(bh) -\n\t    DC_SIZE * (B_NR_ITEMS(bh) + 1))\n\t\treiserfs_panic(NULL, \"vs-6040\", \"invalid free space %z\", bh);\n\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_panic",
          "args": [
            "NULL",
            "\"vs-6040\"",
            "\"invalid free space %z\"",
            "bh"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "356-372",
          "snippet": "void __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}"
        }
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_FREE_SPACE",
          "args": [
            "bh"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_LEVEL",
          "args": [
            "bh"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_LEVEL",
          "args": [
            "bh"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_BLK_HEAD",
          "args": [
            "bh"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void check_internal_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\n\tblkh = B_BLK_HEAD(bh);\n\tif (!(B_LEVEL(bh) > DISK_LEAF_NODE_LEVEL && B_LEVEL(bh) <= MAX_HEIGHT))\n\t\treiserfs_panic(NULL, \"vs-6025\", \"invalid level %z\", bh);\n\n\tif (B_NR_ITEMS(bh) > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6030\", \"invalid item number %z\", bh);\n\n\tif (B_FREE_SPACE(bh) !=\n\t    bh->b_size - BLKH_SIZE - KEY_SIZE * B_NR_ITEMS(bh) -\n\t    DC_SIZE * (B_NR_ITEMS(bh) + 1))\n\t\treiserfs_panic(NULL, \"vs-6040\", \"invalid free space %z\", bh);\n\n}"
  },
  {
    "function_name": "check_leaf_block_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "713-727",
    "snippet": "static void check_leaf_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\tint nr;\n\n\tblkh = B_BLK_HEAD(bh);\n\tnr = blkh_nr_item(blkh);\n\tif (nr > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6010\", \"invalid item number %z\",\n\t\t\t       bh);\n\tif (blkh_free_space(blkh) > bh->b_size - BLKH_SIZE - IH_SIZE * nr)\n\t\treiserfs_panic(NULL, \"vs-6020\", \"invalid free space %z\",\n\t\t\t       bh);\n\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_panic",
          "args": [
            "NULL",
            "\"vs-6020\"",
            "\"invalid free space %z\"",
            "bh"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "356-372",
          "snippet": "void __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}"
        }
      },
      {
        "call_info": {
          "callee": "blkh_free_space",
          "args": [
            "blkh"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blkh_nr_item",
          "args": [
            "blkh"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_BLK_HEAD",
          "args": [
            "bh"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void check_leaf_block_head(struct buffer_head *bh)\n{\n\tstruct block_head *blkh;\n\tint nr;\n\n\tblkh = B_BLK_HEAD(bh);\n\tnr = blkh_nr_item(blkh);\n\tif (nr > (bh->b_size - BLKH_SIZE) / IH_SIZE)\n\t\treiserfs_panic(NULL, \"vs-6010\", \"invalid item number %z\",\n\t\t\t       bh);\n\tif (blkh_free_space(blkh) > bh->b_size - BLKH_SIZE - IH_SIZE * nr)\n\t\treiserfs_panic(NULL, \"vs-6020\", \"invalid free space %z\",\n\t\t\t       bh);\n\n}"
  },
  {
    "function_name": "print_cur_tb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "708-711",
    "snippet": "void print_cur_tb(char *mes)\n{\n\tprintk(\"%s\\n%s\", mes, print_tb_buf);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char print_tb_buf[2048];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"%s\\n%s\"",
            "mes",
            "print_tb_buf"
          ],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char print_tb_buf[2048];\n\nvoid print_cur_tb(char *mes)\n{\n\tprintk(\"%s\\n%s\", mes, print_tb_buf);\n}"
  },
  {
    "function_name": "store_print_tb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "622-706",
    "snippet": "void store_print_tb(struct tree_balance *tb)\n{\n\tint h = 0;\n\tint i;\n\tstruct buffer_head *tbSh, *tbFh;\n\n\tif (!tb)\n\t\treturn;\n\n\tsprintf(print_tb_buf, \"\\n\"\n\t\t\"BALANCING %d\\n\"\n\t\t\"MODE=%c, ITEM_POS=%d POS_IN_ITEM=%d\\n\"\n\t\t\"=====================================================================\\n\"\n\t\t\"* h *    S    *    L    *    R    *   F   *   FL  *   FR  *  CFL  *  CFR  *\\n\",\n\t\tREISERFS_SB(tb->tb_sb)->s_do_balance,\n\t\ttb->tb_mode, PATH_LAST_POSITION(tb->tb_path),\n\t\ttb->tb_path->pos_in_item);\n\n\tfor (h = 0; h < ARRAY_SIZE(tb->insert_size); h++) {\n\t\tif (PATH_H_PATH_OFFSET(tb->tb_path, h) <=\n\t\t    tb->tb_path->path_length\n\t\t    && PATH_H_PATH_OFFSET(tb->tb_path,\n\t\t\t\t\t  h) > ILLEGAL_PATH_ELEMENT_OFFSET) {\n\t\t\ttbSh = PATH_H_PBUFFER(tb->tb_path, h);\n\t\t\ttbFh = PATH_H_PPARENT(tb->tb_path, h);\n\t\t} else {\n\t\t\ttbSh = NULL;\n\t\t\ttbFh = NULL;\n\t\t}\n\t\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\t\"* %d * %3lld(%2d) * %3lld(%2d) * %3lld(%2d) * %5lld * %5lld * %5lld * %5lld * %5lld *\\n\",\n\t\t\th,\n\t\t\t(tbSh) ? (long long)(tbSh->b_blocknr) : (-1LL),\n\t\t\t(tbSh) ? atomic_read(&tbSh->b_count) : -1,\n\t\t\t(tb->L[h]) ? (long long)(tb->L[h]->b_blocknr) : (-1LL),\n\t\t\t(tb->L[h]) ? atomic_read(&tb->L[h]->b_count) : -1,\n\t\t\t(tb->R[h]) ? (long long)(tb->R[h]->b_blocknr) : (-1LL),\n\t\t\t(tb->R[h]) ? atomic_read(&tb->R[h]->b_count) : -1,\n\t\t\t(tbFh) ? (long long)(tbFh->b_blocknr) : (-1LL),\n\t\t\t(tb->FL[h]) ? (long long)(tb->FL[h]->\n\t\t\t\t\t\t  b_blocknr) : (-1LL),\n\t\t\t(tb->FR[h]) ? (long long)(tb->FR[h]->\n\t\t\t\t\t\t  b_blocknr) : (-1LL),\n\t\t\t(tb->CFL[h]) ? (long long)(tb->CFL[h]->\n\t\t\t\t\t\t   b_blocknr) : (-1LL),\n\t\t\t(tb->CFR[h]) ? (long long)(tb->CFR[h]->\n\t\t\t\t\t\t   b_blocknr) : (-1LL));\n\t}\n\n\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\"=====================================================================\\n\"\n\t\t\"* h * size * ln * lb * rn * rb * blkn * s0 * s1 * s1b * s2 * s2b * curb * lk * rk *\\n\"\n\t\t\"* 0 * %4d * %2d * %2d * %2d * %2d * %4d * %2d * %2d * %3d * %2d * %3d * %4d * %2d * %2d *\\n\",\n\t\ttb->insert_size[0], tb->lnum[0], tb->lbytes, tb->rnum[0],\n\t\ttb->rbytes, tb->blknum[0], tb->s0num, tb->snum[0],\n\t\ttb->sbytes[0], tb->snum[1], tb->sbytes[1],\n\t\ttb->cur_blknum, tb->lkey[0], tb->rkey[0]);\n\n\t/* this prints balance parameters for non-leaf levels */\n\th = 0;\n\tdo {\n\t\th++;\n\t\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\t\"* %d * %4d * %2d *    * %2d *    * %2d *\\n\",\n\t\t\th, tb->insert_size[h], tb->lnum[h], tb->rnum[h],\n\t\t\ttb->blknum[h]);\n\t} while (tb->insert_size[h]);\n\n\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\"=====================================================================\\n\"\n\t\t\"FEB list: \");\n\n\t/* print FEB list (list of buffers in form (bh (b_blocknr, b_count), that will be used for new nodes) */\n\th = 0;\n\tfor (i = 0; i < ARRAY_SIZE(tb->FEB); i++)\n\t\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\t\"%p (%llu %d)%s\", tb->FEB[i],\n\t\t\ttb->FEB[i] ? (unsigned long long)tb->FEB[i]->\n\t\t\tb_blocknr : 0ULL,\n\t\t\ttb->FEB[i] ? atomic_read(&tb->FEB[i]->b_count) : 0,\n\t\t\t(i == ARRAY_SIZE(tb->FEB) - 1) ? \"\\n\" : \", \");\n\n\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\"======================== the end ====================================\\n\");\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char print_tb_buf[2048];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "print_tb_buf + strlen(print_tb_buf)",
            "\"======================== the end ====================================\\n\""
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_disk_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "154-158",
          "snippet": "static void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "print_tb_buf"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "print_tb_buf + strlen(print_tb_buf)",
            "\"%p (%llu %d)%s\"",
            "tb->FEB[i]",
            "tb->FEB[i] ? (unsigned long long)tb->FEB[i]->\n\t\t\tb_blocknr : 0ULL",
            "tb->FEB[i] ? atomic_read(&tb->FEB[i]->b_count) : 0",
            "(i == ARRAY_SIZE(tb->FEB) - 1) ? \"\\n\" : \", \""
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "tb->FEB"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&tb->FEB[i]->b_count"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "tb->FEB"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "print_tb_buf + strlen(print_tb_buf)",
            "\"* %d * %4d * %2d *    * %2d *    * %2d *\\n\"",
            "h",
            "tb->insert_size[h]",
            "tb->lnum[h]",
            "tb->rnum[h]",
            "tb->blknum[h]"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "print_tb_buf + strlen(print_tb_buf)",
            "\"=====================================================================\\n\"\n\t\t\"* h * size * ln * lb * rn * rb * blkn * s0 * s1 * s1b * s2 * s2b * curb * lk * rk *\\n\"\n\t\t\"* 0 * %4d * %2d * %2d * %2d * %2d * %4d * %2d * %2d * %3d * %2d * %3d * %4d * %2d * %2d *\\n\"",
            "tb->insert_size[0]",
            "tb->lnum[0]",
            "tb->lbytes",
            "tb->rnum[0]",
            "tb->rbytes",
            "tb->blknum[0]",
            "tb->s0num",
            "tb->snum[0]",
            "tb->sbytes[0]",
            "tb->snum[1]",
            "tb->sbytes[1]",
            "tb->cur_blknum",
            "tb->lkey[0]",
            "tb->rkey[0]"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "print_tb_buf + strlen(print_tb_buf)",
            "\"* %d * %3lld(%2d) * %3lld(%2d) * %3lld(%2d) * %5lld * %5lld * %5lld * %5lld * %5lld *\\n\"",
            "h",
            "(tbSh) ? (long long)(tbSh->b_blocknr) : (-1LL)",
            "(tbSh) ? atomic_read(&tbSh->b_count) : -1",
            "(tb->L[h]) ? (long long)(tb->L[h]->b_blocknr) : (-1LL)",
            "(tb->L[h]) ? atomic_read(&tb->L[h]->b_count) : -1",
            "(tb->R[h]) ? (long long)(tb->R[h]->b_blocknr) : (-1LL)",
            "(tb->R[h]) ? atomic_read(&tb->R[h]->b_count) : -1",
            "(tbFh) ? (long long)(tbFh->b_blocknr) : (-1LL)",
            "(tb->FL[h]) ? (long long)(tb->FL[h]->\n\t\t\t\t\t\t  b_blocknr) : (-1LL)",
            "(tb->FR[h]) ? (long long)(tb->FR[h]->\n\t\t\t\t\t\t  b_blocknr) : (-1LL)",
            "(tb->CFL[h]) ? (long long)(tb->CFL[h]->\n\t\t\t\t\t\t   b_blocknr) : (-1LL)",
            "(tb->CFR[h]) ? (long long)(tb->CFR[h]->\n\t\t\t\t\t\t   b_blocknr) : (-1LL)"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&tb->R[h]->b_count"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&tb->L[h]->b_count"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&tbSh->b_count"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PATH_H_PPARENT",
          "args": [
            "tb->tb_path",
            "h"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PATH_H_PBUFFER",
          "args": [
            "tb->tb_path",
            "h"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PATH_H_PATH_OFFSET",
          "args": [
            "tb->tb_path",
            "h"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PATH_H_PATH_OFFSET",
          "args": [
            "tb->tb_path",
            "h"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "tb->insert_size"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "print_tb_buf",
            "\"\\n\"\n\t\t\"BALANCING %d\\n\"\n\t\t\"MODE=%c, ITEM_POS=%d POS_IN_ITEM=%d\\n\"\n\t\t\"=====================================================================\\n\"\n\t\t\"* h *    S    *    L    *    R    *   F   *   FL  *   FR  *  CFL  *  CFR  *\\n\"",
            "REISERFS_SB(tb->tb_sb)->s_do_balance",
            "tb->tb_mode",
            "PATH_LAST_POSITION(tb->tb_path)",
            "tb->tb_path->pos_in_item"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PATH_LAST_POSITION",
          "args": [
            "tb->tb_path"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "REISERFS_SB",
          "args": [
            "tb->tb_sb"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "REISERFS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1152-1155",
          "snippet": "static inline struct reiserfs_sb_info *REISERFS_SB(const struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int reiserfs_resize(struct super_block *, unsigned long);",
            "void reiserfs_flush_old_commits(struct super_block *);",
            "int journal_release(struct reiserfs_transaction_handle *, struct super_block *);",
            "int journal_release_error(struct reiserfs_transaction_handle *,\n\t\t\t  struct super_block *);",
            "int journal_begin(struct reiserfs_transaction_handle *,\n\t\t  struct super_block *sb, unsigned long);",
            "int journal_join_abort(struct reiserfs_transaction_handle *,\n\t\t       struct super_block *sb);",
            "int reiserfs_convert_objectid_map_v1(struct super_block *);",
            "const struct reiserfs_key *get_rkey(const struct treepath *chk_path,\n\t\t\t\t    const struct super_block *sb);",
            "int reiserfs_parse_alloc_options(struct super_block *, char *);",
            "int reiserfs_init_bitmap_cache(struct super_block *sb);",
            "void reiserfs_free_bitmap_cache(struct super_block *sb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nint reiserfs_resize(struct super_block *, unsigned long);\nvoid reiserfs_flush_old_commits(struct super_block *);\nint journal_release(struct reiserfs_transaction_handle *, struct super_block *);\nint journal_release_error(struct reiserfs_transaction_handle *,\n\t\t\t  struct super_block *);\nint journal_begin(struct reiserfs_transaction_handle *,\n\t\t  struct super_block *sb, unsigned long);\nint journal_join_abort(struct reiserfs_transaction_handle *,\n\t\t       struct super_block *sb);\nint reiserfs_convert_objectid_map_v1(struct super_block *);\nconst struct reiserfs_key *get_rkey(const struct treepath *chk_path,\n\t\t\t\t    const struct super_block *sb);\nint reiserfs_parse_alloc_options(struct super_block *, char *);\nint reiserfs_init_bitmap_cache(struct super_block *sb);\nvoid reiserfs_free_bitmap_cache(struct super_block *sb);\n\nstatic inline struct reiserfs_sb_info *REISERFS_SB(const struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char print_tb_buf[2048];\n\nvoid store_print_tb(struct tree_balance *tb)\n{\n\tint h = 0;\n\tint i;\n\tstruct buffer_head *tbSh, *tbFh;\n\n\tif (!tb)\n\t\treturn;\n\n\tsprintf(print_tb_buf, \"\\n\"\n\t\t\"BALANCING %d\\n\"\n\t\t\"MODE=%c, ITEM_POS=%d POS_IN_ITEM=%d\\n\"\n\t\t\"=====================================================================\\n\"\n\t\t\"* h *    S    *    L    *    R    *   F   *   FL  *   FR  *  CFL  *  CFR  *\\n\",\n\t\tREISERFS_SB(tb->tb_sb)->s_do_balance,\n\t\ttb->tb_mode, PATH_LAST_POSITION(tb->tb_path),\n\t\ttb->tb_path->pos_in_item);\n\n\tfor (h = 0; h < ARRAY_SIZE(tb->insert_size); h++) {\n\t\tif (PATH_H_PATH_OFFSET(tb->tb_path, h) <=\n\t\t    tb->tb_path->path_length\n\t\t    && PATH_H_PATH_OFFSET(tb->tb_path,\n\t\t\t\t\t  h) > ILLEGAL_PATH_ELEMENT_OFFSET) {\n\t\t\ttbSh = PATH_H_PBUFFER(tb->tb_path, h);\n\t\t\ttbFh = PATH_H_PPARENT(tb->tb_path, h);\n\t\t} else {\n\t\t\ttbSh = NULL;\n\t\t\ttbFh = NULL;\n\t\t}\n\t\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\t\"* %d * %3lld(%2d) * %3lld(%2d) * %3lld(%2d) * %5lld * %5lld * %5lld * %5lld * %5lld *\\n\",\n\t\t\th,\n\t\t\t(tbSh) ? (long long)(tbSh->b_blocknr) : (-1LL),\n\t\t\t(tbSh) ? atomic_read(&tbSh->b_count) : -1,\n\t\t\t(tb->L[h]) ? (long long)(tb->L[h]->b_blocknr) : (-1LL),\n\t\t\t(tb->L[h]) ? atomic_read(&tb->L[h]->b_count) : -1,\n\t\t\t(tb->R[h]) ? (long long)(tb->R[h]->b_blocknr) : (-1LL),\n\t\t\t(tb->R[h]) ? atomic_read(&tb->R[h]->b_count) : -1,\n\t\t\t(tbFh) ? (long long)(tbFh->b_blocknr) : (-1LL),\n\t\t\t(tb->FL[h]) ? (long long)(tb->FL[h]->\n\t\t\t\t\t\t  b_blocknr) : (-1LL),\n\t\t\t(tb->FR[h]) ? (long long)(tb->FR[h]->\n\t\t\t\t\t\t  b_blocknr) : (-1LL),\n\t\t\t(tb->CFL[h]) ? (long long)(tb->CFL[h]->\n\t\t\t\t\t\t   b_blocknr) : (-1LL),\n\t\t\t(tb->CFR[h]) ? (long long)(tb->CFR[h]->\n\t\t\t\t\t\t   b_blocknr) : (-1LL));\n\t}\n\n\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\"=====================================================================\\n\"\n\t\t\"* h * size * ln * lb * rn * rb * blkn * s0 * s1 * s1b * s2 * s2b * curb * lk * rk *\\n\"\n\t\t\"* 0 * %4d * %2d * %2d * %2d * %2d * %4d * %2d * %2d * %3d * %2d * %3d * %4d * %2d * %2d *\\n\",\n\t\ttb->insert_size[0], tb->lnum[0], tb->lbytes, tb->rnum[0],\n\t\ttb->rbytes, tb->blknum[0], tb->s0num, tb->snum[0],\n\t\ttb->sbytes[0], tb->snum[1], tb->sbytes[1],\n\t\ttb->cur_blknum, tb->lkey[0], tb->rkey[0]);\n\n\t/* this prints balance parameters for non-leaf levels */\n\th = 0;\n\tdo {\n\t\th++;\n\t\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\t\"* %d * %4d * %2d *    * %2d *    * %2d *\\n\",\n\t\t\th, tb->insert_size[h], tb->lnum[h], tb->rnum[h],\n\t\t\ttb->blknum[h]);\n\t} while (tb->insert_size[h]);\n\n\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\"=====================================================================\\n\"\n\t\t\"FEB list: \");\n\n\t/* print FEB list (list of buffers in form (bh (b_blocknr, b_count), that will be used for new nodes) */\n\th = 0;\n\tfor (i = 0; i < ARRAY_SIZE(tb->FEB); i++)\n\t\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\t\"%p (%llu %d)%s\", tb->FEB[i],\n\t\t\ttb->FEB[i] ? (unsigned long long)tb->FEB[i]->\n\t\t\tb_blocknr : 0ULL,\n\t\t\ttb->FEB[i] ? atomic_read(&tb->FEB[i]->b_count) : 0,\n\t\t\t(i == ARRAY_SIZE(tb->FEB) - 1) ? \"\\n\" : \", \");\n\n\tsprintf(print_tb_buf + strlen(print_tb_buf),\n\t\t\"======================== the end ====================================\\n\");\n}"
  },
  {
    "function_name": "print_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "593-617",
    "snippet": "void print_block(struct buffer_head *bh, ...)\n{\n\tva_list args;\n\tint mode, first, last;\n\n\tif (!bh) {\n\t\tprintk(\"print_block: buffer is NULL\\n\");\n\t\treturn;\n\t}\n\n\tva_start(args, bh);\n\n\tmode = va_arg(args, int);\n\tfirst = va_arg(args, int);\n\tlast = va_arg(args, int);\n\tif (print_leaf(bh, mode, first, last))\n\t\tif (print_internal(bh, first, last))\n\t\t\tif (print_super_block(bh))\n\t\t\t\tif (print_desc_block(bh))\n\t\t\t\t\tprintk\n\t\t\t\t\t    (\"Block %llu contains unformatted data\\n\",\n\t\t\t\t\t     (unsigned long long)bh->b_blocknr);\n\n\tva_end(args);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"Block %llu contains unformatted data\\n\"",
            "(unsigned long long)bh->b_blocknr"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_desc_block",
          "args": [
            "bh"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "print_desc_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "578-591",
          "snippet": "static int print_desc_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_journal_desc *desc;\n\n\tif (memcmp(get_journal_desc_magic(bh), JOURNAL_DESC_MAGIC, 8))\n\t\treturn 1;\n\n\tdesc = (struct reiserfs_journal_desc *)(bh->b_data);\n\tprintk(\"Desc block %llu (j_trans_id %d, j_mount_id %d, j_len %d)\",\n\t       (unsigned long long)bh->b_blocknr, get_desc_trans_id(desc),\n\t       get_desc_mount_id(desc), get_desc_trans_len(desc));\n\n\treturn 0;\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_desc_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_journal_desc *desc;\n\n\tif (memcmp(get_journal_desc_magic(bh), JOURNAL_DESC_MAGIC, 8))\n\t\treturn 1;\n\n\tdesc = (struct reiserfs_journal_desc *)(bh->b_data);\n\tprintk(\"Desc block %llu (j_trans_id %d, j_mount_id %d, j_len %d)\",\n\t       (unsigned long long)bh->b_blocknr, get_desc_trans_id(desc),\n\t       get_desc_mount_id(desc), get_desc_trans_len(desc));\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_super_block",
          "args": [
            "bh"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "print_super_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "527-576",
          "snippet": "static int print_super_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_super_block *rs =\n\t    (struct reiserfs_super_block *)(bh->b_data);\n\tint skipped, data_blocks;\n\tchar *version;\n\tchar b[BDEVNAME_SIZE];\n\n\tif (is_reiserfs_3_5(rs)) {\n\t\tversion = \"3.5\";\n\t} else if (is_reiserfs_3_6(rs)) {\n\t\tversion = \"3.6\";\n\t} else if (is_reiserfs_jr(rs)) {\n\t\tversion = ((sb_version(rs) == REISERFS_VERSION_2) ?\n\t\t\t   \"3.6\" : \"3.5\");\n\t} else {\n\t\treturn 1;\n\t}\n\n\tprintk(\"%s\\'s super block is in block %llu\\n\", bdevname(bh->b_bdev, b),\n\t       (unsigned long long)bh->b_blocknr);\n\tprintk(\"Reiserfs version %s\\n\", version);\n\tprintk(\"Block count %u\\n\", sb_block_count(rs));\n\tprintk(\"Blocksize %d\\n\", sb_blocksize(rs));\n\tprintk(\"Free blocks %u\\n\", sb_free_blocks(rs));\n\t/*\n\t * FIXME: this would be confusing if\n\t * someone stores reiserfs super block in some data block ;)\n//    skipped = (bh->b_blocknr * bh->b_size) / sb_blocksize(rs);\n\t */\n\tskipped = bh->b_blocknr;\n\tdata_blocks = sb_block_count(rs) - skipped - 1 - sb_bmap_nr(rs) -\n\t    (!is_reiserfs_jr(rs) ? sb_jp_journal_size(rs) +\n\t     1 : sb_reserved_for_journal(rs)) - sb_free_blocks(rs);\n\tprintk\n\t    (\"Busy blocks (skipped %d, bitmaps - %d, journal (or reserved) blocks - %d\\n\"\n\t     \"1 super block, %d data blocks\\n\", skipped, sb_bmap_nr(rs),\n\t     (!is_reiserfs_jr(rs) ? (sb_jp_journal_size(rs) + 1) :\n\t      sb_reserved_for_journal(rs)), data_blocks);\n\tprintk(\"Root block %u\\n\", sb_root_block(rs));\n\tprintk(\"Journal block (first) %d\\n\", sb_jp_journal_1st_block(rs));\n\tprintk(\"Journal dev %d\\n\", sb_jp_journal_dev(rs));\n\tprintk(\"Journal orig size %d\\n\", sb_jp_journal_size(rs));\n\tprintk(\"FS state %d\\n\", sb_fs_state(rs));\n\tprintk(\"Hash function \\\"%s\\\"\\n\",\n\t       reiserfs_hashname(sb_hash_function_code(rs)));\n\n\tprintk(\"Tree height %d\\n\", sb_tree_height(rs));\n\treturn 0;\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_super_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_super_block *rs =\n\t    (struct reiserfs_super_block *)(bh->b_data);\n\tint skipped, data_blocks;\n\tchar *version;\n\tchar b[BDEVNAME_SIZE];\n\n\tif (is_reiserfs_3_5(rs)) {\n\t\tversion = \"3.5\";\n\t} else if (is_reiserfs_3_6(rs)) {\n\t\tversion = \"3.6\";\n\t} else if (is_reiserfs_jr(rs)) {\n\t\tversion = ((sb_version(rs) == REISERFS_VERSION_2) ?\n\t\t\t   \"3.6\" : \"3.5\");\n\t} else {\n\t\treturn 1;\n\t}\n\n\tprintk(\"%s\\'s super block is in block %llu\\n\", bdevname(bh->b_bdev, b),\n\t       (unsigned long long)bh->b_blocknr);\n\tprintk(\"Reiserfs version %s\\n\", version);\n\tprintk(\"Block count %u\\n\", sb_block_count(rs));\n\tprintk(\"Blocksize %d\\n\", sb_blocksize(rs));\n\tprintk(\"Free blocks %u\\n\", sb_free_blocks(rs));\n\t/*\n\t * FIXME: this would be confusing if\n\t * someone stores reiserfs super block in some data block ;)\n//    skipped = (bh->b_blocknr * bh->b_size) / sb_blocksize(rs);\n\t */\n\tskipped = bh->b_blocknr;\n\tdata_blocks = sb_block_count(rs) - skipped - 1 - sb_bmap_nr(rs) -\n\t    (!is_reiserfs_jr(rs) ? sb_jp_journal_size(rs) +\n\t     1 : sb_reserved_for_journal(rs)) - sb_free_blocks(rs);\n\tprintk\n\t    (\"Busy blocks (skipped %d, bitmaps - %d, journal (or reserved) blocks - %d\\n\"\n\t     \"1 super block, %d data blocks\\n\", skipped, sb_bmap_nr(rs),\n\t     (!is_reiserfs_jr(rs) ? (sb_jp_journal_size(rs) + 1) :\n\t      sb_reserved_for_journal(rs)), data_blocks);\n\tprintk(\"Root block %u\\n\", sb_root_block(rs));\n\tprintk(\"Journal block (first) %d\\n\", sb_jp_journal_1st_block(rs));\n\tprintk(\"Journal dev %d\\n\", sb_jp_journal_dev(rs));\n\tprintk(\"Journal orig size %d\\n\", sb_jp_journal_size(rs));\n\tprintk(\"FS state %d\\n\", sb_fs_state(rs));\n\tprintk(\"Hash function \\\"%s\\\"\\n\",\n\t       reiserfs_hashname(sb_hash_function_code(rs)));\n\n\tprintk(\"Tree height %d\\n\", sb_tree_height(rs));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_internal",
          "args": [
            "bh",
            "first",
            "last"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "print_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "423-456",
          "snippet": "static int print_internal(struct buffer_head *bh, int first, int last)\n{\n\tstruct reiserfs_key *key;\n\tstruct disk_child *dc;\n\tint i;\n\tint from, to;\n\n\tif (!B_IS_KEYS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_internal(bh);\n\n\tif (first == -1) {\n\t\tfrom = 0;\n\t\tto = B_NR_ITEMS(bh);\n\t} else {\n\t\tfrom = first;\n\t\tto = last < B_NR_ITEMS(bh) ? last : B_NR_ITEMS(bh);\n\t}\n\n\treiserfs_printk(\"INTERNAL NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tdc = B_N_CHILD(bh, from);\n\treiserfs_printk(\"PTR %d: %y \", from, dc);\n\n\tfor (i = from, key = internal_key(bh, from), dc++; i < to;\n\t     i++, key++, dc++) {\n\t\treiserfs_printk(\"KEY %d: %k PTR %d: %y \", i, key, i + 1, dc);\n\t\tif (i && i % 4 == 0)\n\t\t\tprintk(\"\\n\");\n\t}\n\tprintk(\"\\n\");\n\treturn 0;\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_internal(struct buffer_head *bh, int first, int last)\n{\n\tstruct reiserfs_key *key;\n\tstruct disk_child *dc;\n\tint i;\n\tint from, to;\n\n\tif (!B_IS_KEYS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_internal(bh);\n\n\tif (first == -1) {\n\t\tfrom = 0;\n\t\tto = B_NR_ITEMS(bh);\n\t} else {\n\t\tfrom = first;\n\t\tto = last < B_NR_ITEMS(bh) ? last : B_NR_ITEMS(bh);\n\t}\n\n\treiserfs_printk(\"INTERNAL NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tdc = B_N_CHILD(bh, from);\n\treiserfs_printk(\"PTR %d: %y \", from, dc);\n\n\tfor (i = from, key = internal_key(bh, from), dc++; i < to;\n\t     i++, key++, dc++) {\n\t\treiserfs_printk(\"KEY %d: %k PTR %d: %y \", i, key, i + 1, dc);\n\t\tif (i && i % 4 == 0)\n\t\t\tprintk(\"\\n\");\n\t}\n\tprintk(\"\\n\");\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_leaf",
          "args": [
            "bh",
            "mode",
            "first",
            "last"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "print_leaf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "458-512",
          "snippet": "static int print_leaf(struct buffer_head *bh, int print_mode, int first,\n\t\t      int last)\n{\n\tstruct block_head *blkh;\n\tstruct item_head *ih;\n\tint i, nr;\n\tint from, to;\n\n\tif (!B_IS_ITEMS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_leaf(bh);\n\n\tblkh = B_BLK_HEAD(bh);\n\tih = item_head(bh, 0);\n\tnr = blkh_nr_item(blkh);\n\n\tprintk\n\t    (\"\\n===================================================================\\n\");\n\treiserfs_printk(\"LEAF NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tif (!(print_mode & PRINT_LEAF_ITEMS)) {\n\t\treiserfs_printk(\"FIRST ITEM_KEY: %k, LAST ITEM KEY: %k\\n\",\n\t\t\t\t&(ih->ih_key), &((ih + nr - 1)->ih_key));\n\t\treturn 0;\n\t}\n\n\tif (first < 0 || first > nr - 1)\n\t\tfrom = 0;\n\telse\n\t\tfrom = first;\n\n\tif (last < 0 || last > nr)\n\t\tto = nr;\n\telse\n\t\tto = last;\n\n\tih += from;\n\tprintk\n\t    (\"-------------------------------------------------------------------------------\\n\");\n\tprintk\n\t    (\"|##|   type    |           key           | ilen | free_space | version | loc  |\\n\");\n\tfor (i = from; i < to; i++, ih++) {\n\t\tprintk\n\t\t    (\"-------------------------------------------------------------------------------\\n\");\n\t\treiserfs_printk(\"|%2d| %h |\\n\", i, ih);\n\t\tif (print_mode & PRINT_LEAF_ITEMS)\n\t\t\top_print_item(ih, ih_item_body(bh, ih));\n\t}\n\n\tprintk\n\t    (\"===================================================================\\n\");\n\n\treturn 0;\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_leaf(struct buffer_head *bh, int print_mode, int first,\n\t\t      int last)\n{\n\tstruct block_head *blkh;\n\tstruct item_head *ih;\n\tint i, nr;\n\tint from, to;\n\n\tif (!B_IS_ITEMS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_leaf(bh);\n\n\tblkh = B_BLK_HEAD(bh);\n\tih = item_head(bh, 0);\n\tnr = blkh_nr_item(blkh);\n\n\tprintk\n\t    (\"\\n===================================================================\\n\");\n\treiserfs_printk(\"LEAF NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tif (!(print_mode & PRINT_LEAF_ITEMS)) {\n\t\treiserfs_printk(\"FIRST ITEM_KEY: %k, LAST ITEM KEY: %k\\n\",\n\t\t\t\t&(ih->ih_key), &((ih + nr - 1)->ih_key));\n\t\treturn 0;\n\t}\n\n\tif (first < 0 || first > nr - 1)\n\t\tfrom = 0;\n\telse\n\t\tfrom = first;\n\n\tif (last < 0 || last > nr)\n\t\tto = nr;\n\telse\n\t\tto = last;\n\n\tih += from;\n\tprintk\n\t    (\"-------------------------------------------------------------------------------\\n\");\n\tprintk\n\t    (\"|##|   type    |           key           | ilen | free_space | version | loc  |\\n\");\n\tfor (i = from; i < to; i++, ih++) {\n\t\tprintk\n\t\t    (\"-------------------------------------------------------------------------------\\n\");\n\t\treiserfs_printk(\"|%2d| %h |\\n\", i, ih);\n\t\tif (print_mode & PRINT_LEAF_ITEMS)\n\t\t\top_print_item(ih, ih_item_body(bh, ih));\n\t}\n\n\tprintk\n\t    (\"===================================================================\\n\");\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "bh"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nvoid print_block(struct buffer_head *bh, ...)\n{\n\tva_list args;\n\tint mode, first, last;\n\n\tif (!bh) {\n\t\tprintk(\"print_block: buffer is NULL\\n\");\n\t\treturn;\n\t}\n\n\tva_start(args, bh);\n\n\tmode = va_arg(args, int);\n\tfirst = va_arg(args, int);\n\tlast = va_arg(args, int);\n\tif (print_leaf(bh, mode, first, last))\n\t\tif (print_internal(bh, first, last))\n\t\t\tif (print_super_block(bh))\n\t\t\t\tif (print_desc_block(bh))\n\t\t\t\t\tprintk\n\t\t\t\t\t    (\"Block %llu contains unformatted data\\n\",\n\t\t\t\t\t     (unsigned long long)bh->b_blocknr);\n\n\tva_end(args);\n}"
  },
  {
    "function_name": "print_desc_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "578-591",
    "snippet": "static int print_desc_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_journal_desc *desc;\n\n\tif (memcmp(get_journal_desc_magic(bh), JOURNAL_DESC_MAGIC, 8))\n\t\treturn 1;\n\n\tdesc = (struct reiserfs_journal_desc *)(bh->b_data);\n\tprintk(\"Desc block %llu (j_trans_id %d, j_mount_id %d, j_len %d)\",\n\t       (unsigned long long)bh->b_blocknr, get_desc_trans_id(desc),\n\t       get_desc_mount_id(desc), get_desc_trans_len(desc));\n\n\treturn 0;\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"Desc block %llu (j_trans_id %d, j_mount_id %d, j_len %d)\"",
            "(unsigned long long)bh->b_blocknr",
            "get_desc_trans_id(desc)",
            "get_desc_mount_id(desc)",
            "get_desc_trans_len(desc)"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_desc_trans_len",
          "args": [
            "desc"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_desc_mount_id",
          "args": [
            "desc"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_desc_trans_id",
          "args": [
            "desc"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "get_journal_desc_magic(bh)",
            "JOURNAL_DESC_MAGIC",
            "8"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_journal_desc_magic",
          "args": [
            "bh"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_desc_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_journal_desc *desc;\n\n\tif (memcmp(get_journal_desc_magic(bh), JOURNAL_DESC_MAGIC, 8))\n\t\treturn 1;\n\n\tdesc = (struct reiserfs_journal_desc *)(bh->b_data);\n\tprintk(\"Desc block %llu (j_trans_id %d, j_mount_id %d, j_len %d)\",\n\t       (unsigned long long)bh->b_blocknr, get_desc_trans_id(desc),\n\t       get_desc_mount_id(desc), get_desc_trans_len(desc));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "print_super_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "527-576",
    "snippet": "static int print_super_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_super_block *rs =\n\t    (struct reiserfs_super_block *)(bh->b_data);\n\tint skipped, data_blocks;\n\tchar *version;\n\tchar b[BDEVNAME_SIZE];\n\n\tif (is_reiserfs_3_5(rs)) {\n\t\tversion = \"3.5\";\n\t} else if (is_reiserfs_3_6(rs)) {\n\t\tversion = \"3.6\";\n\t} else if (is_reiserfs_jr(rs)) {\n\t\tversion = ((sb_version(rs) == REISERFS_VERSION_2) ?\n\t\t\t   \"3.6\" : \"3.5\");\n\t} else {\n\t\treturn 1;\n\t}\n\n\tprintk(\"%s\\'s super block is in block %llu\\n\", bdevname(bh->b_bdev, b),\n\t       (unsigned long long)bh->b_blocknr);\n\tprintk(\"Reiserfs version %s\\n\", version);\n\tprintk(\"Block count %u\\n\", sb_block_count(rs));\n\tprintk(\"Blocksize %d\\n\", sb_blocksize(rs));\n\tprintk(\"Free blocks %u\\n\", sb_free_blocks(rs));\n\t/*\n\t * FIXME: this would be confusing if\n\t * someone stores reiserfs super block in some data block ;)\n//    skipped = (bh->b_blocknr * bh->b_size) / sb_blocksize(rs);\n\t */\n\tskipped = bh->b_blocknr;\n\tdata_blocks = sb_block_count(rs) - skipped - 1 - sb_bmap_nr(rs) -\n\t    (!is_reiserfs_jr(rs) ? sb_jp_journal_size(rs) +\n\t     1 : sb_reserved_for_journal(rs)) - sb_free_blocks(rs);\n\tprintk\n\t    (\"Busy blocks (skipped %d, bitmaps - %d, journal (or reserved) blocks - %d\\n\"\n\t     \"1 super block, %d data blocks\\n\", skipped, sb_bmap_nr(rs),\n\t     (!is_reiserfs_jr(rs) ? (sb_jp_journal_size(rs) + 1) :\n\t      sb_reserved_for_journal(rs)), data_blocks);\n\tprintk(\"Root block %u\\n\", sb_root_block(rs));\n\tprintk(\"Journal block (first) %d\\n\", sb_jp_journal_1st_block(rs));\n\tprintk(\"Journal dev %d\\n\", sb_jp_journal_dev(rs));\n\tprintk(\"Journal orig size %d\\n\", sb_jp_journal_size(rs));\n\tprintk(\"FS state %d\\n\", sb_fs_state(rs));\n\tprintk(\"Hash function \\\"%s\\\"\\n\",\n\t       reiserfs_hashname(sb_hash_function_code(rs)));\n\n\tprintk(\"Tree height %d\\n\", sb_tree_height(rs));\n\treturn 0;\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"Tree height %d\\n\"",
            "sb_tree_height(rs)"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_tree_height",
          "args": [
            "rs"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reiserfs_hashname",
          "args": [
            "sb_hash_function_code(rs)"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_hashname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "514-524",
          "snippet": "char *reiserfs_hashname(int code)\n{\n\tif (code == YURA_HASH)\n\t\treturn \"rupasov\";\n\tif (code == TEA_HASH)\n\t\treturn \"tea\";\n\tif (code == R5_HASH)\n\t\treturn \"r5\";\n\n\treturn \"unknown\";\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nchar *reiserfs_hashname(int code)\n{\n\tif (code == YURA_HASH)\n\t\treturn \"rupasov\";\n\tif (code == TEA_HASH)\n\t\treturn \"tea\";\n\tif (code == R5_HASH)\n\t\treturn \"r5\";\n\n\treturn \"unknown\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_hash_function_code",
          "args": [
            "rs"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_fs_state",
          "args": [
            "rs"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_jp_journal_size",
          "args": [
            "rs"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_jp_journal_dev",
          "args": [
            "rs"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_jp_journal_1st_block",
          "args": [
            "rs"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_root_block",
          "args": [
            "rs"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_reserved_for_journal",
          "args": [
            "rs"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_jp_journal_size",
          "args": [
            "rs"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_reiserfs_jr",
          "args": [
            "rs"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "is_reiserfs_jr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/super.c",
          "lines": "51-55",
          "snippet": "int is_reiserfs_jr(struct reiserfs_super_block *rs)\n{\n\treturn !strncmp(rs->s_v1.s_magic, reiserfs_jr_magic_string,\n\t\t\tstrlen(reiserfs_jr_magic_string));\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/crc32.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/init.h>",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"reiserfs.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/time.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char reiserfs_jr_magic_string[] = REISER2FS_JR_SUPER_MAGIC_STRING;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/crc32.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/quotaops.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/blkdev.h>\n#include <linux/init.h>\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"reiserfs.h\"\n#include <linux/uaccess.h>\n#include <linux/time.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstatic const char reiserfs_jr_magic_string[] = REISER2FS_JR_SUPER_MAGIC_STRING;\n\nint is_reiserfs_jr(struct reiserfs_super_block *rs)\n{\n\treturn !strncmp(rs->s_v1.s_magic, reiserfs_jr_magic_string,\n\t\t\tstrlen(reiserfs_jr_magic_string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_bmap_nr",
          "args": [
            "rs"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_free_blocks",
          "args": [
            "rs"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_reserved_for_journal",
          "args": [
            "rs"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_jp_journal_size",
          "args": [
            "rs"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_bmap_nr",
          "args": [
            "rs"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_block_count",
          "args": [
            "rs"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_free_blocks",
          "args": [
            "rs"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_blocksize",
          "args": [
            "rs"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_block_count",
          "args": [
            "rs"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdevname",
          "args": [
            "bh->b_bdev",
            "b"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_version",
          "args": [
            "rs"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_sb_version_hasfinobt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_format.h",
          "lines": "565-569",
          "snippet": "static inline int xfs_sb_version_hasfinobt(xfs_sb_t *sbp)\n{\n\treturn (XFS_SB_VERSION_NUM(sbp) == XFS_SB_VERSION_5) &&\n\t\t(sbp->sb_features_ro_compat & XFS_SB_FEAT_RO_COMPAT_FINOBT);\n}",
          "includes": [],
          "macros_used": [
            "#define XFS_SB_FEAT_RO_COMPAT_FINOBT   (1 << 0)\t\t/* free inode btree */",
            "#define\tXFS_SB_VERSION_5\t5\t\t/* CRC enabled filesystem */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#define XFS_SB_FEAT_RO_COMPAT_FINOBT   (1 << 0)\t\t/* free inode btree */\n#define\tXFS_SB_VERSION_5\t5\t\t/* CRC enabled filesystem */\n\nstatic inline int xfs_sb_version_hasfinobt(xfs_sb_t *sbp)\n{\n\treturn (XFS_SB_VERSION_NUM(sbp) == XFS_SB_VERSION_5) &&\n\t\t(sbp->sb_features_ro_compat & XFS_SB_FEAT_RO_COMPAT_FINOBT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_reiserfs_3_6",
          "args": [
            "rs"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "is_reiserfs_3_6",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/super.c",
          "lines": "45-49",
          "snippet": "int is_reiserfs_3_6(struct reiserfs_super_block *rs)\n{\n\treturn !strncmp(rs->s_v1.s_magic, reiserfs_3_6_magic_string,\n\t\t\tstrlen(reiserfs_3_6_magic_string));\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/crc32.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/init.h>",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"reiserfs.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/time.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char reiserfs_3_6_magic_string[] = REISER2FS_SUPER_MAGIC_STRING;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/crc32.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/quotaops.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/blkdev.h>\n#include <linux/init.h>\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"reiserfs.h\"\n#include <linux/uaccess.h>\n#include <linux/time.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstatic const char reiserfs_3_6_magic_string[] = REISER2FS_SUPER_MAGIC_STRING;\n\nint is_reiserfs_3_6(struct reiserfs_super_block *rs)\n{\n\treturn !strncmp(rs->s_v1.s_magic, reiserfs_3_6_magic_string,\n\t\t\tstrlen(reiserfs_3_6_magic_string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_reiserfs_3_5",
          "args": [
            "rs"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "is_reiserfs_3_5",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/super.c",
          "lines": "39-43",
          "snippet": "int is_reiserfs_3_5(struct reiserfs_super_block *rs)\n{\n\treturn !strncmp(rs->s_v1.s_magic, reiserfs_3_5_magic_string,\n\t\t\tstrlen(reiserfs_3_5_magic_string));\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/crc32.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/init.h>",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"reiserfs.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/time.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char reiserfs_3_5_magic_string[] = REISERFS_SUPER_MAGIC_STRING;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/crc32.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/quotaops.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/blkdev.h>\n#include <linux/init.h>\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"reiserfs.h\"\n#include <linux/uaccess.h>\n#include <linux/time.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstatic const char reiserfs_3_5_magic_string[] = REISERFS_SUPER_MAGIC_STRING;\n\nint is_reiserfs_3_5(struct reiserfs_super_block *rs)\n{\n\treturn !strncmp(rs->s_v1.s_magic, reiserfs_3_5_magic_string,\n\t\t\tstrlen(reiserfs_3_5_magic_string));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_super_block(struct buffer_head *bh)\n{\n\tstruct reiserfs_super_block *rs =\n\t    (struct reiserfs_super_block *)(bh->b_data);\n\tint skipped, data_blocks;\n\tchar *version;\n\tchar b[BDEVNAME_SIZE];\n\n\tif (is_reiserfs_3_5(rs)) {\n\t\tversion = \"3.5\";\n\t} else if (is_reiserfs_3_6(rs)) {\n\t\tversion = \"3.6\";\n\t} else if (is_reiserfs_jr(rs)) {\n\t\tversion = ((sb_version(rs) == REISERFS_VERSION_2) ?\n\t\t\t   \"3.6\" : \"3.5\");\n\t} else {\n\t\treturn 1;\n\t}\n\n\tprintk(\"%s\\'s super block is in block %llu\\n\", bdevname(bh->b_bdev, b),\n\t       (unsigned long long)bh->b_blocknr);\n\tprintk(\"Reiserfs version %s\\n\", version);\n\tprintk(\"Block count %u\\n\", sb_block_count(rs));\n\tprintk(\"Blocksize %d\\n\", sb_blocksize(rs));\n\tprintk(\"Free blocks %u\\n\", sb_free_blocks(rs));\n\t/*\n\t * FIXME: this would be confusing if\n\t * someone stores reiserfs super block in some data block ;)\n//    skipped = (bh->b_blocknr * bh->b_size) / sb_blocksize(rs);\n\t */\n\tskipped = bh->b_blocknr;\n\tdata_blocks = sb_block_count(rs) - skipped - 1 - sb_bmap_nr(rs) -\n\t    (!is_reiserfs_jr(rs) ? sb_jp_journal_size(rs) +\n\t     1 : sb_reserved_for_journal(rs)) - sb_free_blocks(rs);\n\tprintk\n\t    (\"Busy blocks (skipped %d, bitmaps - %d, journal (or reserved) blocks - %d\\n\"\n\t     \"1 super block, %d data blocks\\n\", skipped, sb_bmap_nr(rs),\n\t     (!is_reiserfs_jr(rs) ? (sb_jp_journal_size(rs) + 1) :\n\t      sb_reserved_for_journal(rs)), data_blocks);\n\tprintk(\"Root block %u\\n\", sb_root_block(rs));\n\tprintk(\"Journal block (first) %d\\n\", sb_jp_journal_1st_block(rs));\n\tprintk(\"Journal dev %d\\n\", sb_jp_journal_dev(rs));\n\tprintk(\"Journal orig size %d\\n\", sb_jp_journal_size(rs));\n\tprintk(\"FS state %d\\n\", sb_fs_state(rs));\n\tprintk(\"Hash function \\\"%s\\\"\\n\",\n\t       reiserfs_hashname(sb_hash_function_code(rs)));\n\n\tprintk(\"Tree height %d\\n\", sb_tree_height(rs));\n\treturn 0;\n}"
  },
  {
    "function_name": "reiserfs_hashname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "514-524",
    "snippet": "char *reiserfs_hashname(int code)\n{\n\tif (code == YURA_HASH)\n\t\treturn \"rupasov\";\n\tif (code == TEA_HASH)\n\t\treturn \"tea\";\n\tif (code == R5_HASH)\n\t\treturn \"r5\";\n\n\treturn \"unknown\";\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nchar *reiserfs_hashname(int code)\n{\n\tif (code == YURA_HASH)\n\t\treturn \"rupasov\";\n\tif (code == TEA_HASH)\n\t\treturn \"tea\";\n\tif (code == R5_HASH)\n\t\treturn \"r5\";\n\n\treturn \"unknown\";\n}"
  },
  {
    "function_name": "print_leaf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "458-512",
    "snippet": "static int print_leaf(struct buffer_head *bh, int print_mode, int first,\n\t\t      int last)\n{\n\tstruct block_head *blkh;\n\tstruct item_head *ih;\n\tint i, nr;\n\tint from, to;\n\n\tif (!B_IS_ITEMS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_leaf(bh);\n\n\tblkh = B_BLK_HEAD(bh);\n\tih = item_head(bh, 0);\n\tnr = blkh_nr_item(blkh);\n\n\tprintk\n\t    (\"\\n===================================================================\\n\");\n\treiserfs_printk(\"LEAF NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tif (!(print_mode & PRINT_LEAF_ITEMS)) {\n\t\treiserfs_printk(\"FIRST ITEM_KEY: %k, LAST ITEM KEY: %k\\n\",\n\t\t\t\t&(ih->ih_key), &((ih + nr - 1)->ih_key));\n\t\treturn 0;\n\t}\n\n\tif (first < 0 || first > nr - 1)\n\t\tfrom = 0;\n\telse\n\t\tfrom = first;\n\n\tif (last < 0 || last > nr)\n\t\tto = nr;\n\telse\n\t\tto = last;\n\n\tih += from;\n\tprintk\n\t    (\"-------------------------------------------------------------------------------\\n\");\n\tprintk\n\t    (\"|##|   type    |           key           | ilen | free_space | version | loc  |\\n\");\n\tfor (i = from; i < to; i++, ih++) {\n\t\tprintk\n\t\t    (\"-------------------------------------------------------------------------------\\n\");\n\t\treiserfs_printk(\"|%2d| %h |\\n\", i, ih);\n\t\tif (print_mode & PRINT_LEAF_ITEMS)\n\t\t\top_print_item(ih, ih_item_body(bh, ih));\n\t}\n\n\tprintk\n\t    (\"===================================================================\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"===================================================================\\n\""
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "op_print_item",
          "args": [
            "ih",
            "ih_item_body(bh, ih)"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_item_body",
          "args": [
            "bh",
            "ih"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "ih_item_body",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "2213-2217",
          "snippet": "static inline void *ih_item_body(const struct buffer_head *bh,\n\t\t\t\t const struct item_head *ih)\n{\n\treturn bh->b_data + ih_location(ih);\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void reiserfs_free_jh(struct buffer_head *bh);",
            "int reiserfs_add_tail_list(struct inode *inode, struct buffer_head *bh);",
            "int reiserfs_add_ordered_list(struct inode *inode, struct buffer_head *bh);",
            "int journal_mark_dirty(struct reiserfs_transaction_handle *,\n\t\t       struct buffer_head *bh);",
            "void reiserfs_restore_prepared_buffer(struct super_block *,\n\t\t\t\t      struct buffer_head *bh);",
            "int B_IS_IN_TREE(const struct buffer_head *);",
            "extern void decrement_bcount(struct buffer_head *bh);",
            "void reiserfs_unmap_buffer(struct buffer_head *);",
            "void print_block(struct buffer_head *bh, ...);",
            "void check_leaf(struct buffer_head *bh);",
            "void check_internal(struct buffer_head *bh);",
            "int balance_internal(struct tree_balance *, int, int, struct item_head *,\n\t\t     struct buffer_head **);",
            "void reiserfs_invalidate_buffer(struct tree_balance *tb,\n\t\t\t\tstruct buffer_head *bh);",
            "void replace_key(struct tree_balance *tb, struct buffer_head *, int,\n\t\t struct buffer_head *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nvoid reiserfs_free_jh(struct buffer_head *bh);\nint reiserfs_add_tail_list(struct inode *inode, struct buffer_head *bh);\nint reiserfs_add_ordered_list(struct inode *inode, struct buffer_head *bh);\nint journal_mark_dirty(struct reiserfs_transaction_handle *,\n\t\t       struct buffer_head *bh);\nvoid reiserfs_restore_prepared_buffer(struct super_block *,\n\t\t\t\t      struct buffer_head *bh);\nint B_IS_IN_TREE(const struct buffer_head *);\nextern void decrement_bcount(struct buffer_head *bh);\nvoid reiserfs_unmap_buffer(struct buffer_head *);\nvoid print_block(struct buffer_head *bh, ...);\nvoid check_leaf(struct buffer_head *bh);\nvoid check_internal(struct buffer_head *bh);\nint balance_internal(struct tree_balance *, int, int, struct item_head *,\n\t\t     struct buffer_head **);\nvoid reiserfs_invalidate_buffer(struct tree_balance *tb,\n\t\t\t\tstruct buffer_head *bh);\nvoid replace_key(struct tree_balance *tb, struct buffer_head *, int,\n\t\t struct buffer_head *, int);\n\nstatic inline void *ih_item_body(const struct buffer_head *bh,\n\t\t\t\t const struct item_head *ih)\n{\n\treturn bh->b_data + ih_location(ih);\n}"
        }
      },
      {
        "call_info": {
          "callee": "blkh_nr_item",
          "args": [
            "blkh"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item_head",
          "args": [
            "bh",
            "0"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_item_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "112-123",
          "snippet": "static void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "B_BLK_HEAD",
          "args": [
            "bh"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_leaf",
          "args": [
            "bh"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "check_leaf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "747-757",
          "snippet": "void check_leaf(struct buffer_head *bh)\n{\n\tint i;\n\tstruct item_head *ih;\n\n\tif (!bh)\n\t\treturn;\n\tcheck_leaf_block_head(bh);\n\tfor (i = 0, ih = item_head(bh, 0); i < B_NR_ITEMS(bh); i++, ih++)\n\t\top_check_item(ih, ih_item_body(bh, ih));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nvoid check_leaf(struct buffer_head *bh)\n{\n\tint i;\n\tstruct item_head *ih;\n\n\tif (!bh)\n\t\treturn;\n\tcheck_leaf_block_head(bh);\n\tfor (i = 0, ih = item_head(bh, 0); i < B_NR_ITEMS(bh); i++, ih++)\n\t\top_check_item(ih, ih_item_body(bh, ih));\n}"
        }
      },
      {
        "call_info": {
          "callee": "B_IS_ITEMS_LEVEL",
          "args": [
            "bh"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_leaf(struct buffer_head *bh, int print_mode, int first,\n\t\t      int last)\n{\n\tstruct block_head *blkh;\n\tstruct item_head *ih;\n\tint i, nr;\n\tint from, to;\n\n\tif (!B_IS_ITEMS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_leaf(bh);\n\n\tblkh = B_BLK_HEAD(bh);\n\tih = item_head(bh, 0);\n\tnr = blkh_nr_item(blkh);\n\n\tprintk\n\t    (\"\\n===================================================================\\n\");\n\treiserfs_printk(\"LEAF NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tif (!(print_mode & PRINT_LEAF_ITEMS)) {\n\t\treiserfs_printk(\"FIRST ITEM_KEY: %k, LAST ITEM KEY: %k\\n\",\n\t\t\t\t&(ih->ih_key), &((ih + nr - 1)->ih_key));\n\t\treturn 0;\n\t}\n\n\tif (first < 0 || first > nr - 1)\n\t\tfrom = 0;\n\telse\n\t\tfrom = first;\n\n\tif (last < 0 || last > nr)\n\t\tto = nr;\n\telse\n\t\tto = last;\n\n\tih += from;\n\tprintk\n\t    (\"-------------------------------------------------------------------------------\\n\");\n\tprintk\n\t    (\"|##|   type    |           key           | ilen | free_space | version | loc  |\\n\");\n\tfor (i = from; i < to; i++, ih++) {\n\t\tprintk\n\t\t    (\"-------------------------------------------------------------------------------\\n\");\n\t\treiserfs_printk(\"|%2d| %h |\\n\", i, ih);\n\t\tif (print_mode & PRINT_LEAF_ITEMS)\n\t\t\top_print_item(ih, ih_item_body(bh, ih));\n\t}\n\n\tprintk\n\t    (\"===================================================================\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "print_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "423-456",
    "snippet": "static int print_internal(struct buffer_head *bh, int first, int last)\n{\n\tstruct reiserfs_key *key;\n\tstruct disk_child *dc;\n\tint i;\n\tint from, to;\n\n\tif (!B_IS_KEYS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_internal(bh);\n\n\tif (first == -1) {\n\t\tfrom = 0;\n\t\tto = B_NR_ITEMS(bh);\n\t} else {\n\t\tfrom = first;\n\t\tto = last < B_NR_ITEMS(bh) ? last : B_NR_ITEMS(bh);\n\t}\n\n\treiserfs_printk(\"INTERNAL NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tdc = B_N_CHILD(bh, from);\n\treiserfs_printk(\"PTR %d: %y \", from, dc);\n\n\tfor (i = from, key = internal_key(bh, from), dc++; i < to;\n\t     i++, key++, dc++) {\n\t\treiserfs_printk(\"KEY %d: %k PTR %d: %y \", i, key, i + 1, dc);\n\t\tif (i && i % 4 == 0)\n\t\t\tprintk(\"\\n\");\n\t}\n\tprintk(\"\\n\");\n\treturn 0;\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"\\n\""
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "internal_key",
          "args": [
            "bh",
            "from"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "internal_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "2189-2195",
          "snippet": "static inline struct reiserfs_key *internal_key(struct buffer_head *bh,\n\t\t\t\t\t\tint item_num)\n{\n\tstruct reiserfs_key *key = reiserfs_node_data(bh);\n\n\treturn &key[item_num];\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void reiserfs_free_jh(struct buffer_head *bh);",
            "int reiserfs_add_tail_list(struct inode *inode, struct buffer_head *bh);",
            "int reiserfs_add_ordered_list(struct inode *inode, struct buffer_head *bh);",
            "int journal_mark_dirty(struct reiserfs_transaction_handle *,\n\t\t       struct buffer_head *bh);",
            "void reiserfs_restore_prepared_buffer(struct super_block *,\n\t\t\t\t      struct buffer_head *bh);",
            "int B_IS_IN_TREE(const struct buffer_head *);",
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "extern void decrement_bcount(struct buffer_head *bh);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "void reiserfs_unmap_buffer(struct buffer_head *);",
            "void print_indirect_item(struct buffer_head *bh, int item_num);",
            "void print_block(struct buffer_head *bh, ...);",
            "void check_leaf(struct buffer_head *bh);",
            "void check_internal(struct buffer_head *bh);",
            "int balance_internal(struct tree_balance *, int, int, struct item_head *,\n\t\t     struct buffer_head **);",
            "void reiserfs_invalidate_buffer(struct tree_balance *tb,\n\t\t\t\tstruct buffer_head *bh);",
            "void replace_key(struct tree_balance *tb, struct buffer_head *, int,\n\t\t struct buffer_head *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nvoid reiserfs_free_jh(struct buffer_head *bh);\nint reiserfs_add_tail_list(struct inode *inode, struct buffer_head *bh);\nint reiserfs_add_ordered_list(struct inode *inode, struct buffer_head *bh);\nint journal_mark_dirty(struct reiserfs_transaction_handle *,\n\t\t       struct buffer_head *bh);\nvoid reiserfs_restore_prepared_buffer(struct super_block *,\n\t\t\t\t      struct buffer_head *bh);\nint B_IS_IN_TREE(const struct buffer_head *);\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nextern void decrement_bcount(struct buffer_head *bh);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nvoid reiserfs_unmap_buffer(struct buffer_head *);\nvoid print_indirect_item(struct buffer_head *bh, int item_num);\nvoid print_block(struct buffer_head *bh, ...);\nvoid check_leaf(struct buffer_head *bh);\nvoid check_internal(struct buffer_head *bh);\nint balance_internal(struct tree_balance *, int, int, struct item_head *,\n\t\t     struct buffer_head **);\nvoid reiserfs_invalidate_buffer(struct tree_balance *tb,\n\t\t\t\tstruct buffer_head *bh);\nvoid replace_key(struct tree_balance *tb, struct buffer_head *, int,\n\t\t struct buffer_head *, int);\n\nstatic inline struct reiserfs_key *internal_key(struct buffer_head *bh,\n\t\t\t\t\t\tint item_num)\n{\n\tstruct reiserfs_key *key = reiserfs_node_data(bh);\n\n\treturn &key[item_num];\n}"
        }
      },
      {
        "call_info": {
          "callee": "B_N_CHILD",
          "args": [
            "bh",
            "from"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_internal",
          "args": [
            "bh"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "check_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "759-764",
          "snippet": "void check_internal(struct buffer_head *bh)\n{\n\tif (!bh)\n\t\treturn;\n\tcheck_internal_block_head(bh);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nvoid check_internal(struct buffer_head *bh)\n{\n\tif (!bh)\n\t\treturn;\n\tcheck_internal_block_head(bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "B_IS_KEYS_LEVEL",
          "args": [
            "bh"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic int print_internal(struct buffer_head *bh, int first, int last)\n{\n\tstruct reiserfs_key *key;\n\tstruct disk_child *dc;\n\tint i;\n\tint from, to;\n\n\tif (!B_IS_KEYS_LEVEL(bh))\n\t\treturn 1;\n\n\tcheck_internal(bh);\n\n\tif (first == -1) {\n\t\tfrom = 0;\n\t\tto = B_NR_ITEMS(bh);\n\t} else {\n\t\tfrom = first;\n\t\tto = last < B_NR_ITEMS(bh) ? last : B_NR_ITEMS(bh);\n\t}\n\n\treiserfs_printk(\"INTERNAL NODE (%ld) contains %z\\n\", bh->b_blocknr, bh);\n\n\tdc = B_N_CHILD(bh, from);\n\treiserfs_printk(\"PTR %d: %y \", from, dc);\n\n\tfor (i = from, key = internal_key(bh, from), dc++; i < to;\n\t     i++, key++, dc++) {\n\t\treiserfs_printk(\"KEY %d: %k PTR %d: %y \", i, key, i + 1, dc);\n\t\tif (i && i % 4 == 0)\n\t\t\tprintk(\"\\n\");\n\t}\n\tprintk(\"\\n\");\n\treturn 0;\n}"
  },
  {
    "function_name": "reiserfs_abort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "399-416",
    "snippet": "void reiserfs_abort(struct super_block *sb, int errno, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n\tif (reiserfs_error_panic(sb)) {\n\t\tpanic(KERN_CRIT \"REISERFS panic (device %s): %s\\n\", sb->s_id,\n\t\t      error_buf);\n\t}\n\n\tif (reiserfs_is_journal_aborted(SB_JOURNAL(sb)))\n\t\treturn;\n\n\tprintk(KERN_CRIT \"REISERFS abort (device %s): %s\\n\", sb->s_id,\n\t       error_buf);\n\n\tsb->s_flags |= MS_RDONLY;\n\treiserfs_abort_journal(sb, errno);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_abort_journal",
          "args": [
            "sb",
            "errno"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_abort_journal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/journal.c",
          "lines": "4388-4403",
          "snippet": "void reiserfs_abort_journal(struct super_block *sb, int errno)\n{\n\tstruct reiserfs_journal *journal = SB_JOURNAL(sb);\n\tif (test_bit(J_ABORTED, &journal->j_state))\n\t\treturn;\n\n\tif (!journal->j_errno)\n\t\tjournal->j_errno = errno;\n\n\tsb->s_flags |= MS_RDONLY;\n\tset_bit(J_ABORTED, &journal->j_state);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int journal_join(struct reiserfs_transaction_handle *th,\n\t\t\tstruct super_block *sb);",
            "static void release_journal_dev(struct super_block *super,\n\t\t\t       struct reiserfs_journal *journal);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/uaccess.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include \"reiserfs.h\"\n#include <linux/vmalloc.h>\n#include <linux/semaphore.h>\n#include <linux/time.h>\n\nstatic int journal_join(struct reiserfs_transaction_handle *th,\n\t\t\tstruct super_block *sb);\nstatic void release_journal_dev(struct super_block *super,\n\t\t\t       struct reiserfs_journal *journal);\n\nvoid reiserfs_abort_journal(struct super_block *sb, int errno)\n{\n\tstruct reiserfs_journal *journal = SB_JOURNAL(sb);\n\tif (test_bit(J_ABORTED, &journal->j_state))\n\t\treturn;\n\n\tif (!journal->j_errno)\n\t\tjournal->j_errno = errno;\n\n\tsb->s_flags |= MS_RDONLY;\n\tset_bit(J_ABORTED, &journal->j_state);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_CRIT \"REISERFS abort (device %s): %s\\n\"",
            "sb->s_id",
            "error_buf"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reiserfs_is_journal_aborted",
          "args": [
            "SB_JOURNAL(sb)"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_is_journal_aborted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "760-764",
          "snippet": "static inline int __reiserfs_is_journal_aborted(struct reiserfs_journal\n\t\t\t\t\t\t*journal)\n{\n\treturn test_bit(J_ABORTED, &journal->j_state);\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nstatic inline int __reiserfs_is_journal_aborted(struct reiserfs_journal\n\t\t\t\t\t\t*journal)\n{\n\treturn test_bit(J_ABORTED, &journal->j_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SB_JOURNAL",
          "args": [
            "sb"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "KERN_CRIT \"REISERFS panic (device %s): %s\\n\"",
            "sb->s_id",
            "error_buf"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "ufs_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/super.c",
          "lines": "319-342",
          "snippet": "void ufs_panic (struct super_block * sb, const char * function,\n\tconst char * fmt, ...)\n{\n\tstruct ufs_sb_private_info * uspi;\n\tstruct ufs_super_block_first * usb1;\n\tstruct va_format vaf;\n\tva_list args;\n\t\n\tuspi = UFS_SB(sb)->s_uspi;\n\tusb1 = ubh_get_usb_first(uspi);\n\t\n\tif (!(sb->s_flags & MS_RDONLY)) {\n\t\tusb1->fs_clean = UFS_FSBAD;\n\t\tubh_mark_buffer_dirty(USPI_UBH(uspi));\n\t\tufs_mark_sb_dirty(sb);\n\t}\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tsb->s_flags |= MS_RDONLY;\n\tpr_crit(\"panic (device %s): %s: %pV\\n\",\n\t\tsb->s_id, function, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"swab.h\"",
            "#include \"ufs.h\"",
            "#include \"ufs_fs.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/mount.h>",
            "#include <linux/log2.h>",
            "#include <linux/vfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/parser.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <asm/uaccess.h>",
            "#include <stdarg.h>",
            "#include <linux/bitops.h>",
            "#include <linux/module.h>",
            "#include <linux/exportfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"swab.h\"\n#include \"ufs.h\"\n#include \"ufs_fs.h\"\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n#include <linux/log2.h>\n#include <linux/vfs.h>\n#include <linux/buffer_head.h>\n#include <linux/parser.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <asm/uaccess.h>\n#include <stdarg.h>\n#include <linux/bitops.h>\n#include <linux/module.h>\n#include <linux/exportfs.h>\n\nvoid ufs_panic (struct super_block * sb, const char * function,\n\tconst char * fmt, ...)\n{\n\tstruct ufs_sb_private_info * uspi;\n\tstruct ufs_super_block_first * usb1;\n\tstruct va_format vaf;\n\tva_list args;\n\t\n\tuspi = UFS_SB(sb)->s_uspi;\n\tusb1 = ubh_get_usb_first(uspi);\n\t\n\tif (!(sb->s_flags & MS_RDONLY)) {\n\t\tusb1->fs_clean = UFS_FSBAD;\n\t\tubh_mark_buffer_dirty(USPI_UBH(uspi));\n\t\tufs_mark_sb_dirty(sb);\n\t}\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tsb->s_flags |= MS_RDONLY;\n\tpr_crit(\"panic (device %s): %s: %pV\\n\",\n\t\tsb->s_id, function, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reiserfs_error_panic",
          "args": [
            "sb"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_reiserfs_warning",
          "args": [
            "fmt"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid reiserfs_abort(struct super_block *sb, int errno, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n\tif (reiserfs_error_panic(sb)) {\n\t\tpanic(KERN_CRIT \"REISERFS panic (device %s): %s\\n\", sb->s_id,\n\t\t      error_buf);\n\t}\n\n\tif (reiserfs_is_journal_aborted(SB_JOURNAL(sb)))\n\t\treturn;\n\n\tprintk(KERN_CRIT \"REISERFS abort (device %s): %s\\n\", sb->s_id,\n\t       error_buf);\n\n\tsb->s_flags |= MS_RDONLY;\n\treiserfs_abort_journal(sb, errno);\n}"
  },
  {
    "function_name": "__reiserfs_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "374-397",
    "snippet": "void __reiserfs_error(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n\tBUG_ON(sb == NULL);\n\n\tif (reiserfs_error_panic(sb))\n\t\t__reiserfs_panic(sb, id, function, error_buf);\n\n\tif (id && id[0])\n\t\tprintk(KERN_CRIT \"REISERFS error (device %s): %s %s: %s\\n\",\n\t\t       sb->s_id, id, function, error_buf);\n\telse\n\t\tprintk(KERN_CRIT \"REISERFS error (device %s): %s: %s\\n\",\n\t\t       sb->s_id, function, error_buf);\n\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn;\n\n\treiserfs_info(sb, \"Remounting filesystem read-only\\n\");\n\tsb->s_flags |= MS_RDONLY;\n\treiserfs_abort_journal(sb, -EIO);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_abort_journal",
          "args": [
            "sb",
            "-EIO"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_abort_journal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/journal.c",
          "lines": "4388-4403",
          "snippet": "void reiserfs_abort_journal(struct super_block *sb, int errno)\n{\n\tstruct reiserfs_journal *journal = SB_JOURNAL(sb);\n\tif (test_bit(J_ABORTED, &journal->j_state))\n\t\treturn;\n\n\tif (!journal->j_errno)\n\t\tjournal->j_errno = errno;\n\n\tsb->s_flags |= MS_RDONLY;\n\tset_bit(J_ABORTED, &journal->j_state);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int journal_join(struct reiserfs_transaction_handle *th,\n\t\t\tstruct super_block *sb);",
            "static void release_journal_dev(struct super_block *super,\n\t\t\t       struct reiserfs_journal *journal);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/uaccess.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include \"reiserfs.h\"\n#include <linux/vmalloc.h>\n#include <linux/semaphore.h>\n#include <linux/time.h>\n\nstatic int journal_join(struct reiserfs_transaction_handle *th,\n\t\t\tstruct super_block *sb);\nstatic void release_journal_dev(struct super_block *super,\n\t\t\t       struct reiserfs_journal *journal);\n\nvoid reiserfs_abort_journal(struct super_block *sb, int errno)\n{\n\tstruct reiserfs_journal *journal = SB_JOURNAL(sb);\n\tif (test_bit(J_ABORTED, &journal->j_state))\n\t\treturn;\n\n\tif (!journal->j_errno)\n\t\tjournal->j_errno = errno;\n\n\tsb->s_flags |= MS_RDONLY;\n\tset_bit(J_ABORTED, &journal->j_state);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "reiserfs_info",
          "args": [
            "sb",
            "\"Remounting filesystem read-only\\n\""
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "280-288",
          "snippet": "void reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_CRIT \"REISERFS error (device %s): %s: %s\\n\"",
            "sb->s_id",
            "function",
            "error_buf"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__reiserfs_panic",
          "args": [
            "sb",
            "id",
            "function",
            "error_buf"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "356-372",
          "snippet": "void __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}"
        }
      },
      {
        "call_info": {
          "callee": "reiserfs_error_panic",
          "args": [
            "sb"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "sb == NULL"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_reiserfs_warning",
          "args": [
            "fmt"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_error(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n\tBUG_ON(sb == NULL);\n\n\tif (reiserfs_error_panic(sb))\n\t\t__reiserfs_panic(sb, id, function, error_buf);\n\n\tif (id && id[0])\n\t\tprintk(KERN_CRIT \"REISERFS error (device %s): %s %s: %s\\n\",\n\t\t       sb->s_id, id, function, error_buf);\n\telse\n\t\tprintk(KERN_CRIT \"REISERFS error (device %s): %s: %s\\n\",\n\t\t       sb->s_id, function, error_buf);\n\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn;\n\n\treiserfs_info(sb, \"Remounting filesystem read-only\\n\");\n\tsb->s_flags |= MS_RDONLY;\n\treiserfs_abort_journal(sb, -EIO);\n}"
  },
  {
    "function_name": "__reiserfs_panic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "356-372",
    "snippet": "void __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\"",
            "id ? id : \"\"",
            "id ? \" \" : \"\"",
            "function",
            "error_buf"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_stack",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_reiserfs_warning",
          "args": [
            "fmt"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}"
  },
  {
    "function_name": "reiserfs_debug",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "297-307",
    "snippet": "void reiserfs_debug(struct super_block *s, int level, const char *fmt, ...)\n{\n#ifdef CONFIG_REISERFS_CHECK\n\tdo_reiserfs_warning(fmt);\n\tif (s)\n\t\tprintk(KERN_DEBUG \"REISERFS debug (device %s): %s\\n\",\n\t\t       s->s_id, error_buf);\n\telse\n\t\tprintk(KERN_DEBUG \"REISERFS debug: %s\\n\", error_buf);\n#endif\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \"REISERFS debug: %s\\n\"",
            "error_buf"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_reiserfs_warning",
          "args": [
            "fmt"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid reiserfs_debug(struct super_block *s, int level, const char *fmt, ...)\n{\n#ifdef CONFIG_REISERFS_CHECK\n\tdo_reiserfs_warning(fmt);\n\tif (s)\n\t\tprintk(KERN_DEBUG \"REISERFS debug (device %s): %s\\n\",\n\t\t       s->s_id, error_buf);\n\telse\n\t\tprintk(KERN_DEBUG \"REISERFS debug: %s\\n\", error_buf);\n#endif\n}"
  },
  {
    "function_name": "reiserfs_printk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "291-295",
    "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "error_buf"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "do_reiserfs_warning",
          "args": [
            "fmt"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
  },
  {
    "function_name": "reiserfs_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "280-288",
    "snippet": "void reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"REISERFS %s:\"",
            "error_buf"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_reiserfs_warning",
          "args": [
            "fmt"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}"
  },
  {
    "function_name": "__reiserfs_warning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "266-277",
    "snippet": "void __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\"",
            "id ? id : \"\"",
            "id ? \" \" : \"\"",
            "function",
            "error_buf"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_reiserfs_warning",
          "args": [
            "fmt"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}"
  },
  {
    "function_name": "prepare_error_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "189-245",
    "snippet": "static void prepare_error_buf(const char *fmt, va_list args)\n{\n\tchar *fmt1 = fmt_buf;\n\tchar *k;\n\tchar *p = error_buf;\n\tint what;\n\n\tspin_lock(&error_lock);\n\n\tstrcpy(fmt1, fmt);\n\n\twhile ((k = is_there_reiserfs_struct(fmt1, &what)) != NULL) {\n\t\t*k = 0;\n\n\t\tp += vsprintf(p, fmt1, args);\n\n\t\tswitch (what) {\n\t\tcase 'k':\n\t\t\tsprintf_le_key(p, va_arg(args, struct reiserfs_key *));\n\t\t\tbreak;\n\t\tcase 'K':\n\t\t\tsprintf_cpu_key(p, va_arg(args, struct cpu_key *));\n\t\t\tbreak;\n\t\tcase 'h':\n\t\t\tsprintf_item_head(p, va_arg(args, struct item_head *));\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tsprintf_direntry(p,\n\t\t\t\t\t va_arg(args,\n\t\t\t\t\t\tstruct reiserfs_dir_entry *));\n\t\t\tbreak;\n\t\tcase 'y':\n\t\t\tsprintf_disk_child(p,\n\t\t\t\t\t   va_arg(args, struct disk_child *));\n\t\t\tbreak;\n\t\tcase 'z':\n\t\t\tsprintf_block_head(p,\n\t\t\t\t\t   va_arg(args, struct buffer_head *));\n\t\t\tbreak;\n\t\tcase 'b':\n\t\t\tsprintf_buffer_head(p,\n\t\t\t\t\t    va_arg(args, struct buffer_head *));\n\t\t\tbreak;\n\t\tcase 'a':\n\t\t\tsprintf_de_head(p,\n\t\t\t\t\tva_arg(args,\n\t\t\t\t\t       struct reiserfs_de_head *));\n\t\t\tbreak;\n\t\t}\n\n\t\tp += strlen(p);\n\t\tfmt1 = k + 2;\n\t}\n\tvsprintf(p, fmt1, args);\n\tspin_unlock(&error_lock);\n\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char error_buf[1024];",
      "static char fmt_buf[1024];",
      "static DEFINE_SPINLOCK(error_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&error_lock"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "vsprintf",
          "args": [
            "p",
            "fmt1",
            "args"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf_de_head",
          "args": [
            "p",
            "va_arg(args,\n\t\t\t\t\t       struct reiserfs_de_head *)"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_de_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "100-110",
          "snippet": "static void sprintf_de_head(char *buf, struct reiserfs_de_head *deh)\n{\n\tif (deh)\n\t\tsprintf(buf,\n\t\t\t\"[offset=%d dir_id=%d objectid=%d location=%d state=%04x]\",\n\t\t\tdeh_offset(deh), deh_dir_id(deh), deh_objectid(deh),\n\t\t\tdeh_location(deh), deh_state(deh));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_de_head(char *buf, struct reiserfs_de_head *deh)\n{\n\tif (deh)\n\t\tsprintf(buf,\n\t\t\t\"[offset=%d dir_id=%d objectid=%d location=%d state=%04x]\",\n\t\t\tdeh_offset(deh), deh_dir_id(deh), deh_objectid(deh),\n\t\t\tdeh_location(deh), deh_state(deh));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structreiserfs_de_head*"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf_buffer_head",
          "args": [
            "p",
            "va_arg(args, struct buffer_head *)"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_buffer_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "140-152",
          "snippet": "static void sprintf_buffer_head(char *buf, struct buffer_head *bh)\n{\n\tchar b[BDEVNAME_SIZE];\n\n\tsprintf(buf,\n\t\t\"dev %s, size %zd, blocknr %llu, count %d, state 0x%lx, page %p, (%s, %s, %s)\",\n\t\tbdevname(bh->b_bdev, b), bh->b_size,\n\t\t(unsigned long long)bh->b_blocknr, atomic_read(&(bh->b_count)),\n\t\tbh->b_state, bh->b_page,\n\t\tbuffer_uptodate(bh) ? \"UPTODATE\" : \"!UPTODATE\",\n\t\tbuffer_dirty(bh) ? \"DIRTY\" : \"CLEAN\",\n\t\tbuffer_locked(bh) ? \"LOCKED\" : \"UNLOCKED\");\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_buffer_head(char *buf, struct buffer_head *bh)\n{\n\tchar b[BDEVNAME_SIZE];\n\n\tsprintf(buf,\n\t\t\"dev %s, size %zd, blocknr %llu, count %d, state 0x%lx, page %p, (%s, %s, %s)\",\n\t\tbdevname(bh->b_bdev, b), bh->b_size,\n\t\t(unsigned long long)bh->b_blocknr, atomic_read(&(bh->b_count)),\n\t\tbh->b_state, bh->b_page,\n\t\tbuffer_uptodate(bh) ? \"UPTODATE\" : \"!UPTODATE\",\n\t\tbuffer_dirty(bh) ? \"DIRTY\" : \"CLEAN\",\n\t\tbuffer_locked(bh) ? \"LOCKED\" : \"UNLOCKED\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structbuffer_head*"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf_block_head",
          "args": [
            "p",
            "va_arg(args, struct buffer_head *)"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_block_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "134-138",
          "snippet": "static void sprintf_block_head(char *buf, struct buffer_head *bh)\n{\n\tsprintf(buf, \"level=%d, nr_items=%d, free_space=%d rdkey \",\n\t\tB_LEVEL(bh), B_NR_ITEMS(bh), B_FREE_SPACE(bh));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_block_head(char *buf, struct buffer_head *bh)\n{\n\tsprintf(buf, \"level=%d, nr_items=%d, free_space=%d rdkey \",\n\t\tB_LEVEL(bh), B_NR_ITEMS(bh), B_FREE_SPACE(bh));\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structbuffer_head*"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf_disk_child",
          "args": [
            "p",
            "va_arg(args, struct disk_child *)"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_disk_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "154-158",
          "snippet": "static void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structdisk_child*"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf_direntry",
          "args": [
            "p",
            "va_arg(args,\n\t\t\t\t\t\tstruct reiserfs_dir_entry *)"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_direntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "125-132",
          "snippet": "static void sprintf_direntry(char *buf, struct reiserfs_dir_entry *de)\n{\n\tchar name[20];\n\n\tmemcpy(name, de->de_name, de->de_namelen > 19 ? 19 : de->de_namelen);\n\tname[de->de_namelen > 19 ? 19 : de->de_namelen] = 0;\n\tsprintf(buf, \"\\\"%s\\\"==>[%d %d]\", name, de->de_dir_id, de->de_objectid);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_direntry(char *buf, struct reiserfs_dir_entry *de)\n{\n\tchar name[20];\n\n\tmemcpy(name, de->de_name, de->de_namelen > 19 ? 19 : de->de_namelen);\n\tname[de->de_namelen > 19 ? 19 : de->de_namelen] = 0;\n\tsprintf(buf, \"\\\"%s\\\"==>[%d %d]\", name, de->de_dir_id, de->de_objectid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structreiserfs_dir_entry*"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf_item_head",
          "args": [
            "p",
            "va_arg(args, struct item_head *)"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_item_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "112-123",
          "snippet": "static void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structitem_head*"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf_cpu_key",
          "args": [
            "p",
            "va_arg(args, struct cpu_key *)"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_cpu_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "90-98",
          "snippet": "static void sprintf_cpu_key(char *buf, struct cpu_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", key->on_disk_key.k_dir_id,\n\t\t\tkey->on_disk_key.k_objectid, reiserfs_cpu_offset(key),\n\t\t\tcpu_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_cpu_key(char *buf, struct cpu_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", key->on_disk_key.k_dir_id,\n\t\t\tkey->on_disk_key.k_objectid, reiserfs_cpu_offset(key),\n\t\t\tcpu_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structcpu_key*"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf_le_key",
          "args": [
            "p",
            "va_arg(args, struct reiserfs_key *)"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_le_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "79-87",
          "snippet": "static void sprintf_le_key(char *buf, struct reiserfs_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", le32_to_cpu(key->k_dir_id),\n\t\t\tle32_to_cpu(key->k_objectid), le_offset(key),\n\t\t\tle_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_le_key(char *buf, struct reiserfs_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", le32_to_cpu(key->k_dir_id),\n\t\t\tle32_to_cpu(key->k_objectid), le_offset(key),\n\t\t\tle_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "structreiserfs_key*"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsprintf",
          "args": [
            "p",
            "fmt1",
            "args"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_there_reiserfs_struct",
          "args": [
            "fmt1",
            "&what"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "is_there_reiserfs_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "160-173",
          "snippet": "static char *is_there_reiserfs_struct(char *fmt, int *what)\n{\n\tchar *k = fmt;\n\n\twhile ((k = strchr(k, '%')) != NULL) {\n\t\tif (k[1] == 'k' || k[1] == 'K' || k[1] == 'h' || k[1] == 't' ||\n\t\t    k[1] == 'z' || k[1] == 'b' || k[1] == 'y' || k[1] == 'a') {\n\t\t\t*what = k[1];\n\t\t\tbreak;\n\t\t}\n\t\tk++;\n\t}\n\treturn k;\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char *is_there_reiserfs_struct(char *fmt, int *what)\n{\n\tchar *k = fmt;\n\n\twhile ((k = strchr(k, '%')) != NULL) {\n\t\tif (k[1] == 'k' || k[1] == 'K' || k[1] == 'h' || k[1] == 't' ||\n\t\t    k[1] == 'z' || k[1] == 'b' || k[1] == 'y' || k[1] == 'a') {\n\t\t\t*what = k[1];\n\t\t\tbreak;\n\t\t}\n\t\tk++;\n\t}\n\treturn k;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fmt1",
            "fmt"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&error_lock"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\nstatic char fmt_buf[1024];\nstatic DEFINE_SPINLOCK(error_lock);\n\nstatic void prepare_error_buf(const char *fmt, va_list args)\n{\n\tchar *fmt1 = fmt_buf;\n\tchar *k;\n\tchar *p = error_buf;\n\tint what;\n\n\tspin_lock(&error_lock);\n\n\tstrcpy(fmt1, fmt);\n\n\twhile ((k = is_there_reiserfs_struct(fmt1, &what)) != NULL) {\n\t\t*k = 0;\n\n\t\tp += vsprintf(p, fmt1, args);\n\n\t\tswitch (what) {\n\t\tcase 'k':\n\t\t\tsprintf_le_key(p, va_arg(args, struct reiserfs_key *));\n\t\t\tbreak;\n\t\tcase 'K':\n\t\t\tsprintf_cpu_key(p, va_arg(args, struct cpu_key *));\n\t\t\tbreak;\n\t\tcase 'h':\n\t\t\tsprintf_item_head(p, va_arg(args, struct item_head *));\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tsprintf_direntry(p,\n\t\t\t\t\t va_arg(args,\n\t\t\t\t\t\tstruct reiserfs_dir_entry *));\n\t\t\tbreak;\n\t\tcase 'y':\n\t\t\tsprintf_disk_child(p,\n\t\t\t\t\t   va_arg(args, struct disk_child *));\n\t\t\tbreak;\n\t\tcase 'z':\n\t\t\tsprintf_block_head(p,\n\t\t\t\t\t   va_arg(args, struct buffer_head *));\n\t\t\tbreak;\n\t\tcase 'b':\n\t\t\tsprintf_buffer_head(p,\n\t\t\t\t\t    va_arg(args, struct buffer_head *));\n\t\t\tbreak;\n\t\tcase 'a':\n\t\t\tsprintf_de_head(p,\n\t\t\t\t\tva_arg(args,\n\t\t\t\t\t       struct reiserfs_de_head *));\n\t\t\tbreak;\n\t\t}\n\n\t\tp += strlen(p);\n\t\tfmt1 = k + 2;\n\t}\n\tvsprintf(p, fmt1, args);\n\tspin_unlock(&error_lock);\n\n}"
  },
  {
    "function_name": "is_there_reiserfs_struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "160-173",
    "snippet": "static char *is_there_reiserfs_struct(char *fmt, int *what)\n{\n\tchar *k = fmt;\n\n\twhile ((k = strchr(k, '%')) != NULL) {\n\t\tif (k[1] == 'k' || k[1] == 'K' || k[1] == 'h' || k[1] == 't' ||\n\t\t    k[1] == 'z' || k[1] == 'b' || k[1] == 'y' || k[1] == 'a') {\n\t\t\t*what = k[1];\n\t\t\tbreak;\n\t\t}\n\t\tk++;\n\t}\n\treturn k;\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "k",
            "'%'"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char *is_there_reiserfs_struct(char *fmt, int *what)\n{\n\tchar *k = fmt;\n\n\twhile ((k = strchr(k, '%')) != NULL) {\n\t\tif (k[1] == 'k' || k[1] == 'K' || k[1] == 'h' || k[1] == 't' ||\n\t\t    k[1] == 'z' || k[1] == 'b' || k[1] == 'y' || k[1] == 'a') {\n\t\t\t*what = k[1];\n\t\t\tbreak;\n\t\t}\n\t\tk++;\n\t}\n\treturn k;\n}"
  },
  {
    "function_name": "sprintf_disk_child",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "154-158",
    "snippet": "static void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[dc_number=%d, dc_size=%u]\"",
            "dc_block_number(dc)",
            "dc_size(dc)"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_sprintf_system_inode_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2_fs.h",
          "lines": "1609-1628",
          "snippet": "static inline int ocfs2_sprintf_system_inode_name(char *buf, int len,\n\t\t\t\t\t\t  int type, int slot)\n{\n\tint chars;\n\n        /*\n         * Global system inodes can only have one copy.  Everything\n         * after OCFS2_LAST_GLOBAL_SYSTEM_INODE in the system inode\n         * list has a copy per slot.\n         */\n\tif (type <= OCFS2_LAST_GLOBAL_SYSTEM_INODE)\n\t\tchars = snprintf(buf, len, \"%s\",\n\t\t\t\t ocfs2_system_inodes[type].si_name);\n\telse\n\t\tchars = snprintf(buf, len,\n\t\t\t\t ocfs2_system_inodes[type].si_name,\n\t\t\t\t slot);\n\n\treturn chars;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int ocfs2_sprintf_system_inode_name(char *buf, int len,\n\t\t\t\t\t\t  int type, int slot)\n{\n\tint chars;\n\n        /*\n         * Global system inodes can only have one copy.  Everything\n         * after OCFS2_LAST_GLOBAL_SYSTEM_INODE in the system inode\n         * list has a copy per slot.\n         */\n\tif (type <= OCFS2_LAST_GLOBAL_SYSTEM_INODE)\n\t\tchars = snprintf(buf, len, \"%s\",\n\t\t\t\t ocfs2_system_inodes[type].si_name);\n\telse\n\t\tchars = snprintf(buf, len,\n\t\t\t\t ocfs2_system_inodes[type].si_name,\n\t\t\t\t slot);\n\n\treturn chars;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dc_size",
          "args": [
            "dc"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dc_block_number",
          "args": [
            "dc"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}"
  },
  {
    "function_name": "sprintf_buffer_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "140-152",
    "snippet": "static void sprintf_buffer_head(char *buf, struct buffer_head *bh)\n{\n\tchar b[BDEVNAME_SIZE];\n\n\tsprintf(buf,\n\t\t\"dev %s, size %zd, blocknr %llu, count %d, state 0x%lx, page %p, (%s, %s, %s)\",\n\t\tbdevname(bh->b_bdev, b), bh->b_size,\n\t\t(unsigned long long)bh->b_blocknr, atomic_read(&(bh->b_count)),\n\t\tbh->b_state, bh->b_page,\n\t\tbuffer_uptodate(bh) ? \"UPTODATE\" : \"!UPTODATE\",\n\t\tbuffer_dirty(bh) ? \"DIRTY\" : \"CLEAN\",\n\t\tbuffer_locked(bh) ? \"LOCKED\" : \"UNLOCKED\");\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"dev %s, size %zd, blocknr %llu, count %d, state 0x%lx, page %p, (%s, %s, %s)\"",
            "bdevname(bh->b_bdev, b)",
            "bh->b_size",
            "(unsigned long long)bh->b_blocknr",
            "atomic_read(&(bh->b_count))",
            "bh->b_state",
            "bh->b_page",
            "buffer_uptodate(bh) ? \"UPTODATE\" : \"!UPTODATE\"",
            "buffer_dirty(bh) ? \"DIRTY\" : \"CLEAN\"",
            "buffer_locked(bh) ? \"LOCKED\" : \"UNLOCKED\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_locked",
          "args": [
            "bh"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "3758-3761",
          "snippet": "int btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nint btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&(bh->b_count)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdevname",
          "args": [
            "bh->b_bdev",
            "b"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_buffer_head(char *buf, struct buffer_head *bh)\n{\n\tchar b[BDEVNAME_SIZE];\n\n\tsprintf(buf,\n\t\t\"dev %s, size %zd, blocknr %llu, count %d, state 0x%lx, page %p, (%s, %s, %s)\",\n\t\tbdevname(bh->b_bdev, b), bh->b_size,\n\t\t(unsigned long long)bh->b_blocknr, atomic_read(&(bh->b_count)),\n\t\tbh->b_state, bh->b_page,\n\t\tbuffer_uptodate(bh) ? \"UPTODATE\" : \"!UPTODATE\",\n\t\tbuffer_dirty(bh) ? \"DIRTY\" : \"CLEAN\",\n\t\tbuffer_locked(bh) ? \"LOCKED\" : \"UNLOCKED\");\n}"
  },
  {
    "function_name": "sprintf_block_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "134-138",
    "snippet": "static void sprintf_block_head(char *buf, struct buffer_head *bh)\n{\n\tsprintf(buf, \"level=%d, nr_items=%d, free_space=%d rdkey \",\n\t\tB_LEVEL(bh), B_NR_ITEMS(bh), B_FREE_SPACE(bh));\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"level=%d, nr_items=%d, free_space=%d rdkey \"",
            "B_LEVEL(bh)",
            "B_NR_ITEMS(bh)",
            "B_FREE_SPACE(bh)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_FREE_SPACE",
          "args": [
            "bh"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_NR_ITEMS",
          "args": [
            "bh"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B_LEVEL",
          "args": [
            "bh"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_block_head(char *buf, struct buffer_head *bh)\n{\n\tsprintf(buf, \"level=%d, nr_items=%d, free_space=%d rdkey \",\n\t\tB_LEVEL(bh), B_NR_ITEMS(bh), B_FREE_SPACE(bh));\n}"
  },
  {
    "function_name": "sprintf_direntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "125-132",
    "snippet": "static void sprintf_direntry(char *buf, struct reiserfs_dir_entry *de)\n{\n\tchar name[20];\n\n\tmemcpy(name, de->de_name, de->de_namelen > 19 ? 19 : de->de_namelen);\n\tname[de->de_namelen > 19 ? 19 : de->de_namelen] = 0;\n\tsprintf(buf, \"\\\"%s\\\"==>[%d %d]\", name, de->de_dir_id, de->de_objectid);\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"\\\"%s\\\"==>[%d %d]\"",
            "name",
            "de->de_dir_id",
            "de->de_objectid"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "name",
            "de->de_name",
            "de->de_namelen > 19 ? 19 : de->de_namelen"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_direntry(char *buf, struct reiserfs_dir_entry *de)\n{\n\tchar name[20];\n\n\tmemcpy(name, de->de_name, de->de_namelen > 19 ? 19 : de->de_namelen);\n\tname[de->de_namelen > 19 ? 19 : de->de_namelen] = 0;\n\tsprintf(buf, \"\\\"%s\\\"==>[%d %d]\", name, de->de_dir_id, de->de_objectid);\n}"
  },
  {
    "function_name": "sprintf_item_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "112-123",
    "snippet": "static void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[NULL]\""
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_disk_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "154-158",
          "snippet": "static void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf + strlen(buf)",
            "\", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\"",
            "ih_item_len(ih)",
            "ih_location(ih)",
            "ih_free_space(ih)"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_free_space",
          "args": [
            "ih"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_location",
          "args": [
            "ih"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_item_len",
          "args": [
            "ih"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "buf"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf_le_key",
          "args": [
            "buf + strlen(buf)",
            "&(ih->ih_key)"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_le_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "79-87",
          "snippet": "static void sprintf_le_key(char *buf, struct reiserfs_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", le32_to_cpu(key->k_dir_id),\n\t\t\tle32_to_cpu(key->k_objectid), le_offset(key),\n\t\t\tle_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_le_key(char *buf, struct reiserfs_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", le32_to_cpu(key->k_dir_id),\n\t\t\tle32_to_cpu(key->k_objectid), le_offset(key),\n\t\t\tle_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "buf",
            "(ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_version",
          "args": [
            "ih"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_item_head(char *buf, struct item_head *ih)\n{\n\tif (ih) {\n\t\tstrcpy(buf,\n\t\t       (ih_version(ih) == KEY_FORMAT_3_6) ? \"*3.6* \" : \"*3.5*\");\n\t\tsprintf_le_key(buf + strlen(buf), &(ih->ih_key));\n\t\tsprintf(buf + strlen(buf), \", item_len %d, item_location %d, \"\n\t\t\t\"free_space(entry_count) %d\",\n\t\t\tih_item_len(ih), ih_location(ih), ih_free_space(ih));\n\t} else\n\t\tsprintf(buf, \"[NULL]\");\n}"
  },
  {
    "function_name": "sprintf_de_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "100-110",
    "snippet": "static void sprintf_de_head(char *buf, struct reiserfs_de_head *deh)\n{\n\tif (deh)\n\t\tsprintf(buf,\n\t\t\t\"[offset=%d dir_id=%d objectid=%d location=%d state=%04x]\",\n\t\t\tdeh_offset(deh), deh_dir_id(deh), deh_objectid(deh),\n\t\t\tdeh_location(deh), deh_state(deh));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[NULL]\""
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_disk_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "154-158",
          "snippet": "static void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[offset=%d dir_id=%d objectid=%d location=%d state=%04x]\"",
            "deh_offset(deh)",
            "deh_dir_id(deh)",
            "deh_objectid(deh)",
            "deh_location(deh)",
            "deh_state(deh)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_state",
          "args": [
            "deh"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_location",
          "args": [
            "deh"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_objectid",
          "args": [
            "deh"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_dir_id",
          "args": [
            "deh"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_offset",
          "args": [
            "deh"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_de_head(char *buf, struct reiserfs_de_head *deh)\n{\n\tif (deh)\n\t\tsprintf(buf,\n\t\t\t\"[offset=%d dir_id=%d objectid=%d location=%d state=%04x]\",\n\t\t\tdeh_offset(deh), deh_dir_id(deh), deh_objectid(deh),\n\t\t\tdeh_location(deh), deh_state(deh));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n\n}"
  },
  {
    "function_name": "sprintf_cpu_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "90-98",
    "snippet": "static void sprintf_cpu_key(char *buf, struct cpu_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", key->on_disk_key.k_dir_id,\n\t\t\tkey->on_disk_key.k_objectid, reiserfs_cpu_offset(key),\n\t\t\tcpu_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[NULL]\""
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_disk_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "154-158",
          "snippet": "static void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[%d %d %s %s]\"",
            "key->on_disk_key.k_dir_id",
            "key->on_disk_key.k_objectid",
            "reiserfs_cpu_offset(key)",
            "cpu_type(key)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_type",
          "args": [
            "key"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "48-59",
          "snippet": "static char *cpu_type(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (cpu_key_k_type(key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (cpu_key_k_type(key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char *cpu_type(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (cpu_key_k_type(key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (cpu_key_k_type(key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "reiserfs_cpu_offset",
          "args": [
            "key"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_cpu_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "17-29",
          "snippet": "static char *reiserfs_cpu_offset(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(cpu_key_k_offset(key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(cpu_key_k_offset(key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)cpu_key_k_offset(key));\n\treturn off_buf;\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char off_buf[80];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char off_buf[80];\n\nstatic char *reiserfs_cpu_offset(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(cpu_key_k_offset(key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(cpu_key_k_offset(key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)cpu_key_k_offset(key));\n\treturn off_buf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_cpu_key(char *buf, struct cpu_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", key->on_disk_key.k_dir_id,\n\t\t\tkey->on_disk_key.k_objectid, reiserfs_cpu_offset(key),\n\t\t\tcpu_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}"
  },
  {
    "function_name": "sprintf_le_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "79-87",
    "snippet": "static void sprintf_le_key(char *buf, struct reiserfs_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", le32_to_cpu(key->k_dir_id),\n\t\t\tle32_to_cpu(key->k_objectid), le_offset(key),\n\t\t\tle_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[NULL]\""
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "sprintf_disk_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "154-158",
          "snippet": "static void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_disk_child(char *buf, struct disk_child *dc)\n{\n\tsprintf(buf, \"[dc_number=%d, dc_size=%u]\", dc_block_number(dc),\n\t\tdc_size(dc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[%d %d %s %s]\"",
            "le32_to_cpu(key->k_dir_id)",
            "le32_to_cpu(key->k_objectid)",
            "le_offset(key)",
            "le_type(key)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le_type",
          "args": [
            "key"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "le_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "61-76",
          "snippet": "static char *le_type(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\n\tif (le_key_k_type(version, key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (le_key_k_type(version, key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (le_key_k_type(version, key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char *le_type(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\n\tif (le_key_k_type(version, key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (le_key_k_type(version, key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (le_key_k_type(version, key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "le_offset",
          "args": [
            "key"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "le_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "31-46",
          "snippet": "static char *le_offset(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(le_key_k_offset(version, key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(le_key_k_offset(version, key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)le_key_k_offset(version, key));\n\treturn off_buf;\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char off_buf[80];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char off_buf[80];\n\nstatic char *le_offset(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(le_key_k_offset(version, key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(le_key_k_offset(version, key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)le_key_k_offset(version, key));\n\treturn off_buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "key->k_objectid"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void sprintf_le_key(char *buf, struct reiserfs_key *key)\n{\n\tif (key)\n\t\tsprintf(buf, \"[%d %d %s %s]\", le32_to_cpu(key->k_dir_id),\n\t\t\tle32_to_cpu(key->k_objectid), le_offset(key),\n\t\t\tle_type(key));\n\telse\n\t\tsprintf(buf, \"[NULL]\");\n}"
  },
  {
    "function_name": "le_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "61-76",
    "snippet": "static char *le_type(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\n\tif (le_key_k_type(version, key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (le_key_k_type(version, key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (le_key_k_type(version, key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le_key_k_type",
          "args": [
            "version",
            "key"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1486-1493",
          "snippet": "static inline loff_t le_key_k_type(int version, const struct reiserfs_key *key)\n{\n\tif (version == KEY_FORMAT_3_5) {\n\t\tloff_t val = le32_to_cpu(key->u.k_offset_v1.k_uniqueness);\n\t\treturn uniqueness2type(val);\n\t} else\n\t\treturn offset_v2_k_type(&(key->u.k_offset_v2));\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t le_key_k_type(int version, const struct reiserfs_key *key)\n{\n\tif (version == KEY_FORMAT_3_5) {\n\t\tloff_t val = le32_to_cpu(key->u.k_offset_v1.k_uniqueness);\n\t\treturn uniqueness2type(val);\n\t} else\n\t\treturn offset_v2_k_type(&(key->u.k_offset_v2));\n}"
        }
      },
      {
        "call_info": {
          "callee": "le_key_version",
          "args": [
            "key"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "2980-2991",
          "snippet": "static inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define TYPE_DIRENTRY 3",
            "#define TYPE_DIRECT 2",
            "#define TYPE_INDIRECT 1",
            "#define KEY_FORMAT_3_6 1",
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define TYPE_DIRENTRY 3\n#define TYPE_DIRECT 2\n#define TYPE_INDIRECT 1\n#define KEY_FORMAT_3_6 1\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char *le_type(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\n\tif (le_key_k_type(version, key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (le_key_k_type(version, key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (le_key_k_type(version, key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}"
  },
  {
    "function_name": "cpu_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "48-59",
    "snippet": "static char *cpu_type(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (cpu_key_k_type(key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (cpu_key_k_type(key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_key_k_type",
          "args": [
            "key"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1588-1591",
          "snippet": "static inline loff_t cpu_key_k_type(const struct cpu_key *key)\n{\n\treturn key->on_disk_key.k_type;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t cpu_key_k_type(const struct cpu_key *key)\n{\n\treturn key->on_disk_key.k_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char *cpu_type(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_STAT_DATA)\n\t\treturn \"SD\";\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\treturn \"DIR\";\n\tif (cpu_key_k_type(key) == TYPE_DIRECT)\n\t\treturn \"DIRECT\";\n\tif (cpu_key_k_type(key) == TYPE_INDIRECT)\n\t\treturn \"IND\";\n\treturn \"UNKNOWN\";\n}"
  },
  {
    "function_name": "le_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "31-46",
    "snippet": "static char *le_offset(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(le_key_k_offset(version, key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(le_key_k_offset(version, key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)le_key_k_offset(version, key));\n\treturn off_buf;\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char off_buf[80];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "off_buf",
            "\"0x%Lx\"",
            "(unsigned long long)le_key_k_offset(version, key)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le_key_k_offset",
          "args": [
            "version",
            "key"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_k_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1473-1479",
          "snippet": "static inline loff_t le_key_k_offset(int version,\n\t\t\t\t     const struct reiserfs_key *key)\n{\n\treturn (version == KEY_FORMAT_3_5) ?\n\t    le32_to_cpu(key->u.k_offset_v1.k_offset) :\n\t    offset_v2_k_offset(&(key->u.k_offset_v2));\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t le_key_k_offset(int version,\n\t\t\t\t     const struct reiserfs_key *key)\n{\n\treturn (version == KEY_FORMAT_3_5) ?\n\t    le32_to_cpu(key->u.k_offset_v1.k_offset) :\n\t    offset_v2_k_offset(&(key->u.k_offset_v2));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "off_buf",
            "\"%llu(%llu)\"",
            "(unsigned long long)\n\t\t\tGET_HASH_VALUE(le_key_k_offset(version, key))",
            "(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(le_key_k_offset(version, key))"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_sprintf_system_inode_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2_fs.h",
          "lines": "1609-1628",
          "snippet": "static inline int ocfs2_sprintf_system_inode_name(char *buf, int len,\n\t\t\t\t\t\t  int type, int slot)\n{\n\tint chars;\n\n        /*\n         * Global system inodes can only have one copy.  Everything\n         * after OCFS2_LAST_GLOBAL_SYSTEM_INODE in the system inode\n         * list has a copy per slot.\n         */\n\tif (type <= OCFS2_LAST_GLOBAL_SYSTEM_INODE)\n\t\tchars = snprintf(buf, len, \"%s\",\n\t\t\t\t ocfs2_system_inodes[type].si_name);\n\telse\n\t\tchars = snprintf(buf, len,\n\t\t\t\t ocfs2_system_inodes[type].si_name,\n\t\t\t\t slot);\n\n\treturn chars;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int ocfs2_sprintf_system_inode_name(char *buf, int len,\n\t\t\t\t\t\t  int type, int slot)\n{\n\tint chars;\n\n        /*\n         * Global system inodes can only have one copy.  Everything\n         * after OCFS2_LAST_GLOBAL_SYSTEM_INODE in the system inode\n         * list has a copy per slot.\n         */\n\tif (type <= OCFS2_LAST_GLOBAL_SYSTEM_INODE)\n\t\tchars = snprintf(buf, len, \"%s\",\n\t\t\t\t ocfs2_system_inodes[type].si_name);\n\telse\n\t\tchars = snprintf(buf, len,\n\t\t\t\t ocfs2_system_inodes[type].si_name,\n\t\t\t\t slot);\n\n\treturn chars;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_GENERATION_NUMBER",
          "args": [
            "le_key_k_offset(version, key)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HASH_VALUE",
          "args": [
            "le_key_k_offset(version, key)"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le_key_k_type",
          "args": [
            "version",
            "key"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1486-1493",
          "snippet": "static inline loff_t le_key_k_type(int version, const struct reiserfs_key *key)\n{\n\tif (version == KEY_FORMAT_3_5) {\n\t\tloff_t val = le32_to_cpu(key->u.k_offset_v1.k_uniqueness);\n\t\treturn uniqueness2type(val);\n\t} else\n\t\treturn offset_v2_k_type(&(key->u.k_offset_v2));\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t le_key_k_type(int version, const struct reiserfs_key *key)\n{\n\tif (version == KEY_FORMAT_3_5) {\n\t\tloff_t val = le32_to_cpu(key->u.k_offset_v1.k_uniqueness);\n\t\treturn uniqueness2type(val);\n\t} else\n\t\treturn offset_v2_k_type(&(key->u.k_offset_v2));\n}"
        }
      },
      {
        "call_info": {
          "callee": "le_key_version",
          "args": [
            "key"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "2980-2991",
          "snippet": "static inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define TYPE_DIRENTRY 3",
            "#define TYPE_DIRECT 2",
            "#define TYPE_INDIRECT 1",
            "#define KEY_FORMAT_3_6 1",
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define TYPE_DIRENTRY 3\n#define TYPE_DIRECT 2\n#define TYPE_INDIRECT 1\n#define KEY_FORMAT_3_6 1\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char off_buf[80];\n\nstatic char *le_offset(struct reiserfs_key *key)\n{\n\tint version;\n\n\tversion = le_key_version(key);\n\tif (le_key_k_type(version, key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(le_key_k_offset(version, key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(le_key_k_offset(version, key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)le_key_k_offset(version, key));\n\treturn off_buf;\n}"
  },
  {
    "function_name": "reiserfs_cpu_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
    "lines": "17-29",
    "snippet": "static char *reiserfs_cpu_offset(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(cpu_key_k_offset(key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(cpu_key_k_offset(key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)cpu_key_k_offset(key));\n\treturn off_buf;\n}",
    "includes": [
      "#include <stdarg.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/string.h>",
      "#include \"reiserfs.h\"",
      "#include <linux/fs.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char off_buf[80];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "off_buf",
            "\"0x%Lx\"",
            "(unsigned long long)cpu_key_k_offset(key)"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_key_k_offset",
          "args": [
            "key"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_key_k_offset_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1603-1606",
          "snippet": "static inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "off_buf",
            "\"%llu(%llu)\"",
            "(unsigned long long)\n\t\t\tGET_HASH_VALUE(cpu_key_k_offset(key))",
            "(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(cpu_key_k_offset(key))"
          ],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_sprintf_system_inode_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2_fs.h",
          "lines": "1609-1628",
          "snippet": "static inline int ocfs2_sprintf_system_inode_name(char *buf, int len,\n\t\t\t\t\t\t  int type, int slot)\n{\n\tint chars;\n\n        /*\n         * Global system inodes can only have one copy.  Everything\n         * after OCFS2_LAST_GLOBAL_SYSTEM_INODE in the system inode\n         * list has a copy per slot.\n         */\n\tif (type <= OCFS2_LAST_GLOBAL_SYSTEM_INODE)\n\t\tchars = snprintf(buf, len, \"%s\",\n\t\t\t\t ocfs2_system_inodes[type].si_name);\n\telse\n\t\tchars = snprintf(buf, len,\n\t\t\t\t ocfs2_system_inodes[type].si_name,\n\t\t\t\t slot);\n\n\treturn chars;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int ocfs2_sprintf_system_inode_name(char *buf, int len,\n\t\t\t\t\t\t  int type, int slot)\n{\n\tint chars;\n\n        /*\n         * Global system inodes can only have one copy.  Everything\n         * after OCFS2_LAST_GLOBAL_SYSTEM_INODE in the system inode\n         * list has a copy per slot.\n         */\n\tif (type <= OCFS2_LAST_GLOBAL_SYSTEM_INODE)\n\t\tchars = snprintf(buf, len, \"%s\",\n\t\t\t\t ocfs2_system_inodes[type].si_name);\n\telse\n\t\tchars = snprintf(buf, len,\n\t\t\t\t ocfs2_system_inodes[type].si_name,\n\t\t\t\t slot);\n\n\treturn chars;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_GENERATION_NUMBER",
          "args": [
            "cpu_key_k_offset(key)"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HASH_VALUE",
          "args": [
            "cpu_key_k_offset(key)"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_key_k_type",
          "args": [
            "key"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1588-1591",
          "snippet": "static inline loff_t cpu_key_k_type(const struct cpu_key *key)\n{\n\treturn key->on_disk_key.k_type;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t cpu_key_k_type(const struct cpu_key *key)\n{\n\treturn key->on_disk_key.k_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char off_buf[80];\n\nstatic char *reiserfs_cpu_offset(struct cpu_key *key)\n{\n\tif (cpu_key_k_type(key) == TYPE_DIRENTRY)\n\t\tsprintf(off_buf, \"%llu(%llu)\",\n\t\t\t(unsigned long long)\n\t\t\tGET_HASH_VALUE(cpu_key_k_offset(key)),\n\t\t\t(unsigned long long)\n\t\t\tGET_GENERATION_NUMBER(cpu_key_k_offset(key)));\n\telse\n\t\tsprintf(off_buf, \"0x%Lx\",\n\t\t\t(unsigned long long)cpu_key_k_offset(key));\n\treturn off_buf;\n}"
  }
]