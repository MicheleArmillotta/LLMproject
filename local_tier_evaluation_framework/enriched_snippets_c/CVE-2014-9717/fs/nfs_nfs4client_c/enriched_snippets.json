[
  {
    "function_name": "nfs4_update_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "1164-1232",
    "snippet": "int nfs4_update_server(struct nfs_server *server, const char *hostname,\n\t\t       struct sockaddr *sap, size_t salen, struct net *net)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct rpc_clnt *clnt = server->client;\n\tstruct xprt_create xargs = {\n\t\t.ident\t\t= clp->cl_proto,\n\t\t.net\t\t= net,\n\t\t.dstaddr\t= sap,\n\t\t.addrlen\t= salen,\n\t\t.servername\t= hostname,\n\t};\n\tchar buf[INET6_ADDRSTRLEN + 1];\n\tstruct sockaddr_storage address;\n\tstruct sockaddr *localaddr = (struct sockaddr *)&address;\n\tint error;\n\n\tdprintk(\"--> %s: move FSID %llx:%llx to \\\"%s\\\")\\n\", __func__,\n\t\t\t(unsigned long long)server->fsid.major,\n\t\t\t(unsigned long long)server->fsid.minor,\n\t\t\thostname);\n\n\terror = rpc_switch_client_transport(clnt, &xargs, clnt->cl_timeout);\n\tif (error != 0) {\n\t\tdprintk(\"<-- %s(): rpc_switch_client_transport returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\terror = rpc_localaddr(clnt, localaddr, sizeof(address));\n\tif (error != 0) {\n\t\tdprintk(\"<-- %s(): rpc_localaddr returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\terror = -EAFNOSUPPORT;\n\tif (rpc_ntop(localaddr, buf, sizeof(buf)) == 0) {\n\t\tdprintk(\"<-- %s(): rpc_ntop returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\tnfs_server_remove_lists(server);\n\terror = nfs4_set_client(server, hostname, sap, salen, buf,\n\t\t\t\tclp->cl_rpcclient->cl_auth->au_flavor,\n\t\t\t\tclp->cl_proto, clnt->cl_timeout,\n\t\t\t\tclp->cl_minorversion, net);\n\tnfs_put_client(clp);\n\tif (error != 0) {\n\t\tnfs_server_insert_lists(server);\n\t\tdprintk(\"<-- %s(): nfs4_set_client returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\tif (server->nfs_client->cl_hostname == NULL)\n\t\tserver->nfs_client->cl_hostname = kstrdup(hostname, GFP_KERNEL);\n\tnfs_server_insert_lists(server);\n\n\terror = nfs_probe_destination(server);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"<-- %s() succeeded\\n\", __func__);\n\nout:\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s() succeeded\\n\"",
            "__func__"
          ],
          "line": 1228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_probe_destination",
          "args": [
            "server"
          ],
          "line": 1224
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_probe_destination",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "1131-1147",
          "snippet": "static int nfs_probe_destination(struct nfs_server *server)\n{\n\tstruct inode *inode = server->super->s_root->d_inode;\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* Sanity: the probe won't work if the destination server\n\t * does not recognize the migrated FH. */\n\terror = nfs_probe_fsinfo(server, NFS_FH(inode), fattr);\n\n\tnfs_free_fattr(fattr);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs_probe_destination(struct nfs_server *server)\n{\n\tstruct inode *inode = server->super->s_root->d_inode;\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* Sanity: the probe won't work if the destination server\n\t * does not recognize the migrated FH. */\n\terror = nfs_probe_fsinfo(server, NFS_FH(inode), fattr);\n\n\tnfs_free_fattr(fattr);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_server_insert_lists",
          "args": [
            "server"
          ],
          "line": 1222
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_insert_lists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "945-956",
          "snippet": "void nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "hostname",
            "GFP_KERNEL"
          ],
          "line": 1221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s(): nfs4_set_client returned %d\\n\"",
            "__func__",
            "error"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "clp"
          ],
          "line": 1212
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_set_client",
          "args": [
            "server",
            "hostname",
            "sap",
            "salen",
            "buf",
            "clp->cl_rpcclient->cl_auth->au_flavor",
            "clp->cl_proto",
            "clnt->cl_timeout",
            "clp->cl_minorversion",
            "net"
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_set_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "787-837",
          "snippet": "static int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_server_remove_lists",
          "args": [
            "server"
          ],
          "line": 1207
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_remove_lists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "959-975",
          "snippet": "void nfs_server_remove_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn;\n\n\tif (clp == NULL)\n\t\treturn;\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_del_rcu(&server->client_link);\n\tif (list_empty(&clp->cl_superblocks))\n\t\tset_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tlist_del(&server->master_link);\n\tspin_unlock(&nn->nfs_client_lock);\n\n\tsynchronize_rcu();\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_remove_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn;\n\n\tif (clp == NULL)\n\t\treturn;\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_del_rcu(&server->client_link);\n\tif (list_empty(&clp->cl_superblocks))\n\t\tset_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tlist_del(&server->master_link);\n\tspin_unlock(&nn->nfs_client_lock);\n\n\tsynchronize_rcu();\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s(): rpc_ntop returned %d\\n\"",
            "__func__",
            "error"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_ntop",
          "args": [
            "localaddr",
            "buf",
            "sizeof(buf)"
          ],
          "line": 1201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s(): rpc_localaddr returned %d\\n\"",
            "__func__",
            "error"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_localaddr",
          "args": [
            "clnt",
            "localaddr",
            "sizeof(address)"
          ],
          "line": 1193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s(): rpc_switch_client_transport returned %d\\n\"",
            "__func__",
            "error"
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_switch_client_transport",
          "args": [
            "clnt",
            "&xargs",
            "clnt->cl_timeout"
          ],
          "line": 1186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> %s: move FSID %llx:%llx to \\\"%s\\\")\\n\"",
            "__func__",
            "(unsigned long long)server->fsid.major",
            "(unsigned long long)server->fsid.minor",
            "hostname"
          ],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nint nfs4_update_server(struct nfs_server *server, const char *hostname,\n\t\t       struct sockaddr *sap, size_t salen, struct net *net)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct rpc_clnt *clnt = server->client;\n\tstruct xprt_create xargs = {\n\t\t.ident\t\t= clp->cl_proto,\n\t\t.net\t\t= net,\n\t\t.dstaddr\t= sap,\n\t\t.addrlen\t= salen,\n\t\t.servername\t= hostname,\n\t};\n\tchar buf[INET6_ADDRSTRLEN + 1];\n\tstruct sockaddr_storage address;\n\tstruct sockaddr *localaddr = (struct sockaddr *)&address;\n\tint error;\n\n\tdprintk(\"--> %s: move FSID %llx:%llx to \\\"%s\\\")\\n\", __func__,\n\t\t\t(unsigned long long)server->fsid.major,\n\t\t\t(unsigned long long)server->fsid.minor,\n\t\t\thostname);\n\n\terror = rpc_switch_client_transport(clnt, &xargs, clnt->cl_timeout);\n\tif (error != 0) {\n\t\tdprintk(\"<-- %s(): rpc_switch_client_transport returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\terror = rpc_localaddr(clnt, localaddr, sizeof(address));\n\tif (error != 0) {\n\t\tdprintk(\"<-- %s(): rpc_localaddr returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\terror = -EAFNOSUPPORT;\n\tif (rpc_ntop(localaddr, buf, sizeof(buf)) == 0) {\n\t\tdprintk(\"<-- %s(): rpc_ntop returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\tnfs_server_remove_lists(server);\n\terror = nfs4_set_client(server, hostname, sap, salen, buf,\n\t\t\t\tclp->cl_rpcclient->cl_auth->au_flavor,\n\t\t\t\tclp->cl_proto, clnt->cl_timeout,\n\t\t\t\tclp->cl_minorversion, net);\n\tnfs_put_client(clp);\n\tif (error != 0) {\n\t\tnfs_server_insert_lists(server);\n\t\tdprintk(\"<-- %s(): nfs4_set_client returned %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto out;\n\t}\n\n\tif (server->nfs_client->cl_hostname == NULL)\n\t\tserver->nfs_client->cl_hostname = kstrdup(hostname, GFP_KERNEL);\n\tnfs_server_insert_lists(server);\n\n\terror = nfs_probe_destination(server);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"<-- %s() succeeded\\n\", __func__);\n\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_probe_destination",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "1131-1147",
    "snippet": "static int nfs_probe_destination(struct nfs_server *server)\n{\n\tstruct inode *inode = server->super->s_root->d_inode;\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* Sanity: the probe won't work if the destination server\n\t * does not recognize the migrated FH. */\n\terror = nfs_probe_fsinfo(server, NFS_FH(inode), fattr);\n\n\tnfs_free_fattr(fattr);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 1145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_probe_fsinfo",
          "args": [
            "server",
            "NFS_FH(inode)",
            "fattr"
          ],
          "line": 1143
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_probe_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "885-924",
          "snippet": "int nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs_probe_destination(struct nfs_server *server)\n{\n\tstruct inode *inode = server->super->s_root->d_inode;\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* Sanity: the probe won't work if the destination server\n\t * does not recognize the migrated FH. */\n\terror = nfs_probe_fsinfo(server, NFS_FH(inode), fattr);\n\n\tnfs_free_fattr(fattr);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs4_create_referral_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "1072-1123",
    "snippet": "struct nfs_server *nfs4_create_referral_server(struct nfs_clone_mount *data,\n\t\t\t\t\t       struct nfs_fh *mntfh)\n{\n\tstruct nfs_client *parent_client;\n\tstruct nfs_server *server, *parent_server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_referral_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tparent_server = NFS_SB(data->sb);\n\tparent_client = parent_server->nfs_client;\n\n\t/* Initialise the client representation from the parent server */\n\tnfs_server_copy_userdata(server, parent_server);\n\n\t/* Get a client representation.\n\t * Note: NFSv4 always uses TCP, */\n\terror = nfs4_set_client(server, data->hostname,\n\t\t\t\tdata->addr,\n\t\t\t\tdata->addrlen,\n\t\t\t\tparent_client->cl_ipaddr,\n\t\t\t\tdata->authflavor,\n\t\t\t\trpc_protocol(parent_server->client),\n\t\t\t\tparent_server->client->cl_timeout,\n\t\t\t\tparent_client->cl_mvops->minor_version,\n\t\t\t\tparent_client->cl_net);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs_init_server_rpcclient(server, parent_server->client->cl_timeout, data->authflavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\tauth_probe = parent_server->auth_info.flavor_len < 1;\n\n\terror = nfs4_server_common_setup(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs_create_referral_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_referral_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_create_referral_server() = error %d\\n\"",
            "error"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_server",
          "args": [
            "server"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "1023-1046",
          "snippet": "void nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_create_referral_server() = %p\\n\"",
            "server"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_server_common_setup",
          "args": [
            "server",
            "mntfh",
            "auth_probe"
          ],
          "line": 1112
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_server_common_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "909-966",
          "snippet": "static int nfs4_server_common_setup(struct nfs_server *server,\n\t\tstruct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\t/* data servers support only a subset of NFSv4.1 */\n\tif (is_ds_only_client(server->nfs_client))\n\t\treturn -EPROTONOSUPPORT;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* We must ensure the session is initialised first */\n\terror = nfs4_init_session(server->nfs_client);\n\tif (error < 0)\n\t\tgoto out;\n\n\t/* Set the basic capabilities */\n\tserver->caps |= server->nfs_client->cl_mvops->init_caps;\n\tif (server->flags & NFS_MOUNT_NORDIRPLUS)\n\t\t\tserver->caps &= ~NFS_CAP_READDIRPLUS;\n\t/*\n\t * Don't use NFS uid/gid mapping if we're using AUTH_SYS or lower\n\t * authentication.\n\t */\n\tif (nfs4_disable_idmapping &&\n\t\t\tserver->client->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\tserver->caps |= NFS_CAP_UIDGID_NOMAP;\n\n\n\t/* Probe the root fh to retrieve its FSID and filehandle */\n\terror = nfs4_get_rootfh(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t\t(unsigned long long) server->fsid.major,\n\t\t\t(unsigned long long) server->fsid.minor);\n\tnfs_display_fhandle(mntfh, \"Pseudo-fs root FH\");\n\n\tnfs4_session_set_rwsize(server);\n\n\terror = nfs_probe_fsinfo(server, mntfh, fattr);\n\tif (error < 0)\n\t\tgoto out;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tserver->destroy = nfs4_destroy_server;\nout:\n\tnfs_free_fattr(fattr);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_server_common_setup(struct nfs_server *server,\n\t\tstruct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\t/* data servers support only a subset of NFSv4.1 */\n\tif (is_ds_only_client(server->nfs_client))\n\t\treturn -EPROTONOSUPPORT;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* We must ensure the session is initialised first */\n\terror = nfs4_init_session(server->nfs_client);\n\tif (error < 0)\n\t\tgoto out;\n\n\t/* Set the basic capabilities */\n\tserver->caps |= server->nfs_client->cl_mvops->init_caps;\n\tif (server->flags & NFS_MOUNT_NORDIRPLUS)\n\t\t\tserver->caps &= ~NFS_CAP_READDIRPLUS;\n\t/*\n\t * Don't use NFS uid/gid mapping if we're using AUTH_SYS or lower\n\t * authentication.\n\t */\n\tif (nfs4_disable_idmapping &&\n\t\t\tserver->client->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\tserver->caps |= NFS_CAP_UIDGID_NOMAP;\n\n\n\t/* Probe the root fh to retrieve its FSID and filehandle */\n\terror = nfs4_get_rootfh(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t\t(unsigned long long) server->fsid.major,\n\t\t\t(unsigned long long) server->fsid.minor);\n\tnfs_display_fhandle(mntfh, \"Pseudo-fs root FH\");\n\n\tnfs4_session_set_rwsize(server);\n\n\terror = nfs_probe_fsinfo(server, mntfh, fattr);\n\tif (error < 0)\n\t\tgoto out;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tserver->destroy = nfs4_destroy_server;\nout:\n\tnfs_free_fattr(fattr);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_server_rpcclient",
          "args": [
            "server",
            "parent_server->client->cl_timeout",
            "data->authflavor"
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_server_rpcclient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "675-697",
          "snippet": "int nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_set_client",
          "args": [
            "server",
            "data->hostname",
            "data->addr",
            "data->addrlen",
            "parent_client->cl_ipaddr",
            "data->authflavor",
            "rpc_protocol(parent_server->client)",
            "parent_server->client->cl_timeout",
            "parent_client->cl_mvops->minor_version",
            "parent_client->cl_net"
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_set_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "787-837",
          "snippet": "static int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_protocol",
          "args": [
            "parent_server->client"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_copy_userdata",
          "args": [
            "server",
            "parent_server"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_copy_userdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "930-942",
          "snippet": "void nfs_server_copy_userdata(struct nfs_server *target, struct nfs_server *source)\n{\n\ttarget->flags = source->flags;\n\ttarget->rsize = source->rsize;\n\ttarget->wsize = source->wsize;\n\ttarget->acregmin = source->acregmin;\n\ttarget->acregmax = source->acregmax;\n\ttarget->acdirmin = source->acdirmin;\n\ttarget->acdirmax = source->acdirmax;\n\ttarget->caps = source->caps;\n\ttarget->options = source->options;\n\ttarget->auth_info = source->auth_info;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_copy_userdata(struct nfs_server *target, struct nfs_server *source)\n{\n\ttarget->flags = source->flags;\n\ttarget->rsize = source->rsize;\n\ttarget->wsize = source->wsize;\n\ttarget->acregmin = source->acregmin;\n\ttarget->acregmax = source->acregmax;\n\ttarget->acdirmin = source->acdirmin;\n\ttarget->acdirmax = source->acdirmax;\n\ttarget->caps = source->caps;\n\ttarget->options = source->options;\n\ttarget->auth_info = source->auth_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "data->sb"
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_server",
          "args": [],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "981-1017",
          "snippet": "struct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs4_create_referral_server()\\n\""
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs4_create_referral_server(struct nfs_clone_mount *data,\n\t\t\t\t\t       struct nfs_fh *mntfh)\n{\n\tstruct nfs_client *parent_client;\n\tstruct nfs_server *server, *parent_server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_referral_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tparent_server = NFS_SB(data->sb);\n\tparent_client = parent_server->nfs_client;\n\n\t/* Initialise the client representation from the parent server */\n\tnfs_server_copy_userdata(server, parent_server);\n\n\t/* Get a client representation.\n\t * Note: NFSv4 always uses TCP, */\n\terror = nfs4_set_client(server, data->hostname,\n\t\t\t\tdata->addr,\n\t\t\t\tdata->addrlen,\n\t\t\t\tparent_client->cl_ipaddr,\n\t\t\t\tdata->authflavor,\n\t\t\t\trpc_protocol(parent_server->client),\n\t\t\t\tparent_server->client->cl_timeout,\n\t\t\t\tparent_client->cl_mvops->minor_version,\n\t\t\t\tparent_client->cl_net);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs_init_server_rpcclient(server, parent_server->client->cl_timeout, data->authflavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\tauth_probe = parent_server->auth_info.flavor_len < 1;\n\n\terror = nfs4_server_common_setup(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs_create_referral_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_referral_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}"
  },
  {
    "function_name": "nfs4_create_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "1036-1067",
    "snippet": "struct nfs_server *nfs4_create_server(struct nfs_mount_info *mount_info,\n\t\t\t\t      struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tauth_probe = mount_info->parsed->auth_info.flavor_len < 1;\n\n\t/* set up the general RPC client */\n\terror = nfs4_init_server(server, mount_info->parsed);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs4_server_common_setup(server, mount_info->mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs4_create_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_create_server() = error %d\\n\"",
            "error"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_server",
          "args": [
            "server"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "1023-1046",
          "snippet": "void nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_create_server() = %p\\n\"",
            "server"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_server_common_setup",
          "args": [
            "server",
            "mount_info->mntfh",
            "auth_probe"
          ],
          "line": 1056
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_server_common_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "909-966",
          "snippet": "static int nfs4_server_common_setup(struct nfs_server *server,\n\t\tstruct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\t/* data servers support only a subset of NFSv4.1 */\n\tif (is_ds_only_client(server->nfs_client))\n\t\treturn -EPROTONOSUPPORT;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* We must ensure the session is initialised first */\n\terror = nfs4_init_session(server->nfs_client);\n\tif (error < 0)\n\t\tgoto out;\n\n\t/* Set the basic capabilities */\n\tserver->caps |= server->nfs_client->cl_mvops->init_caps;\n\tif (server->flags & NFS_MOUNT_NORDIRPLUS)\n\t\t\tserver->caps &= ~NFS_CAP_READDIRPLUS;\n\t/*\n\t * Don't use NFS uid/gid mapping if we're using AUTH_SYS or lower\n\t * authentication.\n\t */\n\tif (nfs4_disable_idmapping &&\n\t\t\tserver->client->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\tserver->caps |= NFS_CAP_UIDGID_NOMAP;\n\n\n\t/* Probe the root fh to retrieve its FSID and filehandle */\n\terror = nfs4_get_rootfh(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t\t(unsigned long long) server->fsid.major,\n\t\t\t(unsigned long long) server->fsid.minor);\n\tnfs_display_fhandle(mntfh, \"Pseudo-fs root FH\");\n\n\tnfs4_session_set_rwsize(server);\n\n\terror = nfs_probe_fsinfo(server, mntfh, fattr);\n\tif (error < 0)\n\t\tgoto out;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tserver->destroy = nfs4_destroy_server;\nout:\n\tnfs_free_fattr(fattr);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_server_common_setup(struct nfs_server *server,\n\t\tstruct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\t/* data servers support only a subset of NFSv4.1 */\n\tif (is_ds_only_client(server->nfs_client))\n\t\treturn -EPROTONOSUPPORT;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* We must ensure the session is initialised first */\n\terror = nfs4_init_session(server->nfs_client);\n\tif (error < 0)\n\t\tgoto out;\n\n\t/* Set the basic capabilities */\n\tserver->caps |= server->nfs_client->cl_mvops->init_caps;\n\tif (server->flags & NFS_MOUNT_NORDIRPLUS)\n\t\t\tserver->caps &= ~NFS_CAP_READDIRPLUS;\n\t/*\n\t * Don't use NFS uid/gid mapping if we're using AUTH_SYS or lower\n\t * authentication.\n\t */\n\tif (nfs4_disable_idmapping &&\n\t\t\tserver->client->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\tserver->caps |= NFS_CAP_UIDGID_NOMAP;\n\n\n\t/* Probe the root fh to retrieve its FSID and filehandle */\n\terror = nfs4_get_rootfh(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t\t(unsigned long long) server->fsid.major,\n\t\t\t(unsigned long long) server->fsid.minor);\n\tnfs_display_fhandle(mntfh, \"Pseudo-fs root FH\");\n\n\tnfs4_session_set_rwsize(server);\n\n\terror = nfs_probe_fsinfo(server, mntfh, fattr);\n\tif (error < 0)\n\t\tgoto out;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tserver->destroy = nfs4_destroy_server;\nout:\n\tnfs_free_fattr(fattr);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_init_server",
          "args": [
            "server",
            "mount_info->parsed"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_init_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "971-1028",
          "snippet": "static int nfs4_init_server(struct nfs_server *server,\n\t\tstruct nfs_parsed_mount_data *data)\n{\n\tstruct rpc_timeout timeparms;\n\tint error;\n\n\tdprintk(\"--> nfs4_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->auth_info = data->auth_info;\n\n\t/* Use the first specified auth flavor. If this flavor isn't\n\t * allowed by the server, use the SECINFO path to try the\n\t * other specified flavors */\n\tif (data->auth_info.flavor_len >= 1)\n\t\tdata->selected_flavor = data->auth_info.flavors[0];\n\telse\n\t\tdata->selected_flavor = RPC_AUTH_UNIX;\n\n\t/* Get a client record */\n\terror = nfs4_set_client(server,\n\t\t\tdata->nfs_server.hostname,\n\t\t\t(const struct sockaddr *)&data->nfs_server.address,\n\t\t\tdata->nfs_server.addrlen,\n\t\t\tdata->client_address,\n\t\t\tdata->selected_flavor,\n\t\t\tdata->nfs_server.protocol,\n\t\t\t&timeparms,\n\t\t\tdata->minorversion,\n\t\t\tdata->net);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\tserver->port = data->nfs_server.port;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\nerror:\n\t/* Done */\n\tdprintk(\"<-- nfs4_init_server() = %d\\n\", error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_init_server(struct nfs_server *server,\n\t\tstruct nfs_parsed_mount_data *data)\n{\n\tstruct rpc_timeout timeparms;\n\tint error;\n\n\tdprintk(\"--> nfs4_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->auth_info = data->auth_info;\n\n\t/* Use the first specified auth flavor. If this flavor isn't\n\t * allowed by the server, use the SECINFO path to try the\n\t * other specified flavors */\n\tif (data->auth_info.flavor_len >= 1)\n\t\tdata->selected_flavor = data->auth_info.flavors[0];\n\telse\n\t\tdata->selected_flavor = RPC_AUTH_UNIX;\n\n\t/* Get a client record */\n\terror = nfs4_set_client(server,\n\t\t\tdata->nfs_server.hostname,\n\t\t\t(const struct sockaddr *)&data->nfs_server.address,\n\t\t\tdata->nfs_server.addrlen,\n\t\t\tdata->client_address,\n\t\t\tdata->selected_flavor,\n\t\t\tdata->nfs_server.protocol,\n\t\t\t&timeparms,\n\t\t\tdata->minorversion,\n\t\t\tdata->net);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\tserver->port = data->nfs_server.port;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\nerror:\n\t/* Done */\n\tdprintk(\"<-- nfs4_init_server() = %d\\n\", error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_server",
          "args": [],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "981-1017",
          "snippet": "struct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs4_create_server()\\n\""
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs4_create_server(struct nfs_mount_info *mount_info,\n\t\t\t\t      struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tauth_probe = mount_info->parsed->auth_info.flavor_len < 1;\n\n\t/* set up the general RPC client */\n\terror = nfs4_init_server(server, mount_info->parsed);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs4_server_common_setup(server, mount_info->mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs4_create_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}"
  },
  {
    "function_name": "nfs4_init_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "971-1028",
    "snippet": "static int nfs4_init_server(struct nfs_server *server,\n\t\tstruct nfs_parsed_mount_data *data)\n{\n\tstruct rpc_timeout timeparms;\n\tint error;\n\n\tdprintk(\"--> nfs4_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->auth_info = data->auth_info;\n\n\t/* Use the first specified auth flavor. If this flavor isn't\n\t * allowed by the server, use the SECINFO path to try the\n\t * other specified flavors */\n\tif (data->auth_info.flavor_len >= 1)\n\t\tdata->selected_flavor = data->auth_info.flavors[0];\n\telse\n\t\tdata->selected_flavor = RPC_AUTH_UNIX;\n\n\t/* Get a client record */\n\terror = nfs4_set_client(server,\n\t\t\tdata->nfs_server.hostname,\n\t\t\t(const struct sockaddr *)&data->nfs_server.address,\n\t\t\tdata->nfs_server.addrlen,\n\t\t\tdata->client_address,\n\t\t\tdata->selected_flavor,\n\t\t\tdata->nfs_server.protocol,\n\t\t\t&timeparms,\n\t\t\tdata->minorversion,\n\t\t\tdata->net);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\tserver->port = data->nfs_server.port;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\nerror:\n\t/* Done */\n\tdprintk(\"<-- nfs4_init_server() = %d\\n\", error);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_init_server() = %d\\n\"",
            "error"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_init_server_rpcclient",
          "args": [
            "server",
            "&timeparms",
            "data->selected_flavor"
          ],
          "line": 1021
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_server_rpcclient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "675-697",
          "snippet": "int nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_block_size",
          "args": [
            "data->wsize",
            "NULL"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_block_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "579-588",
          "snippet": "static inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_set_client",
          "args": [
            "server",
            "data->nfs_server.hostname",
            "(const struct sockaddr *)&data->nfs_server.address",
            "data->nfs_server.addrlen",
            "data->client_address",
            "data->selected_flavor",
            "data->nfs_server.protocol",
            "&timeparms",
            "data->minorversion",
            "data->net"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_set_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "787-837",
          "snippet": "static int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_timeout_values",
          "args": [
            "&timeparms",
            "data->nfs_server.protocol",
            "data->timeo",
            "data->retrans"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_timeout_values",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "540-576",
          "snippet": "void nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs4_init_server()\\n\""
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_init_server(struct nfs_server *server,\n\t\tstruct nfs_parsed_mount_data *data)\n{\n\tstruct rpc_timeout timeparms;\n\tint error;\n\n\tdprintk(\"--> nfs4_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->auth_info = data->auth_info;\n\n\t/* Use the first specified auth flavor. If this flavor isn't\n\t * allowed by the server, use the SECINFO path to try the\n\t * other specified flavors */\n\tif (data->auth_info.flavor_len >= 1)\n\t\tdata->selected_flavor = data->auth_info.flavors[0];\n\telse\n\t\tdata->selected_flavor = RPC_AUTH_UNIX;\n\n\t/* Get a client record */\n\terror = nfs4_set_client(server,\n\t\t\tdata->nfs_server.hostname,\n\t\t\t(const struct sockaddr *)&data->nfs_server.address,\n\t\t\tdata->nfs_server.addrlen,\n\t\t\tdata->client_address,\n\t\t\tdata->selected_flavor,\n\t\t\tdata->nfs_server.protocol,\n\t\t\t&timeparms,\n\t\t\tdata->minorversion,\n\t\t\tdata->net);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\tserver->port = data->nfs_server.port;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\nerror:\n\t/* Done */\n\tdprintk(\"<-- nfs4_init_server() = %d\\n\", error);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs4_server_common_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "909-966",
    "snippet": "static int nfs4_server_common_setup(struct nfs_server *server,\n\t\tstruct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\t/* data servers support only a subset of NFSv4.1 */\n\tif (is_ds_only_client(server->nfs_client))\n\t\treturn -EPROTONOSUPPORT;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* We must ensure the session is initialised first */\n\terror = nfs4_init_session(server->nfs_client);\n\tif (error < 0)\n\t\tgoto out;\n\n\t/* Set the basic capabilities */\n\tserver->caps |= server->nfs_client->cl_mvops->init_caps;\n\tif (server->flags & NFS_MOUNT_NORDIRPLUS)\n\t\t\tserver->caps &= ~NFS_CAP_READDIRPLUS;\n\t/*\n\t * Don't use NFS uid/gid mapping if we're using AUTH_SYS or lower\n\t * authentication.\n\t */\n\tif (nfs4_disable_idmapping &&\n\t\t\tserver->client->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\tserver->caps |= NFS_CAP_UIDGID_NOMAP;\n\n\n\t/* Probe the root fh to retrieve its FSID and filehandle */\n\terror = nfs4_get_rootfh(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t\t(unsigned long long) server->fsid.major,\n\t\t\t(unsigned long long) server->fsid.minor);\n\tnfs_display_fhandle(mntfh, \"Pseudo-fs root FH\");\n\n\tnfs4_session_set_rwsize(server);\n\n\terror = nfs_probe_fsinfo(server, mntfh, fattr);\n\tif (error < 0)\n\t\tgoto out;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tserver->destroy = nfs4_destroy_server;\nout:\n\tnfs_free_fattr(fattr);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_insert_lists",
          "args": [
            "server"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_insert_lists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "945-956",
          "snippet": "void nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_probe_fsinfo",
          "args": [
            "server",
            "mntfh",
            "fattr"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_probe_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "885-924",
          "snippet": "int nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_session_set_rwsize",
          "args": [
            "server"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_session_set_rwsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "889-907",
          "snippet": "static void nfs4_session_set_rwsize(struct nfs_server *server)\n{\n#ifdef CONFIG_NFS_V4_1\n\tstruct nfs4_session *sess;\n\tu32 server_resp_sz;\n\tu32 server_rqst_sz;\n\n\tif (!nfs4_has_session(server->nfs_client))\n\t\treturn;\n\tsess = server->nfs_client->cl_session;\n\tserver_resp_sz = sess->fc_attrs.max_resp_sz - nfs41_maxread_overhead;\n\tserver_rqst_sz = sess->fc_attrs.max_rqst_sz - nfs41_maxwrite_overhead;\n\n\tif (server->rsize > server_resp_sz)\n\t\tserver->rsize = server_resp_sz;\n\tif (server->wsize > server_rqst_sz)\n\t\tserver->wsize = server_rqst_sz;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_session_set_rwsize(struct nfs_server *server)\n{\n#ifdef CONFIG_NFS_V4_1\n\tstruct nfs4_session *sess;\n\tu32 server_resp_sz;\n\tu32 server_rqst_sz;\n\n\tif (!nfs4_has_session(server->nfs_client))\n\t\treturn;\n\tsess = server->nfs_client->cl_session;\n\tserver_resp_sz = sess->fc_attrs.max_resp_sz - nfs41_maxread_overhead;\n\tserver_rqst_sz = sess->fc_attrs.max_rqst_sz - nfs41_maxwrite_overhead;\n\n\tif (server->rsize > server_resp_sz)\n\t\tserver->rsize = server_resp_sz;\n\tif (server->wsize > server_rqst_sz)\n\t\tserver->wsize = server_rqst_sz;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_display_fhandle",
          "args": [
            "mntfh",
            "\"Pseudo-fs root FH\""
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "_nfs_display_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1359-1393",
          "snippet": "void _nfs_display_fhandle(const struct nfs_fh *fh, const char *caption)\n{\n\tunsigned short i;\n\n\tif (fh == NULL || fh->size == 0) {\n\t\tprintk(KERN_DEFAULT \"%s at %p is empty\\n\", caption, fh);\n\t\treturn;\n\t}\n\n\tprintk(KERN_DEFAULT \"%s at %p is %u bytes, crc: 0x%08x:\\n\",\n\t       caption, fh, fh->size, _nfs_display_fhandle_hash(fh));\n\tfor (i = 0; i < fh->size; i += 16) {\n\t\t__be32 *pos = (__be32 *)&fh->data[i];\n\n\t\tswitch ((fh->size - i - 1) >> 2) {\n\t\tcase 0:\n\t\t\tprintk(KERN_DEFAULT \" %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos));\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1));\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2), be32_to_cpup(pos + 3));\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid _nfs_display_fhandle(const struct nfs_fh *fh, const char *caption)\n{\n\tunsigned short i;\n\n\tif (fh == NULL || fh->size == 0) {\n\t\tprintk(KERN_DEFAULT \"%s at %p is empty\\n\", caption, fh);\n\t\treturn;\n\t}\n\n\tprintk(KERN_DEFAULT \"%s at %p is %u bytes, crc: 0x%08x:\\n\",\n\t       caption, fh, fh->size, _nfs_display_fhandle_hash(fh));\n\tfor (i = 0; i < fh->size; i += 16) {\n\t\t__be32 *pos = (__be32 *)&fh->data[i];\n\n\t\tswitch ((fh->size - i - 1) >> 2) {\n\t\tcase 0:\n\t\t\tprintk(KERN_DEFAULT \" %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos));\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1));\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2), be32_to_cpup(pos + 3));\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"Server FSID: %llx:%llx\\n\"",
            "(unsigned long long) server->fsid.major",
            "(unsigned long long) server->fsid.minor"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_get_rootfh",
          "args": [
            "server",
            "mntfh",
            "auth_probe"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_get_rootfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4getroot.c",
          "lines": "12-50",
          "snippet": "int nfs4_get_rootfh(struct nfs_server *server, struct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tint ret = -ENOMEM;\n\n\tdprintk(\"--> nfs4_get_rootfh()\\n\");\n\n\tfsinfo.fattr = nfs_alloc_fattr();\n\tif (fsinfo.fattr == NULL)\n\t\tgoto out;\n\n\t/* Start by getting the root filehandle from the server */\n\tret = nfs4_proc_get_rootfh(server, mntfh, &fsinfo, auth_probe);\n\tif (ret < 0) {\n\t\tdprintk(\"nfs4_get_rootfh: getroot error = %d\\n\", -ret);\n\t\tgoto out;\n\t}\n\n\tif (!(fsinfo.fattr->valid & NFS_ATTR_FATTR_TYPE)\n\t\t\t|| !S_ISDIR(fsinfo.fattr->mode)) {\n\t\tprintk(KERN_ERR \"nfs4_get_rootfh:\"\n\t\t       \" getroot encountered non-directory\\n\");\n\t\tret = -ENOTDIR;\n\t\tgoto out;\n\t}\n\n\tif (fsinfo.fattr->valid & NFS_ATTR_FATTR_V4_REFERRAL) {\n\t\tprintk(KERN_ERR \"nfs4_get_rootfh:\"\n\t\t       \" getroot obtained referral\\n\");\n\t\tret = -EREMOTE;\n\t\tgoto out;\n\t}\n\n\tmemcpy(&server->fsid, &fsinfo.fattr->fsid, sizeof(server->fsid));\nout:\n\tnfs_free_fattr(fsinfo.fattr);\n\tdprintk(\"<-- nfs4_get_rootfh() = %d\\n\", ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n\nint nfs4_get_rootfh(struct nfs_server *server, struct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tint ret = -ENOMEM;\n\n\tdprintk(\"--> nfs4_get_rootfh()\\n\");\n\n\tfsinfo.fattr = nfs_alloc_fattr();\n\tif (fsinfo.fattr == NULL)\n\t\tgoto out;\n\n\t/* Start by getting the root filehandle from the server */\n\tret = nfs4_proc_get_rootfh(server, mntfh, &fsinfo, auth_probe);\n\tif (ret < 0) {\n\t\tdprintk(\"nfs4_get_rootfh: getroot error = %d\\n\", -ret);\n\t\tgoto out;\n\t}\n\n\tif (!(fsinfo.fattr->valid & NFS_ATTR_FATTR_TYPE)\n\t\t\t|| !S_ISDIR(fsinfo.fattr->mode)) {\n\t\tprintk(KERN_ERR \"nfs4_get_rootfh:\"\n\t\t       \" getroot encountered non-directory\\n\");\n\t\tret = -ENOTDIR;\n\t\tgoto out;\n\t}\n\n\tif (fsinfo.fattr->valid & NFS_ATTR_FATTR_V4_REFERRAL) {\n\t\tprintk(KERN_ERR \"nfs4_get_rootfh:\"\n\t\t       \" getroot obtained referral\\n\");\n\t\tret = -EREMOTE;\n\t\tgoto out;\n\t}\n\n\tmemcpy(&server->fsid, &fsinfo.fattr->fsid, sizeof(server->fsid));\nout:\n\tnfs_free_fattr(fsinfo.fattr);\n\tdprintk(\"<-- nfs4_get_rootfh() = %d\\n\", ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_init_session",
          "args": [
            "server->nfs_client"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_init_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "530-537",
          "snippet": "int nfs4_init_session(struct nfs_client *clp)\n{\n\tif (!nfs4_has_session(clp))\n\t\treturn 0;\n\n\tclear_bit(NFS4_SESSION_INITING, &clp->cl_session->session_state);\n\treturn nfs41_check_session_ready(clp);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nint nfs4_init_session(struct nfs_client *clp)\n{\n\tif (!nfs4_has_session(clp))\n\t\treturn 0;\n\n\tclear_bit(NFS4_SESSION_INITING, &clp->cl_session->session_state);\n\treturn nfs41_check_session_ready(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_ds_only_client",
          "args": [
            "server->nfs_client"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "is_ds_only_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "348-352",
          "snippet": "static inline bool\nis_ds_only_client(struct nfs_client *clp)\n{\n\treturn false;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\nis_ds_only_client(struct nfs_client *clp)\n{\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_server_common_setup(struct nfs_server *server,\n\t\tstruct nfs_fh *mntfh, bool auth_probe)\n{\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\t/* data servers support only a subset of NFSv4.1 */\n\tif (is_ds_only_client(server->nfs_client))\n\t\treturn -EPROTONOSUPPORT;\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\treturn -ENOMEM;\n\n\t/* We must ensure the session is initialised first */\n\terror = nfs4_init_session(server->nfs_client);\n\tif (error < 0)\n\t\tgoto out;\n\n\t/* Set the basic capabilities */\n\tserver->caps |= server->nfs_client->cl_mvops->init_caps;\n\tif (server->flags & NFS_MOUNT_NORDIRPLUS)\n\t\t\tserver->caps &= ~NFS_CAP_READDIRPLUS;\n\t/*\n\t * Don't use NFS uid/gid mapping if we're using AUTH_SYS or lower\n\t * authentication.\n\t */\n\tif (nfs4_disable_idmapping &&\n\t\t\tserver->client->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\tserver->caps |= NFS_CAP_UIDGID_NOMAP;\n\n\n\t/* Probe the root fh to retrieve its FSID and filehandle */\n\terror = nfs4_get_rootfh(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto out;\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t\t(unsigned long long) server->fsid.major,\n\t\t\t(unsigned long long) server->fsid.minor);\n\tnfs_display_fhandle(mntfh, \"Pseudo-fs root FH\");\n\n\tnfs4_session_set_rwsize(server);\n\n\terror = nfs_probe_fsinfo(server, mntfh, fattr);\n\tif (error < 0)\n\t\tgoto out;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tserver->destroy = nfs4_destroy_server;\nout:\n\tnfs_free_fattr(fattr);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs4_session_set_rwsize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "889-907",
    "snippet": "static void nfs4_session_set_rwsize(struct nfs_server *server)\n{\n#ifdef CONFIG_NFS_V4_1\n\tstruct nfs4_session *sess;\n\tu32 server_resp_sz;\n\tu32 server_rqst_sz;\n\n\tif (!nfs4_has_session(server->nfs_client))\n\t\treturn;\n\tsess = server->nfs_client->cl_session;\n\tserver_resp_sz = sess->fc_attrs.max_resp_sz - nfs41_maxread_overhead;\n\tserver_rqst_sz = sess->fc_attrs.max_rqst_sz - nfs41_maxwrite_overhead;\n\n\tif (server->rsize > server_resp_sz)\n\t\tserver->rsize = server_resp_sz;\n\tif (server->wsize > server_rqst_sz)\n\t\tserver->wsize = server_rqst_sz;\n#endif /* CONFIG_NFS_V4_1 */\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_has_session",
          "args": [
            "server->nfs_client"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_has_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "148-151",
          "snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_session_set_rwsize(struct nfs_server *server)\n{\n#ifdef CONFIG_NFS_V4_1\n\tstruct nfs4_session *sess;\n\tu32 server_resp_sz;\n\tu32 server_rqst_sz;\n\n\tif (!nfs4_has_session(server->nfs_client))\n\t\treturn;\n\tsess = server->nfs_client->cl_session;\n\tserver_resp_sz = sess->fc_attrs.max_resp_sz - nfs41_maxread_overhead;\n\tserver_rqst_sz = sess->fc_attrs.max_rqst_sz - nfs41_maxwrite_overhead;\n\n\tif (server->rsize > server_resp_sz)\n\t\tserver->rsize = server_resp_sz;\n\tif (server->wsize > server_rqst_sz)\n\t\tserver->wsize = server_rqst_sz;\n#endif /* CONFIG_NFS_V4_1 */\n}"
  },
  {
    "function_name": "nfs4_set_ds_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "849-881",
    "snippet": "struct nfs_client *nfs4_set_ds_client(struct nfs_client* mds_clp,\n\t\tconst struct sockaddr *ds_addr, int ds_addrlen,\n\t\tint ds_proto, unsigned int ds_timeo, unsigned int ds_retrans,\n\t\tu32 minor_version, rpc_authflavor_t au_flavor)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.addr = ds_addr,\n\t\t.addrlen = ds_addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = ds_proto,\n\t\t.minorversion = minor_version,\n\t\t.net = mds_clp->cl_net,\n\t};\n\tstruct rpc_timeout ds_timeout;\n\tstruct nfs_client *clp;\n\tchar buf[INET6_ADDRSTRLEN + 1];\n\n\tif (rpc_ntop(ds_addr, buf, sizeof(buf)) <= 0)\n\t\treturn ERR_PTR(-EINVAL);\n\tcl_init.hostname = buf;\n\n\t/*\n\t * Set an authflavor equual to the MDS value. Use the MDS nfs_client\n\t * cl_ipaddr so as to use the same EXCHANGE_ID co_ownerid as the MDS\n\t * (section 13.1 RFC 5661).\n\t */\n\tnfs_init_timeout_values(&ds_timeout, ds_proto, ds_timeo, ds_retrans);\n\tclp = nfs_get_client(&cl_init, &ds_timeout, mds_clp->cl_ipaddr,\n\t\t\t     au_flavor);\n\n\tdprintk(\"<-- %s %p\\n\", __func__, clp);\n\treturn clp;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s %p\\n\"",
            "__func__",
            "clp"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_client",
          "args": [
            "&cl_init",
            "&ds_timeout",
            "mds_clp->cl_ipaddr",
            "au_flavor"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "478-523",
          "snippet": "struct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_timeout_values",
          "args": [
            "&ds_timeout",
            "ds_proto",
            "ds_timeo",
            "ds_retrans"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_timeout_values",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "540-576",
          "snippet": "void nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_ntop",
          "args": [
            "ds_addr",
            "buf",
            "sizeof(buf)"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_client *nfs4_set_ds_client(struct nfs_client* mds_clp,\n\t\tconst struct sockaddr *ds_addr, int ds_addrlen,\n\t\tint ds_proto, unsigned int ds_timeo, unsigned int ds_retrans,\n\t\tu32 minor_version, rpc_authflavor_t au_flavor)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.addr = ds_addr,\n\t\t.addrlen = ds_addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = ds_proto,\n\t\t.minorversion = minor_version,\n\t\t.net = mds_clp->cl_net,\n\t};\n\tstruct rpc_timeout ds_timeout;\n\tstruct nfs_client *clp;\n\tchar buf[INET6_ADDRSTRLEN + 1];\n\n\tif (rpc_ntop(ds_addr, buf, sizeof(buf)) <= 0)\n\t\treturn ERR_PTR(-EINVAL);\n\tcl_init.hostname = buf;\n\n\t/*\n\t * Set an authflavor equual to the MDS value. Use the MDS nfs_client\n\t * cl_ipaddr so as to use the same EXCHANGE_ID co_ownerid as the MDS\n\t * (section 13.1 RFC 5661).\n\t */\n\tnfs_init_timeout_values(&ds_timeout, ds_proto, ds_timeo, ds_retrans);\n\tclp = nfs_get_client(&cl_init, &ds_timeout, mds_clp->cl_ipaddr,\n\t\t\t     au_flavor);\n\n\tdprintk(\"<-- %s %p\\n\", __func__, clp);\n\treturn clp;\n}"
  },
  {
    "function_name": "nfs4_set_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "787-837",
    "snippet": "static int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_set_client() = xerror %d\\n\"",
            "error"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_set_client() = 0 [new %p]\\n\"",
            "clp"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_CS_CHECK_LEASE_TIME",
            "&clp->cl_res_state"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "clp"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clp"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_client",
          "args": [
            "&cl_init",
            "timeparms",
            "ip_addr",
            "authflavour"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "478-523",
          "snippet": "struct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs4_set_client()\\n\""
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_set_client(struct nfs_server *server,\n\t\tconst char *hostname,\n\t\tconst struct sockaddr *addr,\n\t\tconst size_t addrlen,\n\t\tconst char *ip_addr,\n\t\trpc_authflavor_t authflavour,\n\t\tint proto, const struct rpc_timeout *timeparms,\n\t\tu32 minorversion, struct net *net)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = hostname,\n\t\t.addr = addr,\n\t\t.addrlen = addrlen,\n\t\t.nfs_mod = &nfs_v4,\n\t\t.proto = proto,\n\t\t.minorversion = minorversion,\n\t\t.net = net,\n\t};\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs4_set_client()\\n\");\n\n\tif (server->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\tif (server->options & NFS_OPTION_MIGRATION)\n\t\tset_bit(NFS_CS_MIGRATION, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, timeparms, ip_addr, authflavour);\n\tif (IS_ERR(clp)) {\n\t\terror = PTR_ERR(clp);\n\t\tgoto error;\n\t}\n\n\t/*\n\t * Query for the lease time on clientid setup or renewal\n\t *\n\t * Note that this will be set on nfs_clients that were created\n\t * only for the DS role and did not set this bit, but now will\n\t * serve a dual role.\n\t */\n\tset_bit(NFS_CS_CHECK_LEASE_TIME, &clp->cl_res_state);\n\n\tserver->nfs_client = clp;\n\tdprintk(\"<-- nfs4_set_client() = 0 [new %p]\\n\", clp);\n\treturn 0;\nerror:\n\tdprintk(\"<-- nfs4_set_client() = xerror %d\\n\", error);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs4_find_client_sessionid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "776-781",
    "snippet": "struct nfs_client *\nnfs4_find_client_sessionid(struct net *net, const struct sockaddr *addr,\n\t\t\t   struct nfs4_sessionid *sid, u32 minorversion)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_client *\nnfs4_find_client_sessionid(struct net *net, const struct sockaddr *addr,\n\t\t\t   struct nfs4_sessionid *sid, u32 minorversion)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "nfs4_find_client_sessionid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "746-772",
    "snippet": "struct nfs_client *\nnfs4_find_client_sessionid(struct net *net, const struct sockaddr *addr,\n\t\t\t   struct nfs4_sessionid *sid, u32 minorversion)\n{\n\tstruct nfs_client *clp;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_for_each_entry(clp, &nn->nfs_client_list, cl_share_link) {\n\t\tif (nfs4_cb_match_client(addr, clp, minorversion) == false)\n\t\t\tcontinue;\n\n\t\tif (!nfs4_has_session(clp))\n\t\t\tcontinue;\n\n\t\t/* Match sessionid*/\n\t\tif (memcmp(clp->cl_session->sess_id.data,\n\t\t    sid->data, NFS4_MAX_SESSIONID_LEN) != 0)\n\t\t\tcontinue;\n\n\t\tatomic_inc(&clp->cl_count);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\t\treturn clp;\n\t}\n\tspin_unlock(&nn->nfs_client_lock);\n\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&clp->cl_count"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "clp->cl_session->sess_id.data",
            "sid->data",
            "NFS4_MAX_SESSIONID_LEN"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_has_session",
          "args": [
            "clp"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_has_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "148-151",
          "snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_cb_match_client",
          "args": [
            "addr",
            "clp",
            "minorversion"
          ],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_cb_match_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "715-737",
          "snippet": "static bool nfs4_cb_match_client(const struct sockaddr *addr,\n\t\tstruct nfs_client *clp, u32 minorversion)\n{\n\tstruct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\n\t/* Don't match clients that failed to initialise */\n\tif (!(clp->cl_cons_state == NFS_CS_READY ||\n\t    clp->cl_cons_state == NFS_CS_SESSION_INITING))\n\t\treturn false;\n\n\tsmp_rmb();\n\n\t/* Match the version and minorversion */\n\tif (clp->rpc_ops->version != 4 ||\n\t    clp->cl_minorversion != minorversion)\n\t\treturn false;\n\n\t/* Match only the IP address, not the port number */\n\tif (!nfs_sockaddr_match_ipaddr(addr, clap))\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool nfs4_cb_match_client(const struct sockaddr *addr,\n\t\tstruct nfs_client *clp, u32 minorversion)\n{\n\tstruct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\n\t/* Don't match clients that failed to initialise */\n\tif (!(clp->cl_cons_state == NFS_CS_READY ||\n\t    clp->cl_cons_state == NFS_CS_SESSION_INITING))\n\t\treturn false;\n\n\tsmp_rmb();\n\n\t/* Match the version and minorversion */\n\tif (clp->rpc_ops->version != 4 ||\n\t    clp->cl_minorversion != minorversion)\n\t\treturn false;\n\n\t/* Match only the IP address, not the port number */\n\tif (!nfs_sockaddr_match_ipaddr(addr, clap))\n\t\treturn false;\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "clp",
            "&nn->nfs_client_list",
            "cl_share_link"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_client *\nnfs4_find_client_sessionid(struct net *net, const struct sockaddr *addr,\n\t\t\t   struct nfs4_sessionid *sid, u32 minorversion)\n{\n\tstruct nfs_client *clp;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_for_each_entry(clp, &nn->nfs_client_list, cl_share_link) {\n\t\tif (nfs4_cb_match_client(addr, clp, minorversion) == false)\n\t\t\tcontinue;\n\n\t\tif (!nfs4_has_session(clp))\n\t\t\tcontinue;\n\n\t\t/* Match sessionid*/\n\t\tif (memcmp(clp->cl_session->sess_id.data,\n\t\t    sid->data, NFS4_MAX_SESSIONID_LEN) != 0)\n\t\t\tcontinue;\n\n\t\tatomic_inc(&clp->cl_count);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\t\treturn clp;\n\t}\n\tspin_unlock(&nn->nfs_client_lock);\n\treturn NULL;\n}"
  },
  {
    "function_name": "nfs4_cb_match_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "715-737",
    "snippet": "static bool nfs4_cb_match_client(const struct sockaddr *addr,\n\t\tstruct nfs_client *clp, u32 minorversion)\n{\n\tstruct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\n\t/* Don't match clients that failed to initialise */\n\tif (!(clp->cl_cons_state == NFS_CS_READY ||\n\t    clp->cl_cons_state == NFS_CS_SESSION_INITING))\n\t\treturn false;\n\n\tsmp_rmb();\n\n\t/* Match the version and minorversion */\n\tif (clp->rpc_ops->version != 4 ||\n\t    clp->cl_minorversion != minorversion)\n\t\treturn false;\n\n\t/* Match only the IP address, not the port number */\n\tif (!nfs_sockaddr_match_ipaddr(addr, clap))\n\t\treturn false;\n\n\treturn true;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_sockaddr_match_ipaddr",
          "args": [
            "addr",
            "clap"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_match_ipaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "363-376",
          "snippet": "int nfs_sockaddr_match_ipaddr(const struct sockaddr *sa1,\n\t\t\t      const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_sockaddr_match_ipaddr(const struct sockaddr *sa1,\n\t\t\t      const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_rmb",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool nfs4_cb_match_client(const struct sockaddr *addr,\n\t\tstruct nfs_client *clp, u32 minorversion)\n{\n\tstruct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\n\t/* Don't match clients that failed to initialise */\n\tif (!(clp->cl_cons_state == NFS_CS_READY ||\n\t    clp->cl_cons_state == NFS_CS_SESSION_INITING))\n\t\treturn false;\n\n\tsmp_rmb();\n\n\t/* Match the version and minorversion */\n\tif (clp->rpc_ops->version != 4 ||\n\t    clp->cl_minorversion != minorversion)\n\t\treturn false;\n\n\t/* Match only the IP address, not the port number */\n\tif (!nfs_sockaddr_match_ipaddr(addr, clap))\n\t\treturn false;\n\n\treturn true;\n}"
  },
  {
    "function_name": "nfs4_find_client_ident",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "699-711",
    "snippet": "struct nfs_client *\nnfs4_find_client_ident(struct net *net, int cb_ident)\n{\n\tstruct nfs_client *clp;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tclp = idr_find(&nn->cb_ident_idr, cb_ident);\n\tif (clp)\n\t\tatomic_inc(&clp->cl_count);\n\tspin_unlock(&nn->nfs_client_lock);\n\treturn clp;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&clp->cl_count"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idr_find",
          "args": [
            "&nn->cb_ident_idr",
            "cb_ident"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "recover_idr_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/recover.c",
          "lines": "343-351",
          "snippet": "static struct dlm_rsb *recover_idr_find(struct dlm_ls *ls, uint64_t id)\n{\n\tstruct dlm_rsb *r;\n\n\tspin_lock(&ls->ls_recover_idr_lock);\n\tr = idr_find(&ls->ls_recover_idr, (int)id);\n\tspin_unlock(&ls->ls_recover_idr_lock);\n\treturn r;\n}",
          "includes": [
            "#include \"recover.h\"",
            "#include \"member.h\"",
            "#include \"lowcomms.h\"",
            "#include \"lock.h\"",
            "#include \"rcom.h\"",
            "#include \"memory.h\"",
            "#include \"ast.h\"",
            "#include \"config.h\"",
            "#include \"dir.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recover.h\"\n#include \"member.h\"\n#include \"lowcomms.h\"\n#include \"lock.h\"\n#include \"rcom.h\"\n#include \"memory.h\"\n#include \"ast.h\"\n#include \"config.h\"\n#include \"dir.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n\nstatic struct dlm_rsb *recover_idr_find(struct dlm_ls *ls, uint64_t id)\n{\n\tstruct dlm_rsb *r;\n\n\tspin_lock(&ls->ls_recover_idr_lock);\n\tr = idr_find(&ls->ls_recover_idr, (int)id);\n\tspin_unlock(&ls->ls_recover_idr_lock);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_client *\nnfs4_find_client_ident(struct net *net, int cb_ident)\n{\n\tstruct nfs_client *clp;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tclp = idr_find(&nn->cb_ident_idr, cb_ident);\n\tif (clp)\n\t\tatomic_inc(&clp->cl_count);\n\tspin_unlock(&nn->nfs_client_lock);\n\treturn clp;\n}"
  },
  {
    "function_name": "nfs4_destroy_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "687-692",
    "snippet": "static void nfs4_destroy_server(struct nfs_server *server)\n{\n\tnfs_server_return_all_delegations(server);\n\tunset_pnfs_layoutdriver(server);\n\tnfs4_purge_state_owners(server);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_purge_state_owners",
          "args": [
            "server"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_purge_state_owners",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "615-632",
          "snippet": "void nfs4_purge_state_owners(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs4_state_owner *sp, *tmp;\n\tLIST_HEAD(doomed);\n\n\tspin_lock(&clp->cl_lock);\n\tlist_for_each_entry_safe(sp, tmp, &server->state_owners_lru, so_lru) {\n\t\tlist_move(&sp->so_lru, &doomed);\n\t\tnfs4_remove_state_owner_locked(sp);\n\t}\n\tspin_unlock(&clp->cl_lock);\n\n\tlist_for_each_entry_safe(sp, tmp, &doomed, so_lru) {\n\t\tlist_del(&sp->so_lru);\n\t\tnfs4_free_state_owner(sp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs4_purge_state_owners(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs4_state_owner *sp, *tmp;\n\tLIST_HEAD(doomed);\n\n\tspin_lock(&clp->cl_lock);\n\tlist_for_each_entry_safe(sp, tmp, &server->state_owners_lru, so_lru) {\n\t\tlist_move(&sp->so_lru, &doomed);\n\t\tnfs4_remove_state_owner_locked(sp);\n\t}\n\tspin_unlock(&clp->cl_lock);\n\n\tlist_for_each_entry_safe(sp, tmp, &doomed, so_lru) {\n\t\tlist_del(&sp->so_lru);\n\t\tnfs4_free_state_owner(sp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unset_pnfs_layoutdriver",
          "args": [
            "server"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "unset_pnfs_layoutdriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pnfs.h",
          "lines": "598-600",
          "snippet": "static inline void unset_pnfs_layoutdriver(struct nfs_server *s)\n{\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void unset_pnfs_layoutdriver(struct nfs_server *s)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_server_return_all_delegations",
          "args": [
            "server"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_return_all_delegations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "601-617",
          "snippet": "void nfs_server_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tbool need_wait;\n\n\tif (clp == NULL)\n\t\treturn;\n\n\trcu_read_lock();\n\tneed_wait = nfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n\n\tif (need_wait) {\n\t\tnfs4_schedule_state_manager(clp);\n\t\tnfs4_wait_clnt_recover(clp);\n\t}\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_server_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tbool need_wait;\n\n\tif (clp == NULL)\n\t\treturn;\n\n\trcu_read_lock();\n\tneed_wait = nfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n\n\tif (need_wait) {\n\t\tnfs4_schedule_state_manager(clp);\n\t\tnfs4_wait_clnt_recover(clp);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_destroy_server(struct nfs_server *server)\n{\n\tnfs_server_return_all_delegations(server);\n\tunset_pnfs_layoutdriver(server);\n\tnfs4_purge_state_owners(server);\n}"
  },
  {
    "function_name": "nfs41_walk_client_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "613-684",
    "snippet": "int nfs41_walk_client_list(struct nfs_client *new,\n\t\t\t   struct nfs_client **result,\n\t\t\t   struct rpc_cred *cred)\n{\n\tstruct nfs_net *nn = net_generic(new->cl_net, nfs_net_id);\n\tstruct nfs_client *pos, *prev = NULL;\n\tint status = -NFS4ERR_STALE_CLIENTID;\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_for_each_entry(pos, &nn->nfs_client_list, cl_share_link) {\n\n\t\tif (pos == new)\n\t\t\tgoto found;\n\n\t\tif (pos->rpc_ops != new->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (pos->cl_minorversion != new->cl_minorversion)\n\t\t\tcontinue;\n\n\t\t/* If \"pos\" isn't marked ready, we can't trust the\n\t\t * remaining fields in \"pos\", especially the client\n\t\t * ID and serverowner fields.  Wait for CREATE_SESSION\n\t\t * to finish. */\n\t\tif (pos->cl_cons_state > NFS_CS_READY) {\n\t\t\tatomic_inc(&pos->cl_count);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\t\tnfs_put_client(prev);\n\t\t\tprev = pos;\n\n\t\t\tstatus = nfs_wait_client_init_complete(pos);\n\t\t\tspin_lock(&nn->nfs_client_lock);\n\t\t\tif (status < 0)\n\t\t\t\tbreak;\n\t\t\tstatus = -NFS4ERR_STALE_CLIENTID;\n\t\t}\n\t\tif (pos->cl_cons_state != NFS_CS_READY)\n\t\t\tcontinue;\n\n\t\tif (!nfs4_match_clientids(pos, new))\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * Note that session trunking is just a special subcase of\n\t\t * client id trunking. In either case, we want to fall back\n\t\t * to using the existing nfs_client.\n\t\t */\n\t\tif (!nfs4_check_clientid_trunking(pos, new))\n\t\t\tcontinue;\n\n\t\t/* Unlike NFSv4.0, we know that NFSv4.1 always uses the\n\t\t * uniform string, however someone might switch the\n\t\t * uniquifier string on us.\n\t\t */\n\t\tif (!nfs4_match_client_owner_id(pos, new))\n\t\t\tcontinue;\nfound:\n\t\tatomic_inc(&pos->cl_count);\n\t\t*result = pos;\n\t\tstatus = 0;\n\t\tdprintk(\"NFS: <-- %s using nfs_client = %p ({%d})\\n\",\n\t\t\t__func__, pos, atomic_read(&pos->cl_count));\n\t\tbreak;\n\t}\n\n\t/* No matching nfs_client found. */\n\tspin_unlock(&nn->nfs_client_lock);\n\tdprintk(\"NFS: <-- %s status = %d\\n\", __func__, status);\n\tnfs_put_client(prev);\n\treturn status;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "prev"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: <-- %s status = %d\\n\"",
            "__func__",
            "status"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: <-- %s using nfs_client = %p ({%d})\\n\"",
            "__func__",
            "pos",
            "atomic_read(&pos->cl_count)"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&pos->cl_count"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&pos->cl_count"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_match_client_owner_id",
          "args": [
            "pos",
            "new"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_match_client_owner_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "456-462",
          "snippet": "static bool nfs4_match_client_owner_id(const struct nfs_client *clp1,\n\t\tconst struct nfs_client *clp2)\n{\n\tif (clp1->cl_owner_id == NULL || clp2->cl_owner_id == NULL)\n\t\treturn true;\n\treturn strcmp(clp1->cl_owner_id, clp2->cl_owner_id) == 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool nfs4_match_client_owner_id(const struct nfs_client *clp1,\n\t\tconst struct nfs_client *clp2)\n{\n\tif (clp1->cl_owner_id == NULL || clp2->cl_owner_id == NULL)\n\t\treturn true;\n\treturn strcmp(clp1->cl_owner_id, clp2->cl_owner_id) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_check_clientid_trunking",
          "args": [
            "pos",
            "new"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_check_clientid_trunking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "580-598",
          "snippet": "static bool\nnfs4_check_clientid_trunking(struct nfs_client *a, struct nfs_client *b)\n{\n\tstruct nfs41_server_owner *o1 = a->cl_serverowner;\n\tstruct nfs41_server_owner *o2 = b->cl_serverowner;\n\n\tif (o1->major_id_sz != o2->major_id_sz)\n\t\tgoto out_major_mismatch;\n\tif (memcmp(o1->major_id, o2->major_id, o1->major_id_sz) != 0)\n\t\tgoto out_major_mismatch;\n\n\tdprintk(\"NFS: --> %s server owners match\\n\", __func__);\n\treturn true;\n\nout_major_mismatch:\n\tdprintk(\"NFS: --> %s server owner major IDs do not match\\n\",\n\t\t__func__);\n\treturn false;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool\nnfs4_check_clientid_trunking(struct nfs_client *a, struct nfs_client *b)\n{\n\tstruct nfs41_server_owner *o1 = a->cl_serverowner;\n\tstruct nfs41_server_owner *o2 = b->cl_serverowner;\n\n\tif (o1->major_id_sz != o2->major_id_sz)\n\t\tgoto out_major_mismatch;\n\tif (memcmp(o1->major_id, o2->major_id, o1->major_id_sz) != 0)\n\t\tgoto out_major_mismatch;\n\n\tdprintk(\"NFS: --> %s server owners match\\n\", __func__);\n\treturn true;\n\nout_major_mismatch:\n\tdprintk(\"NFS: --> %s server owner major IDs do not match\\n\",\n\t\t__func__);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_match_clientids",
          "args": [
            "pos",
            "new"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_match_clientids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "565-575",
          "snippet": "static bool nfs4_match_clientids(struct nfs_client *a, struct nfs_client *b)\n{\n\tif (a->cl_clientid != b->cl_clientid) {\n\t\tdprintk(\"NFS: --> %s client ID %llx does not match %llx\\n\",\n\t\t\t__func__, a->cl_clientid, b->cl_clientid);\n\t\treturn false;\n\t}\n\tdprintk(\"NFS: --> %s client ID %llx matches %llx\\n\",\n\t\t__func__, a->cl_clientid, b->cl_clientid);\n\treturn true;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool nfs4_match_clientids(struct nfs_client *a, struct nfs_client *b)\n{\n\tif (a->cl_clientid != b->cl_clientid) {\n\t\tdprintk(\"NFS: --> %s client ID %llx does not match %llx\\n\",\n\t\t\t__func__, a->cl_clientid, b->cl_clientid);\n\t\treturn false;\n\t}\n\tdprintk(\"NFS: --> %s client ID %llx matches %llx\\n\",\n\t\t__func__, a->cl_clientid, b->cl_clientid);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_wait_client_init_complete",
          "args": [
            "pos"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wait_client_init_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "439-443",
          "snippet": "int nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nint nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&pos->cl_count"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "pos",
            "&nn->nfs_client_list",
            "cl_share_link"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "new->cl_net",
            "nfs_net_id"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nint nfs41_walk_client_list(struct nfs_client *new,\n\t\t\t   struct nfs_client **result,\n\t\t\t   struct rpc_cred *cred)\n{\n\tstruct nfs_net *nn = net_generic(new->cl_net, nfs_net_id);\n\tstruct nfs_client *pos, *prev = NULL;\n\tint status = -NFS4ERR_STALE_CLIENTID;\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_for_each_entry(pos, &nn->nfs_client_list, cl_share_link) {\n\n\t\tif (pos == new)\n\t\t\tgoto found;\n\n\t\tif (pos->rpc_ops != new->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (pos->cl_minorversion != new->cl_minorversion)\n\t\t\tcontinue;\n\n\t\t/* If \"pos\" isn't marked ready, we can't trust the\n\t\t * remaining fields in \"pos\", especially the client\n\t\t * ID and serverowner fields.  Wait for CREATE_SESSION\n\t\t * to finish. */\n\t\tif (pos->cl_cons_state > NFS_CS_READY) {\n\t\t\tatomic_inc(&pos->cl_count);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\t\tnfs_put_client(prev);\n\t\t\tprev = pos;\n\n\t\t\tstatus = nfs_wait_client_init_complete(pos);\n\t\t\tspin_lock(&nn->nfs_client_lock);\n\t\t\tif (status < 0)\n\t\t\t\tbreak;\n\t\t\tstatus = -NFS4ERR_STALE_CLIENTID;\n\t\t}\n\t\tif (pos->cl_cons_state != NFS_CS_READY)\n\t\t\tcontinue;\n\n\t\tif (!nfs4_match_clientids(pos, new))\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * Note that session trunking is just a special subcase of\n\t\t * client id trunking. In either case, we want to fall back\n\t\t * to using the existing nfs_client.\n\t\t */\n\t\tif (!nfs4_check_clientid_trunking(pos, new))\n\t\t\tcontinue;\n\n\t\t/* Unlike NFSv4.0, we know that NFSv4.1 always uses the\n\t\t * uniform string, however someone might switch the\n\t\t * uniquifier string on us.\n\t\t */\n\t\tif (!nfs4_match_client_owner_id(pos, new))\n\t\t\tcontinue;\nfound:\n\t\tatomic_inc(&pos->cl_count);\n\t\t*result = pos;\n\t\tstatus = 0;\n\t\tdprintk(\"NFS: <-- %s using nfs_client = %p ({%d})\\n\",\n\t\t\t__func__, pos, atomic_read(&pos->cl_count));\n\t\tbreak;\n\t}\n\n\t/* No matching nfs_client found. */\n\tspin_unlock(&nn->nfs_client_lock);\n\tdprintk(\"NFS: <-- %s status = %d\\n\", __func__, status);\n\tnfs_put_client(prev);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_check_clientid_trunking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "580-598",
    "snippet": "static bool\nnfs4_check_clientid_trunking(struct nfs_client *a, struct nfs_client *b)\n{\n\tstruct nfs41_server_owner *o1 = a->cl_serverowner;\n\tstruct nfs41_server_owner *o2 = b->cl_serverowner;\n\n\tif (o1->major_id_sz != o2->major_id_sz)\n\t\tgoto out_major_mismatch;\n\tif (memcmp(o1->major_id, o2->major_id, o1->major_id_sz) != 0)\n\t\tgoto out_major_mismatch;\n\n\tdprintk(\"NFS: --> %s server owners match\\n\", __func__);\n\treturn true;\n\nout_major_mismatch:\n\tdprintk(\"NFS: --> %s server owner major IDs do not match\\n\",\n\t\t__func__);\n\treturn false;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: --> %s server owner major IDs do not match\\n\"",
            "__func__"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: --> %s server owners match\\n\"",
            "__func__"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "o1->major_id",
            "o2->major_id",
            "o1->major_id_sz"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool\nnfs4_check_clientid_trunking(struct nfs_client *a, struct nfs_client *b)\n{\n\tstruct nfs41_server_owner *o1 = a->cl_serverowner;\n\tstruct nfs41_server_owner *o2 = b->cl_serverowner;\n\n\tif (o1->major_id_sz != o2->major_id_sz)\n\t\tgoto out_major_mismatch;\n\tif (memcmp(o1->major_id, o2->major_id, o1->major_id_sz) != 0)\n\t\tgoto out_major_mismatch;\n\n\tdprintk(\"NFS: --> %s server owners match\\n\", __func__);\n\treturn true;\n\nout_major_mismatch:\n\tdprintk(\"NFS: --> %s server owner major IDs do not match\\n\",\n\t\t__func__);\n\treturn false;\n}"
  },
  {
    "function_name": "nfs4_match_clientids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "565-575",
    "snippet": "static bool nfs4_match_clientids(struct nfs_client *a, struct nfs_client *b)\n{\n\tif (a->cl_clientid != b->cl_clientid) {\n\t\tdprintk(\"NFS: --> %s client ID %llx does not match %llx\\n\",\n\t\t\t__func__, a->cl_clientid, b->cl_clientid);\n\t\treturn false;\n\t}\n\tdprintk(\"NFS: --> %s client ID %llx matches %llx\\n\",\n\t\t__func__, a->cl_clientid, b->cl_clientid);\n\treturn true;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: --> %s client ID %llx matches %llx\\n\"",
            "__func__",
            "a->cl_clientid",
            "b->cl_clientid"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: --> %s client ID %llx does not match %llx\\n\"",
            "__func__",
            "a->cl_clientid",
            "b->cl_clientid"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool nfs4_match_clientids(struct nfs_client *a, struct nfs_client *b)\n{\n\tif (a->cl_clientid != b->cl_clientid) {\n\t\tdprintk(\"NFS: --> %s client ID %llx does not match %llx\\n\",\n\t\t\t__func__, a->cl_clientid, b->cl_clientid);\n\t\treturn false;\n\t}\n\tdprintk(\"NFS: --> %s client ID %llx matches %llx\\n\",\n\t\t__func__, a->cl_clientid, b->cl_clientid);\n\treturn true;\n}"
  },
  {
    "function_name": "nfs40_walk_client_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "477-559",
    "snippet": "int nfs40_walk_client_list(struct nfs_client *new,\n\t\t\t   struct nfs_client **result,\n\t\t\t   struct rpc_cred *cred)\n{\n\tstruct nfs_net *nn = net_generic(new->cl_net, nfs_net_id);\n\tstruct nfs_client *pos, *prev = NULL;\n\tstruct nfs4_setclientid_res clid = {\n\t\t.clientid\t= new->cl_clientid,\n\t\t.confirm\t= new->cl_confirm,\n\t};\n\tint status = -NFS4ERR_STALE_CLIENTID;\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_for_each_entry(pos, &nn->nfs_client_list, cl_share_link) {\n\n\t\tif (pos->rpc_ops != new->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (pos->cl_minorversion != new->cl_minorversion)\n\t\t\tcontinue;\n\n\t\t/* If \"pos\" isn't marked ready, we can't trust the\n\t\t * remaining fields in \"pos\" */\n\t\tif (pos->cl_cons_state > NFS_CS_READY) {\n\t\t\tatomic_inc(&pos->cl_count);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\t\tnfs_put_client(prev);\n\t\t\tprev = pos;\n\n\t\t\tstatus = nfs_wait_client_init_complete(pos);\n\t\t\tif (status < 0)\n\t\t\t\tgoto out;\n\t\t\tstatus = -NFS4ERR_STALE_CLIENTID;\n\t\t\tspin_lock(&nn->nfs_client_lock);\n\t\t}\n\t\tif (pos->cl_cons_state != NFS_CS_READY)\n\t\t\tcontinue;\n\n\t\tif (pos->cl_clientid != new->cl_clientid)\n\t\t\tcontinue;\n\n\t\tif (!nfs4_match_client_owner_id(pos, new))\n\t\t\tcontinue;\n\n\t\tatomic_inc(&pos->cl_count);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnfs_put_client(prev);\n\t\tprev = pos;\n\n\t\tstatus = nfs4_proc_setclientid_confirm(pos, &clid, cred);\n\t\tswitch (status) {\n\t\tcase -NFS4ERR_STALE_CLIENTID:\n\t\t\tbreak;\n\t\tcase 0:\n\t\t\tnfs4_swap_callback_idents(pos, new);\n\n\t\t\tprev = NULL;\n\t\t\t*result = pos;\n\t\t\tdprintk(\"NFS: <-- %s using nfs_client = %p ({%d})\\n\",\n\t\t\t\t__func__, pos, atomic_read(&pos->cl_count));\n\t\t\tgoto out;\n\t\tcase -ERESTARTSYS:\n\t\tcase -ETIMEDOUT:\n\t\t\t/* The callback path may have been inadvertently\n\t\t\t * changed. Schedule recovery!\n\t\t\t */\n\t\t\tnfs4_schedule_path_down_recovery(pos);\n\t\tdefault:\n\t\t\tgoto out;\n\t\t}\n\n\t\tspin_lock(&nn->nfs_client_lock);\n\t}\n\tspin_unlock(&nn->nfs_client_lock);\n\n\t/* No match found. The server lost our clientid */\nout:\n\tnfs_put_client(prev);\n\tdprintk(\"NFS: <-- %s status = %d\\n\", __func__, status);\n\treturn status;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: <-- %s status = %d\\n\"",
            "__func__",
            "status"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "prev"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_schedule_path_down_recovery",
          "args": [
            "pos"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_schedule_path_down_recovery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1293-1297",
          "snippet": "void nfs4_schedule_path_down_recovery(struct nfs_client *clp)\n{\n\tnfs40_handle_cb_pathdown(clp);\n\tnfs4_schedule_state_manager(clp);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs4_schedule_path_down_recovery(struct nfs_client *clp)\n{\n\tnfs40_handle_cb_pathdown(clp);\n\tnfs4_schedule_state_manager(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: <-- %s using nfs_client = %p ({%d})\\n\"",
            "__func__",
            "pos",
            "atomic_read(&pos->cl_count)"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&pos->cl_count"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_swap_callback_idents",
          "args": [
            "pos",
            "new"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_swap_callback_idents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "433-454",
          "snippet": "static void nfs4_swap_callback_idents(struct nfs_client *keep,\n\t\t\t\t      struct nfs_client *drop)\n{\n\tstruct nfs_net *nn = net_generic(keep->cl_net, nfs_net_id);\n\tunsigned int save = keep->cl_cb_ident;\n\n\tif (keep->cl_cb_ident == drop->cl_cb_ident)\n\t\treturn;\n\n\tdprintk(\"%s: keeping callback ident %u and dropping ident %u\\n\",\n\t\t__func__, keep->cl_cb_ident, drop->cl_cb_ident);\n\n\tspin_lock(&nn->nfs_client_lock);\n\n\tidr_replace(&nn->cb_ident_idr, keep, drop->cl_cb_ident);\n\tkeep->cl_cb_ident = drop->cl_cb_ident;\n\n\tidr_replace(&nn->cb_ident_idr, drop, save);\n\tdrop->cl_cb_ident = save;\n\n\tspin_unlock(&nn->nfs_client_lock);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_swap_callback_idents(struct nfs_client *keep,\n\t\t\t\t      struct nfs_client *drop)\n{\n\tstruct nfs_net *nn = net_generic(keep->cl_net, nfs_net_id);\n\tunsigned int save = keep->cl_cb_ident;\n\n\tif (keep->cl_cb_ident == drop->cl_cb_ident)\n\t\treturn;\n\n\tdprintk(\"%s: keeping callback ident %u and dropping ident %u\\n\",\n\t\t__func__, keep->cl_cb_ident, drop->cl_cb_ident);\n\n\tspin_lock(&nn->nfs_client_lock);\n\n\tidr_replace(&nn->cb_ident_idr, keep, drop->cl_cb_ident);\n\tkeep->cl_cb_ident = drop->cl_cb_ident;\n\n\tidr_replace(&nn->cb_ident_idr, drop, save);\n\tdrop->cl_cb_ident = save;\n\n\tspin_unlock(&nn->nfs_client_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_proc_setclientid_confirm",
          "args": [
            "pos",
            "&clid",
            "cred"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_proc_setclientid_confirm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "5115-5133",
          "snippet": "int nfs4_proc_setclientid_confirm(struct nfs_client *clp,\n\t\tstruct nfs4_setclientid_res *arg,\n\t\tstruct rpc_cred *cred)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc = &nfs4_procedures[NFSPROC4_CLNT_SETCLIENTID_CONFIRM],\n\t\t.rpc_argp = arg,\n\t\t.rpc_cred = cred,\n\t};\n\tint status;\n\n\tdprintk(\"NFS call  setclientid_confirm auth=%s, (client ID %llx)\\n\",\n\t\tclp->cl_rpcclient->cl_auth->au_ops->au_name,\n\t\tclp->cl_clientid);\n\tstatus = rpc_call_sync(clp->cl_rpcclient, &msg, RPC_TASK_TIMEOUT);\n\ttrace_nfs4_setclientid_confirm(clp, status);\n\tdprintk(\"NFS reply setclientid_confirm: %d\\n\", status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nint nfs4_proc_setclientid_confirm(struct nfs_client *clp,\n\t\tstruct nfs4_setclientid_res *arg,\n\t\tstruct rpc_cred *cred)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc = &nfs4_procedures[NFSPROC4_CLNT_SETCLIENTID_CONFIRM],\n\t\t.rpc_argp = arg,\n\t\t.rpc_cred = cred,\n\t};\n\tint status;\n\n\tdprintk(\"NFS call  setclientid_confirm auth=%s, (client ID %llx)\\n\",\n\t\tclp->cl_rpcclient->cl_auth->au_ops->au_name,\n\t\tclp->cl_clientid);\n\tstatus = rpc_call_sync(clp->cl_rpcclient, &msg, RPC_TASK_TIMEOUT);\n\ttrace_nfs4_setclientid_confirm(clp, status);\n\tdprintk(\"NFS reply setclientid_confirm: %d\\n\", status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&pos->cl_count"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_match_client_owner_id",
          "args": [
            "pos",
            "new"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_match_client_owner_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "456-462",
          "snippet": "static bool nfs4_match_client_owner_id(const struct nfs_client *clp1,\n\t\tconst struct nfs_client *clp2)\n{\n\tif (clp1->cl_owner_id == NULL || clp2->cl_owner_id == NULL)\n\t\treturn true;\n\treturn strcmp(clp1->cl_owner_id, clp2->cl_owner_id) == 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool nfs4_match_client_owner_id(const struct nfs_client *clp1,\n\t\tconst struct nfs_client *clp2)\n{\n\tif (clp1->cl_owner_id == NULL || clp2->cl_owner_id == NULL)\n\t\treturn true;\n\treturn strcmp(clp1->cl_owner_id, clp2->cl_owner_id) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_wait_client_init_complete",
          "args": [
            "pos"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wait_client_init_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "439-443",
          "snippet": "int nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nint nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&pos->cl_count"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "pos",
            "&nn->nfs_client_list",
            "cl_share_link"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "new->cl_net",
            "nfs_net_id"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nint nfs40_walk_client_list(struct nfs_client *new,\n\t\t\t   struct nfs_client **result,\n\t\t\t   struct rpc_cred *cred)\n{\n\tstruct nfs_net *nn = net_generic(new->cl_net, nfs_net_id);\n\tstruct nfs_client *pos, *prev = NULL;\n\tstruct nfs4_setclientid_res clid = {\n\t\t.clientid\t= new->cl_clientid,\n\t\t.confirm\t= new->cl_confirm,\n\t};\n\tint status = -NFS4ERR_STALE_CLIENTID;\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_for_each_entry(pos, &nn->nfs_client_list, cl_share_link) {\n\n\t\tif (pos->rpc_ops != new->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (pos->cl_minorversion != new->cl_minorversion)\n\t\t\tcontinue;\n\n\t\t/* If \"pos\" isn't marked ready, we can't trust the\n\t\t * remaining fields in \"pos\" */\n\t\tif (pos->cl_cons_state > NFS_CS_READY) {\n\t\t\tatomic_inc(&pos->cl_count);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\t\tnfs_put_client(prev);\n\t\t\tprev = pos;\n\n\t\t\tstatus = nfs_wait_client_init_complete(pos);\n\t\t\tif (status < 0)\n\t\t\t\tgoto out;\n\t\t\tstatus = -NFS4ERR_STALE_CLIENTID;\n\t\t\tspin_lock(&nn->nfs_client_lock);\n\t\t}\n\t\tif (pos->cl_cons_state != NFS_CS_READY)\n\t\t\tcontinue;\n\n\t\tif (pos->cl_clientid != new->cl_clientid)\n\t\t\tcontinue;\n\n\t\tif (!nfs4_match_client_owner_id(pos, new))\n\t\t\tcontinue;\n\n\t\tatomic_inc(&pos->cl_count);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnfs_put_client(prev);\n\t\tprev = pos;\n\n\t\tstatus = nfs4_proc_setclientid_confirm(pos, &clid, cred);\n\t\tswitch (status) {\n\t\tcase -NFS4ERR_STALE_CLIENTID:\n\t\t\tbreak;\n\t\tcase 0:\n\t\t\tnfs4_swap_callback_idents(pos, new);\n\n\t\t\tprev = NULL;\n\t\t\t*result = pos;\n\t\t\tdprintk(\"NFS: <-- %s using nfs_client = %p ({%d})\\n\",\n\t\t\t\t__func__, pos, atomic_read(&pos->cl_count));\n\t\t\tgoto out;\n\t\tcase -ERESTARTSYS:\n\t\tcase -ETIMEDOUT:\n\t\t\t/* The callback path may have been inadvertently\n\t\t\t * changed. Schedule recovery!\n\t\t\t */\n\t\t\tnfs4_schedule_path_down_recovery(pos);\n\t\tdefault:\n\t\t\tgoto out;\n\t\t}\n\n\t\tspin_lock(&nn->nfs_client_lock);\n\t}\n\tspin_unlock(&nn->nfs_client_lock);\n\n\t/* No match found. The server lost our clientid */\nout:\n\tnfs_put_client(prev);\n\tdprintk(\"NFS: <-- %s status = %d\\n\", __func__, status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_match_client_owner_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "456-462",
    "snippet": "static bool nfs4_match_client_owner_id(const struct nfs_client *clp1,\n\t\tconst struct nfs_client *clp2)\n{\n\tif (clp1->cl_owner_id == NULL || clp2->cl_owner_id == NULL)\n\t\treturn true;\n\treturn strcmp(clp1->cl_owner_id, clp2->cl_owner_id) == 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "clp1->cl_owner_id",
            "clp2->cl_owner_id"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic bool nfs4_match_client_owner_id(const struct nfs_client *clp1,\n\t\tconst struct nfs_client *clp2)\n{\n\tif (clp1->cl_owner_id == NULL || clp2->cl_owner_id == NULL)\n\t\treturn true;\n\treturn strcmp(clp1->cl_owner_id, clp2->cl_owner_id) == 0;\n}"
  },
  {
    "function_name": "nfs4_swap_callback_idents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "433-454",
    "snippet": "static void nfs4_swap_callback_idents(struct nfs_client *keep,\n\t\t\t\t      struct nfs_client *drop)\n{\n\tstruct nfs_net *nn = net_generic(keep->cl_net, nfs_net_id);\n\tunsigned int save = keep->cl_cb_ident;\n\n\tif (keep->cl_cb_ident == drop->cl_cb_ident)\n\t\treturn;\n\n\tdprintk(\"%s: keeping callback ident %u and dropping ident %u\\n\",\n\t\t__func__, keep->cl_cb_ident, drop->cl_cb_ident);\n\n\tspin_lock(&nn->nfs_client_lock);\n\n\tidr_replace(&nn->cb_ident_idr, keep, drop->cl_cb_ident);\n\tkeep->cl_cb_ident = drop->cl_cb_ident;\n\n\tidr_replace(&nn->cb_ident_idr, drop, save);\n\tdrop->cl_cb_ident = save;\n\n\tspin_unlock(&nn->nfs_client_lock);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "idr_replace",
          "args": [
            "&nn->cb_ident_idr",
            "drop",
            "save"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idr_replace",
          "args": [
            "&nn->cb_ident_idr",
            "keep",
            "drop->cl_cb_ident"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: keeping callback ident %u and dropping ident %u\\n\"",
            "__func__",
            "keep->cl_cb_ident",
            "drop->cl_cb_ident"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "keep->cl_net",
            "nfs_net_id"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_swap_callback_idents(struct nfs_client *keep,\n\t\t\t\t      struct nfs_client *drop)\n{\n\tstruct nfs_net *nn = net_generic(keep->cl_net, nfs_net_id);\n\tunsigned int save = keep->cl_cb_ident;\n\n\tif (keep->cl_cb_ident == drop->cl_cb_ident)\n\t\treturn;\n\n\tdprintk(\"%s: keeping callback ident %u and dropping ident %u\\n\",\n\t\t__func__, keep->cl_cb_ident, drop->cl_cb_ident);\n\n\tspin_lock(&nn->nfs_client_lock);\n\n\tidr_replace(&nn->cb_ident_idr, keep, drop->cl_cb_ident);\n\tkeep->cl_cb_ident = drop->cl_cb_ident;\n\n\tidr_replace(&nn->cb_ident_idr, drop, save);\n\tdrop->cl_cb_ident = save;\n\n\tspin_unlock(&nn->nfs_client_lock);\n}"
  },
  {
    "function_name": "nfs4_init_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "351-423",
    "snippet": "struct nfs_client *nfs4_init_client(struct nfs_client *clp,\n\t\t\t\t    const struct rpc_timeout *timeparms,\n\t\t\t\t    const char *ip_addr)\n{\n\tchar buf[INET6_ADDRSTRLEN + 1];\n\tstruct nfs_client *old;\n\tint error;\n\n\tif (clp->cl_cons_state == NFS_CS_READY) {\n\t\t/* the client is initialised already */\n\t\tdprintk(\"<-- nfs4_init_client() = 0 [already %p]\\n\", clp);\n\t\treturn clp;\n\t}\n\n\t/* Check NFS protocol revision and initialize RPC op vector */\n\tclp->rpc_ops = &nfs_v4_clientops;\n\n\tif (clp->cl_minorversion != 0)\n\t\t__set_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags);\n\t__set_bit(NFS_CS_DISCRTRY, &clp->cl_flags);\n\t__set_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags);\n\n\terror = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_GSS_KRB5I);\n\tif (error == -EINVAL)\n\t\terror = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_UNIX);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* If no clientaddr= option was specified, find a usable cb address */\n\tif (ip_addr == NULL) {\n\t\tstruct sockaddr_storage cb_addr;\n\t\tstruct sockaddr *sap = (struct sockaddr *)&cb_addr;\n\n\t\terror = rpc_localaddr(clp->cl_rpcclient, sap, sizeof(cb_addr));\n\t\tif (error < 0)\n\t\t\tgoto error;\n\t\terror = rpc_ntop(sap, buf, sizeof(buf));\n\t\tif (error < 0)\n\t\t\tgoto error;\n\t\tip_addr = (const char *)buf;\n\t}\n\tstrlcpy(clp->cl_ipaddr, ip_addr, sizeof(clp->cl_ipaddr));\n\n\terror = nfs_idmap_new(clp);\n\tif (error < 0) {\n\t\tdprintk(\"%s: failed to create idmapper. Error = %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto error;\n\t}\n\t__set_bit(NFS_CS_IDMAP, &clp->cl_res_state);\n\n\terror = nfs4_init_client_minor_version(clp);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (!nfs4_has_session(clp))\n\t\tnfs_mark_client_ready(clp, NFS_CS_READY);\n\n\terror = nfs4_discover_server_trunking(clp, &old);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (clp != old)\n\t\tclp->cl_preserve_clid = true;\n\tnfs_put_client(clp);\n\treturn old;\n\nerror:\n\tnfs_mark_client_ready(clp, error);\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs4_init_client() = xerror %d\\n\", error);\n\treturn ERR_PTR(error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_init_client() = xerror %d\\n\"",
            "error"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "clp"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mark_client_ready",
          "args": [
            "clp",
            "error"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_client_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "529-534",
          "snippet": "void nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nvoid nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_discover_server_trunking",
          "args": [
            "clp",
            "&old"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_discover_server_trunking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "2052-2135",
          "snippet": "int nfs4_discover_server_trunking(struct nfs_client *clp,\n\t\t\t\t  struct nfs_client **result)\n{\n\tconst struct nfs4_state_recovery_ops *ops =\n\t\t\t\tclp->cl_mvops->reboot_recovery_ops;\n\tstruct rpc_clnt *clnt;\n\tstruct rpc_cred *cred;\n\tint i, status;\n\n\tdprintk(\"NFS: %s: testing '%s'\\n\", __func__, clp->cl_hostname);\n\n\tclnt = clp->cl_rpcclient;\n\ti = 0;\n\n\tmutex_lock(&nfs_clid_init_mutex);\nagain:\n\tstatus  = -ENOENT;\n\tcred = nfs4_get_clid_cred(clp);\n\tif (cred == NULL)\n\t\tgoto out_unlock;\n\n\tstatus = ops->detect_trunking(clp, result, cred);\n\tput_rpccred(cred);\n\tswitch (status) {\n\tcase 0:\n\t\tbreak;\n\tcase -ETIMEDOUT:\n\t\tif (clnt->cl_softrtry)\n\t\t\tbreak;\n\tcase -NFS4ERR_DELAY:\n\tcase -EAGAIN:\n\t\tssleep(1);\n\tcase -NFS4ERR_STALE_CLIENTID:\n\t\tdprintk(\"NFS: %s after status %d, retrying\\n\",\n\t\t\t__func__, status);\n\t\tgoto again;\n\tcase -EACCES:\n\t\tif (i++ == 0) {\n\t\t\tnfs4_root_machine_cred(clp);\n\t\t\tgoto again;\n\t\t}\n\t\tif (clnt->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\t\tbreak;\n\tcase -NFS4ERR_CLID_INUSE:\n\tcase -NFS4ERR_WRONGSEC:\n\t\t/* No point in retrying if we already used RPC_AUTH_UNIX */\n\t\tif (clnt->cl_auth->au_flavor == RPC_AUTH_UNIX) {\n\t\t\tstatus = -EPERM;\n\t\t\tbreak;\n\t\t}\n\t\tclnt = rpc_clone_client_set_auth(clnt, RPC_AUTH_UNIX);\n\t\tif (IS_ERR(clnt)) {\n\t\t\tstatus = PTR_ERR(clnt);\n\t\t\tbreak;\n\t\t}\n\t\t/* Note: this is safe because we haven't yet marked the\n\t\t * client as ready, so we are the only user of\n\t\t * clp->cl_rpcclient\n\t\t */\n\t\tclnt = xchg(&clp->cl_rpcclient, clnt);\n\t\trpc_shutdown_client(clnt);\n\t\tclnt = clp->cl_rpcclient;\n\t\tgoto again;\n\n\tcase -NFS4ERR_MINOR_VERS_MISMATCH:\n\t\tstatus = -EPROTONOSUPPORT;\n\t\tbreak;\n\n\tcase -EKEYEXPIRED:\n\tcase -NFS4ERR_NOT_SAME: /* FixMe: implement recovery\n\t\t\t\t * in nfs4_exchange_id */\n\t\tstatus = -EKEYEXPIRED;\n\t\tbreak;\n\tdefault:\n\t\tpr_warn(\"NFS: %s unhandled error %d. Exiting with error EIO\\n\",\n\t\t\t\t__func__, status);\n\t\tstatus = -EIO;\n\t}\n\nout_unlock:\n\tmutex_unlock(&nfs_clid_init_mutex);\n\tdprintk(\"NFS: %s: status = %d\\n\", __func__, status);\n\treturn status;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(nfs_clid_init_mutex);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_MUTEX(nfs_clid_init_mutex);\n\nint nfs4_discover_server_trunking(struct nfs_client *clp,\n\t\t\t\t  struct nfs_client **result)\n{\n\tconst struct nfs4_state_recovery_ops *ops =\n\t\t\t\tclp->cl_mvops->reboot_recovery_ops;\n\tstruct rpc_clnt *clnt;\n\tstruct rpc_cred *cred;\n\tint i, status;\n\n\tdprintk(\"NFS: %s: testing '%s'\\n\", __func__, clp->cl_hostname);\n\n\tclnt = clp->cl_rpcclient;\n\ti = 0;\n\n\tmutex_lock(&nfs_clid_init_mutex);\nagain:\n\tstatus  = -ENOENT;\n\tcred = nfs4_get_clid_cred(clp);\n\tif (cred == NULL)\n\t\tgoto out_unlock;\n\n\tstatus = ops->detect_trunking(clp, result, cred);\n\tput_rpccred(cred);\n\tswitch (status) {\n\tcase 0:\n\t\tbreak;\n\tcase -ETIMEDOUT:\n\t\tif (clnt->cl_softrtry)\n\t\t\tbreak;\n\tcase -NFS4ERR_DELAY:\n\tcase -EAGAIN:\n\t\tssleep(1);\n\tcase -NFS4ERR_STALE_CLIENTID:\n\t\tdprintk(\"NFS: %s after status %d, retrying\\n\",\n\t\t\t__func__, status);\n\t\tgoto again;\n\tcase -EACCES:\n\t\tif (i++ == 0) {\n\t\t\tnfs4_root_machine_cred(clp);\n\t\t\tgoto again;\n\t\t}\n\t\tif (clnt->cl_auth->au_flavor == RPC_AUTH_UNIX)\n\t\t\tbreak;\n\tcase -NFS4ERR_CLID_INUSE:\n\tcase -NFS4ERR_WRONGSEC:\n\t\t/* No point in retrying if we already used RPC_AUTH_UNIX */\n\t\tif (clnt->cl_auth->au_flavor == RPC_AUTH_UNIX) {\n\t\t\tstatus = -EPERM;\n\t\t\tbreak;\n\t\t}\n\t\tclnt = rpc_clone_client_set_auth(clnt, RPC_AUTH_UNIX);\n\t\tif (IS_ERR(clnt)) {\n\t\t\tstatus = PTR_ERR(clnt);\n\t\t\tbreak;\n\t\t}\n\t\t/* Note: this is safe because we haven't yet marked the\n\t\t * client as ready, so we are the only user of\n\t\t * clp->cl_rpcclient\n\t\t */\n\t\tclnt = xchg(&clp->cl_rpcclient, clnt);\n\t\trpc_shutdown_client(clnt);\n\t\tclnt = clp->cl_rpcclient;\n\t\tgoto again;\n\n\tcase -NFS4ERR_MINOR_VERS_MISMATCH:\n\t\tstatus = -EPROTONOSUPPORT;\n\t\tbreak;\n\n\tcase -EKEYEXPIRED:\n\tcase -NFS4ERR_NOT_SAME: /* FixMe: implement recovery\n\t\t\t\t * in nfs4_exchange_id */\n\t\tstatus = -EKEYEXPIRED;\n\t\tbreak;\n\tdefault:\n\t\tpr_warn(\"NFS: %s unhandled error %d. Exiting with error EIO\\n\",\n\t\t\t\t__func__, status);\n\t\tstatus = -EIO;\n\t}\n\nout_unlock:\n\tmutex_unlock(&nfs_clid_init_mutex);\n\tdprintk(\"NFS: %s: status = %d\\n\", __func__, status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_has_session",
          "args": [
            "clp"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_has_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "148-151",
          "snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_init_client_minor_version",
          "args": [
            "clp"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_init_client_minor_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "331-339",
          "snippet": "static int nfs4_init_client_minor_version(struct nfs_client *clp)\n{\n\tint ret;\n\n\tret = clp->cl_mvops->init_client(clp);\n\tif (ret)\n\t\treturn ret;\n\treturn nfs4_init_callback(clp);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_init_client_minor_version(struct nfs_client *clp)\n{\n\tint ret;\n\n\tret = clp->cl_mvops->init_client(clp);\n\tif (ret)\n\t\treturn ret;\n\treturn nfs4_init_callback(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "NFS_CS_IDMAP",
            "&clp->cl_res_state"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: failed to create idmapper. Error = %d\\n\"",
            "__func__",
            "error"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_new",
          "args": [
            "clp"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "442-478",
          "snippet": "int\nnfs_idmap_new(struct nfs_client *clp)\n{\n\tstruct idmap *idmap;\n\tstruct rpc_pipe *pipe;\n\tint error;\n\n\tidmap = kzalloc(sizeof(*idmap), GFP_KERNEL);\n\tif (idmap == NULL)\n\t\treturn -ENOMEM;\n\n\trpc_init_pipe_dir_object(&idmap->idmap_pdo,\n\t\t\t&nfs_idmap_pipe_dir_object_ops,\n\t\t\tidmap);\n\n\tpipe = rpc_mkpipe_data(&idmap_upcall_ops, 0);\n\tif (IS_ERR(pipe)) {\n\t\terror = PTR_ERR(pipe);\n\t\tgoto err;\n\t}\n\tidmap->idmap_pipe = pipe;\n\tmutex_init(&idmap->idmap_mutex);\n\n\terror = rpc_add_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\tif (error)\n\t\tgoto err_destroy_pipe;\n\n\tclp->cl_idmap = idmap;\n\treturn 0;\nerr_destroy_pipe:\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\nerr:\n\tkfree(idmap);\n\treturn error;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct rpc_pipe_ops idmap_upcall_ops = {\n\t.upcall\t\t= rpc_pipe_generic_upcall,\n\t.downcall\t= idmap_pipe_downcall,\n\t.release_pipe\t= idmap_release_pipe,\n\t.destroy_msg\t= idmap_pipe_destroy_msg,\n};",
            "static const struct rpc_pipe_dir_object_ops nfs_idmap_pipe_dir_object_ops = {\n\t.create = nfs_idmap_pipe_create,\n\t.destroy = nfs_idmap_pipe_destroy,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct rpc_pipe_ops idmap_upcall_ops = {\n\t.upcall\t\t= rpc_pipe_generic_upcall,\n\t.downcall\t= idmap_pipe_downcall,\n\t.release_pipe\t= idmap_release_pipe,\n\t.destroy_msg\t= idmap_pipe_destroy_msg,\n};\nstatic const struct rpc_pipe_dir_object_ops nfs_idmap_pipe_dir_object_ops = {\n\t.create = nfs_idmap_pipe_create,\n\t.destroy = nfs_idmap_pipe_destroy,\n};\n\nint\nnfs_idmap_new(struct nfs_client *clp)\n{\n\tstruct idmap *idmap;\n\tstruct rpc_pipe *pipe;\n\tint error;\n\n\tidmap = kzalloc(sizeof(*idmap), GFP_KERNEL);\n\tif (idmap == NULL)\n\t\treturn -ENOMEM;\n\n\trpc_init_pipe_dir_object(&idmap->idmap_pdo,\n\t\t\t&nfs_idmap_pipe_dir_object_ops,\n\t\t\tidmap);\n\n\tpipe = rpc_mkpipe_data(&idmap_upcall_ops, 0);\n\tif (IS_ERR(pipe)) {\n\t\terror = PTR_ERR(pipe);\n\t\tgoto err;\n\t}\n\tidmap->idmap_pipe = pipe;\n\tmutex_init(&idmap->idmap_mutex);\n\n\terror = rpc_add_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\tif (error)\n\t\tgoto err_destroy_pipe;\n\n\tclp->cl_idmap = idmap;\n\treturn 0;\nerr_destroy_pipe:\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\nerr:\n\tkfree(idmap);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "clp->cl_ipaddr",
            "ip_addr",
            "sizeof(clp->cl_ipaddr)"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_ntop",
          "args": [
            "sap",
            "buf",
            "sizeof(buf)"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_localaddr",
          "args": [
            "clp->cl_rpcclient",
            "sap",
            "sizeof(cb_addr)"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_create_rpc_client",
          "args": [
            "clp",
            "timeparms",
            "RPC_AUTH_UNIX"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_create_rpc_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "582-620",
          "snippet": "int nfs_create_rpc_client(struct nfs_client *clp,\n\t\t\t  const struct rpc_timeout *timeparms,\n\t\t\t  rpc_authflavor_t flavor)\n{\n\tstruct rpc_clnt\t\t*clnt = NULL;\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= clp->cl_net,\n\t\t.protocol\t= clp->cl_proto,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrsize\t= clp->cl_addrlen,\n\t\t.timeout\t= timeparms,\n\t\t.servername\t= clp->cl_hostname,\n\t\t.program\t= &nfs_program,\n\t\t.version\t= clp->rpc_ops->version,\n\t\t.authflavor\t= flavor,\n\t};\n\n\tif (test_bit(NFS_CS_DISCRTRY, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_DISCRTRY;\n\tif (test_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NO_RETRANS_TIMEOUT;\n\tif (test_bit(NFS_CS_NORESVPORT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\tif (test_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_INFINITE_SLOTS;\n\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\treturn 0;\n\n\tclnt = rpc_create(&args);\n\tif (IS_ERR(clnt)) {\n\t\tdprintk(\"%s: cannot create RPC client. Error = %ld\\n\",\n\t\t\t\t__func__, PTR_ERR(clnt));\n\t\treturn PTR_ERR(clnt);\n\t}\n\n\tclp->cl_rpcclient = clnt;\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "const struct rpc_program nfs_program = {\n\t.name\t\t\t= \"nfs\",\n\t.number\t\t\t= NFS_PROGRAM,\n\t.nrvers\t\t\t= ARRAY_SIZE(nfs_version),\n\t.version\t\t= nfs_version,\n\t.stats\t\t\t= &nfs_rpcstat,\n\t.pipe_dir_name\t\t= NFS_PIPE_DIRNAME,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nconst struct rpc_program nfs_program = {\n\t.name\t\t\t= \"nfs\",\n\t.number\t\t\t= NFS_PROGRAM,\n\t.nrvers\t\t\t= ARRAY_SIZE(nfs_version),\n\t.version\t\t= nfs_version,\n\t.stats\t\t\t= &nfs_rpcstat,\n\t.pipe_dir_name\t\t= NFS_PIPE_DIRNAME,\n};\n\nint nfs_create_rpc_client(struct nfs_client *clp,\n\t\t\t  const struct rpc_timeout *timeparms,\n\t\t\t  rpc_authflavor_t flavor)\n{\n\tstruct rpc_clnt\t\t*clnt = NULL;\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= clp->cl_net,\n\t\t.protocol\t= clp->cl_proto,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrsize\t= clp->cl_addrlen,\n\t\t.timeout\t= timeparms,\n\t\t.servername\t= clp->cl_hostname,\n\t\t.program\t= &nfs_program,\n\t\t.version\t= clp->rpc_ops->version,\n\t\t.authflavor\t= flavor,\n\t};\n\n\tif (test_bit(NFS_CS_DISCRTRY, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_DISCRTRY;\n\tif (test_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NO_RETRANS_TIMEOUT;\n\tif (test_bit(NFS_CS_NORESVPORT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\tif (test_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_INFINITE_SLOTS;\n\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\treturn 0;\n\n\tclnt = rpc_create(&args);\n\tif (IS_ERR(clnt)) {\n\t\tdprintk(\"%s: cannot create RPC client. Error = %ld\\n\",\n\t\t\t\t__func__, PTR_ERR(clnt));\n\t\treturn PTR_ERR(clnt);\n\t}\n\n\tclp->cl_rpcclient = clnt;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "NFS_CS_NO_RETRANS_TIMEOUT",
            "&clp->cl_flags"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "NFS_CS_DISCRTRY",
            "&clp->cl_flags"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "NFS_CS_INFINITE_SLOTS",
            "&clp->cl_flags"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_init_client() = 0 [already %p]\\n\"",
            "clp"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_client *nfs4_init_client(struct nfs_client *clp,\n\t\t\t\t    const struct rpc_timeout *timeparms,\n\t\t\t\t    const char *ip_addr)\n{\n\tchar buf[INET6_ADDRSTRLEN + 1];\n\tstruct nfs_client *old;\n\tint error;\n\n\tif (clp->cl_cons_state == NFS_CS_READY) {\n\t\t/* the client is initialised already */\n\t\tdprintk(\"<-- nfs4_init_client() = 0 [already %p]\\n\", clp);\n\t\treturn clp;\n\t}\n\n\t/* Check NFS protocol revision and initialize RPC op vector */\n\tclp->rpc_ops = &nfs_v4_clientops;\n\n\tif (clp->cl_minorversion != 0)\n\t\t__set_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags);\n\t__set_bit(NFS_CS_DISCRTRY, &clp->cl_flags);\n\t__set_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags);\n\n\terror = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_GSS_KRB5I);\n\tif (error == -EINVAL)\n\t\terror = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_UNIX);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* If no clientaddr= option was specified, find a usable cb address */\n\tif (ip_addr == NULL) {\n\t\tstruct sockaddr_storage cb_addr;\n\t\tstruct sockaddr *sap = (struct sockaddr *)&cb_addr;\n\n\t\terror = rpc_localaddr(clp->cl_rpcclient, sap, sizeof(cb_addr));\n\t\tif (error < 0)\n\t\t\tgoto error;\n\t\terror = rpc_ntop(sap, buf, sizeof(buf));\n\t\tif (error < 0)\n\t\t\tgoto error;\n\t\tip_addr = (const char *)buf;\n\t}\n\tstrlcpy(clp->cl_ipaddr, ip_addr, sizeof(clp->cl_ipaddr));\n\n\terror = nfs_idmap_new(clp);\n\tif (error < 0) {\n\t\tdprintk(\"%s: failed to create idmapper. Error = %d\\n\",\n\t\t\t__func__, error);\n\t\tgoto error;\n\t}\n\t__set_bit(NFS_CS_IDMAP, &clp->cl_res_state);\n\n\terror = nfs4_init_client_minor_version(clp);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (!nfs4_has_session(clp))\n\t\tnfs_mark_client_ready(clp, NFS_CS_READY);\n\n\terror = nfs4_discover_server_trunking(clp, &old);\n\tif (error < 0)\n\t\tgoto error;\n\n\tif (clp != old)\n\t\tclp->cl_preserve_clid = true;\n\tnfs_put_client(clp);\n\treturn old;\n\nerror:\n\tnfs_mark_client_ready(clp, error);\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs4_init_client() = xerror %d\\n\", error);\n\treturn ERR_PTR(error);\n}"
  },
  {
    "function_name": "nfs4_init_client_minor_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "331-339",
    "snippet": "static int nfs4_init_client_minor_version(struct nfs_client *clp)\n{\n\tint ret;\n\n\tret = clp->cl_mvops->init_client(clp);\n\tif (ret)\n\t\treturn ret;\n\treturn nfs4_init_callback(clp);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_init_callback",
          "args": [
            "clp"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_init_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "243-265",
          "snippet": "static int nfs4_init_callback(struct nfs_client *clp)\n{\n\tstruct rpc_xprt *xprt;\n\tint error;\n\n\txprt = rcu_dereference_raw(clp->cl_rpcclient->cl_xprt);\n\n\tif (nfs4_has_session(clp)) {\n\t\terror = xprt_setup_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\terror = nfs_callback_up(clp->cl_mvops->minor_version, xprt);\n\tif (error < 0) {\n\t\tdprintk(\"%s: failed to start callback. Error = %d\\n\",\n\t\t\t__func__, error);\n\t\treturn error;\n\t}\n\t__set_bit(NFS_CS_CALLBACK, &clp->cl_res_state);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_init_callback(struct nfs_client *clp)\n{\n\tstruct rpc_xprt *xprt;\n\tint error;\n\n\txprt = rcu_dereference_raw(clp->cl_rpcclient->cl_xprt);\n\n\tif (nfs4_has_session(clp)) {\n\t\terror = xprt_setup_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\terror = nfs_callback_up(clp->cl_mvops->minor_version, xprt);\n\tif (error < 0) {\n\t\tdprintk(\"%s: failed to start callback. Error = %d\\n\",\n\t\t\t__func__, error);\n\t\treturn error;\n\t}\n\t__set_bit(NFS_CS_CALLBACK, &clp->cl_res_state);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clp->cl_mvops->init_client",
          "args": [
            "clp"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_init_client_minor_version(struct nfs_client *clp)\n{\n\tint ret;\n\n\tret = clp->cl_mvops->init_client(clp);\n\tif (ret)\n\t\treturn ret;\n\treturn nfs4_init_callback(clp);\n}"
  },
  {
    "function_name": "nfs41_init_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "301-324",
    "snippet": "int nfs41_init_client(struct nfs_client *clp)\n{\n\tstruct nfs4_session *session = NULL;\n\n\t/*\n\t * Create the session and mark it expired.\n\t * When a SEQUENCE operation encounters the expired session\n\t * it will do session recovery to initialize it.\n\t */\n\tsession = nfs4_alloc_session(clp);\n\tif (!session)\n\t\treturn -ENOMEM;\n\n\tclp->cl_session = session;\n\n\t/*\n\t * The create session reply races with the server back\n\t * channel probe. Mark the client NFS_CS_SESSION_INITING\n\t * so that the client back channel can find the\n\t * nfs_client struct\n\t */\n\tnfs_mark_client_ready(clp, NFS_CS_SESSION_INITING);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_mark_client_ready",
          "args": [
            "clp",
            "NFS_CS_SESSION_INITING"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_client_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "529-534",
          "snippet": "void nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nvoid nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_alloc_session",
          "args": [
            "clp"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_alloc_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "466-480",
          "snippet": "struct nfs4_session *nfs4_alloc_session(struct nfs_client *clp)\n{\n\tstruct nfs4_session *session;\n\n\tsession = kzalloc(sizeof(struct nfs4_session), GFP_NOFS);\n\tif (!session)\n\t\treturn NULL;\n\n\tnfs4_init_slot_table(&session->fc_slot_table, \"ForeChannel Slot table\");\n\tnfs4_init_slot_table(&session->bc_slot_table, \"BackChannel Slot table\");\n\tsession->session_state = 1<<NFS4_SESSION_INITING;\n\n\tsession->clp = clp;\n\treturn session;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstruct nfs4_session *nfs4_alloc_session(struct nfs_client *clp)\n{\n\tstruct nfs4_session *session;\n\n\tsession = kzalloc(sizeof(struct nfs4_session), GFP_NOFS);\n\tif (!session)\n\t\treturn NULL;\n\n\tnfs4_init_slot_table(&session->fc_slot_table, \"ForeChannel Slot table\");\n\tnfs4_init_slot_table(&session->bc_slot_table, \"BackChannel Slot table\");\n\tsession->session_state = 1<<NFS4_SESSION_INITING;\n\n\tsession->clp = clp;\n\treturn session;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nint nfs41_init_client(struct nfs_client *clp)\n{\n\tstruct nfs4_session *session = NULL;\n\n\t/*\n\t * Create the session and mark it expired.\n\t * When a SEQUENCE operation encounters the expired session\n\t * it will do session recovery to initialize it.\n\t */\n\tsession = nfs4_alloc_session(clp);\n\tif (!session)\n\t\treturn -ENOMEM;\n\n\tclp->cl_session = session;\n\n\t/*\n\t * The create session reply races with the server back\n\t * channel probe. Mark the client NFS_CS_SESSION_INITING\n\t * so that the client back channel can find the\n\t * nfs_client struct\n\t */\n\tnfs_mark_client_ready(clp, NFS_CS_SESSION_INITING);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs40_init_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "273-291",
    "snippet": "int nfs40_init_client(struct nfs_client *clp)\n{\n\tstruct nfs4_slot_table *tbl;\n\tint ret;\n\n\ttbl = kzalloc(sizeof(*tbl), GFP_NOFS);\n\tif (tbl == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nfs4_setup_slot_table(tbl, NFS4_MAX_SLOT_TABLE,\n\t\t\t\t\t\"NFSv4.0 transport Slot table\");\n\tif (ret) {\n\t\tkfree(tbl);\n\t\treturn ret;\n\t}\n\n\tclp->cl_slot_tbl = tbl;\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "tbl"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_setup_slot_table",
          "args": [
            "tbl",
            "NFS4_MAX_SLOT_TABLE",
            "\"NFSv4.0 transport Slot table\""
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_setup_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "261-266",
          "snippet": "int nfs4_setup_slot_table(struct nfs4_slot_table *tbl, unsigned int max_reqs,\n\t\tconst char *queue)\n{\n\tnfs4_init_slot_table(tbl, queue);\n\treturn nfs4_realloc_slot_table(tbl, max_reqs, 0);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nint nfs4_setup_slot_table(struct nfs4_slot_table *tbl, unsigned int max_reqs,\n\t\tconst char *queue)\n{\n\tnfs4_init_slot_table(tbl, queue);\n\treturn nfs4_realloc_slot_table(tbl, max_reqs, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*tbl)",
            "GFP_NOFS"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nint nfs40_init_client(struct nfs_client *clp)\n{\n\tstruct nfs4_slot_table *tbl;\n\tint ret;\n\n\ttbl = kzalloc(sizeof(*tbl), GFP_NOFS);\n\tif (tbl == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nfs4_setup_slot_table(tbl, NFS4_MAX_SLOT_TABLE,\n\t\t\t\t\t\"NFSv4.0 transport Slot table\");\n\tif (ret) {\n\t\tkfree(tbl);\n\t\treturn ret;\n\t}\n\n\tclp->cl_slot_tbl = tbl;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs4_init_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "243-265",
    "snippet": "static int nfs4_init_callback(struct nfs_client *clp)\n{\n\tstruct rpc_xprt *xprt;\n\tint error;\n\n\txprt = rcu_dereference_raw(clp->cl_rpcclient->cl_xprt);\n\n\tif (nfs4_has_session(clp)) {\n\t\terror = xprt_setup_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\terror = nfs_callback_up(clp->cl_mvops->minor_version, xprt);\n\tif (error < 0) {\n\t\tdprintk(\"%s: failed to start callback. Error = %d\\n\",\n\t\t\t__func__, error);\n\t\treturn error;\n\t}\n\t__set_bit(NFS_CS_CALLBACK, &clp->cl_res_state);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "NFS_CS_CALLBACK",
            "&clp->cl_res_state"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: failed to start callback. Error = %d\\n\"",
            "__func__",
            "error"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_callback_up",
          "args": [
            "clp->cl_mvops->minor_version",
            "xprt"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_callback_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/callback.c",
          "lines": "352-392",
          "snippet": "int nfs_callback_up(u32 minorversion, struct rpc_xprt *xprt)\n{\n\tstruct svc_serv *serv;\n\tstruct nfs_callback_data *cb_info = &nfs_callback_info[minorversion];\n\tint ret;\n\tstruct net *net = xprt->xprt_net;\n\n\tmutex_lock(&nfs_callback_mutex);\n\n\tserv = nfs_callback_create_svc(minorversion);\n\tif (IS_ERR(serv)) {\n\t\tret = PTR_ERR(serv);\n\t\tgoto err_create;\n\t}\n\n\tret = nfs_callback_up_net(minorversion, serv, net);\n\tif (ret < 0)\n\t\tgoto err_net;\n\n\tret = nfs_callback_start_svc(minorversion, xprt, serv);\n\tif (ret < 0)\n\t\tgoto err_start;\n\n\tcb_info->users++;\n\t/*\n\t * svc_create creates the svc_serv with sv_nrthreads == 1, and then\n\t * svc_prepare_thread increments that. So we need to call svc_destroy\n\t * on both success and failure so that the refcount is 1 when the\n\t * thread exits.\n\t */\nerr_net:\n\tsvc_destroy(serv);\nerr_create:\n\tmutex_unlock(&nfs_callback_mutex);\n\treturn ret;\n\nerr_start:\n\tnfs_callback_down_net(minorversion, serv, net);\n\tdprintk(\"NFS: Couldn't create server thread; err = %d\\n\", ret);\n\tgoto err_net;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <net/inet_sock.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/svcauth_gss.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mutex.h>",
            "#include <linux/errno.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/module.h>",
            "#include <linux/ip.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct nfs_callback_data nfs_callback_info[NFS4_MAX_MINOR_VERSION + 1];",
            "static DEFINE_MUTEX(nfs_callback_mutex);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"internal.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <net/inet_sock.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/svcauth_gss.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/mutex.h>\n#include <linux/errno.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/module.h>\n#include <linux/ip.h>\n#include <linux/completion.h>\n\nstatic struct nfs_callback_data nfs_callback_info[NFS4_MAX_MINOR_VERSION + 1];\nstatic DEFINE_MUTEX(nfs_callback_mutex);\n\nint nfs_callback_up(u32 minorversion, struct rpc_xprt *xprt)\n{\n\tstruct svc_serv *serv;\n\tstruct nfs_callback_data *cb_info = &nfs_callback_info[minorversion];\n\tint ret;\n\tstruct net *net = xprt->xprt_net;\n\n\tmutex_lock(&nfs_callback_mutex);\n\n\tserv = nfs_callback_create_svc(minorversion);\n\tif (IS_ERR(serv)) {\n\t\tret = PTR_ERR(serv);\n\t\tgoto err_create;\n\t}\n\n\tret = nfs_callback_up_net(minorversion, serv, net);\n\tif (ret < 0)\n\t\tgoto err_net;\n\n\tret = nfs_callback_start_svc(minorversion, xprt, serv);\n\tif (ret < 0)\n\t\tgoto err_start;\n\n\tcb_info->users++;\n\t/*\n\t * svc_create creates the svc_serv with sv_nrthreads == 1, and then\n\t * svc_prepare_thread increments that. So we need to call svc_destroy\n\t * on both success and failure so that the refcount is 1 when the\n\t * thread exits.\n\t */\nerr_net:\n\tsvc_destroy(serv);\nerr_create:\n\tmutex_unlock(&nfs_callback_mutex);\n\treturn ret;\n\nerr_start:\n\tnfs_callback_down_net(minorversion, serv, net);\n\tdprintk(\"NFS: Couldn't create server thread; err = %d\\n\", ret);\n\tgoto err_net;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xprt_setup_backchannel",
          "args": [
            "xprt",
            "NFS41_BC_MIN_CALLBACKS"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_has_session",
          "args": [
            "clp"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_has_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "148-151",
          "snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference_raw",
          "args": [
            "clp->cl_rpcclient->cl_xprt"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs4_init_callback(struct nfs_client *clp)\n{\n\tstruct rpc_xprt *xprt;\n\tint error;\n\n\txprt = rcu_dereference_raw(clp->cl_rpcclient->cl_xprt);\n\n\tif (nfs4_has_session(clp)) {\n\t\terror = xprt_setup_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\t\tif (error < 0)\n\t\t\treturn error;\n\t}\n\n\terror = nfs_callback_up(clp->cl_mvops->minor_version, xprt);\n\tif (error < 0) {\n\t\tdprintk(\"%s: failed to start callback. Error = %d\\n\",\n\t\t\t__func__, error);\n\t\treturn error;\n\t}\n\t__set_bit(NFS_CS_CALLBACK, &clp->cl_res_state);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs4_free_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "234-238",
    "snippet": "void nfs4_free_client(struct nfs_client *clp)\n{\n\tnfs4_shutdown_client(clp);\n\tnfs_free_client(clp);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_client",
          "args": [
            "clp"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "241-261",
          "snippet": "void nfs_free_client(struct nfs_client *clp)\n{\n\tdprintk(\"--> nfs_free_client(%u)\\n\", clp->rpc_ops->version);\n\n\tnfs_fscache_release_client_cookie(clp);\n\n\t/* -EIO all pending I/O */\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\trpc_shutdown_client(clp->cl_rpcclient);\n\n\tif (clp->cl_machine_cred != NULL)\n\t\tput_rpccred(clp->cl_machine_cred);\n\n\tput_net(clp->cl_net);\n\tput_nfs_version(clp->cl_nfs_mod);\n\tkfree(clp->cl_hostname);\n\tkfree(clp->cl_acceptor);\n\tkfree(clp);\n\n\tdprintk(\"<-- nfs_free_client()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_client(struct nfs_client *clp)\n{\n\tdprintk(\"--> nfs_free_client(%u)\\n\", clp->rpc_ops->version);\n\n\tnfs_fscache_release_client_cookie(clp);\n\n\t/* -EIO all pending I/O */\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\trpc_shutdown_client(clp->cl_rpcclient);\n\n\tif (clp->cl_machine_cred != NULL)\n\t\tput_rpccred(clp->cl_machine_cred);\n\n\tput_net(clp->cl_net);\n\tput_nfs_version(clp->cl_nfs_mod);\n\tkfree(clp->cl_hostname);\n\tkfree(clp->cl_acceptor);\n\tkfree(clp);\n\n\tdprintk(\"<-- nfs_free_client()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_shutdown_client",
          "args": [
            "clp"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_shutdown_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "218-232",
          "snippet": "static void nfs4_shutdown_client(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_RENEWD, &clp->cl_res_state))\n\t\tnfs4_kill_renewd(clp);\n\tclp->cl_mvops->shutdown_client(clp);\n\tnfs4_destroy_callback(clp);\n\tif (__test_and_clear_bit(NFS_CS_IDMAP, &clp->cl_res_state))\n\t\tnfs_idmap_delete(clp);\n\n\trpc_destroy_wait_queue(&clp->cl_rpcwaitq);\n\tkfree(clp->cl_serverowner);\n\tkfree(clp->cl_serverscope);\n\tkfree(clp->cl_implid);\n\tkfree(clp->cl_owner_id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_shutdown_client(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_RENEWD, &clp->cl_res_state))\n\t\tnfs4_kill_renewd(clp);\n\tclp->cl_mvops->shutdown_client(clp);\n\tnfs4_destroy_callback(clp);\n\tif (__test_and_clear_bit(NFS_CS_IDMAP, &clp->cl_res_state))\n\t\tnfs_idmap_delete(clp);\n\n\trpc_destroy_wait_queue(&clp->cl_rpcwaitq);\n\tkfree(clp->cl_serverowner);\n\tkfree(clp->cl_serverscope);\n\tkfree(clp->cl_implid);\n\tkfree(clp->cl_owner_id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nvoid nfs4_free_client(struct nfs_client *clp)\n{\n\tnfs4_shutdown_client(clp);\n\tnfs_free_client(clp);\n}"
  },
  {
    "function_name": "nfs4_shutdown_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "218-232",
    "snippet": "static void nfs4_shutdown_client(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_RENEWD, &clp->cl_res_state))\n\t\tnfs4_kill_renewd(clp);\n\tclp->cl_mvops->shutdown_client(clp);\n\tnfs4_destroy_callback(clp);\n\tif (__test_and_clear_bit(NFS_CS_IDMAP, &clp->cl_res_state))\n\t\tnfs_idmap_delete(clp);\n\n\trpc_destroy_wait_queue(&clp->cl_rpcwaitq);\n\tkfree(clp->cl_serverowner);\n\tkfree(clp->cl_serverscope);\n\tkfree(clp->cl_implid);\n\tkfree(clp->cl_owner_id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp->cl_owner_id"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp->cl_implid"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp->cl_serverscope"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp->cl_serverowner"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_destroy_wait_queue",
          "args": [
            "&clp->cl_rpcwaitq"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_delete",
          "args": [
            "clp"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "480-493",
          "snippet": "void\nnfs_idmap_delete(struct nfs_client *clp)\n{\n\tstruct idmap *idmap = clp->cl_idmap;\n\n\tif (!idmap)\n\t\treturn;\n\tclp->cl_idmap = NULL;\n\trpc_remove_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\n\tkfree(idmap);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid\nnfs_idmap_delete(struct nfs_client *clp)\n{\n\tstruct idmap *idmap = clp->cl_idmap;\n\n\tif (!idmap)\n\t\treturn;\n\tclp->cl_idmap = NULL;\n\trpc_remove_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\n\tkfree(idmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__test_and_clear_bit",
          "args": [
            "NFS_CS_IDMAP",
            "&clp->cl_res_state"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_destroy_callback",
          "args": [
            "clp"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_destroy_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "212-216",
          "snippet": "static void nfs4_destroy_callback(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_CALLBACK, &clp->cl_res_state))\n\t\tnfs_callback_down(clp->cl_mvops->minor_version, clp->cl_net);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_destroy_callback(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_CALLBACK, &clp->cl_res_state))\n\t\tnfs_callback_down(clp->cl_mvops->minor_version, clp->cl_net);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clp->cl_mvops->shutdown_client",
          "args": [
            "clp"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_kill_renewd",
          "args": [
            "clp"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_kill_renewd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4renewd.c",
          "lines": "133-137",
          "snippet": "void\nnfs4_kill_renewd(struct nfs_client *clp)\n{\n\tcancel_delayed_work_sync(&clp->cl_renewd);\n}",
          "includes": [
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n\nvoid\nnfs4_kill_renewd(struct nfs_client *clp)\n{\n\tcancel_delayed_work_sync(&clp->cl_renewd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__test_and_clear_bit",
          "args": [
            "NFS_CS_RENEWD",
            "&clp->cl_res_state"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_shutdown_client(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_RENEWD, &clp->cl_res_state))\n\t\tnfs4_kill_renewd(clp);\n\tclp->cl_mvops->shutdown_client(clp);\n\tnfs4_destroy_callback(clp);\n\tif (__test_and_clear_bit(NFS_CS_IDMAP, &clp->cl_res_state))\n\t\tnfs_idmap_delete(clp);\n\n\trpc_destroy_wait_queue(&clp->cl_rpcwaitq);\n\tkfree(clp->cl_serverowner);\n\tkfree(clp->cl_serverscope);\n\tkfree(clp->cl_implid);\n\tkfree(clp->cl_owner_id);\n}"
  },
  {
    "function_name": "nfs4_destroy_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "212-216",
    "snippet": "static void nfs4_destroy_callback(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_CALLBACK, &clp->cl_res_state))\n\t\tnfs_callback_down(clp->cl_mvops->minor_version, clp->cl_net);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_callback_down",
          "args": [
            "clp->cl_mvops->minor_version",
            "clp->cl_net"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_callback_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/callback.c",
          "lines": "397-414",
          "snippet": "void nfs_callback_down(int minorversion, struct net *net)\n{\n\tstruct nfs_callback_data *cb_info = &nfs_callback_info[minorversion];\n\n\tmutex_lock(&nfs_callback_mutex);\n\tnfs_callback_down_net(minorversion, cb_info->serv, net);\n\tcb_info->users--;\n\tif (cb_info->users == 0 && cb_info->task != NULL) {\n\t\tkthread_stop(cb_info->task);\n\t\tdprintk(\"nfs_callback_down: service stopped\\n\");\n\t\tsvc_exit_thread(cb_info->rqst);\n\t\tdprintk(\"nfs_callback_down: service destroyed\\n\");\n\t\tcb_info->serv = NULL;\n\t\tcb_info->rqst = NULL;\n\t\tcb_info->task = NULL;\n\t}\n\tmutex_unlock(&nfs_callback_mutex);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <net/inet_sock.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/svcauth_gss.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mutex.h>",
            "#include <linux/errno.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/module.h>",
            "#include <linux/ip.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct nfs_callback_data nfs_callback_info[NFS4_MAX_MINOR_VERSION + 1];",
            "static DEFINE_MUTEX(nfs_callback_mutex);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"internal.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <net/inet_sock.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/svcauth_gss.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/mutex.h>\n#include <linux/errno.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/module.h>\n#include <linux/ip.h>\n#include <linux/completion.h>\n\nstatic struct nfs_callback_data nfs_callback_info[NFS4_MAX_MINOR_VERSION + 1];\nstatic DEFINE_MUTEX(nfs_callback_mutex);\n\nvoid nfs_callback_down(int minorversion, struct net *net)\n{\n\tstruct nfs_callback_data *cb_info = &nfs_callback_info[minorversion];\n\n\tmutex_lock(&nfs_callback_mutex);\n\tnfs_callback_down_net(minorversion, cb_info->serv, net);\n\tcb_info->users--;\n\tif (cb_info->users == 0 && cb_info->task != NULL) {\n\t\tkthread_stop(cb_info->task);\n\t\tdprintk(\"nfs_callback_down: service stopped\\n\");\n\t\tsvc_exit_thread(cb_info->rqst);\n\t\tdprintk(\"nfs_callback_down: service destroyed\\n\");\n\t\tcb_info->serv = NULL;\n\t\tcb_info->rqst = NULL;\n\t\tcb_info->task = NULL;\n\t}\n\tmutex_unlock(&nfs_callback_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__test_and_clear_bit",
          "args": [
            "NFS_CS_CALLBACK",
            "&clp->cl_res_state"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void nfs4_destroy_callback(struct nfs_client *clp)\n{\n\tif (__test_and_clear_bit(NFS_CS_CALLBACK, &clp->cl_res_state))\n\t\tnfs_callback_down(clp->cl_mvops->minor_version, clp->cl_net);\n}"
  },
  {
    "function_name": "nfs4_alloc_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "178-207",
    "snippet": "struct nfs_client *nfs4_alloc_client(const struct nfs_client_initdata *cl_init)\n{\n\tint err;\n\tstruct nfs_client *clp = nfs_alloc_client(cl_init);\n\tif (IS_ERR(clp))\n\t\treturn clp;\n\n\terr = nfs_get_cb_ident_idr(clp, cl_init->minorversion);\n\tif (err)\n\t\tgoto error;\n\n\tif (cl_init->minorversion > NFS4_MAX_MINOR_VERSION) {\n\t\terr = -EINVAL;\n\t\tgoto error;\n\t}\n\n\tspin_lock_init(&clp->cl_lock);\n\tINIT_DELAYED_WORK(&clp->cl_renewd, nfs4_renew_state);\n\tINIT_LIST_HEAD(&clp->cl_ds_clients);\n\trpc_init_wait_queue(&clp->cl_rpcwaitq, \"NFS client\");\n\tclp->cl_state = 1 << NFS4CLNT_LEASE_EXPIRED;\n\tclp->cl_minorversion = cl_init->minorversion;\n\tclp->cl_mvops = nfs_v4_minor_ops[cl_init->minorversion];\n\tclp->cl_mig_gen = 1;\n\treturn clp;\n\nerror:\n\tnfs_free_client(clp);\n\treturn ERR_PTR(err);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_client",
          "args": [
            "clp"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "241-261",
          "snippet": "void nfs_free_client(struct nfs_client *clp)\n{\n\tdprintk(\"--> nfs_free_client(%u)\\n\", clp->rpc_ops->version);\n\n\tnfs_fscache_release_client_cookie(clp);\n\n\t/* -EIO all pending I/O */\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\trpc_shutdown_client(clp->cl_rpcclient);\n\n\tif (clp->cl_machine_cred != NULL)\n\t\tput_rpccred(clp->cl_machine_cred);\n\n\tput_net(clp->cl_net);\n\tput_nfs_version(clp->cl_nfs_mod);\n\tkfree(clp->cl_hostname);\n\tkfree(clp->cl_acceptor);\n\tkfree(clp);\n\n\tdprintk(\"<-- nfs_free_client()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_client(struct nfs_client *clp)\n{\n\tdprintk(\"--> nfs_free_client(%u)\\n\", clp->rpc_ops->version);\n\n\tnfs_fscache_release_client_cookie(clp);\n\n\t/* -EIO all pending I/O */\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\trpc_shutdown_client(clp->cl_rpcclient);\n\n\tif (clp->cl_machine_cred != NULL)\n\t\tput_rpccred(clp->cl_machine_cred);\n\n\tput_net(clp->cl_net);\n\tput_nfs_version(clp->cl_nfs_mod);\n\tkfree(clp->cl_hostname);\n\tkfree(clp->cl_acceptor);\n\tkfree(clp);\n\n\tdprintk(\"<-- nfs_free_client()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_init_wait_queue",
          "args": [
            "&clp->cl_rpcwaitq",
            "\"NFS client\""
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&clp->cl_ds_clients"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_DELAYED_WORK",
          "args": [
            "&clp->cl_renewd",
            "nfs4_renew_state"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_cb_ident_idr",
          "args": [
            "clp",
            "cl_init->minorversion"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_cb_ident_idr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "27-42",
          "snippet": "static int nfs_get_cb_ident_idr(struct nfs_client *clp, int minorversion)\n{\n\tint ret = 0;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (clp->rpc_ops->version != 4 || minorversion != 0)\n\t\treturn ret;\n\tidr_preload(GFP_KERNEL);\n\tspin_lock(&nn->nfs_client_lock);\n\tret = idr_alloc(&nn->cb_ident_idr, clp, 0, 0, GFP_NOWAIT);\n\tif (ret >= 0)\n\t\tclp->cl_cb_ident = ret;\n\tspin_unlock(&nn->nfs_client_lock);\n\tidr_preload_end();\n\treturn ret < 0 ? ret : 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs_get_cb_ident_idr(struct nfs_client *clp, int minorversion)\n{\n\tint ret = 0;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (clp->rpc_ops->version != 4 || minorversion != 0)\n\t\treturn ret;\n\tidr_preload(GFP_KERNEL);\n\tspin_lock(&nn->nfs_client_lock);\n\tret = idr_alloc(&nn->cb_ident_idr, clp, 0, 0, GFP_NOWAIT);\n\tif (ret >= 0)\n\t\tclp->cl_cb_ident = ret;\n\tspin_unlock(&nn->nfs_client_lock);\n\tidr_preload_end();\n\treturn ret < 0 ? ret : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clp"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_client",
          "args": [
            "cl_init"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "151-198",
          "snippet": "struct nfs_client *nfs_alloc_client(const struct nfs_client_initdata *cl_init)\n{\n\tstruct nfs_client *clp;\n\tstruct rpc_cred *cred;\n\tint err = -ENOMEM;\n\n\tif ((clp = kzalloc(sizeof(*clp), GFP_KERNEL)) == NULL)\n\t\tgoto error_0;\n\n\tclp->cl_nfs_mod = cl_init->nfs_mod;\n\tif (!try_module_get(clp->cl_nfs_mod->owner))\n\t\tgoto error_dealloc;\n\n\tclp->rpc_ops = clp->cl_nfs_mod->rpc_ops;\n\n\tatomic_set(&clp->cl_count, 1);\n\tclp->cl_cons_state = NFS_CS_INITING;\n\n\tmemcpy(&clp->cl_addr, cl_init->addr, cl_init->addrlen);\n\tclp->cl_addrlen = cl_init->addrlen;\n\n\tif (cl_init->hostname) {\n\t\terr = -ENOMEM;\n\t\tclp->cl_hostname = kstrdup(cl_init->hostname, GFP_KERNEL);\n\t\tif (!clp->cl_hostname)\n\t\t\tgoto error_cleanup;\n\t}\n\n\tINIT_LIST_HEAD(&clp->cl_superblocks);\n\tclp->cl_rpcclient = ERR_PTR(-EINVAL);\n\n\tclp->cl_proto = cl_init->proto;\n\tclp->cl_net = get_net(cl_init->net);\n\n\tcred = rpc_lookup_machine_cred(\"*\");\n\tif (!IS_ERR(cred))\n\t\tclp->cl_machine_cred = cred;\n\tnfs_fscache_get_client_cookie(clp);\n\n\treturn clp;\n\nerror_cleanup:\n\tput_nfs_version(clp->cl_nfs_mod);\nerror_dealloc:\n\tkfree(clp);\nerror_0:\n\treturn ERR_PTR(err);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_client *nfs_alloc_client(const struct nfs_client_initdata *cl_init)\n{\n\tstruct nfs_client *clp;\n\tstruct rpc_cred *cred;\n\tint err = -ENOMEM;\n\n\tif ((clp = kzalloc(sizeof(*clp), GFP_KERNEL)) == NULL)\n\t\tgoto error_0;\n\n\tclp->cl_nfs_mod = cl_init->nfs_mod;\n\tif (!try_module_get(clp->cl_nfs_mod->owner))\n\t\tgoto error_dealloc;\n\n\tclp->rpc_ops = clp->cl_nfs_mod->rpc_ops;\n\n\tatomic_set(&clp->cl_count, 1);\n\tclp->cl_cons_state = NFS_CS_INITING;\n\n\tmemcpy(&clp->cl_addr, cl_init->addr, cl_init->addrlen);\n\tclp->cl_addrlen = cl_init->addrlen;\n\n\tif (cl_init->hostname) {\n\t\terr = -ENOMEM;\n\t\tclp->cl_hostname = kstrdup(cl_init->hostname, GFP_KERNEL);\n\t\tif (!clp->cl_hostname)\n\t\t\tgoto error_cleanup;\n\t}\n\n\tINIT_LIST_HEAD(&clp->cl_superblocks);\n\tclp->cl_rpcclient = ERR_PTR(-EINVAL);\n\n\tclp->cl_proto = cl_init->proto;\n\tclp->cl_net = get_net(cl_init->net);\n\n\tcred = rpc_lookup_machine_cred(\"*\");\n\tif (!IS_ERR(cred))\n\t\tclp->cl_machine_cred = cred;\n\tnfs_fscache_get_client_cookie(clp);\n\n\treturn clp;\n\nerror_cleanup:\n\tput_nfs_version(clp->cl_nfs_mod);\nerror_dealloc:\n\tkfree(clp);\nerror_0:\n\treturn ERR_PTR(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_client *nfs4_alloc_client(const struct nfs_client_initdata *cl_init)\n{\n\tint err;\n\tstruct nfs_client *clp = nfs_alloc_client(cl_init);\n\tif (IS_ERR(clp))\n\t\treturn clp;\n\n\terr = nfs_get_cb_ident_idr(clp, cl_init->minorversion);\n\tif (err)\n\t\tgoto error;\n\n\tif (cl_init->minorversion > NFS4_MAX_MINOR_VERSION) {\n\t\terr = -EINVAL;\n\t\tgoto error;\n\t}\n\n\tspin_lock_init(&clp->cl_lock);\n\tINIT_DELAYED_WORK(&clp->cl_renewd, nfs4_renew_state);\n\tINIT_LIST_HEAD(&clp->cl_ds_clients);\n\trpc_init_wait_queue(&clp->cl_rpcwaitq, \"NFS client\");\n\tclp->cl_state = 1 << NFS4CLNT_LEASE_EXPIRED;\n\tclp->cl_minorversion = cl_init->minorversion;\n\tclp->cl_mvops = nfs_v4_minor_ops[cl_init->minorversion];\n\tclp->cl_mig_gen = 1;\n\treturn clp;\n\nerror:\n\tnfs_free_client(clp);\n\treturn ERR_PTR(err);\n}"
  },
  {
    "function_name": "nfs40_shutdown_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "170-176",
    "snippet": "void nfs40_shutdown_client(struct nfs_client *clp)\n{\n\tif (clp->cl_slot_tbl) {\n\t\tnfs4_shutdown_slot_table(clp->cl_slot_tbl);\n\t\tkfree(clp->cl_slot_tbl);\n\t}\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp->cl_slot_tbl"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_shutdown_slot_table",
          "args": [
            "clp->cl_slot_tbl"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_shutdown_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "247-251",
          "snippet": "void nfs4_shutdown_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_release_slot_table(tbl);\n\trpc_destroy_wait_queue(&tbl->slot_tbl_waitq);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_shutdown_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_release_slot_table(tbl);\n\trpc_destroy_wait_queue(&tbl->slot_tbl_waitq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nvoid nfs40_shutdown_client(struct nfs_client *clp)\n{\n\tif (clp->cl_slot_tbl) {\n\t\tnfs4_shutdown_slot_table(clp->cl_slot_tbl);\n\t\tkfree(clp->cl_slot_tbl);\n\t}\n}"
  },
  {
    "function_name": "nfs41_shutdown_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "159-167",
    "snippet": "void nfs41_shutdown_client(struct nfs_client *clp)\n{\n\tif (nfs4_has_session(clp)) {\n\t\tnfs4_shutdown_ds_clients(clp);\n\t\tnfs4_destroy_session(clp->cl_session);\n\t\tnfs4_destroy_clientid(clp);\n\t}\n\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_destroy_clientid",
          "args": [
            "clp"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_destroy_clientid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "7015-7037",
          "snippet": "int nfs4_destroy_clientid(struct nfs_client *clp)\n{\n\tstruct rpc_cred *cred;\n\tint ret = 0;\n\n\tif (clp->cl_mvops->minor_version < 1)\n\t\tgoto out;\n\tif (clp->cl_exchange_flags == 0)\n\t\tgoto out;\n\tif (clp->cl_preserve_clid)\n\t\tgoto out;\n\tcred = nfs4_get_clid_cred(clp);\n\tret = nfs4_proc_destroy_clientid(clp, cred);\n\tif (cred)\n\t\tput_rpccred(cred);\n\tswitch (ret) {\n\tcase 0:\n\tcase -NFS4ERR_STALE_CLIENTID:\n\t\tclp->cl_exchange_flags = 0;\n\t}\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nint nfs4_destroy_clientid(struct nfs_client *clp)\n{\n\tstruct rpc_cred *cred;\n\tint ret = 0;\n\n\tif (clp->cl_mvops->minor_version < 1)\n\t\tgoto out;\n\tif (clp->cl_exchange_flags == 0)\n\t\tgoto out;\n\tif (clp->cl_preserve_clid)\n\t\tgoto out;\n\tcred = nfs4_get_clid_cred(clp);\n\tret = nfs4_proc_destroy_clientid(clp, cred);\n\tif (cred)\n\t\tput_rpccred(cred);\n\tswitch (ret) {\n\tcase 0:\n\tcase -NFS4ERR_STALE_CLIENTID:\n\t\tclp->cl_exchange_flags = 0;\n\t}\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_destroy_session",
          "args": [
            "clp->cl_session"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_destroy_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "488-506",
          "snippet": "void nfs4_destroy_session(struct nfs4_session *session)\n{\n\tstruct rpc_xprt *xprt;\n\tstruct rpc_cred *cred;\n\n\tcred = nfs4_get_clid_cred(session->clp);\n\tnfs4_proc_destroy_session(session, cred);\n\tif (cred)\n\t\tput_rpccred(cred);\n\n\trcu_read_lock();\n\txprt = rcu_dereference(session->clp->cl_rpcclient->cl_xprt);\n\trcu_read_unlock();\n\tdprintk(\"%s Destroy backchannel for xprt %p\\n\",\n\t\t__func__, xprt);\n\txprt_destroy_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\tnfs4_destroy_session_slot_tables(session);\n\tkfree(session);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_destroy_session(struct nfs4_session *session)\n{\n\tstruct rpc_xprt *xprt;\n\tstruct rpc_cred *cred;\n\n\tcred = nfs4_get_clid_cred(session->clp);\n\tnfs4_proc_destroy_session(session, cred);\n\tif (cred)\n\t\tput_rpccred(cred);\n\n\trcu_read_lock();\n\txprt = rcu_dereference(session->clp->cl_rpcclient->cl_xprt);\n\trcu_read_unlock();\n\tdprintk(\"%s Destroy backchannel for xprt %p\\n\",\n\t\t__func__, xprt);\n\txprt_destroy_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\tnfs4_destroy_session_slot_tables(session);\n\tkfree(session);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_shutdown_ds_clients",
          "args": [
            "clp"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_shutdown_ds_clients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "144-157",
          "snippet": "static void\nnfs4_shutdown_ds_clients(struct nfs_client *clp)\n{\n\tstruct nfs4_ds_server *dss;\n\tLIST_HEAD(shutdown_list);\n\n\twhile (!list_empty(&clp->cl_ds_clients)) {\n\t\tdss = list_entry(clp->cl_ds_clients.next,\n\t\t\t\t\tstruct nfs4_ds_server, list);\n\t\tlist_del(&dss->list);\n\t\trpc_shutdown_client(dss->rpc_clnt);\n\t\tkfree (dss);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void\nnfs4_shutdown_ds_clients(struct nfs_client *clp)\n{\n\tstruct nfs4_ds_server *dss;\n\tLIST_HEAD(shutdown_list);\n\n\twhile (!list_empty(&clp->cl_ds_clients)) {\n\t\tdss = list_entry(clp->cl_ds_clients.next,\n\t\t\t\t\tstruct nfs4_ds_server, list);\n\t\tlist_del(&dss->list);\n\t\trpc_shutdown_client(dss->rpc_clnt);\n\t\tkfree (dss);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_has_session",
          "args": [
            "clp"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_has_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "148-151",
          "snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nvoid nfs41_shutdown_client(struct nfs_client *clp)\n{\n\tif (nfs4_has_session(clp)) {\n\t\tnfs4_shutdown_ds_clients(clp);\n\t\tnfs4_destroy_session(clp->cl_session);\n\t\tnfs4_destroy_clientid(clp);\n\t}\n\n}"
  },
  {
    "function_name": "nfs4_shutdown_ds_clients",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "144-157",
    "snippet": "static void\nnfs4_shutdown_ds_clients(struct nfs_client *clp)\n{\n\tstruct nfs4_ds_server *dss;\n\tLIST_HEAD(shutdown_list);\n\n\twhile (!list_empty(&clp->cl_ds_clients)) {\n\t\tdss = list_entry(clp->cl_ds_clients.next,\n\t\t\t\t\tstruct nfs4_ds_server, list);\n\t\tlist_del(&dss->list);\n\t\trpc_shutdown_client(dss->rpc_clnt);\n\t\tkfree (dss);\n\t}\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dss"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_shutdown_client",
          "args": [
            "dss->rpc_clnt"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&dss->list"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "clp->cl_ds_clients.next",
            "structnfs4_ds_server",
            "list"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&clp->cl_ds_clients"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "shutdown_list"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void\nnfs4_shutdown_ds_clients(struct nfs_client *clp)\n{\n\tstruct nfs4_ds_server *dss;\n\tLIST_HEAD(shutdown_list);\n\n\twhile (!list_empty(&clp->cl_ds_clients)) {\n\t\tdss = list_entry(clp->cl_ds_clients.next,\n\t\t\t\t\tstruct nfs4_ds_server, list);\n\t\tlist_del(&dss->list);\n\t\trpc_shutdown_client(dss->rpc_clnt);\n\t\tkfree (dss);\n\t}\n}"
  },
  {
    "function_name": "nfs4_find_or_create_ds_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "124-141",
    "snippet": "struct rpc_clnt *\nnfs4_find_or_create_ds_client(struct nfs_client *ds_clp, struct inode *inode)\n{\n\tstruct nfs4_ds_server *dss, *new;\n\trpc_authflavor_t flavor = NFS_SERVER(inode)->client->cl_auth->au_flavor;\n\n\tdss = nfs4_find_ds_client(ds_clp, flavor);\n\tif (dss != NULL)\n\t\tgoto out;\n\tnew = nfs4_alloc_ds_server(ds_clp, flavor);\n\tif (IS_ERR(new))\n\t\treturn ERR_CAST(new);\n\tdss = nfs4_add_ds_client(ds_clp, flavor, new);\n\tif (dss != new)\n\t\tnfs4_free_ds_server(new);\nout:\n\treturn dss->rpc_clnt;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_free_ds_server",
          "args": [
            "new"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_free_ds_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "113-118",
          "snippet": "static void\nnfs4_free_ds_server(struct nfs4_ds_server *dss)\n{\n\trpc_release_client(dss->rpc_clnt);\n\tkfree(dss);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void\nnfs4_free_ds_server(struct nfs4_ds_server *dss)\n{\n\trpc_release_client(dss->rpc_clnt);\n\tkfree(dss);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_add_ds_client",
          "args": [
            "ds_clp",
            "flavor",
            "new"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_add_ds_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "73-91",
          "snippet": "static struct nfs4_ds_server *\nnfs4_add_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor,\n\t\t\t   struct nfs4_ds_server *new)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tspin_lock(&ds_clp->cl_lock);\n\tlist_for_each_entry(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tif (new)\n\t\tlist_add_rcu(&new->list, &ds_clp->cl_ds_clients);\n\tdss = new;\nout:\n\tspin_unlock(&ds_clp->cl_lock); /* need some lock to protect list */\n\treturn dss;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs4_ds_server *\nnfs4_add_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor,\n\t\t\t   struct nfs4_ds_server *new)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tspin_lock(&ds_clp->cl_lock);\n\tlist_for_each_entry(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tif (new)\n\t\tlist_add_rcu(&new->list, &ds_clp->cl_ds_clients);\n\tdss = new;\nout:\n\tspin_unlock(&ds_clp->cl_lock); /* need some lock to protect list */\n\treturn dss;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "new"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "new"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_alloc_ds_server",
          "args": [
            "ds_clp",
            "flavor"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_alloc_ds_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "93-111",
          "snippet": "static struct nfs4_ds_server *\nnfs4_alloc_ds_server(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tdss = kmalloc(sizeof(*dss), GFP_NOFS);\n\tif (dss == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tdss->rpc_clnt = rpc_clone_client_set_auth(ds_clp->cl_rpcclient, flavor);\n\tif (IS_ERR(dss->rpc_clnt)) {\n\t\tint err = PTR_ERR(dss->rpc_clnt);\n\t\tkfree (dss);\n\t\treturn ERR_PTR(err);\n\t}\n\tINIT_LIST_HEAD(&dss->list);\n\n\treturn dss;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs4_ds_server *\nnfs4_alloc_ds_server(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tdss = kmalloc(sizeof(*dss), GFP_NOFS);\n\tif (dss == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tdss->rpc_clnt = rpc_clone_client_set_auth(ds_clp->cl_rpcclient, flavor);\n\tif (IS_ERR(dss->rpc_clnt)) {\n\t\tint err = PTR_ERR(dss->rpc_clnt);\n\t\tkfree (dss);\n\t\treturn ERR_PTR(err);\n\t}\n\tINIT_LIST_HEAD(&dss->list);\n\n\treturn dss;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_find_ds_client",
          "args": [
            "ds_clp",
            "flavor"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_find_ds_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "56-71",
          "snippet": "static struct nfs4_ds_server *\nnfs4_find_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tdss = NULL;\nout:\n\trcu_read_unlock();\n\treturn dss;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs4_ds_server *\nnfs4_find_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tdss = NULL;\nout:\n\trcu_read_unlock();\n\treturn dss;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct rpc_clnt *\nnfs4_find_or_create_ds_client(struct nfs_client *ds_clp, struct inode *inode)\n{\n\tstruct nfs4_ds_server *dss, *new;\n\trpc_authflavor_t flavor = NFS_SERVER(inode)->client->cl_auth->au_flavor;\n\n\tdss = nfs4_find_ds_client(ds_clp, flavor);\n\tif (dss != NULL)\n\t\tgoto out;\n\tnew = nfs4_alloc_ds_server(ds_clp, flavor);\n\tif (IS_ERR(new))\n\t\treturn ERR_CAST(new);\n\tdss = nfs4_add_ds_client(ds_clp, flavor, new);\n\tif (dss != new)\n\t\tnfs4_free_ds_server(new);\nout:\n\treturn dss->rpc_clnt;\n}"
  },
  {
    "function_name": "nfs4_free_ds_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "113-118",
    "snippet": "static void\nnfs4_free_ds_server(struct nfs4_ds_server *dss)\n{\n\trpc_release_client(dss->rpc_clnt);\n\tkfree(dss);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dss"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_release_client",
          "args": [
            "dss->rpc_clnt"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic void\nnfs4_free_ds_server(struct nfs4_ds_server *dss)\n{\n\trpc_release_client(dss->rpc_clnt);\n\tkfree(dss);\n}"
  },
  {
    "function_name": "nfs4_alloc_ds_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "93-111",
    "snippet": "static struct nfs4_ds_server *\nnfs4_alloc_ds_server(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tdss = kmalloc(sizeof(*dss), GFP_NOFS);\n\tif (dss == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tdss->rpc_clnt = rpc_clone_client_set_auth(ds_clp->cl_rpcclient, flavor);\n\tif (IS_ERR(dss->rpc_clnt)) {\n\t\tint err = PTR_ERR(dss->rpc_clnt);\n\t\tkfree (dss);\n\t\treturn ERR_PTR(err);\n\t}\n\tINIT_LIST_HEAD(&dss->list);\n\n\treturn dss;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dss->list"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dss"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "dss->rpc_clnt"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "dss->rpc_clnt"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_clone_client_set_auth",
          "args": [
            "ds_clp->cl_rpcclient",
            "flavor"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*dss)",
            "GFP_NOFS"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs4_ds_server *\nnfs4_alloc_ds_server(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tdss = kmalloc(sizeof(*dss), GFP_NOFS);\n\tif (dss == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tdss->rpc_clnt = rpc_clone_client_set_auth(ds_clp->cl_rpcclient, flavor);\n\tif (IS_ERR(dss->rpc_clnt)) {\n\t\tint err = PTR_ERR(dss->rpc_clnt);\n\t\tkfree (dss);\n\t\treturn ERR_PTR(err);\n\t}\n\tINIT_LIST_HEAD(&dss->list);\n\n\treturn dss;\n}"
  },
  {
    "function_name": "nfs4_add_ds_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "73-91",
    "snippet": "static struct nfs4_ds_server *\nnfs4_add_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor,\n\t\t\t   struct nfs4_ds_server *new)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tspin_lock(&ds_clp->cl_lock);\n\tlist_for_each_entry(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tif (new)\n\t\tlist_add_rcu(&new->list, &ds_clp->cl_ds_clients);\n\tdss = new;\nout:\n\tspin_unlock(&ds_clp->cl_lock); /* need some lock to protect list */\n\treturn dss;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ds_clp->cl_lock"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_rcu",
          "args": [
            "&new->list",
            "&ds_clp->cl_ds_clients"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "dss",
            "&ds_clp->cl_ds_clients",
            "list"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ds_clp->cl_lock"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs4_ds_server *\nnfs4_add_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor,\n\t\t\t   struct nfs4_ds_server *new)\n{\n\tstruct nfs4_ds_server *dss;\n\n\tspin_lock(&ds_clp->cl_lock);\n\tlist_for_each_entry(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tif (new)\n\t\tlist_add_rcu(&new->list, &ds_clp->cl_ds_clients);\n\tdss = new;\nout:\n\tspin_unlock(&ds_clp->cl_lock); /* need some lock to protect list */\n\treturn dss;\n}"
  },
  {
    "function_name": "nfs4_find_ds_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "56-71",
    "snippet": "static struct nfs4_ds_server *\nnfs4_find_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tdss = NULL;\nout:\n\trcu_read_unlock();\n\treturn dss;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "dss",
            "&ds_clp->cl_ds_clients",
            "list"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic struct nfs4_ds_server *\nnfs4_find_ds_client(struct nfs_client *ds_clp, rpc_authflavor_t flavor)\n{\n\tstruct nfs4_ds_server *dss;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(dss, &ds_clp->cl_ds_clients, list) {\n\t\tif (dss->rpc_clnt->cl_auth->au_flavor != flavor)\n\t\t\tcontinue;\n\t\tgoto out;\n\t}\n\tdss = NULL;\nout:\n\trcu_read_unlock();\n\treturn dss;\n}"
  },
  {
    "function_name": "nfs_get_cb_ident_idr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
    "lines": "27-42",
    "snippet": "static int nfs_get_cb_ident_idr(struct nfs_client *clp, int minorversion)\n{\n\tint ret = 0;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (clp->rpc_ops->version != 4 || minorversion != 0)\n\t\treturn ret;\n\tidr_preload(GFP_KERNEL);\n\tspin_lock(&nn->nfs_client_lock);\n\tret = idr_alloc(&nn->cb_ident_idr, clp, 0, 0, GFP_NOWAIT);\n\tif (ret >= 0)\n\t\tclp->cl_cb_ident = ret;\n\tspin_unlock(&nn->nfs_client_lock);\n\tidr_preload_end();\n\treturn ret < 0 ? ret : 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"internal.h\"",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/xprt.h>",
      "#include <linux/sunrpc/auth.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "idr_preload_end",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "idr_alloc",
          "args": [
            "&nn->cb_ident_idr",
            "clp",
            "0",
            "0",
            "GFP_NOWAIT"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "idr_preload",
          "args": [
            "GFP_KERNEL"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "clp->cl_net",
            "nfs_net_id"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstatic int nfs_get_cb_ident_idr(struct nfs_client *clp, int minorversion)\n{\n\tint ret = 0;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (clp->rpc_ops->version != 4 || minorversion != 0)\n\t\treturn ret;\n\tidr_preload(GFP_KERNEL);\n\tspin_lock(&nn->nfs_client_lock);\n\tret = idr_alloc(&nn->cb_ident_idr, clp, 0, 0, GFP_NOWAIT);\n\tif (ret >= 0)\n\t\tclp->cl_cb_ident = ret;\n\tspin_unlock(&nn->nfs_client_lock);\n\tidr_preload_end();\n\treturn ret < 0 ? ret : 0;\n}"
  }
]