[
  {
    "function_name": "pcmcia_check_cis_quirks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pcmcia/pcmcia_cis_quirks.c",
    "lines": "127-201",
    "snippet": "void pcmcia_check_cis_quirks(sc)\n\tstruct pcmcia_softc *sc;\n{\n\tint wiped = 0;\n\tint i, j;\n\tstruct pcmcia_function *pf, *pf_next, *pf_last;\n\tstruct pcmcia_config_entry *cfe, *cfe_next;\n\n\tpf = NULL;\n\tpf_last = NULL;\n\n\t\n\tfor (i = 0; i < sizeof(pcmcia_cis_quirks)/sizeof(pcmcia_cis_quirks[0]);\n\t    i++) {\n\t\tif ((sc->card.manufacturer == pcmcia_cis_quirks[i].manufacturer) &&\n\t\t\t(sc->card.product == pcmcia_cis_quirks[i].product) &&\n\t\t\t(((sc->card.manufacturer != PCMCIA_VENDOR_INVALID) &&\n\t\t\t  (sc->card.product != PCMCIA_PRODUCT_INVALID)) ||\n\t\t\t ((sc->card.manufacturer == PCMCIA_VENDOR_INVALID) &&\n\t\t\t  (sc->card.product == PCMCIA_PRODUCT_INVALID) &&\n\t\t\t  sc->card.cis1_info[0] &&\n\t\t\t  (strcmp(sc->card.cis1_info[0],\n\t\t\t\t\t  pcmcia_cis_quirks[i].cis1_info[0]) == 0) &&\n\t\t\t  sc->card.cis1_info[1] &&\n\t\t\t  (strcmp(sc->card.cis1_info[1],\n\t\t\t\t\t  pcmcia_cis_quirks[i].cis1_info[1]) == 0)))) {\n\t\t\tif (!wiped) {\n\t\t\t\tif (pcmcia_verbose) {\n\t\t\t\t\tprintf(\"%s: using CIS quirks for \", sc->dev.dv_xname);\n\t\t\t\t\tfor (j = 0; j < 4; j++) {\n\t\t\t\t\t\tif (sc->card.cis1_info[j] == NULL)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tif (j)\n\t\t\t\t\t\t\tprintf(\", \");\n\t\t\t\t\t\tprintf(\"%s\", sc->card.cis1_info[j]);\n\t\t\t\t\t}\n\t\t\t\t\tprintf(\"\\n\");\n\t\t\t\t}\n\n\t\t\t\tfor (pf = SIMPLEQ_FIRST(&sc->card.pf_head); pf != NULL;\n\t\t\t\t     pf = pf_next) {\n\t\t\t\t\tfor (cfe = SIMPLEQ_FIRST(&pf->cfe_head); cfe != NULL;\n\t\t\t\t\t     cfe = cfe_next) {\n\t\t\t\t\t\tcfe_next = SIMPLEQ_NEXT(cfe, cfe_list);\n\t\t\t\t\t\tfree(cfe, M_DEVBUF);\n\t\t\t\t\t}\n\t\t\t\t\tpf_next = SIMPLEQ_NEXT(pf, pf_list);\n\t\t\t\t\tfree(pf, M_DEVBUF);\n\t\t\t\t}\n\n\t\t\t\tSIMPLEQ_INIT(&sc->card.pf_head);\n\t\t\t\twiped = 1;\n\t\t\t}\n\n\t\t\tif (pf_last == pcmcia_cis_quirks[i].pf) {\n\t\t\t\tcfe = malloc(sizeof(*cfe), M_DEVBUF, M_NOWAIT);\n\t\t\t\t*cfe = *pcmcia_cis_quirks[i].cfe;\n\n\t\t\t\tSIMPLEQ_INSERT_TAIL(&pf->cfe_head, cfe, cfe_list);\n\t\t\t} else {\n\t\t\t\tpf = malloc(sizeof(*pf), M_DEVBUF, M_NOWAIT);\n\t\t\t\t*pf = *pcmcia_cis_quirks[i].pf;\n\t\t\t\tSIMPLEQ_INIT(&pf->cfe_head);\n\n\t\t\t\tcfe = malloc(sizeof(*cfe), M_DEVBUF, M_NOWAIT);\n\t\t\t\t*cfe = *pcmcia_cis_quirks[i].cfe;\n\n\t\t\t\tSIMPLEQ_INSERT_TAIL(&pf->cfe_head, cfe, cfe_list);\n\t\t\t\tSIMPLEQ_INSERT_TAIL(&sc->card.pf_head, pf, pf_list);\n\n\t\t\t\tpf_last = pcmcia_cis_quirks[i].pf;\n\t\t\t}\n\t\t}\n\t}\n}",
    "includes": [
      "#include <dev/pcmcia/pcmciavar.h>",
      "#include <dev/pcmcia/pcmciachip.h>",
      "#include <dev/pcmcia/pcmciareg.h>",
      "#include <dev/pcmcia/pcmciadevs.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pcmcia_cis_quirk pcmcia_cis_quirks[] = {\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556, PCMCIA_CIS_INVALID, \n\t  &pcmcia_3cxem556_func0, &pcmcia_3cxem556_func0_cfe0 },\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556, PCMCIA_CIS_INVALID,\n\t  &pcmcia_3cxem556_func1, &pcmcia_3cxem556_func1_cfe0 },\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556B, PCMCIA_CIS_INVALID,\n\t  &pcmcia_3cxem556_func0, &pcmcia_3cxem556_func0_cfe0 },\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556B, PCMCIA_CIS_INVALID,\n\t  &pcmcia_3cxem556_func1, &pcmcia_3cxem556_func1_cfe0 },\n\t{ PCMCIA_VENDOR_INVALID, PCMCIA_PRODUCT_INVALID, PCMCIA_CIS_SVEC_LANCARD,\n\t  &pcmcia_sveclancard_func0, &pcmcia_sveclancard_func0_cfe0 },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SIMPLEQ_INSERT_TAIL",
          "args": [
            "&sc->card.pf_head",
            "pf",
            "pf_list"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_INSERT_TAIL",
          "args": [
            "&pf->cfe_head",
            "cfe",
            "cfe_list"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*cfe)",
            "M_DEVBUF",
            "M_NOWAIT"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_INIT",
          "args": [
            "&pf->cfe_head"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_INSERT_TAIL",
          "args": [
            "&pf->cfe_head",
            "cfe",
            "cfe_list"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_INIT",
          "args": [
            "&sc->card.pf_head"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "pf",
            "M_DEVBUF"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "ray_free_ccs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pcmcia/if_ray.c",
          "lines": "2156-2172",
          "snippet": "u_int8_t\nray_free_ccs(sc, ccs)\n\tstruct ray_softc *sc;\n\tbus_size_t ccs;\n{\n\tu_int8_t stat;\n\n\tRAY_DPRINTF((\"%s: free_ccs idx %ld\\n\", sc->sc_xname,\n\t    RAY_GET_INDEX(ccs)));\n\n\tstat = SRAM_READ_FIELD_1(sc, ccs, ray_cmd, c_status);\n\tSRAM_WRITE_FIELD_1(sc, ccs, ray_cmd, c_status, RAY_CCS_STATUS_FREE);\n\tif (ccs <= RAY_GET_CCS(RAY_CCS_LAST))\n\t\tsc->sc_ccsinuse[RAY_GET_INDEX(ccs)] = 0;\n\n\treturn (stat);\n}",
          "includes": [
            "#include <dev/pcmcia/if_rayreg.h>",
            "#include <dev/pcmcia/pcmciadevs.h>",
            "#include <dev/pcmcia/pcmciavar.h>",
            "#include <dev/pcmcia/pcmciareg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <net/if_ieee80211.h>\t/* here, since ETHER_ADDR_LEN is in netinet */",
            "#include <netinet/if_ether.h>",
            "#include <netinet/if_inarp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_llc.h>",
            "#include <net/if_media.h>",
            "#include <net/if_ether.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/device.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/timeout.h>",
            "#include <sys/callout.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\"",
            "#include \"opt_inet.h\""
          ],
          "macros_used": [
            "#define\tsc_xname\tsc_dev.dv_xname"
          ],
          "globals_used": [
            "u_int8_t ray_free_ccs"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pcmcia/if_rayreg.h>\n#include <dev/pcmcia/pcmciadevs.h>\n#include <dev/pcmcia/pcmciavar.h>\n#include <dev/pcmcia/pcmciareg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <net/if_ieee80211.h>\t/* here, since ETHER_ADDR_LEN is in netinet */\n#include <netinet/if_ether.h>\n#include <netinet/if_inarp.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_llc.h>\n#include <net/if_media.h>\n#include <net/if_ether.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/timeout.h>\n#include <sys/callout.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n#include \"opt_inet.h\"\n\n#define\tsc_xname\tsc_dev.dv_xname\n\nu_int8_t ray_free_ccs;\n\nu_int8_t\nray_free_ccs(sc, ccs)\n\tstruct ray_softc *sc;\n\tbus_size_t ccs;\n{\n\tu_int8_t stat;\n\n\tRAY_DPRINTF((\"%s: free_ccs idx %ld\\n\", sc->sc_xname,\n\t    RAY_GET_INDEX(ccs)));\n\n\tstat = SRAM_READ_FIELD_1(sc, ccs, ray_cmd, c_status);\n\tSRAM_WRITE_FIELD_1(sc, ccs, ray_cmd, c_status, RAY_CCS_STATUS_FREE);\n\tif (ccs <= RAY_GET_CCS(RAY_CCS_LAST))\n\t\tsc->sc_ccsinuse[RAY_GET_INDEX(ccs)] = 0;\n\n\treturn (stat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_NEXT",
          "args": [
            "pf",
            "pf_list"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_NEXT",
          "args": [
            "cfe",
            "cfe_list"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_FIRST",
          "args": [
            "&pf->cfe_head"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIMPLEQ_FIRST",
          "args": [
            "&sc->card.pf_head"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "sc->card.cis1_info[1]",
            "pcmcia_cis_quirks[i].cis1_info[1]"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "sc->card.cis1_info[0]",
            "pcmcia_cis_quirks[i].cis1_info[0]"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pcmcia/pcmciavar.h>\n#include <dev/pcmcia/pcmciachip.h>\n#include <dev/pcmcia/pcmciareg.h>\n#include <dev/pcmcia/pcmciadevs.h>\n#include <sys/mbuf.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic struct pcmcia_cis_quirk pcmcia_cis_quirks[] = {\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556, PCMCIA_CIS_INVALID, \n\t  &pcmcia_3cxem556_func0, &pcmcia_3cxem556_func0_cfe0 },\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556, PCMCIA_CIS_INVALID,\n\t  &pcmcia_3cxem556_func1, &pcmcia_3cxem556_func1_cfe0 },\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556B, PCMCIA_CIS_INVALID,\n\t  &pcmcia_3cxem556_func0, &pcmcia_3cxem556_func0_cfe0 },\n\t{ PCMCIA_VENDOR_3COM, PCMCIA_PRODUCT_3COM_3CXEM556B, PCMCIA_CIS_INVALID,\n\t  &pcmcia_3cxem556_func1, &pcmcia_3cxem556_func1_cfe0 },\n\t{ PCMCIA_VENDOR_INVALID, PCMCIA_PRODUCT_INVALID, PCMCIA_CIS_SVEC_LANCARD,\n\t  &pcmcia_sveclancard_func0, &pcmcia_sveclancard_func0_cfe0 },\n};\n\nvoid pcmcia_check_cis_quirks(sc)\n\tstruct pcmcia_softc *sc;\n{\n\tint wiped = 0;\n\tint i, j;\n\tstruct pcmcia_function *pf, *pf_next, *pf_last;\n\tstruct pcmcia_config_entry *cfe, *cfe_next;\n\n\tpf = NULL;\n\tpf_last = NULL;\n\n\t\n\tfor (i = 0; i < sizeof(pcmcia_cis_quirks)/sizeof(pcmcia_cis_quirks[0]);\n\t    i++) {\n\t\tif ((sc->card.manufacturer == pcmcia_cis_quirks[i].manufacturer) &&\n\t\t\t(sc->card.product == pcmcia_cis_quirks[i].product) &&\n\t\t\t(((sc->card.manufacturer != PCMCIA_VENDOR_INVALID) &&\n\t\t\t  (sc->card.product != PCMCIA_PRODUCT_INVALID)) ||\n\t\t\t ((sc->card.manufacturer == PCMCIA_VENDOR_INVALID) &&\n\t\t\t  (sc->card.product == PCMCIA_PRODUCT_INVALID) &&\n\t\t\t  sc->card.cis1_info[0] &&\n\t\t\t  (strcmp(sc->card.cis1_info[0],\n\t\t\t\t\t  pcmcia_cis_quirks[i].cis1_info[0]) == 0) &&\n\t\t\t  sc->card.cis1_info[1] &&\n\t\t\t  (strcmp(sc->card.cis1_info[1],\n\t\t\t\t\t  pcmcia_cis_quirks[i].cis1_info[1]) == 0)))) {\n\t\t\tif (!wiped) {\n\t\t\t\tif (pcmcia_verbose) {\n\t\t\t\t\tprintf(\"%s: using CIS quirks for \", sc->dev.dv_xname);\n\t\t\t\t\tfor (j = 0; j < 4; j++) {\n\t\t\t\t\t\tif (sc->card.cis1_info[j] == NULL)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tif (j)\n\t\t\t\t\t\t\tprintf(\", \");\n\t\t\t\t\t\tprintf(\"%s\", sc->card.cis1_info[j]);\n\t\t\t\t\t}\n\t\t\t\t\tprintf(\"\\n\");\n\t\t\t\t}\n\n\t\t\t\tfor (pf = SIMPLEQ_FIRST(&sc->card.pf_head); pf != NULL;\n\t\t\t\t     pf = pf_next) {\n\t\t\t\t\tfor (cfe = SIMPLEQ_FIRST(&pf->cfe_head); cfe != NULL;\n\t\t\t\t\t     cfe = cfe_next) {\n\t\t\t\t\t\tcfe_next = SIMPLEQ_NEXT(cfe, cfe_list);\n\t\t\t\t\t\tfree(cfe, M_DEVBUF);\n\t\t\t\t\t}\n\t\t\t\t\tpf_next = SIMPLEQ_NEXT(pf, pf_list);\n\t\t\t\t\tfree(pf, M_DEVBUF);\n\t\t\t\t}\n\n\t\t\t\tSIMPLEQ_INIT(&sc->card.pf_head);\n\t\t\t\twiped = 1;\n\t\t\t}\n\n\t\t\tif (pf_last == pcmcia_cis_quirks[i].pf) {\n\t\t\t\tcfe = malloc(sizeof(*cfe), M_DEVBUF, M_NOWAIT);\n\t\t\t\t*cfe = *pcmcia_cis_quirks[i].cfe;\n\n\t\t\t\tSIMPLEQ_INSERT_TAIL(&pf->cfe_head, cfe, cfe_list);\n\t\t\t} else {\n\t\t\t\tpf = malloc(sizeof(*pf), M_DEVBUF, M_NOWAIT);\n\t\t\t\t*pf = *pcmcia_cis_quirks[i].pf;\n\t\t\t\tSIMPLEQ_INIT(&pf->cfe_head);\n\n\t\t\t\tcfe = malloc(sizeof(*cfe), M_DEVBUF, M_NOWAIT);\n\t\t\t\t*cfe = *pcmcia_cis_quirks[i].cfe;\n\n\t\t\t\tSIMPLEQ_INSERT_TAIL(&pf->cfe_head, cfe, cfe_list);\n\t\t\t\tSIMPLEQ_INSERT_TAIL(&sc->card.pf_head, pf, pf_list);\n\n\t\t\t\tpf_last = pcmcia_cis_quirks[i].pf;\n\t\t\t}\n\t\t}\n\t}\n}"
  }
]