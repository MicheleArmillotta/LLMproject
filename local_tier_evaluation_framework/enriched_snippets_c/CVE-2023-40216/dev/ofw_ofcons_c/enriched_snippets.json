[
  {
    "function_name": "ofccnpollc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "340-359",
    "snippet": "void\nofccnpollc(dev, on)\n\tdev_t dev;\n\tint on;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\t\n\tif (!sc)\n\t\treturn;\n\tif (on) {\n\t\tif (sc->of_flags & OFPOLL)\n\t\t\tuntimeout(ofcpoll, sc);\n\t\tsc->of_flags &= ~OFPOLL;\n\t} else {\n\t\tif (!(sc->of_flags & OFPOLL)) {\n\t\t\tsc->of_flags |= OFPOLL;\n\t\t\ttimeout(ofcpoll, sc, 1);\n\t\t}\n\t}\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tOFPOLL\t\t1"
    ],
    "globals_used": [
      "struct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};",
      "static void ofcpoll",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "ofcpoll",
            "sc",
            "1"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "midi_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "478-486",
          "snippet": "void\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "untimeout",
          "args": [
            "ofcpoll",
            "sc"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\n#define\tOFPOLL\t\t1\n\nstruct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};\nstatic void ofcpoll;\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nvoid\nofccnpollc(dev, on)\n\tdev_t dev;\n\tint on;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\t\n\tif (!sc)\n\t\treturn;\n\tif (on) {\n\t\tif (sc->of_flags & OFPOLL)\n\t\t\tuntimeout(ofcpoll, sc);\n\t\tsc->of_flags &= ~OFPOLL;\n\t} else {\n\t\tif (!(sc->of_flags & OFPOLL)) {\n\t\t\tsc->of_flags |= OFPOLL;\n\t\t\ttimeout(ofcpoll, sc, 1);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "ofccnputc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "324-338",
    "snippet": "void\nofccnputc(dev, c)\n\tdev_t dev;\n\tint c;\n{\n\tchar ch = c;\n\t\n/*#ifdef DEBUG */\n#if 1\n\tif (stdout == 0) {\n\t\tofcprobe();\n\t}\n#endif\n\tOF_write(stdout, &ch, 1);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stdout = 0;",
      "static int ofcprobe",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "OF_write",
          "args": [
            "stdout",
            "&ch",
            "1"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ofcprobe",
          "args": [],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "ofcprobe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
          "lines": "274-287",
          "snippet": "static int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <dev/ofw/openfirm.h>",
            "#include <dev/cons.h>",
            "#include <sys/tty.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stdin  = 0;",
            "static int stdout = 0;",
            "static int ofcprobe"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdin  = 0;\nstatic int stdout = 0;\nstatic int ofcprobe;\n\nstatic int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdout = 0;\nstatic int ofcprobe;\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nvoid\nofccnputc(dev, c)\n\tdev_t dev;\n\tint c;\n{\n\tchar ch = c;\n\t\n/*#ifdef DEBUG */\n#if 1\n\tif (stdout == 0) {\n\t\tofcprobe();\n\t}\n#endif\n\tOF_write(stdout, &ch, 1);\n}"
  },
  {
    "function_name": "ofccngetc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "311-322",
    "snippet": "int\nofccngetc(dev)\n\tdev_t dev;\n{\n\tunsigned char ch;\n\tint l;\n\t\n\twhile ((l = OF_read(stdin, &ch, 1)) != 1)\n\t\tif (l != -2)\n\t\t\treturn -1;\n\treturn ch;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stdin  = 0;",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "OF_read",
          "args": [
            "stdin",
            "&ch",
            "1"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdin  = 0;\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nint\nofccngetc(dev)\n\tdev_t dev;\n{\n\tunsigned char ch;\n\tint l;\n\t\n\twhile ((l = OF_read(stdin, &ch, 1)) != 1)\n\t\tif (l != -2)\n\t\t\treturn -1;\n\treturn ch;\n}"
  },
  {
    "function_name": "ofccninit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "305-309",
    "snippet": "void\nofccninit(cd)\n\tstruct consdev *cd;\n{\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nvoid\nofccninit(cd)\n\tstruct consdev *cd;\n{\n}"
  },
  {
    "function_name": "ofccnprobe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "289-303",
    "snippet": "void\nofccnprobe(cd)\n\tstruct consdev *cd;\n{\n\tint maj;\n\n\tif (!ofcprobe())\n\t\treturn;\n\n\tfor (maj = 0; maj < nchrdev; maj++)\n\t\tif (cdevsw[maj].d_open == ofcopen)\n\t\t\tbreak;\n\tcd->cn_dev = makedev(maj, 0);\n\tcd->cn_pri = CN_INTERNAL;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int ofcprobe"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "makedev",
          "args": [
            "maj",
            "0"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ofcprobe",
          "args": [],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "ofcprobe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
          "lines": "274-287",
          "snippet": "static int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <dev/ofw/openfirm.h>",
            "#include <dev/cons.h>",
            "#include <sys/tty.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stdin  = 0;",
            "static int stdout = 0;",
            "static int ofcprobe"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdin  = 0;\nstatic int stdout = 0;\nstatic int ofcprobe;\n\nstatic int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int ofcprobe;\n\nvoid\nofccnprobe(cd)\n\tstruct consdev *cd;\n{\n\tint maj;\n\n\tif (!ofcprobe())\n\t\treturn;\n\n\tfor (maj = 0; maj < nchrdev; maj++)\n\t\tif (cdevsw[maj].d_open == ofcopen)\n\t\t\tbreak;\n\tcd->cn_dev = makedev(maj, 0);\n\tcd->cn_pri = CN_INTERNAL;\n}"
  },
  {
    "function_name": "ofcprobe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "274-287",
    "snippet": "static int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stdin  = 0;",
      "static int stdout = 0;",
      "static int ofcprobe"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "OF_getprop",
          "args": [
            "chosen",
            "\"stdout\"",
            "&stdout",
            "sizeof stdout"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_getprop",
          "args": [
            "chosen",
            "\"stdin\"",
            "&stdin",
            "sizeof stdin"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_finddevice",
          "args": [
            "\"/chosen\""
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdin  = 0;\nstatic int stdout = 0;\nstatic int ofcprobe;\n\nstatic int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "ofcpoll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "259-272",
    "snippet": "static void\nofcpoll(aux)\n\tvoid *aux;\n{\n\tstruct ofc_softc *sc = aux;\n\tstruct tty *tp = sc->of_tty;\n\tchar ch;\n\t\n\twhile (OF_read(stdin, &ch, 1) > 0) {\n\t\tif (tp && (tp->t_state & TS_ISOPEN))\n\t\t\t(*linesw[tp->t_line].l_rint)(ch, tp);\n\t}\n\ttimeout(ofcpoll, sc, 1);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stdin  = 0;",
      "static void ofcpoll"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "ofcpoll",
            "sc",
            "1"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "midi_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "478-486",
          "snippet": "void\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "ch",
            "tp"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_read",
          "args": [
            "stdin",
            "&ch",
            "1"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdin  = 0;\nstatic void ofcpoll;\n\nstatic void\nofcpoll(aux)\n\tvoid *aux;\n{\n\tstruct ofc_softc *sc = aux;\n\tstruct tty *tp = sc->of_tty;\n\tchar ch;\n\t\n\twhile (OF_read(stdin, &ch, 1) > 0) {\n\t\tif (tp && (tp->t_state & TS_ISOPEN))\n\t\t\t(*linesw[tp->t_line].l_rint)(ch, tp);\n\t}\n\ttimeout(ofcpoll, sc, 1);\n}"
  },
  {
    "function_name": "ofcparam",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "248-257",
    "snippet": "static int\nofcparam(tp, t)\n\tstruct tty *tp;\n\tstruct termios *t;\n{\n\ttp->t_ispeed = t->c_ispeed;\n\ttp->t_ospeed = t->c_ospeed;\n\ttp->t_cflag = t->c_cflag;\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int ofcparam"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int ofcparam;\n\nstatic int\nofcparam(tp, t)\n\tstruct tty *tp;\n\tstruct termios *t;\n{\n\ttp->t_ispeed = t->c_ispeed;\n\ttp->t_ospeed = t->c_ospeed;\n\ttp->t_cflag = t->c_cflag;\n\treturn 0;\n}"
  },
  {
    "function_name": "ofcstart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "214-246",
    "snippet": "static void\nofcstart(tp)\n\tstruct tty *tp;\n{\n\tstruct clist *cl;\n\tint s, len;\n\tu_char buf[OFBURSTLEN];\n\t\n\ts = spltty();\n\tif (tp->t_state & (TS_TIMEOUT | TS_BUSY | TS_TTSTOP)) {\n\t\tsplx(s);\n\t\treturn;\n\t}\n\ttp->t_state |= TS_BUSY;\n\tsplx(s);\n\tcl = &tp->t_outq;\n\tlen = q_to_b(cl, buf, OFBURSTLEN);\n\tOF_write(stdout, buf, len);\n\ts = spltty();\n\ttp->t_state &= ~TS_BUSY;\n\tif (cl->c_cc) {\n\t\ttp->t_state |= TS_TIMEOUT;\n\t\ttimeout(ttrstrt, (void *)tp, 1);\n\t}\n\tif (cl->c_cc <= tp->t_lowat) {\n\t\tif (tp->t_state & TS_ASLEEP) {\n\t\t\ttp->t_state &= ~TS_ASLEEP;\n\t\t\twakeup(cl);\n\t\t}\n\t\tselwakeup(&tp->t_wsel);\n\t}\n\tsplx(s);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tOFBURSTLEN\t128\t/* max number of bytes to write in one chunk */"
    ],
    "globals_used": [
      "static int stdout = 0;",
      "static void ofcstart"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selwakeup",
          "args": [
            "&tp->t_wsel"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wakeup",
          "args": [
            "cl"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "audio_wakeup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "765-774",
          "snippet": "static __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nstatic __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "ttrstrt",
            "(void *)tp",
            "1"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "midi_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "478-486",
          "snippet": "void\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spltty",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_write",
          "args": [
            "stdout",
            "buf",
            "len"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "q_to_b",
          "args": [
            "cl",
            "buf",
            "OFBURSTLEN"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spltty",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\n#define\tOFBURSTLEN\t128\t/* max number of bytes to write in one chunk */\n\nstatic int stdout = 0;\nstatic void ofcstart;\n\nstatic void\nofcstart(tp)\n\tstruct tty *tp;\n{\n\tstruct clist *cl;\n\tint s, len;\n\tu_char buf[OFBURSTLEN];\n\t\n\ts = spltty();\n\tif (tp->t_state & (TS_TIMEOUT | TS_BUSY | TS_TTSTOP)) {\n\t\tsplx(s);\n\t\treturn;\n\t}\n\ttp->t_state |= TS_BUSY;\n\tsplx(s);\n\tcl = &tp->t_outq;\n\tlen = q_to_b(cl, buf, OFBURSTLEN);\n\tOF_write(stdout, buf, len);\n\ts = spltty();\n\ttp->t_state &= ~TS_BUSY;\n\tif (cl->c_cc) {\n\t\ttp->t_state |= TS_TIMEOUT;\n\t\ttimeout(ttrstrt, (void *)tp, 1);\n\t}\n\tif (cl->c_cc <= tp->t_lowat) {\n\t\tif (tp->t_state & TS_ASLEEP) {\n\t\t\ttp->t_state &= ~TS_ASLEEP;\n\t\t\twakeup(cl);\n\t\t}\n\t\tselwakeup(&tp->t_wsel);\n\t}\n\tsplx(s);\n}"
  },
  {
    "function_name": "ofcstop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "207-212",
    "snippet": "void\nofcstop(tp, flag)\n\tstruct tty *tp;\n\tint flag;\n{\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nvoid\nofcstop(tp, flag)\n\tstruct tty *tp;\n\tint flag;\n{\n}"
  },
  {
    "function_name": "ofcioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "179-196",
    "snippet": "int\nofcioctl(dev, cmd, data, flag, p)\n\tdev_t dev;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\tint error;\n\t\n\tif ((error = (*linesw[tp->t_line].l_ioctl)(tp, cmd, data, flag, p)) >= 0)\n\t\treturn error;\n\tif ((error = ttioctl(tp, cmd, data, flag, p)) >= 0)\n\t\treturn error;\n\treturn ENOTTY;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ttioctl",
          "args": [
            "tp",
            "cmd",
            "data",
            "flag",
            "p"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tp",
            "cmd",
            "data",
            "flag",
            "p"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstruct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nint\nofcioctl(dev, cmd, data, flag, p)\n\tdev_t dev;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\tint error;\n\t\n\tif ((error = (*linesw[tp->t_line].l_ioctl)(tp, cmd, data, flag, p)) >= 0)\n\t\treturn error;\n\tif ((error = ttioctl(tp, cmd, data, flag, p)) >= 0)\n\t\treturn error;\n\treturn ENOTTY;\n}"
  },
  {
    "function_name": "ofcwrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "167-177",
    "snippet": "int\nofcwrite(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\t\n\treturn (*linesw[tp->t_line].l_write)(tp, uio, flag);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "tp",
            "uio",
            "flag"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstruct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nint\nofcwrite(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\t\n\treturn (*linesw[tp->t_line].l_write)(tp, uio, flag);\n}"
  },
  {
    "function_name": "ofcread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "155-165",
    "snippet": "int\nofcread(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\t\n\treturn (*linesw[tp->t_line].l_read)(tp, uio, flag);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "tp",
            "uio",
            "flag"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstruct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nint\nofcread(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\t\n\treturn (*linesw[tp->t_line].l_read)(tp, uio, flag);\n}"
  },
  {
    "function_name": "ofcclose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "139-153",
    "snippet": "int\nofcclose(dev, flag, mode, p)\n\tdev_t dev;\n\tint flag, mode;\n\tstruct proc *p;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\n\tuntimeout(ofcpoll, sc);\n\tsc->of_flags &= ~OFPOLL;\n\t(*linesw[tp->t_line].l_close)(tp, flag);\n\tttyclose(tp);\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tOFPOLL\t\t1"
    ],
    "globals_used": [
      "struct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};",
      "static void ofcpoll",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ttyclose",
          "args": [
            "tp"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tp",
            "flag"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "untimeout",
          "args": [
            "ofcpoll",
            "sc"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\n#define\tOFPOLL\t\t1\n\nstruct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};\nstatic void ofcpoll;\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nint\nofcclose(dev, flag, mode, p)\n\tdev_t dev;\n\tint flag, mode;\n\tstruct proc *p;\n{\n\tstruct ofc_softc *sc = ofcons_cd.cd_devs[minor(dev)];\n\tstruct tty *tp = sc->of_tty;\n\n\tuntimeout(ofcpoll, sc);\n\tsc->of_flags &= ~OFPOLL;\n\t(*linesw[tp->t_line].l_close)(tp, flag);\n\tttyclose(tp);\n\treturn 0;\n}"
  },
  {
    "function_name": "ofcopen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "97-137",
    "snippet": "int\nofcopen(dev, flag, mode, p)\n\tdev_t dev;\n\tint flag, mode;\n\tstruct proc *p;\n{\n\tstruct ofc_softc *sc;\n\tint unit = minor(dev);\n\tstruct tty *tp;\n\t\n\tif (unit >= ofcons_cd.cd_ndevs)\n\t\treturn ENXIO;\n\tsc = ofcons_cd.cd_devs[unit];\n\tif (!sc)\n\t\treturn ENXIO;\n\tif (!(tp = sc->of_tty))\n\t\tsc->of_tty = tp = ttymalloc();\n\ttp->t_oproc = ofcstart;\n\ttp->t_param = ofcparam;\n\ttp->t_dev = dev;\n\tif (!(tp->t_state & TS_ISOPEN)) {\n\t\ttp->t_state |= TS_WOPEN;\n\t\tttychars(tp);\n\t\ttp->t_iflag = TTYDEF_IFLAG;\n\t\ttp->t_oflag = TTYDEF_OFLAG;\n\t\ttp->t_cflag = TTYDEF_CFLAG;\n\t\ttp->t_lflag = TTYDEF_LFLAG;\n\t\ttp->t_ispeed = tp->t_ospeed = TTYDEF_SPEED;\n\t\tofcparam(tp, &tp->t_termios);\n\t\tttsetwater(tp);\n\t} else if ((tp->t_state&TS_XCLUDE) && suser(p->p_ucred, &p->p_acflag))\n\t\treturn EBUSY;\n\ttp->t_state |= TS_CARR_ON;\n\t\n\tif (!(sc->of_flags & OFPOLL)) {\n\t\tsc->of_flags |= OFPOLL;\n\t\ttimeout(ofcpoll, sc, 1);\n\t}\n\n\treturn (*linesw[tp->t_line].l_open)(dev, tp);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tOFPOLL\t\t1"
    ],
    "globals_used": [
      "struct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};",
      "static void ofcstart",
      "static int ofcparam",
      "static void ofcpoll",
      "struct tty *\nofctty(dev)\n\tdev_t dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "dev",
            "tp"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "ofcpoll",
            "sc",
            "1"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "midi_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "478-486",
          "snippet": "void\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "suser",
          "args": [
            "p->p_ucred",
            "&p->p_acflag"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ttsetwater",
          "args": [
            "tp"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ofcparam",
          "args": [
            "tp",
            "&tp->t_termios"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "ofcparam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
          "lines": "248-257",
          "snippet": "static int\nofcparam(tp, t)\n\tstruct tty *tp;\n\tstruct termios *t;\n{\n\ttp->t_ispeed = t->c_ispeed;\n\ttp->t_ospeed = t->c_ospeed;\n\ttp->t_cflag = t->c_cflag;\n\treturn 0;\n}",
          "includes": [
            "#include <dev/ofw/openfirm.h>",
            "#include <dev/cons.h>",
            "#include <sys/tty.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int ofcparam"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int ofcparam;\n\nstatic int\nofcparam(tp, t)\n\tstruct tty *tp;\n\tstruct termios *t;\n{\n\ttp->t_ispeed = t->c_ispeed;\n\ttp->t_ospeed = t->c_ospeed;\n\ttp->t_cflag = t->c_cflag;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ttychars",
          "args": [
            "tp"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ttymalloc",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\n#define\tOFPOLL\t\t1\n\nstruct cfdriver ofcons_cd = {\n\tNULL, \"ofcons\", DV_TTY\n};\nstatic void ofcstart;\nstatic int ofcparam;\nstatic void ofcpoll;\nstruct tty *\nofctty(dev)\n\tdev_t dev;\n\nint\nofcopen(dev, flag, mode, p)\n\tdev_t dev;\n\tint flag, mode;\n\tstruct proc *p;\n{\n\tstruct ofc_softc *sc;\n\tint unit = minor(dev);\n\tstruct tty *tp;\n\t\n\tif (unit >= ofcons_cd.cd_ndevs)\n\t\treturn ENXIO;\n\tsc = ofcons_cd.cd_devs[unit];\n\tif (!sc)\n\t\treturn ENXIO;\n\tif (!(tp = sc->of_tty))\n\t\tsc->of_tty = tp = ttymalloc();\n\ttp->t_oproc = ofcstart;\n\ttp->t_param = ofcparam;\n\ttp->t_dev = dev;\n\tif (!(tp->t_state & TS_ISOPEN)) {\n\t\ttp->t_state |= TS_WOPEN;\n\t\tttychars(tp);\n\t\ttp->t_iflag = TTYDEF_IFLAG;\n\t\ttp->t_oflag = TTYDEF_OFLAG;\n\t\ttp->t_cflag = TTYDEF_CFLAG;\n\t\ttp->t_lflag = TTYDEF_LFLAG;\n\t\ttp->t_ispeed = tp->t_ospeed = TTYDEF_SPEED;\n\t\tofcparam(tp, &tp->t_termios);\n\t\tttsetwater(tp);\n\t} else if ((tp->t_state&TS_XCLUDE) && suser(p->p_ucred, &p->p_acflag))\n\t\treturn EBUSY;\n\ttp->t_state |= TS_CARR_ON;\n\t\n\tif (!(sc->of_flags & OFPOLL)) {\n\t\tsc->of_flags |= OFPOLL;\n\t\ttimeout(ofcpoll, sc, 1);\n\t}\n\n\treturn (*linesw[tp->t_line].l_open)(dev, tp);\n}"
  },
  {
    "function_name": "ofcattach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "85-91",
    "snippet": "static void\nofcattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ofcattach"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic void ofcattach;\n\nstatic void\nofcattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "ofcmatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
    "lines": "72-83",
    "snippet": "static int\nofcmatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct ofprobe *ofp = aux;\n\t\n\tif (!ofcprobe())\n\t\treturn 0;\n\treturn OF_instance_to_package(stdin) == ofp->phandle\n\t\t|| OF_instance_to_package(stdout) == ofp->phandle;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <dev/cons.h>",
      "#include <sys/tty.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stdin  = 0;",
      "static int stdout = 0;",
      "static int ofcmatch",
      "static int ofcprobe"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "OF_instance_to_package",
          "args": [
            "stdout"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_instance_to_package",
          "args": [
            "stdin"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ofcprobe",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "ofcprobe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofcons.c",
          "lines": "274-287",
          "snippet": "static int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <dev/ofw/openfirm.h>",
            "#include <dev/cons.h>",
            "#include <sys/tty.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stdin  = 0;",
            "static int stdout = 0;",
            "static int ofcprobe"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdin  = 0;\nstatic int stdout = 0;\nstatic int ofcprobe;\n\nstatic int\nofcprobe()\n{\n\tint chosen;\n\n\tif (stdin)\n\t\treturn 1;\n\tif ((chosen = OF_finddevice(\"/chosen\")) == -1)\n\t\treturn 0;\n\tif (OF_getprop(chosen, \"stdin\", &stdin, sizeof stdin) != sizeof stdin\n\t    || OF_getprop(chosen, \"stdout\", &stdout, sizeof stdout) != sizeof stdout)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <dev/cons.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n\nstatic int stdin  = 0;\nstatic int stdout = 0;\nstatic int ofcmatch;\nstatic int ofcprobe;\n\nstatic int\nofcmatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct ofprobe *ofp = aux;\n\t\n\tif (!ofcprobe())\n\t\treturn 0;\n\treturn OF_instance_to_package(stdin) == ofp->phandle\n\t\t|| OF_instance_to_package(stdout) == ofp->phandle;\n}"
  }
]