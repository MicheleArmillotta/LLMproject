[
  {
    "function_name": "le_isa_intredge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_le.c",
    "lines": "107-117",
    "snippet": "int\nle_isa_intredge(arg)\n\tvoid *arg;\n{\n\n\tif (am7990_intr(arg) == 0)\n\t\treturn (0);\n\tfor (;;)\n\t\tif (am7990_intr(arg) == 0)\n\t\t\treturn (1);\n}",
    "includes": [
      "#include <dev/isa/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/intr.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"isadma.h\"",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "am7990_intr",
          "args": [
            "arg"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "am7990_intr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am7990.c",
          "lines": "663-729",
          "snippet": "int\nam7990_intr(arg)\n\tregister void *arg;\n{\n\tregister struct am7990_softc *sc = arg;\n\tregister u_int16_t isr;\n\n\tisr = (*sc->sc_rdcsr)(sc, LE_CSR0);\n#ifdef LEDEBUG\n\tif (sc->sc_debug){\n\t\tprintf(\"%s: am7990_intr entering with isr=%04x\\n\",\n\t\t    sc->sc_dev.dv_xname, isr);\n\t\tprintf(\" isr: 0x%b\\n\", isr, LE_C0_BITS);\n\t}\n#endif\n\tif ((isr & LE_C0_INTR) == 0)\n\t\treturn (0);\n\n\t(*sc->sc_wrcsr)(sc, LE_CSR0,\n\t    isr & (LE_C0_INEA | LE_C0_BABL | LE_C0_CERR | LE_C0_MISS | LE_C0_MERR |\n\t\t   LE_C0_RINT | LE_C0_TINT | LE_C0_IDON));\n\tif (isr & LE_C0_ERR) {\n\t\tif (isr & LE_C0_BABL) {\n#ifdef LEDEBUG\n\t\t\tprintf(\"%s: babble\\n\", sc->sc_dev.dv_xname);\n#endif\n\t\t\tifp->if_oerrors++;\n\t\t}\n#if 0\n\t\tif (isr & LE_C0_CERR) {\n\t\t\tprintf(\"%s: collision error\\n\", sc->sc_dev.dv_xname);\n\t\t\tifp->if_collisions++;\n\t\t}\n#endif\n\t\tif (isr & LE_C0_MISS) {\n#ifdef LEDEBUG\n\t\t\tprintf(\"%s: missed packet\\n\", sc->sc_dev.dv_xname);\n#endif\n\t\t\tifp->if_ierrors++;\n\t\t}\n\t\tif (isr & LE_C0_MERR) {\n\t\t\tprintf(\"%s: memory error\\n\", sc->sc_dev.dv_xname);\n\t\t\tam7990_reset(sc);\n\t\t\treturn (1);\n\t\t}\n\t}\n\n\tif ((isr & LE_C0_RXON) == 0) {\n\t\tprintf(\"%s: receiver disabled\\n\", sc->sc_dev.dv_xname);\n\t\tifp->if_ierrors++;\n\t\tam7990_reset(sc);\n\t\treturn (1);\n\t}\n\tif ((isr & LE_C0_TXON) == 0) {\n\t\tprintf(\"%s: transmitter disabled\\n\", sc->sc_dev.dv_xname);\n\t\tifp->if_oerrors++;\n\t\tam7990_reset(sc);\n\t\treturn (1);\n\t}\n\n\tif (isr & LE_C0_RINT)\n\t\tam7990_rint(sc);\n\tif (isr & LE_C0_TINT)\n\t\tam7990_tint(sc);\n\n\treturn (1);\n}",
          "includes": [
            "#include <dev/ic/am7990var.h>",
            "#include <dev/ic/am7990reg.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/socket.h>",
            "#include <sys/syslog.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tifp\t(&sc->sc_arpcom.ac_if)"
          ],
          "globals_used": [
            "am7990_rint __P((struct am7990_softc *));",
            "am7990_tint __P((struct am7990_softc *));",
            "integrate struct",
            "integrate struct",
            "mbuf *\nam7990_get(sc, boff, totlen)\n\tstruct am7990_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tifp\t(&sc->sc_arpcom.ac_if)\n\nam7990_rint __P((struct am7990_softc *));\nam7990_tint __P((struct am7990_softc *));\nintegrate struct;\nintegrate struct;\nmbuf *\nam7990_get(sc, boff, totlen)\n\tstruct am7990_softc *sc;\n\nint\nam7990_intr(arg)\n\tregister void *arg;\n{\n\tregister struct am7990_softc *sc = arg;\n\tregister u_int16_t isr;\n\n\tisr = (*sc->sc_rdcsr)(sc, LE_CSR0);\n#ifdef LEDEBUG\n\tif (sc->sc_debug){\n\t\tprintf(\"%s: am7990_intr entering with isr=%04x\\n\",\n\t\t    sc->sc_dev.dv_xname, isr);\n\t\tprintf(\" isr: 0x%b\\n\", isr, LE_C0_BITS);\n\t}\n#endif\n\tif ((isr & LE_C0_INTR) == 0)\n\t\treturn (0);\n\n\t(*sc->sc_wrcsr)(sc, LE_CSR0,\n\t    isr & (LE_C0_INEA | LE_C0_BABL | LE_C0_CERR | LE_C0_MISS | LE_C0_MERR |\n\t\t   LE_C0_RINT | LE_C0_TINT | LE_C0_IDON));\n\tif (isr & LE_C0_ERR) {\n\t\tif (isr & LE_C0_BABL) {\n#ifdef LEDEBUG\n\t\t\tprintf(\"%s: babble\\n\", sc->sc_dev.dv_xname);\n#endif\n\t\t\tifp->if_oerrors++;\n\t\t}\n#if 0\n\t\tif (isr & LE_C0_CERR) {\n\t\t\tprintf(\"%s: collision error\\n\", sc->sc_dev.dv_xname);\n\t\t\tifp->if_collisions++;\n\t\t}\n#endif\n\t\tif (isr & LE_C0_MISS) {\n#ifdef LEDEBUG\n\t\t\tprintf(\"%s: missed packet\\n\", sc->sc_dev.dv_xname);\n#endif\n\t\t\tifp->if_ierrors++;\n\t\t}\n\t\tif (isr & LE_C0_MERR) {\n\t\t\tprintf(\"%s: memory error\\n\", sc->sc_dev.dv_xname);\n\t\t\tam7990_reset(sc);\n\t\t\treturn (1);\n\t\t}\n\t}\n\n\tif ((isr & LE_C0_RXON) == 0) {\n\t\tprintf(\"%s: receiver disabled\\n\", sc->sc_dev.dv_xname);\n\t\tifp->if_ierrors++;\n\t\tam7990_reset(sc);\n\t\treturn (1);\n\t}\n\tif ((isr & LE_C0_TXON) == 0) {\n\t\tprintf(\"%s: transmitter disabled\\n\", sc->sc_dev.dv_xname);\n\t\tifp->if_oerrors++;\n\t\tam7990_reset(sc);\n\t\treturn (1);\n\t}\n\n\tif (isr & LE_C0_RINT)\n\t\tam7990_rint(sc);\n\tif (isr & LE_C0_TINT)\n\t\tam7990_tint(sc);\n\n\treturn (1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/intr.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"isadma.h\"\n#include \"bpfilter.h\"\n\nint\nle_isa_intredge(arg)\n\tvoid *arg;\n{\n\n\tif (am7990_intr(arg) == 0)\n\t\treturn (0);\n\tfor (;;)\n\t\tif (am7990_intr(arg) == 0)\n\t\t\treturn (1);\n}"
  },
  {
    "function_name": "le_isa_rdcsr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_le.c",
    "lines": "88-101",
    "snippet": "u_int16_t\nle_isa_rdcsr(sc, port)\n\tstruct am7990_softc *sc;\n\tu_int16_t port;\n{\n\tstruct le_softc *lesc = (struct le_softc *)sc;\n\tbus_space_tag_t iot = lesc->sc_iot;\n\tbus_space_handle_t ioh = lesc->sc_ioh;\n\tu_int16_t val;\n\n\tbus_space_write_2(iot, ioh, lesc->sc_rap, port);\n\tval = bus_space_read_2(iot, ioh, lesc->sc_rdp);\n\treturn (val);\n}",
    "includes": [
      "#include <dev/isa/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/intr.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"isadma.h\"",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "lesc->sc_rdp"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "lesc->sc_rap",
            "port"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/intr.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"isadma.h\"\n#include \"bpfilter.h\"\n\nu_int16_t\nle_isa_rdcsr(sc, port)\n\tstruct am7990_softc *sc;\n\tu_int16_t port;\n{\n\tstruct le_softc *lesc = (struct le_softc *)sc;\n\tbus_space_tag_t iot = lesc->sc_iot;\n\tbus_space_handle_t ioh = lesc->sc_ioh;\n\tu_int16_t val;\n\n\tbus_space_write_2(iot, ioh, lesc->sc_rap, port);\n\tval = bus_space_read_2(iot, ioh, lesc->sc_rdp);\n\treturn (val);\n}"
  },
  {
    "function_name": "le_isa_wrcsr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_le.c",
    "lines": "75-86",
    "snippet": "void\nle_isa_wrcsr(sc, port, val)\n\tstruct am7990_softc *sc;\n\tu_int16_t port, val;\n{\n\tstruct le_softc *lesc = (struct le_softc *)sc;\n\tbus_space_tag_t iot = lesc->sc_iot;\n\tbus_space_handle_t ioh = lesc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, lesc->sc_rap, port);\n\tbus_space_write_2(iot, ioh, lesc->sc_rdp, val);\n}",
    "includes": [
      "#include <dev/isa/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/intr.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"isadma.h\"",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "lesc->sc_rdp",
            "val"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "lesc->sc_rap",
            "port"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/intr.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"isadma.h\"\n#include \"bpfilter.h\"\n\nvoid\nle_isa_wrcsr(sc, port, val)\n\tstruct am7990_softc *sc;\n\tu_int16_t port, val;\n{\n\tstruct le_softc *lesc = (struct le_softc *)sc;\n\tbus_space_tag_t iot = lesc->sc_iot;\n\tbus_space_handle_t ioh = lesc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, lesc->sc_rap, port);\n\tbus_space_write_2(iot, ioh, lesc->sc_rdp, val);\n}"
  }
]