[
  {
    "function_name": "rf_spill_debug_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
    "lines": "116-134",
    "snippet": "void \nrf_spill_debug_buffer(fname)\n\tchar   *fname;\n{\n\tint     i;\n\n\tif (!rf_debugPrintUseBuffer)\n\t\treturn;\n\n\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\n\tfor (i = rf_debugprint_index + 1; i != rf_debugprint_index; i = (i + 1) & BUFMASK)\n\t\tif (rf_debugprint_buf[i].cstring)\n\t\t\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t\t\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n}",
    "includes": [
      "#include <sys/param.h>",
      "#include \"rf_options.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_debugprint.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [
      "#define BUFMASK  (BUFSIZE-1)"
    ],
    "globals_used": [
      "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
      "static int rf_debugprint_index = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_UNLOCK_MUTEX",
          "args": [
            "rf_debug_print_mutex"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "rf_debugprint_buf[i].cstring",
            "rf_debugprint_buf[i].a1",
            "rf_debugprint_buf[i].a2",
            "rf_debugprint_buf[i].a3",
            "rf_debugprint_buf[i].a4",
            "rf_debugprint_buf[i].a5",
            "rf_debugprint_buf[i].a6",
            "rf_debugprint_buf[i].a7",
            "rf_debugprint_buf[i].a8"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_LOCK_MUTEX",
          "args": [
            "rf_debug_print_mutex"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_spill_debug_buffer(fname)\n\tchar   *fname;\n{\n\tint     i;\n\n\tif (!rf_debugPrintUseBuffer)\n\t\treturn;\n\n\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\n\tfor (i = rf_debugprint_index + 1; i != rf_debugprint_index; i = (i + 1) & BUFMASK)\n\t\tif (rf_debugprint_buf[i].cstring)\n\t\t\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t\t\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n}"
  },
  {
    "function_name": "rf_print_debug_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
    "lines": "110-114",
    "snippet": "void \nrf_print_debug_buffer()\n{\n\trf_spill_debug_buffer(NULL);\n}",
    "includes": [
      "#include <sys/param.h>",
      "#include \"rf_options.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_debugprint.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_spill_debug_buffer",
          "args": [
            "NULL"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "rf_spill_debug_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "116-134",
          "snippet": "void \nrf_spill_debug_buffer(fname)\n\tchar   *fname;\n{\n\tint     i;\n\n\tif (!rf_debugPrintUseBuffer)\n\t\treturn;\n\n\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\n\tfor (i = rf_debugprint_index + 1; i != rf_debugprint_index; i = (i + 1) & BUFMASK)\n\t\tif (rf_debugprint_buf[i].cstring)\n\t\t\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t\t\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_spill_debug_buffer(fname)\n\tchar   *fname;\n{\n\tint     i;\n\n\tif (!rf_debugPrintUseBuffer)\n\t\treturn;\n\n\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\n\tfor (i = rf_debugprint_index + 1; i != rf_debugprint_index; i = (i + 1) & BUFMASK)\n\t\tif (rf_debugprint_buf[i].cstring)\n\t\t\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t\t\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tprintf(rf_debugprint_buf[i].cstring, rf_debugprint_buf[i].a1, rf_debugprint_buf[i].a2, rf_debugprint_buf[i].a3,\n\t    rf_debugprint_buf[i].a4, rf_debugprint_buf[i].a5, rf_debugprint_buf[i].a6, rf_debugprint_buf[i].a7, rf_debugprint_buf[i].a8);\n\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nvoid \nrf_print_debug_buffer()\n{\n\trf_spill_debug_buffer(NULL);\n}"
  },
  {
    "function_name": "rf_debug_printf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
    "lines": "82-108",
    "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
    "includes": [
      "#include <sys/param.h>",
      "#include \"rf_options.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_debugprint.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [
      "#define BUFMASK  (BUFSIZE-1)"
    ],
    "globals_used": [
      "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
      "static int rf_debugprint_index = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "s",
            "a1",
            "a2",
            "a3",
            "a4",
            "a5",
            "a6",
            "a7",
            "a8"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "RF_UNLOCK_MUTEX",
          "args": [
            "rf_debug_print_mutex"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_LOCK_MUTEX",
          "args": [
            "rf_debug_print_mutex"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
  },
  {
    "function_name": "rf_clear_debug_print_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
    "lines": "72-80",
    "snippet": "void \nrf_clear_debug_print_buffer()\n{\n\tint     i;\n\n\tfor (i = 0; i < BUFSIZE; i++)\n\t\trf_debugprint_buf[i].cstring = NULL;\n\trf_debugprint_index = 0;\n}",
    "includes": [
      "#include <sys/param.h>",
      "#include \"rf_options.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_debugprint.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [
      "#define BUFSIZE  (1<<BUFSHIFT)"
    ],
    "globals_used": [
      "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
      "static int rf_debugprint_index = 0;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFSIZE  (1<<BUFSHIFT)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_clear_debug_print_buffer()\n{\n\tint     i;\n\n\tfor (i = 0; i < BUFSIZE; i++)\n\t\trf_debugprint_buf[i].cstring = NULL;\n\trf_debugprint_index = 0;\n}"
  },
  {
    "function_name": "rf_ConfigureDebugPrint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
    "lines": "56-70",
    "snippet": "RF_DECLARE_STATIC_MUTEX(rf_debug_print_mutex)\n\tint     rf_ConfigureDebugPrint(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\trc = rf_create_managed_mutex(listp, &rf_debug_print_mutex);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init mutex file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\treturn (rc);\n\t}\n\trf_clear_debug_print_buffer();\n\treturn (0);\n}",
    "includes": [
      "#include <sys/param.h>",
      "#include \"rf_options.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_debugprint.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_clear_debug_print_buffer",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "rf_clear_debug_print_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "72-80",
          "snippet": "void \nrf_clear_debug_print_buffer()\n{\n\tint     i;\n\n\tfor (i = 0; i < BUFSIZE; i++)\n\t\trf_debugprint_buf[i].cstring = NULL;\n\trf_debugprint_index = 0;\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFSIZE  (1<<BUFSHIFT)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFSIZE  (1<<BUFSHIFT)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_clear_debug_print_buffer()\n{\n\tint     i;\n\n\tfor (i = 0; i < BUFSIZE; i++)\n\t\trf_debugprint_buf[i].cstring = NULL;\n\trf_debugprint_index = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG3",
          "args": [
            "\"Unable to init mutex file %s line %d rc=%d\\n\"",
            "__FILE__",
            "__LINE__",
            "rc"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_create_managed_mutex",
          "args": [
            "listp",
            "&rf_debug_print_mutex"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "_rf_create_managed_mutex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "69-90",
          "snippet": "int \n_rf_create_managed_mutex(listp, m, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_MUTEX(*m)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_mutex_init(m);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, mutex_destroyer, (void *) m, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_mutex_destroy(m);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying mutex\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void mutex_destroyer(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic void mutex_destroyer(void *);\n\nint \n_rf_create_managed_mutex(listp, m, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_MUTEX(*m)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_mutex_init(m);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, mutex_destroyer, (void *) m, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_mutex_destroy(m);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying mutex\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nRF_DECLARE_STATIC_MUTEX(rf_debug_print_mutex)\n\tint     rf_ConfigureDebugPrint(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\trc = rf_create_managed_mutex(listp, &rf_debug_print_mutex);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init mutex file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\treturn (rc);\n\t}\n\trf_clear_debug_print_buffer();\n\treturn (0);\n}"
  }
]