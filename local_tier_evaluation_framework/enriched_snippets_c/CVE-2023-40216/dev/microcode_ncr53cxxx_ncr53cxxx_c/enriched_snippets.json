[
  {
    "function_name": "usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "1152-1156",
    "snippet": "void\tusage()\n{\n\tfprintf (stderr, \"usage: scc sourcfile [options]\\n\");\n\texit(1);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tusage(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"usage: scc sourcfile [options]\\n\""
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tusage(void);\n\nvoid\tusage()\n{\n\tfprintf (stderr, \"usage: scc sourcfile [options]\\n\");\n\texit(1);\n}"
  },
  {
    "function_name": "error_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "1128-1134",
    "snippet": "void\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tlineno;",
      "int\terr_listed;",
      "char\tinbuf[128];",
      "FILE\t*listfp;",
      "FILE\t*errfp;",
      "void\terror_line(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "errfp",
            "\"%3d:  %s\"",
            "lineno",
            "inbuf"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tlineno;\nint\terr_listed;\nchar\tinbuf[128];\nFILE\t*listfp;\nFILE\t*errfp;\nvoid\terror_line(void);\n\nvoid\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}"
  },
  {
    "function_name": "memory_to_memory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "1121-1126",
    "snippet": "void\tmemory_to_memory ()\n{\n\tinst0 = 0xc0000000 + evaluate (tokenix+1);\n\tinst1 = evaluate (tokenix+3);\n\tinst2 = evaluate (tokenix+5);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\ttokenix;",
      "unsigned long\tinst0, inst1, inst2;",
      "int\tevaluate (int);",
      "void\tmemory_to_memory (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "tokenix+5"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "591-606",
          "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\tnumber (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\ttokenix;\nunsigned long\tinst0, inst1, inst2;\nint\tevaluate (int);\nvoid\tmemory_to_memory (void);\n\nvoid\tmemory_to_memory ()\n{\n\tinst0 = 0xc0000000 + evaluate (tokenix+1);\n\tinst1 = evaluate (tokenix+3);\n\tinst2 = evaluate (tokenix+5);\n}"
  },
  {
    "function_name": "register_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "1040-1119",
    "snippet": "void\tregister_write ()\n{\n\t/*\n\t * MOVE reg/data8 TO reg\t\t\tregister write\n\t * MOVE reg <op> data8 TO reg\t\t\tregister write\n\t */\n\tint\top;\n\tint\treg;\n\tint\tdata;\n\n\tif (reserved (\"to\", tokenix+1))\n\t\top = 0;\n\telse if (tokens[tokenix+1].type == '|')\n\t\top = 1;\n\telse if (tokens[tokenix+1].type == '&')\n\t\top = 2;\n\telse if (tokens[tokenix+1].type == '+')\n\t\top = 3;\n\telse if (tokens[tokenix+1].type == '-')\n\t\top = 4;\n\telse\n\t\terrout (\"Unknown register operator\");\n\tif (op && reserved (\"to\", tokenix+3) == 0)\n\t\terrout (\"Register command expected TO\");\n\treg = CheckRegister (tokenix);\n\tif (reg < 0) {\t\t\t/* Not register, must be data */\n\t\tdata = evaluate (tokenix);\n\t\tif (op)\n\t\t\terrout (\"Register operator not move\");\n\t\treg = CheckRegister (tokenix+2);\n\t\tif (reg < 0)\n\t\t\terrout (\"Expected register\");\n\t\tinst0 = 0x78000000 | (data << 8) | reg;\n#if 0\nfprintf (listfp, \"Move data to register: %02x %d\\n\", data, reg);\n#endif\n\t}\n\telse if (op) {\t\t\t/* A register read/write operator */\n\t\tdata = evaluate (tokenix+2);\n\t\tif (op == 4) {\n\t\t\tdata = -data;\n\t\t\top = 3;\n\t\t}\n\t\tinst0 = (data & 0xff) << 8;\n\t\tdata = CheckRegister (tokenix+4);\n\t\tif (data < 0)\n\t\t\terrout (\"Expected register\");\n\t\tif (reg != data && reg != 8 && data != 8)\n\t\t\terrout (\"One register MUST be SBFR\");\n\t\tif (reg == data) {\t/* A register read/modify/write */\n#if 0\nfprintf (listfp, \"Read/modify register: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\tinst0 |= 0x78000000 | (op << 25) | (reg << 16);\n\t\t}\n\t\telse {\t\t\t/* A move to/from SFBR */\n\t\t\tif (reg == 8) {\t/* MOVE SFBR <> TO reg */\n#if 0\nfprintf (listfp, \"Move SFBR to register: %02x %d %d\\n\", inst0 >> 8, op, data);\n#endif\n\t\t\t\tinst0 |= 0x68000000 | (op << 25) | (data << 16);\n\t\t\t}\n\t\t\telse {\n#if 0\nfprintf (listfp, \"Move register to SFBR: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\t\tinst0 |= 0x70000000 | (op << 25) | (reg << 16);\n\t\t\t}\n\t\t}\n\t}\n\telse {\t\t\t\t/* register to register */\n\t\tdata = CheckRegister (tokenix+2);\n\t\tif (reg == 8)\t\t/* move SFBR to reg */\n\t\t\tinst0 = 0x6a000000 | (data << 16);\n\t\telse if (data == 8)\t/* move reg to SFBR */\n\t\t\tinst0 = 0x72000000 | (reg << 16);\n\t\telse\n\t\t\terrout (\"One register must be SFBR\");\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\ttokenix;",
      "FILE\t*listfp;",
      "void\terrout (char *);",
      "int\tevaluate (int);",
      "int\treserved (char *, int);",
      "int\tCheckRegister (int);",
      "void\tregister_write (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"One register must be SFBR\""
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CheckRegister",
          "args": [
            "tokenix+2"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "CheckRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "552-570",
          "snippet": "int\tCheckRegister (int t)\n{\n\tint\ti;\n\n\tif(arch == 710) {\n\t\tfor (i = 0; i < 64; ++i)\n\t\t\tif (reserved (regs710[i], t))\n\t\t\t\treturn i;\n\t}\n\telse if (arch == 720) {\n\t\tfor (i = 0; i < 96; ++i)\n\t\t\tif (reserved (regs720[i], t))\n\t\t\t\treturn i;\n\t}\n\telse {\n\t\terrout(\"'ARCH' statement missing\");\n\t}\n\treturn (-1);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "char\t*regs710[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"sdid\",\t\t\"sien\",\n\t\"scid\",\t\t\"sxfer\",\t\"sodl\",\t\t\"socl\",\n\t\"sfbr\",\t\t\"sidl\",\t\t\"sbdl\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\t\"ctest7\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"istat\",\t\"ctest8\",\t\"lcrc\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratch0\",\t\"scratch1\",\t\"scratch2\",\t\"scratch3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\"\n};",
            "char\t*regs720[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"scntl2\",\t\"scntl3\",\n\t\"scid\",\t\t\"sxfer\",\t\"sdid\",\t\t\"gpreg\",\n\t\"sfbr\",\t\t\"socl\",\t\t\"ssid\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"istat\",\t\"\",\t\t\"\",\t\t\"\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratcha0\",\t\"scratcha1\",\t\"scratcha2\",\t\"scratcha3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\",\n\t\"sien0\",\t\"sien1\",\t\"sist0\",\t\"sist1\",\n\t\"slpar\",\t\"swide\",\t\"macntl\",\t\"gpcntl\",\n\t\"stime0\",\t\"stime1\",\t\"respid0\",\t\"respid1\",\n\t\"stest0\",\t\"stest1\",\t\"stest2\",\t\"stest3\",\n\t\"sidl0\",\t\"sidl1\",\t\"\",\t\t\"\",\n\t\"sodl0\",\t\"sodl1\",\t\"\",\t\t\"\",\n\t\"sbdl0\",\t\"sbdl1\",\t\"\",\t\t\"\",\n\t\"scratchb0\",\t\"scratchb1\",\t\"scratchb2\",\t\"scratchb3\",\n};",
            "int\tarch;",
            "void\terrout (char *);",
            "int\treserved (char *, int);",
            "int\tCheckRegister (int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nchar\t*regs710[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"sdid\",\t\t\"sien\",\n\t\"scid\",\t\t\"sxfer\",\t\"sodl\",\t\t\"socl\",\n\t\"sfbr\",\t\t\"sidl\",\t\t\"sbdl\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\t\"ctest7\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"istat\",\t\"ctest8\",\t\"lcrc\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratch0\",\t\"scratch1\",\t\"scratch2\",\t\"scratch3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\"\n};\nchar\t*regs720[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"scntl2\",\t\"scntl3\",\n\t\"scid\",\t\t\"sxfer\",\t\"sdid\",\t\t\"gpreg\",\n\t\"sfbr\",\t\t\"socl\",\t\t\"ssid\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"istat\",\t\"\",\t\t\"\",\t\t\"\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratcha0\",\t\"scratcha1\",\t\"scratcha2\",\t\"scratcha3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\",\n\t\"sien0\",\t\"sien1\",\t\"sist0\",\t\"sist1\",\n\t\"slpar\",\t\"swide\",\t\"macntl\",\t\"gpcntl\",\n\t\"stime0\",\t\"stime1\",\t\"respid0\",\t\"respid1\",\n\t\"stest0\",\t\"stest1\",\t\"stest2\",\t\"stest3\",\n\t\"sidl0\",\t\"sidl1\",\t\"\",\t\t\"\",\n\t\"sodl0\",\t\"sodl1\",\t\"\",\t\t\"\",\n\t\"sbdl0\",\t\"sbdl1\",\t\"\",\t\t\"\",\n\t\"scratchb0\",\t\"scratchb1\",\t\"scratchb2\",\t\"scratchb3\",\n};\nint\tarch;\nvoid\terrout (char *);\nint\treserved (char *, int);\nint\tCheckRegister (int);\n\nint\tCheckRegister (int t)\n{\n\tint\ti;\n\n\tif(arch == 710) {\n\t\tfor (i = 0; i < 64; ++i)\n\t\t\tif (reserved (regs710[i], t))\n\t\t\t\treturn i;\n\t}\n\telse if (arch == 720) {\n\t\tfor (i = 0; i < 96; ++i)\n\t\t\tif (reserved (regs720[i], t))\n\t\t\t\treturn i;\n\t}\n\telse {\n\t\terrout(\"'ARCH' statement missing\");\n\t}\n\treturn (-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"Move register to SFBR: %02x %d %d\\n\"",
            "inst0 >> 8",
            "op",
            "reg"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"Move SFBR to register: %02x %d %d\\n\"",
            "inst0 >> 8",
            "op",
            "data"
          ],
          "line": 1098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"Read/modify register: %02x %d %d\\n\"",
            "inst0 >> 8",
            "op",
            "reg"
          ],
          "line": 1091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "tokenix+2"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "591-606",
          "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\tnumber (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"Move data to register: %02x %d\\n\"",
            "data",
            "reg"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"to\"",
            "tokenix+3"
          ],
          "line": 1062
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nFILE\t*listfp;\nvoid\terrout (char *);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckRegister (int);\nvoid\tregister_write (void);\n\nvoid\tregister_write ()\n{\n\t/*\n\t * MOVE reg/data8 TO reg\t\t\tregister write\n\t * MOVE reg <op> data8 TO reg\t\t\tregister write\n\t */\n\tint\top;\n\tint\treg;\n\tint\tdata;\n\n\tif (reserved (\"to\", tokenix+1))\n\t\top = 0;\n\telse if (tokens[tokenix+1].type == '|')\n\t\top = 1;\n\telse if (tokens[tokenix+1].type == '&')\n\t\top = 2;\n\telse if (tokens[tokenix+1].type == '+')\n\t\top = 3;\n\telse if (tokens[tokenix+1].type == '-')\n\t\top = 4;\n\telse\n\t\terrout (\"Unknown register operator\");\n\tif (op && reserved (\"to\", tokenix+3) == 0)\n\t\terrout (\"Register command expected TO\");\n\treg = CheckRegister (tokenix);\n\tif (reg < 0) {\t\t\t/* Not register, must be data */\n\t\tdata = evaluate (tokenix);\n\t\tif (op)\n\t\t\terrout (\"Register operator not move\");\n\t\treg = CheckRegister (tokenix+2);\n\t\tif (reg < 0)\n\t\t\terrout (\"Expected register\");\n\t\tinst0 = 0x78000000 | (data << 8) | reg;\n#if 0\nfprintf (listfp, \"Move data to register: %02x %d\\n\", data, reg);\n#endif\n\t}\n\telse if (op) {\t\t\t/* A register read/write operator */\n\t\tdata = evaluate (tokenix+2);\n\t\tif (op == 4) {\n\t\t\tdata = -data;\n\t\t\top = 3;\n\t\t}\n\t\tinst0 = (data & 0xff) << 8;\n\t\tdata = CheckRegister (tokenix+4);\n\t\tif (data < 0)\n\t\t\terrout (\"Expected register\");\n\t\tif (reg != data && reg != 8 && data != 8)\n\t\t\terrout (\"One register MUST be SBFR\");\n\t\tif (reg == data) {\t/* A register read/modify/write */\n#if 0\nfprintf (listfp, \"Read/modify register: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\tinst0 |= 0x78000000 | (op << 25) | (reg << 16);\n\t\t}\n\t\telse {\t\t\t/* A move to/from SFBR */\n\t\t\tif (reg == 8) {\t/* MOVE SFBR <> TO reg */\n#if 0\nfprintf (listfp, \"Move SFBR to register: %02x %d %d\\n\", inst0 >> 8, op, data);\n#endif\n\t\t\t\tinst0 |= 0x68000000 | (op << 25) | (data << 16);\n\t\t\t}\n\t\t\telse {\n#if 0\nfprintf (listfp, \"Move register to SFBR: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\t\tinst0 |= 0x70000000 | (op << 25) | (reg << 16);\n\t\t\t}\n\t\t}\n\t}\n\telse {\t\t\t\t/* register to register */\n\t\tdata = CheckRegister (tokenix+2);\n\t\tif (reg == 8)\t\t/* move SFBR to reg */\n\t\t\tinst0 = 0x6a000000 | (data << 16);\n\t\telse if (data == 8)\t/* move reg to SFBR */\n\t\t\tinst0 = 0x72000000 | (reg << 16);\n\t\telse\n\t\t\terrout (\"One register must be SFBR\");\n\t}\n}"
  },
  {
    "function_name": "block_move",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "1009-1038",
    "snippet": "void\tblock_move ()\n{\n\tint\tt;\n\n\tif (reserved (\"from\", tokenix)) {\n\t\tinst1 = evaluate (tokenix+1);\n\t\tinst0 |= 0x10000000 | inst1;\t/*** ??? to match Zeus script */\n\t\ttokenix += 2;\n\t}\n\telse {\n\t\tinst0 |= evaluate (tokenix++);\t/* count */\n\t\ttokenix++;\t\t\t/* skip ',' */\n\t\tif (reserved (\"ptr\", tokenix)) {\n\t\t\t++ tokenix;\n\t\t\tinst0 |= 0x20000000;\n\t\t}\n\t\tinst1 = evaluate (tokenix++);\t/* address */\n\t}\n\tif (tokens[tokenix].type != ',')\n\t\terrout (\"Expected separator\");\n\tif (reserved (\"when\", tokenix + 1)) {\n\t\tinst0 |= 0x08000000;\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse if (reserved (\"with\", tokenix + 1)) {\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse\n\t\terrout (\"Expected WITH or WHEN\");\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\ttokenix;",
      "unsigned long script[MAXINST];",
      "void\terrout (char *);",
      "int\tevaluate (int);",
      "int\treserved (char *, int);",
      "int\tCheckPhase (int);",
      "void\tblock_move (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected WITH or WHEN\""
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CheckPhase",
          "args": [
            "tokenix + 2"
          ],
          "line": 1034
        },
        "resolved": true,
        "details": {
          "function_name": "CheckPhase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "539-550",
          "snippet": "int\tCheckPhase (int t)\n{\n\tint\ti;\n\n\tfor (i = 0; i < 8; ++i) {\n\t\tif (reserved (phases[i], t)) {\n\t\t\tinst0 |= i << 24;\n\t\t\treturn (1);\n\t\t}\n\t}\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "char\t*phases[] = {\n\t\"data_out\", \"data_in\", \"cmd\", \"status\",\n\t\"res4\", \"res5\", \"msg_out\", \"msg_in\"\n};",
            "int\treserved (char *, int);",
            "int\tCheckPhase (int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nchar\t*phases[] = {\n\t\"data_out\", \"data_in\", \"cmd\", \"status\",\n\t\"res4\", \"res5\", \"msg_out\", \"msg_in\"\n};\nint\treserved (char *, int);\nint\tCheckPhase (int);\n\nint\tCheckPhase (int t)\n{\n\tint\ti;\n\n\tfor (i = 0; i < 8; ++i) {\n\t\tif (reserved (phases[i], t)) {\n\t\t\tinst0 |= i << 24;\n\t\t\treturn (1);\n\t\t}\n\t}\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"with\"",
            "tokenix + 1"
          ],
          "line": 1033
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "tokenix++"
          ],
          "line": 1025
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "591-606",
          "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\tnumber (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nunsigned long script[MAXINST];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckPhase (int);\nvoid\tblock_move (void);\n\nvoid\tblock_move ()\n{\n\tint\tt;\n\n\tif (reserved (\"from\", tokenix)) {\n\t\tinst1 = evaluate (tokenix+1);\n\t\tinst0 |= 0x10000000 | inst1;\t/*** ??? to match Zeus script */\n\t\ttokenix += 2;\n\t}\n\telse {\n\t\tinst0 |= evaluate (tokenix++);\t/* count */\n\t\ttokenix++;\t\t\t/* skip ',' */\n\t\tif (reserved (\"ptr\", tokenix)) {\n\t\t\t++ tokenix;\n\t\t\tinst0 |= 0x20000000;\n\t\t}\n\t\tinst1 = evaluate (tokenix++);\t/* address */\n\t}\n\tif (tokens[tokenix].type != ',')\n\t\terrout (\"Expected separator\");\n\tif (reserved (\"when\", tokenix + 1)) {\n\t\tinst0 |= 0x08000000;\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse if (reserved (\"with\", tokenix + 1)) {\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse\n\t\terrout (\"Expected WITH or WHEN\");\n}"
  },
  {
    "function_name": "set_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "977-1007",
    "snippet": "void\tset_clear (unsigned long code)\n{\n\tint\ti = tokenix;\n\tshort\tneed_and = 0;\n\n\tinst0 = code;\n\twhile (i < ntokens) {\n\t\tif (need_and) {\n\t\t\tif (reserved (\"and\", i))\n\t\t\t\t++i;\n\t\t\telse\n\t\t\t\terrout (\"Expected AND\");\n\t\t}\n\t\tif (reserved (\"atn\", i)) {\n\t\t\tinst0 |= 0x0008;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"ack\", i)) {\n\t\t\tinst0 |= 0x0040;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"target\", i)) {\n\t\t\tinst0 |= 0x0200;\n\t\t\t++i;\n\t\t}\n\t\telse\n\t\t\terrout (\"Expected ATN, ACK, or TARGET\");\n\t\tneed_and = 1;\n\t}\n\tstore_inst ();\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tntokens;",
      "int\ttokenix;",
      "void\terrout (char *);",
      "void\tstore_inst (void);",
      "int\treserved (char *, int);",
      "void\tset_clear (unsigned long);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_inst",
          "args": [],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "store_inst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "771-795",
          "snippet": "void\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tMAXINST\t\t1024"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "unsigned long\tinst0, inst1, inst2;",
            "unsigned long\tninsts;",
            "FILE\t*listfp;",
            "void\terrout (char *);",
            "void\tstore_inst (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXINST\t\t1024\n\nunsigned long script[MAXINST];\nint\tdsps;\nunsigned long\tinst0, inst1, inst2;\nunsigned long\tninsts;\nFILE\t*listfp;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\n\nvoid\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected ATN, ACK, or TARGET\""
          ],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"target\"",
            "i"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tntokens;\nint\ttokenix;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\treserved (char *, int);\nvoid\tset_clear (unsigned long);\n\nvoid\tset_clear (unsigned long code)\n{\n\tint\ti = tokenix;\n\tshort\tneed_and = 0;\n\n\tinst0 = code;\n\twhile (i < ntokens) {\n\t\tif (need_and) {\n\t\t\tif (reserved (\"and\", i))\n\t\t\t\t++i;\n\t\t\telse\n\t\t\t\terrout (\"Expected AND\");\n\t\t}\n\t\tif (reserved (\"atn\", i)) {\n\t\t\tinst0 |= 0x0008;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"ack\", i)) {\n\t\t\tinst0 |= 0x0040;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"target\", i)) {\n\t\t\tinst0 |= 0x0200;\n\t\t\t++i;\n\t\t}\n\t\telse\n\t\t\terrout (\"Expected ATN, ACK, or TARGET\");\n\t\tneed_and = 1;\n\t}\n\tstore_inst ();\n}"
  },
  {
    "function_name": "select_reselect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "955-975",
    "snippet": "void \tselect_reselect (int t)\n{\n\tinst0 |= 0x40000000;\t\t/* ATN may be set from SELECT */\n\tif (reserved (\"from\", t)) {\n\t\t++t;\n\t\tinst0 |= 0x02000000 | evaluate (t++);\n\t}\n\telse\n\t\tinst0 |= (evaluate (t++) & 0xff) << 16;\n\tif (tokens[t++].type == ',') {\n\t\tif (reserved (\"rel\", t)) {\n\t\t\tinst0 |= 0x04000000;\n\t\t\tinst1 = evaluate (t + 2) - dsps - 8;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (t);\n\t}\n\telse\n\t\terrout (\"Expected separator\");\n\tstore_inst ();\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\tdsps;",
      "void\terrout (char *);",
      "void\tstore_inst (void);",
      "int\tevaluate (int);",
      "int\treserved (char *, int);",
      "void\tselect_reselect (int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_inst",
          "args": [],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "store_inst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "771-795",
          "snippet": "void\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tMAXINST\t\t1024"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "unsigned long\tinst0, inst1, inst2;",
            "unsigned long\tninsts;",
            "FILE\t*listfp;",
            "void\terrout (char *);",
            "void\tstore_inst (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXINST\t\t1024\n\nunsigned long script[MAXINST];\nint\tdsps;\nunsigned long\tinst0, inst1, inst2;\nunsigned long\tninsts;\nFILE\t*listfp;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\n\nvoid\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected separator\""
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "t"
          ],
          "line": 970
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "591-606",
          "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\tnumber (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"rel\"",
            "t"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nvoid\tselect_reselect (int);\n\nvoid \tselect_reselect (int t)\n{\n\tinst0 |= 0x40000000;\t\t/* ATN may be set from SELECT */\n\tif (reserved (\"from\", t)) {\n\t\t++t;\n\t\tinst0 |= 0x02000000 | evaluate (t++);\n\t}\n\telse\n\t\tinst0 |= (evaluate (t++) & 0xff) << 16;\n\tif (tokens[t++].type == ',') {\n\t\tif (reserved (\"rel\", t)) {\n\t\t\tinst0 |= 0x04000000;\n\t\t\tinst1 = evaluate (t + 2) - dsps - 8;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (t);\n\t}\n\telse\n\t\terrout (\"Expected separator\");\n\tstore_inst ();\n}"
  },
  {
    "function_name": "transfer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "887-953",
    "snippet": "void\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\tntokens;",
      "int\ttokenix;",
      "int\tdsps;",
      "void\terrout (char *);",
      "void\tstore_inst (void);",
      "int\tevaluate (int);",
      "int\treserved (char *, int);",
      "int\tCheckPhase (int);",
      "void\ttransfer (int, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_inst",
          "args": [],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "store_inst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "771-795",
          "snippet": "void\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tMAXINST\t\t1024"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "unsigned long\tinst0, inst1, inst2;",
            "unsigned long\tninsts;",
            "FILE\t*listfp;",
            "void\terrout (char *);",
            "void\tstore_inst (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXINST\t\t1024\n\nunsigned long script[MAXINST];\nint\tdsps;\nunsigned long\tinst0, inst1, inst2;\nunsigned long\tninsts;\nFILE\t*listfp;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\n\nvoid\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected , AND MASK\""
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "i + 2"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "591-606",
          "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\tnumber (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"mask\"",
            "i + 1"
          ],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CheckPhase",
          "args": [
            "i"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "CheckPhase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "539-550",
          "snippet": "int\tCheckPhase (int t)\n{\n\tint\ti;\n\n\tfor (i = 0; i < 8; ++i) {\n\t\tif (reserved (phases[i], t)) {\n\t\t\tinst0 |= i << 24;\n\t\t\treturn (1);\n\t\t}\n\t}\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "char\t*phases[] = {\n\t\"data_out\", \"data_in\", \"cmd\", \"status\",\n\t\"res4\", \"res5\", \"msg_out\", \"msg_in\"\n};",
            "int\treserved (char *, int);",
            "int\tCheckPhase (int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nchar\t*phases[] = {\n\t\"data_out\", \"data_in\", \"cmd\", \"status\",\n\t\"res4\", \"res5\", \"msg_out\", \"msg_in\"\n};\nint\treserved (char *, int);\nint\tCheckPhase (int);\n\nint\tCheckPhase (int t)\n{\n\tint\ti;\n\n\tfor (i = 0; i < 8; ++i) {\n\t\tif (reserved (phases[i], t)) {\n\t\t\tinst0 |= i << 24;\n\t\t\treturn (1);\n\t\t}\n\t}\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckPhase (int);\nvoid\ttransfer (int, int);\n\nvoid\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}"
  },
  {
    "function_name": "f_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "882-885",
    "snippet": "void\tf_clear (void)\n{\n\tset_clear (0x60000000);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_clear (void);",
      "void\tset_clear (unsigned long);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_clear",
          "args": [
            "0x60000000"
          ],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "set_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "977-1007",
          "snippet": "void\tset_clear (unsigned long code)\n{\n\tint\ti = tokenix;\n\tshort\tneed_and = 0;\n\n\tinst0 = code;\n\twhile (i < ntokens) {\n\t\tif (need_and) {\n\t\t\tif (reserved (\"and\", i))\n\t\t\t\t++i;\n\t\t\telse\n\t\t\t\terrout (\"Expected AND\");\n\t\t}\n\t\tif (reserved (\"atn\", i)) {\n\t\t\tinst0 |= 0x0008;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"ack\", i)) {\n\t\t\tinst0 |= 0x0040;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"target\", i)) {\n\t\t\tinst0 |= 0x0200;\n\t\t\t++i;\n\t\t}\n\t\telse\n\t\t\terrout (\"Expected ATN, ACK, or TARGET\");\n\t\tneed_and = 1;\n\t}\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tntokens;",
            "int\ttokenix;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\treserved (char *, int);",
            "void\tset_clear (unsigned long);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tntokens;\nint\ttokenix;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\treserved (char *, int);\nvoid\tset_clear (unsigned long);\n\nvoid\tset_clear (unsigned long code)\n{\n\tint\ti = tokenix;\n\tshort\tneed_and = 0;\n\n\tinst0 = code;\n\twhile (i < ntokens) {\n\t\tif (need_and) {\n\t\t\tif (reserved (\"and\", i))\n\t\t\t\t++i;\n\t\t\telse\n\t\t\t\terrout (\"Expected AND\");\n\t\t}\n\t\tif (reserved (\"atn\", i)) {\n\t\t\tinst0 |= 0x0008;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"ack\", i)) {\n\t\t\tinst0 |= 0x0040;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"target\", i)) {\n\t\t\tinst0 |= 0x0200;\n\t\t\t++i;\n\t\t}\n\t\telse\n\t\t\terrout (\"Expected ATN, ACK, or TARGET\");\n\t\tneed_and = 1;\n\t}\n\tstore_inst ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_clear (void);\nvoid\tset_clear (unsigned long);\n\nvoid\tf_clear (void)\n{\n\tset_clear (0x60000000);\n}"
  },
  {
    "function_name": "f_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "877-880",
    "snippet": "void\tf_set (void)\n{\n\tset_clear (0x58000000);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_set (void);",
      "void\tset_clear (unsigned long);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_clear",
          "args": [
            "0x58000000"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "set_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "977-1007",
          "snippet": "void\tset_clear (unsigned long code)\n{\n\tint\ti = tokenix;\n\tshort\tneed_and = 0;\n\n\tinst0 = code;\n\twhile (i < ntokens) {\n\t\tif (need_and) {\n\t\t\tif (reserved (\"and\", i))\n\t\t\t\t++i;\n\t\t\telse\n\t\t\t\terrout (\"Expected AND\");\n\t\t}\n\t\tif (reserved (\"atn\", i)) {\n\t\t\tinst0 |= 0x0008;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"ack\", i)) {\n\t\t\tinst0 |= 0x0040;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"target\", i)) {\n\t\t\tinst0 |= 0x0200;\n\t\t\t++i;\n\t\t}\n\t\telse\n\t\t\terrout (\"Expected ATN, ACK, or TARGET\");\n\t\tneed_and = 1;\n\t}\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tntokens;",
            "int\ttokenix;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\treserved (char *, int);",
            "void\tset_clear (unsigned long);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tntokens;\nint\ttokenix;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\treserved (char *, int);\nvoid\tset_clear (unsigned long);\n\nvoid\tset_clear (unsigned long code)\n{\n\tint\ti = tokenix;\n\tshort\tneed_and = 0;\n\n\tinst0 = code;\n\twhile (i < ntokens) {\n\t\tif (need_and) {\n\t\t\tif (reserved (\"and\", i))\n\t\t\t\t++i;\n\t\t\telse\n\t\t\t\terrout (\"Expected AND\");\n\t\t}\n\t\tif (reserved (\"atn\", i)) {\n\t\t\tinst0 |= 0x0008;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"ack\", i)) {\n\t\t\tinst0 |= 0x0040;\n\t\t\t++i;\n\t\t}\n\t\telse if (reserved (\"target\", i)) {\n\t\t\tinst0 |= 0x0200;\n\t\t\t++i;\n\t\t}\n\t\telse\n\t\t\terrout (\"Expected ATN, ACK, or TARGET\");\n\t\tneed_and = 1;\n\t}\n\tstore_inst ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_set (void);\nvoid\tset_clear (unsigned long);\n\nvoid\tf_set (void)\n{\n\tset_clear (0x58000000);\n}"
  },
  {
    "function_name": "f_disconnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "871-875",
    "snippet": "void\tf_disconnect (void)\n{\n\tinst0 = 0x48000000;\n\tstore_inst ();\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_disconnect (void);",
      "void\tstore_inst (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_inst",
          "args": [],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "store_inst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "771-795",
          "snippet": "void\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tMAXINST\t\t1024"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "unsigned long\tinst0, inst1, inst2;",
            "unsigned long\tninsts;",
            "FILE\t*listfp;",
            "void\terrout (char *);",
            "void\tstore_inst (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXINST\t\t1024\n\nunsigned long script[MAXINST];\nint\tdsps;\nunsigned long\tinst0, inst1, inst2;\nunsigned long\tninsts;\nFILE\t*listfp;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\n\nvoid\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_disconnect (void);\nvoid\tstore_inst (void);\n\nvoid\tf_disconnect (void)\n{\n\tinst0 = 0x48000000;\n\tstore_inst ();\n}"
  },
  {
    "function_name": "f_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "844-869",
    "snippet": "void\tf_wait (void)\n{\n\tint\ti = tokenix;\n\n\tinst1 = 0;\n\tif (reserved (\"disconnect\", i)) {\n\t\tinst0 = 0x48000000;\n\t}\n\telse {\n\t\tif (reserved (\"reselect\", i))\n\t\t\tinst0 = 0x50000000;\n\t\telse if (reserved (\"select\", i))\n\t\t\tinst0 = 0x50000000;\n\t\telse\n\t\t\terrout (\"Expected SELECT or RESELECT\");\n\t\t++i;\n\t\tif (reserved (\"rel\", i)) {\n\t\t\ti += 2;\n\t\t\tinst1 = evaluate (i) - dsps - 8;\n\t\t\tinst0 |= 0x04000000;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (i);\n\t}\n\tstore_inst ();\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\ttokenix;",
      "void\tf_wait (void);",
      "int\tdsps;",
      "void\terrout (char *);",
      "void\tstore_inst (void);",
      "int\tevaluate (int);",
      "int\treserved (char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_inst",
          "args": [],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "store_inst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "771-795",
          "snippet": "void\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tMAXINST\t\t1024"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "unsigned long\tinst0, inst1, inst2;",
            "unsigned long\tninsts;",
            "FILE\t*listfp;",
            "void\terrout (char *);",
            "void\tstore_inst (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXINST\t\t1024\n\nunsigned long script[MAXINST];\nint\tdsps;\nunsigned long\tinst0, inst1, inst2;\nunsigned long\tninsts;\nFILE\t*listfp;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\n\nvoid\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "i"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "591-606",
          "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\tnumber (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"rel\"",
            "i"
          ],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected SELECT or RESELECT\""
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\ttokenix;\nvoid\tf_wait (void);\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\n\nvoid\tf_wait (void)\n{\n\tint\ti = tokenix;\n\n\tinst1 = 0;\n\tif (reserved (\"disconnect\", i)) {\n\t\tinst0 = 0x48000000;\n\t}\n\telse {\n\t\tif (reserved (\"reselect\", i))\n\t\t\tinst0 = 0x50000000;\n\t\telse if (reserved (\"select\", i))\n\t\t\tinst0 = 0x50000000;\n\t\telse\n\t\t\terrout (\"Expected SELECT or RESELECT\");\n\t\t++i;\n\t\tif (reserved (\"rel\", i)) {\n\t\t\ti += 2;\n\t\t\tinst1 = evaluate (i) - dsps - 8;\n\t\t\tinst0 |= 0x04000000;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (i);\n\t}\n\tstore_inst ();\n}"
  },
  {
    "function_name": "f_reselect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "839-842",
    "snippet": "void\tf_reselect (void)\n{\n\tselect_reselect (tokenix);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\ttokenix;",
      "void\tf_reselect (void);",
      "void\tselect_reselect (int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "select_reselect",
          "args": [
            "tokenix"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "select_reselect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "955-975",
          "snippet": "void \tselect_reselect (int t)\n{\n\tinst0 |= 0x40000000;\t\t/* ATN may be set from SELECT */\n\tif (reserved (\"from\", t)) {\n\t\t++t;\n\t\tinst0 |= 0x02000000 | evaluate (t++);\n\t}\n\telse\n\t\tinst0 |= (evaluate (t++) & 0xff) << 16;\n\tif (tokens[t++].type == ',') {\n\t\tif (reserved (\"rel\", t)) {\n\t\t\tinst0 |= 0x04000000;\n\t\t\tinst1 = evaluate (t + 2) - dsps - 8;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (t);\n\t}\n\telse\n\t\terrout (\"Expected separator\");\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\tdsps;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "void\tselect_reselect (int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nvoid\tselect_reselect (int);\n\nvoid \tselect_reselect (int t)\n{\n\tinst0 |= 0x40000000;\t\t/* ATN may be set from SELECT */\n\tif (reserved (\"from\", t)) {\n\t\t++t;\n\t\tinst0 |= 0x02000000 | evaluate (t++);\n\t}\n\telse\n\t\tinst0 |= (evaluate (t++) & 0xff) << 16;\n\tif (tokens[t++].type == ',') {\n\t\tif (reserved (\"rel\", t)) {\n\t\t\tinst0 |= 0x04000000;\n\t\t\tinst1 = evaluate (t + 2) - dsps - 8;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (t);\n\t}\n\telse\n\t\terrout (\"Expected separator\");\n\tstore_inst ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\ttokenix;\nvoid\tf_reselect (void);\nvoid\tselect_reselect (int);\n\nvoid\tf_reselect (void)\n{\n\tselect_reselect (tokenix);\n}"
  },
  {
    "function_name": "f_select",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "828-837",
    "snippet": "void\tf_select (void)\n{\n\tint\tt = tokenix;\n\n\tif (reserved (\"atn\", t)) {\n\t\tinst0 = 0x01000000;\n\t\t++t;\n\t}\n\tselect_reselect (t);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\ttokenix;",
      "void\tf_select (void);",
      "int\treserved (char *, int);",
      "void\tselect_reselect (int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "select_reselect",
          "args": [
            "t"
          ],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "select_reselect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "955-975",
          "snippet": "void \tselect_reselect (int t)\n{\n\tinst0 |= 0x40000000;\t\t/* ATN may be set from SELECT */\n\tif (reserved (\"from\", t)) {\n\t\t++t;\n\t\tinst0 |= 0x02000000 | evaluate (t++);\n\t}\n\telse\n\t\tinst0 |= (evaluate (t++) & 0xff) << 16;\n\tif (tokens[t++].type == ',') {\n\t\tif (reserved (\"rel\", t)) {\n\t\t\tinst0 |= 0x04000000;\n\t\t\tinst1 = evaluate (t + 2) - dsps - 8;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (t);\n\t}\n\telse\n\t\terrout (\"Expected separator\");\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\tdsps;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "void\tselect_reselect (int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nvoid\tselect_reselect (int);\n\nvoid \tselect_reselect (int t)\n{\n\tinst0 |= 0x40000000;\t\t/* ATN may be set from SELECT */\n\tif (reserved (\"from\", t)) {\n\t\t++t;\n\t\tinst0 |= 0x02000000 | evaluate (t++);\n\t}\n\telse\n\t\tinst0 |= (evaluate (t++) & 0xff) << 16;\n\tif (tokens[t++].type == ',') {\n\t\tif (reserved (\"rel\", t)) {\n\t\t\tinst0 |= 0x04000000;\n\t\t\tinst1 = evaluate (t + 2) - dsps - 8;\n\t\t}\n\t\telse\n\t\t\tinst1 = evaluate (t);\n\t}\n\telse\n\t\terrout (\"Expected separator\");\n\tstore_inst ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"atn\"",
            "t"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\ttokenix;\nvoid\tf_select (void);\nint\treserved (char *, int);\nvoid\tselect_reselect (int);\n\nvoid\tf_select (void)\n{\n\tint\tt = tokenix;\n\n\tif (reserved (\"atn\", t)) {\n\t\tinst0 = 0x01000000;\n\t\t++t;\n\t}\n\tselect_reselect (t);\n}"
  },
  {
    "function_name": "f_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "823-826",
    "snippet": "void\tf_int (void)\n{\n\ttransfer (0x98000000, 2);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_int (void);",
      "void\ttransfer (int, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "transfer",
          "args": [
            "0x98000000",
            "2"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "transfer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "887-953",
          "snippet": "void\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\tntokens;",
            "int\ttokenix;",
            "int\tdsps;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "int\tCheckPhase (int);",
            "void\ttransfer (int, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckPhase (int);\nvoid\ttransfer (int, int);\n\nvoid\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_int (void);\nvoid\ttransfer (int, int);\n\nvoid\tf_int (void)\n{\n\ttransfer (0x98000000, 2);\n}"
  },
  {
    "function_name": "f_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "818-821",
    "snippet": "void\tf_return (void)\n{\n\ttransfer (0x90000000, 1);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_return (void);",
      "void\ttransfer (int, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "transfer",
          "args": [
            "0x90000000",
            "1"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "transfer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "887-953",
          "snippet": "void\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\tntokens;",
            "int\ttokenix;",
            "int\tdsps;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "int\tCheckPhase (int);",
            "void\ttransfer (int, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckPhase (int);\nvoid\ttransfer (int, int);\n\nvoid\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_return (void);\nvoid\ttransfer (int, int);\n\nvoid\tf_return (void)\n{\n\ttransfer (0x90000000, 1);\n}"
  },
  {
    "function_name": "f_call",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "813-816",
    "snippet": "void\tf_call (void)\n{\n\ttransfer (0x88000000, 0);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_call (void);",
      "void\ttransfer (int, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "transfer",
          "args": [
            "0x88000000",
            "0"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "transfer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "887-953",
          "snippet": "void\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\tntokens;",
            "int\ttokenix;",
            "int\tdsps;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "int\tCheckPhase (int);",
            "void\ttransfer (int, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckPhase (int);\nvoid\ttransfer (int, int);\n\nvoid\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_call (void);\nvoid\ttransfer (int, int);\n\nvoid\tf_call (void)\n{\n\ttransfer (0x88000000, 0);\n}"
  },
  {
    "function_name": "f_jump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "808-811",
    "snippet": "void\tf_jump (void)\n{\n\ttransfer (0x80000000, 0);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_jump (void);",
      "void\ttransfer (int, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "transfer",
          "args": [
            "0x80000000",
            "0"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "transfer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "887-953",
          "snippet": "void\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\tntokens;",
            "int\ttokenix;",
            "int\tdsps;",
            "void\terrout (char *);",
            "void\tstore_inst (void);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "int\tCheckPhase (int);",
            "void\ttransfer (int, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nint\tdsps;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckPhase (int);\nvoid\ttransfer (int, int);\n\nvoid\ttransfer (int word0, int type)\n{\n\tint\ti;\n\n\ti = tokenix;\n\tinst0 = word0;\n\tif (type == 0 && reserved (\"rel\", i)) {\n\t\tinst1 = evaluate (i + 2) - dsps - 8;\n\t\ti += 3;\n\t\tinst0 |= 0x00800000;\n\t}\n\telse if (type != 1) {\n\t\tinst1 = evaluate (i);\n\t}\n\t++i;\n\tif (i >= ntokens) {\n\t\tinst0 |= 0x00080000;\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (tokens[i].type != ',')\n\t\terrout (\"Expected a separator, ',' assumed\");\n\telse\n\t\t++i;\n\tif (reserved(\"when\", i))\n\t\tinst0 |= 0x00010000;\n\telse if (reserved (\"if\", i) == 0) {\n\t\terrout (\"Expected a reserved word\");\n\t\tstore_inst ();\n\t\treturn;\n\t}\n\tif (reserved (\"not\", ++i))\n\t\t++i;\n\telse\n\t\tinst0 |= 0x00080000;\n\tif (reserved (\"atn\", i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t} else if (CheckPhase (i)) {\n\t\tinst0 |= 0x00020000;\n\t\t++i;\n\t}\n\tif (i < ntokens && tokens[i].type != ',') {\n\t\tif (inst0 & 0x00020000) {\n\t\t\tif (inst0 & 0x00080000 && reserved (\"and\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse if ((inst0 & 0x00080000) == 0 && reserved (\"or\", i)) {\n\t\t\t\t++i;\n\t\t\t}\n\t\t\telse\n\t\t\t\terrout (\"Expected a reserved word\");\n\t\t}\n\t\tinst0 |= 0x00040000 + (evaluate (i++) & 0xff);\n\t}\n\tif (i < ntokens) {\n\t\tif (tokens[i].type == ',')\n\t\t\t++i;\n\t\telse\n\t\t\terrout (\"Expected a separator, ',' assumed\");\n\t\tif (reserved (\"and\", i) && reserved (\"mask\", i + 1))\n\t\t\tinst0 |= ((evaluate (i + 2) & 0xff) << 8);\n\t\telse\n\t\t\terrout (\"Expected , AND MASK\");\n\t}\n\tstore_inst ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_jump (void);\nvoid\ttransfer (int, int);\n\nvoid\tf_jump (void)\n{\n\ttransfer (0x80000000, 0);\n}"
  },
  {
    "function_name": "f_move",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "797-806",
    "snippet": "void\tf_move (void)\n{\n\tif (reserved (\"memory\", tokenix))\n\t\tmemory_to_memory ();\n\telse if (reserved (\"from\", tokenix) || tokens[tokenix+1].type == ',')\n\t\tblock_move ();\n\telse\n\t\tregister_write ();\n\tstore_inst ();\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\ttokenix;",
      "void\tf_move (void);",
      "void\tstore_inst (void);",
      "int\treserved (char *, int);",
      "void\tblock_move (void);",
      "void\tregister_write (void);",
      "void\tmemory_to_memory (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_inst",
          "args": [],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "store_inst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "771-795",
          "snippet": "void\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tMAXINST\t\t1024"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "unsigned long\tinst0, inst1, inst2;",
            "unsigned long\tninsts;",
            "FILE\t*listfp;",
            "void\terrout (char *);",
            "void\tstore_inst (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXINST\t\t1024\n\nunsigned long script[MAXINST];\nint\tdsps;\nunsigned long\tinst0, inst1, inst2;\nunsigned long\tninsts;\nFILE\t*listfp;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\n\nvoid\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_write",
          "args": [],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "register_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "1040-1119",
          "snippet": "void\tregister_write ()\n{\n\t/*\n\t * MOVE reg/data8 TO reg\t\t\tregister write\n\t * MOVE reg <op> data8 TO reg\t\t\tregister write\n\t */\n\tint\top;\n\tint\treg;\n\tint\tdata;\n\n\tif (reserved (\"to\", tokenix+1))\n\t\top = 0;\n\telse if (tokens[tokenix+1].type == '|')\n\t\top = 1;\n\telse if (tokens[tokenix+1].type == '&')\n\t\top = 2;\n\telse if (tokens[tokenix+1].type == '+')\n\t\top = 3;\n\telse if (tokens[tokenix+1].type == '-')\n\t\top = 4;\n\telse\n\t\terrout (\"Unknown register operator\");\n\tif (op && reserved (\"to\", tokenix+3) == 0)\n\t\terrout (\"Register command expected TO\");\n\treg = CheckRegister (tokenix);\n\tif (reg < 0) {\t\t\t/* Not register, must be data */\n\t\tdata = evaluate (tokenix);\n\t\tif (op)\n\t\t\terrout (\"Register operator not move\");\n\t\treg = CheckRegister (tokenix+2);\n\t\tif (reg < 0)\n\t\t\terrout (\"Expected register\");\n\t\tinst0 = 0x78000000 | (data << 8) | reg;\n#if 0\nfprintf (listfp, \"Move data to register: %02x %d\\n\", data, reg);\n#endif\n\t}\n\telse if (op) {\t\t\t/* A register read/write operator */\n\t\tdata = evaluate (tokenix+2);\n\t\tif (op == 4) {\n\t\t\tdata = -data;\n\t\t\top = 3;\n\t\t}\n\t\tinst0 = (data & 0xff) << 8;\n\t\tdata = CheckRegister (tokenix+4);\n\t\tif (data < 0)\n\t\t\terrout (\"Expected register\");\n\t\tif (reg != data && reg != 8 && data != 8)\n\t\t\terrout (\"One register MUST be SBFR\");\n\t\tif (reg == data) {\t/* A register read/modify/write */\n#if 0\nfprintf (listfp, \"Read/modify register: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\tinst0 |= 0x78000000 | (op << 25) | (reg << 16);\n\t\t}\n\t\telse {\t\t\t/* A move to/from SFBR */\n\t\t\tif (reg == 8) {\t/* MOVE SFBR <> TO reg */\n#if 0\nfprintf (listfp, \"Move SFBR to register: %02x %d %d\\n\", inst0 >> 8, op, data);\n#endif\n\t\t\t\tinst0 |= 0x68000000 | (op << 25) | (data << 16);\n\t\t\t}\n\t\t\telse {\n#if 0\nfprintf (listfp, \"Move register to SFBR: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\t\tinst0 |= 0x70000000 | (op << 25) | (reg << 16);\n\t\t\t}\n\t\t}\n\t}\n\telse {\t\t\t\t/* register to register */\n\t\tdata = CheckRegister (tokenix+2);\n\t\tif (reg == 8)\t\t/* move SFBR to reg */\n\t\t\tinst0 = 0x6a000000 | (data << 16);\n\t\telse if (data == 8)\t/* move reg to SFBR */\n\t\t\tinst0 = 0x72000000 | (reg << 16);\n\t\telse\n\t\t\terrout (\"One register must be SFBR\");\n\t}\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\ttokenix;",
            "FILE\t*listfp;",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "int\tCheckRegister (int);",
            "void\tregister_write (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nFILE\t*listfp;\nvoid\terrout (char *);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckRegister (int);\nvoid\tregister_write (void);\n\nvoid\tregister_write ()\n{\n\t/*\n\t * MOVE reg/data8 TO reg\t\t\tregister write\n\t * MOVE reg <op> data8 TO reg\t\t\tregister write\n\t */\n\tint\top;\n\tint\treg;\n\tint\tdata;\n\n\tif (reserved (\"to\", tokenix+1))\n\t\top = 0;\n\telse if (tokens[tokenix+1].type == '|')\n\t\top = 1;\n\telse if (tokens[tokenix+1].type == '&')\n\t\top = 2;\n\telse if (tokens[tokenix+1].type == '+')\n\t\top = 3;\n\telse if (tokens[tokenix+1].type == '-')\n\t\top = 4;\n\telse\n\t\terrout (\"Unknown register operator\");\n\tif (op && reserved (\"to\", tokenix+3) == 0)\n\t\terrout (\"Register command expected TO\");\n\treg = CheckRegister (tokenix);\n\tif (reg < 0) {\t\t\t/* Not register, must be data */\n\t\tdata = evaluate (tokenix);\n\t\tif (op)\n\t\t\terrout (\"Register operator not move\");\n\t\treg = CheckRegister (tokenix+2);\n\t\tif (reg < 0)\n\t\t\terrout (\"Expected register\");\n\t\tinst0 = 0x78000000 | (data << 8) | reg;\n#if 0\nfprintf (listfp, \"Move data to register: %02x %d\\n\", data, reg);\n#endif\n\t}\n\telse if (op) {\t\t\t/* A register read/write operator */\n\t\tdata = evaluate (tokenix+2);\n\t\tif (op == 4) {\n\t\t\tdata = -data;\n\t\t\top = 3;\n\t\t}\n\t\tinst0 = (data & 0xff) << 8;\n\t\tdata = CheckRegister (tokenix+4);\n\t\tif (data < 0)\n\t\t\terrout (\"Expected register\");\n\t\tif (reg != data && reg != 8 && data != 8)\n\t\t\terrout (\"One register MUST be SBFR\");\n\t\tif (reg == data) {\t/* A register read/modify/write */\n#if 0\nfprintf (listfp, \"Read/modify register: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\tinst0 |= 0x78000000 | (op << 25) | (reg << 16);\n\t\t}\n\t\telse {\t\t\t/* A move to/from SFBR */\n\t\t\tif (reg == 8) {\t/* MOVE SFBR <> TO reg */\n#if 0\nfprintf (listfp, \"Move SFBR to register: %02x %d %d\\n\", inst0 >> 8, op, data);\n#endif\n\t\t\t\tinst0 |= 0x68000000 | (op << 25) | (data << 16);\n\t\t\t}\n\t\t\telse {\n#if 0\nfprintf (listfp, \"Move register to SFBR: %02x %d %d\\n\", inst0 >> 8, op, reg);\n#endif\n\t\t\t\tinst0 |= 0x70000000 | (op << 25) | (reg << 16);\n\t\t\t}\n\t\t}\n\t}\n\telse {\t\t\t\t/* register to register */\n\t\tdata = CheckRegister (tokenix+2);\n\t\tif (reg == 8)\t\t/* move SFBR to reg */\n\t\t\tinst0 = 0x6a000000 | (data << 16);\n\t\telse if (data == 8)\t/* move reg to SFBR */\n\t\t\tinst0 = 0x72000000 | (reg << 16);\n\t\telse\n\t\t\terrout (\"One register must be SFBR\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "block_move",
          "args": [],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "block_move",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "1009-1038",
          "snippet": "void\tblock_move ()\n{\n\tint\tt;\n\n\tif (reserved (\"from\", tokenix)) {\n\t\tinst1 = evaluate (tokenix+1);\n\t\tinst0 |= 0x10000000 | inst1;\t/*** ??? to match Zeus script */\n\t\ttokenix += 2;\n\t}\n\telse {\n\t\tinst0 |= evaluate (tokenix++);\t/* count */\n\t\ttokenix++;\t\t\t/* skip ',' */\n\t\tif (reserved (\"ptr\", tokenix)) {\n\t\t\t++ tokenix;\n\t\t\tinst0 |= 0x20000000;\n\t\t}\n\t\tinst1 = evaluate (tokenix++);\t/* address */\n\t}\n\tif (tokens[tokenix].type != ',')\n\t\terrout (\"Expected separator\");\n\tif (reserved (\"when\", tokenix + 1)) {\n\t\tinst0 |= 0x08000000;\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse if (reserved (\"with\", tokenix + 1)) {\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse\n\t\terrout (\"Expected WITH or WHEN\");\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\ttokenix;",
            "unsigned long script[MAXINST];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\treserved (char *, int);",
            "int\tCheckPhase (int);",
            "void\tblock_move (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nunsigned long script[MAXINST];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\treserved (char *, int);\nint\tCheckPhase (int);\nvoid\tblock_move (void);\n\nvoid\tblock_move ()\n{\n\tint\tt;\n\n\tif (reserved (\"from\", tokenix)) {\n\t\tinst1 = evaluate (tokenix+1);\n\t\tinst0 |= 0x10000000 | inst1;\t/*** ??? to match Zeus script */\n\t\ttokenix += 2;\n\t}\n\telse {\n\t\tinst0 |= evaluate (tokenix++);\t/* count */\n\t\ttokenix++;\t\t\t/* skip ',' */\n\t\tif (reserved (\"ptr\", tokenix)) {\n\t\t\t++ tokenix;\n\t\t\tinst0 |= 0x20000000;\n\t\t}\n\t\tinst1 = evaluate (tokenix++);\t/* address */\n\t}\n\tif (tokens[tokenix].type != ',')\n\t\terrout (\"Expected separator\");\n\tif (reserved (\"when\", tokenix + 1)) {\n\t\tinst0 |= 0x08000000;\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse if (reserved (\"with\", tokenix + 1)) {\n\t\tCheckPhase (tokenix + 2);\n\t}\n\telse\n\t\terrout (\"Expected WITH or WHEN\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "\"from\"",
            "tokenix"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_to_memory",
          "args": [],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "memory_to_memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "1121-1126",
          "snippet": "void\tmemory_to_memory ()\n{\n\tinst0 = 0xc0000000 + evaluate (tokenix+1);\n\tinst1 = evaluate (tokenix+3);\n\tinst2 = evaluate (tokenix+5);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\ttokenix;",
            "unsigned long\tinst0, inst1, inst2;",
            "int\tevaluate (int);",
            "void\tmemory_to_memory (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\ttokenix;\nunsigned long\tinst0, inst1, inst2;\nint\tevaluate (int);\nvoid\tmemory_to_memory (void);\n\nvoid\tmemory_to_memory ()\n{\n\tinst0 = 0xc0000000 + evaluate (tokenix+1);\n\tinst1 = evaluate (tokenix+3);\n\tinst2 = evaluate (tokenix+5);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nvoid\tf_move (void);\nvoid\tstore_inst (void);\nint\treserved (char *, int);\nvoid\tblock_move (void);\nvoid\tregister_write (void);\nvoid\tmemory_to_memory (void);\n\nvoid\tf_move (void)\n{\n\tif (reserved (\"memory\", tokenix))\n\t\tmemory_to_memory ();\n\telse if (reserved (\"from\", tokenix) || tokens[tokenix+1].type == ',')\n\t\tblock_move ();\n\telse\n\t\tregister_write ();\n\tstore_inst ();\n}"
  },
  {
    "function_name": "store_inst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "771-795",
    "snippet": "void\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define\tMAXINST\t\t1024"
    ],
    "globals_used": [
      "unsigned long script[MAXINST];",
      "int\tdsps;",
      "unsigned long\tinst0, inst1, inst2;",
      "unsigned long\tninsts;",
      "FILE\t*listfp;",
      "void\terrout (char *);",
      "void\tstore_inst (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"\\n\""
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\" %08x\"",
            "inst2"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"\\t%04x: %08x %08x\"",
            "dsps",
            "inst0",
            "inst1"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Instruction table overflow\""
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXINST\t\t1024\n\nunsigned long script[MAXINST];\nint\tdsps;\nunsigned long\tinst0, inst1, inst2;\nunsigned long\tninsts;\nFILE\t*listfp;\nvoid\terrout (char *);\nvoid\tstore_inst (void);\n\nvoid\tstore_inst ()\n{\n\tint\ti = dsps / 4;\n\tint\tl = 8;\n\n\tif ((inst0 & 0xc0000000) == 0xc0000000)\n\t\tl = 12;\t\t\t/* Memory to memory move is 12 bytes */\n\tif ((dsps + l) / 4 > MAXINST) {\n\t\terrout (\"Instruction table overflow\");\n\t\treturn;\n\t}\n\tscript[i++] = inst0;\n\tscript[i++] = inst1;\n\tif (l == 12)\n\t\tscript[i] = inst2;\n\tif (listfp) {\n\t\tfprintf (listfp, \"\\t%04x: %08x %08x\", dsps, inst0, inst1);\n\t\tif (l == 12)\n\t\t\tfprintf (listfp, \" %08x\", inst2);\n\t\tfprintf (listfp, \"\\n\");\n\t}\n\tdsps += l;\n\tinst0 = inst1 = inst2 = 0;\n\t++ninsts;\n}"
  },
  {
    "function_name": "f_define",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "746-769",
    "snippet": "void\tf_define (void)\n{\n\tint\ti;\n\tchar\t*name;\n\tunsigned long value;\n\tint\ttype;\n\n\ttype = strcmpi (tokens[tokenix-1].name, \"ABSOLUTE\") ? S_RELATIVE : S_ABSOLUTE;\n\ti = tokenix;\n\twhile (i < ntokens) {\n\t\tif (tokens[i].type) {\n\t\t\terrout (\"Expected an identifier\");\n\t\t\treturn;\n\t\t}\n\t\tif (tokens[i + 1].type != '=') {\n\t\t\terrout (\"Expected a separator\");\n\t\t\treturn;\n\t\t}\n\t\tname = tokens[i].name;\n\t\ti += 2;\n\t\tvalue = expression (&i);\n\t\tdefine_symbol (name, value, type, F_DEFINED);\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define\tF_DEFINED\t0x0001",
      "#define\tS_RELATIVE\t0x0002",
      "#define\tS_ABSOLUTE\t0x0001",
      "#define strcmpi\tstrcasecmp"
    ],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\tntokens;",
      "int\ttokenix;",
      "void\tf_define (void);",
      "void\terrout (char *);",
      "void\tdefine_symbol (char *, unsigned long, short, short);",
      "int\texpression (int *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "define_symbol",
          "args": [
            "name",
            "value",
            "type",
            "F_DEFINED"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "define_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "461-498",
          "snippet": "void define_symbol (char *name, unsigned long value, short type, short flags)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (symbols[i].type == type && strcmp (symbols[i].name, name) == 0) {\n\t\t\tif (symbols[i].flags & F_DEFINED) {\n\t\t\t\terror_line();\n\t\t\t\tfprintf (errfp, \"*** Symbol \\\"%s\\\" multiply defined\\n\",\n\t\t\t\t\tname);\n\t\t\t} else {\n\t\t\t\tsymbols[i].flags |= flags;\n\t\t\t\tsymbols[i].value = value;\n\t\t\t\tp = symbols[i].patchlist;\n\t\t\t\twhile (p) {\n\t\t\t\t\tif (p->offset > dsps)\n\t\t\t\t\t\terrout (\"Whoops\\007\");\n\t\t\t\t\telse\n\t\t\t\t\t\tscript[p->offset / 4] = dsps - p->offset - 4;\n\t\t\t\t\tp = p->next;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn;\n\t}\n\tsymbols[nsymbols].type = type;\n\tsymbols[nsymbols].flags = flags;\n\tsymbols[nsymbols].value = value;\n\tsymbols[nsymbols].patchlist = NULL;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tF_DEFINED\t0x0001",
            "#define\tMAXSYMBOLS\t128"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "struct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];",
            "int nsymbols;",
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\tdefine_symbol (char *, unsigned long, short, short);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_DEFINED\t0x0001\n#define\tMAXSYMBOLS\t128\n\nunsigned long script[MAXINST];\nint\tdsps;\nstruct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];\nint nsymbols;\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\tdefine_symbol (char *, unsigned long, short, short);\nvoid\terror_line(void);\n\nvoid define_symbol (char *name, unsigned long value, short type, short flags)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (symbols[i].type == type && strcmp (symbols[i].name, name) == 0) {\n\t\t\tif (symbols[i].flags & F_DEFINED) {\n\t\t\t\terror_line();\n\t\t\t\tfprintf (errfp, \"*** Symbol \\\"%s\\\" multiply defined\\n\",\n\t\t\t\t\tname);\n\t\t\t} else {\n\t\t\t\tsymbols[i].flags |= flags;\n\t\t\t\tsymbols[i].value = value;\n\t\t\t\tp = symbols[i].patchlist;\n\t\t\t\twhile (p) {\n\t\t\t\t\tif (p->offset > dsps)\n\t\t\t\t\t\terrout (\"Whoops\\007\");\n\t\t\t\t\telse\n\t\t\t\t\t\tscript[p->offset / 4] = dsps - p->offset - 4;\n\t\t\t\t\tp = p->next;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn;\n\t}\n\tsymbols[nsymbols].type = type;\n\tsymbols[nsymbols].flags = flags;\n\tsymbols[nsymbols].value = value;\n\tsymbols[nsymbols].patchlist = NULL;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n}"
        }
      },
      {
        "call_info": {
          "callee": "expression",
          "args": [
            "&i"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "expression",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "572-589",
          "snippet": "int\texpression (int *t)\n{\n\tint\tvalue;\n\tint\ti = *t;\n\n\tvalue = evaluate (i++);\n\twhile (i < ntokens) {\n\t\tif (tokens[i].type == '+')\n\t\t\tvalue += evaluate (i + 1);\n\t\telse if (tokens[i].type == '-')\n\t\t\tvalue -= evaluate (i + 1);\n\t\telse\n\t\t\terrout (\"Unknown identifier\");\n\t\ti += 2;\n\t}\n\t*t = i;\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\tntokens;",
            "void\terrout (char *);",
            "int\texpression (int *);",
            "int\tevaluate (int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nvoid\terrout (char *);\nint\texpression (int *);\nint\tevaluate (int);\n\nint\texpression (int *t)\n{\n\tint\tvalue;\n\tint\ti = *t;\n\n\tvalue = evaluate (i++);\n\twhile (i < ntokens) {\n\t\tif (tokens[i].type == '+')\n\t\t\tvalue += evaluate (i + 1);\n\t\telse if (tokens[i].type == '-')\n\t\t\tvalue -= evaluate (i + 1);\n\t\telse\n\t\t\terrout (\"Unknown identifier\");\n\t\ti += 2;\n\t}\n\t*t = i;\n\treturn (value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected a separator\""
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmpi",
          "args": [
            "tokens[tokenix-1].name",
            "\"ABSOLUTE\""
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_DEFINED\t0x0001\n#define\tS_RELATIVE\t0x0002\n#define\tS_ABSOLUTE\t0x0001\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nvoid\tf_define (void);\nvoid\terrout (char *);\nvoid\tdefine_symbol (char *, unsigned long, short, short);\nint\texpression (int *);\n\nvoid\tf_define (void)\n{\n\tint\ti;\n\tchar\t*name;\n\tunsigned long value;\n\tint\ttype;\n\n\ttype = strcmpi (tokens[tokenix-1].name, \"ABSOLUTE\") ? S_RELATIVE : S_ABSOLUTE;\n\ti = tokenix;\n\twhile (i < ntokens) {\n\t\tif (tokens[i].type) {\n\t\t\terrout (\"Expected an identifier\");\n\t\t\treturn;\n\t\t}\n\t\tif (tokens[i + 1].type != '=') {\n\t\t\terrout (\"Expected a separator\");\n\t\t\treturn;\n\t\t}\n\t\tname = tokens[i].name;\n\t\ti += 2;\n\t\tvalue = expression (&i);\n\t\tdefine_symbol (name, value, type, F_DEFINED);\n\t}\n}"
  },
  {
    "function_name": "f_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "719-740",
    "snippet": "void\tf_list (void)\n{\n\tint\ti;\n\tshort\ttype;\n\tshort\tflags;\n\n\ttype = strcmpi (tokens[tokenix-1].name, \"ENTRY\") ? S_EXTERNAL : S_LABEL;\n\tflags = type == S_LABEL ? F_ENTRY : 0;\n\tfor (i = tokenix; i < ntokens; ++i) {\n\t\tif (tokens[i].type != 0) {\n\t\t\terrout (\"Expected an identifier\");\n\t\t\treturn;\n\t\t}\n\t\tdefine_symbol (tokens[i].name, 0, type, flags);\n\t\tif (i + 1 < ntokens) {\n\t\t\tif (tokens[++i].type == ',')\n\t\t\t\tcontinue;\n\t\t\terrout (\"Expected a separator\");\n\t\t\treturn;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define\tF_ENTRY\t\t0x0002",
      "#define\tS_EXTERNAL\t0x0003",
      "#define\tS_LABEL\t\t0x0000",
      "#define strcmpi\tstrcasecmp"
    ],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\tntokens;",
      "int\ttokenix;",
      "void\tf_list (void);",
      "void\terrout (char *);",
      "void\tdefine_symbol (char *, unsigned long, short, short);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected a separator\""
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "define_symbol",
          "args": [
            "tokens[i].name",
            "0",
            "type",
            "flags"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "define_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "461-498",
          "snippet": "void define_symbol (char *name, unsigned long value, short type, short flags)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (symbols[i].type == type && strcmp (symbols[i].name, name) == 0) {\n\t\t\tif (symbols[i].flags & F_DEFINED) {\n\t\t\t\terror_line();\n\t\t\t\tfprintf (errfp, \"*** Symbol \\\"%s\\\" multiply defined\\n\",\n\t\t\t\t\tname);\n\t\t\t} else {\n\t\t\t\tsymbols[i].flags |= flags;\n\t\t\t\tsymbols[i].value = value;\n\t\t\t\tp = symbols[i].patchlist;\n\t\t\t\twhile (p) {\n\t\t\t\t\tif (p->offset > dsps)\n\t\t\t\t\t\terrout (\"Whoops\\007\");\n\t\t\t\t\telse\n\t\t\t\t\t\tscript[p->offset / 4] = dsps - p->offset - 4;\n\t\t\t\t\tp = p->next;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn;\n\t}\n\tsymbols[nsymbols].type = type;\n\tsymbols[nsymbols].flags = flags;\n\tsymbols[nsymbols].value = value;\n\tsymbols[nsymbols].patchlist = NULL;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tF_DEFINED\t0x0001",
            "#define\tMAXSYMBOLS\t128"
          ],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "struct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];",
            "int nsymbols;",
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\tdefine_symbol (char *, unsigned long, short, short);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_DEFINED\t0x0001\n#define\tMAXSYMBOLS\t128\n\nunsigned long script[MAXINST];\nint\tdsps;\nstruct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];\nint nsymbols;\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\tdefine_symbol (char *, unsigned long, short, short);\nvoid\terror_line(void);\n\nvoid define_symbol (char *name, unsigned long value, short type, short flags)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (symbols[i].type == type && strcmp (symbols[i].name, name) == 0) {\n\t\t\tif (symbols[i].flags & F_DEFINED) {\n\t\t\t\terror_line();\n\t\t\t\tfprintf (errfp, \"*** Symbol \\\"%s\\\" multiply defined\\n\",\n\t\t\t\t\tname);\n\t\t\t} else {\n\t\t\t\tsymbols[i].flags |= flags;\n\t\t\t\tsymbols[i].value = value;\n\t\t\t\tp = symbols[i].patchlist;\n\t\t\t\twhile (p) {\n\t\t\t\t\tif (p->offset > dsps)\n\t\t\t\t\t\terrout (\"Whoops\\007\");\n\t\t\t\t\telse\n\t\t\t\t\t\tscript[p->offset / 4] = dsps - p->offset - 4;\n\t\t\t\t\tp = p->next;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn;\n\t}\n\tsymbols[nsymbols].type = type;\n\tsymbols[nsymbols].flags = flags;\n\tsymbols[nsymbols].value = value;\n\tsymbols[nsymbols].patchlist = NULL;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmpi",
          "args": [
            "tokens[tokenix-1].name",
            "\"ENTRY\""
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_ENTRY\t\t0x0002\n#define\tS_EXTERNAL\t0x0003\n#define\tS_LABEL\t\t0x0000\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nvoid\tf_list (void);\nvoid\terrout (char *);\nvoid\tdefine_symbol (char *, unsigned long, short, short);\n\nvoid\tf_list (void)\n{\n\tint\ti;\n\tshort\ttype;\n\tshort\tflags;\n\n\ttype = strcmpi (tokens[tokenix-1].name, \"ENTRY\") ? S_EXTERNAL : S_LABEL;\n\tflags = type == S_LABEL ? F_ENTRY : 0;\n\tfor (i = tokenix; i < ntokens; ++i) {\n\t\tif (tokens[i].type != 0) {\n\t\t\terrout (\"Expected an identifier\");\n\t\t\treturn;\n\t\t}\n\t\tdefine_symbol (tokens[i].name, 0, type, flags);\n\t\tif (i + 1 < ntokens) {\n\t\t\tif (tokens[++i].type == ',')\n\t\t\t\tcontinue;\n\t\t\terrout (\"Expected a separator\");\n\t\t\treturn;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "f_pass",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "710-713",
    "snippet": "void\tf_pass (void)\n{\n\terrout (\"PASS option not implemented\");\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tf_pass (void);",
      "void\terrout (char *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"PASS option not implemented\""
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nvoid\tf_pass (void);\nvoid\terrout (char *);\n\nvoid\tf_pass (void)\n{\n\terrout (\"PASS option not implemented\");\n}"
  },
  {
    "function_name": "f_proc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "702-708",
    "snippet": "void\tf_proc (void)\n{\n\tif (tokens[tokenix].type != 0 || tokens[tokenix + 1].type != ':')\n\t\terrout (\"Invalid PROC statement\");\n\telse\n\t\tnew_script (tokens[tokenix].name);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\ttokenix;",
      "void\tf_proc (void);",
      "void\terrout (char *);",
      "void\tnew_script (char *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "new_script",
          "args": [
            "tokens[tokenix].name"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "new_script",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "525-530",
          "snippet": "void new_script (char *name)\n{\n\tclose_script ();\n\tscript_name = malloc (strlen (name) + 1);\n\tstrcpy (script_name, name);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "char\t*script_name = \"SCRIPT\";",
            "void\tclose_script (void);",
            "void\tnew_script (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nchar\t*script_name = \"SCRIPT\";\nvoid\tclose_script (void);\nvoid\tnew_script (char *);\n\nvoid new_script (char *name)\n{\n\tclose_script ();\n\tscript_name = malloc (strlen (name) + 1);\n\tstrcpy (script_name, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Invalid PROC statement\""
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nvoid\tf_proc (void);\nvoid\terrout (char *);\nvoid\tnew_script (char *);\n\nvoid\tf_proc (void)\n{\n\tif (tokens[tokenix].type != 0 || tokens[tokenix + 1].type != ':')\n\t\terrout (\"Invalid PROC statement\");\n\telse\n\t\tnew_script (tokens[tokenix].name);\n}"
  },
  {
    "function_name": "f_arch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "687-700",
    "snippet": "void\tf_arch (void)\n{\n\tint i, archsave;\n\n\ti = tokenix;\n\n\tarchsave = arch;\n\tarch = 0;\n\tarch = atoi(tokens[i].name);\n\tif( arch != 710 && arch != 720) {\n\t\terrout(\"Unrecognized ARCH\");\n\t\tarch = archsave;\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\ttokenix;",
      "void\tf_arch (void);",
      "int\tarch;",
      "void\terrout (char *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Unrecognized ARCH\""
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "tokens[i].name"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "rf_atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_utils.c",
          "lines": "124-137",
          "snippet": "int \nrf_atoi(p)\n\tchar   *p;\n{\n\tint     val = 0, negate = 0;\n\n\tif (*p == '-') {\n\t\tnegate = 1;\n\t\tp++;\n\t}\n\tfor (; ISDIGIT(*p); p++)\n\t\tval = 10 * val + (*p - '0');\n\treturn ((negate) ? -val : val);\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_alloclist.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_utils.h\"",
            "#include <sys/time.h>",
            "#include \"rf_threadstuff.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_alloclist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_utils.h\"\n#include <sys/time.h>\n#include \"rf_threadstuff.h\"\n\nint \nrf_atoi(p)\n\tchar   *p;\n{\n\tint     val = 0, negate = 0;\n\n\tif (*p == '-') {\n\t\tnegate = 1;\n\t\tp++;\n\t}\n\tfor (; ISDIGIT(*p); p++)\n\t\tval = 10 * val + (*p - '0');\n\treturn ((negate) ? -val : val);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nvoid\tf_arch (void);\nint\tarch;\nvoid\terrout (char *);\n\nvoid\tf_arch (void)\n{\n\tint i, archsave;\n\n\ti = tokenix;\n\n\tarchsave = arch;\n\tarch = 0;\n\tarch = atoi(tokens[i].name);\n\tif( arch != 710 && arch != 720) {\n\t\terrout(\"Unrecognized ARCH\");\n\t\tarch = archsave;\n\t}\n}"
  },
  {
    "function_name": "lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "651-685",
    "snippet": "int\tlookup (char *name)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (strcmp (name, symbols[i].name) == 0) {\n\t\t\tif ((symbols[i].flags & F_DEFINED) == 0) {\n\t\t\t\tp = (struct patchlist *) &symbols[i].patchlist;\n\t\t\t\twhile (p->next)\n\t\t\t\t\tp = p->next;\n\t\t\t\tp->next = (struct patchlist *) malloc (sizeof (struct patchlist));\n\t\t\t\tp = p->next;\n\t\t\t\tp->next = NULL;\n\t\t\t\tp->offset = dsps + 4;\n\t\t\t}\n\t\t\treturn ((int) symbols[i].value);\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn (0);\n\t}\n\tsymbols[nsymbols].type = S_LABEL;\t/* assume forward reference */\n\tsymbols[nsymbols].flags = 0;\n\tsymbols[nsymbols].value = 0;\n\tp = (struct patchlist *) malloc (sizeof (struct patchlist));\n\tsymbols[nsymbols].patchlist = p;\n\tp->next = NULL;\n\tp->offset = dsps + 4;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n\treturn (0);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define\tF_DEFINED\t0x0001",
      "#define\tS_LABEL\t\t0x0000",
      "#define\tMAXSYMBOLS\t128"
    ],
    "globals_used": [
      "int\tdsps;",
      "struct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];",
      "int nsymbols;",
      "void\terrout (char *);",
      "int\tlookup (char *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "symbols[nsymbols].name",
            "name"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "strlen (name) + 1"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Symbol table full\""
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "symbols[i].name"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_DEFINED\t0x0001\n#define\tS_LABEL\t\t0x0000\n#define\tMAXSYMBOLS\t128\n\nint\tdsps;\nstruct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];\nint nsymbols;\nvoid\terrout (char *);\nint\tlookup (char *);\n\nint\tlookup (char *name)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (strcmp (name, symbols[i].name) == 0) {\n\t\t\tif ((symbols[i].flags & F_DEFINED) == 0) {\n\t\t\t\tp = (struct patchlist *) &symbols[i].patchlist;\n\t\t\t\twhile (p->next)\n\t\t\t\t\tp = p->next;\n\t\t\t\tp->next = (struct patchlist *) malloc (sizeof (struct patchlist));\n\t\t\t\tp = p->next;\n\t\t\t\tp->next = NULL;\n\t\t\t\tp->offset = dsps + 4;\n\t\t\t}\n\t\t\treturn ((int) symbols[i].value);\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn (0);\n\t}\n\tsymbols[nsymbols].type = S_LABEL;\t/* assume forward reference */\n\tsymbols[nsymbols].flags = 0;\n\tsymbols[nsymbols].value = 0;\n\tp = (struct patchlist *) malloc (sizeof (struct patchlist));\n\tsymbols[nsymbols].patchlist = p;\n\tp->next = NULL;\n\tp->offset = dsps + 4;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n\treturn (0);\n}"
  },
  {
    "function_name": "number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "608-649",
    "snippet": "int\tnumber (char *s)\n{\n\tint\tvalue;\n\tint\tn;\n\tint\tradix;\n\n\tradix = 10;\n\tif (*s == '0') {\n\t\t++s;\n\t\tradix = 8;\n\t\tswitch (*s) {\n\t\tcase 'x':\n\t\tcase 'X':\n\t\t\tradix = 16;\n\t\t\tbreak;\n\t\tcase 'b':\n\t\tcase 'B':\n\t\t\tradix = 2;\n\t\t}\n\t\tif (radix != 8)\n\t\t\t++s;\n\t}\n\tvalue = 0;\n\twhile (*s) {\n\t\tn = *s++;\n\t\tif (n >= '0' && n <= '9')\n\t\t\tn -= '0';\n\t\telse if (n >= 'a' && n <= 'f')\n\t\t\tn -= 'a' - 10;\n\t\telse if (n >= 'A' && n <= 'F')\n\t\t\tn -= 'A' - 10;\n\t\telse {\n\t\t\terror_line();\n\t\t\tfprintf (errfp, \"*** Expected digit\\n\", n = 0);\n\t\t}\n\t\tif (n >= radix)\n\t\t\terrout (\"Expected digit\");\n\t\telse\n\t\t\tvalue = value * radix + n;\n\t}\n\treturn (value);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "FILE\t*errfp;",
      "void\terrout (char *);",
      "int\tnumber (char *);",
      "void\terror_line(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected digit\""
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "errfp",
            "\"*** Expected digit\\n\"",
            "n = 0"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_line",
          "args": [],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "error_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "1128-1134",
          "snippet": "void\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tlineno;",
            "int\terr_listed;",
            "char\tinbuf[128];",
            "FILE\t*listfp;",
            "FILE\t*errfp;",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tlineno;\nint\terr_listed;\nchar\tinbuf[128];\nFILE\t*listfp;\nFILE\t*errfp;\nvoid\terror_line(void);\n\nvoid\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nint\tnumber (char *);\nvoid\terror_line(void);\n\nint\tnumber (char *s)\n{\n\tint\tvalue;\n\tint\tn;\n\tint\tradix;\n\n\tradix = 10;\n\tif (*s == '0') {\n\t\t++s;\n\t\tradix = 8;\n\t\tswitch (*s) {\n\t\tcase 'x':\n\t\tcase 'X':\n\t\t\tradix = 16;\n\t\t\tbreak;\n\t\tcase 'b':\n\t\tcase 'B':\n\t\t\tradix = 2;\n\t\t}\n\t\tif (radix != 8)\n\t\t\t++s;\n\t}\n\tvalue = 0;\n\twhile (*s) {\n\t\tn = *s++;\n\t\tif (n >= '0' && n <= '9')\n\t\t\tn -= '0';\n\t\telse if (n >= 'a' && n <= 'f')\n\t\t\tn -= 'a' - 10;\n\t\telse if (n >= 'A' && n <= 'F')\n\t\t\tn -= 'A' - 10;\n\t\telse {\n\t\t\terror_line();\n\t\t\tfprintf (errfp, \"*** Expected digit\\n\", n = 0);\n\t\t}\n\t\tif (n >= radix)\n\t\t\terrout (\"Expected digit\");\n\t\telse\n\t\t\tvalue = value * radix + n;\n\t}\n\treturn (value);\n}"
  },
  {
    "function_name": "evaluate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "591-606",
    "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "void\terrout (char *);",
      "int\tevaluate (int);",
      "int\tnumber (char *);",
      "int\tlookup (char *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lookup",
          "args": [
            "name"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "651-685",
          "snippet": "int\tlookup (char *name)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (strcmp (name, symbols[i].name) == 0) {\n\t\t\tif ((symbols[i].flags & F_DEFINED) == 0) {\n\t\t\t\tp = (struct patchlist *) &symbols[i].patchlist;\n\t\t\t\twhile (p->next)\n\t\t\t\t\tp = p->next;\n\t\t\t\tp->next = (struct patchlist *) malloc (sizeof (struct patchlist));\n\t\t\t\tp = p->next;\n\t\t\t\tp->next = NULL;\n\t\t\t\tp->offset = dsps + 4;\n\t\t\t}\n\t\t\treturn ((int) symbols[i].value);\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn (0);\n\t}\n\tsymbols[nsymbols].type = S_LABEL;\t/* assume forward reference */\n\tsymbols[nsymbols].flags = 0;\n\tsymbols[nsymbols].value = 0;\n\tp = (struct patchlist *) malloc (sizeof (struct patchlist));\n\tsymbols[nsymbols].patchlist = p;\n\tp->next = NULL;\n\tp->offset = dsps + 4;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define\tF_DEFINED\t0x0001",
            "#define\tS_LABEL\t\t0x0000",
            "#define\tMAXSYMBOLS\t128"
          ],
          "globals_used": [
            "int\tdsps;",
            "struct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];",
            "int nsymbols;",
            "void\terrout (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_DEFINED\t0x0001\n#define\tS_LABEL\t\t0x0000\n#define\tMAXSYMBOLS\t128\n\nint\tdsps;\nstruct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];\nint nsymbols;\nvoid\terrout (char *);\nint\tlookup (char *);\n\nint\tlookup (char *name)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (strcmp (name, symbols[i].name) == 0) {\n\t\t\tif ((symbols[i].flags & F_DEFINED) == 0) {\n\t\t\t\tp = (struct patchlist *) &symbols[i].patchlist;\n\t\t\t\twhile (p->next)\n\t\t\t\t\tp = p->next;\n\t\t\t\tp->next = (struct patchlist *) malloc (sizeof (struct patchlist));\n\t\t\t\tp = p->next;\n\t\t\t\tp->next = NULL;\n\t\t\t\tp->offset = dsps + 4;\n\t\t\t}\n\t\t\treturn ((int) symbols[i].value);\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn (0);\n\t}\n\tsymbols[nsymbols].type = S_LABEL;\t/* assume forward reference */\n\tsymbols[nsymbols].flags = 0;\n\tsymbols[nsymbols].value = 0;\n\tp = (struct patchlist *) malloc (sizeof (struct patchlist));\n\tsymbols[nsymbols].patchlist = p;\n\tp->next = NULL;\n\tp->offset = dsps + 4;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "number",
          "args": [
            "name"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "number",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "608-649",
          "snippet": "int\tnumber (char *s)\n{\n\tint\tvalue;\n\tint\tn;\n\tint\tradix;\n\n\tradix = 10;\n\tif (*s == '0') {\n\t\t++s;\n\t\tradix = 8;\n\t\tswitch (*s) {\n\t\tcase 'x':\n\t\tcase 'X':\n\t\t\tradix = 16;\n\t\t\tbreak;\n\t\tcase 'b':\n\t\tcase 'B':\n\t\t\tradix = 2;\n\t\t}\n\t\tif (radix != 8)\n\t\t\t++s;\n\t}\n\tvalue = 0;\n\twhile (*s) {\n\t\tn = *s++;\n\t\tif (n >= '0' && n <= '9')\n\t\t\tn -= '0';\n\t\telse if (n >= 'a' && n <= 'f')\n\t\t\tn -= 'a' - 10;\n\t\telse if (n >= 'A' && n <= 'F')\n\t\t\tn -= 'A' - 10;\n\t\telse {\n\t\t\terror_line();\n\t\t\tfprintf (errfp, \"*** Expected digit\\n\", n = 0);\n\t\t}\n\t\tif (n >= radix)\n\t\t\terrout (\"Expected digit\");\n\t\telse\n\t\t\tvalue = value * radix + n;\n\t}\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "int\tnumber (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nint\tnumber (char *);\nvoid\terror_line(void);\n\nint\tnumber (char *s)\n{\n\tint\tvalue;\n\tint\tn;\n\tint\tradix;\n\n\tradix = 10;\n\tif (*s == '0') {\n\t\t++s;\n\t\tradix = 8;\n\t\tswitch (*s) {\n\t\tcase 'x':\n\t\tcase 'X':\n\t\t\tradix = 16;\n\t\t\tbreak;\n\t\tcase 'b':\n\t\tcase 'B':\n\t\t\tradix = 2;\n\t\t}\n\t\tif (radix != 8)\n\t\t\t++s;\n\t}\n\tvalue = 0;\n\twhile (*s) {\n\t\tn = *s++;\n\t\tif (n >= '0' && n <= '9')\n\t\t\tn -= '0';\n\t\telse if (n >= 'a' && n <= 'f')\n\t\t\tn -= 'a' - 10;\n\t\telse if (n >= 'A' && n <= 'F')\n\t\t\tn -= 'A' - 10;\n\t\telse {\n\t\t\terror_line();\n\t\t\tfprintf (errfp, \"*** Expected digit\\n\", n = 0);\n\t\t}\n\t\tif (n >= radix)\n\t\t\terrout (\"Expected digit\");\n\t\telse\n\t\t\tvalue = value * radix + n;\n\t}\n\treturn (value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Expected an identifier\""
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
  },
  {
    "function_name": "expression",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "572-589",
    "snippet": "int\texpression (int *t)\n{\n\tint\tvalue;\n\tint\ti = *t;\n\n\tvalue = evaluate (i++);\n\twhile (i < ntokens) {\n\t\tif (tokens[i].type == '+')\n\t\t\tvalue += evaluate (i + 1);\n\t\telse if (tokens[i].type == '-')\n\t\t\tvalue -= evaluate (i + 1);\n\t\telse\n\t\t\terrout (\"Unknown identifier\");\n\t\ti += 2;\n\t}\n\t*t = i;\n\treturn (value);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\tntokens;",
      "void\terrout (char *);",
      "int\texpression (int *);",
      "int\tevaluate (int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Unknown identifier\""
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "i + 1"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "591-606",
          "snippet": "int\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "void\terrout (char *);",
            "int\tevaluate (int);",
            "int\tnumber (char *);",
            "int\tlookup (char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nvoid\terrout (char *);\nint\tevaluate (int);\nint\tnumber (char *);\nint\tlookup (char *);\n\nint\tevaluate (t)\n{\n\tint\tvalue;\n\tchar\t*name;\n\n\tif (tokens[t].type) {\n\t\terrout (\"Expected an identifier\");\n\t\treturn (0);\n\t}\n\tname = tokens[t].name;\n\tif (*name >= '0' && *name <= '9')\n\t\tvalue = number (name);\n\telse\n\t\tvalue = lookup (name);\n\treturn (value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nvoid\terrout (char *);\nint\texpression (int *);\nint\tevaluate (int);\n\nint\texpression (int *t)\n{\n\tint\tvalue;\n\tint\ti = *t;\n\n\tvalue = evaluate (i++);\n\twhile (i < ntokens) {\n\t\tif (tokens[i].type == '+')\n\t\t\tvalue += evaluate (i + 1);\n\t\telse if (tokens[i].type == '-')\n\t\t\tvalue -= evaluate (i + 1);\n\t\telse\n\t\t\terrout (\"Unknown identifier\");\n\t\ti += 2;\n\t}\n\t*t = i;\n\treturn (value);\n}"
  },
  {
    "function_name": "CheckRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "552-570",
    "snippet": "int\tCheckRegister (int t)\n{\n\tint\ti;\n\n\tif(arch == 710) {\n\t\tfor (i = 0; i < 64; ++i)\n\t\t\tif (reserved (regs710[i], t))\n\t\t\t\treturn i;\n\t}\n\telse if (arch == 720) {\n\t\tfor (i = 0; i < 96; ++i)\n\t\t\tif (reserved (regs720[i], t))\n\t\t\t\treturn i;\n\t}\n\telse {\n\t\terrout(\"'ARCH' statement missing\");\n\t}\n\treturn (-1);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "char\t*regs710[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"sdid\",\t\t\"sien\",\n\t\"scid\",\t\t\"sxfer\",\t\"sodl\",\t\t\"socl\",\n\t\"sfbr\",\t\t\"sidl\",\t\t\"sbdl\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\t\"ctest7\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"istat\",\t\"ctest8\",\t\"lcrc\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratch0\",\t\"scratch1\",\t\"scratch2\",\t\"scratch3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\"\n};",
      "char\t*regs720[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"scntl2\",\t\"scntl3\",\n\t\"scid\",\t\t\"sxfer\",\t\"sdid\",\t\t\"gpreg\",\n\t\"sfbr\",\t\t\"socl\",\t\t\"ssid\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"istat\",\t\"\",\t\t\"\",\t\t\"\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratcha0\",\t\"scratcha1\",\t\"scratcha2\",\t\"scratcha3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\",\n\t\"sien0\",\t\"sien1\",\t\"sist0\",\t\"sist1\",\n\t\"slpar\",\t\"swide\",\t\"macntl\",\t\"gpcntl\",\n\t\"stime0\",\t\"stime1\",\t\"respid0\",\t\"respid1\",\n\t\"stest0\",\t\"stest1\",\t\"stest2\",\t\"stest3\",\n\t\"sidl0\",\t\"sidl1\",\t\"\",\t\t\"\",\n\t\"sodl0\",\t\"sodl1\",\t\"\",\t\t\"\",\n\t\"sbdl0\",\t\"sbdl1\",\t\"\",\t\t\"\",\n\t\"scratchb0\",\t\"scratchb1\",\t\"scratchb2\",\t\"scratchb3\",\n};",
      "int\tarch;",
      "void\terrout (char *);",
      "int\treserved (char *, int);",
      "int\tCheckRegister (int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"'ARCH' statement missing\""
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "regs720[i]",
            "t"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nchar\t*regs710[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"sdid\",\t\t\"sien\",\n\t\"scid\",\t\t\"sxfer\",\t\"sodl\",\t\t\"socl\",\n\t\"sfbr\",\t\t\"sidl\",\t\t\"sbdl\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\t\"ctest7\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"istat\",\t\"ctest8\",\t\"lcrc\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratch0\",\t\"scratch1\",\t\"scratch2\",\t\"scratch3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\"\n};\nchar\t*regs720[] = {\n\t\"scntl0\",\t\"scntl1\",\t\"scntl2\",\t\"scntl3\",\n\t\"scid\",\t\t\"sxfer\",\t\"sdid\",\t\t\"gpreg\",\n\t\"sfbr\",\t\t\"socl\",\t\t\"ssid\",\t\t\"sbcl\",\n\t\"dstat\",\t\"sstat0\",\t\"sstat1\",\t\"sstat2\",\n\t\"dsa0\",\t\t\"dsa1\",\t\t\"dsa2\",\t\t\"dsa3\",\n\t\"istat\",\t\"\",\t\t\"\",\t\t\"\",\n\t\"ctest0\",\t\"ctest1\",\t\"ctest2\",\t\"ctest3\",\n\t\"temp0\",\t\"temp1\",\t\"temp2\",\t\"temp3\",\n\t\"dfifo\",\t\"ctest4\",\t\"ctest5\",\t\"ctest6\",\n\t\"dbc0\",\t\t\"dbc1\",\t\t\"dbc2\",\t\t\"dcmd\",\n\t\"dnad0\",\t\"dnad1\",\t\"dnad2\",\t\"dnad3\",\n\t\"dsp0\",\t\t\"dsp1\",\t\t\"dsp2\",\t\t\"dsp3\",\n\t\"dsps0\",\t\"dsps1\",\t\"dsps2\",\t\"dsps3\",\n\t\"scratcha0\",\t\"scratcha1\",\t\"scratcha2\",\t\"scratcha3\",\n\t\"dmode\",\t\"dien\",\t\t\"dwt\",\t\t\"dcntl\",\n\t\"addr0\",\t\"addr1\",\t\"addr2\",\t\"addr3\",\n\t\"sien0\",\t\"sien1\",\t\"sist0\",\t\"sist1\",\n\t\"slpar\",\t\"swide\",\t\"macntl\",\t\"gpcntl\",\n\t\"stime0\",\t\"stime1\",\t\"respid0\",\t\"respid1\",\n\t\"stest0\",\t\"stest1\",\t\"stest2\",\t\"stest3\",\n\t\"sidl0\",\t\"sidl1\",\t\"\",\t\t\"\",\n\t\"sodl0\",\t\"sodl1\",\t\"\",\t\t\"\",\n\t\"sbdl0\",\t\"sbdl1\",\t\"\",\t\t\"\",\n\t\"scratchb0\",\t\"scratchb1\",\t\"scratchb2\",\t\"scratchb3\",\n};\nint\tarch;\nvoid\terrout (char *);\nint\treserved (char *, int);\nint\tCheckRegister (int);\n\nint\tCheckRegister (int t)\n{\n\tint\ti;\n\n\tif(arch == 710) {\n\t\tfor (i = 0; i < 64; ++i)\n\t\t\tif (reserved (regs710[i], t))\n\t\t\t\treturn i;\n\t}\n\telse if (arch == 720) {\n\t\tfor (i = 0; i < 96; ++i)\n\t\t\tif (reserved (regs720[i], t))\n\t\t\t\treturn i;\n\t}\n\telse {\n\t\terrout(\"'ARCH' statement missing\");\n\t}\n\treturn (-1);\n}"
  },
  {
    "function_name": "CheckPhase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "539-550",
    "snippet": "int\tCheckPhase (int t)\n{\n\tint\ti;\n\n\tfor (i = 0; i < 8; ++i) {\n\t\tif (reserved (phases[i], t)) {\n\t\t\tinst0 |= i << 24;\n\t\t\treturn (1);\n\t\t}\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "char\t*phases[] = {\n\t\"data_out\", \"data_in\", \"cmd\", \"status\",\n\t\"res4\", \"res5\", \"msg_out\", \"msg_in\"\n};",
      "int\treserved (char *, int);",
      "int\tCheckPhase (int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "reserved",
          "args": [
            "phases[i]",
            "t"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "reserved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "532-537",
          "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define strcmpi\tstrcasecmp"
          ],
          "globals_used": [
            "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
            "int\treserved (char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nchar\t*phases[] = {\n\t\"data_out\", \"data_in\", \"cmd\", \"status\",\n\t\"res4\", \"res5\", \"msg_out\", \"msg_in\"\n};\nint\treserved (char *, int);\nint\tCheckPhase (int);\n\nint\tCheckPhase (int t)\n{\n\tint\ti;\n\n\tfor (i = 0; i < 8; ++i) {\n\t\tif (reserved (phases[i], t)) {\n\t\t\tinst0 |= i << 24;\n\t\t\treturn (1);\n\t\t}\n\t}\n\treturn (0);\n}"
  },
  {
    "function_name": "reserved",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "532-537",
    "snippet": "int\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define strcmpi\tstrcasecmp"
    ],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\treserved (char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmpi",
          "args": [
            "tokens[t].name",
            "string"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\treserved (char *, int);\n\nint\treserved (char *string, int t)\n{\n\tif (tokens[t].type == 0 && strcmpi (tokens[t].name, string) == 0)\n\t\treturn (1);\n\treturn (0);\n}"
  },
  {
    "function_name": "new_script",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "525-530",
    "snippet": "void new_script (char *name)\n{\n\tclose_script ();\n\tscript_name = malloc (strlen (name) + 1);\n\tstrcpy (script_name, name);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "char\t*script_name = \"SCRIPT\";",
      "void\tclose_script (void);",
      "void\tnew_script (char *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "script_name",
            "name"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "strlen (name) + 1"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close_script",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "close_script",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "500-523",
          "snippet": "void close_script ()\n{\n\tint\ti;\n\n\tif (dsps == 0)\n\t\treturn;\n\tif (outfp) {\n\t\tfprintf (outfp, \"unsigned long %s[] = {\\n\", script_name);\n\t\tfor (i = 0; i < dsps / 4; i += 2) {\n\t\t\tfprintf (outfp, \"\\t0x%08x, 0x%08x\", script[i],\n\t\t\t\tscript[i + 1]);\n\t\t\t/* check for memory move instruction */\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\tfprintf (outfp, \", 0x%08x,\", script[i + 2]);\n\t\t\telse\n\t\t\t\tif ((i + 2) <= dsps / 4) fprintf (outfp, \",\\t\\t\");\n\t\t\tfprintf (outfp, \"\\t/* %03x - %3d */\\n\", i * 4, i * 4);\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\t++i;\n\t\t}\n\t\tfprintf (outfp, \"};\\n\\n\");\n\t}\n\tdsps = 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long script[MAXINST];",
            "int\tdsps;",
            "char\t*script_name = \"SCRIPT\";",
            "FILE\t*outfp;",
            "void\tclose_script (void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nunsigned long script[MAXINST];\nint\tdsps;\nchar\t*script_name = \"SCRIPT\";\nFILE\t*outfp;\nvoid\tclose_script (void);\n\nvoid close_script ()\n{\n\tint\ti;\n\n\tif (dsps == 0)\n\t\treturn;\n\tif (outfp) {\n\t\tfprintf (outfp, \"unsigned long %s[] = {\\n\", script_name);\n\t\tfor (i = 0; i < dsps / 4; i += 2) {\n\t\t\tfprintf (outfp, \"\\t0x%08x, 0x%08x\", script[i],\n\t\t\t\tscript[i + 1]);\n\t\t\t/* check for memory move instruction */\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\tfprintf (outfp, \", 0x%08x,\", script[i + 2]);\n\t\t\telse\n\t\t\t\tif ((i + 2) <= dsps / 4) fprintf (outfp, \",\\t\\t\");\n\t\t\tfprintf (outfp, \"\\t/* %03x - %3d */\\n\", i * 4, i * 4);\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\t++i;\n\t\t}\n\t\tfprintf (outfp, \"};\\n\\n\");\n\t}\n\tdsps = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nchar\t*script_name = \"SCRIPT\";\nvoid\tclose_script (void);\nvoid\tnew_script (char *);\n\nvoid new_script (char *name)\n{\n\tclose_script ();\n\tscript_name = malloc (strlen (name) + 1);\n\tstrcpy (script_name, name);\n}"
  },
  {
    "function_name": "close_script",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "500-523",
    "snippet": "void close_script ()\n{\n\tint\ti;\n\n\tif (dsps == 0)\n\t\treturn;\n\tif (outfp) {\n\t\tfprintf (outfp, \"unsigned long %s[] = {\\n\", script_name);\n\t\tfor (i = 0; i < dsps / 4; i += 2) {\n\t\t\tfprintf (outfp, \"\\t0x%08x, 0x%08x\", script[i],\n\t\t\t\tscript[i + 1]);\n\t\t\t/* check for memory move instruction */\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\tfprintf (outfp, \", 0x%08x,\", script[i + 2]);\n\t\t\telse\n\t\t\t\tif ((i + 2) <= dsps / 4) fprintf (outfp, \",\\t\\t\");\n\t\t\tfprintf (outfp, \"\\t/* %03x - %3d */\\n\", i * 4, i * 4);\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\t++i;\n\t\t}\n\t\tfprintf (outfp, \"};\\n\\n\");\n\t}\n\tdsps = 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long script[MAXINST];",
      "int\tdsps;",
      "char\t*script_name = \"SCRIPT\";",
      "FILE\t*outfp;",
      "void\tclose_script (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"};\\n\\n\""
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"\\t/* %03x - %3d */\\n\"",
            "i * 4",
            "i * 4"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\",\\t\\t\""
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\", 0x%08x,\"",
            "script[i + 2]"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"\\t0x%08x, 0x%08x\"",
            "script[i]",
            "script[i + 1]"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"unsigned long %s[] = {\\n\"",
            "script_name"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nunsigned long script[MAXINST];\nint\tdsps;\nchar\t*script_name = \"SCRIPT\";\nFILE\t*outfp;\nvoid\tclose_script (void);\n\nvoid close_script ()\n{\n\tint\ti;\n\n\tif (dsps == 0)\n\t\treturn;\n\tif (outfp) {\n\t\tfprintf (outfp, \"unsigned long %s[] = {\\n\", script_name);\n\t\tfor (i = 0; i < dsps / 4; i += 2) {\n\t\t\tfprintf (outfp, \"\\t0x%08x, 0x%08x\", script[i],\n\t\t\t\tscript[i + 1]);\n\t\t\t/* check for memory move instruction */\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\tfprintf (outfp, \", 0x%08x,\", script[i + 2]);\n\t\t\telse\n\t\t\t\tif ((i + 2) <= dsps / 4) fprintf (outfp, \",\\t\\t\");\n\t\t\tfprintf (outfp, \"\\t/* %03x - %3d */\\n\", i * 4, i * 4);\n\t\t\tif (script[i] >> 30 == 3)\n\t\t\t\t++i;\n\t\t}\n\t\tfprintf (outfp, \"};\\n\\n\");\n\t}\n\tdsps = 0;\n}"
  },
  {
    "function_name": "define_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "461-498",
    "snippet": "void define_symbol (char *name, unsigned long value, short type, short flags)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (symbols[i].type == type && strcmp (symbols[i].name, name) == 0) {\n\t\t\tif (symbols[i].flags & F_DEFINED) {\n\t\t\t\terror_line();\n\t\t\t\tfprintf (errfp, \"*** Symbol \\\"%s\\\" multiply defined\\n\",\n\t\t\t\t\tname);\n\t\t\t} else {\n\t\t\t\tsymbols[i].flags |= flags;\n\t\t\t\tsymbols[i].value = value;\n\t\t\t\tp = symbols[i].patchlist;\n\t\t\t\twhile (p) {\n\t\t\t\t\tif (p->offset > dsps)\n\t\t\t\t\t\terrout (\"Whoops\\007\");\n\t\t\t\t\telse\n\t\t\t\t\t\tscript[p->offset / 4] = dsps - p->offset - 4;\n\t\t\t\t\tp = p->next;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn;\n\t}\n\tsymbols[nsymbols].type = type;\n\tsymbols[nsymbols].flags = flags;\n\tsymbols[nsymbols].value = value;\n\tsymbols[nsymbols].patchlist = NULL;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define\tF_DEFINED\t0x0001",
      "#define\tMAXSYMBOLS\t128"
    ],
    "globals_used": [
      "unsigned long script[MAXINST];",
      "int\tdsps;",
      "struct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];",
      "int nsymbols;",
      "FILE\t*errfp;",
      "void\terrout (char *);",
      "void\tdefine_symbol (char *, unsigned long, short, short);",
      "void\terror_line(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "symbols[nsymbols].name",
            "name"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "strlen (name) + 1"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Symbol table full\""
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "errfp",
            "\"*** Symbol \\\"%s\\\" multiply defined\\n\"",
            "name"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_line",
          "args": [],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "error_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "1128-1134",
          "snippet": "void\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tlineno;",
            "int\terr_listed;",
            "char\tinbuf[128];",
            "FILE\t*listfp;",
            "FILE\t*errfp;",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tlineno;\nint\terr_listed;\nchar\tinbuf[128];\nFILE\t*listfp;\nFILE\t*errfp;\nvoid\terror_line(void);\n\nvoid\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "symbols[i].name",
            "name"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_DEFINED\t0x0001\n#define\tMAXSYMBOLS\t128\n\nunsigned long script[MAXINST];\nint\tdsps;\nstruct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];\nint nsymbols;\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\tdefine_symbol (char *, unsigned long, short, short);\nvoid\terror_line(void);\n\nvoid define_symbol (char *name, unsigned long value, short type, short flags)\n{\n\tint\ti;\n\tstruct patchlist *p;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tif (symbols[i].type == type && strcmp (symbols[i].name, name) == 0) {\n\t\t\tif (symbols[i].flags & F_DEFINED) {\n\t\t\t\terror_line();\n\t\t\t\tfprintf (errfp, \"*** Symbol \\\"%s\\\" multiply defined\\n\",\n\t\t\t\t\tname);\n\t\t\t} else {\n\t\t\t\tsymbols[i].flags |= flags;\n\t\t\t\tsymbols[i].value = value;\n\t\t\t\tp = symbols[i].patchlist;\n\t\t\t\twhile (p) {\n\t\t\t\t\tif (p->offset > dsps)\n\t\t\t\t\t\terrout (\"Whoops\\007\");\n\t\t\t\t\telse\n\t\t\t\t\t\tscript[p->offset / 4] = dsps - p->offset - 4;\n\t\t\t\t\tp = p->next;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tif (nsymbols >= MAXSYMBOLS) {\n\t\terrout (\"Symbol table full\");\n\t\treturn;\n\t}\n\tsymbols[nsymbols].type = type;\n\tsymbols[nsymbols].flags = flags;\n\tsymbols[nsymbols].value = value;\n\tsymbols[nsymbols].patchlist = NULL;\n\tsymbols[nsymbols].name = malloc (strlen (name) + 1);\n\tstrcpy (symbols[nsymbols].name, name);\n\t++nsymbols;\n}"
  },
  {
    "function_name": "process",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "429-459",
    "snippet": "void\tprocess ()\n{\n\tint\ti;\n\n\tif (tokens[tokenix].type) {\n\t\terror_line();\n\t\tfprintf (errfp, \"Error: expected directive, found '%c'\\n\",\n\t\t\ttokens[tokenix].type);\n\t\treturn;\n\t}\n\tfor (i = 0; directives[i].name; ++i) {\n\t\tif (strcmpi (directives[i].name, tokens[tokenix].name) == 0)\n\t\t\tbreak;\n\t}\n\tif (directives[i].name == NULL) {\n\t\terror_line();\n\t\tfprintf (errfp, \"Error: expected directive, found \\\"%s\\\"\\n\",\n\t\t\ttokens[tokenix].name);\n\t\treturn;\n\t}\n\tif (directives[i].func == NULL) {\n\t\terror_line();\n\t\tfprintf (errfp, \"No function for directive \\\"%s\\\"\\n\", tokens[tokenix].name);\n\t} else {\n#if 0\n\t\tfprintf (listfp, \"Processing directive \\\"%s\\\"\\n\", directives[i].name);\n#endif\n\t\t++tokenix;\n\t\t(*directives[i].func) ();\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define strcmpi\tstrcasecmp"
    ],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\ttokenix;",
      "struct {\n\tchar\t*name;\n\tvoid\t(*func)(void);\n} directives[] = {\n\t\"PROC\",\t\tf_proc,\n\t\"PASS\",\t\tf_pass,\n\t\"ENTRY\",\tf_list,\n\t\"ABSOLUTE\",\tf_define,\n\t\"EXTERN\",\tf_list,\n\t\"EXTERNAL\",\tf_list,\n\t\"RELATIVE\",\tf_define,\n\t\"MOVE\",\t\tf_move,\n\t\"JUMP\",\t\tf_jump,\n\t\"CALL\",\t\tf_call,\n\t\"RETURN\",\tf_return,\n\t\"INT\",\t\tf_int,\n\t\"SELECT\",\tf_select,\n\t\"RESELECT\",\tf_reselect,\n\t\"WAIT\",\t\tf_wait,\n\t\"DISCONNECT\",\tf_disconnect,\n\t\"SET\",\t\tf_set,\n\t\"CLEAR\",\tf_clear,\n\t\"ARCH\",\t\tf_arch,\n\tNULL};",
      "FILE\t*listfp;",
      "FILE\t*errfp;",
      "void\tprocess (void);",
      "void\terror_line(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"Processing directive \\\"%s\\\"\\n\"",
            "directives[i].name"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "errfp",
            "\"No function for directive \\\"%s\\\"\\n\"",
            "tokens[tokenix].name"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_line",
          "args": [],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "error_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "1128-1134",
          "snippet": "void\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tlineno;",
            "int\terr_listed;",
            "char\tinbuf[128];",
            "FILE\t*listfp;",
            "FILE\t*errfp;",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tlineno;\nint\terr_listed;\nchar\tinbuf[128];\nFILE\t*listfp;\nFILE\t*errfp;\nvoid\terror_line(void);\n\nvoid\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "errfp",
            "\"Error: expected directive, found \\\"%s\\\"\\n\"",
            "tokens[tokenix].name"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmpi",
          "args": [
            "directives[i].name",
            "tokens[tokenix].name"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "errfp",
            "\"Error: expected directive, found '%c'\\n\"",
            "tokens[tokenix].type"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define strcmpi\tstrcasecmp\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\ttokenix;\nstruct {\n\tchar\t*name;\n\tvoid\t(*func)(void);\n} directives[] = {\n\t\"PROC\",\t\tf_proc,\n\t\"PASS\",\t\tf_pass,\n\t\"ENTRY\",\tf_list,\n\t\"ABSOLUTE\",\tf_define,\n\t\"EXTERN\",\tf_list,\n\t\"EXTERNAL\",\tf_list,\n\t\"RELATIVE\",\tf_define,\n\t\"MOVE\",\t\tf_move,\n\t\"JUMP\",\t\tf_jump,\n\t\"CALL\",\t\tf_call,\n\t\"RETURN\",\tf_return,\n\t\"INT\",\t\tf_int,\n\t\"SELECT\",\tf_select,\n\t\"RESELECT\",\tf_reselect,\n\t\"WAIT\",\t\tf_wait,\n\t\"DISCONNECT\",\tf_disconnect,\n\t\"SET\",\t\tf_set,\n\t\"CLEAR\",\tf_clear,\n\t\"ARCH\",\t\tf_arch,\n\tNULL};\nFILE\t*listfp;\nFILE\t*errfp;\nvoid\tprocess (void);\nvoid\terror_line(void);\n\nvoid\tprocess ()\n{\n\tint\ti;\n\n\tif (tokens[tokenix].type) {\n\t\terror_line();\n\t\tfprintf (errfp, \"Error: expected directive, found '%c'\\n\",\n\t\t\ttokens[tokenix].type);\n\t\treturn;\n\t}\n\tfor (i = 0; directives[i].name; ++i) {\n\t\tif (strcmpi (directives[i].name, tokens[tokenix].name) == 0)\n\t\t\tbreak;\n\t}\n\tif (directives[i].name == NULL) {\n\t\terror_line();\n\t\tfprintf (errfp, \"Error: expected directive, found \\\"%s\\\"\\n\",\n\t\t\ttokens[tokenix].name);\n\t\treturn;\n\t}\n\tif (directives[i].func == NULL) {\n\t\terror_line();\n\t\tfprintf (errfp, \"No function for directive \\\"%s\\\"\\n\", tokens[tokenix].name);\n\t} else {\n#if 0\n\t\tfprintf (listfp, \"Processing directive \\\"%s\\\"\\n\", directives[i].name);\n#endif\n\t\t++tokenix;\n\t\t(*directives[i].func) ();\n\t}\n}"
  },
  {
    "function_name": "parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "390-427",
    "snippet": "void parse ()\n{\n\tchar *p = inbuf;\n\tchar c;\n\tchar string[64];\n\tchar *s;\n\n\tntokens = tokenix = 0;\n\twhile (1) {\n\t\twhile ((c = *p++) && c != '\\n' && c <= ' ' || c == '\\t')\n\t\t\t;\n\t\tif (c == '\\n' || c == 0 || c == ';')\n\t\t\tbreak;\n\t\tif (ntokens >= MAXTOKENS) {\n\t\t\terrout (\"Token table full\");\n\t\t\tbreak;\n\t\t}\n\t\tif ((c >= '0' && c <= '9') || (c >= 'a' && c <= 'z') ||\n\t\t    (c >= 'A' && c <= 'Z') || c == '$' || c == '_') {\n\t\t    \ts = string;\n\t\t    \t*s++ = c;\n\t\t    \twhile (((c = *p) >= '0' && c <= '9') ||\n\t\t    \t    (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') ||\n\t\t    \t    c == '_' || c == '$') {\n\t\t    \t    \t*s++ = *p++;\n\t\t    \t}\n\t\t    \t*s = 0;\n\t\t    \ttokens[ntokens].name = malloc (strlen (string) + 1);\n\t\t    \tstrcpy (tokens[ntokens].name, string);\n\t\t    \ttokens[ntokens].type = 0;\n\t\t}\n\t\telse {\n\t\t\ttokens[ntokens].type = c;\n\t\t}\n\t\t++ntokens;\n\t}\n\treturn;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define\tMAXTOKENS\t16"
    ],
    "globals_used": [
      "struct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];",
      "int\tntokens;",
      "int\ttokenix;",
      "char\tinbuf[128];",
      "void\tparse (void);",
      "void\terrout (char *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "tokens[ntokens].name",
            "string"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "strlen (string) + 1"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errout",
          "args": [
            "\"Token table full\""
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "errout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "384-388",
          "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "FILE\t*errfp;",
            "void\terrout (char *);",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tMAXTOKENS\t16\n\nstruct {\n\tlong\ttype;\n\tchar\t*name;\n} tokens[MAXTOKENS];\nint\tntokens;\nint\ttokenix;\nchar\tinbuf[128];\nvoid\tparse (void);\nvoid\terrout (char *);\n\nvoid parse ()\n{\n\tchar *p = inbuf;\n\tchar c;\n\tchar string[64];\n\tchar *s;\n\n\tntokens = tokenix = 0;\n\twhile (1) {\n\t\twhile ((c = *p++) && c != '\\n' && c <= ' ' || c == '\\t')\n\t\t\t;\n\t\tif (c == '\\n' || c == 0 || c == ';')\n\t\t\tbreak;\n\t\tif (ntokens >= MAXTOKENS) {\n\t\t\terrout (\"Token table full\");\n\t\t\tbreak;\n\t\t}\n\t\tif ((c >= '0' && c <= '9') || (c >= 'a' && c <= 'z') ||\n\t\t    (c >= 'A' && c <= 'Z') || c == '$' || c == '_') {\n\t\t    \ts = string;\n\t\t    \t*s++ = c;\n\t\t    \twhile (((c = *p) >= '0' && c <= '9') ||\n\t\t    \t    (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') ||\n\t\t    \t    c == '_' || c == '$') {\n\t\t    \t    \t*s++ = *p++;\n\t\t    \t}\n\t\t    \t*s = 0;\n\t\t    \ttokens[ntokens].name = malloc (strlen (string) + 1);\n\t\t    \tstrcpy (tokens[ntokens].name, string);\n\t\t    \ttokens[ntokens].type = 0;\n\t\t}\n\t\telse {\n\t\t\ttokens[ntokens].type = c;\n\t\t}\n\t\t++ntokens;\n\t}\n\treturn;\n}"
  },
  {
    "function_name": "errout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "384-388",
    "snippet": "void errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "FILE\t*errfp;",
      "void\terrout (char *);",
      "void\terror_line(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "errfp",
            "\"*** %s ***\\n\"",
            "text"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_line",
          "args": [],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "error_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
          "lines": "1128-1134",
          "snippet": "void\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tlineno;",
            "int\terr_listed;",
            "char\tinbuf[128];",
            "FILE\t*listfp;",
            "FILE\t*errfp;",
            "void\terror_line(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint\tlineno;\nint\terr_listed;\nchar\tinbuf[128];\nFILE\t*listfp;\nFILE\t*errfp;\nvoid\terror_line(void);\n\nvoid\terror_line()\n{\n\tif (errfp != listfp && errfp && err_listed == 0) {\n\t\tfprintf (errfp, \"%3d:  %s\", lineno, inbuf);\n\t\terr_listed = 1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nFILE\t*errfp;\nvoid\terrout (char *);\nvoid\terror_line(void);\n\nvoid errout (char *text)\n{\n\terror_line();\n\tfprintf (errfp, \"*** %s ***\\n\", text);\n}"
  },
  {
    "function_name": "list_symbols",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "371-382",
    "snippet": "void list_symbols ()\n{\n\tint\ti;\n\n\tif (nsymbols == 0 || listfp == NULL)\n\t\treturn;\n\tfprintf (listfp, \"\\n\\nValue     Type     Symbol\\n\");\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tfprintf (listfp, \"%08x: %-8s %s\\n\", symbols[i].value,\n\t\t\tstypes[symbols[i].type], symbols[i].name);\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];",
      "int nsymbols;",
      "char\t*stypes[] = {\"Label\", \"Absolute\", \"Relative\", \"External\"};",
      "FILE\t*listfp;",
      "void\tlist_symbols (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"%08x: %-8s %s\\n\"",
            "symbols[i].value",
            "stypes[symbols[i].type]",
            "symbols[i].name"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "listfp",
            "\"\\n\\nValue     Type     Symbol\\n\""
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstruct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];\nint nsymbols;\nchar\t*stypes[] = {\"Label\", \"Absolute\", \"Relative\", \"External\"};\nFILE\t*listfp;\nvoid\tlist_symbols (void);\n\nvoid list_symbols ()\n{\n\tint\ti;\n\n\tif (nsymbols == 0 || listfp == NULL)\n\t\treturn;\n\tfprintf (listfp, \"\\n\\nValue     Type     Symbol\\n\");\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tfprintf (listfp, \"%08x: %-8s %s\\n\", symbols[i].value,\n\t\t\tstypes[symbols[i].type], symbols[i].name);\n\t}\n}"
  },
  {
    "function_name": "emit_symbols",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/microcode/ncr53cxxx/ncr53cxxx.c",
    "lines": "334-369",
    "snippet": "void emit_symbols ()\n{\n\tint\ti;\n\tstruct\tpatchlist *p;\n\n\tif (nsymbols == 0 || outfp == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tchar\t*code;\n\t\tif (symbols[i].type == S_ABSOLUTE)\n\t\t\tcode = \"A_\";\n\t\telse if (symbols[i].type == S_RELATIVE)\n\t\t\tcode = \"R_\";\n\t\telse if (symbols[i].type == S_EXTERNAL)\n\t\t\tcode = \"E_\";\n\t\telse if (symbols[i].flags & F_ENTRY)\n\t\t\tcode = \"Ent_\";\n\t\telse\n\t\t\tcontinue;\n\t\tfprintf (outfp, \"#define\\t%s%s\\t0x%08x\\n\", code, symbols[i].name,\n\t\t\tsymbols[i].value);\n\t\tif (symbols[i].flags & F_ENTRY || symbols[i].patchlist == NULL)\n\t\t\tcontinue;\n\t\tfprintf (outfp, \"unsigned long %s%s_Used[] = {\\n\", code, symbols[i].name);\n#if 1\n\t\tp = symbols[i].patchlist;\n\t\twhile (p) {\n\t\t\tfprintf (outfp, \"\\t%08x,\\n\", p->offset / 4);\n\t\t\tp = p->next;\n\t\t}\n#endif\n\t\tfprintf (outfp, \"};\\n\\n\");\n\t}\n\t/* patches ? */\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define\tF_ENTRY\t\t0x0002",
      "#define\tS_EXTERNAL\t0x0003",
      "#define\tS_RELATIVE\t0x0002",
      "#define\tS_ABSOLUTE\t0x0001"
    ],
    "globals_used": [
      "struct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];",
      "int nsymbols;",
      "FILE\t*outfp;",
      "void\temit_symbols (void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"};\\n\\n\""
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"\\t%08x,\\n\"",
            "p->offset / 4"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"unsigned long %s%s_Used[] = {\\n\"",
            "code",
            "symbols[i].name"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "outfp",
            "\"#define\\t%s%s\\t0x%08x\\n\"",
            "code",
            "symbols[i].name",
            "symbols[i].value"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define\tF_ENTRY\t\t0x0002\n#define\tS_EXTERNAL\t0x0003\n#define\tS_RELATIVE\t0x0002\n#define\tS_ABSOLUTE\t0x0001\n\nstruct {\n\tshort\ttype;\n\tshort\tflags;\n\tunsigned long value;\n\tstruct patchlist *patchlist;\n\tchar\t*name;\n} symbols[MAXSYMBOLS];\nint nsymbols;\nFILE\t*outfp;\nvoid\temit_symbols (void);\n\nvoid emit_symbols ()\n{\n\tint\ti;\n\tstruct\tpatchlist *p;\n\n\tif (nsymbols == 0 || outfp == NULL)\n\t\treturn;\n\n\tfor (i = 0; i < nsymbols; ++i) {\n\t\tchar\t*code;\n\t\tif (symbols[i].type == S_ABSOLUTE)\n\t\t\tcode = \"A_\";\n\t\telse if (symbols[i].type == S_RELATIVE)\n\t\t\tcode = \"R_\";\n\t\telse if (symbols[i].type == S_EXTERNAL)\n\t\t\tcode = \"E_\";\n\t\telse if (symbols[i].flags & F_ENTRY)\n\t\t\tcode = \"Ent_\";\n\t\telse\n\t\t\tcontinue;\n\t\tfprintf (outfp, \"#define\\t%s%s\\t0x%08x\\n\", code, symbols[i].name,\n\t\t\tsymbols[i].value);\n\t\tif (symbols[i].flags & F_ENTRY || symbols[i].patchlist == NULL)\n\t\t\tcontinue;\n\t\tfprintf (outfp, \"unsigned long %s%s_Used[] = {\\n\", code, symbols[i].name);\n#if 1\n\t\tp = symbols[i].patchlist;\n\t\twhile (p) {\n\t\t\tfprintf (outfp, \"\\t%08x,\\n\", p->offset / 4);\n\t\t\tp = p->next;\n\t\t}\n#endif\n\t\tfprintf (outfp, \"};\\n\\n\");\n\t}\n\t/* patches ? */\n}"
  }
]