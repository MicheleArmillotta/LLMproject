[
  {
    "function_name": "ef_tick",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "1012-1023",
    "snippet": "void\nef_tick(v)\n\tvoid *v;\n{\n\tstruct ef_softc *sc = v;\n\tint s;\n\n\ts = splimp();\n\tmii_tick(&sc->sc_mii);\n\tsplx(s);\n\ttimeout(ef_tick, sc, hz);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void ef_tick",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "ef_tick",
            "sc",
            "hz"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "bt_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/bt.c",
          "lines": "1300-1345",
          "snippet": "void\nbt_timeout(arg)\n\tvoid *arg;\n{\n\tstruct bt_ccb *ccb = arg;\n\tstruct scsi_xfer *xs = ccb->xs;\n\tstruct scsi_link *sc_link = xs->sc_link;\n\tstruct bt_softc *sc = sc_link->adapter_softc;\n\tint s;\n\n\tsc_print_addr(sc_link);\n\tprintf(\"timed out\");\n\n\ts = splbio();\n\n#ifdef BTDIAG\n\t/*\n\t * If the ccb's mbx is not free, then the board has gone Far East?\n\t */\n\tbt_collect_mbo(sc);\n\tif (ccb->flags & CCB_SENDING) {\n\t\tprintf(\"%s: not taking commands!\\n\", sc->sc_dev.dv_xname);\n\t\tDebugger();\n\t}\n#endif\n\n\t/*\n\t * If it has been through before, then\n\t * a previous abort has failed, don't\n\t * try abort again\n\t */\n\tif (ccb->flags & CCB_ABORT) {\n\t\t/* abort timed out */\n\t\tprintf(\" AGAIN\\n\");\n\t\t/* XXX Must reset! */\n\t} else {\n\t\t/* abort the operation that has timed out */\n\t\tprintf(\"\\n\");\n\t\tccb->xs->error = XS_TIMEOUT;\n\t\tccb->timeout = BT_ABORT_TIMEOUT;\n\t\tccb->flags |= CCB_ABORT;\n\t\tbt_queue_ccb(sc, ccb);\n\t}\n\n\tsplx(s);\n}",
          "includes": [
            "#include \"bt.h\"",
            "#include \"aha.h\"",
            "#include <dev/isa/btreg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <scsi/scsiconf.h>",
            "#include <scsi/scsi_all.h>",
            "#include <machine/pio.h>",
            "#include <machine/intr.h>",
            "#include <sys/user.h>",
            "#include <sys/proc.h>",
            "#include <sys/buf.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define\tBT_ABORT_TIMEOUT\t2000\t/* time to wait for abort (mSec) */"
          ],
          "globals_used": [
            "bt_finish_ccbs __P((struct bt_softc *));",
            "bt_reset_ccb __P((struct bt_softc *, struct bt_ccb *));",
            "bt_init_ccb __P((struct bt_softc *, struct bt_ccb *));",
            "void bt_queue_ccb",
            "void bt_collect_mbo",
            "void bt_timeout",
            "struct bt_ccb *\nbt_get_ccb(sc, flags)\n\tstruct bt_softc *sc;",
            "int flags;",
            "struct bt_ccb *\nbt_ccb_phys_kv(sc, ccb_phys)\n\tstruct bt_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"bt.h\"\n#include \"aha.h\"\n#include <dev/isa/btreg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <scsi/scsiconf.h>\n#include <scsi/scsi_all.h>\n#include <machine/pio.h>\n#include <machine/intr.h>\n#include <sys/user.h>\n#include <sys/proc.h>\n#include <sys/buf.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define\tBT_ABORT_TIMEOUT\t2000\t/* time to wait for abort (mSec) */\n\nbt_finish_ccbs __P((struct bt_softc *));\nbt_reset_ccb __P((struct bt_softc *, struct bt_ccb *));\nbt_init_ccb __P((struct bt_softc *, struct bt_ccb *));\nvoid bt_queue_ccb;\nvoid bt_collect_mbo;\nvoid bt_timeout;\nstruct bt_ccb *\nbt_get_ccb(sc, flags)\n\tstruct bt_softc *sc;\nint flags;\nstruct bt_ccb *\nbt_ccb_phys_kv(sc, ccb_phys)\n\tstruct bt_softc *sc;\n\nvoid\nbt_timeout(arg)\n\tvoid *arg;\n{\n\tstruct bt_ccb *ccb = arg;\n\tstruct scsi_xfer *xs = ccb->xs;\n\tstruct scsi_link *sc_link = xs->sc_link;\n\tstruct bt_softc *sc = sc_link->adapter_softc;\n\tint s;\n\n\tsc_print_addr(sc_link);\n\tprintf(\"timed out\");\n\n\ts = splbio();\n\n#ifdef BTDIAG\n\t/*\n\t * If the ccb's mbx is not free, then the board has gone Far East?\n\t */\n\tbt_collect_mbo(sc);\n\tif (ccb->flags & CCB_SENDING) {\n\t\tprintf(\"%s: not taking commands!\\n\", sc->sc_dev.dv_xname);\n\t\tDebugger();\n\t}\n#endif\n\n\t/*\n\t * If it has been through before, then\n\t * a previous abort has failed, don't\n\t * try abort again\n\t */\n\tif (ccb->flags & CCB_ABORT) {\n\t\t/* abort timed out */\n\t\tprintf(\" AGAIN\\n\");\n\t\t/* XXX Must reset! */\n\t} else {\n\t\t/* abort the operation that has timed out */\n\t\tprintf(\"\\n\");\n\t\tccb->xs->error = XS_TIMEOUT;\n\t\tccb->timeout = BT_ABORT_TIMEOUT;\n\t\tccb->flags |= CCB_ABORT;\n\t\tbt_queue_ccb(sc, ccb);\n\t}\n\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mii_tick",
          "args": [
            "&sc->sc_mii"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "mii_tick",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/mii/mii.c",
          "lines": "192-201",
          "snippet": "void\nmii_tick(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list))\n\t\t(void) (*child->mii_service)(child, mii, MII_TICK);\n}",
          "includes": [
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/socket.h>",
            "#include <sys/systm.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/socket.h>\n#include <sys/systm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nvoid\nmii_tick(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list))\n\t\t(void) (*child->mii_service)(child, mii, MII_TICK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splimp",
          "args": [],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_tick(v)\n\tvoid *v;\n{\n\tstruct ef_softc *sc = v;\n\tint s;\n\n\ts = splimp();\n\tmii_tick(&sc->sc_mii);\n\tsplx(s);\n\ttimeout(ef_tick, sc, hz);\n}"
  },
  {
    "function_name": "ef_miibus_statchg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "992-1010",
    "snippet": "void\nef_miibus_statchg(self)\n\tstruct device *self;\n{\n\tstruct ef_softc *sc = (struct ef_softc *)self;\n\tint s;\n\n\ts = splimp();\n\tGO_WINDOW(3);\n\t/* Set duplex bit appropriately */\n\tif ((sc->sc_mii.mii_media_active & IFM_GMASK) == IFM_FDX)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_ioh,\n\t\t    EP_W3_MAC_CONTROL, 0x20);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_ioh,\n\t\t    EP_W3_MAC_CONTROL, 0x00);\n\tGO_WINDOW(7);\n\tsplx(s);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void ef_miibus_statchg",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "7"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "EP_W3_MAC_CONTROL",
            "0x00"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "EP_W3_MAC_CONTROL",
            "0x20"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "3"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splimp",
          "args": [],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid ef_miibus_statchg;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_miibus_statchg(self)\n\tstruct device *self;\n{\n\tstruct ef_softc *sc = (struct ef_softc *)self;\n\tint s;\n\n\ts = splimp();\n\tGO_WINDOW(3);\n\t/* Set duplex bit appropriately */\n\tif ((sc->sc_mii.mii_media_active & IFM_GMASK) == IFM_FDX)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_ioh,\n\t\t    EP_W3_MAC_CONTROL, 0x20);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_ioh,\n\t\t    EP_W3_MAC_CONTROL, 0x00);\n\tGO_WINDOW(7);\n\tsplx(s);\n}"
  },
  {
    "function_name": "ef_ifmedia_sts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "980-990",
    "snippet": "void\nef_ifmedia_sts(ifp, ifmr)\n\tstruct ifnet *ifp;\n\tstruct ifmediareq *ifmr;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\n\tmii_pollstat(&sc->sc_mii);\n\tifmr->ifm_status = sc->sc_mii.mii_media_status;\n\tifmr->ifm_active = sc->sc_mii.mii_media_active;\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void ef_ifmedia_sts",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mii_pollstat",
          "args": [
            "&sc->sc_mii"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "mii_pollstat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/mii/mii.c",
          "lines": "206-218",
          "snippet": "void\nmii_pollstat(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\n\tmii->mii_media_status = 0;\n\tmii->mii_media_active = IFM_NONE;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list))\n\t\t(void) (*child->mii_service)(child, mii, MII_POLLSTAT);\n}",
          "includes": [
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/socket.h>",
            "#include <sys/systm.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/socket.h>\n#include <sys/systm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nvoid\nmii_pollstat(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\n\tmii->mii_media_status = 0;\n\tmii->mii_media_active = IFM_NONE;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list))\n\t\t(void) (*child->mii_service)(child, mii, MII_POLLSTAT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid ef_ifmedia_sts;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_ifmedia_sts(ifp, ifmr)\n\tstruct ifnet *ifp;\n\tstruct ifmediareq *ifmr;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\n\tmii_pollstat(&sc->sc_mii);\n\tifmr->ifm_status = sc->sc_mii.mii_media_status;\n\tifmr->ifm_active = sc->sc_mii.mii_media_active;\n}"
  },
  {
    "function_name": "ef_ifmedia_upd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "970-978",
    "snippet": "int\nef_ifmedia_upd(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\n\tmii_mediachg(&sc->sc_mii);\n\treturn (0);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int ef_ifmedia_upd",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mii_mediachg",
          "args": [
            "&sc->sc_mii"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "mii_mediachg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/mii/mii.c",
          "lines": "170-187",
          "snippet": "int\nmii_mediachg(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\tint rv;\n\n\tmii->mii_media_status = 0;\n\tmii->mii_media_active = IFM_NONE;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list)) {\n\t\trv = (*child->mii_service)(child, mii, MII_MEDIACHG);\n\t\tif (rv)\n\t\t\treturn (rv);\n\t}\n\treturn (0);\n}",
          "includes": [
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/socket.h>",
            "#include <sys/systm.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/socket.h>\n#include <sys/systm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nint\nmii_mediachg(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\tint rv;\n\n\tmii->mii_media_status = 0;\n\tmii->mii_media_active = IFM_NONE;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list)) {\n\t\trv = (*child->mii_service)(child, mii, MII_MEDIACHG);\n\t\tif (rv)\n\t\t\treturn (rv);\n\t}\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint ef_ifmedia_upd;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nint\nef_ifmedia_upd(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\n\tmii_mediachg(&sc->sc_mii);\n\treturn (0);\n}"
  },
  {
    "function_name": "ef_miibus_writereg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "932-968",
    "snippet": "void\nef_miibus_writereg(dev, phy, reg, val)\n\tstruct device *dev;\n\tint phy, reg, val;\n{\n\tstruct ef_softc *sc = (struct ef_softc *)dev;\n\tint s, i;\n\n\ts = splimp();\n\n\tGO_WINDOW(4);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, EP_W4_CTRLR_STATUS, 0);\n\n\t/* Turn on xmit */\n\tMII_SET(sc, EF_MII_DIR);\n\n\tef_mii_sync(sc);\n\n\tef_mii_writeb(sc, 0);\n\tef_mii_writeb(sc, 1);\n\tef_mii_writeb(sc, 0);\n\tef_mii_writeb(sc, 1);\n\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (phy & i) ? 1 : 0);\n\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (reg & i) ? 1 : 0);\n\n\tef_mii_writeb(sc, 1);\n\tef_mii_writeb(sc, 0);\n\n\tfor (i = 0x8000; i; i >>= 1)\n\t\tef_mii_writeb(sc, (val & i) ? 1 : 0);\n\n\tsplx(s);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define\tEF_MII_DIR\t\t0x04\t\t/* direction */"
    ],
    "globals_used": [
      "void ef_miibus_writereg",
      "void ef_mii_writeb",
      "void ef_mii_sync",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ef_mii_writeb",
          "args": [
            "sc",
            "(val & i) ? 1 : 0"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "ef_mii_writeb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "831-847",
          "snippet": "void\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */",
            "#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */"
          ],
          "globals_used": [
            "void ef_mii_writeb",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */\n#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */\n\nvoid ef_mii_writeb;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ef_mii_sync",
          "args": [
            "sc"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "ef_mii_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "849-857",
          "snippet": "void\nef_mii_sync(sc)\n\tstruct ef_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < 32; i++)\n\t\tef_mii_writeb(sc, 1);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void ef_mii_writeb",
            "void ef_mii_sync",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid ef_mii_writeb;\nvoid ef_mii_sync;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_mii_sync(sc)\n\tstruct ef_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < 32; i++)\n\t\tef_mii_writeb(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_DIR"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "EP_W4_CTRLR_STATUS",
            "0"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "4"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splimp",
          "args": [],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_MII_DIR\t\t0x04\t\t/* direction */\n\nvoid ef_miibus_writereg;\nvoid ef_mii_writeb;\nvoid ef_mii_sync;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_miibus_writereg(dev, phy, reg, val)\n\tstruct device *dev;\n\tint phy, reg, val;\n{\n\tstruct ef_softc *sc = (struct ef_softc *)dev;\n\tint s, i;\n\n\ts = splimp();\n\n\tGO_WINDOW(4);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, EP_W4_CTRLR_STATUS, 0);\n\n\t/* Turn on xmit */\n\tMII_SET(sc, EF_MII_DIR);\n\n\tef_mii_sync(sc);\n\n\tef_mii_writeb(sc, 0);\n\tef_mii_writeb(sc, 1);\n\tef_mii_writeb(sc, 0);\n\tef_mii_writeb(sc, 1);\n\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (phy & i) ? 1 : 0);\n\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (reg & i) ? 1 : 0);\n\n\tef_mii_writeb(sc, 1);\n\tef_mii_writeb(sc, 0);\n\n\tfor (i = 0x8000; i; i >>= 1)\n\t\tef_mii_writeb(sc, (val & i) ? 1 : 0);\n\n\tsplx(s);\n}"
  },
  {
    "function_name": "ef_miibus_readreg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "859-930",
    "snippet": "int\nef_miibus_readreg(dev, phy, reg)\n\tstruct device *dev;\n\tint phy, reg;\n{\n\tstruct ef_softc *sc = (struct ef_softc *)dev;\n\tint i, ack, s, val = 0;\n\n\ts = splimp();\n\n\tGO_WINDOW(4);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, EP_W4_CTRLR_STATUS, 0);\n\n\t/* Turn on xmit */\n\tMII_SET(sc, EF_MII_DIR);\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tef_mii_sync(sc);\n\n\t/* Transmit start sequence */\n\tef_mii_writeb(sc, 0);\n\tef_mii_writeb(sc, 1);\n\n\t/* Transmit read sequence */\n\tef_mii_writeb(sc, 1);\n\tef_mii_writeb(sc, 0);\n\n\t/* Transmit phy addr */\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (phy & i) ? 1 : 0);\n\n\t/* Transmit reg addr */\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (reg & i) ? 1 : 0);\n\n\t/* First cycle of turnaround */\n\tMII_CLR(sc, EF_MII_CLK | EF_MII_DATA);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n\n\t/* Turn off xmit */\n\tMII_CLR(sc, EF_MII_DIR);\n\n\t/* Second cycle of turnaround */\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n\tack = bus_space_read_2(sc->sc_iot, sc->sc_ioh, EP_W4_CTRLR_STATUS) &\n\t    EF_MII_DATA;\n\n\t/* Read 16bit data */\n\tfor (i = 0x8000; i; i >>= 1) {\n\t\tMII_CLR(sc, EF_MII_CLK);\n\t\tDELAY(1);\n\t\tif (bus_space_read_2(sc->sc_iot, sc->sc_ioh,\n\t\t\t\t     EP_W4_CTRLR_STATUS) & EF_MII_DATA)\n\t\t\tval |= i;\n\t\tMII_SET(sc, EF_MII_CLK);\n\t\tDELAY(1);\n\t}\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n\n\tsplx(s);\n\n\treturn (val);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define\tEF_MII_DIR\t\t0x04\t\t/* direction */",
      "#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */",
      "#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */"
    ],
    "globals_used": [
      "int ef_miibus_readreg",
      "void ef_mii_writeb",
      "void ef_mii_sync",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "EP_W4_CTRLR_STATUS"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "EP_W4_CTRLR_STATUS"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_DIR"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_CLK | EF_MII_DATA"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ef_mii_writeb",
          "args": [
            "sc",
            "(reg & i) ? 1 : 0"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "ef_mii_writeb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "831-847",
          "snippet": "void\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */",
            "#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */"
          ],
          "globals_used": [
            "void ef_mii_writeb",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */\n#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */\n\nvoid ef_mii_writeb;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ef_mii_sync",
          "args": [
            "sc"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "ef_mii_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "849-857",
          "snippet": "void\nef_mii_sync(sc)\n\tstruct ef_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < 32; i++)\n\t\tef_mii_writeb(sc, 1);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void ef_mii_writeb",
            "void ef_mii_sync",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid ef_mii_writeb;\nvoid ef_mii_sync;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_mii_sync(sc)\n\tstruct ef_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < 32; i++)\n\t\tef_mii_writeb(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_DIR"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "EP_W4_CTRLR_STATUS",
            "0"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "4"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splimp",
          "args": [],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_MII_DIR\t\t0x04\t\t/* direction */\n#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */\n#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */\n\nint ef_miibus_readreg;\nvoid ef_mii_writeb;\nvoid ef_mii_sync;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nint\nef_miibus_readreg(dev, phy, reg)\n\tstruct device *dev;\n\tint phy, reg;\n{\n\tstruct ef_softc *sc = (struct ef_softc *)dev;\n\tint i, ack, s, val = 0;\n\n\ts = splimp();\n\n\tGO_WINDOW(4);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, EP_W4_CTRLR_STATUS, 0);\n\n\t/* Turn on xmit */\n\tMII_SET(sc, EF_MII_DIR);\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tef_mii_sync(sc);\n\n\t/* Transmit start sequence */\n\tef_mii_writeb(sc, 0);\n\tef_mii_writeb(sc, 1);\n\n\t/* Transmit read sequence */\n\tef_mii_writeb(sc, 1);\n\tef_mii_writeb(sc, 0);\n\n\t/* Transmit phy addr */\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (phy & i) ? 1 : 0);\n\n\t/* Transmit reg addr */\n\tfor (i = 0x10; i; i >>= 1)\n\t\tef_mii_writeb(sc, (reg & i) ? 1 : 0);\n\n\t/* First cycle of turnaround */\n\tMII_CLR(sc, EF_MII_CLK | EF_MII_DATA);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n\n\t/* Turn off xmit */\n\tMII_CLR(sc, EF_MII_DIR);\n\n\t/* Second cycle of turnaround */\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n\tack = bus_space_read_2(sc->sc_iot, sc->sc_ioh, EP_W4_CTRLR_STATUS) &\n\t    EF_MII_DATA;\n\n\t/* Read 16bit data */\n\tfor (i = 0x8000; i; i >>= 1) {\n\t\tMII_CLR(sc, EF_MII_CLK);\n\t\tDELAY(1);\n\t\tif (bus_space_read_2(sc->sc_iot, sc->sc_ioh,\n\t\t\t\t     EP_W4_CTRLR_STATUS) & EF_MII_DATA)\n\t\t\tval |= i;\n\t\tMII_SET(sc, EF_MII_CLK);\n\t\tDELAY(1);\n\t}\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n\n\tsplx(s);\n\n\treturn (val);\n}"
  },
  {
    "function_name": "ef_mii_sync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "849-857",
    "snippet": "void\nef_mii_sync(sc)\n\tstruct ef_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < 32; i++)\n\t\tef_mii_writeb(sc, 1);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void ef_mii_writeb",
      "void ef_mii_sync",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ef_mii_writeb",
          "args": [
            "sc",
            "1"
          ],
          "line": 856
        },
        "resolved": true,
        "details": {
          "function_name": "ef_mii_writeb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "831-847",
          "snippet": "void\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */",
            "#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */"
          ],
          "globals_used": [
            "void ef_mii_writeb",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */\n#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */\n\nvoid ef_mii_writeb;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid ef_mii_writeb;\nvoid ef_mii_sync;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_mii_sync(sc)\n\tstruct ef_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < 32; i++)\n\t\tef_mii_writeb(sc, 1);\n}"
  },
  {
    "function_name": "ef_mii_writeb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "831-847",
    "snippet": "void\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */",
      "#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */"
    ],
    "globals_used": [
      "void ef_mii_writeb",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_DATA"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_SET",
          "args": [
            "sc",
            "EF_MII_DATA"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MII_CLR",
          "args": [
            "sc",
            "EF_MII_CLK"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_MII_DATA\t\t0x02\t\t/* data bit */\n#define\tEF_MII_CLK\t\t0x01\t\t/* clock bit */\n\nvoid ef_mii_writeb;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_mii_writeb(sc, b)\n\tstruct ef_softc *sc;\n\tint b;\n{\n\tMII_CLR(sc, EF_MII_CLK);\n\n\tif (b)\n\t\tMII_SET(sc, EF_MII_DATA);\n\telse\n\t\tMII_CLR(sc, EF_MII_DATA);\n\n\tMII_CLR(sc, EF_MII_CLK);\n\tDELAY(1);\n\tMII_SET(sc, EF_MII_CLK);\n\tDELAY(1);\n}"
  },
  {
    "function_name": "efread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "691-757",
    "snippet": "void\nefread(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct mbuf *m;\n\tstruct ether_header *eh;\n\tint len;\n\n\tlen = bus_space_read_2(iot, ioh, EF_W1_RX_STATUS);\n\n#ifdef EF_DEBUG\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tint err = len & ERR_MASK;\n\t\tchar *s = NULL;\n\n\t\tif (len & ERR_INCOMPLETE)\n\t\t\ts = \"incomplete packet\";\n\t\telse if (err == ERR_OVERRUN)\n\t\t\ts = \"packet overrun\";\n\t\telse if (err == ERR_RUNT)\n\t\t\ts = \"runt packet\";\n\t\telse if (err == ERR_ALIGNMENT)\n\t\t\ts = \"bad alignment\";\n\t\telse if (err == ERR_CRC)\n\t\t\ts = \"bad crc\";\n\t\telse if (err == ERR_OVERSIZE)\n\t\t\ts = \"oversized packet\";\n\t\telse if (err == ERR_DRIBBLE)\n\t\t\ts = \"dribble bits\";\n\n\t\tif (s)\n\t\t\tprintf(\"%s: %s\\n\", sc->sc_dv.dv_xname, s);\n\t}\n#endif\n\n\tif (len & ERR_INCOMPLETE)\n\t\treturn;\n\n\tif (len & ERR_RX) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tlen &= RX_BYTES_MASK;\n\tm = efget(sc, len);\n\tif (m == NULL) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tifp->if_ipackets++;\n\n\teh = mtod(m, struct ether_header *);\n\n#if NBPFILTER > 0\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n\tm_adj(m, sizeof(struct ether_header));\n\tether_input(ifp, eh, m);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define\tEF_W1_RX_STATUS\t\t0x18"
    ],
    "globals_used": [
      "void efcompletecmd",
      "void efread",
      "struct mbuf *efget",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ether_input",
          "args": [
            "ifp",
            "eh",
            "m"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_adj",
          "args": [
            "m",
            "sizeof(struct ether_header)"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_mtap",
          "args": [
            "ifp->if_bpf",
            "m"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "structether_header*"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efcompletecmd",
          "args": [
            "sc",
            "EP_COMMAND",
            "RX_DISCARD_TOP_PACK"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "efcompletecmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "525-536",
          "snippet": "void\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efcompletecmd",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efcompletecmd;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "efget",
          "args": [
            "sc",
            "len"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: %s\\n\"",
            "sc->sc_dv.dv_xname",
            "s"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "EF_W1_RX_STATUS"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W1_RX_STATUS\t\t0x18\n\nvoid efcompletecmd;\nvoid efread;\nstruct mbuf *efget;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefread(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct mbuf *m;\n\tstruct ether_header *eh;\n\tint len;\n\n\tlen = bus_space_read_2(iot, ioh, EF_W1_RX_STATUS);\n\n#ifdef EF_DEBUG\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tint err = len & ERR_MASK;\n\t\tchar *s = NULL;\n\n\t\tif (len & ERR_INCOMPLETE)\n\t\t\ts = \"incomplete packet\";\n\t\telse if (err == ERR_OVERRUN)\n\t\t\ts = \"packet overrun\";\n\t\telse if (err == ERR_RUNT)\n\t\t\ts = \"runt packet\";\n\t\telse if (err == ERR_ALIGNMENT)\n\t\t\ts = \"bad alignment\";\n\t\telse if (err == ERR_CRC)\n\t\t\ts = \"bad crc\";\n\t\telse if (err == ERR_OVERSIZE)\n\t\t\ts = \"oversized packet\";\n\t\telse if (err == ERR_DRIBBLE)\n\t\t\ts = \"dribble bits\";\n\n\t\tif (s)\n\t\t\tprintf(\"%s: %s\\n\", sc->sc_dv.dv_xname, s);\n\t}\n#endif\n\n\tif (len & ERR_INCOMPLETE)\n\t\treturn;\n\n\tif (len & ERR_RX) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tlen &= RX_BYTES_MASK;\n\tm = efget(sc, len);\n\tif (m == NULL) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tifp->if_ipackets++;\n\n\teh = mtod(m, struct ether_header *);\n\n#if NBPFILTER > 0\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n\tm_adj(m, sizeof(struct ether_header));\n\tether_input(ifp, eh, m);\n}"
  },
  {
    "function_name": "efsetmulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "664-689",
    "snippet": "void\nefsetmulti(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct arpcom *ac = &sc->sc_arpcom;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ether_multi *enm;\n\tstruct ether_multistep step;\n\tu_int16_t cmd = SET_RX_FILTER | FIL_INDIVIDUAL | FIL_BRDCST;\n\tint mcnt = 0;\n\n\tETHER_FIRST_MULTI(step, ac, enm);\n\twhile (enm != NULL) {\n\t\tmcnt++;\n\t\tETHER_NEXT_MULTI(step, enm);\n\t}\n\tif (mcnt || ifp->if_flags & IFF_ALLMULTI)\n\t\tcmd |= FIL_MULTICAST;\n\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tcmd |= FIL_PROMISC;\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, cmd);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void efsetmulti",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "cmd"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ETHER_NEXT_MULTI",
          "args": [
            "step",
            "enm"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ETHER_FIRST_MULTI",
          "args": [
            "step",
            "ac",
            "enm"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efsetmulti;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefsetmulti(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct arpcom *ac = &sc->sc_arpcom;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ether_multi *enm;\n\tstruct ether_multistep step;\n\tu_int16_t cmd = SET_RX_FILTER | FIL_INDIVIDUAL | FIL_BRDCST;\n\tint mcnt = 0;\n\n\tETHER_FIRST_MULTI(step, ac, enm);\n\twhile (enm != NULL) {\n\t\tmcnt++;\n\t\tETHER_NEXT_MULTI(step, enm);\n\t}\n\tif (mcnt || ifp->if_flags & IFF_ALLMULTI)\n\t\tcmd |= FIL_MULTICAST;\n\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tcmd |= FIL_PROMISC;\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, cmd);\n}"
  },
  {
    "function_name": "efwatchdog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "653-662",
    "snippet": "void\nefwatchdog(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\n\tprintf(\"%s: device timeout\\n\", sc->sc_dv.dv_xname);\n\tsc->sc_arpcom.ac_if.if_oerrors++;\n\tefreset(sc);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void efwatchdog",
      "void efreset",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "efreset",
          "args": [
            "sc"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "efreset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "485-495",
          "snippet": "void\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efreset",
            "void efstop",
            "void efinit",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efreset;\nvoid efstop;\nvoid efinit;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: device timeout\\n\"",
            "sc->sc_dv.dv_xname"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efwatchdog;\nvoid efreset;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefwatchdog(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\n\tprintf(\"%s: device timeout\\n\", sc->sc_dv.dv_xname);\n\tsc->sc_arpcom.ac_if.if_oerrors++;\n\tefreset(sc);\n}"
  },
  {
    "function_name": "efbusyeeprom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "630-651",
    "snippet": "int\nefbusyeeprom(sc)\n\tstruct ef_softc *sc;\n{\n\tint i = 100, j;\n\n\twhile (i--) {\n\t\tj = bus_space_read_2(sc->sc_iot, sc->sc_ioh,\n\t\t\t\t     EF_W0_EEPROM_COMMAND);\n\t\tif (j & EF_EEPROM_BUSY)\n\t\t\tdelay(100);\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (i == 0) {\n\t\tprintf(\"%s: eeprom failed to come ready\\n\",\n\t\t   sc->sc_dv.dv_xname);\n\t\treturn (1);\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define    EF_EEPROM_BUSY\t(1 << 9)",
      "#define\tEF_W0_EEPROM_COMMAND\t0x200a"
    ],
    "globals_used": [
      "int efbusyeeprom",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: eeprom failed to come ready\\n\"",
            "sc->sc_dv.dv_xname"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "100"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "EF_W0_EEPROM_COMMAND"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define    EF_EEPROM_BUSY\t(1 << 9)\n#define\tEF_W0_EEPROM_COMMAND\t0x200a\n\nint efbusyeeprom;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nint\nefbusyeeprom(sc)\n\tstruct ef_softc *sc;\n{\n\tint i = 100, j;\n\n\twhile (i--) {\n\t\tj = bus_space_read_2(sc->sc_iot, sc->sc_ioh,\n\t\t\t\t     EF_W0_EEPROM_COMMAND);\n\t\tif (j & EF_EEPROM_BUSY)\n\t\t\tdelay(100);\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (i == 0) {\n\t\tprintf(\"%s: eeprom failed to come ready\\n\",\n\t\t   sc->sc_dv.dv_xname);\n\t\treturn (1);\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "eftxstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "585-628",
    "snippet": "void\neftxstat(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i;\n\n\twhile ((i = bus_space_read_1(iot, ioh, EF_W1_TX_STATUS)) &\n\t   TXS_COMPLETE) {\n\t\tbus_space_write_1(iot, ioh, EF_W1_TX_STATUS, 0);\n\n\t\tif (i & TXS_JABBER) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: jabber (%x)\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i);\n#endif\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_UNDERRUN) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: fifo underrun (%x) @%d\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i,\n\t\t\t\t    sc->sc_tx_start_thresh);\n#endif\n\t\t\tif (sc->sc_tx_succ_ok < 100)\n\t\t\t\tsc->sc_tx_start_thresh = min(ETHER_MAX_LEN,\n\t\t\t\t    sc->sc_tx_start_thresh + 20);\n\t\t\tsc->sc_tx_succ_ok = 0;\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_MAX_COLLISION) {\n\t\t\tsc->sc_arpcom.ac_if.if_collisions++;\n\t\t\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\t\t\tsc->sc_arpcom.ac_if.if_flags &= ~IFF_OACTIVE;\n\t\t}\n\t\telse\n\t\t\tsc->sc_tx_succ_ok = (sc->sc_tx_succ_ok + 1) & 127;\n\t}\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define\tEF_W1_TX_STATUS\t\t0x1b",
      "#define\tETHER_MAX_LEN\t\t1518"
    ],
    "globals_used": [
      "void efreset",
      "void eftxstat",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "TX_ENABLE"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efreset",
          "args": [
            "sc"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "efreset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "485-495",
          "snippet": "void\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efreset",
            "void efstop",
            "void efinit",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efreset;\nvoid efstop;\nvoid efinit;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "ETHER_MAX_LEN",
            "sc->sc_tx_start_thresh + 20"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "btminphys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/bt.c",
          "lines": "1088-1096",
          "snippet": "void\nbtminphys(bp)\n\tstruct buf *bp;\n{\n\n\tif (bp->b_bcount > ((BT_NSEG - 1) << PGSHIFT))\n\t\tbp->b_bcount = ((BT_NSEG - 1) << PGSHIFT);\n\tminphys(bp);\n}",
          "includes": [
            "#include \"bt.h\"",
            "#include \"aha.h\"",
            "#include <dev/isa/btreg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <scsi/scsiconf.h>",
            "#include <scsi/scsi_all.h>",
            "#include <machine/pio.h>",
            "#include <machine/intr.h>",
            "#include <sys/user.h>",
            "#include <sys/proc.h>",
            "#include <sys/buf.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void btminphys"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"bt.h\"\n#include \"aha.h\"\n#include <dev/isa/btreg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <scsi/scsiconf.h>\n#include <scsi/scsi_all.h>\n#include <machine/pio.h>\n#include <machine/intr.h>\n#include <sys/user.h>\n#include <sys/proc.h>\n#include <sys/buf.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nvoid btminphys;\n\nvoid\nbtminphys(bp)\n\tstruct buf *bp;\n{\n\n\tif (bp->b_bcount > ((BT_NSEG - 1) << PGSHIFT))\n\t\tbp->b_bcount = ((BT_NSEG - 1) << PGSHIFT);\n\tminphys(bp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: fifo underrun (%x) @%d\\n\"",
            "sc->sc_dv.dv_xname",
            "i",
            "sc->sc_tx_start_thresh"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "ioh",
            "EF_W1_TX_STATUS",
            "0"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "ioh",
            "EF_W1_TX_STATUS"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W1_TX_STATUS\t\t0x1b\n#define\tETHER_MAX_LEN\t\t1518\n\nvoid efreset;\nvoid eftxstat;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\neftxstat(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i;\n\n\twhile ((i = bus_space_read_1(iot, ioh, EF_W1_TX_STATUS)) &\n\t   TXS_COMPLETE) {\n\t\tbus_space_write_1(iot, ioh, EF_W1_TX_STATUS, 0);\n\n\t\tif (i & TXS_JABBER) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: jabber (%x)\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i);\n#endif\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_UNDERRUN) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: fifo underrun (%x) @%d\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i,\n\t\t\t\t    sc->sc_tx_start_thresh);\n#endif\n\t\t\tif (sc->sc_tx_succ_ok < 100)\n\t\t\t\tsc->sc_tx_start_thresh = min(ETHER_MAX_LEN,\n\t\t\t\t    sc->sc_tx_start_thresh + 20);\n\t\t\tsc->sc_tx_succ_ok = 0;\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_MAX_COLLISION) {\n\t\t\tsc->sc_arpcom.ac_if.if_collisions++;\n\t\t\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\t\t\tsc->sc_arpcom.ac_if.if_flags &= ~IFF_OACTIVE;\n\t\t}\n\t\telse\n\t\t\tsc->sc_tx_succ_ok = (sc->sc_tx_succ_ok + 1) & 127;\n\t}\n}"
  },
  {
    "function_name": "efintr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "538-583",
    "snippet": "int\nefintr(vsc)\n\tvoid *vsc;\n{\n\tstruct ef_softc *sc = vsc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tu_int16_t status;\n\tint r = 0;\n\n\tstatus = bus_space_read_2(iot, ioh, EP_STATUS);\n\n\tdo {\n\t\tif (status & S_RX_COMPLETE) {\n\t\t\tr = 1;\n\t\t\tbus_space_write_2(iot, ioh, EP_STATUS, C_RX_COMPLETE);\n\t\t\tefread(sc);\n\t\t}\n\t\tif (status & S_TX_AVAIL) {\n\t\t\tbus_space_write_2(iot, ioh, EP_STATUS, C_TX_AVAIL);\n\t\t\tr = 1;\n\t\t\tsc->sc_arpcom.ac_if.if_flags &= ~IFF_OACTIVE;\n\t\t\tefstart(&sc->sc_arpcom.ac_if);\n\t\t}\n\t\tif (status & S_CARD_FAILURE) {\n\t\t\tr = 1;\n\t\t\tefreset(sc);\n\t\t\tprintf(\"%s: adapter failure (%x)\\n\",\n\t\t\t   sc->sc_dv.dv_xname, status);\n\t\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t\t\t\t  C_CARD_FAILURE);\n\t\t\treturn (1);\n\t\t}\n\t\tif (status & S_TX_COMPLETE) {\n\t\t\tr = 1;\n\t\t\teftxstat(sc);\n\t\t\tefstart(ifp);\n\t\t}\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    C_INTR_LATCH | C_INT_RQD);\n\t} while ((status = bus_space_read_2(iot, ioh, EP_STATUS)) &\n\t    (S_INT_RQD | S_RX_COMPLETE));\n\n\treturn (r);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void efstart",
      "void efreset",
      "int efintr",
      "void eftxstat",
      "void efread",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "EP_STATUS"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "C_INTR_LATCH | C_INT_RQD"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efstart",
          "args": [
            "ifp"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "efstart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "244-343",
          "snippet": "void\nefstart(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct mbuf *m, *m0;\n\tint s, len, pad, i;\n\tint fillcnt = 0;\n\tu_int32_t filler = 0;\n\n\tif ((ifp->if_flags & (IFF_RUNNING | IFF_OACTIVE)) != IFF_RUNNING)\n\t\treturn;\n\nstartagain:\n\tm0 = ifp->if_snd.ifq_head;\n\tif (m0 == NULL)\n\t\treturn;\n\n\tif ((m0->m_flags & M_PKTHDR) == 0)\n\t\tpanic(\"efstart: no header mbuf\");\n\tlen = m0->m_pkthdr.len;\n\tpad = (4 - len) & 3;\n\n\tif (len + pad > ETHER_MAX_LEN) {\n\t\tifp->if_oerrors++;\n\t\tIF_DEQUEUE(&ifp->if_snd, m0);\n\t\tm_freem(m0);\n\t\tgoto startagain;\n\t}\n\n\tif (bus_space_read_2(iot, ioh, EF_W1_FREE_TX) < len + pad + 4) {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | ((len + pad) >> 2));\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t\treturn;\n\t} else {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | EP_THRESH_DISABLE);\n\t}\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_TX_START_THRESH |\n\t    ((len / 4 + sc->sc_tx_start_thresh)));\n\n#if NBPFILTER\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\n\tIF_DEQUEUE(&ifp->if_snd, m0);\n\tif (m0 == NULL) /* XXX not needed */\n\t\treturn;\n\n\ts = splhigh();\n\n\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1, len);\n\tfor (m = m0; m; ) {\n\t\tif (fillcnt) {\n\t\t\twhile (m->m_len && fillcnt < 4) {\n\t\t\t\tfillcnt++;\n\t\t\t\tfiller >>= 8;\n\t\t\t\tfiller |= m->m_data[0] << 24;\n\t\t\t\tm->m_data++;\n\t\t\t\tm->m_len--;\n\t\t\t}\n\t\t\tif (fillcnt == 4) {\n\t\t\t\tbus_space_write_4(iot, ioh,\n\t\t\t\t    EF_W1_TX_PIO_WR_1, filler);\n\t\t\t\tfiller = 0;\n\t\t\t\tfillcnt = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (m->m_len & ~3)\n\t\t\tbus_space_write_multi_4(iot, ioh,\n\t\t\t    EF_W1_TX_PIO_WR_1, (u_int32_t *)m->m_data,\n\t\t\t    m->m_len >> 2);\n\t\tfor (i = 0; i < (m->m_len & 3); i++) {\n\t\t\tfillcnt++;\n\t\t\tfiller >>= 8;\n\t\t\tfiller |= m->m_data[(m->m_len & ~3) + i] << 24;\n\t\t}\n\t\tMFREE(m, m0);\n\t\tm = m0;\n\t}\n\n\tif (fillcnt) {\n\t\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1,\n\t\t    filler >> (32 - (8 * fillcnt)));\n\t\tfillcnt = 0;\n\t\tfiller = 0;\n\t}\n\n\tsplx(s);\n\n\tifp->if_opackets++;\n\n\tgoto startagain;\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tEF_W1_FREE_TX\t\t0x1c",
            "#define\tEF_W1_TX_PIO_WR_1\t0x10",
            "#define\tETHER_MAX_LEN\t\t1518"
          ],
          "globals_used": [
            "void efstart",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W1_FREE_TX\t\t0x1c\n#define\tEF_W1_TX_PIO_WR_1\t0x10\n#define\tETHER_MAX_LEN\t\t1518\n\nvoid efstart;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefstart(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct mbuf *m, *m0;\n\tint s, len, pad, i;\n\tint fillcnt = 0;\n\tu_int32_t filler = 0;\n\n\tif ((ifp->if_flags & (IFF_RUNNING | IFF_OACTIVE)) != IFF_RUNNING)\n\t\treturn;\n\nstartagain:\n\tm0 = ifp->if_snd.ifq_head;\n\tif (m0 == NULL)\n\t\treturn;\n\n\tif ((m0->m_flags & M_PKTHDR) == 0)\n\t\tpanic(\"efstart: no header mbuf\");\n\tlen = m0->m_pkthdr.len;\n\tpad = (4 - len) & 3;\n\n\tif (len + pad > ETHER_MAX_LEN) {\n\t\tifp->if_oerrors++;\n\t\tIF_DEQUEUE(&ifp->if_snd, m0);\n\t\tm_freem(m0);\n\t\tgoto startagain;\n\t}\n\n\tif (bus_space_read_2(iot, ioh, EF_W1_FREE_TX) < len + pad + 4) {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | ((len + pad) >> 2));\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t\treturn;\n\t} else {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | EP_THRESH_DISABLE);\n\t}\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_TX_START_THRESH |\n\t    ((len / 4 + sc->sc_tx_start_thresh)));\n\n#if NBPFILTER\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\n\tIF_DEQUEUE(&ifp->if_snd, m0);\n\tif (m0 == NULL) /* XXX not needed */\n\t\treturn;\n\n\ts = splhigh();\n\n\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1, len);\n\tfor (m = m0; m; ) {\n\t\tif (fillcnt) {\n\t\t\twhile (m->m_len && fillcnt < 4) {\n\t\t\t\tfillcnt++;\n\t\t\t\tfiller >>= 8;\n\t\t\t\tfiller |= m->m_data[0] << 24;\n\t\t\t\tm->m_data++;\n\t\t\t\tm->m_len--;\n\t\t\t}\n\t\t\tif (fillcnt == 4) {\n\t\t\t\tbus_space_write_4(iot, ioh,\n\t\t\t\t    EF_W1_TX_PIO_WR_1, filler);\n\t\t\t\tfiller = 0;\n\t\t\t\tfillcnt = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (m->m_len & ~3)\n\t\t\tbus_space_write_multi_4(iot, ioh,\n\t\t\t    EF_W1_TX_PIO_WR_1, (u_int32_t *)m->m_data,\n\t\t\t    m->m_len >> 2);\n\t\tfor (i = 0; i < (m->m_len & 3); i++) {\n\t\t\tfillcnt++;\n\t\t\tfiller >>= 8;\n\t\t\tfiller |= m->m_data[(m->m_len & ~3) + i] << 24;\n\t\t}\n\t\tMFREE(m, m0);\n\t\tm = m0;\n\t}\n\n\tif (fillcnt) {\n\t\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1,\n\t\t    filler >> (32 - (8 * fillcnt)));\n\t\tfillcnt = 0;\n\t\tfiller = 0;\n\t}\n\n\tsplx(s);\n\n\tifp->if_opackets++;\n\n\tgoto startagain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "eftxstat",
          "args": [
            "sc"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "eftxstat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "585-628",
          "snippet": "void\neftxstat(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i;\n\n\twhile ((i = bus_space_read_1(iot, ioh, EF_W1_TX_STATUS)) &\n\t   TXS_COMPLETE) {\n\t\tbus_space_write_1(iot, ioh, EF_W1_TX_STATUS, 0);\n\n\t\tif (i & TXS_JABBER) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: jabber (%x)\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i);\n#endif\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_UNDERRUN) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: fifo underrun (%x) @%d\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i,\n\t\t\t\t    sc->sc_tx_start_thresh);\n#endif\n\t\t\tif (sc->sc_tx_succ_ok < 100)\n\t\t\t\tsc->sc_tx_start_thresh = min(ETHER_MAX_LEN,\n\t\t\t\t    sc->sc_tx_start_thresh + 20);\n\t\t\tsc->sc_tx_succ_ok = 0;\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_MAX_COLLISION) {\n\t\t\tsc->sc_arpcom.ac_if.if_collisions++;\n\t\t\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\t\t\tsc->sc_arpcom.ac_if.if_flags &= ~IFF_OACTIVE;\n\t\t}\n\t\telse\n\t\t\tsc->sc_tx_succ_ok = (sc->sc_tx_succ_ok + 1) & 127;\n\t}\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tEF_W1_TX_STATUS\t\t0x1b",
            "#define\tETHER_MAX_LEN\t\t1518"
          ],
          "globals_used": [
            "void efreset",
            "void eftxstat",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W1_TX_STATUS\t\t0x1b\n#define\tETHER_MAX_LEN\t\t1518\n\nvoid efreset;\nvoid eftxstat;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\neftxstat(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i;\n\n\twhile ((i = bus_space_read_1(iot, ioh, EF_W1_TX_STATUS)) &\n\t   TXS_COMPLETE) {\n\t\tbus_space_write_1(iot, ioh, EF_W1_TX_STATUS, 0);\n\n\t\tif (i & TXS_JABBER) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: jabber (%x)\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i);\n#endif\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_UNDERRUN) {\n\t\t\tsc->sc_arpcom.ac_if.if_oerrors++;\n#ifdef EF_DEBUG\n\t\t\tif (sc->sc_arpcom.ac_if.if_flags & IFF_DEBUG)\n\t\t\t\tprintf(\"%s: fifo underrun (%x) @%d\\n\",\n\t\t\t\t    sc->sc_dv.dv_xname, i,\n\t\t\t\t    sc->sc_tx_start_thresh);\n#endif\n\t\t\tif (sc->sc_tx_succ_ok < 100)\n\t\t\t\tsc->sc_tx_start_thresh = min(ETHER_MAX_LEN,\n\t\t\t\t    sc->sc_tx_start_thresh + 20);\n\t\t\tsc->sc_tx_succ_ok = 0;\n\t\t\tefreset(sc);\n\t\t}\n\t\telse if (i & TXS_MAX_COLLISION) {\n\t\t\tsc->sc_arpcom.ac_if.if_collisions++;\n\t\t\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\t\t\tsc->sc_arpcom.ac_if.if_flags &= ~IFF_OACTIVE;\n\t\t}\n\t\telse\n\t\t\tsc->sc_tx_succ_ok = (sc->sc_tx_succ_ok + 1) & 127;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "C_CARD_FAILURE"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: adapter failure (%x)\\n\"",
            "sc->sc_dv.dv_xname",
            "status"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "efreset",
          "args": [
            "sc"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "efreset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "485-495",
          "snippet": "void\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efreset",
            "void efstop",
            "void efinit",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efreset;\nvoid efstop;\nvoid efinit;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_STATUS",
            "C_TX_AVAIL"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efread",
          "args": [
            "sc"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "efread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "691-757",
          "snippet": "void\nefread(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct mbuf *m;\n\tstruct ether_header *eh;\n\tint len;\n\n\tlen = bus_space_read_2(iot, ioh, EF_W1_RX_STATUS);\n\n#ifdef EF_DEBUG\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tint err = len & ERR_MASK;\n\t\tchar *s = NULL;\n\n\t\tif (len & ERR_INCOMPLETE)\n\t\t\ts = \"incomplete packet\";\n\t\telse if (err == ERR_OVERRUN)\n\t\t\ts = \"packet overrun\";\n\t\telse if (err == ERR_RUNT)\n\t\t\ts = \"runt packet\";\n\t\telse if (err == ERR_ALIGNMENT)\n\t\t\ts = \"bad alignment\";\n\t\telse if (err == ERR_CRC)\n\t\t\ts = \"bad crc\";\n\t\telse if (err == ERR_OVERSIZE)\n\t\t\ts = \"oversized packet\";\n\t\telse if (err == ERR_DRIBBLE)\n\t\t\ts = \"dribble bits\";\n\n\t\tif (s)\n\t\t\tprintf(\"%s: %s\\n\", sc->sc_dv.dv_xname, s);\n\t}\n#endif\n\n\tif (len & ERR_INCOMPLETE)\n\t\treturn;\n\n\tif (len & ERR_RX) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tlen &= RX_BYTES_MASK;\n\tm = efget(sc, len);\n\tif (m == NULL) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tifp->if_ipackets++;\n\n\teh = mtod(m, struct ether_header *);\n\n#if NBPFILTER > 0\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n\tm_adj(m, sizeof(struct ether_header));\n\tether_input(ifp, eh, m);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tEF_W1_RX_STATUS\t\t0x18"
          ],
          "globals_used": [
            "void efcompletecmd",
            "void efread",
            "struct mbuf *efget",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W1_RX_STATUS\t\t0x18\n\nvoid efcompletecmd;\nvoid efread;\nstruct mbuf *efget;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefread(sc)\n\tstruct ef_softc *sc;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct mbuf *m;\n\tstruct ether_header *eh;\n\tint len;\n\n\tlen = bus_space_read_2(iot, ioh, EF_W1_RX_STATUS);\n\n#ifdef EF_DEBUG\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tint err = len & ERR_MASK;\n\t\tchar *s = NULL;\n\n\t\tif (len & ERR_INCOMPLETE)\n\t\t\ts = \"incomplete packet\";\n\t\telse if (err == ERR_OVERRUN)\n\t\t\ts = \"packet overrun\";\n\t\telse if (err == ERR_RUNT)\n\t\t\ts = \"runt packet\";\n\t\telse if (err == ERR_ALIGNMENT)\n\t\t\ts = \"bad alignment\";\n\t\telse if (err == ERR_CRC)\n\t\t\ts = \"bad crc\";\n\t\telse if (err == ERR_OVERSIZE)\n\t\t\ts = \"oversized packet\";\n\t\telse if (err == ERR_DRIBBLE)\n\t\t\ts = \"dribble bits\";\n\n\t\tif (s)\n\t\t\tprintf(\"%s: %s\\n\", sc->sc_dv.dv_xname, s);\n\t}\n#endif\n\n\tif (len & ERR_INCOMPLETE)\n\t\treturn;\n\n\tif (len & ERR_RX) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tlen &= RX_BYTES_MASK;\n\tm = efget(sc, len);\n\tif (m == NULL) {\n\t\tifp->if_ierrors++;\n\t\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\t\treturn;\n\t}\n\n\tifp->if_ipackets++;\n\n\teh = mtod(m, struct ether_header *);\n\n#if NBPFILTER > 0\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n\tm_adj(m, sizeof(struct ether_header));\n\tether_input(ifp, eh, m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_STATUS",
            "C_RX_COMPLETE"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "EP_STATUS"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstart;\nvoid efreset;\nint efintr;\nvoid eftxstat;\nvoid efread;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nint\nefintr(vsc)\n\tvoid *vsc;\n{\n\tstruct ef_softc *sc = vsc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tu_int16_t status;\n\tint r = 0;\n\n\tstatus = bus_space_read_2(iot, ioh, EP_STATUS);\n\n\tdo {\n\t\tif (status & S_RX_COMPLETE) {\n\t\t\tr = 1;\n\t\t\tbus_space_write_2(iot, ioh, EP_STATUS, C_RX_COMPLETE);\n\t\t\tefread(sc);\n\t\t}\n\t\tif (status & S_TX_AVAIL) {\n\t\t\tbus_space_write_2(iot, ioh, EP_STATUS, C_TX_AVAIL);\n\t\t\tr = 1;\n\t\t\tsc->sc_arpcom.ac_if.if_flags &= ~IFF_OACTIVE;\n\t\t\tefstart(&sc->sc_arpcom.ac_if);\n\t\t}\n\t\tif (status & S_CARD_FAILURE) {\n\t\t\tr = 1;\n\t\t\tefreset(sc);\n\t\t\tprintf(\"%s: adapter failure (%x)\\n\",\n\t\t\t   sc->sc_dv.dv_xname, status);\n\t\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t\t\t\t  C_CARD_FAILURE);\n\t\t\treturn (1);\n\t\t}\n\t\tif (status & S_TX_COMPLETE) {\n\t\t\tr = 1;\n\t\t\teftxstat(sc);\n\t\t\tefstart(ifp);\n\t\t}\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    C_INTR_LATCH | C_INT_RQD);\n\t} while ((status = bus_space_read_2(iot, ioh, EP_STATUS)) &\n\t    (S_INT_RQD | S_RX_COMPLETE));\n\n\treturn (r);\n}"
  },
  {
    "function_name": "efcompletecmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "525-536",
    "snippet": "void\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void efcompletecmd",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "EP_STATUS"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "cmd",
            "arg"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efcompletecmd;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}"
  },
  {
    "function_name": "efstop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "497-523",
    "snippet": "void\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void efstop",
      "void efcompletecmd",
      "void ef_tick",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_RX_FILTER"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_INTR_MASK"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_RD_0_MASK"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "C_INTR_LATCH"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efcompletecmd",
          "args": [
            "sc",
            "EP_COMMAND",
            "TX_RESET"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "efcompletecmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "525-536",
          "snippet": "void\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efcompletecmd",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efcompletecmd;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "STOP_TRANSCEIVER"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "TX_DISABLE"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "RX_DISABLE"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "untimeout",
          "args": [
            "ef_tick",
            "sc"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstop;\nvoid efcompletecmd;\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}"
  },
  {
    "function_name": "efreset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "485-495",
    "snippet": "void\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void efreset",
      "void efstop",
      "void efinit",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efinit",
          "args": [
            "sc"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "efinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "413-483",
          "snippet": "void\nefinit(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i, s;\n\n\ts = splimp();\n\n\tefstop(sc);\n\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n\n\tGO_WINDOW(2);\n\tfor (i = 0; i < 6; i++)\n\t\tbus_space_write_1(iot, ioh, EP_W2_ADDR_0 + i,\n\t\t    sc->sc_arpcom.ac_enaddr[i]);\n\tfor (i = 0; i < 3; i += 2)\n\t\tbus_space_write_2(iot, ioh, EP_W2_RECVMASK_0 + (i * 2), 0);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t    SET_TX_AVAIL_THRESH | (1536 >> 2));\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE | 0);\n\n\tGO_WINDOW(6);\n\tfor (i = 0; i < 10; i++)\n\t\t(void)bus_space_read_1(iot, ioh, i);\n\t(void)bus_space_read_2(iot, ioh, 10);\n\t(void)bus_space_read_2(iot, ioh, 12);\n\tGO_WINDOW(4);\n\t(void)bus_space_read_1(iot, ioh, 12);\n\tbus_space_write_2(iot, ioh, EP_W4_NET_DIAG, 0x0040);\n\n\tGO_WINDOW(7);\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_ENABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE |\n\t    S_CARD_FAILURE | S_INT_RQD | S_UPD_STATS | S_TX_COMPLETE |\n\t    S_TX_AVAIL | S_RX_COMPLETE |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0));\n\tbus_space_write_2(iot, ioh, EP_COMMAND, ACK_INTR |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_EARLY | S_INT_RQD);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_COMPLETE | S_UPD_STATS |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0) | S_UP_COMPLETE |\n\t    S_DOWN_COMPLETE | S_CARD_FAILURE | S_TX_COMPLETE);\n\n\tmii_mediachg(&sc->sc_mii);\n\n\tifp->if_flags |= IFF_RUNNING;\n\tifp->if_flags &= ~IFF_OACTIVE;\n\n\tsplx(s);\n\n\ttimeout(ef_tick, sc, hz);\n\n\tefstart(ifp);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efstart",
            "void efstop",
            "void efsetmulti",
            "void efinit",
            "void efcompletecmd",
            "void ef_tick",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstart;\nvoid efstop;\nvoid efsetmulti;\nvoid efinit;\nvoid efcompletecmd;\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefinit(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i, s;\n\n\ts = splimp();\n\n\tefstop(sc);\n\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n\n\tGO_WINDOW(2);\n\tfor (i = 0; i < 6; i++)\n\t\tbus_space_write_1(iot, ioh, EP_W2_ADDR_0 + i,\n\t\t    sc->sc_arpcom.ac_enaddr[i]);\n\tfor (i = 0; i < 3; i += 2)\n\t\tbus_space_write_2(iot, ioh, EP_W2_RECVMASK_0 + (i * 2), 0);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t    SET_TX_AVAIL_THRESH | (1536 >> 2));\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE | 0);\n\n\tGO_WINDOW(6);\n\tfor (i = 0; i < 10; i++)\n\t\t(void)bus_space_read_1(iot, ioh, i);\n\t(void)bus_space_read_2(iot, ioh, 10);\n\t(void)bus_space_read_2(iot, ioh, 12);\n\tGO_WINDOW(4);\n\t(void)bus_space_read_1(iot, ioh, 12);\n\tbus_space_write_2(iot, ioh, EP_W4_NET_DIAG, 0x0040);\n\n\tGO_WINDOW(7);\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_ENABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE |\n\t    S_CARD_FAILURE | S_INT_RQD | S_UPD_STATS | S_TX_COMPLETE |\n\t    S_TX_AVAIL | S_RX_COMPLETE |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0));\n\tbus_space_write_2(iot, ioh, EP_COMMAND, ACK_INTR |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_EARLY | S_INT_RQD);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_COMPLETE | S_UPD_STATS |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0) | S_UP_COMPLETE |\n\t    S_DOWN_COMPLETE | S_CARD_FAILURE | S_TX_COMPLETE);\n\n\tmii_mediachg(&sc->sc_mii);\n\n\tifp->if_flags |= IFF_RUNNING;\n\tifp->if_flags &= ~IFF_OACTIVE;\n\n\tsplx(s);\n\n\ttimeout(ef_tick, sc, hz);\n\n\tefstart(ifp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "efstop",
          "args": [
            "sc"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "efstop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "497-523",
          "snippet": "void\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efstop",
            "void efcompletecmd",
            "void ef_tick",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstop;\nvoid efcompletecmd;\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splnet",
          "args": [],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efreset;\nvoid efstop;\nvoid efinit;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}"
  },
  {
    "function_name": "efinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "413-483",
    "snippet": "void\nefinit(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i, s;\n\n\ts = splimp();\n\n\tefstop(sc);\n\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n\n\tGO_WINDOW(2);\n\tfor (i = 0; i < 6; i++)\n\t\tbus_space_write_1(iot, ioh, EP_W2_ADDR_0 + i,\n\t\t    sc->sc_arpcom.ac_enaddr[i]);\n\tfor (i = 0; i < 3; i += 2)\n\t\tbus_space_write_2(iot, ioh, EP_W2_RECVMASK_0 + (i * 2), 0);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t    SET_TX_AVAIL_THRESH | (1536 >> 2));\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE | 0);\n\n\tGO_WINDOW(6);\n\tfor (i = 0; i < 10; i++)\n\t\t(void)bus_space_read_1(iot, ioh, i);\n\t(void)bus_space_read_2(iot, ioh, 10);\n\t(void)bus_space_read_2(iot, ioh, 12);\n\tGO_WINDOW(4);\n\t(void)bus_space_read_1(iot, ioh, 12);\n\tbus_space_write_2(iot, ioh, EP_W4_NET_DIAG, 0x0040);\n\n\tGO_WINDOW(7);\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_ENABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE |\n\t    S_CARD_FAILURE | S_INT_RQD | S_UPD_STATS | S_TX_COMPLETE |\n\t    S_TX_AVAIL | S_RX_COMPLETE |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0));\n\tbus_space_write_2(iot, ioh, EP_COMMAND, ACK_INTR |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_EARLY | S_INT_RQD);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_COMPLETE | S_UPD_STATS |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0) | S_UP_COMPLETE |\n\t    S_DOWN_COMPLETE | S_CARD_FAILURE | S_TX_COMPLETE);\n\n\tmii_mediachg(&sc->sc_mii);\n\n\tifp->if_flags |= IFF_RUNNING;\n\tifp->if_flags &= ~IFF_OACTIVE;\n\n\tsplx(s);\n\n\ttimeout(ef_tick, sc, hz);\n\n\tefstart(ifp);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void efstart",
      "void efstop",
      "void efsetmulti",
      "void efinit",
      "void efcompletecmd",
      "void ef_tick",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "efstart",
          "args": [
            "ifp"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "efstart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "244-343",
          "snippet": "void\nefstart(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct mbuf *m, *m0;\n\tint s, len, pad, i;\n\tint fillcnt = 0;\n\tu_int32_t filler = 0;\n\n\tif ((ifp->if_flags & (IFF_RUNNING | IFF_OACTIVE)) != IFF_RUNNING)\n\t\treturn;\n\nstartagain:\n\tm0 = ifp->if_snd.ifq_head;\n\tif (m0 == NULL)\n\t\treturn;\n\n\tif ((m0->m_flags & M_PKTHDR) == 0)\n\t\tpanic(\"efstart: no header mbuf\");\n\tlen = m0->m_pkthdr.len;\n\tpad = (4 - len) & 3;\n\n\tif (len + pad > ETHER_MAX_LEN) {\n\t\tifp->if_oerrors++;\n\t\tIF_DEQUEUE(&ifp->if_snd, m0);\n\t\tm_freem(m0);\n\t\tgoto startagain;\n\t}\n\n\tif (bus_space_read_2(iot, ioh, EF_W1_FREE_TX) < len + pad + 4) {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | ((len + pad) >> 2));\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t\treturn;\n\t} else {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | EP_THRESH_DISABLE);\n\t}\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_TX_START_THRESH |\n\t    ((len / 4 + sc->sc_tx_start_thresh)));\n\n#if NBPFILTER\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\n\tIF_DEQUEUE(&ifp->if_snd, m0);\n\tif (m0 == NULL) /* XXX not needed */\n\t\treturn;\n\n\ts = splhigh();\n\n\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1, len);\n\tfor (m = m0; m; ) {\n\t\tif (fillcnt) {\n\t\t\twhile (m->m_len && fillcnt < 4) {\n\t\t\t\tfillcnt++;\n\t\t\t\tfiller >>= 8;\n\t\t\t\tfiller |= m->m_data[0] << 24;\n\t\t\t\tm->m_data++;\n\t\t\t\tm->m_len--;\n\t\t\t}\n\t\t\tif (fillcnt == 4) {\n\t\t\t\tbus_space_write_4(iot, ioh,\n\t\t\t\t    EF_W1_TX_PIO_WR_1, filler);\n\t\t\t\tfiller = 0;\n\t\t\t\tfillcnt = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (m->m_len & ~3)\n\t\t\tbus_space_write_multi_4(iot, ioh,\n\t\t\t    EF_W1_TX_PIO_WR_1, (u_int32_t *)m->m_data,\n\t\t\t    m->m_len >> 2);\n\t\tfor (i = 0; i < (m->m_len & 3); i++) {\n\t\t\tfillcnt++;\n\t\t\tfiller >>= 8;\n\t\t\tfiller |= m->m_data[(m->m_len & ~3) + i] << 24;\n\t\t}\n\t\tMFREE(m, m0);\n\t\tm = m0;\n\t}\n\n\tif (fillcnt) {\n\t\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1,\n\t\t    filler >> (32 - (8 * fillcnt)));\n\t\tfillcnt = 0;\n\t\tfiller = 0;\n\t}\n\n\tsplx(s);\n\n\tifp->if_opackets++;\n\n\tgoto startagain;\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tEF_W1_FREE_TX\t\t0x1c",
            "#define\tEF_W1_TX_PIO_WR_1\t0x10",
            "#define\tETHER_MAX_LEN\t\t1518"
          ],
          "globals_used": [
            "void efstart",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W1_FREE_TX\t\t0x1c\n#define\tEF_W1_TX_PIO_WR_1\t0x10\n#define\tETHER_MAX_LEN\t\t1518\n\nvoid efstart;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefstart(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct mbuf *m, *m0;\n\tint s, len, pad, i;\n\tint fillcnt = 0;\n\tu_int32_t filler = 0;\n\n\tif ((ifp->if_flags & (IFF_RUNNING | IFF_OACTIVE)) != IFF_RUNNING)\n\t\treturn;\n\nstartagain:\n\tm0 = ifp->if_snd.ifq_head;\n\tif (m0 == NULL)\n\t\treturn;\n\n\tif ((m0->m_flags & M_PKTHDR) == 0)\n\t\tpanic(\"efstart: no header mbuf\");\n\tlen = m0->m_pkthdr.len;\n\tpad = (4 - len) & 3;\n\n\tif (len + pad > ETHER_MAX_LEN) {\n\t\tifp->if_oerrors++;\n\t\tIF_DEQUEUE(&ifp->if_snd, m0);\n\t\tm_freem(m0);\n\t\tgoto startagain;\n\t}\n\n\tif (bus_space_read_2(iot, ioh, EF_W1_FREE_TX) < len + pad + 4) {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | ((len + pad) >> 2));\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t\treturn;\n\t} else {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | EP_THRESH_DISABLE);\n\t}\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_TX_START_THRESH |\n\t    ((len / 4 + sc->sc_tx_start_thresh)));\n\n#if NBPFILTER\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\n\tIF_DEQUEUE(&ifp->if_snd, m0);\n\tif (m0 == NULL) /* XXX not needed */\n\t\treturn;\n\n\ts = splhigh();\n\n\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1, len);\n\tfor (m = m0; m; ) {\n\t\tif (fillcnt) {\n\t\t\twhile (m->m_len && fillcnt < 4) {\n\t\t\t\tfillcnt++;\n\t\t\t\tfiller >>= 8;\n\t\t\t\tfiller |= m->m_data[0] << 24;\n\t\t\t\tm->m_data++;\n\t\t\t\tm->m_len--;\n\t\t\t}\n\t\t\tif (fillcnt == 4) {\n\t\t\t\tbus_space_write_4(iot, ioh,\n\t\t\t\t    EF_W1_TX_PIO_WR_1, filler);\n\t\t\t\tfiller = 0;\n\t\t\t\tfillcnt = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (m->m_len & ~3)\n\t\t\tbus_space_write_multi_4(iot, ioh,\n\t\t\t    EF_W1_TX_PIO_WR_1, (u_int32_t *)m->m_data,\n\t\t\t    m->m_len >> 2);\n\t\tfor (i = 0; i < (m->m_len & 3); i++) {\n\t\t\tfillcnt++;\n\t\t\tfiller >>= 8;\n\t\t\tfiller |= m->m_data[(m->m_len & ~3) + i] << 24;\n\t\t}\n\t\tMFREE(m, m0);\n\t\tm = m0;\n\t}\n\n\tif (fillcnt) {\n\t\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1,\n\t\t    filler >> (32 - (8 * fillcnt)));\n\t\tfillcnt = 0;\n\t\tfiller = 0;\n\t}\n\n\tsplx(s);\n\n\tifp->if_opackets++;\n\n\tgoto startagain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "ef_tick",
            "sc",
            "hz"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "bt_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/bt.c",
          "lines": "1300-1345",
          "snippet": "void\nbt_timeout(arg)\n\tvoid *arg;\n{\n\tstruct bt_ccb *ccb = arg;\n\tstruct scsi_xfer *xs = ccb->xs;\n\tstruct scsi_link *sc_link = xs->sc_link;\n\tstruct bt_softc *sc = sc_link->adapter_softc;\n\tint s;\n\n\tsc_print_addr(sc_link);\n\tprintf(\"timed out\");\n\n\ts = splbio();\n\n#ifdef BTDIAG\n\t/*\n\t * If the ccb's mbx is not free, then the board has gone Far East?\n\t */\n\tbt_collect_mbo(sc);\n\tif (ccb->flags & CCB_SENDING) {\n\t\tprintf(\"%s: not taking commands!\\n\", sc->sc_dev.dv_xname);\n\t\tDebugger();\n\t}\n#endif\n\n\t/*\n\t * If it has been through before, then\n\t * a previous abort has failed, don't\n\t * try abort again\n\t */\n\tif (ccb->flags & CCB_ABORT) {\n\t\t/* abort timed out */\n\t\tprintf(\" AGAIN\\n\");\n\t\t/* XXX Must reset! */\n\t} else {\n\t\t/* abort the operation that has timed out */\n\t\tprintf(\"\\n\");\n\t\tccb->xs->error = XS_TIMEOUT;\n\t\tccb->timeout = BT_ABORT_TIMEOUT;\n\t\tccb->flags |= CCB_ABORT;\n\t\tbt_queue_ccb(sc, ccb);\n\t}\n\n\tsplx(s);\n}",
          "includes": [
            "#include \"bt.h\"",
            "#include \"aha.h\"",
            "#include <dev/isa/btreg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <scsi/scsiconf.h>",
            "#include <scsi/scsi_all.h>",
            "#include <machine/pio.h>",
            "#include <machine/intr.h>",
            "#include <sys/user.h>",
            "#include <sys/proc.h>",
            "#include <sys/buf.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define\tBT_ABORT_TIMEOUT\t2000\t/* time to wait for abort (mSec) */"
          ],
          "globals_used": [
            "bt_finish_ccbs __P((struct bt_softc *));",
            "bt_reset_ccb __P((struct bt_softc *, struct bt_ccb *));",
            "bt_init_ccb __P((struct bt_softc *, struct bt_ccb *));",
            "void bt_queue_ccb",
            "void bt_collect_mbo",
            "void bt_timeout",
            "struct bt_ccb *\nbt_get_ccb(sc, flags)\n\tstruct bt_softc *sc;",
            "int flags;",
            "struct bt_ccb *\nbt_ccb_phys_kv(sc, ccb_phys)\n\tstruct bt_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"bt.h\"\n#include \"aha.h\"\n#include <dev/isa/btreg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <scsi/scsiconf.h>\n#include <scsi/scsi_all.h>\n#include <machine/pio.h>\n#include <machine/intr.h>\n#include <sys/user.h>\n#include <sys/proc.h>\n#include <sys/buf.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define\tBT_ABORT_TIMEOUT\t2000\t/* time to wait for abort (mSec) */\n\nbt_finish_ccbs __P((struct bt_softc *));\nbt_reset_ccb __P((struct bt_softc *, struct bt_ccb *));\nbt_init_ccb __P((struct bt_softc *, struct bt_ccb *));\nvoid bt_queue_ccb;\nvoid bt_collect_mbo;\nvoid bt_timeout;\nstruct bt_ccb *\nbt_get_ccb(sc, flags)\n\tstruct bt_softc *sc;\nint flags;\nstruct bt_ccb *\nbt_ccb_phys_kv(sc, ccb_phys)\n\tstruct bt_softc *sc;\n\nvoid\nbt_timeout(arg)\n\tvoid *arg;\n{\n\tstruct bt_ccb *ccb = arg;\n\tstruct scsi_xfer *xs = ccb->xs;\n\tstruct scsi_link *sc_link = xs->sc_link;\n\tstruct bt_softc *sc = sc_link->adapter_softc;\n\tint s;\n\n\tsc_print_addr(sc_link);\n\tprintf(\"timed out\");\n\n\ts = splbio();\n\n#ifdef BTDIAG\n\t/*\n\t * If the ccb's mbx is not free, then the board has gone Far East?\n\t */\n\tbt_collect_mbo(sc);\n\tif (ccb->flags & CCB_SENDING) {\n\t\tprintf(\"%s: not taking commands!\\n\", sc->sc_dev.dv_xname);\n\t\tDebugger();\n\t}\n#endif\n\n\t/*\n\t * If it has been through before, then\n\t * a previous abort has failed, don't\n\t * try abort again\n\t */\n\tif (ccb->flags & CCB_ABORT) {\n\t\t/* abort timed out */\n\t\tprintf(\" AGAIN\\n\");\n\t\t/* XXX Must reset! */\n\t} else {\n\t\t/* abort the operation that has timed out */\n\t\tprintf(\"\\n\");\n\t\tccb->xs->error = XS_TIMEOUT;\n\t\tccb->timeout = BT_ABORT_TIMEOUT;\n\t\tccb->flags |= CCB_ABORT;\n\t\tbt_queue_ccb(sc, ccb);\n\t}\n\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mii_mediachg",
          "args": [
            "&sc->sc_mii"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "mii_mediachg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/mii/mii.c",
          "lines": "170-187",
          "snippet": "int\nmii_mediachg(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\tint rv;\n\n\tmii->mii_media_status = 0;\n\tmii->mii_media_active = IFM_NONE;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list)) {\n\t\trv = (*child->mii_service)(child, mii, MII_MEDIACHG);\n\t\tif (rv)\n\t\t\treturn (rv);\n\t}\n\treturn (0);\n}",
          "includes": [
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/socket.h>",
            "#include <sys/systm.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/socket.h>\n#include <sys/systm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nint\nmii_mediachg(mii)\n\tstruct mii_data *mii;\n{\n\tstruct mii_softc *child;\n\tint rv;\n\n\tmii->mii_media_status = 0;\n\tmii->mii_media_active = IFM_NONE;\n\n\tfor (child = LIST_FIRST(&mii->mii_phys); child != NULL;\n\t     child = LIST_NEXT(child, mii_list)) {\n\t\trv = (*child->mii_service)(child, mii, MII_MEDIACHG);\n\t\tif (rv)\n\t\t\treturn (rv);\n\t}\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_INTR_MASK |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_COMPLETE | S_UPD_STATS |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0) | S_UP_COMPLETE |\n\t    S_DOWN_COMPLETE | S_CARD_FAILURE | S_TX_COMPLETE"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "ACK_INTR |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_EARLY | S_INT_RQD"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "STATUS_ENABLE |\n\t    S_CARD_FAILURE | S_INT_RQD | S_UPD_STATS | S_TX_COMPLETE |\n\t    S_TX_AVAIL | S_RX_COMPLETE |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0)"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "TX_ENABLE"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "RX_ENABLE"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efsetmulti",
          "args": [
            "sc"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "efsetmulti",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "664-689",
          "snippet": "void\nefsetmulti(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct arpcom *ac = &sc->sc_arpcom;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ether_multi *enm;\n\tstruct ether_multistep step;\n\tu_int16_t cmd = SET_RX_FILTER | FIL_INDIVIDUAL | FIL_BRDCST;\n\tint mcnt = 0;\n\n\tETHER_FIRST_MULTI(step, ac, enm);\n\twhile (enm != NULL) {\n\t\tmcnt++;\n\t\tETHER_NEXT_MULTI(step, enm);\n\t}\n\tif (mcnt || ifp->if_flags & IFF_ALLMULTI)\n\t\tcmd |= FIL_MULTICAST;\n\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tcmd |= FIL_PROMISC;\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, cmd);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efsetmulti",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efsetmulti;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefsetmulti(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct arpcom *ac = &sc->sc_arpcom;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ether_multi *enm;\n\tstruct ether_multistep step;\n\tu_int16_t cmd = SET_RX_FILTER | FIL_INDIVIDUAL | FIL_BRDCST;\n\tint mcnt = 0;\n\n\tETHER_FIRST_MULTI(step, ac, enm);\n\twhile (enm != NULL) {\n\t\tmcnt++;\n\t\tETHER_NEXT_MULTI(step, enm);\n\t}\n\tif (mcnt || ifp->if_flags & IFF_ALLMULTI)\n\t\tcmd |= FIL_MULTICAST;\n\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tcmd |= FIL_PROMISC;\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "7"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_W4_NET_DIAG",
            "0x0040"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "ioh",
            "12"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "4"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "12"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "10"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "ioh",
            "i"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "6"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "STATUS_ENABLE | 0"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_TX_AVAIL_THRESH | (1536 >> 2)"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efcompletecmd",
          "args": [
            "sc",
            "EP_COMMAND",
            "TX_RESET"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "efcompletecmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "525-536",
          "snippet": "void\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efcompletecmd",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efcompletecmd;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_W2_RECVMASK_0 + (i * 2)",
            "0"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "ioh",
            "EP_W2_ADDR_0 + i",
            "sc->sc_arpcom.ac_enaddr[i]"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "2"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "EP_STATUS"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efstop",
          "args": [
            "sc"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "efstop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "497-523",
          "snippet": "void\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efstop",
            "void efcompletecmd",
            "void ef_tick",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstop;\nvoid efcompletecmd;\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splimp",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstart;\nvoid efstop;\nvoid efsetmulti;\nvoid efinit;\nvoid efcompletecmd;\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefinit(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i, s;\n\n\ts = splimp();\n\n\tefstop(sc);\n\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n\n\tGO_WINDOW(2);\n\tfor (i = 0; i < 6; i++)\n\t\tbus_space_write_1(iot, ioh, EP_W2_ADDR_0 + i,\n\t\t    sc->sc_arpcom.ac_enaddr[i]);\n\tfor (i = 0; i < 3; i += 2)\n\t\tbus_space_write_2(iot, ioh, EP_W2_RECVMASK_0 + (i * 2), 0);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t    SET_TX_AVAIL_THRESH | (1536 >> 2));\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE | 0);\n\n\tGO_WINDOW(6);\n\tfor (i = 0; i < 10; i++)\n\t\t(void)bus_space_read_1(iot, ioh, i);\n\t(void)bus_space_read_2(iot, ioh, 10);\n\t(void)bus_space_read_2(iot, ioh, 12);\n\tGO_WINDOW(4);\n\t(void)bus_space_read_1(iot, ioh, 12);\n\tbus_space_write_2(iot, ioh, EP_W4_NET_DIAG, 0x0040);\n\n\tGO_WINDOW(7);\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_ENABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE |\n\t    S_CARD_FAILURE | S_INT_RQD | S_UPD_STATS | S_TX_COMPLETE |\n\t    S_TX_AVAIL | S_RX_COMPLETE |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0));\n\tbus_space_write_2(iot, ioh, EP_COMMAND, ACK_INTR |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_EARLY | S_INT_RQD);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_COMPLETE | S_UPD_STATS |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0) | S_UP_COMPLETE |\n\t    S_DOWN_COMPLETE | S_CARD_FAILURE | S_TX_COMPLETE);\n\n\tmii_mediachg(&sc->sc_mii);\n\n\tifp->if_flags |= IFF_RUNNING;\n\tifp->if_flags &= ~IFF_OACTIVE;\n\n\tsplx(s);\n\n\ttimeout(ef_tick, sc, hz);\n\n\tefstart(ifp);\n}"
  },
  {
    "function_name": "efioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "345-411",
    "snippet": "int\nefioctl(ifp, cmd, data)\n\tstruct ifnet *ifp;\n\tu_long cmd;\n\tcaddr_t data;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tstruct ifaddr *ifa = (struct ifaddr *)data;\n\tstruct ifreq *ifr = (struct ifreq *)data;\n\tint s, error = 0;\n\n\ts = splnet();\n\n\tif ((error = ether_ioctl(ifp, &sc->sc_arpcom, cmd, data)) > 0) {\n\t\tsplx(s);\n\t\treturn (error);\n\t}\n\n\tswitch (cmd) {\n\tcase SIOCSIFADDR:\n\t\tifp->if_flags |= IFF_UP;\n\t\tswitch (ifa->ifa_addr->sa_family) {\n#ifdef INET\n\t\tcase AF_INET:\n\t\t\tefinit(sc);\n\t\t\tarp_ifinit(&sc->sc_arpcom, ifa);\n\t\t\tbreak;\n#endif\n\t\tdefault:\n\t\t\tefinit(sc);\n\t\t\tbreak;\n\t\t}\n\tcase SIOCSIFMEDIA:\n\tcase SIOCGIFMEDIA:\n\t\terror = ifmedia_ioctl(ifp, ifr, &sc->sc_mii.mii_media, cmd);\n\t\tbreak;\n\tcase SIOCSIFFLAGS:\n\t\tif ((ifp->if_flags & IFF_UP) == 0 &&\n\t\t    (ifp->if_flags & IFF_RUNNING) != 0) {\n\t\t\tefstop(sc);\n\t\t\tifp->if_flags &= ~IFF_RUNNING;\n\t\t} else if ((ifp->if_flags & IFF_UP) != 0 &&\n\t\t\t   (ifp->if_flags & IFF_RUNNING) == 0) {\n\t\t\tefinit(sc);\n\t\t}\n\t\tefsetmulti(sc);\n\t\tbreak;\n\n\tcase SIOCADDMULTI:\n\tcase SIOCDELMULTI:\n\t\terror = (cmd == SIOCADDMULTI) ?\n\t\t    ether_addmulti(ifr, &sc->sc_arpcom) :\n\t\t    ether_delmulti(ifr, &sc->sc_arpcom);\n\t\tif (error == ENETRESET) {\n\t\t\tefreset(sc);\n\t\t\terror = 0;\n\t\t}\n\t\tefsetmulti(sc);\n\t\tbreak;\n\tdefault:\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\n\tsplx(s);\n\treturn (error);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int efioctl",
      "void efreset",
      "void efstop",
      "void efsetmulti",
      "void efinit",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efsetmulti",
          "args": [
            "sc"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "efsetmulti",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "664-689",
          "snippet": "void\nefsetmulti(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct arpcom *ac = &sc->sc_arpcom;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ether_multi *enm;\n\tstruct ether_multistep step;\n\tu_int16_t cmd = SET_RX_FILTER | FIL_INDIVIDUAL | FIL_BRDCST;\n\tint mcnt = 0;\n\n\tETHER_FIRST_MULTI(step, ac, enm);\n\twhile (enm != NULL) {\n\t\tmcnt++;\n\t\tETHER_NEXT_MULTI(step, enm);\n\t}\n\tif (mcnt || ifp->if_flags & IFF_ALLMULTI)\n\t\tcmd |= FIL_MULTICAST;\n\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tcmd |= FIL_PROMISC;\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, cmd);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efsetmulti",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efsetmulti;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefsetmulti(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tstruct arpcom *ac = &sc->sc_arpcom;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct ether_multi *enm;\n\tstruct ether_multistep step;\n\tu_int16_t cmd = SET_RX_FILTER | FIL_INDIVIDUAL | FIL_BRDCST;\n\tint mcnt = 0;\n\n\tETHER_FIRST_MULTI(step, ac, enm);\n\twhile (enm != NULL) {\n\t\tmcnt++;\n\t\tETHER_NEXT_MULTI(step, enm);\n\t}\n\tif (mcnt || ifp->if_flags & IFF_ALLMULTI)\n\t\tcmd |= FIL_MULTICAST;\n\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tcmd |= FIL_PROMISC;\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "efreset",
          "args": [
            "sc"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "efreset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "485-495",
          "snippet": "void\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efreset",
            "void efstop",
            "void efinit",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efreset;\nvoid efstop;\nvoid efinit;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefreset(sc)\n\tstruct ef_softc *sc;\n{\n\tint s;\n\n\ts = splnet();\n\tefstop(sc);\n\tefinit(sc);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ether_delmulti",
          "args": [
            "ifr",
            "&sc->sc_arpcom"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ether_addmulti",
          "args": [
            "ifr",
            "&sc->sc_arpcom"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efinit",
          "args": [
            "sc"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "efinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "413-483",
          "snippet": "void\nefinit(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i, s;\n\n\ts = splimp();\n\n\tefstop(sc);\n\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n\n\tGO_WINDOW(2);\n\tfor (i = 0; i < 6; i++)\n\t\tbus_space_write_1(iot, ioh, EP_W2_ADDR_0 + i,\n\t\t    sc->sc_arpcom.ac_enaddr[i]);\n\tfor (i = 0; i < 3; i += 2)\n\t\tbus_space_write_2(iot, ioh, EP_W2_RECVMASK_0 + (i * 2), 0);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t    SET_TX_AVAIL_THRESH | (1536 >> 2));\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE | 0);\n\n\tGO_WINDOW(6);\n\tfor (i = 0; i < 10; i++)\n\t\t(void)bus_space_read_1(iot, ioh, i);\n\t(void)bus_space_read_2(iot, ioh, 10);\n\t(void)bus_space_read_2(iot, ioh, 12);\n\tGO_WINDOW(4);\n\t(void)bus_space_read_1(iot, ioh, 12);\n\tbus_space_write_2(iot, ioh, EP_W4_NET_DIAG, 0x0040);\n\n\tGO_WINDOW(7);\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_ENABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE |\n\t    S_CARD_FAILURE | S_INT_RQD | S_UPD_STATS | S_TX_COMPLETE |\n\t    S_TX_AVAIL | S_RX_COMPLETE |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0));\n\tbus_space_write_2(iot, ioh, EP_COMMAND, ACK_INTR |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_EARLY | S_INT_RQD);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_COMPLETE | S_UPD_STATS |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0) | S_UP_COMPLETE |\n\t    S_DOWN_COMPLETE | S_CARD_FAILURE | S_TX_COMPLETE);\n\n\tmii_mediachg(&sc->sc_mii);\n\n\tifp->if_flags |= IFF_RUNNING;\n\tifp->if_flags &= ~IFF_OACTIVE;\n\n\tsplx(s);\n\n\ttimeout(ef_tick, sc, hz);\n\n\tefstart(ifp);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efstart",
            "void efstop",
            "void efsetmulti",
            "void efinit",
            "void efcompletecmd",
            "void ef_tick",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstart;\nvoid efstop;\nvoid efsetmulti;\nvoid efinit;\nvoid efcompletecmd;\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefinit(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tint i, s;\n\n\ts = splimp();\n\n\tefstop(sc);\n\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n\n\tGO_WINDOW(2);\n\tfor (i = 0; i < 6; i++)\n\t\tbus_space_write_1(iot, ioh, EP_W2_ADDR_0 + i,\n\t\t    sc->sc_arpcom.ac_enaddr[i]);\n\tfor (i = 0; i < 3; i += 2)\n\t\tbus_space_write_2(iot, ioh, EP_W2_RECVMASK_0 + (i * 2), 0);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t    SET_TX_AVAIL_THRESH | (1536 >> 2));\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE | 0);\n\n\tGO_WINDOW(6);\n\tfor (i = 0; i < 10; i++)\n\t\t(void)bus_space_read_1(iot, ioh, i);\n\t(void)bus_space_read_2(iot, ioh, 10);\n\t(void)bus_space_read_2(iot, ioh, 12);\n\tGO_WINDOW(4);\n\t(void)bus_space_read_1(iot, ioh, 12);\n\tbus_space_write_2(iot, ioh, EP_W4_NET_DIAG, 0x0040);\n\n\tGO_WINDOW(7);\n\n\tefsetmulti(sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_ENABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_ENABLE);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STATUS_ENABLE |\n\t    S_CARD_FAILURE | S_INT_RQD | S_UPD_STATS | S_TX_COMPLETE |\n\t    S_TX_AVAIL | S_RX_COMPLETE |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0));\n\tbus_space_write_2(iot, ioh, EP_COMMAND, ACK_INTR |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_EARLY | S_INT_RQD);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK |\n\t    S_INTR_LATCH | S_TX_AVAIL | S_RX_COMPLETE | S_UPD_STATS |\n\t    (sc->sc_busmaster ? S_DMA_DONE : 0) | S_UP_COMPLETE |\n\t    S_DOWN_COMPLETE | S_CARD_FAILURE | S_TX_COMPLETE);\n\n\tmii_mediachg(&sc->sc_mii);\n\n\tifp->if_flags |= IFF_RUNNING;\n\tifp->if_flags &= ~IFF_OACTIVE;\n\n\tsplx(s);\n\n\ttimeout(ef_tick, sc, hz);\n\n\tefstart(ifp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "efstop",
          "args": [
            "sc"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "efstop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "497-523",
          "snippet": "void\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efstop",
            "void efcompletecmd",
            "void ef_tick",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efstop;\nvoid efcompletecmd;\nvoid ef_tick;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefstop(sc)\n\tstruct ef_softc *sc;\n{\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tifp->if_timer = 0;\n\tifp->if_flags &= ~(IFF_RUNNING | IFF_OACTIVE);\n\n\tuntimeout(ef_tick, sc);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, RX_DISABLE);\n\tefcompletecmd(sc, EP_COMMAND, RX_DISCARD_TOP_PACK);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, TX_DISABLE);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, STOP_TRANSCEIVER);\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, C_INTR_LATCH);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RD_0_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_INTR_MASK);\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_RX_FILTER);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ifmedia_ioctl",
          "args": [
            "ifp",
            "ifr",
            "&sc->sc_mii.mii_media",
            "cmd"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arp_ifinit",
          "args": [
            "&sc->sc_arpcom",
            "ifa"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "arp_ifinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_devar.h",
          "lines": "929-936",
          "snippet": "static void\narp_ifinit(\n    struct arpcom *ac,\n    struct ifaddr *ifa)\n{\n    ac->ac_ipaddr = IA_SIN(ifa)->sin_addr;\n    arpwhohas(ac, &ac->ac_ipaddr);\n}",
          "includes": [
            "#include <sys/devconf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/devconf.h>\n\nstatic void\narp_ifinit(\n    struct arpcom *ac,\n    struct ifaddr *ifa)\n{\n    ac->ac_ipaddr = IA_SIN(ifa)->sin_addr;\n    arpwhohas(ac, &ac->ac_ipaddr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ether_ioctl",
          "args": [
            "ifp",
            "&sc->sc_arpcom",
            "cmd",
            "data"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "wx_ether_ioctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_wx.c",
          "lines": "303-356",
          "snippet": "static int\nwx_ether_ioctl(ifp, cmd, data)\n\tstruct ifnet *ifp;\n\tIOCTL_CMD_TYPE cmd;\n\tcaddr_t data;\n{\n\tstruct ifaddr *ifa = (struct ifaddr *) data;\n\tint error = 0;\n\twx_softc_t *sc = SOFTC_IFP(ifp);\n\n\tswitch (cmd) {\n\tcase SIOCSIFADDR:\n\t\tifp->if_flags |= IFF_UP;\n\t\terror = wx_init(sc);\n\t\tif (error) {\n\t\t\tifp->if_flags &= ~IFF_UP;\n\t\t\tbreak;\n\t\t}\n\t\tswitch (ifa->ifa_addr->sa_family) {\n#ifdef INET\n\t\tcase AF_INET:\n#ifdef __OpenBSD__\n\t\t\tarp_ifinit(&sc->w.arpcom, ifa);\n#else\n\t\t\tarp_ifinit(ifp, ifa);\n#endif\n\t\t\tbreak;\n#endif\n#ifdef NS\n\t\tcase AF_NS:\n\t\t{\n\t\t\t register struct ns_addr *ina = &IA_SNS(ifa)->sns_addr;\n\t\t\t if (ns_nullhost(*ina))\n\t\t\t\tina->x_host = *(union ns_host *)\n\t\t\t\t    LLADDR(ifp->if_sadl);\n\t\t\t else\n\t\t\t\tbcopy(ina->x_host.c_host, LLADDR(ifp->if_sadl),\n\t\t\t\t    ifp->if_addrlen);\n\t\t\t break;\n\t\t}\n#endif\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\n\t\tbreak;\n\n\tdefault:\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\n\treturn (0);\n}",
          "includes": [
            "#include <pci/if_wxvar.h>",
            "#include <dev/pci/if_wxvar.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int wx_init",
            "wx_eeprom_sibits __P((wx_softc_t *));",
            "wx_eeprom_cleanup __P((wx_softc_t *));",
            "wx_read_eeprom_word __P((wx_softc_t *, int));",
            "wx_mwi_whackon\t__P((wx_softc_t *));",
            "wx_mwi_unwhack\t__P((wx_softc_t *));"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <pci/if_wxvar.h>\n#include <dev/pci/if_wxvar.h>\n\nstatic int wx_init;\nwx_eeprom_sibits __P((wx_softc_t *));\nwx_eeprom_cleanup __P((wx_softc_t *));\nwx_read_eeprom_word __P((wx_softc_t *, int));\nwx_mwi_whackon\t__P((wx_softc_t *));\nwx_mwi_unwhack\t__P((wx_softc_t *));\n\nstatic int\nwx_ether_ioctl(ifp, cmd, data)\n\tstruct ifnet *ifp;\n\tIOCTL_CMD_TYPE cmd;\n\tcaddr_t data;\n{\n\tstruct ifaddr *ifa = (struct ifaddr *) data;\n\tint error = 0;\n\twx_softc_t *sc = SOFTC_IFP(ifp);\n\n\tswitch (cmd) {\n\tcase SIOCSIFADDR:\n\t\tifp->if_flags |= IFF_UP;\n\t\terror = wx_init(sc);\n\t\tif (error) {\n\t\t\tifp->if_flags &= ~IFF_UP;\n\t\t\tbreak;\n\t\t}\n\t\tswitch (ifa->ifa_addr->sa_family) {\n#ifdef INET\n\t\tcase AF_INET:\n#ifdef __OpenBSD__\n\t\t\tarp_ifinit(&sc->w.arpcom, ifa);\n#else\n\t\t\tarp_ifinit(ifp, ifa);\n#endif\n\t\t\tbreak;\n#endif\n#ifdef NS\n\t\tcase AF_NS:\n\t\t{\n\t\t\t register struct ns_addr *ina = &IA_SNS(ifa)->sns_addr;\n\t\t\t if (ns_nullhost(*ina))\n\t\t\t\tina->x_host = *(union ns_host *)\n\t\t\t\t    LLADDR(ifp->if_sadl);\n\t\t\t else\n\t\t\t\tbcopy(ina->x_host.c_host, LLADDR(ifp->if_sadl),\n\t\t\t\t    ifp->if_addrlen);\n\t\t\t break;\n\t\t}\n#endif\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\n\t\tbreak;\n\n\tdefault:\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splnet",
          "args": [],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint efioctl;\nvoid efreset;\nvoid efstop;\nvoid efsetmulti;\nvoid efinit;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nint\nefioctl(ifp, cmd, data)\n\tstruct ifnet *ifp;\n\tu_long cmd;\n\tcaddr_t data;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tstruct ifaddr *ifa = (struct ifaddr *)data;\n\tstruct ifreq *ifr = (struct ifreq *)data;\n\tint s, error = 0;\n\n\ts = splnet();\n\n\tif ((error = ether_ioctl(ifp, &sc->sc_arpcom, cmd, data)) > 0) {\n\t\tsplx(s);\n\t\treturn (error);\n\t}\n\n\tswitch (cmd) {\n\tcase SIOCSIFADDR:\n\t\tifp->if_flags |= IFF_UP;\n\t\tswitch (ifa->ifa_addr->sa_family) {\n#ifdef INET\n\t\tcase AF_INET:\n\t\t\tefinit(sc);\n\t\t\tarp_ifinit(&sc->sc_arpcom, ifa);\n\t\t\tbreak;\n#endif\n\t\tdefault:\n\t\t\tefinit(sc);\n\t\t\tbreak;\n\t\t}\n\tcase SIOCSIFMEDIA:\n\tcase SIOCGIFMEDIA:\n\t\terror = ifmedia_ioctl(ifp, ifr, &sc->sc_mii.mii_media, cmd);\n\t\tbreak;\n\tcase SIOCSIFFLAGS:\n\t\tif ((ifp->if_flags & IFF_UP) == 0 &&\n\t\t    (ifp->if_flags & IFF_RUNNING) != 0) {\n\t\t\tefstop(sc);\n\t\t\tifp->if_flags &= ~IFF_RUNNING;\n\t\t} else if ((ifp->if_flags & IFF_UP) != 0 &&\n\t\t\t   (ifp->if_flags & IFF_RUNNING) == 0) {\n\t\t\tefinit(sc);\n\t\t}\n\t\tefsetmulti(sc);\n\t\tbreak;\n\n\tcase SIOCADDMULTI:\n\tcase SIOCDELMULTI:\n\t\terror = (cmd == SIOCADDMULTI) ?\n\t\t    ether_addmulti(ifr, &sc->sc_arpcom) :\n\t\t    ether_delmulti(ifr, &sc->sc_arpcom);\n\t\tif (error == ENETRESET) {\n\t\t\tefreset(sc);\n\t\t\terror = 0;\n\t\t}\n\t\tefsetmulti(sc);\n\t\tbreak;\n\tdefault:\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\n\tsplx(s);\n\treturn (error);\n}"
  },
  {
    "function_name": "efstart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "244-343",
    "snippet": "void\nefstart(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct mbuf *m, *m0;\n\tint s, len, pad, i;\n\tint fillcnt = 0;\n\tu_int32_t filler = 0;\n\n\tif ((ifp->if_flags & (IFF_RUNNING | IFF_OACTIVE)) != IFF_RUNNING)\n\t\treturn;\n\nstartagain:\n\tm0 = ifp->if_snd.ifq_head;\n\tif (m0 == NULL)\n\t\treturn;\n\n\tif ((m0->m_flags & M_PKTHDR) == 0)\n\t\tpanic(\"efstart: no header mbuf\");\n\tlen = m0->m_pkthdr.len;\n\tpad = (4 - len) & 3;\n\n\tif (len + pad > ETHER_MAX_LEN) {\n\t\tifp->if_oerrors++;\n\t\tIF_DEQUEUE(&ifp->if_snd, m0);\n\t\tm_freem(m0);\n\t\tgoto startagain;\n\t}\n\n\tif (bus_space_read_2(iot, ioh, EF_W1_FREE_TX) < len + pad + 4) {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | ((len + pad) >> 2));\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t\treturn;\n\t} else {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | EP_THRESH_DISABLE);\n\t}\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_TX_START_THRESH |\n\t    ((len / 4 + sc->sc_tx_start_thresh)));\n\n#if NBPFILTER\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\n\tIF_DEQUEUE(&ifp->if_snd, m0);\n\tif (m0 == NULL) /* XXX not needed */\n\t\treturn;\n\n\ts = splhigh();\n\n\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1, len);\n\tfor (m = m0; m; ) {\n\t\tif (fillcnt) {\n\t\t\twhile (m->m_len && fillcnt < 4) {\n\t\t\t\tfillcnt++;\n\t\t\t\tfiller >>= 8;\n\t\t\t\tfiller |= m->m_data[0] << 24;\n\t\t\t\tm->m_data++;\n\t\t\t\tm->m_len--;\n\t\t\t}\n\t\t\tif (fillcnt == 4) {\n\t\t\t\tbus_space_write_4(iot, ioh,\n\t\t\t\t    EF_W1_TX_PIO_WR_1, filler);\n\t\t\t\tfiller = 0;\n\t\t\t\tfillcnt = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (m->m_len & ~3)\n\t\t\tbus_space_write_multi_4(iot, ioh,\n\t\t\t    EF_W1_TX_PIO_WR_1, (u_int32_t *)m->m_data,\n\t\t\t    m->m_len >> 2);\n\t\tfor (i = 0; i < (m->m_len & 3); i++) {\n\t\t\tfillcnt++;\n\t\t\tfiller >>= 8;\n\t\t\tfiller |= m->m_data[(m->m_len & ~3) + i] << 24;\n\t\t}\n\t\tMFREE(m, m0);\n\t\tm = m0;\n\t}\n\n\tif (fillcnt) {\n\t\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1,\n\t\t    filler >> (32 - (8 * fillcnt)));\n\t\tfillcnt = 0;\n\t\tfiller = 0;\n\t}\n\n\tsplx(s);\n\n\tifp->if_opackets++;\n\n\tgoto startagain;\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define\tEF_W1_FREE_TX\t\t0x1c",
      "#define\tEF_W1_TX_PIO_WR_1\t0x10",
      "#define\tETHER_MAX_LEN\t\t1518"
    ],
    "globals_used": [
      "void efstart",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "iot",
            "ioh",
            "EF_W1_TX_PIO_WR_1",
            "filler >> (32 - (8 * fillcnt))"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MFREE",
          "args": [
            "m",
            "m0"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_multi_4",
          "args": [
            "iot",
            "ioh",
            "EF_W1_TX_PIO_WR_1",
            "(u_int32_t *)m->m_data",
            "m->m_len >> 2"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "iot",
            "ioh",
            "EF_W1_TX_PIO_WR_1",
            "filler"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "iot",
            "ioh",
            "EF_W1_TX_PIO_WR_1",
            "len"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splhigh",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&ifp->if_snd",
            "m0"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_mtap",
          "args": [
            "ifp->if_bpf",
            "m0"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_TX_START_THRESH |\n\t    ((len / 4 + sc->sc_tx_start_thresh))"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_TX_AVAIL_THRESH | EP_THRESH_DISABLE"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EP_COMMAND",
            "SET_TX_AVAIL_THRESH | ((len + pad) >> 2)"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "EF_W1_FREE_TX"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m0"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&ifp->if_snd",
            "m0"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"efstart: no header mbuf\""
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W1_FREE_TX\t\t0x1c\n#define\tEF_W1_TX_PIO_WR_1\t0x10\n#define\tETHER_MAX_LEN\t\t1518\n\nvoid efstart;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefstart(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct ef_softc *sc = ifp->if_softc;\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\tstruct mbuf *m, *m0;\n\tint s, len, pad, i;\n\tint fillcnt = 0;\n\tu_int32_t filler = 0;\n\n\tif ((ifp->if_flags & (IFF_RUNNING | IFF_OACTIVE)) != IFF_RUNNING)\n\t\treturn;\n\nstartagain:\n\tm0 = ifp->if_snd.ifq_head;\n\tif (m0 == NULL)\n\t\treturn;\n\n\tif ((m0->m_flags & M_PKTHDR) == 0)\n\t\tpanic(\"efstart: no header mbuf\");\n\tlen = m0->m_pkthdr.len;\n\tpad = (4 - len) & 3;\n\n\tif (len + pad > ETHER_MAX_LEN) {\n\t\tifp->if_oerrors++;\n\t\tIF_DEQUEUE(&ifp->if_snd, m0);\n\t\tm_freem(m0);\n\t\tgoto startagain;\n\t}\n\n\tif (bus_space_read_2(iot, ioh, EF_W1_FREE_TX) < len + pad + 4) {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | ((len + pad) >> 2));\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t\treturn;\n\t} else {\n\t\tbus_space_write_2(iot, ioh, EP_COMMAND,\n\t\t    SET_TX_AVAIL_THRESH | EP_THRESH_DISABLE);\n\t}\n\n\tbus_space_write_2(iot, ioh, EP_COMMAND, SET_TX_START_THRESH |\n\t    ((len / 4 + sc->sc_tx_start_thresh)));\n\n#if NBPFILTER\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\n\tIF_DEQUEUE(&ifp->if_snd, m0);\n\tif (m0 == NULL) /* XXX not needed */\n\t\treturn;\n\n\ts = splhigh();\n\n\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1, len);\n\tfor (m = m0; m; ) {\n\t\tif (fillcnt) {\n\t\t\twhile (m->m_len && fillcnt < 4) {\n\t\t\t\tfillcnt++;\n\t\t\t\tfiller >>= 8;\n\t\t\t\tfiller |= m->m_data[0] << 24;\n\t\t\t\tm->m_data++;\n\t\t\t\tm->m_len--;\n\t\t\t}\n\t\t\tif (fillcnt == 4) {\n\t\t\t\tbus_space_write_4(iot, ioh,\n\t\t\t\t    EF_W1_TX_PIO_WR_1, filler);\n\t\t\t\tfiller = 0;\n\t\t\t\tfillcnt = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (m->m_len & ~3)\n\t\t\tbus_space_write_multi_4(iot, ioh,\n\t\t\t    EF_W1_TX_PIO_WR_1, (u_int32_t *)m->m_data,\n\t\t\t    m->m_len >> 2);\n\t\tfor (i = 0; i < (m->m_len & 3); i++) {\n\t\t\tfillcnt++;\n\t\t\tfiller >>= 8;\n\t\t\tfiller |= m->m_data[(m->m_len & ~3) + i] << 24;\n\t\t}\n\t\tMFREE(m, m0);\n\t\tm = m0;\n\t}\n\n\tif (fillcnt) {\n\t\tbus_space_write_4(iot, ioh, EF_W1_TX_PIO_WR_1,\n\t\t    filler >> (32 - (8 * fillcnt)));\n\t\tfillcnt = 0;\n\t\tfiller = 0;\n\t}\n\n\tsplx(s);\n\n\tifp->if_opackets++;\n\n\tgoto startagain;\n}"
  },
  {
    "function_name": "ef_isapnp_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "160-242",
    "snippet": "void\nef_isapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct ef_softc *sc = (void *)self;\n\tstruct isa_attach_args *ia = aux;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot;\n\tbus_space_handle_t ioh;\n\tint i;\n\tu_int16_t x;\n\tu_int32_t cfg;\n\n\tsc->sc_iot = iot = ia->ia_iot;\n\tsc->sc_ioh = ioh = ia->ipa_io[0].h;\n\n\tefcompletecmd(sc, EP_COMMAND, GLOBAL_RESET);\n\tDELAY(1500);\n\n\tfor (i = 0; i < 3; i++) {\n\t\tif (efbusyeeprom(sc))\n\t\t\treturn;\n\n\t\tbus_space_write_2(iot, ioh, EF_W0_EEPROM_COMMAND,\n\t\t    EF_EEPROM_READ | i);\n\n\t\tif (efbusyeeprom(sc))\n\t\t\treturn;\n\n\t\tx = bus_space_read_2(iot, ioh, EF_W0_EEPROM_DATA);\n\n\t\tsc->sc_arpcom.ac_enaddr[(i << 1)] = x >> 8;\n\t\tsc->sc_arpcom.ac_enaddr[(i << 1) + 1] = x;\n\t}\n\n\tprintf(\": address %s\\n\", ether_sprintf(sc->sc_arpcom.ac_enaddr));\n\n\tGO_WINDOW(3);\n\tcfg = bus_space_read_4(iot, ioh, EP_W3_INTERNAL_CONFIG);\n\tcfg &= ~(0x00f00000);\n\tcfg |= (0x06 << 20);\n\tbus_space_write_4(iot, ioh, EP_W3_INTERNAL_CONFIG, cfg);\n\n\tsc->sc_ih = isa_intr_establish(ia->ia_ic, ia->ia_irq, IST_EDGE,\n\t    IPL_NET, efintr, sc, sc->sc_dv.dv_xname);\n\n\tif (ia->ia_drq != DRQUNK)\n\t\tisadma_cascade(ia->ia_drq);\n\n\tbcopy(sc->sc_dv.dv_xname, ifp->if_xname, IFNAMSIZ);\n\tifp->if_softc = sc;\n\tifp->if_start = efstart;\n\tifp->if_ioctl = efioctl;\n\tifp->if_watchdog = efwatchdog;\n\tifp->if_flags =\n\t    IFF_BROADCAST | IFF_SIMPLEX | IFF_NOTRAILERS | IFF_MULTICAST;\n\n\tsc->sc_mii.mii_ifp = ifp;\n\tsc->sc_mii.mii_readreg = ef_miibus_readreg;\n\tsc->sc_mii.mii_writereg = ef_miibus_writereg;\n\tsc->sc_mii.mii_statchg = ef_miibus_statchg;\n\tifmedia_init(&sc->sc_mii.mii_media, 0, ef_ifmedia_upd, ef_ifmedia_sts);\n\tmii_phy_probe(self, &sc->sc_mii, 0xffffffff);\n\tif (LIST_FIRST(&sc->sc_mii.mii_phys) == NULL) {\n\t\tifmedia_add(&sc->sc_mii.mii_media, IFM_ETHER|IFM_NONE, 0, NULL);\n\t\tifmedia_set(&sc->sc_mii.mii_media, IFM_ETHER|IFM_NONE);\n\t} else\n\t\tifmedia_set(&sc->sc_mii.mii_media, IFM_ETHER|IFM_AUTO);\n\n\tif_attach(ifp);\n\tether_ifattach(ifp);\n\n#if NBPFILTER > 0\n\tbpfattach(&sc->sc_arpcom.ac_if.if_bpf, ifp, DLT_EN10MB,\n\t   sizeof(struct ether_header));\n#endif\n\n\tsc->sc_tx_start_thresh = 20;\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define\tEF_W0_EEPROM_DATA\t0x200c",
      "#define    EF_EEPROM_READ\t(1 << 7)",
      "#define\tEF_W0_EEPROM_COMMAND\t0x200a"
    ],
    "globals_used": [
      "void ef_isapnp_attach",
      "void efstart",
      "int efioctl",
      "void efwatchdog",
      "int efbusyeeprom",
      "int efintr",
      "void efcompletecmd",
      "void ef_miibus_writereg",
      "void ef_miibus_statchg",
      "int ef_miibus_readreg",
      "int ef_ifmedia_upd",
      "void ef_ifmedia_sts",
      "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "efcompletecmd",
          "args": [
            "sc",
            "EP_COMMAND",
            "TX_RESET"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "efcompletecmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "525-536",
          "snippet": "void\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void efcompletecmd",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid efcompletecmd;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nefcompletecmd(sc, cmd, arg)\n\tstruct ef_softc *sc;\n\tu_int cmd, arg;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tbus_space_handle_t ioh = sc->sc_ioh;\n\n\tbus_space_write_2(iot, ioh, cmd, arg);\n\twhile (bus_space_read_2(iot, ioh, EP_STATUS) & S_COMMAND_IN_PROGRESS)\n\t\t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpfattach",
          "args": [
            "&sc->sc_arpcom.ac_if.if_bpf",
            "ifp",
            "DLT_EN10MB",
            "sizeof(struct ether_header)"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ether_ifattach",
          "args": [
            "ifp"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if_attach",
          "args": [
            "ifp"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ifmedia_set",
          "args": [
            "&sc->sc_mii.mii_media",
            "IFM_ETHER|IFM_AUTO"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ifmedia_set",
          "args": [
            "&sc->sc_mii.mii_media",
            "IFM_ETHER|IFM_NONE"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ifmedia_add",
          "args": [
            "&sc->sc_mii.mii_media",
            "IFM_ETHER|IFM_NONE",
            "0",
            "NULL"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_FIRST",
          "args": [
            "&sc->sc_mii.mii_phys"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mii_phy_probe",
          "args": [
            "self",
            "&sc->sc_mii",
            "0xffffffff"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "mii_phy_probe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/mii/mii.c",
          "lines": "68-122",
          "snippet": "void\nmii_phy_probe(parent, mii, capmask)\n\tstruct device *parent;\n\tstruct mii_data *mii;\n\tint capmask;\n{\n\tstruct mii_attach_args ma;\n\tstruct mii_softc *child;\n\n\tLIST_INIT(&mii->mii_phys);\n\n\tfor (ma.mii_phyno = 0; ma.mii_phyno < MII_NPHY; ma.mii_phyno++) {\n\t\t/*\n\t\t * Check to see if there is a PHY at this address.  If\n\t\t * the register contains garbage, assume no.\n\t\t */\n\t\tma.mii_id1 = (*mii->mii_readreg)(parent, ma.mii_phyno,\n\t\t    MII_PHYIDR1);\n\t\tma.mii_id2 = (*mii->mii_readreg)(parent, ma.mii_phyno,\n\t\t    MII_PHYIDR2);\n\t\tif ((ma.mii_id1 == 0 || ma.mii_id1 == 0xffff) &&\n\t\t    (ma.mii_id2 == 0 || ma.mii_id2 == 0xffff)) {\n\t\t\t/*\n\t\t\t * ARGH!!  3Com internal PHYs report 0/0 in their\n\t\t\t * ID registers!  If we spot this, check to see\n\t\t\t * if the BMSR has reasonable data in it.\n\t\t\t * And if that wasn't enough there are PHYs\n\t\t\t * reporting 0xffff/0xffff too.\n\t\t\t */\n\t\t\tif ((MII_OUI(ma.mii_id1, ma.mii_id2) == 0 &&\n\t\t\t    MII_MODEL(ma.mii_id2) == 0) ||\n\t\t\t    (MII_OUI(ma.mii_id1, ma.mii_id2) == 0x3fffff &&\n\t\t\t    MII_MODEL(ma.mii_id2) == 0x3f)) {\n\t\t\t\tint bmsr = (*mii->mii_readreg)(parent,\n\t\t\t\t    ma.mii_phyno, MII_BMSR);\n\t\t\t\tif (bmsr == 0 || bmsr == 0xffff ||\n\t\t\t\t    (bmsr & BMSR_MEDIAMASK) == 0)\n\t\t\t\t\tcontinue;\n\t\t\t} else\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tma.mii_data = mii;\n\t\tma.mii_capmask = capmask;\n\n\t\tif ((child = (struct mii_softc *)config_found_sm(parent, &ma,\n\t\t    mii_print, mii_submatch)) != NULL) {\n\t\t\t/*\n\t\t\t * Link it up in the parent's MII data.\n\t\t\t */\n\t\t\tLIST_INSERT_HEAD(&mii->mii_phys, child, mii_list);\n\t\t\tmii->mii_instance++;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/socket.h>",
            "#include <sys/systm.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tmii_print",
            "int\tmii_submatch"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/socket.h>\n#include <sys/systm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nint\tmii_print;\nint\tmii_submatch;\n\nvoid\nmii_phy_probe(parent, mii, capmask)\n\tstruct device *parent;\n\tstruct mii_data *mii;\n\tint capmask;\n{\n\tstruct mii_attach_args ma;\n\tstruct mii_softc *child;\n\n\tLIST_INIT(&mii->mii_phys);\n\n\tfor (ma.mii_phyno = 0; ma.mii_phyno < MII_NPHY; ma.mii_phyno++) {\n\t\t/*\n\t\t * Check to see if there is a PHY at this address.  If\n\t\t * the register contains garbage, assume no.\n\t\t */\n\t\tma.mii_id1 = (*mii->mii_readreg)(parent, ma.mii_phyno,\n\t\t    MII_PHYIDR1);\n\t\tma.mii_id2 = (*mii->mii_readreg)(parent, ma.mii_phyno,\n\t\t    MII_PHYIDR2);\n\t\tif ((ma.mii_id1 == 0 || ma.mii_id1 == 0xffff) &&\n\t\t    (ma.mii_id2 == 0 || ma.mii_id2 == 0xffff)) {\n\t\t\t/*\n\t\t\t * ARGH!!  3Com internal PHYs report 0/0 in their\n\t\t\t * ID registers!  If we spot this, check to see\n\t\t\t * if the BMSR has reasonable data in it.\n\t\t\t * And if that wasn't enough there are PHYs\n\t\t\t * reporting 0xffff/0xffff too.\n\t\t\t */\n\t\t\tif ((MII_OUI(ma.mii_id1, ma.mii_id2) == 0 &&\n\t\t\t    MII_MODEL(ma.mii_id2) == 0) ||\n\t\t\t    (MII_OUI(ma.mii_id1, ma.mii_id2) == 0x3fffff &&\n\t\t\t    MII_MODEL(ma.mii_id2) == 0x3f)) {\n\t\t\t\tint bmsr = (*mii->mii_readreg)(parent,\n\t\t\t\t    ma.mii_phyno, MII_BMSR);\n\t\t\t\tif (bmsr == 0 || bmsr == 0xffff ||\n\t\t\t\t    (bmsr & BMSR_MEDIAMASK) == 0)\n\t\t\t\t\tcontinue;\n\t\t\t} else\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tma.mii_data = mii;\n\t\tma.mii_capmask = capmask;\n\n\t\tif ((child = (struct mii_softc *)config_found_sm(parent, &ma,\n\t\t    mii_print, mii_submatch)) != NULL) {\n\t\t\t/*\n\t\t\t * Link it up in the parent's MII data.\n\t\t\t */\n\t\t\tLIST_INSERT_HEAD(&mii->mii_phys, child, mii_list);\n\t\t\tmii->mii_instance++;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ifmedia_init",
          "args": [
            "&sc->sc_mii.mii_media",
            "0",
            "ef_ifmedia_upd",
            "ef_ifmedia_sts"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bcopy",
          "args": [
            "sc->sc_dv.dv_xname",
            "ifp->if_xname",
            "IFNAMSIZ"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "tr_bcopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/tropic.c",
          "lines": "1618-1663",
          "snippet": "void \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}",
          "includes": [
            "#include <dev/ic/tropicvar.h>",
            "#include <dev/ic/tropicreg.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <net/if_token.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_media.h>",
            "#include <net/if_llc.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/syslog.h>",
            "#include <sys/socket.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void\ttr_bcopy",
            "struct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/tropicvar.h>\n#include <dev/ic/tropicreg.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <net/if_token.h>\n#include <netinet/in_var.h>\n#include <netinet/ip.h>\n#include <netinet/if_ether.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_media.h>\n#include <net/if_llc.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/syslog.h>\n#include <sys/socket.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\ttr_bcopy;\nstruct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;\n\nvoid \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "isadma_cascade",
          "args": [
            "ia->ia_drq"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isa_intr_establish",
          "args": [
            "ia->ia_ic",
            "ia->ia_irq",
            "IST_EDGE",
            "IPL_NET",
            "efintr",
            "sc",
            "sc->sc_dv.dv_xname"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "iot",
            "ioh",
            "EP_W3_INTERNAL_CONFIG",
            "cfg"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_4",
          "args": [
            "iot",
            "ioh",
            "EP_W3_INTERNAL_CONFIG"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GO_WINDOW",
          "args": [
            "3"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\": address %s\\n\"",
            "ether_sprintf(sc->sc_arpcom.ac_enaddr)"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ether_sprintf",
          "args": [
            "sc->sc_arpcom.ac_enaddr"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "iot",
            "ioh",
            "EF_W0_EEPROM_DATA"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efbusyeeprom",
          "args": [
            "sc"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "efbusyeeprom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
          "lines": "630-651",
          "snippet": "int\nefbusyeeprom(sc)\n\tstruct ef_softc *sc;\n{\n\tint i = 100, j;\n\n\twhile (i--) {\n\t\tj = bus_space_read_2(sc->sc_iot, sc->sc_ioh,\n\t\t\t\t     EF_W0_EEPROM_COMMAND);\n\t\tif (j & EF_EEPROM_BUSY)\n\t\t\tdelay(100);\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (i == 0) {\n\t\tprintf(\"%s: eeprom failed to come ready\\n\",\n\t\t   sc->sc_dv.dv_xname);\n\t\treturn (1);\n\t}\n\n\treturn (0);\n}",
          "includes": [
            "#include <dev/ic/elink3reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/netisr.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/kernel.h>",
            "#include <sys/queue.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define    EF_EEPROM_BUSY\t(1 << 9)",
            "#define\tEF_W0_EEPROM_COMMAND\t0x200a"
          ],
          "globals_used": [
            "int efbusyeeprom",
            "struct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define    EF_EEPROM_BUSY\t(1 << 9)\n#define\tEF_W0_EEPROM_COMMAND\t0x200a\n\nint efbusyeeprom;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nint\nefbusyeeprom(sc)\n\tstruct ef_softc *sc;\n{\n\tint i = 100, j;\n\n\twhile (i--) {\n\t\tj = bus_space_read_2(sc->sc_iot, sc->sc_ioh,\n\t\t\t\t     EF_W0_EEPROM_COMMAND);\n\t\tif (j & EF_EEPROM_BUSY)\n\t\t\tdelay(100);\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (i == 0) {\n\t\tprintf(\"%s: eeprom failed to come ready\\n\",\n\t\t   sc->sc_dv.dv_xname);\n\t\treturn (1);\n\t}\n\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "iot",
            "ioh",
            "EF_W0_EEPROM_COMMAND",
            "EF_EEPROM_READ | i"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1500"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tEF_W0_EEPROM_DATA\t0x200c\n#define    EF_EEPROM_READ\t(1 << 7)\n#define\tEF_W0_EEPROM_COMMAND\t0x200a\n\nvoid ef_isapnp_attach;\nvoid efstart;\nint efioctl;\nvoid efwatchdog;\nint efbusyeeprom;\nint efintr;\nvoid efcompletecmd;\nvoid ef_miibus_writereg;\nvoid ef_miibus_statchg;\nint ef_miibus_readreg;\nint ef_ifmedia_upd;\nvoid ef_ifmedia_sts;\nstruct mbuf *\nefget(sc, totlen)\n\tstruct ef_softc *sc;\n\nvoid\nef_isapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct ef_softc *sc = (void *)self;\n\tstruct isa_attach_args *ia = aux;\n\tstruct ifnet *ifp = &sc->sc_arpcom.ac_if;\n\tbus_space_tag_t iot;\n\tbus_space_handle_t ioh;\n\tint i;\n\tu_int16_t x;\n\tu_int32_t cfg;\n\n\tsc->sc_iot = iot = ia->ia_iot;\n\tsc->sc_ioh = ioh = ia->ipa_io[0].h;\n\n\tefcompletecmd(sc, EP_COMMAND, GLOBAL_RESET);\n\tDELAY(1500);\n\n\tfor (i = 0; i < 3; i++) {\n\t\tif (efbusyeeprom(sc))\n\t\t\treturn;\n\n\t\tbus_space_write_2(iot, ioh, EF_W0_EEPROM_COMMAND,\n\t\t    EF_EEPROM_READ | i);\n\n\t\tif (efbusyeeprom(sc))\n\t\t\treturn;\n\n\t\tx = bus_space_read_2(iot, ioh, EF_W0_EEPROM_DATA);\n\n\t\tsc->sc_arpcom.ac_enaddr[(i << 1)] = x >> 8;\n\t\tsc->sc_arpcom.ac_enaddr[(i << 1) + 1] = x;\n\t}\n\n\tprintf(\": address %s\\n\", ether_sprintf(sc->sc_arpcom.ac_enaddr));\n\n\tGO_WINDOW(3);\n\tcfg = bus_space_read_4(iot, ioh, EP_W3_INTERNAL_CONFIG);\n\tcfg &= ~(0x00f00000);\n\tcfg |= (0x06 << 20);\n\tbus_space_write_4(iot, ioh, EP_W3_INTERNAL_CONFIG, cfg);\n\n\tsc->sc_ih = isa_intr_establish(ia->ia_ic, ia->ia_irq, IST_EDGE,\n\t    IPL_NET, efintr, sc, sc->sc_dv.dv_xname);\n\n\tif (ia->ia_drq != DRQUNK)\n\t\tisadma_cascade(ia->ia_drq);\n\n\tbcopy(sc->sc_dv.dv_xname, ifp->if_xname, IFNAMSIZ);\n\tifp->if_softc = sc;\n\tifp->if_start = efstart;\n\tifp->if_ioctl = efioctl;\n\tifp->if_watchdog = efwatchdog;\n\tifp->if_flags =\n\t    IFF_BROADCAST | IFF_SIMPLEX | IFF_NOTRAILERS | IFF_MULTICAST;\n\n\tsc->sc_mii.mii_ifp = ifp;\n\tsc->sc_mii.mii_readreg = ef_miibus_readreg;\n\tsc->sc_mii.mii_writereg = ef_miibus_writereg;\n\tsc->sc_mii.mii_statchg = ef_miibus_statchg;\n\tifmedia_init(&sc->sc_mii.mii_media, 0, ef_ifmedia_upd, ef_ifmedia_sts);\n\tmii_phy_probe(self, &sc->sc_mii, 0xffffffff);\n\tif (LIST_FIRST(&sc->sc_mii.mii_phys) == NULL) {\n\t\tifmedia_add(&sc->sc_mii.mii_media, IFM_ETHER|IFM_NONE, 0, NULL);\n\t\tifmedia_set(&sc->sc_mii.mii_media, IFM_ETHER|IFM_NONE);\n\t} else\n\t\tifmedia_set(&sc->sc_mii.mii_media, IFM_ETHER|IFM_AUTO);\n\n\tif_attach(ifp);\n\tether_ifattach(ifp);\n\n#if NBPFILTER > 0\n\tbpfattach(&sc->sc_arpcom.ac_if.if_bpf, ifp, DLT_EN10MB,\n\t   sizeof(struct ether_header));\n#endif\n\n\tsc->sc_tx_start_thresh = 20;\n\n\tefcompletecmd(sc, EP_COMMAND, RX_RESET);\n\tefcompletecmd(sc, EP_COMMAND, TX_RESET);\n}"
  },
  {
    "function_name": "ef_isapnp_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ef_isapnp.c",
    "lines": "152-158",
    "snippet": "int\nef_isapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\treturn (1);\n}",
    "includes": [
      "#include <dev/ic/elink3reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mii/miivar.h>",
      "#include <dev/mii/mii.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/netisr.h>",
      "#include <net/if_types.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/kernel.h>",
      "#include <sys/queue.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int ef_isapnp_match"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/elink3reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/netisr.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/kernel.h>\n#include <sys/queue.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint ef_isapnp_match;\n\nint\nef_isapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\treturn (1);\n}"
  }
]