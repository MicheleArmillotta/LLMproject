[
  {
    "function_name": "rf_PrintReconSchedule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "378-394",
    "snippet": "void \nrf_PrintReconSchedule(mapPtr, starttime)\n\tRF_ReconMap_t *mapPtr;\n\tstruct timeval *starttime;\n{\n\tstatic int old_pctg = -1;\n\tstruct timeval tv, diff;\n\tint     new_pctg;\n\n\tnew_pctg = 100 - (rf_UnitsLeftToReconstruct(mapPtr) * 100 / mapPtr->totalRUs);\n\tif (new_pctg != old_pctg) {\n\t\tRF_GETTIME(tv);\n\t\tRF_TIMEVAL_DIFF(starttime, &tv, &diff);\n\t\tprintf(\"%d %d.%06d\\n\", (int) new_pctg, (int) diff.tv_sec, (int) diff.tv_usec);\n\t\told_pctg = new_pctg;\n\t}\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%d %d.%06d\\n\"",
            "(int) new_pctg",
            "(int) diff.tv_sec",
            "(int) diff.tv_usec"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_TIMEVAL_DIFF",
          "args": [
            "starttime",
            "&tv",
            "&diff"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_GETTIME",
          "args": [
            "tv"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_UnitsLeftToReconstruct",
          "args": [
            "mapPtr"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "rf_UnitsLeftToReconstruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "321-327",
          "snippet": "RF_ReconUnitCount_t \nrf_UnitsLeftToReconstruct(mapPtr)\n\tRF_ReconMap_t *mapPtr;\n{\n\tRF_ASSERT(mapPtr != NULL);\n\treturn (mapPtr->unitsLeft);\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nRF_ReconUnitCount_t \nrf_UnitsLeftToReconstruct(mapPtr)\n\tRF_ReconMap_t *mapPtr;\n{\n\tRF_ASSERT(mapPtr != NULL);\n\treturn (mapPtr->unitsLeft);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nvoid \nrf_PrintReconSchedule(mapPtr, starttime)\n\tRF_ReconMap_t *mapPtr;\n\tstruct timeval *starttime;\n{\n\tstatic int old_pctg = -1;\n\tstruct timeval tv, diff;\n\tint     new_pctg;\n\n\tnew_pctg = 100 - (rf_UnitsLeftToReconstruct(mapPtr) * 100 / mapPtr->totalRUs);\n\tif (new_pctg != old_pctg) {\n\t\tRF_GETTIME(tv);\n\t\tRF_TIMEVAL_DIFF(starttime, &tv, &diff);\n\t\tprintf(\"%d %d.%06d\\n\", (int) new_pctg, (int) diff.tv_sec, (int) diff.tv_usec);\n\t\told_pctg = new_pctg;\n\t}\n}"
  },
  {
    "function_name": "rf_PrintReconMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "349-376",
    "snippet": "void \nrf_PrintReconMap(raidPtr, mapPtr, frow, fcol)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tRF_RowCol_t frow;\n\tRF_RowCol_t fcol;\n{\n\tRF_ReconUnitCount_t numRUs;\n\tRF_ReconMapListElem_t *p;\n\tRF_ReconUnitNum_t i;\n\n\tnumRUs = mapPtr->totalRUs;\n\tif (mapPtr->sectorsInDisk % mapPtr->sectorsPerReconUnit)\n\t\tnumRUs++;\n\n\tfor (i = 0; i < numRUs; i++) {\n\t\tp = mapPtr->status[i];\n\t\tif (p == RU_ALL)/* printf(\"[%d] ALL\\n\",i) */\n\t\t\t;\n\t\telse\n\t\t\tif (p == RU_NOTHING) {\n\t\t\t\tprintf(\"%d: Unreconstructed\\n\", i);\n\t\t\t} else {\n\t\t\t\tprintf(\"%d: \", i);\n\t\t\t\tPrintList(p);\n\t\t\t}\n\t}\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [
      "#define RU_NOTHING  ((RF_ReconMapListElem_t *) 0)",
      "#define RU_ALL      ((RF_ReconMapListElem_t *) -1)"
    ],
    "globals_used": [
      "static void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);",
      "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);",
      "RF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PrintList",
          "args": [
            "p"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "PrintList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "338-347",
          "snippet": "static void \nPrintList(listPtr)\n\tRF_ReconMapListElem_t *listPtr;\n{\n\twhile (listPtr) {\n\t\tprintf(\"%d,%d -> \", (int) listPtr->startSector, (int) listPtr->stopSector);\n\t\tlistPtr = listPtr->next;\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);",
            "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
            "static void PrintList(RF_ReconMapListElem_t * listPtr);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void PrintList(RF_ReconMapListElem_t * listPtr);\n\nstatic void \nPrintList(listPtr)\n\tRF_ReconMapListElem_t *listPtr;\n{\n\twhile (listPtr) {\n\t\tprintf(\"%d,%d -> \", (int) listPtr->startSector, (int) listPtr->stopSector);\n\t\tlistPtr = listPtr->next;\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%d: \"",
            "i"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\n#define RU_NOTHING  ((RF_ReconMapListElem_t *) 0)\n#define RU_ALL      ((RF_ReconMapListElem_t *) -1)\n\nstatic void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\nRF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;\n\nvoid \nrf_PrintReconMap(raidPtr, mapPtr, frow, fcol)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tRF_RowCol_t frow;\n\tRF_RowCol_t fcol;\n{\n\tRF_ReconUnitCount_t numRUs;\n\tRF_ReconMapListElem_t *p;\n\tRF_ReconUnitNum_t i;\n\n\tnumRUs = mapPtr->totalRUs;\n\tif (mapPtr->sectorsInDisk % mapPtr->sectorsPerReconUnit)\n\t\tnumRUs++;\n\n\tfor (i = 0; i < numRUs; i++) {\n\t\tp = mapPtr->status[i];\n\t\tif (p == RU_ALL)/* printf(\"[%d] ALL\\n\",i) */\n\t\t\t;\n\t\telse\n\t\t\tif (p == RU_NOTHING) {\n\t\t\t\tprintf(\"%d: Unreconstructed\\n\", i);\n\t\t\t} else {\n\t\t\t\tprintf(\"%d: \", i);\n\t\t\t\tPrintList(p);\n\t\t\t}\n\t}\n}"
  },
  {
    "function_name": "PrintList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "338-347",
    "snippet": "static void \nPrintList(listPtr)\n\tRF_ReconMapListElem_t *listPtr;\n{\n\twhile (listPtr) {\n\t\tprintf(\"%d,%d -> \", (int) listPtr->startSector, (int) listPtr->stopSector);\n\t\tlistPtr = listPtr->next;\n\t}\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);",
      "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
      "static void PrintList(RF_ReconMapListElem_t * listPtr);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void PrintList(RF_ReconMapListElem_t * listPtr);\n\nstatic void \nPrintList(listPtr)\n\tRF_ReconMapListElem_t *listPtr;\n{\n\twhile (listPtr) {\n\t\tprintf(\"%d,%d -> \", (int) listPtr->startSector, (int) listPtr->stopSector);\n\t\tlistPtr = listPtr->next;\n\t}\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "update_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "329-336",
    "snippet": "static void \nupdate_size(mapPtr, size)\n\tRF_ReconMap_t *mapPtr;\n\tint     size;\n{\n\tmapPtr->size += size;\n\tmapPtr->maxSize = RF_MAX(mapPtr->size, mapPtr->maxSize);\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void update_size(RF_ReconMap_t * mapPtr, int size);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_MAX",
          "args": [
            "mapPtr->size",
            "mapPtr->maxSize"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void update_size(RF_ReconMap_t * mapPtr, int size);\n\nstatic void \nupdate_size(mapPtr, size)\n\tRF_ReconMap_t *mapPtr;\n\tint     size;\n{\n\tmapPtr->size += size;\n\tmapPtr->maxSize = RF_MAX(mapPtr->size, mapPtr->maxSize);\n}"
  },
  {
    "function_name": "rf_UnitsLeftToReconstruct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "321-327",
    "snippet": "RF_ReconUnitCount_t \nrf_UnitsLeftToReconstruct(mapPtr)\n\tRF_ReconMap_t *mapPtr;\n{\n\tRF_ASSERT(mapPtr != NULL);\n\treturn (mapPtr->unitsLeft);\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "mapPtr != NULL"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nRF_ReconUnitCount_t \nrf_UnitsLeftToReconstruct(mapPtr)\n\tRF_ReconMap_t *mapPtr;\n{\n\tRF_ASSERT(mapPtr != NULL);\n\treturn (mapPtr->unitsLeft);\n}"
  },
  {
    "function_name": "rf_CheckRUReconstructed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "308-319",
    "snippet": "int \nrf_CheckRUReconstructed(mapPtr, startSector)\n\tRF_ReconMap_t *mapPtr;\n\tRF_SectorNum_t startSector;\n{\n\tRF_ReconMapListElem_t *l;\t/* used for searching */\n\tRF_ReconUnitNum_t i;\n\n\ti = startSector / mapPtr->sectorsPerReconUnit;\n\tl = mapPtr->status[i];\n\treturn ((l == RU_ALL) ? 1 : 0);\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [
      "#define RU_ALL      ((RF_ReconMapListElem_t *) -1)"
    ],
    "globals_used": [
      "static void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\n#define RU_ALL      ((RF_ReconMapListElem_t *) -1)\n\nstatic void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);\n\nint \nrf_CheckRUReconstructed(mapPtr, startSector)\n\tRF_ReconMap_t *mapPtr;\n\tRF_SectorNum_t startSector;\n{\n\tRF_ReconMapListElem_t *l;\t/* used for searching */\n\tRF_ReconUnitNum_t i;\n\n\ti = startSector / mapPtr->sectorsPerReconUnit;\n\tl = mapPtr->status[i];\n\treturn ((l == RU_ALL) ? 1 : 0);\n}"
  },
  {
    "function_name": "rf_FreeReconMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "278-301",
    "snippet": "void \nrf_FreeReconMap(mapPtr)\n\tRF_ReconMap_t *mapPtr;\n{\n\tRF_ReconMapListElem_t *p, *q;\n\tRF_ReconUnitCount_t numRUs;\n\tRF_ReconUnitNum_t i;\n\n\tnumRUs = mapPtr->sectorsInDisk / mapPtr->sectorsPerReconUnit;\n\tif (mapPtr->sectorsInDisk % mapPtr->sectorsPerReconUnit)\n\t\tnumRUs++;\n\n\tfor (i = 0; i < numRUs; i++) {\n\t\tp = mapPtr->status[i];\n\t\twhile (p != RU_NOTHING && p != RU_ALL) {\n\t\t\tq = p;\n\t\t\tp = p->next;\n\t\t\tRF_Free(q, sizeof(*q));\n\t\t}\n\t}\n\trf_mutex_destroy(&mapPtr->mutex);\n\tRF_Free(mapPtr->status, mapPtr->totalRUs * sizeof(RF_ReconMapListElem_t *));\n\tRF_Free(mapPtr, sizeof(RF_ReconMap_t));\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [
      "#define RU_NOTHING  ((RF_ReconMapListElem_t *) 0)",
      "#define RU_ALL      ((RF_ReconMapListElem_t *) -1)"
    ],
    "globals_used": [
      "static void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);",
      "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
      "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_Free",
          "args": [
            "mapPtr",
            "sizeof(RF_ReconMap_t)"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_Free",
          "args": [
            "mapPtr->status",
            "mapPtr->totalRUs * sizeof(RF_ReconMapListElem_t *)"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "&mapPtr->mutex"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_Free",
          "args": [
            "q",
            "sizeof(*q)"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\n#define RU_NOTHING  ((RF_ReconMapListElem_t *) 0)\n#define RU_ALL      ((RF_ReconMapListElem_t *) -1)\n\nstatic void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\n\nvoid \nrf_FreeReconMap(mapPtr)\n\tRF_ReconMap_t *mapPtr;\n{\n\tRF_ReconMapListElem_t *p, *q;\n\tRF_ReconUnitCount_t numRUs;\n\tRF_ReconUnitNum_t i;\n\n\tnumRUs = mapPtr->sectorsInDisk / mapPtr->sectorsPerReconUnit;\n\tif (mapPtr->sectorsInDisk % mapPtr->sectorsPerReconUnit)\n\t\tnumRUs++;\n\n\tfor (i = 0; i < numRUs; i++) {\n\t\tp = mapPtr->status[i];\n\t\twhile (p != RU_NOTHING && p != RU_ALL) {\n\t\t\tq = p;\n\t\t\tp = p->next;\n\t\t\tRF_Free(q, sizeof(*q));\n\t\t}\n\t}\n\trf_mutex_destroy(&mapPtr->mutex);\n\tRF_Free(mapPtr->status, mapPtr->totalRUs * sizeof(RF_ReconMapListElem_t *));\n\tRF_Free(mapPtr, sizeof(RF_ReconMap_t));\n}"
  },
  {
    "function_name": "FreeReconMapListElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "260-272",
    "snippet": "static void \nFreeReconMapListElem(mapPtr, p)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *p;\n{\n\tint     delta;\n\n\tif (mapPtr) {\n\t\tdelta = 0 - (int) sizeof(RF_ReconMapListElem_t);\n\t\tupdate_size(mapPtr, delta);\n\t}\n\tRF_Free(p, sizeof(*p));\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_Free",
          "args": [
            "p",
            "sizeof(*p)"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "update_size",
          "args": [
            "mapPtr",
            "delta"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "update_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "329-336",
          "snippet": "static void \nupdate_size(mapPtr, size)\n\tRF_ReconMap_t *mapPtr;\n\tint     size;\n{\n\tmapPtr->size += size;\n\tmapPtr->maxSize = RF_MAX(mapPtr->size, mapPtr->maxSize);\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void update_size(RF_ReconMap_t * mapPtr, int size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void update_size(RF_ReconMap_t * mapPtr, int size);\n\nstatic void \nupdate_size(mapPtr, size)\n\tRF_ReconMap_t *mapPtr;\n\tint     size;\n{\n\tmapPtr->size += size;\n\tmapPtr->maxSize = RF_MAX(mapPtr->size, mapPtr->maxSize);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\n\nstatic void \nFreeReconMapListElem(mapPtr, p)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *p;\n{\n\tint     delta;\n\n\tif (mapPtr) {\n\t\tdelta = 0 - (int) sizeof(RF_ReconMapListElem_t);\n\t\tupdate_size(mapPtr, delta);\n\t}\n\tRF_Free(p, sizeof(*p));\n}"
  },
  {
    "function_name": "MakeReconMapListElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "238-253",
    "snippet": "static RF_ReconMapListElem_t *\nMakeReconMapListElem(\n    RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector,\n    RF_ReconMapListElem_t * next)\n{\n\tRF_ReconMapListElem_t *p;\n\n\tRF_Malloc(p, sizeof(RF_ReconMapListElem_t), (RF_ReconMapListElem_t *));\n\tif (p == NULL)\n\t\treturn (NULL);\n\tp->startSector = startSector;\n\tp->stopSector = stopSector;\n\tp->next = next;\n\treturn (p);\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
      "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_Malloc",
          "args": [
            "p",
            "sizeof(RF_ReconMapListElem_t)",
            "(RF_ReconMapListElem_t *)"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\n\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(\n    RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector,\n    RF_ReconMapListElem_t * next)\n{\n\tRF_ReconMapListElem_t *p;\n\n\tRF_Malloc(p, sizeof(RF_ReconMapListElem_t), (RF_ReconMapListElem_t *));\n\tif (p == NULL)\n\t\treturn (NULL);\n\tp->startSector = startSector;\n\tp->stopSector = stopSector;\n\tp->next = next;\n\treturn (p);\n}"
  },
  {
    "function_name": "crunch_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "209-231",
    "snippet": "static void \ncrunch_list(mapPtr, listPtr)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *listPtr;\n{\n\tRF_ReconMapListElem_t *pt, *p = listPtr;\n\n\tif (!p)\n\t\treturn;\n\tpt = p;\n\tp = p->next;\n\twhile (p) {\n\t\tif (pt->stopSector >= p->startSector - 1) {\n\t\t\tpt->stopSector = RF_MAX(pt->stopSector, p->stopSector);\n\t\t\tpt->next = p->next;\n\t\t\tFreeReconMapListElem(mapPtr, p);\n\t\t\tp = pt->next;\n\t\t} else {\n\t\t\tpt = p;\n\t\t\tp = p->next;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);",
      "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
      "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);",
      "static void PrintList(RF_ReconMapListElem_t * listPtr);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FreeReconMapListElem",
          "args": [
            "mapPtr",
            "p"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "FreeReconMapListElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "260-272",
          "snippet": "static void \nFreeReconMapListElem(mapPtr, p)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *p;\n{\n\tint     delta;\n\n\tif (mapPtr) {\n\t\tdelta = 0 - (int) sizeof(RF_ReconMapListElem_t);\n\t\tupdate_size(mapPtr, delta);\n\t}\n\tRF_Free(p, sizeof(*p));\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\n\nstatic void \nFreeReconMapListElem(mapPtr, p)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *p;\n{\n\tint     delta;\n\n\tif (mapPtr) {\n\t\tdelta = 0 - (int) sizeof(RF_ReconMapListElem_t);\n\t\tupdate_size(mapPtr, delta);\n\t}\n\tRF_Free(p, sizeof(*p));\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_MAX",
          "args": [
            "pt->stopSector",
            "p->stopSector"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\nstatic void PrintList(RF_ReconMapListElem_t * listPtr);\n\nstatic void \ncrunch_list(mapPtr, listPtr)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *listPtr;\n{\n\tRF_ReconMapListElem_t *pt, *p = listPtr;\n\n\tif (!p)\n\t\treturn;\n\tpt = p;\n\tp = p->next;\n\twhile (p) {\n\t\tif (pt->stopSector >= p->startSector - 1) {\n\t\t\tpt->stopSector = RF_MAX(pt->stopSector, p->stopSector);\n\t\t\tpt->next = p->next;\n\t\t\tFreeReconMapListElem(mapPtr, p);\n\t\t\tp = pt->next;\n\t\t} else {\n\t\t\tpt = p;\n\t\t\tp = p->next;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "compact_stat_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "190-207",
    "snippet": "static void \ncompact_stat_entry(raidPtr, mapPtr, i)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tint     i;\n{\n\tRF_SectorCount_t sectorsPerReconUnit = mapPtr->sectorsPerReconUnit;\n\tRF_ReconMapListElem_t *p = mapPtr->status[i];\n\n\tcrunch_list(mapPtr, p);\n\n\tif ((p->startSector == i * sectorsPerReconUnit) &&\n\t    (p->stopSector == i * sectorsPerReconUnit + sectorsPerReconUnit - 1)) {\n\t\tmapPtr->status[i] = RU_ALL;\n\t\tmapPtr->unitsLeft--;\n\t\tFreeReconMapListElem(mapPtr, p);\n\t}\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [
      "#define RU_ALL      ((RF_ReconMapListElem_t *) -1)"
    ],
    "globals_used": [
      "static void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);",
      "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);",
      "RF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FreeReconMapListElem",
          "args": [
            "mapPtr",
            "p"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "FreeReconMapListElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "260-272",
          "snippet": "static void \nFreeReconMapListElem(mapPtr, p)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *p;\n{\n\tint     delta;\n\n\tif (mapPtr) {\n\t\tdelta = 0 - (int) sizeof(RF_ReconMapListElem_t);\n\t\tupdate_size(mapPtr, delta);\n\t}\n\tRF_Free(p, sizeof(*p));\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\n\nstatic void \nFreeReconMapListElem(mapPtr, p)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *p;\n{\n\tint     delta;\n\n\tif (mapPtr) {\n\t\tdelta = 0 - (int) sizeof(RF_ReconMapListElem_t);\n\t\tupdate_size(mapPtr, delta);\n\t}\n\tRF_Free(p, sizeof(*p));\n}"
        }
      },
      {
        "call_info": {
          "callee": "crunch_list",
          "args": [
            "mapPtr",
            "p"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "crunch_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "209-231",
          "snippet": "static void \ncrunch_list(mapPtr, listPtr)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *listPtr;\n{\n\tRF_ReconMapListElem_t *pt, *p = listPtr;\n\n\tif (!p)\n\t\treturn;\n\tpt = p;\n\tp = p->next;\n\twhile (p) {\n\t\tif (pt->stopSector >= p->startSector - 1) {\n\t\t\tpt->stopSector = RF_MAX(pt->stopSector, p->stopSector);\n\t\t\tpt->next = p->next;\n\t\t\tFreeReconMapListElem(mapPtr, p);\n\t\t\tp = pt->next;\n\t\t} else {\n\t\t\tpt = p;\n\t\t\tp = p->next;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);",
            "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
            "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);",
            "static void PrintList(RF_ReconMapListElem_t * listPtr);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void crunch_list(RF_ReconMap_t * mapPtr, RF_ReconMapListElem_t * listPtr);\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\nstatic void PrintList(RF_ReconMapListElem_t * listPtr);\n\nstatic void \ncrunch_list(mapPtr, listPtr)\n\tRF_ReconMap_t *mapPtr;\n\tRF_ReconMapListElem_t *listPtr;\n{\n\tRF_ReconMapListElem_t *pt, *p = listPtr;\n\n\tif (!p)\n\t\treturn;\n\tpt = p;\n\tp = p->next;\n\twhile (p) {\n\t\tif (pt->stopSector >= p->startSector - 1) {\n\t\t\tpt->stopSector = RF_MAX(pt->stopSector, p->stopSector);\n\t\t\tpt->next = p->next;\n\t\t\tFreeReconMapListElem(mapPtr, p);\n\t\t\tp = pt->next;\n\t\t} else {\n\t\t\tpt = p;\n\t\t\tp = p->next;\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\n#define RU_ALL      ((RF_ReconMapListElem_t *) -1)\n\nstatic void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\nRF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;\n\nstatic void \ncompact_stat_entry(raidPtr, mapPtr, i)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tint     i;\n{\n\tRF_SectorCount_t sectorsPerReconUnit = mapPtr->sectorsPerReconUnit;\n\tRF_ReconMapListElem_t *p = mapPtr->status[i];\n\n\tcrunch_list(mapPtr, p);\n\n\tif ((p->startSector == i * sectorsPerReconUnit) &&\n\t    (p->stopSector == i * sectorsPerReconUnit + sectorsPerReconUnit - 1)) {\n\t\tmapPtr->status[i] = RU_ALL;\n\t\tmapPtr->unitsLeft--;\n\t\tFreeReconMapListElem(mapPtr, p);\n\t}\n}"
  },
  {
    "function_name": "rf_ReconMapUpdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
    "lines": "131-170",
    "snippet": "void \nrf_ReconMapUpdate(raidPtr, mapPtr, startSector, stopSector)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tRF_SectorNum_t startSector;\n\tRF_SectorNum_t stopSector;\n{\n\tRF_SectorCount_t sectorsPerReconUnit = mapPtr->sectorsPerReconUnit;\n\tRF_SectorNum_t i, first_in_RU, last_in_RU;\n\tRF_ReconMapListElem_t *p, *pt;\n\n\tRF_LOCK_MUTEX(mapPtr->mutex);\n\tRF_ASSERT(startSector >= 0 && stopSector < mapPtr->sectorsInDisk && stopSector >= startSector);\n\n\twhile (startSector <= stopSector) {\n\t\ti = startSector / mapPtr->sectorsPerReconUnit;\n\t\tfirst_in_RU = i * sectorsPerReconUnit;\n\t\tlast_in_RU = first_in_RU + sectorsPerReconUnit - 1;\n\t\tp = mapPtr->status[i];\n\t\tif (p != RU_ALL) {\n\t\t\tif (p == RU_NOTHING || p->startSector > startSector) {\t/* insert at front of\n\t\t\t\t\t\t\t\t\t\t * list */\n\n\t\t\t\tmapPtr->status[i] = MakeReconMapListElem(startSector, RF_MIN(stopSector, last_in_RU), (p == RU_NOTHING) ? NULL : p);\n\t\t\t\tupdate_size(mapPtr, sizeof(RF_ReconMapListElem_t));\n\n\t\t\t} else {/* general case */\n\t\t\t\tdo {\t/* search for place to insert */\n\t\t\t\t\tpt = p;\n\t\t\t\t\tp = p->next;\n\t\t\t\t} while (p && (p->startSector < startSector));\n\t\t\t\tpt->next = MakeReconMapListElem(startSector, RF_MIN(stopSector, last_in_RU), p);\n\t\t\t\tupdate_size(mapPtr, sizeof(RF_ReconMapListElem_t));\n\t\t\t}\n\t\t\tcompact_stat_entry(raidPtr, mapPtr, i);\n\t\t}\n\t\tstartSector = RF_MIN(stopSector, last_in_RU) + 1;\n\t}\n\tRF_UNLOCK_MUTEX(mapPtr->mutex);\n}",
    "includes": [
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include <sys/time.h>",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [
      "#define RU_NOTHING  ((RF_ReconMapListElem_t *) 0)",
      "#define RU_ALL      ((RF_ReconMapListElem_t *) -1)"
    ],
    "globals_used": [
      "static void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);",
      "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
      "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);",
      "RF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_UNLOCK_MUTEX",
          "args": [
            "mapPtr->mutex"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_MIN",
          "args": [
            "stopSector",
            "last_in_RU"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compact_stat_entry",
          "args": [
            "raidPtr",
            "mapPtr",
            "i"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "compact_stat_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "190-207",
          "snippet": "static void \ncompact_stat_entry(raidPtr, mapPtr, i)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tint     i;\n{\n\tRF_SectorCount_t sectorsPerReconUnit = mapPtr->sectorsPerReconUnit;\n\tRF_ReconMapListElem_t *p = mapPtr->status[i];\n\n\tcrunch_list(mapPtr, p);\n\n\tif ((p->startSector == i * sectorsPerReconUnit) &&\n\t    (p->stopSector == i * sectorsPerReconUnit + sectorsPerReconUnit - 1)) {\n\t\tmapPtr->status[i] = RU_ALL;\n\t\tmapPtr->unitsLeft--;\n\t\tFreeReconMapListElem(mapPtr, p);\n\t}\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [
            "#define RU_ALL      ((RF_ReconMapListElem_t *) -1)"
          ],
          "globals_used": [
            "static void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);",
            "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);",
            "RF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\n#define RU_ALL      ((RF_ReconMapListElem_t *) -1)\n\nstatic void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\nRF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;\n\nstatic void \ncompact_stat_entry(raidPtr, mapPtr, i)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tint     i;\n{\n\tRF_SectorCount_t sectorsPerReconUnit = mapPtr->sectorsPerReconUnit;\n\tRF_ReconMapListElem_t *p = mapPtr->status[i];\n\n\tcrunch_list(mapPtr, p);\n\n\tif ((p->startSector == i * sectorsPerReconUnit) &&\n\t    (p->stopSector == i * sectorsPerReconUnit + sectorsPerReconUnit - 1)) {\n\t\tmapPtr->status[i] = RU_ALL;\n\t\tmapPtr->unitsLeft--;\n\t\tFreeReconMapListElem(mapPtr, p);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "update_size",
          "args": [
            "mapPtr",
            "sizeof(RF_ReconMapListElem_t)"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "update_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "329-336",
          "snippet": "static void \nupdate_size(mapPtr, size)\n\tRF_ReconMap_t *mapPtr;\n\tint     size;\n{\n\tmapPtr->size += size;\n\tmapPtr->maxSize = RF_MAX(mapPtr->size, mapPtr->maxSize);\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void update_size(RF_ReconMap_t * mapPtr, int size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic void update_size(RF_ReconMap_t * mapPtr, int size);\n\nstatic void \nupdate_size(mapPtr, size)\n\tRF_ReconMap_t *mapPtr;\n\tint     size;\n{\n\tmapPtr->size += size;\n\tmapPtr->maxSize = RF_MAX(mapPtr->size, mapPtr->maxSize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeReconMapListElem",
          "args": [
            "startSector",
            "RF_MIN(stopSector, last_in_RU)",
            "p"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "MakeReconMapListElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_reconmap.c",
          "lines": "238-253",
          "snippet": "static RF_ReconMapListElem_t *\nMakeReconMapListElem(\n    RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector,\n    RF_ReconMapListElem_t * next)\n{\n\tRF_ReconMapListElem_t *p;\n\n\tRF_Malloc(p, sizeof(RF_ReconMapListElem_t), (RF_ReconMapListElem_t *));\n\tif (p == NULL)\n\t\treturn (NULL);\n\tp->startSector = startSector;\n\tp->stopSector = stopSector;\n\tp->next = next;\n\treturn (p);\n}",
          "includes": [
            "#include \"rf_utils.h\"",
            "#include \"rf_general.h\"",
            "#include <sys/time.h>",
            "#include \"rf_raid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);",
            "static void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\n\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(\n    RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector,\n    RF_ReconMapListElem_t * next)\n{\n\tRF_ReconMapListElem_t *p;\n\n\tRF_Malloc(p, sizeof(RF_ReconMapListElem_t), (RF_ReconMapListElem_t *));\n\tif (p == NULL)\n\t\treturn (NULL);\n\tp->startSector = startSector;\n\tp->stopSector = stopSector;\n\tp->next = next;\n\treturn (p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_MIN",
          "args": [
            "stopSector",
            "last_in_RU"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_MIN",
          "args": [
            "stopSector",
            "last_in_RU"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "startSector >= 0 && stopSector < mapPtr->sectorsInDisk && stopSector >= startSector"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_LOCK_MUTEX",
          "args": [
            "mapPtr->mutex"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include <sys/time.h>\n#include \"rf_raid.h\"\n\n#define RU_NOTHING  ((RF_ReconMapListElem_t *) 0)\n#define RU_ALL      ((RF_ReconMapListElem_t *) -1)\n\nstatic void \ncompact_stat_entry(RF_Raid_t * raidPtr, RF_ReconMap_t * mapPtr,\n    int i);\nstatic RF_ReconMapListElem_t *\nMakeReconMapListElem(RF_SectorNum_t startSector,\n    RF_SectorNum_t stopSector, RF_ReconMapListElem_t * next);\nstatic void \nFreeReconMapListElem(RF_ReconMap_t * mapPtr,\n    RF_ReconMapListElem_t * p);\nRF_ReconMap_t *\nrf_MakeReconMap(raidPtr, ru_sectors, disk_sectors, spareUnitsPerDisk)\n\tRF_Raid_t *raidPtr;\n\nvoid \nrf_ReconMapUpdate(raidPtr, mapPtr, startSector, stopSector)\n\tRF_Raid_t *raidPtr;\n\tRF_ReconMap_t *mapPtr;\n\tRF_SectorNum_t startSector;\n\tRF_SectorNum_t stopSector;\n{\n\tRF_SectorCount_t sectorsPerReconUnit = mapPtr->sectorsPerReconUnit;\n\tRF_SectorNum_t i, first_in_RU, last_in_RU;\n\tRF_ReconMapListElem_t *p, *pt;\n\n\tRF_LOCK_MUTEX(mapPtr->mutex);\n\tRF_ASSERT(startSector >= 0 && stopSector < mapPtr->sectorsInDisk && stopSector >= startSector);\n\n\twhile (startSector <= stopSector) {\n\t\ti = startSector / mapPtr->sectorsPerReconUnit;\n\t\tfirst_in_RU = i * sectorsPerReconUnit;\n\t\tlast_in_RU = first_in_RU + sectorsPerReconUnit - 1;\n\t\tp = mapPtr->status[i];\n\t\tif (p != RU_ALL) {\n\t\t\tif (p == RU_NOTHING || p->startSector > startSector) {\t/* insert at front of\n\t\t\t\t\t\t\t\t\t\t * list */\n\n\t\t\t\tmapPtr->status[i] = MakeReconMapListElem(startSector, RF_MIN(stopSector, last_in_RU), (p == RU_NOTHING) ? NULL : p);\n\t\t\t\tupdate_size(mapPtr, sizeof(RF_ReconMapListElem_t));\n\n\t\t\t} else {/* general case */\n\t\t\t\tdo {\t/* search for place to insert */\n\t\t\t\t\tpt = p;\n\t\t\t\t\tp = p->next;\n\t\t\t\t} while (p && (p->startSector < startSector));\n\t\t\t\tpt->next = MakeReconMapListElem(startSector, RF_MIN(stopSector, last_in_RU), p);\n\t\t\t\tupdate_size(mapPtr, sizeof(RF_ReconMapListElem_t));\n\t\t\t}\n\t\t\tcompact_stat_entry(raidPtr, mapPtr, i);\n\t\t}\n\t\tstartSector = RF_MIN(stopSector, last_in_RU) + 1;\n\t}\n\tRF_UNLOCK_MUTEX(mapPtr->mutex);\n}"
  }
]