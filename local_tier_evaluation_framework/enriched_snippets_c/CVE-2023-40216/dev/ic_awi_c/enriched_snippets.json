[
  {
    "function_name": "awi_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2617-2622",
    "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_reset"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: reset\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 2620
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
  },
  {
    "function_name": "awi_running",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2602-2614",
    "snippet": "void awi_running (sc)\n\tstruct awi_softc *sc;\n\t\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\t/*\n\t * Who knows what it is to be running?\n\t * Only he who is running knows..\n\t */\n\tifp->if_flags |= IFF_RUNNING;\n\tawi_start(ifp);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_running",
      "void awi_start"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_start",
          "args": [
            "ifp"
          ],
          "line": 2613
        },
        "resolved": true,
        "details": {
          "function_name": "awi_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "384-449",
          "snippet": "void\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_tx_packet",
            "void awi_start"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_tx_packet;\nvoid awi_start;\n\nvoid\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_running;\nvoid awi_start;\n\nvoid awi_running (sc)\n\tstruct awi_softc *sc;\n\t\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\t/*\n\t * Who knows what it is to be running?\n\t * Only he who is running knows..\n\t */\n\tifp->if_flags |= IFF_RUNNING;\n\tawi_start(ifp);\n}"
  },
  {
    "function_name": "awi_cmd_set_ss_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2576-2600",
    "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_set_ss_done",
      "void awi_reset",
      "void awi_running",
      "void awi_send_authreq"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_send_authreq",
          "args": [
            "sc"
          ],
          "line": 2598
        },
        "resolved": true,
        "details": {
          "function_name": "awi_send_authreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "681-739",
          "snippet": "void\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_send_frame",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_send_frame;\nvoid awi_send_authreq;\n\nvoid\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_running",
          "args": [
            "sc"
          ],
          "line": 2592
        },
        "resolved": true,
        "details": {
          "function_name": "awi_running",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2602-2614",
          "snippet": "void awi_running (sc)\n\tstruct awi_softc *sc;\n\t\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\t/*\n\t * Who knows what it is to be running?\n\t * Only he who is running knows..\n\t */\n\tifp->if_flags |= IFF_RUNNING;\n\tawi_start(ifp);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_running",
            "void awi_start"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_running;\nvoid awi_start;\n\nvoid awi_running (sc)\n\tstruct awi_softc *sc;\n\t\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\t/*\n\t * Who knows what it is to be running?\n\t * Only he who is running knows..\n\t */\n\tifp->if_flags |= IFF_RUNNING;\n\tawi_start(ifp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: set_ss done\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 2589
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2585
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2581
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
  },
  {
    "function_name": "awi_cmd_set_ss",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2554-2574",
    "snippet": "void awi_cmd_set_ss (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_MAC_MGT);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE,\n\t    ETHER_ADDR_LEN + AWI_MIB_MGT_ESS_SIZE);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_MGT_BSS_ID);\n\t\n\tawi_write_bytes(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA,\n\t    sc->sc_active_bss.bss_id, ETHER_ADDR_LEN);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA+ETHER_ADDR_LEN,\n\t    0);\t\t\t/* XXX */\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA+ETHER_ADDR_LEN+1,\n\t    sc->sc_active_bss.sslen);\n\tawi_write_bytes(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA+8,\n\t    sc->sc_active_bss.ssid, AWI_MIB_MGT_ESS_SIZE-2);\n\n\tsc->sc_completion = awi_cmd_set_ss_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_set_ss",
      "void awi_cmd_set_ss_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_SET_MIB"
          ],
          "line": 2573
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_bytes",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA+8",
            "sc->sc_active_bss.ssid",
            "AWI_MIB_MGT_ESS_SIZE-2"
          ],
          "line": 2569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA+ETHER_ADDR_LEN+1",
            "sc->sc_active_bss.sslen"
          ],
          "line": 2567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA+ETHER_ADDR_LEN",
            "0"
          ],
          "line": 2565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_bytes",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA",
            "sc->sc_active_bss.bss_id",
            "ETHER_ADDR_LEN"
          ],
          "line": 2563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_INDEX",
            "AWI_MIB_MGT_BSS_ID"
          ],
          "line": 2560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_SIZE",
            "ETHER_ADDR_LEN + AWI_MIB_MGT_ESS_SIZE"
          ],
          "line": 2558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_TYPE",
            "AWI_MIB_MAC_MGT"
          ],
          "line": 2557
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_set_ss;\nvoid awi_cmd_set_ss_done;\n\nvoid awi_cmd_set_ss (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_MAC_MGT);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE,\n\t    ETHER_ADDR_LEN + AWI_MIB_MGT_ESS_SIZE);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_MGT_BSS_ID);\n\t\n\tawi_write_bytes(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA,\n\t    sc->sc_active_bss.bss_id, ETHER_ADDR_LEN);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA+ETHER_ADDR_LEN,\n\t    0);\t\t\t/* XXX */\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA+ETHER_ADDR_LEN+1,\n\t    sc->sc_active_bss.sslen);\n\tawi_write_bytes(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA+8,\n\t    sc->sc_active_bss.ssid, AWI_MIB_MGT_ESS_SIZE-2);\n\n\tsc->sc_completion = awi_cmd_set_ss_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}"
  },
  {
    "function_name": "awi_cmd_sync_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2523-2551",
    "snippet": "void\nawi_cmd_sync_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: sync_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\t/*\n\t * at this point, the card should be synchronized with the AP\n\t * we heard from.  tell the card what BSS and ESS it's running in..\n\t */\n\t\n\tawi_drvstate (sc, AWI_DRV_INFSY);\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sync done, setting bss/iss parameters\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump (\"bss\", sc->sc_active_bss.bss_id, ETHER_ADDR_LEN);\n\t\tprintf(\"ssid: %s\\n\", sc->sc_active_bss.ssid);\n\t}\n\n\tawi_cmd_set_ss (sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_set_ss",
      "void awi_cmd_sync_done",
      "void awi_reset"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_set_ss",
          "args": [
            "sc"
          ],
          "line": 2550
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ssid: %s\\n\"",
            "sc->sc_active_bss.ssid"
          ],
          "line": 2547
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_hexdump",
          "args": [
            "\"bss\"",
            "sc->sc_active_bss.bss_id",
            "ETHER_ADDR_LEN"
          ],
          "line": 2546
        },
        "resolved": true,
        "details": {
          "function_name": "awi_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "541-550",
          "snippet": "void awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_drvstate",
          "args": [
            "sc",
            "AWI_DRV_INFSY"
          ],
          "line": 2542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2533
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss;\nvoid awi_cmd_sync_done;\nvoid awi_reset;\n\nvoid\nawi_cmd_sync_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: sync_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\t/*\n\t * at this point, the card should be synchronized with the AP\n\t * we heard from.  tell the card what BSS and ESS it's running in..\n\t */\n\t\n\tawi_drvstate (sc, AWI_DRV_INFSY);\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sync done, setting bss/iss parameters\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump (\"bss\", sc->sc_active_bss.bss_id, ETHER_ADDR_LEN);\n\t\tprintf(\"ssid: %s\\n\", sc->sc_active_bss.ssid);\n\t}\n\n\tawi_cmd_set_ss (sc);\n}"
  },
  {
    "function_name": "awi_try_sync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2466-2521",
    "snippet": "void\nawi_try_sync (sc) \n\tstruct awi_softc *sc;\n{\n\tint max_rssi = 0, best = 0;\n\tint i;\n\tstruct awi_bss_binding *bp = NULL;\n\t\n\tawi_flush(sc);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: looking for best of %d\\n\",\n\t\t    sc->sc_dev.dv_xname, sc->sc_nbindings);\n\t}\n\t/* pick one with best rssi */\n\tfor (i=0; i<sc->sc_nbindings; i++) {\n\t\tbp = &sc->sc_bindings[i];\n\n\t\tif (bp->rssi > max_rssi) {\n\t\t\tmax_rssi = bp->rssi;\n\t\t\tbest = i;\n\t\t}\n\t}\n\n\tif (bp == NULL) {\n\t\tprintf(\"%s: no beacons seen\\n\", sc->sc_dev.dv_xname);\n\t\tawi_scan_next(sc);\n\t\treturn;\n\t}\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: best %d\\n\", sc->sc_dev.dv_xname, best);\n\t}\n\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\n\tbp = &sc->sc_bindings[best];\n\tbcopy(bp, &sc->sc_active_bss, sizeof(*bp));\n\tsc->sc_new_bss = 1;\n\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_SET, bp->chanset);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_PATTERN, bp->pattern);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_IDX, bp->index);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_STARTBSS, 0);\n\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_DWELL, bp->dwell_time);\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_MBZ, 0);\n\n\tawi_write_bytes (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_TIMESTAMP,\n\t    bp->bss_timestamp, 8);\n\tawi_write_4 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_REFTIME, bp->rxtime);\n\n\tsc->sc_completion = awi_cmd_sync_done;\n\t\n\tawi_cmd (sc, AWI_CMD_SYNC);\n\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_flush",
      "void awi_cmd",
      "void awi_scan_next",
      "void awi_try_sync",
      "void awi_cmd_sync_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_SYNC"
          ],
          "line": 2519
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_REFTIME",
            "bp->rxtime"
          ],
          "line": 2515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_bytes",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_TIMESTAMP",
            "bp->bss_timestamp",
            "8"
          ],
          "line": 2513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_2",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_MBZ",
            "0"
          ],
          "line": 2511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_2",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_DWELL",
            "bp->dwell_time"
          ],
          "line": 2510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_STARTBSS",
            "0"
          ],
          "line": 2508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_IDX",
            "bp->index"
          ],
          "line": 2507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_PATTERN",
            "bp->pattern"
          ],
          "line": 2506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SYNC_SET",
            "bp->chanset"
          ],
          "line": 2505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bcopy",
          "args": [
            "bp",
            "&sc->sc_active_bss",
            "sizeof(*bp)"
          ],
          "line": 2502
        },
        "resolved": true,
        "details": {
          "function_name": "tr_bcopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/tropic.c",
          "lines": "1618-1663",
          "snippet": "void \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}",
          "includes": [
            "#include <dev/ic/tropicvar.h>",
            "#include <dev/ic/tropicreg.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <net/if_token.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_media.h>",
            "#include <net/if_llc.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/syslog.h>",
            "#include <sys/socket.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void\ttr_bcopy",
            "struct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/tropicvar.h>\n#include <dev/ic/tropicreg.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <net/if_token.h>\n#include <netinet/in_var.h>\n#include <netinet/ip.h>\n#include <netinet/if_ether.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_media.h>\n#include <net/if_llc.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/syslog.h>\n#include <sys/socket.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\ttr_bcopy;\nstruct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;\n\nvoid \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: best %d\\n\"",
            "sc->sc_dev.dv_xname",
            "best"
          ],
          "line": 2497
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_scan_next",
          "args": [
            "sc"
          ],
          "line": 2492
        },
        "resolved": true,
        "details": {
          "function_name": "awi_scan_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2446-2464",
          "snippet": "void\nawi_scan_next (sc)\n\tstruct awi_softc *sc;\n{\n\tsc->sc_scan_pattern++;\n\tif (sc->sc_scan_pattern > IEEEWL_FH_PATTERN_MAX) {\n\t\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\t\t\n\n\t\tsc->sc_scan_chanset++;\n\t\tif (sc->sc_scan_chanset > IEEEWL_FH_CHANSET_MAX)\n\t\t\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\t}\n#if 0\n\tprintf(\"scan: pattern %x chanset %x\\n\", sc->sc_scan_pattern,\n\t    sc->sc_scan_chanset);\n#endif\n\t\n\tawi_cmd_scan(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_scan",
            "void awi_scan_next"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan;\nvoid awi_scan_next;\n\nvoid\nawi_scan_next (sc)\n\tstruct awi_softc *sc;\n{\n\tsc->sc_scan_pattern++;\n\tif (sc->sc_scan_pattern > IEEEWL_FH_PATTERN_MAX) {\n\t\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\t\t\n\n\t\tsc->sc_scan_chanset++;\n\t\tif (sc->sc_scan_chanset > IEEEWL_FH_CHANSET_MAX)\n\t\t\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\t}\n#if 0\n\tprintf(\"scan: pattern %x chanset %x\\n\", sc->sc_scan_pattern,\n\t    sc->sc_scan_chanset);\n#endif\n\t\n\tawi_cmd_scan(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_flush",
          "args": [
            "sc"
          ],
          "line": 2474
        },
        "resolved": true,
        "details": {
          "function_name": "awi_flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1585-1601",
          "snippet": "void\nawi_flush(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tstruct mbuf *m;\n\n\tdo {\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n\t\n\tdo {\n\t\tIF_DEQUEUE (&ifp->if_snd, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_flush"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_flush;\n\nvoid\nawi_flush(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tstruct mbuf *m;\n\n\tdo {\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n\t\n\tdo {\n\t\tIF_DEQUEUE (&ifp->if_snd, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_flush;\nvoid awi_cmd;\nvoid awi_scan_next;\nvoid awi_try_sync;\nvoid awi_cmd_sync_done;\n\nvoid\nawi_try_sync (sc) \n\tstruct awi_softc *sc;\n{\n\tint max_rssi = 0, best = 0;\n\tint i;\n\tstruct awi_bss_binding *bp = NULL;\n\t\n\tawi_flush(sc);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: looking for best of %d\\n\",\n\t\t    sc->sc_dev.dv_xname, sc->sc_nbindings);\n\t}\n\t/* pick one with best rssi */\n\tfor (i=0; i<sc->sc_nbindings; i++) {\n\t\tbp = &sc->sc_bindings[i];\n\n\t\tif (bp->rssi > max_rssi) {\n\t\t\tmax_rssi = bp->rssi;\n\t\t\tbest = i;\n\t\t}\n\t}\n\n\tif (bp == NULL) {\n\t\tprintf(\"%s: no beacons seen\\n\", sc->sc_dev.dv_xname);\n\t\tawi_scan_next(sc);\n\t\treturn;\n\t}\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: best %d\\n\", sc->sc_dev.dv_xname, best);\n\t}\n\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\n\tbp = &sc->sc_bindings[best];\n\tbcopy(bp, &sc->sc_active_bss, sizeof(*bp));\n\tsc->sc_new_bss = 1;\n\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_SET, bp->chanset);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_PATTERN, bp->pattern);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_IDX, bp->index);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_STARTBSS, 0);\n\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_DWELL, bp->dwell_time);\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_MBZ, 0);\n\n\tawi_write_bytes (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_TIMESTAMP,\n\t    bp->bss_timestamp, 8);\n\tawi_write_4 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_REFTIME, bp->rxtime);\n\n\tsc->sc_completion = awi_cmd_sync_done;\n\t\n\tawi_cmd (sc, AWI_CMD_SYNC);\n\n}"
  },
  {
    "function_name": "awi_scan_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2446-2464",
    "snippet": "void\nawi_scan_next (sc)\n\tstruct awi_softc *sc;\n{\n\tsc->sc_scan_pattern++;\n\tif (sc->sc_scan_pattern > IEEEWL_FH_PATTERN_MAX) {\n\t\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\t\t\n\n\t\tsc->sc_scan_chanset++;\n\t\tif (sc->sc_scan_chanset > IEEEWL_FH_CHANSET_MAX)\n\t\t\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\t}\n#if 0\n\tprintf(\"scan: pattern %x chanset %x\\n\", sc->sc_scan_pattern,\n\t    sc->sc_scan_chanset);\n#endif\n\t\n\tawi_cmd_scan(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_scan",
      "void awi_scan_next"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_scan",
          "args": [
            "sc"
          ],
          "line": 2463
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_scan_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2418-2444",
          "snippet": "void\nawi_cmd_scan_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tint erroffset;\n#endif\n\tif (status == AWI_STAT_OK) {\n\t\tif (sc->sc_scan_chanset > awi_max_chan)\n\t\t\tawi_max_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_chanset < awi_min_chan)\n\t\t\tawi_min_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_pattern > awi_max_pattern)\n\t\t\tawi_max_pattern = sc->sc_scan_pattern;\n\t\tif (sc->sc_scan_pattern < awi_min_pattern)\n\t\t\tawi_min_pattern = sc->sc_scan_pattern;\n\t\t\n\t\treturn;\n\t}\n#if 0\n\terroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\tprintf(\"%s: scan failed; erroffset %d\\n\", sc->sc_dev.dv_xname,\n\t    erroffset);\n#endif\n\t/* wait for response or scan timeout.. */\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_scan_done"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan_done;\n\nvoid\nawi_cmd_scan_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tint erroffset;\n#endif\n\tif (status == AWI_STAT_OK) {\n\t\tif (sc->sc_scan_chanset > awi_max_chan)\n\t\t\tawi_max_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_chanset < awi_min_chan)\n\t\t\tawi_min_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_pattern > awi_max_pattern)\n\t\t\tawi_max_pattern = sc->sc_scan_pattern;\n\t\tif (sc->sc_scan_pattern < awi_min_pattern)\n\t\t\tawi_min_pattern = sc->sc_scan_pattern;\n\t\t\n\t\treturn;\n\t}\n#if 0\n\terroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\tprintf(\"%s: scan failed; erroffset %d\\n\", sc->sc_dev.dv_xname,\n\t    erroffset);\n#endif\n\t/* wait for response or scan timeout.. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"scan: pattern %x chanset %x\\n\"",
            "sc->sc_scan_pattern",
            "sc->sc_scan_chanset"
          ],
          "line": 2459
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan;\nvoid awi_scan_next;\n\nvoid\nawi_scan_next (sc)\n\tstruct awi_softc *sc;\n{\n\tsc->sc_scan_pattern++;\n\tif (sc->sc_scan_pattern > IEEEWL_FH_PATTERN_MAX) {\n\t\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\t\t\n\n\t\tsc->sc_scan_chanset++;\n\t\tif (sc->sc_scan_chanset > IEEEWL_FH_CHANSET_MAX)\n\t\t\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\t}\n#if 0\n\tprintf(\"scan: pattern %x chanset %x\\n\", sc->sc_scan_pattern,\n\t    sc->sc_scan_chanset);\n#endif\n\t\n\tawi_cmd_scan(sc);\n}"
  },
  {
    "function_name": "awi_cmd_scan_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2418-2444",
    "snippet": "void\nawi_cmd_scan_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tint erroffset;\n#endif\n\tif (status == AWI_STAT_OK) {\n\t\tif (sc->sc_scan_chanset > awi_max_chan)\n\t\t\tawi_max_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_chanset < awi_min_chan)\n\t\t\tawi_min_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_pattern > awi_max_pattern)\n\t\t\tawi_max_pattern = sc->sc_scan_pattern;\n\t\tif (sc->sc_scan_pattern < awi_min_pattern)\n\t\t\tawi_min_pattern = sc->sc_scan_pattern;\n\t\t\n\t\treturn;\n\t}\n#if 0\n\terroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\tprintf(\"%s: scan failed; erroffset %d\\n\", sc->sc_dev.dv_xname,\n\t    erroffset);\n#endif\n\t/* wait for response or scan timeout.. */\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_scan_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: scan failed; erroffset %d\\n\"",
            "sc->sc_dev.dv_xname",
            "erroffset"
          ],
          "line": 2440
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan_done;\n\nvoid\nawi_cmd_scan_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tint erroffset;\n#endif\n\tif (status == AWI_STAT_OK) {\n\t\tif (sc->sc_scan_chanset > awi_max_chan)\n\t\t\tawi_max_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_chanset < awi_min_chan)\n\t\t\tawi_min_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_pattern > awi_max_pattern)\n\t\t\tawi_max_pattern = sc->sc_scan_pattern;\n\t\tif (sc->sc_scan_pattern < awi_min_pattern)\n\t\t\tawi_min_pattern = sc->sc_scan_pattern;\n\t\t\n\t\treturn;\n\t}\n#if 0\n\terroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\tprintf(\"%s: scan failed; erroffset %d\\n\", sc->sc_dev.dv_xname,\n\t    erroffset);\n#endif\n\t/* wait for response or scan timeout.. */\n}"
  },
  {
    "function_name": "awi_cmd_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2400-2416",
    "snippet": "void\nawi_cmd_scan (sc)\n\tstruct awi_softc *sc;\n{\n\t\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_DURATION,\n\t    sc->sc_scan_duration);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_SET,\n\t    sc->sc_scan_chanset);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_PATTERN,\n\t    sc->sc_scan_pattern);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_IDX, 1);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_SUSP, 0);\t\n\t\n\tsc->sc_completion = awi_cmd_scan_done;\n\tawi_cmd (sc, AWI_CMD_SCAN);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_scan",
      "void awi_cmd_scan_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_SCAN"
          ],
          "line": 2415
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SCAN_SUSP",
            "0"
          ],
          "line": 2412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SCAN_IDX",
            "1"
          ],
          "line": 2411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SCAN_PATTERN",
            "sc->sc_scan_pattern"
          ],
          "line": 2409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SCAN_SET",
            "sc->sc_scan_chanset"
          ],
          "line": 2407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_2",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_SCAN_DURATION",
            "sc->sc_scan_duration"
          ],
          "line": 2405
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_scan;\nvoid awi_cmd_scan_done;\n\nvoid\nawi_cmd_scan (sc)\n\tstruct awi_softc *sc;\n{\n\t\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_DURATION,\n\t    sc->sc_scan_duration);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_SET,\n\t    sc->sc_scan_chanset);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_PATTERN,\n\t    sc->sc_scan_pattern);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_IDX, 1);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SCAN_SUSP, 0);\t\n\t\n\tsc->sc_completion = awi_cmd_scan_done;\n\tawi_cmd (sc, AWI_CMD_SCAN);\n}"
  },
  {
    "function_name": "awi_restart_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2384-2398",
    "snippet": "void awi_restart_scan (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: starting scan\\n\", sc->sc_dev.dv_xname);\n\t}\n\tsc->sc_scan_timer = 2;\n\tsc->sc_mgt_timer = 0;\n\tawi_set_timer(sc);\n\n\tsc->sc_nbindings = 0;\n\tsc->sc_state = AWI_ST_SCAN;\n\tawi_drvstate (sc, AWI_DRV_INFSC);\n\tawi_cmd_scan (sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_scan"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_scan",
          "args": [
            "sc"
          ],
          "line": 2397
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_scan_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2418-2444",
          "snippet": "void\nawi_cmd_scan_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tint erroffset;\n#endif\n\tif (status == AWI_STAT_OK) {\n\t\tif (sc->sc_scan_chanset > awi_max_chan)\n\t\t\tawi_max_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_chanset < awi_min_chan)\n\t\t\tawi_min_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_pattern > awi_max_pattern)\n\t\t\tawi_max_pattern = sc->sc_scan_pattern;\n\t\tif (sc->sc_scan_pattern < awi_min_pattern)\n\t\t\tawi_min_pattern = sc->sc_scan_pattern;\n\t\t\n\t\treturn;\n\t}\n#if 0\n\terroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\tprintf(\"%s: scan failed; erroffset %d\\n\", sc->sc_dev.dv_xname,\n\t    erroffset);\n#endif\n\t/* wait for response or scan timeout.. */\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_scan_done"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan_done;\n\nvoid\nawi_cmd_scan_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tint erroffset;\n#endif\n\tif (status == AWI_STAT_OK) {\n\t\tif (sc->sc_scan_chanset > awi_max_chan)\n\t\t\tawi_max_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_chanset < awi_min_chan)\n\t\t\tawi_min_chan = sc->sc_scan_chanset;\n\t\tif (sc->sc_scan_pattern > awi_max_pattern)\n\t\t\tawi_max_pattern = sc->sc_scan_pattern;\n\t\tif (sc->sc_scan_pattern < awi_min_pattern)\n\t\t\tawi_min_pattern = sc->sc_scan_pattern;\n\t\t\n\t\treturn;\n\t}\n#if 0\n\terroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\tprintf(\"%s: scan failed; erroffset %d\\n\", sc->sc_dev.dv_xname,\n\t    erroffset);\n#endif\n\t/* wait for response or scan timeout.. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_drvstate",
          "args": [
            "sc",
            "AWI_DRV_INFSC"
          ],
          "line": 2396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_set_timer",
          "args": [
            "sc"
          ],
          "line": 2392
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "267-274",
          "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: starting scan\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 2388
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan;\n\nvoid awi_restart_scan (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: starting scan\\n\", sc->sc_dev.dv_xname);\n\t}\n\tsc->sc_scan_timer = 2;\n\tsc->sc_mgt_timer = 0;\n\tawi_set_timer(sc);\n\n\tsc->sc_nbindings = 0;\n\tsc->sc_state = AWI_ST_SCAN;\n\tawi_drvstate (sc, AWI_DRV_INFSC);\n\tawi_cmd_scan (sc);\n}"
  },
  {
    "function_name": "awi_init_5",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2354-2382",
    "snippet": "void awi_init_5 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tstruct ifnet *ifp = sc->sc_ifp;\n#endif\n\t\n#if 0\n\tprintf(\"%s: awi_init_5, st %x\\n\", sc->sc_dev.dv_xname, status);\n\tawi_card_hexdump(sc, \"init_5 CSB\", AWI_CSB, 16);\n#endif\n\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: init_rx failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\tsc->sc_rx_data_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_DATA_DESC);\n\tsc->sc_rx_mgt_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_PS_DESC);\t\n\n#if 0\n\tprintf(\"%s: data desc %x, mgt desc %x\\n\", sc->sc_dev.dv_xname,\n\t    sc->sc_rx_data_desc, sc->sc_rx_mgt_desc);\n#endif\n\tawi_restart_scan(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_reset",
      "void awi_init_5"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_restart_scan",
          "args": [
            "sc"
          ],
          "line": 2381
        },
        "resolved": true,
        "details": {
          "function_name": "awi_restart_scan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2384-2398",
          "snippet": "void awi_restart_scan (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: starting scan\\n\", sc->sc_dev.dv_xname);\n\t}\n\tsc->sc_scan_timer = 2;\n\tsc->sc_mgt_timer = 0;\n\tawi_set_timer(sc);\n\n\tsc->sc_nbindings = 0;\n\tsc->sc_state = AWI_ST_SCAN;\n\tawi_drvstate (sc, AWI_DRV_INFSC);\n\tawi_cmd_scan (sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_scan"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan;\n\nvoid awi_restart_scan (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: starting scan\\n\", sc->sc_dev.dv_xname);\n\t}\n\tsc->sc_scan_timer = 2;\n\tsc->sc_mgt_timer = 0;\n\tawi_set_timer(sc);\n\n\tsc->sc_nbindings = 0;\n\tsc->sc_state = AWI_ST_SCAN;\n\tawi_drvstate (sc, AWI_DRV_INFSC);\n\tawi_cmd_scan (sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: data desc %x, mgt desc %x\\n\"",
            "sc->sc_dev.dv_xname",
            "sc->sc_rx_data_desc",
            "sc->sc_rx_mgt_desc"
          ],
          "line": 2378
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_IRX_PS_DESC"
          ],
          "line": 2375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_IRX_DATA_DESC"
          ],
          "line": 2374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2370
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_card_hexdump",
          "args": [
            "sc",
            "\"init_5 CSB\"",
            "AWI_CSB",
            "16"
          ],
          "line": 2364
        },
        "resolved": true,
        "details": {
          "function_name": "awi_card_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "552-565",
          "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\nvoid awi_init_5;\n\nvoid awi_init_5 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tstruct ifnet *ifp = sc->sc_ifp;\n#endif\n\t\n#if 0\n\tprintf(\"%s: awi_init_5, st %x\\n\", sc->sc_dev.dv_xname, status);\n\tawi_card_hexdump(sc, \"init_5 CSB\", AWI_CSB, 16);\n#endif\n\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: init_rx failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\tsc->sc_rx_data_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_DATA_DESC);\n\tsc->sc_rx_mgt_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_PS_DESC);\t\n\n#if 0\n\tprintf(\"%s: data desc %x, mgt desc %x\\n\", sc->sc_dev.dv_xname,\n\t    sc->sc_rx_data_desc, sc->sc_rx_mgt_desc);\n#endif\n\tawi_restart_scan(sc);\n}"
  },
  {
    "function_name": "awi_init_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2329-2352",
    "snippet": "void\nawi_init_4 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"%s: awi_init_4, st %x\\n\", sc->sc_dev.dv_xname, status);\n\tawi_card_hexdump(sc, \"init_4 CSB\", AWI_CSB, 16);\n#endif\n\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: init_tx failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\tsc->sc_state = AWI_ST_RXINIT;\n\tsc->sc_completion = awi_init_5;\n\t\n\tawi_cmd (sc, AWI_CMD_INIT_RX);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_reset",
      "void awi_init_4",
      "void awi_init_5"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_INIT_RX"
          ],
          "line": 2351
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2344
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: init_tx failed (card unhappy?); erroffset %d\\n\"",
            "sc->sc_dev.dv_xname",
            "erroffset"
          ],
          "line": 2341
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_card_hexdump",
          "args": [
            "sc",
            "\"init_4 CSB\"",
            "AWI_CSB",
            "16"
          ],
          "line": 2336
        },
        "resolved": true,
        "details": {
          "function_name": "awi_card_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "552-565",
          "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_reset;\nvoid awi_init_4;\nvoid awi_init_5;\n\nvoid\nawi_init_4 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"%s: awi_init_4, st %x\\n\", sc->sc_dev.dv_xname, status);\n\tawi_card_hexdump(sc, \"init_4 CSB\", AWI_CSB, 16);\n#endif\n\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: init_tx failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\tsc->sc_state = AWI_ST_RXINIT;\n\tsc->sc_completion = awi_init_5;\n\t\n\tawi_cmd (sc, AWI_CMD_INIT_RX);\n}"
  },
  {
    "function_name": "awi_cmd_set_promisc_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2302-2327",
    "snippet": "void awi_cmd_set_promisc_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set promisc_done\\n\");\n#endif\n\t\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_promisc_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_promisc done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_init_txdescr(sc);\n\n\tsc->sc_state = AWI_ST_TXINIT;\n\tsc->sc_completion = awi_init_4;\n\tawi_cmd_txinit(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_txinit",
      "void awi_cmd_set_promisc_done",
      "void awi_reset",
      "void awi_init_4",
      "void awi_init_txdescr"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_txinit",
          "args": [
            "sc"
          ],
          "line": 2326
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_txinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2064-2075",
          "snippet": "void\nawi_cmd_txinit (sc) \n\tstruct awi_softc *sc;\n{\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_DATA, sc->sc_txbase);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_MGT, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_BCAST, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_PS, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_CF, 0);\n\t\n\tawi_cmd (sc, AWI_CMD_INIT_TX);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd",
            "void awi_cmd_txinit"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_txinit;\n\nvoid\nawi_cmd_txinit (sc) \n\tstruct awi_softc *sc;\n{\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_DATA, sc->sc_txbase);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_MGT, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_BCAST, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_PS, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_CF, 0);\n\t\n\tawi_cmd (sc, AWI_CMD_INIT_TX);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_init_txdescr",
          "args": [
            "sc"
          ],
          "line": 2322
        },
        "resolved": true,
        "details": {
          "function_name": "awi_init_txdescr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1424-1458",
          "snippet": "void\nawi_init_txdescr (sc)\n\tstruct awi_softc *sc;\n{\n\tint i;\n\tu_int32_t offset = sc->sc_txbase;\n\n\tsc->sc_txfirst = 0;\n\tsc->sc_txnext = 0;\n\n\tsc->sc_ntxd = sc->sc_txlen / (AWI_FRAME_SIZE + AWI_TXD_SIZE);\n\tif (sc->sc_ntxd > NTXD) {\n\t\tsc->sc_ntxd = NTXD;\n\t\tprintf(\"oops, no, only %d\\n\", sc->sc_ntxd);\n\t}\n\n\t/* Allocate TXD's */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].descr = offset;\n\t\toffset += AWI_TXD_SIZE;\n\t}\n\t/* now, allocate buffer space to each txd.. */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].frame = offset;\n\t\tsc->sc_txd[i].len = AWI_FRAME_SIZE;\n\t\toffset += AWI_FRAME_SIZE;\n\t\t\n\t}\n\t\n\t/* now, initialize the TX descriptors into a circular linked list. */\n\t\n\tfor (i= 0; i<sc->sc_ntxd; i++) {\n\t\tawi_init_txd(sc, i, 0, 0, 0);\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_init_txdescr",
            "void awi_init_txd"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_init_txdescr;\nvoid awi_init_txd;\n\nvoid\nawi_init_txdescr (sc)\n\tstruct awi_softc *sc;\n{\n\tint i;\n\tu_int32_t offset = sc->sc_txbase;\n\n\tsc->sc_txfirst = 0;\n\tsc->sc_txnext = 0;\n\n\tsc->sc_ntxd = sc->sc_txlen / (AWI_FRAME_SIZE + AWI_TXD_SIZE);\n\tif (sc->sc_ntxd > NTXD) {\n\t\tsc->sc_ntxd = NTXD;\n\t\tprintf(\"oops, no, only %d\\n\", sc->sc_ntxd);\n\t}\n\n\t/* Allocate TXD's */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].descr = offset;\n\t\toffset += AWI_TXD_SIZE;\n\t}\n\t/* now, allocate buffer space to each txd.. */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].frame = offset;\n\t\tsc->sc_txd[i].len = AWI_FRAME_SIZE;\n\t\toffset += AWI_FRAME_SIZE;\n\t\t\n\t}\n\t\n\t/* now, initialize the TX descriptors into a circular linked list. */\n\t\n\tfor (i= 0; i<sc->sc_ntxd; i++) {\n\t\tawi_init_txd(sc, i, 0, 0, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: set_promisc done\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 2319
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2315
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_txinit;\nvoid awi_cmd_set_promisc_done;\nvoid awi_reset;\nvoid awi_init_4;\nvoid awi_init_txdescr;\n\nvoid awi_cmd_set_promisc_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set promisc_done\\n\");\n#endif\n\t\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_promisc_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_promisc done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_init_txdescr(sc);\n\n\tsc->sc_state = AWI_ST_TXINIT;\n\tsc->sc_completion = awi_init_4;\n\tawi_cmd_txinit(sc);\n}"
  },
  {
    "function_name": "awi_cmd_set_promisc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2290-2300",
    "snippet": "void awi_cmd_set_promisc (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_MAC);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_MAC_PROMISC); \n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 0); /* XXX */\n\tsc->sc_completion = awi_cmd_set_promisc_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_set_promisc",
      "void awi_cmd_set_promisc_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_SET_MIB"
          ],
          "line": 2299
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA",
            "0"
          ],
          "line": 2297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_INDEX",
            "AWI_MIB_MAC_PROMISC"
          ],
          "line": 2295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_SIZE",
            "1"
          ],
          "line": 2294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_TYPE",
            "AWI_MIB_MAC"
          ],
          "line": 2293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_set_promisc;\nvoid awi_cmd_set_promisc_done;\n\nvoid awi_cmd_set_promisc (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_MAC);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_MAC_PROMISC); \n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 0); /* XXX */\n\tsc->sc_completion = awi_cmd_set_promisc_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}"
  },
  {
    "function_name": "awi_cmd_set_allmulti_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2275-2288",
    "snippet": "void awi_cmd_set_allmulti_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_almulti_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_promisc (sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_set_promisc",
      "void awi_cmd_set_allmulti_done",
      "void awi_reset"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_set_promisc",
          "args": [
            "sc"
          ],
          "line": 2287
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_promisc_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2302-2327",
          "snippet": "void awi_cmd_set_promisc_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set promisc_done\\n\");\n#endif\n\t\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_promisc_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_promisc done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_init_txdescr(sc);\n\n\tsc->sc_state = AWI_ST_TXINIT;\n\tsc->sc_completion = awi_init_4;\n\tawi_cmd_txinit(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_txinit",
            "void awi_cmd_set_promisc_done",
            "void awi_reset",
            "void awi_init_4",
            "void awi_init_txdescr"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_txinit;\nvoid awi_cmd_set_promisc_done;\nvoid awi_reset;\nvoid awi_init_4;\nvoid awi_init_txdescr;\n\nvoid awi_cmd_set_promisc_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set promisc_done\\n\");\n#endif\n\t\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_promisc_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_promisc done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_init_txdescr(sc);\n\n\tsc->sc_state = AWI_ST_TXINIT;\n\tsc->sc_completion = awi_init_4;\n\tawi_cmd_txinit(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2284
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: set_almulti_done failed (card unhappy?); erroffset %d\\n\"",
            "sc->sc_dev.dv_xname",
            "erroffset"
          ],
          "line": 2281
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_promisc;\nvoid awi_cmd_set_allmulti_done;\nvoid awi_reset;\n\nvoid awi_cmd_set_allmulti_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_almulti_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_promisc (sc);\n}"
  },
  {
    "function_name": "awi_cmd_set_allmulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2263-2273",
    "snippet": "void awi_cmd_set_allmulti (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_LOCAL);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_LOCAL_FILTMULTI);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 0);\n\tsc->sc_completion = awi_cmd_set_allmulti_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_set_allmulti",
      "void awi_cmd_set_allmulti_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_SET_MIB"
          ],
          "line": 2272
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA",
            "0"
          ],
          "line": 2270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_INDEX",
            "AWI_MIB_LOCAL_FILTMULTI"
          ],
          "line": 2268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_SIZE",
            "1"
          ],
          "line": 2267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_TYPE",
            "AWI_MIB_LOCAL"
          ],
          "line": 2266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_set_allmulti;\nvoid awi_cmd_set_allmulti_done;\n\nvoid awi_cmd_set_allmulti (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_LOCAL);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_LOCAL_FILTMULTI);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 0);\n\tsc->sc_completion = awi_cmd_set_allmulti_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}"
  },
  {
    "function_name": "awi_cmd_set_infra_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2242-2261",
    "snippet": "void awi_cmd_set_infra_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set_infra done\\n\");\n#endif\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_infra done\\n\", sc->sc_dev.dv_xname);\n#endif\n\tawi_cmd_set_allmulti (sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_set_allmulti",
      "void awi_cmd_set_infra_done",
      "void awi_reset"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_set_allmulti",
          "args": [
            "sc"
          ],
          "line": 2260
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_allmulti_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2275-2288",
          "snippet": "void awi_cmd_set_allmulti_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_almulti_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_promisc (sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_promisc",
            "void awi_cmd_set_allmulti_done",
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_promisc;\nvoid awi_cmd_set_allmulti_done;\nvoid awi_reset;\n\nvoid awi_cmd_set_allmulti_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_almulti_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_promisc (sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: set_infra done\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 2258
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2254
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_allmulti;\nvoid awi_cmd_set_infra_done;\nvoid awi_reset;\n\nvoid awi_cmd_set_infra_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set_infra done\\n\");\n#endif\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_infra done\\n\", sc->sc_dev.dv_xname);\n#endif\n\tawi_cmd_set_allmulti (sc);\n}"
  },
  {
    "function_name": "awi_cmd_set_infra",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2228-2240",
    "snippet": "void awi_cmd_set_infra (sc)\n\tstruct awi_softc *sc;\n{\n\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_LOCAL);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_LOCAL_INFRA_MODE);\n\t\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 1);\n\tsc->sc_completion = awi_cmd_set_infra_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_set_infra",
      "void awi_cmd_set_infra_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_SET_MIB"
          ],
          "line": 2239
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA",
            "1"
          ],
          "line": 2237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_INDEX",
            "AWI_MIB_LOCAL_INFRA_MODE"
          ],
          "line": 2234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_SIZE",
            "1"
          ],
          "line": 2233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_TYPE",
            "AWI_MIB_LOCAL"
          ],
          "line": 2232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_set_infra;\nvoid awi_cmd_set_infra_done;\n\nvoid awi_cmd_set_infra (sc)\n\tstruct awi_softc *sc;\n{\n\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_LOCAL);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_LOCAL_INFRA_MODE);\n\t\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 1);\n\tsc->sc_completion = awi_cmd_set_infra_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}"
  },
  {
    "function_name": "awi_cmd_set_notap_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2213-2226",
    "snippet": "void awi_cmd_set_notap_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_infra (sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_set_infra",
      "void awi_cmd_set_notap_done",
      "void awi_reset"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_set_infra",
          "args": [
            "sc"
          ],
          "line": 2225
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_infra_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2242-2261",
          "snippet": "void awi_cmd_set_infra_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set_infra done\\n\");\n#endif\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_infra done\\n\", sc->sc_dev.dv_xname);\n#endif\n\tawi_cmd_set_allmulti (sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_allmulti",
            "void awi_cmd_set_infra_done",
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_allmulti;\nvoid awi_cmd_set_infra_done;\nvoid awi_reset;\n\nvoid awi_cmd_set_infra_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tprintf(\"set_infra done\\n\");\n#endif\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_infra done\\n\", sc->sc_dev.dv_xname);\n#endif\n\tawi_cmd_set_allmulti (sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2222
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: set_infra failed (card unhappy?); erroffset %d\\n\"",
            "sc->sc_dev.dv_xname",
            "erroffset"
          ],
          "line": 2219
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_ERROR_OFFSET"
          ],
          "line": 2218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_infra;\nvoid awi_cmd_set_notap_done;\nvoid awi_reset;\n\nvoid awi_cmd_set_notap_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_infra (sc);\n}"
  },
  {
    "function_name": "awi_cmd_set_notap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2200-2211",
    "snippet": "void awi_cmd_set_notap (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_LOCAL);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_LOCAL_ACTING_AS_AP);\n\t\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 0);\n\tsc->sc_completion = awi_cmd_set_notap_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_set_notap",
      "void awi_cmd_set_notap_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_SET_MIB"
          ],
          "line": 2210
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA",
            "0"
          ],
          "line": 2208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_INDEX",
            "AWI_MIB_LOCAL_ACTING_AS_AP"
          ],
          "line": 2205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_SIZE",
            "1"
          ],
          "line": 2204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_TYPE",
            "AWI_MIB_LOCAL"
          ],
          "line": 2203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_set_notap;\nvoid awi_cmd_set_notap_done;\n\nvoid awi_cmd_set_notap (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, AWI_MIB_LOCAL);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, 1);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX,\n\t    AWI_MIB_LOCAL_ACTING_AS_AP);\n\t\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA, 0);\n\tsc->sc_completion = awi_cmd_set_notap_done;\n\tawi_cmd (sc, AWI_CMD_SET_MIB);\n}"
  },
  {
    "function_name": "awi_init_read_bufptrs_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2161-2198",
    "snippet": "void awi_init_read_bufptrs_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: get_mib failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t}\n\t\n\tsc->sc_txbase = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_TXB_OFFSET);\n\tsc->sc_txlen = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_TXB_SIZE);\n\tsc->sc_rxbase = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_RXB_OFFSET);\n\tsc->sc_rxlen = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_RXB_SIZE);\n\t/*\n\t * XXX consider repartitioning buffer space to allow for\n\t * more efficient usage.\n\t * 6144: 3 txds, 1476 waste\t(current partition)\n\t * better splits:\n\t * 4864: 3 txds, 196 waste\n\t * 6400: 4 txds, 176 waste\n\t * 7936: 5 txds, 156 waste\n\t */\n\n#if 0\n\tprintf(\"tx offset: %x\\n\", sc->sc_txbase);\n\tprintf(\"tx size: %x\\n\", sc->sc_txlen);\n\tprintf(\"rx offset: %x\\n\", sc->sc_rxbase);\n\tprintf(\"rx size: %x\\n\", sc->sc_rxlen);\n#endif\n\t\n\tsc->sc_state = AWI_ST_MIB_SET;\n\tawi_cmd_set_notap(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_set_notap",
      "void awi_reset",
      "void awi_init_read_bufptrs_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_set_notap",
          "args": [
            "sc"
          ],
          "line": 2197
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_notap_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2213-2226",
          "snippet": "void awi_cmd_set_notap_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_infra (sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_infra",
            "void awi_cmd_set_notap_done",
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_infra;\nvoid awi_cmd_set_notap_done;\nvoid awi_reset;\n\nvoid awi_cmd_set_notap_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_infra failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\tawi_cmd_set_infra (sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"rx size: %x\\n\"",
            "sc->sc_rxlen"
          ],
          "line": 2193
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_RXB_SIZE"
          ],
          "line": 2177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_RXB_OFFSET"
          ],
          "line": 2175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_TXB_SIZE"
          ],
          "line": 2173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_TXB_OFFSET"
          ],
          "line": 2171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2168
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_notap;\nvoid awi_reset;\nvoid awi_init_read_bufptrs_done;\n\nvoid awi_init_read_bufptrs_done (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: get_mib failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t}\n\t\n\tsc->sc_txbase = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_TXB_OFFSET);\n\tsc->sc_txlen = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_TXB_SIZE);\n\tsc->sc_rxbase = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_RXB_OFFSET);\n\tsc->sc_rxlen = awi_read_4 (sc,\n\t    AWI_CMD_PARAMS+AWI_CA_MIB_DATA+AWI_MIB_LOCAL_RXB_SIZE);\n\t/*\n\t * XXX consider repartitioning buffer space to allow for\n\t * more efficient usage.\n\t * 6144: 3 txds, 1476 waste\t(current partition)\n\t * better splits:\n\t * 4864: 3 txds, 196 waste\n\t * 6400: 4 txds, 176 waste\n\t * 7936: 5 txds, 156 waste\n\t */\n\n#if 0\n\tprintf(\"tx offset: %x\\n\", sc->sc_txbase);\n\tprintf(\"tx size: %x\\n\", sc->sc_txlen);\n\tprintf(\"rx offset: %x\\n\", sc->sc_rxbase);\n\tprintf(\"rx size: %x\\n\", sc->sc_rxlen);\n#endif\n\t\n\tsc->sc_state = AWI_ST_MIB_SET;\n\tawi_cmd_set_notap(sc);\n}"
  },
  {
    "function_name": "awi_init_2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2144-2159",
    "snippet": "void awi_init_2 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\t/* did it succeed? */\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: nop failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t}\n\t\n\tsc->sc_state = AWI_ST_MIB_GET;\n\tsc->sc_completion = awi_init_read_bufptrs_done;\n\n\tawi_cmd_get_mib (sc, AWI_MIB_LOCAL, 0, AWI_MIB_LOCAL_SIZE);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_get_mib",
      "void awi_reset",
      "void awi_init_2",
      "void awi_init_read_bufptrs_done"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_get_mib",
          "args": [
            "sc",
            "AWI_MIB_LOCAL",
            "0",
            "AWI_MIB_LOCAL_SIZE"
          ],
          "line": 2158
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_get_mib",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2050-2062",
          "snippet": "void\nawi_cmd_get_mib (sc, var, offset, len)\n\tstruct awi_softc *sc;\n\tu_int8_t var;\n\tu_int8_t offset;\n\tu_int8_t len;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, var);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, len);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX, offset);\n\n\tawi_cmd (sc, AWI_CMD_GET_MIB);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd",
            "void awi_cmd_get_mib"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_get_mib;\n\nvoid\nawi_cmd_get_mib (sc, var, offset, len)\n\tstruct awi_softc *sc;\n\tu_int8_t var;\n\tu_int8_t offset;\n\tu_int8_t len;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, var);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, len);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX, offset);\n\n\tawi_cmd (sc, AWI_CMD_GET_MIB);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: nop failed (card unhappy?)\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 2150
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_get_mib;\nvoid awi_reset;\nvoid awi_init_2;\nvoid awi_init_read_bufptrs_done;\n\nvoid awi_init_2 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\t/* did it succeed? */\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: nop failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t}\n\t\n\tsc->sc_state = AWI_ST_MIB_GET;\n\tsc->sc_completion = awi_init_read_bufptrs_done;\n\n\tawi_cmd_get_mib (sc, AWI_MIB_LOCAL, 0, AWI_MIB_LOCAL_SIZE);\n}"
  },
  {
    "function_name": "awi_mibdump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2108-2137",
    "snippet": "void awi_mibdump (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tu_int8_t mibblk[256];\n\t    \n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: pre-mibread failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\t\n\tif (sc->sc_curmib != 0) {\n\t\tawi_read_bytes(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA,\n\t\t    mibblk, 72);\n\t\tawi_hexdump(\"mib\", mibblk, 72);\n\t}\n\tif (sc->sc_curmib > AWI_MIB_LAST) {\n\t\tawi_init_2 (sc, status);\n\t} else {\n\t\tsc->sc_completion = awi_mibdump;\n\t\tprintf(\"mib %d\\n\", sc->sc_curmib);\n\t\tawi_cmd_get_mib (sc, sc->sc_curmib, 0, 30);\n\t\tsc->sc_curmib++;\n\t\t/* skip over reserved MIB's.. */\n\t\tif ((sc->sc_curmib == 1) || (sc->sc_curmib == 6))\n\t\t\tsc->sc_curmib++;\n\t}\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd_get_mib",
      "void awi_reset",
      "void awi_init_2",
      "void awi_mibdump"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_get_mib",
          "args": [
            "sc",
            "sc->sc_curmib",
            "0",
            "30"
          ],
          "line": 2131
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_get_mib",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2050-2062",
          "snippet": "void\nawi_cmd_get_mib (sc, var, offset, len)\n\tstruct awi_softc *sc;\n\tu_int8_t var;\n\tu_int8_t offset;\n\tu_int8_t len;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, var);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, len);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX, offset);\n\n\tawi_cmd (sc, AWI_CMD_GET_MIB);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd",
            "void awi_cmd_get_mib"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_get_mib;\n\nvoid\nawi_cmd_get_mib (sc, var, offset, len)\n\tstruct awi_softc *sc;\n\tu_int8_t var;\n\tu_int8_t offset;\n\tu_int8_t len;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, var);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, len);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX, offset);\n\n\tawi_cmd (sc, AWI_CMD_GET_MIB);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"mib %d\\n\"",
            "sc->sc_curmib"
          ],
          "line": 2130
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_init_2",
          "args": [
            "sc",
            "status"
          ],
          "line": 2127
        },
        "resolved": true,
        "details": {
          "function_name": "awi_init_2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2144-2159",
          "snippet": "void awi_init_2 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\t/* did it succeed? */\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: nop failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t}\n\t\n\tsc->sc_state = AWI_ST_MIB_GET;\n\tsc->sc_completion = awi_init_read_bufptrs_done;\n\n\tawi_cmd_get_mib (sc, AWI_MIB_LOCAL, 0, AWI_MIB_LOCAL_SIZE);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_get_mib",
            "void awi_reset",
            "void awi_init_2",
            "void awi_init_read_bufptrs_done"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_get_mib;\nvoid awi_reset;\nvoid awi_init_2;\nvoid awi_init_read_bufptrs_done;\n\nvoid awi_init_2 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\t/* did it succeed? */\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: nop failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t}\n\t\n\tsc->sc_state = AWI_ST_MIB_GET;\n\tsc->sc_completion = awi_init_read_bufptrs_done;\n\n\tawi_cmd_get_mib (sc, AWI_MIB_LOCAL, 0, AWI_MIB_LOCAL_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_hexdump",
          "args": [
            "\"mib\"",
            "mibblk",
            "72"
          ],
          "line": 2124
        },
        "resolved": true,
        "details": {
          "function_name": "awi_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "541-550",
          "snippet": "void awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_bytes",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_DATA",
            "mibblk",
            "72"
          ],
          "line": 2122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 2117
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_get_mib;\nvoid awi_reset;\nvoid awi_init_2;\nvoid awi_mibdump;\n\nvoid awi_mibdump (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tu_int8_t mibblk[256];\n\t    \n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: pre-mibread failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\t\n\tif (sc->sc_curmib != 0) {\n\t\tawi_read_bytes(sc, AWI_CMD_PARAMS+AWI_CA_MIB_DATA,\n\t\t    mibblk, 72);\n\t\tawi_hexdump(\"mib\", mibblk, 72);\n\t}\n\tif (sc->sc_curmib > AWI_MIB_LAST) {\n\t\tawi_init_2 (sc, status);\n\t} else {\n\t\tsc->sc_completion = awi_mibdump;\n\t\tprintf(\"mib %d\\n\", sc->sc_curmib);\n\t\tawi_cmd_get_mib (sc, sc->sc_curmib, 0, 30);\n\t\tsc->sc_curmib++;\n\t\t/* skip over reserved MIB's.. */\n\t\tif ((sc->sc_curmib == 1) || (sc->sc_curmib == 6))\n\t\t\tsc->sc_curmib++;\n\t}\n}"
  },
  {
    "function_name": "awi_init_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2088-2106",
    "snippet": "void awi_init_1 (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_intrinit(sc);\n\n\tsc->sc_state = AWI_ST_IFTEST;\n\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tawi_card_hexdump(sc, \"init_1 CSB\", AWI_CSB, 16);\n\t\tsc->sc_completion = awi_mibdump;\n\t} else\n\t\tsc->sc_completion = awi_init_2;\n\n\tsc->sc_curmib = 0;\n\n\tawi_cmd_test_if (sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_intrinit",
      "void awi_cmd_test_if",
      "void awi_init_1",
      "void awi_init_2",
      "void awi_mibdump"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd_test_if",
          "args": [
            "sc"
          ],
          "line": 2105
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_test_if",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2043-2048",
          "snippet": "void\nawi_cmd_test_if (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_cmd (sc, AWI_CMD_NOP);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd",
            "void awi_cmd_test_if"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_test_if;\n\nvoid\nawi_cmd_test_if (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_cmd (sc, AWI_CMD_NOP);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_card_hexdump",
          "args": [
            "sc",
            "\"init_1 CSB\"",
            "AWI_CSB",
            "16"
          ],
          "line": 2098
        },
        "resolved": true,
        "details": {
          "function_name": "awi_card_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "552-565",
          "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_intrinit",
          "args": [
            "sc"
          ],
          "line": 2093
        },
        "resolved": true,
        "details": {
          "function_name": "awi_intrinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "519-539",
          "snippet": "void\nawi_intrinit(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t intmask;\n\n\tam79c930_gcr_setbits(&sc->sc_chip, AM79C930_GCR_ENECINT);\n\t\n\tintmask = AWI_INT_GROGGY|AWI_INT_SCAN_CMPLT|\n\t    AWI_INT_TX|AWI_INT_RX|AWI_INT_CMD;\n\n\tintmask = ~intmask;\n\n\tif (!awi_intlock(sc))\n\t\treturn;\n\t\n\tawi_write_1(sc, AWI_INTMASK, intmask);\n\tawi_write_1(sc, AWI_INTMASK2, 0); \n\n\tawi_intunlock(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int awi_intlock",
            "void awi_intunlock",
            "void awi_intrinit"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint awi_intlock;\nvoid awi_intunlock;\nvoid awi_intrinit;\n\nvoid\nawi_intrinit(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t intmask;\n\n\tam79c930_gcr_setbits(&sc->sc_chip, AM79C930_GCR_ENECINT);\n\t\n\tintmask = AWI_INT_GROGGY|AWI_INT_SCAN_CMPLT|\n\t    AWI_INT_TX|AWI_INT_RX|AWI_INT_CMD;\n\n\tintmask = ~intmask;\n\n\tif (!awi_intlock(sc))\n\t\treturn;\n\t\n\tawi_write_1(sc, AWI_INTMASK, intmask);\n\tawi_write_1(sc, AWI_INTMASK2, 0); \n\n\tawi_intunlock(sc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_intrinit;\nvoid awi_cmd_test_if;\nvoid awi_init_1;\nvoid awi_init_2;\nvoid awi_mibdump;\n\nvoid awi_init_1 (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_intrinit(sc);\n\n\tsc->sc_state = AWI_ST_IFTEST;\n\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tawi_card_hexdump(sc, \"init_1 CSB\", AWI_CSB, 16);\n\t\tsc->sc_completion = awi_mibdump;\n\t} else\n\t\tsc->sc_completion = awi_init_2;\n\n\tsc->sc_curmib = 0;\n\n\tawi_cmd_test_if (sc);\n}"
  },
  {
    "function_name": "awi_cmd_txinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2064-2075",
    "snippet": "void\nawi_cmd_txinit (sc) \n\tstruct awi_softc *sc;\n{\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_DATA, sc->sc_txbase);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_MGT, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_BCAST, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_PS, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_CF, 0);\n\t\n\tawi_cmd (sc, AWI_CMD_INIT_TX);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_txinit"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_INIT_TX"
          ],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_TX_CF",
            "0"
          ],
          "line": 2072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_TX_PS",
            "0"
          ],
          "line": 2071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_TX_BCAST",
            "0"
          ],
          "line": 2070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_TX_MGT",
            "0"
          ],
          "line": 2069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_TX_DATA",
            "sc->sc_txbase"
          ],
          "line": 2068
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_txinit;\n\nvoid\nawi_cmd_txinit (sc) \n\tstruct awi_softc *sc;\n{\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_DATA, sc->sc_txbase);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_MGT, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_BCAST, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_PS, 0);\n\tawi_write_4(sc, AWI_CMD_PARAMS+AWI_CA_TX_CF, 0);\n\t\n\tawi_cmd (sc, AWI_CMD_INIT_TX);\n}"
  },
  {
    "function_name": "awi_cmd_get_mib",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2050-2062",
    "snippet": "void\nawi_cmd_get_mib (sc, var, offset, len)\n\tstruct awi_softc *sc;\n\tu_int8_t var;\n\tu_int8_t offset;\n\tu_int8_t len;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, var);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, len);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX, offset);\n\n\tawi_cmd (sc, AWI_CMD_GET_MIB);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_get_mib"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_GET_MIB"
          ],
          "line": 2061
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_INDEX",
            "offset"
          ],
          "line": 2059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_SIZE",
            "len"
          ],
          "line": 2058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_PARAMS+AWI_CA_MIB_TYPE",
            "var"
          ],
          "line": 2057
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_get_mib;\n\nvoid\nawi_cmd_get_mib (sc, var, offset, len)\n\tstruct awi_softc *sc;\n\tu_int8_t var;\n\tu_int8_t offset;\n\tu_int8_t len;\n{\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_TYPE, var);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_SIZE, len);\n\tawi_write_1(sc, AWI_CMD_PARAMS+AWI_CA_MIB_INDEX, offset);\n\n\tawi_cmd (sc, AWI_CMD_GET_MIB);\n}"
  },
  {
    "function_name": "awi_cmd_test_if",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2043-2048",
    "snippet": "void\nawi_cmd_test_if (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_cmd (sc, AWI_CMD_NOP);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd",
      "void awi_cmd_test_if"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_cmd",
          "args": [
            "sc",
            "AWI_CMD_NOP"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "awi_cmd_set_ss_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2576-2600",
          "snippet": "void awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_set_ss_done",
            "void awi_reset",
            "void awi_running",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_set_ss_done;\nvoid awi_reset;\nvoid awi_running;\nvoid awi_send_authreq;\n\nvoid awi_cmd_set_ss_done (sc, status) \n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n\tif (status != AWI_STAT_OK) {\n\t\tint erroffset = awi_read_1 (sc, AWI_ERROR_OFFSET);\n\t\tprintf(\"%s: set_ss_done failed (card unhappy?); erroffset %d\\n\",\n\t\t    sc->sc_dev.dv_xname,\n\t\t    erroffset);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n#if 0\n\tprintf(\"%s: set_ss done\\n\", sc->sc_dev.dv_xname);\n#endif\n\n\tawi_running (sc);\n\t\n\t/*\n\t * now, we *should* be getting broadcast frames..\n\t */\n\tsc->sc_state = AWI_ST_SYNCED;\n\tawi_send_authreq (sc);\n\t\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\nvoid awi_cmd_test_if;\n\nvoid\nawi_cmd_test_if (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_cmd (sc, AWI_CMD_NOP);\n}"
  },
  {
    "function_name": "awi_cmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "2024-2041",
    "snippet": "void\nawi_cmd (sc, opcode)\n\tstruct awi_softc *sc;\n\tu_int8_t opcode;\n{\n\tif (sc->sc_flags & AWI_FL_CMD_INPROG)\n\t\tpanic(\"%s: command reentered\", sc->sc_dev.dv_xname);\n\t\n\tsc->sc_flags |= AWI_FL_CMD_INPROG;\n\t\n\t/* issue test-interface command */\n\tawi_write_1(sc, AWI_CMD, opcode);\n\n\tawi_write_1(sc, AWI_CMD_STATUS, 0);\n\n\tsc->sc_cmd_timer = 2;\n\tawi_set_timer(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_cmd"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_set_timer",
          "args": [
            "sc"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "267-274",
          "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD_STATUS",
            "0"
          ],
          "line": 2037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD",
            "opcode"
          ],
          "line": 2035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"%s: command reentered\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 2030
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd;\n\nvoid\nawi_cmd (sc, opcode)\n\tstruct awi_softc *sc;\n\tu_int8_t opcode;\n{\n\tif (sc->sc_flags & AWI_FL_CMD_INPROG)\n\t\tpanic(\"%s: command reentered\", sc->sc_dev.dv_xname);\n\t\n\tsc->sc_flags |= AWI_FL_CMD_INPROG;\n\t\n\t/* issue test-interface command */\n\tawi_write_1(sc, AWI_CMD, opcode);\n\n\tawi_write_1(sc, AWI_CMD_STATUS, 0);\n\n\tsc->sc_cmd_timer = 2;\n\tawi_set_timer(sc);\n}"
  },
  {
    "function_name": "awi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1965-2022",
    "snippet": "void\nawi_init (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\n\tsc->sc_scan_duration = 100; /* scan for 100ms */\n\n\t/*\n\t * Maybe we should randomize these....\n\t */\n\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\n\t\n\tsc->sc_flags &= ~AWI_FL_CMD_INPROG;\n\n\tifp->if_flags &= ~(IFF_RUNNING|IFF_OACTIVE);\n\tifp->if_timer = 0;\n\t\n\tsc->sc_cmd_timer = 0;\n\tsc->sc_tx_timer = 0;\n\tsc->sc_mgt_timer = 0;\n\tsc->sc_scan_timer = 0;\n\t\n\tsc->sc_nbindings = 0;\n\n\t/*\n\t * this reset sequence doesn't seem to always do the trick.\n\t * hard-power-cycling the card may do it..\n\t */\n\t\n\t/*\n\t * reset the hardware, just to be sure.\n\t * (bring out the big hammer here..)\n\t */\n\t/* XXX insert delay here? */\n\t\n\tam79c930_gcr_setbits (&sc->sc_chip, AM79C930_GCR_CORESET);\n\tdelay(10);\t\t/* XXX arbitrary value */\n\n\t/*\n\t * clear control memory regions (firmware should do this but...)\n\t */\n\tawi_zero(sc, AWI_LAST_TXD, AWI_BUFFERS);\n\n\tawi_drvstate(sc, AWI_DRV_RESET);\n\tsc->sc_selftest_tries = 0;\n\n\t/*\n\t * release reset\n\t */\n\tam79c930_gcr_clearbits (&sc->sc_chip, AM79C930_GCR_CORESET);\n\tdelay(10);\n\t\n\tsc->sc_state = AWI_ST_SELFTEST;\n\tifp->if_timer = 1;\n\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_init",
      "void awi_zero"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 2017
        },
        "resolved": true,
        "details": {
          "function_name": "dc_delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/dc.c",
          "lines": "215-222",
          "snippet": "void dc_delay(sc)\n\tstruct dc_softc\t\t*sc;\n{\n\tint\t\t\tidx;\n\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\tCSR_READ_4(sc, DC_BUSCTL);\n}",
          "includes": [
            "#include <dev/ic/dcreg.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <vm/pmap.h>            /* for vtophys */",
            "#include <vm/vm.h>              /* for vtophys */",
            "#include <net/bpf.h>",
            "#include <net/if_media.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/protosw.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void dc_delay"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/dcreg.h>\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <vm/pmap.h>            /* for vtophys */\n#include <vm/vm.h>              /* for vtophys */\n#include <net/bpf.h>\n#include <net/if_media.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/protosw.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid dc_delay;\n\nvoid dc_delay(sc)\n\tstruct dc_softc\t\t*sc;\n{\n\tint\t\t\tidx;\n\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\tCSR_READ_4(sc, DC_BUSCTL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "am79c930_gcr_clearbits",
          "args": [
            "&sc->sc_chip",
            "AM79C930_GCR_CORESET"
          ],
          "line": 2016
        },
        "resolved": true,
        "details": {
          "function_name": "am79c930_gcr_clearbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "334-343",
          "snippet": "void am79c930_gcr_clearbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr &= ~bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_gcr_clearbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr &= ~bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_drvstate",
          "args": [
            "sc",
            "AWI_DRV_RESET"
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_zero",
          "args": [
            "sc",
            "AWI_LAST_TXD",
            "AWI_BUFFERS"
          ],
          "line": 2008
        },
        "resolved": true,
        "details": {
          "function_name": "awi_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1955-1963",
          "snippet": "void\nawi_zero (sc, from, to)\n\tstruct awi_softc *sc;\n\tu_int32_t from, to;\n{\n\tu_int32_t i;\n\tfor (i=from; i<to; i++)\n\t\tawi_write_1(sc, i, 0);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_zero"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_zero;\n\nvoid\nawi_zero (sc, from, to)\n\tstruct awi_softc *sc;\n\tu_int32_t from, to;\n{\n\tu_int32_t i;\n\tfor (i=from; i<to; i++)\n\t\tawi_write_1(sc, i, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "am79c930_gcr_setbits",
          "args": [
            "&sc->sc_chip",
            "AM79C930_GCR_CORESET"
          ],
          "line": 2002
        },
        "resolved": true,
        "details": {
          "function_name": "am79c930_gcr_setbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "319-328",
          "snippet": "void am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_init;\nvoid awi_zero;\n\nvoid\nawi_init (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\n\tsc->sc_scan_duration = 100; /* scan for 100ms */\n\n\t/*\n\t * Maybe we should randomize these....\n\t */\n\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\n\t\n\tsc->sc_flags &= ~AWI_FL_CMD_INPROG;\n\n\tifp->if_flags &= ~(IFF_RUNNING|IFF_OACTIVE);\n\tifp->if_timer = 0;\n\t\n\tsc->sc_cmd_timer = 0;\n\tsc->sc_tx_timer = 0;\n\tsc->sc_mgt_timer = 0;\n\tsc->sc_scan_timer = 0;\n\t\n\tsc->sc_nbindings = 0;\n\n\t/*\n\t * this reset sequence doesn't seem to always do the trick.\n\t * hard-power-cycling the card may do it..\n\t */\n\t\n\t/*\n\t * reset the hardware, just to be sure.\n\t * (bring out the big hammer here..)\n\t */\n\t/* XXX insert delay here? */\n\t\n\tam79c930_gcr_setbits (&sc->sc_chip, AM79C930_GCR_CORESET);\n\tdelay(10);\t\t/* XXX arbitrary value */\n\n\t/*\n\t * clear control memory regions (firmware should do this but...)\n\t */\n\tawi_zero(sc, AWI_LAST_TXD, AWI_BUFFERS);\n\n\tawi_drvstate(sc, AWI_DRV_RESET);\n\tsc->sc_selftest_tries = 0;\n\n\t/*\n\t * release reset\n\t */\n\tam79c930_gcr_clearbits (&sc->sc_chip, AM79C930_GCR_CORESET);\n\tdelay(10);\n\t\n\tsc->sc_state = AWI_ST_SELFTEST;\n\tifp->if_timer = 1;\n\n}"
  },
  {
    "function_name": "awi_zero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1955-1963",
    "snippet": "void\nawi_zero (sc, from, to)\n\tstruct awi_softc *sc;\n\tu_int32_t from, to;\n{\n\tu_int32_t i;\n\tfor (i=from; i<to; i++)\n\t\tawi_write_1(sc, i, 0);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_zero"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "i",
            "0"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_zero;\n\nvoid\nawi_zero (sc, from, to)\n\tstruct awi_softc *sc;\n\tu_int32_t from, to;\n{\n\tu_int32_t i;\n\tfor (i=from; i<to; i++)\n\t\tawi_write_1(sc, i, 0);\n}"
  },
  {
    "function_name": "awi_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1912-1953",
    "snippet": "int awi_attach (sc, macaddr)\n\tstruct awi_softc *sc;\n\tu_int8_t *macaddr;\n{\n\tstruct ifnet *ifp = &sc->sc_ec.ac_if;\n\tu_int8_t version[AWI_BANNER_LEN];\n\n\tsc->sc_ifp = ifp;\n\tsc->sc_nextpkt = NULL;\n\tsc->sc_m = NULL;\n\tsc->sc_mptr = NULL;\n\tsc->sc_mleft = 0;\n\tsc->sc_flushpkt = 0;\n\t\n\tawi_read_bytes (sc, AWI_BANNER, version, AWI_BANNER_LEN);\n\tprintf(\"%s: firmware %s\\n\", sc->sc_dev.dv_xname, version);\n\n\tbcopy(macaddr, sc->sc_my_addr, ETHER_ADDR_LEN);\n\tprintf(\"%s: 802.11 address %s\\n\", sc->sc_dev.dv_xname,\n\t    ether_sprintf(sc->sc_my_addr));\n\t\n\tbcopy(sc->sc_dev.dv_xname, ifp->if_xname, IFNAMSIZ);\n\tifp->if_softc = sc;\n\tifp->if_start = awi_start;\n\tifp->if_ioctl = awi_ioctl;\n\tifp->if_watchdog = awi_watchdog;\n\tifp->if_mtu = ETHERMTU;\t\n\t/* XXX simplex may not be correct here.. */\n\tifp->if_flags =\n\t    IFF_BROADCAST | IFF_SIMPLEX | IFF_NOTRAILERS | IFF_MULTICAST;\n\n\tsc->sc_mgtq.ifq_maxlen = 5;\n\t\n\tif_attach(ifp);\n\tether_ifattach(ifp);\n\tifp->if_hdrlen = 32;\t/* 802.11 headers are bigger.. */\n\n#if NBPFILTER > 0\n\tbpfattach(&ifp->if_bpf, ifp, DLT_EN10MB, sizeof(struct ether_header));\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_watchdog",
      "void awi_start",
      "int awi_ioctl"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpfattach",
          "args": [
            "&ifp->if_bpf",
            "ifp",
            "DLT_EN10MB",
            "sizeof(struct ether_header)"
          ],
          "line": 1950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ether_ifattach",
          "args": [
            "ifp"
          ],
          "line": 1946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if_attach",
          "args": [
            "ifp"
          ],
          "line": 1945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bcopy",
          "args": [
            "sc->sc_dev.dv_xname",
            "ifp->if_xname",
            "IFNAMSIZ"
          ],
          "line": 1933
        },
        "resolved": true,
        "details": {
          "function_name": "tr_bcopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/tropic.c",
          "lines": "1618-1663",
          "snippet": "void \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}",
          "includes": [
            "#include <dev/ic/tropicvar.h>",
            "#include <dev/ic/tropicreg.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <net/if_token.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_media.h>",
            "#include <net/if_llc.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/syslog.h>",
            "#include <sys/socket.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void\ttr_bcopy",
            "struct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/tropicvar.h>\n#include <dev/ic/tropicreg.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <net/if_token.h>\n#include <netinet/in_var.h>\n#include <netinet/ip.h>\n#include <netinet/if_ether.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_media.h>\n#include <net/if_llc.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/syslog.h>\n#include <sys/socket.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\ttr_bcopy;\nstruct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;\n\nvoid \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: 802.11 address %s\\n\"",
            "sc->sc_dev.dv_xname",
            "ether_sprintf(sc->sc_my_addr)"
          ],
          "line": 1930
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ether_sprintf",
          "args": [
            "sc->sc_my_addr"
          ],
          "line": 1931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_bytes",
          "args": [
            "sc",
            "AWI_BANNER",
            "version",
            "AWI_BANNER_LEN"
          ],
          "line": 1926
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_watchdog;\nvoid awi_start;\nint awi_ioctl;\n\nint awi_attach (sc, macaddr)\n\tstruct awi_softc *sc;\n\tu_int8_t *macaddr;\n{\n\tstruct ifnet *ifp = &sc->sc_ec.ac_if;\n\tu_int8_t version[AWI_BANNER_LEN];\n\n\tsc->sc_ifp = ifp;\n\tsc->sc_nextpkt = NULL;\n\tsc->sc_m = NULL;\n\tsc->sc_mptr = NULL;\n\tsc->sc_mleft = 0;\n\tsc->sc_flushpkt = 0;\n\t\n\tawi_read_bytes (sc, AWI_BANNER, version, AWI_BANNER_LEN);\n\tprintf(\"%s: firmware %s\\n\", sc->sc_dev.dv_xname, version);\n\n\tbcopy(macaddr, sc->sc_my_addr, ETHER_ADDR_LEN);\n\tprintf(\"%s: 802.11 address %s\\n\", sc->sc_dev.dv_xname,\n\t    ether_sprintf(sc->sc_my_addr));\n\t\n\tbcopy(sc->sc_dev.dv_xname, ifp->if_xname, IFNAMSIZ);\n\tifp->if_softc = sc;\n\tifp->if_start = awi_start;\n\tifp->if_ioctl = awi_ioctl;\n\tifp->if_watchdog = awi_watchdog;\n\tifp->if_mtu = ETHERMTU;\t\n\t/* XXX simplex may not be correct here.. */\n\tifp->if_flags =\n\t    IFF_BROADCAST | IFF_SIMPLEX | IFF_NOTRAILERS | IFF_MULTICAST;\n\n\tsc->sc_mgtq.ifq_maxlen = 5;\n\t\n\tif_attach(ifp);\n\tether_ifattach(ifp);\n\tifp->if_hdrlen = 32;\t/* 802.11 headers are bigger.. */\n\n#if NBPFILTER > 0\n\tbpfattach(&ifp->if_bpf, ifp, DLT_EN10MB, sizeof(struct ether_header));\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "awi_drop_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1904-1910",
    "snippet": "void\nawi_drop_input (ifp, m0)\n\tstruct ifnet *ifp;\n\tstruct mbuf *m0;\n{\n\tm_freem(m0);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m0"
          ],
          "line": 1909
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_drop_input (ifp, m0)\n\tstruct ifnet *ifp;\n\tstruct mbuf *m0;\n{\n\tm_freem(m0);\n}"
  },
  {
    "function_name": "awi_drop_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1893-1902",
    "snippet": "int\nawi_drop_output (ifp, m0, dst, rt0)\n\tstruct ifnet *ifp;\n\tstruct mbuf *m0;\n\tstruct sockaddr *dst;\n\tstruct rtentry *rt0;\n{\n\tm_freem(m0);\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m0"
          ],
          "line": 1900
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint\nawi_drop_output (ifp, m0, dst, rt0)\n\tstruct ifnet *ifp;\n\tstruct mbuf *m0;\n\tstruct sockaddr *dst;\n\tstruct rtentry *rt0;\n{\n\tm_freem(m0);\n\treturn 0;\n}"
  },
  {
    "function_name": "awi_activate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1865-1891",
    "snippet": "int awi_activate (self, act)\n\tstruct device *self;\n\tenum devact act;\n{\n\tint s = splnet();\n\tpanic(\"awi_activate\");\n\t\n#if 0\n\tswitch (act) {\n\tcase DVACT_ACTIVATE:\n\t\trv = EOPNOTSUPP;\n\t\tbreak;\n\n\tcase DVACT_DEACTIVATE:\n#ifdef notyet\n\t\t/* First, kill off the interface. */\n\t\tif_detach(sc->sc_ethercom.ec_if);\n#endif\n\n\t\t/* Now disable the interface. */\n\t\tawidisable(sc);\n\t\tbreak;\n\t}\n#endif\n\tsplx(s);\n\t\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 1889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awidisable",
          "args": [
            "sc"
          ],
          "line": 1885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if_detach",
          "args": [
            "sc->sc_ethercom.ec_if"
          ],
          "line": 1881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"awi_activate\""
          ],
          "line": 1870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splnet",
          "args": [],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint awi_activate (self, act)\n\tstruct device *self;\n\tenum devact act;\n{\n\tint s = splnet();\n\tpanic(\"awi_activate\");\n\t\n#if 0\n\tswitch (act) {\n\tcase DVACT_ACTIVATE:\n\t\trv = EOPNOTSUPP;\n\t\tbreak;\n\n\tcase DVACT_DEACTIVATE:\n#ifdef notyet\n\t\t/* First, kill off the interface. */\n\t\tif_detach(sc->sc_ethercom.ec_if);\n#endif\n\n\t\t/* Now disable the interface. */\n\t\tawidisable(sc);\n\t\tbreak;\n\t}\n#endif\n\tsplx(s);\n\t\n}"
  },
  {
    "function_name": "awi_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1786-1863",
    "snippet": "int\nawi_ioctl(ifp, cmd, data)\n\tregister struct ifnet *ifp;\n\tu_long cmd;\n\tcaddr_t data;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct ifaddr *ifa = (struct ifaddr *)data;\n\tstruct ifreq *ifr = (struct ifreq *)data;\n\tint s, error = 0;\n\t\n\ts = splnet();\n\n\tswitch (cmd) {\n\tcase SIOCSIFADDR:\n\t\tif ((error = awi_enable(sc)) != 0)\n\t\t\tbreak;\n\n\t\tifp->if_flags |= IFF_UP;\n\n\t\t/* XXX other AF support: inet6, NS, ... */\n\t\tswitch (ifa->ifa_addr->sa_family) {\n#ifdef INET\n\t\tcase AF_INET:\n\t\t\tarp_ifinit(&sc->sc_ec, ifa);\n\t\t\tbreak;\n#endif\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t\t\n\tcase SIOCSIFFLAGS:\n\t\tif ((ifp->if_flags & IFF_UP) == 0 &&\n\t\t    (sc->sc_state != AWI_ST_OFF)) {\n\t\t\t/*\n\t\t\t * If interface is marked down and it is enabled, then\n\t\t\t * stop it.\n\t\t\t */\n\t\t\tifp->if_flags &= ~IFF_RUNNING;\n\t\t\tawi_stop(sc);\n\t\t\tawi_disable(sc);\n\t\t} else if ((ifp->if_flags & IFF_UP) != 0 &&\n\t\t\t   (ifp->if_flags & IFF_RUNNING) == 0) {\n\t\t\t/*\n\t\t\t * If interface is marked up and it is stopped, then\n\t\t\t * start it.\n\t\t\t */\n\t\t\tif ((error = awi_enable(sc)) != 0)\n\t\t\t\tbreak;\n\t\t} else if ((ifp->if_flags & IFF_UP) != 0) {\n\t\t\t/*\n\t\t\t * Deal with other flags that change hardware\n\t\t\t * state, i.e. IFF_PROMISC.\n\t\t\t */\n\t\t\tawi_set_mc(sc);\n\t\t}\n\t\tbreak;\n\tcase SIOCADDMULTI:\n\tcase SIOCDELMULTI:\n\t\terror = (cmd == SIOCADDMULTI) ?\n\t\t    ether_addmulti(ifr, &sc->sc_ec) :\n\t\t    ether_delmulti(ifr, &sc->sc_ec);\n\t\tif (error == ENETRESET) {\n\t\t\terror = 0;\n\t\t\tawi_set_mc(sc);\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\terror = EINVAL;\n\t\tbreak;\n\t\t\n\t}\n\tsplx(s);\n\treturn error;\n\t\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_stop",
      "void awi_set_mc",
      "int awi_enable",
      "void awi_disable",
      "int awi_ioctl"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 1860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_set_mc",
          "args": [
            "sc"
          ],
          "line": 1851
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_mc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1767-1772",
          "snippet": "void\nawi_set_mc (sc)\n\tstruct awi_softc  *sc;\n{\n\t/* XXX not implemented yet.. */\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_set_mc"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_set_mc;\n\nvoid\nawi_set_mc (sc)\n\tstruct awi_softc  *sc;\n{\n\t/* XXX not implemented yet.. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ether_delmulti",
          "args": [
            "ifr",
            "&sc->sc_ec"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ether_addmulti",
          "args": [
            "ifr",
            "&sc->sc_ec"
          ],
          "line": 1847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_enable",
          "args": [
            "sc"
          ],
          "line": 1834
        },
        "resolved": true,
        "details": {
          "function_name": "awi_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "451-465",
          "snippet": "int\nawi_enable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled == 0) {\n\t\tif ((sc->sc_enable != NULL) && ((*sc->sc_enable)(sc) != 0)) {\n\t\t\tprintf(\"%s: device enable failed\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\treturn (EIO);\n\t\t}\n\t\tawi_init(sc);\n\t}\n\tsc->sc_enabled = 1;\n\treturn 0;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_init",
            "int awi_enable"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_init;\nint awi_enable;\n\nint\nawi_enable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled == 0) {\n\t\tif ((sc->sc_enable != NULL) && ((*sc->sc_enable)(sc) != 0)) {\n\t\t\tprintf(\"%s: device enable failed\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\treturn (EIO);\n\t\t}\n\t\tawi_init(sc);\n\t}\n\tsc->sc_enabled = 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_disable",
          "args": [
            "sc"
          ],
          "line": 1827
        },
        "resolved": true,
        "details": {
          "function_name": "awi_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "467-475",
          "snippet": "void\nawi_disable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled != 0 && sc->sc_disable != NULL) {\n\t\t(*sc->sc_disable)(sc);\n\t\tsc->sc_enabled = 0;\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_disable"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_disable;\n\nvoid\nawi_disable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled != 0 && sc->sc_disable != NULL) {\n\t\t(*sc->sc_disable)(sc);\n\t\tsc->sc_enabled = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_stop",
          "args": [
            "sc"
          ],
          "line": 1826
        },
        "resolved": true,
        "details": {
          "function_name": "awi_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1609-1627",
          "snippet": "void\nawi_stop(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_flush(sc);\n\n\t/* Turn off timer.. */\n\tifp->if_timer = 0;\n\tsc->sc_state = AWI_ST_OFF;\n\t(void) awi_read_intst (sc);\n\t/*\n\t * XXX for pcmcia, there's no point in  disabling the device,\n\t * as it's about to be powered off..\n\t * for non-PCMCIA attachments, we should, however, stop\n\t * the receiver and transmitter here.\n\t */\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "u_int8_t awi_read_intst",
            "void awi_stop",
            "void awi_flush"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nu_int8_t awi_read_intst;\nvoid awi_stop;\nvoid awi_flush;\n\nvoid\nawi_stop(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_flush(sc);\n\n\t/* Turn off timer.. */\n\tifp->if_timer = 0;\n\tsc->sc_state = AWI_ST_OFF;\n\t(void) awi_read_intst (sc);\n\t/*\n\t * XXX for pcmcia, there's no point in  disabling the device,\n\t * as it's about to be powered off..\n\t * for non-PCMCIA attachments, we should, however, stop\n\t * the receiver and transmitter here.\n\t */\n}"
        }
      },
      {
        "call_info": {
          "callee": "arp_ifinit",
          "args": [
            "&sc->sc_ec",
            "ifa"
          ],
          "line": 1810
        },
        "resolved": true,
        "details": {
          "function_name": "arp_ifinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_devar.h",
          "lines": "929-936",
          "snippet": "static void\narp_ifinit(\n    struct arpcom *ac,\n    struct ifaddr *ifa)\n{\n    ac->ac_ipaddr = IA_SIN(ifa)->sin_addr;\n    arpwhohas(ac, &ac->ac_ipaddr);\n}",
          "includes": [
            "#include <sys/devconf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/devconf.h>\n\nstatic void\narp_ifinit(\n    struct arpcom *ac,\n    struct ifaddr *ifa)\n{\n    ac->ac_ipaddr = IA_SIN(ifa)->sin_addr;\n    arpwhohas(ac, &ac->ac_ipaddr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splnet",
          "args": [],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_stop;\nvoid awi_set_mc;\nint awi_enable;\nvoid awi_disable;\nint awi_ioctl;\n\nint\nawi_ioctl(ifp, cmd, data)\n\tregister struct ifnet *ifp;\n\tu_long cmd;\n\tcaddr_t data;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct ifaddr *ifa = (struct ifaddr *)data;\n\tstruct ifreq *ifr = (struct ifreq *)data;\n\tint s, error = 0;\n\t\n\ts = splnet();\n\n\tswitch (cmd) {\n\tcase SIOCSIFADDR:\n\t\tif ((error = awi_enable(sc)) != 0)\n\t\t\tbreak;\n\n\t\tifp->if_flags |= IFF_UP;\n\n\t\t/* XXX other AF support: inet6, NS, ... */\n\t\tswitch (ifa->ifa_addr->sa_family) {\n#ifdef INET\n\t\tcase AF_INET:\n\t\t\tarp_ifinit(&sc->sc_ec, ifa);\n\t\t\tbreak;\n#endif\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t\t\n\tcase SIOCSIFFLAGS:\n\t\tif ((ifp->if_flags & IFF_UP) == 0 &&\n\t\t    (sc->sc_state != AWI_ST_OFF)) {\n\t\t\t/*\n\t\t\t * If interface is marked down and it is enabled, then\n\t\t\t * stop it.\n\t\t\t */\n\t\t\tifp->if_flags &= ~IFF_RUNNING;\n\t\t\tawi_stop(sc);\n\t\t\tawi_disable(sc);\n\t\t} else if ((ifp->if_flags & IFF_UP) != 0 &&\n\t\t\t   (ifp->if_flags & IFF_RUNNING) == 0) {\n\t\t\t/*\n\t\t\t * If interface is marked up and it is stopped, then\n\t\t\t * start it.\n\t\t\t */\n\t\t\tif ((error = awi_enable(sc)) != 0)\n\t\t\t\tbreak;\n\t\t} else if ((ifp->if_flags & IFF_UP) != 0) {\n\t\t\t/*\n\t\t\t * Deal with other flags that change hardware\n\t\t\t * state, i.e. IFF_PROMISC.\n\t\t\t */\n\t\t\tawi_set_mc(sc);\n\t\t}\n\t\tbreak;\n\tcase SIOCADDMULTI:\n\tcase SIOCDELMULTI:\n\t\terror = (cmd == SIOCADDMULTI) ?\n\t\t    ether_addmulti(ifr, &sc->sc_ec) :\n\t\t    ether_delmulti(ifr, &sc->sc_ec);\n\t\tif (error == ENETRESET) {\n\t\t\terror = 0;\n\t\t\tawi_set_mc(sc);\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\terror = EINVAL;\n\t\tbreak;\n\t\t\n\t}\n\tsplx(s);\n\treturn error;\n\t\n}"
  },
  {
    "function_name": "awi_set_mc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1767-1772",
    "snippet": "void\nawi_set_mc (sc)\n\tstruct awi_softc  *sc;\n{\n\t/* XXX not implemented yet.. */\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_set_mc"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_set_mc;\n\nvoid\nawi_set_mc (sc)\n\tstruct awi_softc  *sc;\n{\n\t/* XXX not implemented yet.. */\n}"
  },
  {
    "function_name": "awi_watchdog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1634-1765",
    "snippet": "void\nawi_watchdog(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tu_int8_t test;\n\tint i;\n\n\tif (sc->sc_state == AWI_ST_OFF) \n\t\t/* nothing to do */\n\t\treturn;\n\telse if (sc->sc_state == AWI_ST_INSANE) {\n\t\tawi_reset(sc);\n\t\treturn;\n\t} else if (sc->sc_state == AWI_ST_SELFTEST) {\n\t\t/* check for selftest completion.. */\n\t\ttest = awi_read_1(sc, AWI_SELFTEST);\n\t\tif ((test & 0xf0)  == 0xf0) { /* XXX magic numbers */\n\t\t\tif (test == AWI_SELFTEST_PASSED) {\n\t\t\t\tawi_init_1(sc);\n\t\t\t} else {\n\t\t\t\tprintf(\"%s: selftest failed (code %x)\\n\",\n\t\t\t\t    sc->sc_dev.dv_xname, test);\n\t\t\t\tawi_reset(sc);\n\t\t\t}\n\t\t}\n\t\tsc->sc_selftest_tries++;\n\t\t/* still running.  try again on next tick */\n\t\tif (sc->sc_selftest_tries < 5) {\n\t\t\tifp->if_timer = 1;\n\t\t} else {\n\t\t\t/*\n\t\t\t * XXX should power down card, wait 1s, power it back\n\t\t\t * up again..\n\t\t\t */\n\t\t\tprintf(\"%s: device failed to complete selftest (code %x)\\n\",\n\t\t\t    sc->sc_dev.dv_xname, test);\n\t\t\tifp->if_timer = 0;\n\t\t}\n\t\treturn;\n\t}\n\t\n\n\t/*\n\t * command timer: if it goes to zero, device failed to respond.\n\t * boot to the head.\n\t */\n\tif (sc->sc_cmd_timer) {\n\t\tsc->sc_cmd_timer--;\n\t\tif (sc->sc_cmd_timer == 0) {\n\t\t\tsc->sc_flags &= ~AWI_FL_CMD_INPROG;\n\t\t\n\t\t\tprintf(\"%s: timeout waiting for command completion\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\ttest = awi_read_1(sc, AWI_CMD_STATUS);\n\t\t\tprintf(\"%s: cmd status: %x\\n\", sc->sc_dev.dv_xname, test);\n\t\t\ttest = awi_read_1(sc, AWI_CMD);\t\t\n\t\t\tprintf(\"%s: cmd: %x\\n\", sc->sc_dev.dv_xname, test);\n\t\t\tawi_card_hexdump(sc, \"CSB\", AWI_CSB, 16);\n\t\t\tawi_reset(sc);\n\t\t\treturn;\n\t\t}\n\t}\n\t/*\n\t * Transmit timer.  If it goes to zero, device failed to deliver a\n\t * tx complete interrupt.  boot to the head.\n\t */\n\tif (sc->sc_tx_timer) {\n\t\tsc->sc_tx_timer--;\n\t\tif ((sc->sc_tx_timer == 0)  && (sc->sc_txpending)) {\n\t\t\tawi_card_hexdump(sc, \"CSB\", AWI_CSB, 16);\n\t\t\tprintf(\"%s: transmit timeout\\n\", sc->sc_dev.dv_xname);\n\t\t\tawi_card_hexdump(sc, \"last_txd\", AWI_LAST_TXD, 5*4);\n\t\t\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\t\t\tawi_card_hexdump(sc, \"txd\",\n\t\t\t\t    sc->sc_txd[i].descr, AWI_TXD_SIZE);\n\t\t\t}\n\t\t\tawi_reset(sc);\n\t\t\treturn;\n\t\t}\n\t}\n\t/*\n\t * Scan timer.\n\t * When synched, this is used to notice when we've stopped\n\t * receiving beacons and should attempt to resynch.\n\t *\n\t * When unsynched, this is used to notice if we've received an\n\t * interesting probe response and should synch up.\n\t */\n\n\tif (sc->sc_scan_timer) {\n\t\tsc->sc_scan_timer--;\n\t\tif (sc->sc_scan_timer == 0) {\n\t\t\tif (sc->sc_state == AWI_ST_SCAN) {\n\t\t\t\t/*\n\t\t\t\t * XXX what if device fails to deliver\n\t\t\t\t * a scan-completion interrupt?\n\t\t\t\t */\n\t\t\t} else {\n\t\t\t\tprintf(\"%s: no recent beacon from %s; rescanning\\n\",\n\t\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t\t    ether_sprintf(sc->sc_active_bss.bss_id));\n\t\t\t\tawi_restart_scan(sc);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/*\n\t * Management timer.  Used to know when to send auth\n\t * requests and associate requests.\n\t */\n\tif (sc->sc_mgt_timer) {\n\t\tsc->sc_mgt_timer--;\n\t\tif (sc->sc_mgt_timer == 0) {\n\t\t\tswitch (sc->sc_state) \n\t\t\t{\n\t\t\tcase AWI_ST_SYNCED:\n\t\t\tcase AWI_ST_RUNNING:\n\t\t\t\tsc->sc_state = AWI_ST_SYNCED;\n\t\t\t\tawi_send_authreq(sc);\n\t\t\t\tbreak;\n\t\t\tcase AWI_ST_AUTHED:\n\t\t\t\tawi_send_assocreq(sc);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tprintf(\"weird state for mgt timeout!\\n\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tawi_set_timer(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_reset",
      "void awi_init_1",
      "void awi_watchdog",
      "void awi_send_authreq",
      "void awi_send_assocreq"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_set_timer",
          "args": [
            "sc"
          ],
          "line": 1764
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "267-274",
          "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"weird state for mgt timeout!\\n\""
          ],
          "line": 1759
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_send_assocreq",
          "args": [
            "sc"
          ],
          "line": 1756
        },
        "resolved": true,
        "details": {
          "function_name": "awi_send_assocreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "741-791",
          "snippet": "void\nawi_send_assocreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_assoc_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\t/* \n\t * cap info (2 bytes)\n\t * listen interval\t(2 bytes)\n\t * ssid\t\t\t(variable)\n\t * supported rates\t(variable)\n\t */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    IEEEWL_FC_TYPE_MGT, IEEEWL_SUBTYPE_ASSOCREQ);\n\n\tamahp->awi_cap_info[0] = 4; /* XXX magic (CF-pollable) */\n\tamahp->awi_cap_info[1] = 0;\n\tamahp->awi_li[0] = 1;\n\tamahp->awi_li[1] = 0;\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending assoc request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_send_frame",
            "void awi_send_assocreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_send_frame;\nvoid awi_send_assocreq;\n\nvoid\nawi_send_assocreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_assoc_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\t/* \n\t * cap info (2 bytes)\n\t * listen interval\t(2 bytes)\n\t * ssid\t\t\t(variable)\n\t * supported rates\t(variable)\n\t */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    IEEEWL_FC_TYPE_MGT, IEEEWL_SUBTYPE_ASSOCREQ);\n\n\tamahp->awi_cap_info[0] = 4; /* XXX magic (CF-pollable) */\n\tamahp->awi_cap_info[1] = 0;\n\tamahp->awi_li[0] = 1;\n\tamahp->awi_li[1] = 0;\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending assoc request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_send_authreq",
          "args": [
            "sc"
          ],
          "line": 1753
        },
        "resolved": true,
        "details": {
          "function_name": "awi_send_authreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "681-739",
          "snippet": "void\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_send_frame",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_send_frame;\nvoid awi_send_authreq;\n\nvoid\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_restart_scan",
          "args": [
            "sc"
          ],
          "line": 1736
        },
        "resolved": true,
        "details": {
          "function_name": "awi_restart_scan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2384-2398",
          "snippet": "void awi_restart_scan (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: starting scan\\n\", sc->sc_dev.dv_xname);\n\t}\n\tsc->sc_scan_timer = 2;\n\tsc->sc_mgt_timer = 0;\n\tawi_set_timer(sc);\n\n\tsc->sc_nbindings = 0;\n\tsc->sc_state = AWI_ST_SCAN;\n\tawi_drvstate (sc, AWI_DRV_INFSC);\n\tawi_cmd_scan (sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_scan"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan;\n\nvoid awi_restart_scan (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: starting scan\\n\", sc->sc_dev.dv_xname);\n\t}\n\tsc->sc_scan_timer = 2;\n\tsc->sc_mgt_timer = 0;\n\tawi_set_timer(sc);\n\n\tsc->sc_nbindings = 0;\n\tsc->sc_state = AWI_ST_SCAN;\n\tawi_drvstate (sc, AWI_DRV_INFSC);\n\tawi_cmd_scan (sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ether_sprintf",
          "args": [
            "sc->sc_active_bss.bss_id"
          ],
          "line": 1735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_reset",
          "args": [
            "sc"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "awi_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2617-2622",
          "snippet": "void awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\n\nvoid awi_reset (sc)\n\tstruct awi_softc *sc;\n{\n\tprintf(\"%s: reset\\n\", sc->sc_dev.dv_xname);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_card_hexdump",
          "args": [
            "sc",
            "\"txd\"",
            "sc->sc_txd[i].descr",
            "AWI_TXD_SIZE"
          ],
          "line": 1708
        },
        "resolved": true,
        "details": {
          "function_name": "awi_card_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "552-565",
          "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_CMD"
          ],
          "line": 1690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_CMD_STATUS"
          ],
          "line": 1688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_init_1",
          "args": [
            "sc"
          ],
          "line": 1653
        },
        "resolved": true,
        "details": {
          "function_name": "awi_init_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2088-2106",
          "snippet": "void awi_init_1 (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_intrinit(sc);\n\n\tsc->sc_state = AWI_ST_IFTEST;\n\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tawi_card_hexdump(sc, \"init_1 CSB\", AWI_CSB, 16);\n\t\tsc->sc_completion = awi_mibdump;\n\t} else\n\t\tsc->sc_completion = awi_init_2;\n\n\tsc->sc_curmib = 0;\n\n\tawi_cmd_test_if (sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_intrinit",
            "void awi_cmd_test_if",
            "void awi_init_1",
            "void awi_init_2",
            "void awi_mibdump"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_intrinit;\nvoid awi_cmd_test_if;\nvoid awi_init_1;\nvoid awi_init_2;\nvoid awi_mibdump;\n\nvoid awi_init_1 (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_intrinit(sc);\n\n\tsc->sc_state = AWI_ST_IFTEST;\n\n\tif (ifp->if_flags & IFF_DEBUG) {\n\t\tawi_card_hexdump(sc, \"init_1 CSB\", AWI_CSB, 16);\n\t\tsc->sc_completion = awi_mibdump;\n\t} else\n\t\tsc->sc_completion = awi_init_2;\n\n\tsc->sc_curmib = 0;\n\n\tawi_cmd_test_if (sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_SELFTEST"
          ],
          "line": 1650
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\nvoid awi_init_1;\nvoid awi_watchdog;\nvoid awi_send_authreq;\nvoid awi_send_assocreq;\n\nvoid\nawi_watchdog(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tu_int8_t test;\n\tint i;\n\n\tif (sc->sc_state == AWI_ST_OFF) \n\t\t/* nothing to do */\n\t\treturn;\n\telse if (sc->sc_state == AWI_ST_INSANE) {\n\t\tawi_reset(sc);\n\t\treturn;\n\t} else if (sc->sc_state == AWI_ST_SELFTEST) {\n\t\t/* check for selftest completion.. */\n\t\ttest = awi_read_1(sc, AWI_SELFTEST);\n\t\tif ((test & 0xf0)  == 0xf0) { /* XXX magic numbers */\n\t\t\tif (test == AWI_SELFTEST_PASSED) {\n\t\t\t\tawi_init_1(sc);\n\t\t\t} else {\n\t\t\t\tprintf(\"%s: selftest failed (code %x)\\n\",\n\t\t\t\t    sc->sc_dev.dv_xname, test);\n\t\t\t\tawi_reset(sc);\n\t\t\t}\n\t\t}\n\t\tsc->sc_selftest_tries++;\n\t\t/* still running.  try again on next tick */\n\t\tif (sc->sc_selftest_tries < 5) {\n\t\t\tifp->if_timer = 1;\n\t\t} else {\n\t\t\t/*\n\t\t\t * XXX should power down card, wait 1s, power it back\n\t\t\t * up again..\n\t\t\t */\n\t\t\tprintf(\"%s: device failed to complete selftest (code %x)\\n\",\n\t\t\t    sc->sc_dev.dv_xname, test);\n\t\t\tifp->if_timer = 0;\n\t\t}\n\t\treturn;\n\t}\n\t\n\n\t/*\n\t * command timer: if it goes to zero, device failed to respond.\n\t * boot to the head.\n\t */\n\tif (sc->sc_cmd_timer) {\n\t\tsc->sc_cmd_timer--;\n\t\tif (sc->sc_cmd_timer == 0) {\n\t\t\tsc->sc_flags &= ~AWI_FL_CMD_INPROG;\n\t\t\n\t\t\tprintf(\"%s: timeout waiting for command completion\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\ttest = awi_read_1(sc, AWI_CMD_STATUS);\n\t\t\tprintf(\"%s: cmd status: %x\\n\", sc->sc_dev.dv_xname, test);\n\t\t\ttest = awi_read_1(sc, AWI_CMD);\t\t\n\t\t\tprintf(\"%s: cmd: %x\\n\", sc->sc_dev.dv_xname, test);\n\t\t\tawi_card_hexdump(sc, \"CSB\", AWI_CSB, 16);\n\t\t\tawi_reset(sc);\n\t\t\treturn;\n\t\t}\n\t}\n\t/*\n\t * Transmit timer.  If it goes to zero, device failed to deliver a\n\t * tx complete interrupt.  boot to the head.\n\t */\n\tif (sc->sc_tx_timer) {\n\t\tsc->sc_tx_timer--;\n\t\tif ((sc->sc_tx_timer == 0)  && (sc->sc_txpending)) {\n\t\t\tawi_card_hexdump(sc, \"CSB\", AWI_CSB, 16);\n\t\t\tprintf(\"%s: transmit timeout\\n\", sc->sc_dev.dv_xname);\n\t\t\tawi_card_hexdump(sc, \"last_txd\", AWI_LAST_TXD, 5*4);\n\t\t\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\t\t\tawi_card_hexdump(sc, \"txd\",\n\t\t\t\t    sc->sc_txd[i].descr, AWI_TXD_SIZE);\n\t\t\t}\n\t\t\tawi_reset(sc);\n\t\t\treturn;\n\t\t}\n\t}\n\t/*\n\t * Scan timer.\n\t * When synched, this is used to notice when we've stopped\n\t * receiving beacons and should attempt to resynch.\n\t *\n\t * When unsynched, this is used to notice if we've received an\n\t * interesting probe response and should synch up.\n\t */\n\n\tif (sc->sc_scan_timer) {\n\t\tsc->sc_scan_timer--;\n\t\tif (sc->sc_scan_timer == 0) {\n\t\t\tif (sc->sc_state == AWI_ST_SCAN) {\n\t\t\t\t/*\n\t\t\t\t * XXX what if device fails to deliver\n\t\t\t\t * a scan-completion interrupt?\n\t\t\t\t */\n\t\t\t} else {\n\t\t\t\tprintf(\"%s: no recent beacon from %s; rescanning\\n\",\n\t\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t\t    ether_sprintf(sc->sc_active_bss.bss_id));\n\t\t\t\tawi_restart_scan(sc);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/*\n\t * Management timer.  Used to know when to send auth\n\t * requests and associate requests.\n\t */\n\tif (sc->sc_mgt_timer) {\n\t\tsc->sc_mgt_timer--;\n\t\tif (sc->sc_mgt_timer == 0) {\n\t\t\tswitch (sc->sc_state) \n\t\t\t{\n\t\t\tcase AWI_ST_SYNCED:\n\t\t\tcase AWI_ST_RUNNING:\n\t\t\t\tsc->sc_state = AWI_ST_SYNCED;\n\t\t\t\tawi_send_authreq(sc);\n\t\t\t\tbreak;\n\t\t\tcase AWI_ST_AUTHED:\n\t\t\t\tawi_send_assocreq(sc);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tprintf(\"weird state for mgt timeout!\\n\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tawi_set_timer(sc);\n}"
  },
  {
    "function_name": "awi_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1609-1627",
    "snippet": "void\nawi_stop(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_flush(sc);\n\n\t/* Turn off timer.. */\n\tifp->if_timer = 0;\n\tsc->sc_state = AWI_ST_OFF;\n\t(void) awi_read_intst (sc);\n\t/*\n\t * XXX for pcmcia, there's no point in  disabling the device,\n\t * as it's about to be powered off..\n\t * for non-PCMCIA attachments, we should, however, stop\n\t * the receiver and transmitter here.\n\t */\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "u_int8_t awi_read_intst",
      "void awi_stop",
      "void awi_flush"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_read_intst",
          "args": [
            "sc"
          ],
          "line": 1620
        },
        "resolved": true,
        "details": {
          "function_name": "awi_read_intst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "567-584",
          "snippet": "u_int8_t\nawi_read_intst(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t state;\n\t\n\tif (!awi_intlock(sc))\n\t\treturn 0;\n\n\t/* we have int lock.. */\n\n\tstate = awi_read_1 (sc, AWI_INTSTAT);\n\tawi_write_1(sc, AWI_INTSTAT, 0);\n\t\n\tawi_intunlock(sc);\n\n\treturn state;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int awi_intlock",
            "void awi_intunlock",
            "u_int8_t awi_read_intst"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint awi_intlock;\nvoid awi_intunlock;\nu_int8_t awi_read_intst;\n\nu_int8_t\nawi_read_intst(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t state;\n\t\n\tif (!awi_intlock(sc))\n\t\treturn 0;\n\n\t/* we have int lock.. */\n\n\tstate = awi_read_1 (sc, AWI_INTSTAT);\n\tawi_write_1(sc, AWI_INTSTAT, 0);\n\t\n\tawi_intunlock(sc);\n\n\treturn state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_flush",
          "args": [
            "sc"
          ],
          "line": 1615
        },
        "resolved": true,
        "details": {
          "function_name": "awi_flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1585-1601",
          "snippet": "void\nawi_flush(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tstruct mbuf *m;\n\n\tdo {\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n\t\n\tdo {\n\t\tIF_DEQUEUE (&ifp->if_snd, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_flush"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_flush;\n\nvoid\nawi_flush(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tstruct mbuf *m;\n\n\tdo {\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n\t\n\tdo {\n\t\tIF_DEQUEUE (&ifp->if_snd, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nu_int8_t awi_read_intst;\nvoid awi_stop;\nvoid awi_flush;\n\nvoid\nawi_stop(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n\tawi_flush(sc);\n\n\t/* Turn off timer.. */\n\tifp->if_timer = 0;\n\tsc->sc_state = AWI_ST_OFF;\n\t(void) awi_read_intst (sc);\n\t/*\n\t * XXX for pcmcia, there's no point in  disabling the device,\n\t * as it's about to be powered off..\n\t * for non-PCMCIA attachments, we should, however, stop\n\t * the receiver and transmitter here.\n\t */\n}"
  },
  {
    "function_name": "awi_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1585-1601",
    "snippet": "void\nawi_flush(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tstruct mbuf *m;\n\n\tdo {\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n\t\n\tdo {\n\t\tIF_DEQUEUE (&ifp->if_snd, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_flush"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m"
          ],
          "line": 1599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&ifp->if_snd",
            "m"
          ],
          "line": 1598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m"
          ],
          "line": 1594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&sc->sc_mgtq",
            "m"
          ],
          "line": 1593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_flush;\n\nvoid\nawi_flush(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tstruct mbuf *m;\n\n\tdo {\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n\t\n\tdo {\n\t\tIF_DEQUEUE (&ifp->if_snd, m);\n\t\tm_freem(m);\n\t} while (m != NULL);\n}"
  },
  {
    "function_name": "awi_intr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1514-1579",
    "snippet": "int\nawi_intr(arg)\n\tvoid *arg;\n{\n\tstruct awi_softc *sc = arg;\n\tint handled = 0;\n\n\tif (sc->sc_state == AWI_ST_OFF) {\n\t\tu_int8_t intstate = awi_read_intst (sc);\n\t\treturn intstate != 0;\n\t}\n\n\t/* disable power down, (and implicitly ack interrupt) */\n\tam79c930_gcr_setbits(&sc->sc_chip, AM79C930_GCR_DISPWDN);\n\tawi_write_1(sc, AWI_DIS_PWRDN, 1);\n\t\n\tfor (;;) {\n\t\tu_int8_t intstate = awi_read_intst (sc);\n\n\t\tif (!intstate)\n\t\t\tbreak;\n\n\t\thandled = 1;\n\t\t\n\t\tif (intstate & AWI_INT_RX)\n\t\t\tawi_rxint(sc);\n\n\t\tif (intstate & AWI_INT_TX) \n\t\t\tawi_txint(sc);\n\n\t\tif (intstate & AWI_INT_CMD) {\n\t\t\tu_int8_t status;\n\t\t\t\n\t\t\tif (!(sc->sc_flags & AWI_FL_CMD_INPROG))\n\t\t\t\tprintf(\"%s: no command in progress?\\n\",\n\t\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tstatus = awi_read_1(sc, AWI_CMD_STATUS);\n\t\t\tawi_write_1 (sc, AWI_CMD, 0);\n\t\t\tsc->sc_cmd_timer = 0;\n\t\t\tsc->sc_flags &= ~AWI_FL_CMD_INPROG;\n\t\t\t\n\t\t\tif (sc->sc_completion)\n\t\t\t\t(*sc->sc_completion)(sc, status);\n\t\t}\n\t\tif (intstate & AWI_INT_SCAN_CMPLT) {\n\t\t\tif (sc->sc_flags & AWI_FL_CMD_INPROG) {\n\t\t\t\tpanic(\"i can't take it any more\");\n\t\t\t}\n\t\t\t/*\n\t\t\t * scan completion heuristic..\n\t\t\t */\n\t\t\tif ((sc->sc_nbindings >= NBND)\n\t\t\t    || ((sc->sc_scan_timer == 0) &&\n\t\t\t\t(sc->sc_nbindings > 0)))\n\t\t\t\tawi_try_sync(sc);\n\t\t\telse\n\t\t\t\tawi_scan_next(sc);\n\t\t}\n\t\t\n\t}\n\t/* reenable power down */\n\tam79c930_gcr_clearbits(&sc->sc_chip, AM79C930_GCR_DISPWDN);\n\tawi_write_1(sc, AWI_DIS_PWRDN, 0);\n\n\treturn handled;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "u_int8_t awi_read_intst",
      "void awi_rxint",
      "void awi_txint",
      "void awi_scan_next",
      "void awi_try_sync"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_DIS_PWRDN",
            "0"
          ],
          "line": 1576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "am79c930_gcr_clearbits",
          "args": [
            "&sc->sc_chip",
            "AM79C930_GCR_DISPWDN"
          ],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "am79c930_gcr_clearbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "334-343",
          "snippet": "void am79c930_gcr_clearbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr &= ~bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_gcr_clearbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr &= ~bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_scan_next",
          "args": [
            "sc"
          ],
          "line": 1570
        },
        "resolved": true,
        "details": {
          "function_name": "awi_scan_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2446-2464",
          "snippet": "void\nawi_scan_next (sc)\n\tstruct awi_softc *sc;\n{\n\tsc->sc_scan_pattern++;\n\tif (sc->sc_scan_pattern > IEEEWL_FH_PATTERN_MAX) {\n\t\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\t\t\n\n\t\tsc->sc_scan_chanset++;\n\t\tif (sc->sc_scan_chanset > IEEEWL_FH_CHANSET_MAX)\n\t\t\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\t}\n#if 0\n\tprintf(\"scan: pattern %x chanset %x\\n\", sc->sc_scan_pattern,\n\t    sc->sc_scan_chanset);\n#endif\n\t\n\tawi_cmd_scan(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_cmd_scan",
            "void awi_scan_next"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_cmd_scan;\nvoid awi_scan_next;\n\nvoid\nawi_scan_next (sc)\n\tstruct awi_softc *sc;\n{\n\tsc->sc_scan_pattern++;\n\tif (sc->sc_scan_pattern > IEEEWL_FH_PATTERN_MAX) {\n\t\tsc->sc_scan_pattern = IEEEWL_FH_PATTERN_MIN;\t\t\n\n\t\tsc->sc_scan_chanset++;\n\t\tif (sc->sc_scan_chanset > IEEEWL_FH_CHANSET_MAX)\n\t\t\tsc->sc_scan_chanset = IEEEWL_FH_CHANSET_MIN;\n\t}\n#if 0\n\tprintf(\"scan: pattern %x chanset %x\\n\", sc->sc_scan_pattern,\n\t    sc->sc_scan_chanset);\n#endif\n\t\n\tawi_cmd_scan(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_try_sync",
          "args": [
            "sc"
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "awi_try_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2466-2521",
          "snippet": "void\nawi_try_sync (sc) \n\tstruct awi_softc *sc;\n{\n\tint max_rssi = 0, best = 0;\n\tint i;\n\tstruct awi_bss_binding *bp = NULL;\n\t\n\tawi_flush(sc);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: looking for best of %d\\n\",\n\t\t    sc->sc_dev.dv_xname, sc->sc_nbindings);\n\t}\n\t/* pick one with best rssi */\n\tfor (i=0; i<sc->sc_nbindings; i++) {\n\t\tbp = &sc->sc_bindings[i];\n\n\t\tif (bp->rssi > max_rssi) {\n\t\t\tmax_rssi = bp->rssi;\n\t\t\tbest = i;\n\t\t}\n\t}\n\n\tif (bp == NULL) {\n\t\tprintf(\"%s: no beacons seen\\n\", sc->sc_dev.dv_xname);\n\t\tawi_scan_next(sc);\n\t\treturn;\n\t}\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: best %d\\n\", sc->sc_dev.dv_xname, best);\n\t}\n\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\n\tbp = &sc->sc_bindings[best];\n\tbcopy(bp, &sc->sc_active_bss, sizeof(*bp));\n\tsc->sc_new_bss = 1;\n\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_SET, bp->chanset);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_PATTERN, bp->pattern);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_IDX, bp->index);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_STARTBSS, 0);\n\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_DWELL, bp->dwell_time);\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_MBZ, 0);\n\n\tawi_write_bytes (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_TIMESTAMP,\n\t    bp->bss_timestamp, 8);\n\tawi_write_4 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_REFTIME, bp->rxtime);\n\n\tsc->sc_completion = awi_cmd_sync_done;\n\t\n\tawi_cmd (sc, AWI_CMD_SYNC);\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_flush",
            "void awi_cmd",
            "void awi_scan_next",
            "void awi_try_sync",
            "void awi_cmd_sync_done"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_flush;\nvoid awi_cmd;\nvoid awi_scan_next;\nvoid awi_try_sync;\nvoid awi_cmd_sync_done;\n\nvoid\nawi_try_sync (sc) \n\tstruct awi_softc *sc;\n{\n\tint max_rssi = 0, best = 0;\n\tint i;\n\tstruct awi_bss_binding *bp = NULL;\n\t\n\tawi_flush(sc);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: looking for best of %d\\n\",\n\t\t    sc->sc_dev.dv_xname, sc->sc_nbindings);\n\t}\n\t/* pick one with best rssi */\n\tfor (i=0; i<sc->sc_nbindings; i++) {\n\t\tbp = &sc->sc_bindings[i];\n\n\t\tif (bp->rssi > max_rssi) {\n\t\t\tmax_rssi = bp->rssi;\n\t\t\tbest = i;\n\t\t}\n\t}\n\n\tif (bp == NULL) {\n\t\tprintf(\"%s: no beacons seen\\n\", sc->sc_dev.dv_xname);\n\t\tawi_scan_next(sc);\n\t\treturn;\n\t}\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: best %d\\n\", sc->sc_dev.dv_xname, best);\n\t}\n\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\n\tbp = &sc->sc_bindings[best];\n\tbcopy(bp, &sc->sc_active_bss, sizeof(*bp));\n\tsc->sc_new_bss = 1;\n\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_SET, bp->chanset);\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_PATTERN, bp->pattern);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_IDX, bp->index);\t\n\tawi_write_1 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_STARTBSS, 0);\n\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_DWELL, bp->dwell_time);\n\tawi_write_2 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_MBZ, 0);\n\n\tawi_write_bytes (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_TIMESTAMP,\n\t    bp->bss_timestamp, 8);\n\tawi_write_4 (sc, AWI_CMD_PARAMS+AWI_CA_SYNC_REFTIME, bp->rxtime);\n\n\tsc->sc_completion = awi_cmd_sync_done;\n\t\n\tawi_cmd (sc, AWI_CMD_SYNC);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"i can't take it any more\""
          ],
          "line": 1560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc",
            "status"
          ],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_CMD",
            "0"
          ],
          "line": 1551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_CMD_STATUS"
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: no command in progress?\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 1548
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_txint",
          "args": [
            "sc"
          ],
          "line": 1542
        },
        "resolved": true,
        "details": {
          "function_name": "awi_txint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1460-1495",
          "snippet": "void\nawi_txint (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tint txfirst;\n\t\n\tsc->sc_tx_timer = 0;\n\n\ttxfirst = sc->sc_txfirst;\n\twhile (sc->sc_txpending > 0) {\n\t\tu_int8_t flags = awi_read_1 (sc, sc->sc_txd[txfirst].descr +\n\t\t    AWI_TXD_STATE);\n\n\t\tif (flags & AWI_TXD_ST_OWN)\n\t\t\tbreak;\n\n\t\tif (flags & AWI_TXD_ST_ERROR) {\n\t\t\t/* increment oerrs */;\n\t\t}\n\n\t\ttxfirst = (txfirst + 1) % sc->sc_ntxd;\n\t\tsc->sc_txpending--;\n\t}\n\n\tsc->sc_txfirst = txfirst;\n\n\tif (sc->sc_txpending < sc->sc_ntxd)\n\t\tifp->if_flags &= ~IFF_OACTIVE;\n\t\n\t/*\n\t * see which descriptors are done..\n\t */\n\n\tawi_start(sc->sc_ifp);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_txint",
            "void awi_start"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_txint;\nvoid awi_start;\n\nvoid\nawi_txint (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tint txfirst;\n\t\n\tsc->sc_tx_timer = 0;\n\n\ttxfirst = sc->sc_txfirst;\n\twhile (sc->sc_txpending > 0) {\n\t\tu_int8_t flags = awi_read_1 (sc, sc->sc_txd[txfirst].descr +\n\t\t    AWI_TXD_STATE);\n\n\t\tif (flags & AWI_TXD_ST_OWN)\n\t\t\tbreak;\n\n\t\tif (flags & AWI_TXD_ST_ERROR) {\n\t\t\t/* increment oerrs */;\n\t\t}\n\n\t\ttxfirst = (txfirst + 1) % sc->sc_ntxd;\n\t\tsc->sc_txpending--;\n\t}\n\n\tsc->sc_txfirst = txfirst;\n\n\tif (sc->sc_txpending < sc->sc_ntxd)\n\t\tifp->if_flags &= ~IFF_OACTIVE;\n\t\n\t/*\n\t * see which descriptors are done..\n\t */\n\n\tawi_start(sc->sc_ifp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_rxint",
          "args": [
            "sc"
          ],
          "line": 1539
        },
        "resolved": true,
        "details": {
          "function_name": "awi_rxint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1393-1399",
          "snippet": "void\nawi_rxint (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_dump_rxchain (sc, \"mgt\", &sc->sc_rx_mgt_desc);\n\tawi_dump_rxchain (sc, \"data\", &sc->sc_rx_data_desc);\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_rxint",
            "void awi_dump_rxchain"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rxint;\nvoid awi_dump_rxchain;\n\nvoid\nawi_rxint (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_dump_rxchain (sc, \"mgt\", &sc->sc_rx_mgt_desc);\n\tawi_dump_rxchain (sc, \"data\", &sc->sc_rx_data_desc);\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_intst",
          "args": [
            "sc"
          ],
          "line": 1531
        },
        "resolved": true,
        "details": {
          "function_name": "awi_read_intst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "567-584",
          "snippet": "u_int8_t\nawi_read_intst(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t state;\n\t\n\tif (!awi_intlock(sc))\n\t\treturn 0;\n\n\t/* we have int lock.. */\n\n\tstate = awi_read_1 (sc, AWI_INTSTAT);\n\tawi_write_1(sc, AWI_INTSTAT, 0);\n\t\n\tawi_intunlock(sc);\n\n\treturn state;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int awi_intlock",
            "void awi_intunlock",
            "u_int8_t awi_read_intst"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint awi_intlock;\nvoid awi_intunlock;\nu_int8_t awi_read_intst;\n\nu_int8_t\nawi_read_intst(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t state;\n\t\n\tif (!awi_intlock(sc))\n\t\treturn 0;\n\n\t/* we have int lock.. */\n\n\tstate = awi_read_1 (sc, AWI_INTSTAT);\n\tawi_write_1(sc, AWI_INTSTAT, 0);\n\t\n\tawi_intunlock(sc);\n\n\treturn state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_DIS_PWRDN",
            "1"
          ],
          "line": 1528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "am79c930_gcr_setbits",
          "args": [
            "&sc->sc_chip",
            "AM79C930_GCR_DISPWDN"
          ],
          "line": 1527
        },
        "resolved": true,
        "details": {
          "function_name": "am79c930_gcr_setbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "319-328",
          "snippet": "void am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nu_int8_t awi_read_intst;\nvoid awi_rxint;\nvoid awi_txint;\nvoid awi_scan_next;\nvoid awi_try_sync;\n\nint\nawi_intr(arg)\n\tvoid *arg;\n{\n\tstruct awi_softc *sc = arg;\n\tint handled = 0;\n\n\tif (sc->sc_state == AWI_ST_OFF) {\n\t\tu_int8_t intstate = awi_read_intst (sc);\n\t\treturn intstate != 0;\n\t}\n\n\t/* disable power down, (and implicitly ack interrupt) */\n\tam79c930_gcr_setbits(&sc->sc_chip, AM79C930_GCR_DISPWDN);\n\tawi_write_1(sc, AWI_DIS_PWRDN, 1);\n\t\n\tfor (;;) {\n\t\tu_int8_t intstate = awi_read_intst (sc);\n\n\t\tif (!intstate)\n\t\t\tbreak;\n\n\t\thandled = 1;\n\t\t\n\t\tif (intstate & AWI_INT_RX)\n\t\t\tawi_rxint(sc);\n\n\t\tif (intstate & AWI_INT_TX) \n\t\t\tawi_txint(sc);\n\n\t\tif (intstate & AWI_INT_CMD) {\n\t\t\tu_int8_t status;\n\t\t\t\n\t\t\tif (!(sc->sc_flags & AWI_FL_CMD_INPROG))\n\t\t\t\tprintf(\"%s: no command in progress?\\n\",\n\t\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tstatus = awi_read_1(sc, AWI_CMD_STATUS);\n\t\t\tawi_write_1 (sc, AWI_CMD, 0);\n\t\t\tsc->sc_cmd_timer = 0;\n\t\t\tsc->sc_flags &= ~AWI_FL_CMD_INPROG;\n\t\t\t\n\t\t\tif (sc->sc_completion)\n\t\t\t\t(*sc->sc_completion)(sc, status);\n\t\t}\n\t\tif (intstate & AWI_INT_SCAN_CMPLT) {\n\t\t\tif (sc->sc_flags & AWI_FL_CMD_INPROG) {\n\t\t\t\tpanic(\"i can't take it any more\");\n\t\t\t}\n\t\t\t/*\n\t\t\t * scan completion heuristic..\n\t\t\t */\n\t\t\tif ((sc->sc_nbindings >= NBND)\n\t\t\t    || ((sc->sc_scan_timer == 0) &&\n\t\t\t\t(sc->sc_nbindings > 0)))\n\t\t\t\tawi_try_sync(sc);\n\t\t\telse\n\t\t\t\tawi_scan_next(sc);\n\t\t}\n\t\t\n\t}\n\t/* reenable power down */\n\tam79c930_gcr_clearbits(&sc->sc_chip, AM79C930_GCR_DISPWDN);\n\tawi_write_1(sc, AWI_DIS_PWRDN, 0);\n\n\treturn handled;\n}"
  },
  {
    "function_name": "awi_txint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1460-1495",
    "snippet": "void\nawi_txint (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tint txfirst;\n\t\n\tsc->sc_tx_timer = 0;\n\n\ttxfirst = sc->sc_txfirst;\n\twhile (sc->sc_txpending > 0) {\n\t\tu_int8_t flags = awi_read_1 (sc, sc->sc_txd[txfirst].descr +\n\t\t    AWI_TXD_STATE);\n\n\t\tif (flags & AWI_TXD_ST_OWN)\n\t\t\tbreak;\n\n\t\tif (flags & AWI_TXD_ST_ERROR) {\n\t\t\t/* increment oerrs */;\n\t\t}\n\n\t\ttxfirst = (txfirst + 1) % sc->sc_ntxd;\n\t\tsc->sc_txpending--;\n\t}\n\n\tsc->sc_txfirst = txfirst;\n\n\tif (sc->sc_txpending < sc->sc_ntxd)\n\t\tifp->if_flags &= ~IFF_OACTIVE;\n\t\n\t/*\n\t * see which descriptors are done..\n\t */\n\n\tawi_start(sc->sc_ifp);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_txint",
      "void awi_start"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_start",
          "args": [
            "sc->sc_ifp"
          ],
          "line": 1494
        },
        "resolved": true,
        "details": {
          "function_name": "awi_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "384-449",
          "snippet": "void\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_tx_packet",
            "void awi_start"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_tx_packet;\nvoid awi_start;\n\nvoid\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "sc->sc_txd[txfirst].descr +\n\t\t    AWI_TXD_STATE"
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_txint;\nvoid awi_start;\n\nvoid\nawi_txint (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tint txfirst;\n\t\n\tsc->sc_tx_timer = 0;\n\n\ttxfirst = sc->sc_txfirst;\n\twhile (sc->sc_txpending > 0) {\n\t\tu_int8_t flags = awi_read_1 (sc, sc->sc_txd[txfirst].descr +\n\t\t    AWI_TXD_STATE);\n\n\t\tif (flags & AWI_TXD_ST_OWN)\n\t\t\tbreak;\n\n\t\tif (flags & AWI_TXD_ST_ERROR) {\n\t\t\t/* increment oerrs */;\n\t\t}\n\n\t\ttxfirst = (txfirst + 1) % sc->sc_ntxd;\n\t\tsc->sc_txpending--;\n\t}\n\n\tsc->sc_txfirst = txfirst;\n\n\tif (sc->sc_txpending < sc->sc_ntxd)\n\t\tifp->if_flags &= ~IFF_OACTIVE;\n\t\n\t/*\n\t * see which descriptors are done..\n\t */\n\n\tawi_start(sc->sc_ifp);\n}"
  },
  {
    "function_name": "awi_init_txdescr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1424-1458",
    "snippet": "void\nawi_init_txdescr (sc)\n\tstruct awi_softc *sc;\n{\n\tint i;\n\tu_int32_t offset = sc->sc_txbase;\n\n\tsc->sc_txfirst = 0;\n\tsc->sc_txnext = 0;\n\n\tsc->sc_ntxd = sc->sc_txlen / (AWI_FRAME_SIZE + AWI_TXD_SIZE);\n\tif (sc->sc_ntxd > NTXD) {\n\t\tsc->sc_ntxd = NTXD;\n\t\tprintf(\"oops, no, only %d\\n\", sc->sc_ntxd);\n\t}\n\n\t/* Allocate TXD's */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].descr = offset;\n\t\toffset += AWI_TXD_SIZE;\n\t}\n\t/* now, allocate buffer space to each txd.. */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].frame = offset;\n\t\tsc->sc_txd[i].len = AWI_FRAME_SIZE;\n\t\toffset += AWI_FRAME_SIZE;\n\t\t\n\t}\n\t\n\t/* now, initialize the TX descriptors into a circular linked list. */\n\t\n\tfor (i= 0; i<sc->sc_ntxd; i++) {\n\t\tawi_init_txd(sc, i, 0, 0, 0);\n\t}\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_init_txdescr",
      "void awi_init_txd"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_init_txd",
          "args": [
            "sc",
            "i",
            "0",
            "0",
            "0"
          ],
          "line": 1456
        },
        "resolved": true,
        "details": {
          "function_name": "awi_init_txdescr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1424-1458",
          "snippet": "void\nawi_init_txdescr (sc)\n\tstruct awi_softc *sc;\n{\n\tint i;\n\tu_int32_t offset = sc->sc_txbase;\n\n\tsc->sc_txfirst = 0;\n\tsc->sc_txnext = 0;\n\n\tsc->sc_ntxd = sc->sc_txlen / (AWI_FRAME_SIZE + AWI_TXD_SIZE);\n\tif (sc->sc_ntxd > NTXD) {\n\t\tsc->sc_ntxd = NTXD;\n\t\tprintf(\"oops, no, only %d\\n\", sc->sc_ntxd);\n\t}\n\n\t/* Allocate TXD's */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].descr = offset;\n\t\toffset += AWI_TXD_SIZE;\n\t}\n\t/* now, allocate buffer space to each txd.. */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].frame = offset;\n\t\tsc->sc_txd[i].len = AWI_FRAME_SIZE;\n\t\toffset += AWI_FRAME_SIZE;\n\t\t\n\t}\n\t\n\t/* now, initialize the TX descriptors into a circular linked list. */\n\t\n\tfor (i= 0; i<sc->sc_ntxd; i++) {\n\t\tawi_init_txd(sc, i, 0, 0, 0);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"oops, no, only %d\\n\"",
            "sc->sc_ntxd"
          ],
          "line": 1437
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_init_txdescr;\nvoid awi_init_txd;\n\nvoid\nawi_init_txdescr (sc)\n\tstruct awi_softc *sc;\n{\n\tint i;\n\tu_int32_t offset = sc->sc_txbase;\n\n\tsc->sc_txfirst = 0;\n\tsc->sc_txnext = 0;\n\n\tsc->sc_ntxd = sc->sc_txlen / (AWI_FRAME_SIZE + AWI_TXD_SIZE);\n\tif (sc->sc_ntxd > NTXD) {\n\t\tsc->sc_ntxd = NTXD;\n\t\tprintf(\"oops, no, only %d\\n\", sc->sc_ntxd);\n\t}\n\n\t/* Allocate TXD's */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].descr = offset;\n\t\toffset += AWI_TXD_SIZE;\n\t}\n\t/* now, allocate buffer space to each txd.. */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].frame = offset;\n\t\tsc->sc_txd[i].len = AWI_FRAME_SIZE;\n\t\toffset += AWI_FRAME_SIZE;\n\t\t\n\t}\n\t\n\t/* now, initialize the TX descriptors into a circular linked list. */\n\t\n\tfor (i= 0; i<sc->sc_ntxd; i++) {\n\t\tawi_init_txd(sc, i, 0, 0, 0);\n\t}\n}"
  },
  {
    "function_name": "awi_init_txd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1401-1422",
    "snippet": "void\nawi_init_txd (sc, tx, flag, len, rate)\n\tstruct awi_softc *sc;\n\tint tx;\n\tint flag;\n\tint len;\n\tint rate;\n{\n\tu_int32_t txdbase = sc->sc_txd[tx].descr;\n\tu_int32_t framebase = sc->sc_txd[tx].frame;\n\tu_int32_t nextbase = sc->sc_txd[(tx+1)%sc->sc_ntxd].descr;\n\n\tawi_write_4 (sc, txdbase + AWI_TXD_START, framebase);\n\tawi_write_4 (sc, txdbase + AWI_TXD_NEXT, nextbase);\n\tawi_write_4 (sc, txdbase + AWI_TXD_LENGTH, len);\n\tawi_write_1 (sc, txdbase + AWI_TXD_RATE, rate);\n\t/* zeroize tail end of txd */\n\tawi_write_4 (sc, txdbase + AWI_TXD_NDA, 0);\n\tawi_write_4 (sc, txdbase + AWI_TXD_NRA, 0);\n\t/* Init state last; firmware keys off of this to know when to start tx */\n\tawi_write_1 (sc, txdbase + AWI_TXD_STATE, flag);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_init_txd"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "txdbase + AWI_TXD_STATE",
            "flag"
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "txdbase + AWI_TXD_NRA",
            "0"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "txdbase + AWI_TXD_NDA",
            "0"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "txdbase + AWI_TXD_RATE",
            "rate"
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "txdbase + AWI_TXD_LENGTH",
            "len"
          ],
          "line": 1415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "txdbase + AWI_TXD_NEXT",
            "nextbase"
          ],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_4",
          "args": [
            "sc",
            "txdbase + AWI_TXD_START",
            "framebase"
          ],
          "line": 1413
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_init_txd;\n\nvoid\nawi_init_txd (sc, tx, flag, len, rate)\n\tstruct awi_softc *sc;\n\tint tx;\n\tint flag;\n\tint len;\n\tint rate;\n{\n\tu_int32_t txdbase = sc->sc_txd[tx].descr;\n\tu_int32_t framebase = sc->sc_txd[tx].frame;\n\tu_int32_t nextbase = sc->sc_txd[(tx+1)%sc->sc_ntxd].descr;\n\n\tawi_write_4 (sc, txdbase + AWI_TXD_START, framebase);\n\tawi_write_4 (sc, txdbase + AWI_TXD_NEXT, nextbase);\n\tawi_write_4 (sc, txdbase + AWI_TXD_LENGTH, len);\n\tawi_write_1 (sc, txdbase + AWI_TXD_RATE, rate);\n\t/* zeroize tail end of txd */\n\tawi_write_4 (sc, txdbase + AWI_TXD_NDA, 0);\n\tawi_write_4 (sc, txdbase + AWI_TXD_NRA, 0);\n\t/* Init state last; firmware keys off of this to know when to start tx */\n\tawi_write_1 (sc, txdbase + AWI_TXD_STATE, flag);\n}"
  },
  {
    "function_name": "awi_rxint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1393-1399",
    "snippet": "void\nawi_rxint (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_dump_rxchain (sc, \"mgt\", &sc->sc_rx_mgt_desc);\n\tawi_dump_rxchain (sc, \"data\", &sc->sc_rx_data_desc);\t\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_rxint",
      "void awi_dump_rxchain"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_dump_rxchain",
          "args": [
            "sc",
            "\"data\"",
            "&sc->sc_rx_data_desc"
          ],
          "line": 1398
        },
        "resolved": true,
        "details": {
          "function_name": "awi_dump_rxchain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1364-1391",
          "snippet": "void\nawi_dump_rxchain (sc, what, descr)\n\tstruct awi_softc *sc;\n\tchar *what;\n\tu_int32_t *descr;\n{\n\tu_int32_t cur, next;\n\tstruct awi_rxd rxd;\n\t\n\tcur = *descr;\n\n\tif (cur & AWI_RXD_NEXT_LAST)\n\t\treturn;\n\t\n\tdo {\n\t\tawi_copy_rxd(sc, cur, &rxd);\n\n\t\tnext = awi_parse_rxd(sc, cur, &rxd);\n\t\tif ((rxd.state & AWI_RXD_ST_OWN) && (next == cur)) {\n\t\t\tprintf(\"%s: loop in rxd list?\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tcur = next;\n\t} while (rxd.state & AWI_RXD_ST_OWN);\n\n\t*descr = cur;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_dump_rxchain"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_dump_rxchain;\n\nvoid\nawi_dump_rxchain (sc, what, descr)\n\tstruct awi_softc *sc;\n\tchar *what;\n\tu_int32_t *descr;\n{\n\tu_int32_t cur, next;\n\tstruct awi_rxd rxd;\n\t\n\tcur = *descr;\n\n\tif (cur & AWI_RXD_NEXT_LAST)\n\t\treturn;\n\t\n\tdo {\n\t\tawi_copy_rxd(sc, cur, &rxd);\n\n\t\tnext = awi_parse_rxd(sc, cur, &rxd);\n\t\tif ((rxd.state & AWI_RXD_ST_OWN) && (next == cur)) {\n\t\t\tprintf(\"%s: loop in rxd list?\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tcur = next;\n\t} while (rxd.state & AWI_RXD_ST_OWN);\n\n\t*descr = cur;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rxint;\nvoid awi_dump_rxchain;\n\nvoid\nawi_rxint (sc)\n\tstruct awi_softc *sc;\n{\n\tawi_dump_rxchain (sc, \"mgt\", &sc->sc_rx_mgt_desc);\n\tawi_dump_rxchain (sc, \"data\", &sc->sc_rx_data_desc);\t\n}"
  },
  {
    "function_name": "awi_dump_rxchain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1364-1391",
    "snippet": "void\nawi_dump_rxchain (sc, what, descr)\n\tstruct awi_softc *sc;\n\tchar *what;\n\tu_int32_t *descr;\n{\n\tu_int32_t cur, next;\n\tstruct awi_rxd rxd;\n\t\n\tcur = *descr;\n\n\tif (cur & AWI_RXD_NEXT_LAST)\n\t\treturn;\n\t\n\tdo {\n\t\tawi_copy_rxd(sc, cur, &rxd);\n\n\t\tnext = awi_parse_rxd(sc, cur, &rxd);\n\t\tif ((rxd.state & AWI_RXD_ST_OWN) && (next == cur)) {\n\t\t\tprintf(\"%s: loop in rxd list?\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tcur = next;\n\t} while (rxd.state & AWI_RXD_ST_OWN);\n\n\t*descr = cur;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_dump_rxchain"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: loop in rxd list?\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_parse_rxd",
          "args": [
            "sc",
            "cur",
            "&rxd"
          ],
          "line": 1381
        },
        "resolved": true,
        "details": {
          "function_name": "awi_parse_rxd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1249-1362",
          "snippet": "u_int32_t\nawi_parse_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tstruct mbuf *top;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int32_t next;\n\t\n\tif ((rxd->state & AWI_RXD_ST_CONSUMED) == 0) {\n\t\tif (ifp->if_flags & IFF_LINK1) {\n\t\t\tint xx = awi_read_1(sc, rxd->frame);\n\t\t\tif (xx != (IEEEWL_FC_VERS |\n\t\t\t    (IEEEWL_FC_TYPE_MGT<<IEEEWL_FC_TYPE_SHIFT) |\n\t\t\t    (IEEEWL_SUBTYPE_BEACON << IEEEWL_FC_SUBTYPE_SHIFT))) {\n\t\t\t\tchar bitbuf[64];\n\t\t\t\tprintf(\"floosh: %d state \", sc->sc_flushpkt);\n\t\t\t \tsnprintf(bitbuf, sizeof bitbuf, \"%b\",\n\t\t\t\t\t rxd->state, AWI_RXD_ST_BITS);\n\t\t\t\tawi_card_hexdump(sc, bitbuf, rxd->frame,\n\t\t\t\t\t\t rxd->len);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tif ((sc->sc_flushpkt == 0) &&\n\t\t    (sc->sc_nextpkt == NULL)) {\n\t\t\tMGETHDR(top, M_DONTWAIT, MT_DATA);\n\t\t\t\n\t\t\tif (top == NULL) {\n\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t} else {\n\t\t\t\tif (rxd->len >= MINCLSIZE)\n\t\t\t\t\tMCLGET(top, M_DONTWAIT);\n\t\t\n\t\t\t\ttop->m_pkthdr.rcvif = ifp;\n\t\t\t\ttop->m_pkthdr.len = 0;\n\t\t\t\ttop->m_len = 0;\n\t\t\n\t\t\t\tsc->sc_mleft = (top->m_flags & M_EXT) ?\n\t\t\t\t    MCLBYTES : MHLEN;\n\t\t\t\tsc->sc_mptr = mtod(top, u_int8_t *);\n\t\t\t\tsc->sc_m = top;\n\t\t\t\tsc->sc_nextpkt = top;\n\t\t\t}\n\t\t}\n\t\tif (sc->sc_flushpkt == 0) {\n\t\t\t/* copy data into mbuf */\n\n\t\t\twhile (rxd->len > 0) {\n\t\t\t\tint nmove = min (rxd->len, sc->sc_mleft);\n\n\t\t\t\tawi_read_bytes (sc, rxd->frame, sc->sc_mptr,\n\t\t\t\t    nmove);\n\n\t\t\t\trxd->len -= nmove;\n\t\t\t\trxd->frame += nmove;\n\t\t\t\tsc->sc_mleft -= nmove;\n\t\t\t\tsc->sc_mptr += nmove;\n\t\t\t\t\n\t\t\t\tsc->sc_nextpkt->m_pkthdr.len += nmove;\n\t\t\t\tsc->sc_m->m_len += nmove;\n\t\t\t\t\t\t\n\t\t\t\tif ((rxd->len > 0) && (sc->sc_mleft == 0)) {\n\t\t\t\t\tstruct mbuf *m1;\n\t\t\t\t\t\n\t\t\t\t\t/* Get next mbuf.. */\n\t\t\t\t\tMGET(m1, M_DONTWAIT, MT_DATA);\n\t\t\t\t\tif (m1 == NULL) {\n\t\t\t\t\t\tm_freem(sc->sc_nextpkt);\n\t\t\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\t\t\tsc->sc_m = NULL;\n\t\t\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsc->sc_m->m_next = m1;\n\t\t\t\t\tsc->sc_m = m1;\n\t\t\t\t\tm1->m_len = 0;\n\n\t\t\t\t\tsc->sc_mleft = MLEN;\n\t\t\t\t\tsc->sc_mptr = mtod(m1, u_int8_t *);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (rxd->state & AWI_RXD_ST_LF) {\n\t\t\tif (sc->sc_flushpkt) {\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t}\n\t\t\telse if (sc->sc_nextpkt != NULL) {\n\t\t\t\tstruct mbuf *m = sc->sc_nextpkt;\n\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\tawi_rcv(sc, m, rxd->rxts, rxd->rssi);\n\t\t\t}\n\t\t}\n\t}\n\trxd->state |= AWI_RXD_ST_CONSUMED;\n\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\tnext = cur;\n\tif ((rxd->next & AWI_RXD_NEXT_LAST) == 0) {\n\t\trxd->state |= AWI_RXD_ST_OWN;\n\t\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\t\tnext = rxd->next;\n\t}\n\treturn next;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_rcv"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rcv;\n\nu_int32_t\nawi_parse_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tstruct mbuf *top;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int32_t next;\n\t\n\tif ((rxd->state & AWI_RXD_ST_CONSUMED) == 0) {\n\t\tif (ifp->if_flags & IFF_LINK1) {\n\t\t\tint xx = awi_read_1(sc, rxd->frame);\n\t\t\tif (xx != (IEEEWL_FC_VERS |\n\t\t\t    (IEEEWL_FC_TYPE_MGT<<IEEEWL_FC_TYPE_SHIFT) |\n\t\t\t    (IEEEWL_SUBTYPE_BEACON << IEEEWL_FC_SUBTYPE_SHIFT))) {\n\t\t\t\tchar bitbuf[64];\n\t\t\t\tprintf(\"floosh: %d state \", sc->sc_flushpkt);\n\t\t\t \tsnprintf(bitbuf, sizeof bitbuf, \"%b\",\n\t\t\t\t\t rxd->state, AWI_RXD_ST_BITS);\n\t\t\t\tawi_card_hexdump(sc, bitbuf, rxd->frame,\n\t\t\t\t\t\t rxd->len);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tif ((sc->sc_flushpkt == 0) &&\n\t\t    (sc->sc_nextpkt == NULL)) {\n\t\t\tMGETHDR(top, M_DONTWAIT, MT_DATA);\n\t\t\t\n\t\t\tif (top == NULL) {\n\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t} else {\n\t\t\t\tif (rxd->len >= MINCLSIZE)\n\t\t\t\t\tMCLGET(top, M_DONTWAIT);\n\t\t\n\t\t\t\ttop->m_pkthdr.rcvif = ifp;\n\t\t\t\ttop->m_pkthdr.len = 0;\n\t\t\t\ttop->m_len = 0;\n\t\t\n\t\t\t\tsc->sc_mleft = (top->m_flags & M_EXT) ?\n\t\t\t\t    MCLBYTES : MHLEN;\n\t\t\t\tsc->sc_mptr = mtod(top, u_int8_t *);\n\t\t\t\tsc->sc_m = top;\n\t\t\t\tsc->sc_nextpkt = top;\n\t\t\t}\n\t\t}\n\t\tif (sc->sc_flushpkt == 0) {\n\t\t\t/* copy data into mbuf */\n\n\t\t\twhile (rxd->len > 0) {\n\t\t\t\tint nmove = min (rxd->len, sc->sc_mleft);\n\n\t\t\t\tawi_read_bytes (sc, rxd->frame, sc->sc_mptr,\n\t\t\t\t    nmove);\n\n\t\t\t\trxd->len -= nmove;\n\t\t\t\trxd->frame += nmove;\n\t\t\t\tsc->sc_mleft -= nmove;\n\t\t\t\tsc->sc_mptr += nmove;\n\t\t\t\t\n\t\t\t\tsc->sc_nextpkt->m_pkthdr.len += nmove;\n\t\t\t\tsc->sc_m->m_len += nmove;\n\t\t\t\t\t\t\n\t\t\t\tif ((rxd->len > 0) && (sc->sc_mleft == 0)) {\n\t\t\t\t\tstruct mbuf *m1;\n\t\t\t\t\t\n\t\t\t\t\t/* Get next mbuf.. */\n\t\t\t\t\tMGET(m1, M_DONTWAIT, MT_DATA);\n\t\t\t\t\tif (m1 == NULL) {\n\t\t\t\t\t\tm_freem(sc->sc_nextpkt);\n\t\t\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\t\t\tsc->sc_m = NULL;\n\t\t\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsc->sc_m->m_next = m1;\n\t\t\t\t\tsc->sc_m = m1;\n\t\t\t\t\tm1->m_len = 0;\n\n\t\t\t\t\tsc->sc_mleft = MLEN;\n\t\t\t\t\tsc->sc_mptr = mtod(m1, u_int8_t *);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (rxd->state & AWI_RXD_ST_LF) {\n\t\t\tif (sc->sc_flushpkt) {\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t}\n\t\t\telse if (sc->sc_nextpkt != NULL) {\n\t\t\t\tstruct mbuf *m = sc->sc_nextpkt;\n\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\tawi_rcv(sc, m, rxd->rxts, rxd->rssi);\n\t\t\t}\n\t\t}\n\t}\n\trxd->state |= AWI_RXD_ST_CONSUMED;\n\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\tnext = cur;\n\tif ((rxd->next & AWI_RXD_NEXT_LAST) == 0) {\n\t\trxd->state |= AWI_RXD_ST_OWN;\n\t\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\t\tnext = rxd->next;\n\t}\n\treturn next;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_copy_rxd",
          "args": [
            "sc",
            "cur",
            "&rxd"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "awi_copy_rxd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1209-1246",
          "snippet": "void\nawi_copy_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"%x: \", cur);\n\t\tawi_card_hexdump(sc, \"rxd\", cur, AWI_RXD_SIZE);\n\t}\n\t\n\trxd->next = awi_read_4(sc, cur + AWI_RXD_NEXT);\n\trxd->state = awi_read_1(sc, cur + AWI_RXD_HOST_DESC_STATE);\n\trxd->len = awi_read_2 (sc, cur + AWI_RXD_LEN);\n\trxd->rate = awi_read_1 (sc, cur + AWI_RXD_RATE);\n\trxd->rssi = awi_read_1 (sc, cur + AWI_RXD_RSSI);\t\t\n\trxd->index = awi_read_1 (sc, cur + AWI_RXD_INDEX);\n\trxd->frame = awi_read_4 (sc, cur + AWI_RXD_START_FRAME);\n\trxd->rxts = awi_read_4 (sc, cur + AWI_RXD_LOCALTIME);\n\n\t/*\n\t * only the low order bits of \"frame\" and \"next\" are valid.\n\t * (the documentation doesn't mention this).\n\t */\n\trxd->frame &= 0xffff;\n\trxd->next &= (0xffff | AWI_RXD_NEXT_LAST);\n\n\t/*\n\t * XXX after masking, sanity check that rxd->frame and\n\t * rxd->next lie within the receive area.\n\t */\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"nxt %x frame %x state %b len %d\\n\",\n\t\t    rxd->next, rxd->frame,\n\t\t    rxd->state, AWI_RXD_ST_BITS,\n\t\t    rxd->len);\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_copy_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"%x: \", cur);\n\t\tawi_card_hexdump(sc, \"rxd\", cur, AWI_RXD_SIZE);\n\t}\n\t\n\trxd->next = awi_read_4(sc, cur + AWI_RXD_NEXT);\n\trxd->state = awi_read_1(sc, cur + AWI_RXD_HOST_DESC_STATE);\n\trxd->len = awi_read_2 (sc, cur + AWI_RXD_LEN);\n\trxd->rate = awi_read_1 (sc, cur + AWI_RXD_RATE);\n\trxd->rssi = awi_read_1 (sc, cur + AWI_RXD_RSSI);\t\t\n\trxd->index = awi_read_1 (sc, cur + AWI_RXD_INDEX);\n\trxd->frame = awi_read_4 (sc, cur + AWI_RXD_START_FRAME);\n\trxd->rxts = awi_read_4 (sc, cur + AWI_RXD_LOCALTIME);\n\n\t/*\n\t * only the low order bits of \"frame\" and \"next\" are valid.\n\t * (the documentation doesn't mention this).\n\t */\n\trxd->frame &= 0xffff;\n\trxd->next &= (0xffff | AWI_RXD_NEXT_LAST);\n\n\t/*\n\t * XXX after masking, sanity check that rxd->frame and\n\t * rxd->next lie within the receive area.\n\t */\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"nxt %x frame %x state %b len %d\\n\",\n\t\t    rxd->next, rxd->frame,\n\t\t    rxd->state, AWI_RXD_ST_BITS,\n\t\t    rxd->len);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_dump_rxchain;\n\nvoid\nawi_dump_rxchain (sc, what, descr)\n\tstruct awi_softc *sc;\n\tchar *what;\n\tu_int32_t *descr;\n{\n\tu_int32_t cur, next;\n\tstruct awi_rxd rxd;\n\t\n\tcur = *descr;\n\n\tif (cur & AWI_RXD_NEXT_LAST)\n\t\treturn;\n\t\n\tdo {\n\t\tawi_copy_rxd(sc, cur, &rxd);\n\n\t\tnext = awi_parse_rxd(sc, cur, &rxd);\n\t\tif ((rxd.state & AWI_RXD_ST_OWN) && (next == cur)) {\n\t\t\tprintf(\"%s: loop in rxd list?\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tcur = next;\n\t} while (rxd.state & AWI_RXD_ST_OWN);\n\n\t*descr = cur;\n}"
  },
  {
    "function_name": "awi_parse_rxd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1249-1362",
    "snippet": "u_int32_t\nawi_parse_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tstruct mbuf *top;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int32_t next;\n\t\n\tif ((rxd->state & AWI_RXD_ST_CONSUMED) == 0) {\n\t\tif (ifp->if_flags & IFF_LINK1) {\n\t\t\tint xx = awi_read_1(sc, rxd->frame);\n\t\t\tif (xx != (IEEEWL_FC_VERS |\n\t\t\t    (IEEEWL_FC_TYPE_MGT<<IEEEWL_FC_TYPE_SHIFT) |\n\t\t\t    (IEEEWL_SUBTYPE_BEACON << IEEEWL_FC_SUBTYPE_SHIFT))) {\n\t\t\t\tchar bitbuf[64];\n\t\t\t\tprintf(\"floosh: %d state \", sc->sc_flushpkt);\n\t\t\t \tsnprintf(bitbuf, sizeof bitbuf, \"%b\",\n\t\t\t\t\t rxd->state, AWI_RXD_ST_BITS);\n\t\t\t\tawi_card_hexdump(sc, bitbuf, rxd->frame,\n\t\t\t\t\t\t rxd->len);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tif ((sc->sc_flushpkt == 0) &&\n\t\t    (sc->sc_nextpkt == NULL)) {\n\t\t\tMGETHDR(top, M_DONTWAIT, MT_DATA);\n\t\t\t\n\t\t\tif (top == NULL) {\n\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t} else {\n\t\t\t\tif (rxd->len >= MINCLSIZE)\n\t\t\t\t\tMCLGET(top, M_DONTWAIT);\n\t\t\n\t\t\t\ttop->m_pkthdr.rcvif = ifp;\n\t\t\t\ttop->m_pkthdr.len = 0;\n\t\t\t\ttop->m_len = 0;\n\t\t\n\t\t\t\tsc->sc_mleft = (top->m_flags & M_EXT) ?\n\t\t\t\t    MCLBYTES : MHLEN;\n\t\t\t\tsc->sc_mptr = mtod(top, u_int8_t *);\n\t\t\t\tsc->sc_m = top;\n\t\t\t\tsc->sc_nextpkt = top;\n\t\t\t}\n\t\t}\n\t\tif (sc->sc_flushpkt == 0) {\n\t\t\t/* copy data into mbuf */\n\n\t\t\twhile (rxd->len > 0) {\n\t\t\t\tint nmove = min (rxd->len, sc->sc_mleft);\n\n\t\t\t\tawi_read_bytes (sc, rxd->frame, sc->sc_mptr,\n\t\t\t\t    nmove);\n\n\t\t\t\trxd->len -= nmove;\n\t\t\t\trxd->frame += nmove;\n\t\t\t\tsc->sc_mleft -= nmove;\n\t\t\t\tsc->sc_mptr += nmove;\n\t\t\t\t\n\t\t\t\tsc->sc_nextpkt->m_pkthdr.len += nmove;\n\t\t\t\tsc->sc_m->m_len += nmove;\n\t\t\t\t\t\t\n\t\t\t\tif ((rxd->len > 0) && (sc->sc_mleft == 0)) {\n\t\t\t\t\tstruct mbuf *m1;\n\t\t\t\t\t\n\t\t\t\t\t/* Get next mbuf.. */\n\t\t\t\t\tMGET(m1, M_DONTWAIT, MT_DATA);\n\t\t\t\t\tif (m1 == NULL) {\n\t\t\t\t\t\tm_freem(sc->sc_nextpkt);\n\t\t\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\t\t\tsc->sc_m = NULL;\n\t\t\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsc->sc_m->m_next = m1;\n\t\t\t\t\tsc->sc_m = m1;\n\t\t\t\t\tm1->m_len = 0;\n\n\t\t\t\t\tsc->sc_mleft = MLEN;\n\t\t\t\t\tsc->sc_mptr = mtod(m1, u_int8_t *);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (rxd->state & AWI_RXD_ST_LF) {\n\t\t\tif (sc->sc_flushpkt) {\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t}\n\t\t\telse if (sc->sc_nextpkt != NULL) {\n\t\t\t\tstruct mbuf *m = sc->sc_nextpkt;\n\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\tawi_rcv(sc, m, rxd->rxts, rxd->rssi);\n\t\t\t}\n\t\t}\n\t}\n\trxd->state |= AWI_RXD_ST_CONSUMED;\n\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\tnext = cur;\n\tif ((rxd->next & AWI_RXD_NEXT_LAST) == 0) {\n\t\trxd->state |= AWI_RXD_ST_OWN;\n\t\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\t\tnext = rxd->next;\n\t}\n\treturn next;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_rcv"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "cur + AWI_RXD_HOST_DESC_STATE",
            "rxd->state"
          ],
          "line": 1358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "cur + AWI_RXD_HOST_DESC_STATE",
            "rxd->state"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_rcv",
          "args": [
            "sc",
            "m",
            "rxd->rxts",
            "rxd->rssi"
          ],
          "line": 1349
        },
        "resolved": true,
        "details": {
          "function_name": "awi_rcv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1137-1207",
          "snippet": "void\nawi_rcv (sc, m, rxts, rssi)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t *framehdr;\n\tu_int8_t framectl;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * peek at first byte of frame header.\n\t *  check version subfield (must be zero)\n\t *  check type subfield (00 = mgt, 01 = ctl, 10 = data)\n\t *  check subtype field (next four bits)\n\t */\n\n\t/*\n\t * Not counting WDS mode, the IEEE 802.11 frame header format\n\t * has *three* MAC addresses. \n\t * (source, destination, and BSS).\n\t *\n\t * The BSS indicates which wireless \"cable segment\" we're part of;\n\t * we discover this dynamically..\n\t *\n\t * Not content to put them in a fixed order, the exact\n\t * ordering of these addresses depends on other attribute bits\n\t * in the frame control word!\n\t *\n\t * an alternate presentation which is more self-consistent:\n\t * address 1 is the \"wireless destination\" -- either the\n\t * station address,\n\t * for wireless->wireless traffic, or the BSS id of an AP.\n\t *\n\t * address 2 is the \"wireless source\" -- either the\n\t * station address of a wireless node, or the BSS id of an AP.\n\t *\n\t * address 3 is the \"other address\" -- for STA->AP, the\n\t * eventual destination; for AP->STA, the original source, and\n\t * for ad-hoc mode, the BSS id..\n\t */\n\n\tframectl = framehdr[IEEEWL_FC];\n\t\n\tif ((framectl & IEEEWL_FC_VERS_MASK) != IEEEWL_FC_VERS) {\n\t\tprintf(\"wrong vers.  drop\");\n\t\tgoto drop;\n\t}\n\n\tswitch (framectl & IEEEWL_FC_TYPE_MASK) {\n\tcase IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_mgt (sc, m, rxts, rssi);\n\t\tm = 0;\n\t\tbreak;\n\t\t\n\tcase IEEEWL_FC_TYPE_DATA << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_data (sc, m);\n\t\tm = 0;\n\t\tbreak;\n\n\tcase IEEEWL_FC_TYPE_CTL << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_ctl (sc, m);\n\tdefault:\n\t\tgoto drop;\n\t}\n\n drop:\n\tif (m) m_freem(m);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_rcv",
            "void awi_rcv_mgt",
            "void awi_rcv_data",
            "void awi_rcv_ctl"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rcv;\nvoid awi_rcv_mgt;\nvoid awi_rcv_data;\nvoid awi_rcv_ctl;\n\nvoid\nawi_rcv (sc, m, rxts, rssi)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t *framehdr;\n\tu_int8_t framectl;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * peek at first byte of frame header.\n\t *  check version subfield (must be zero)\n\t *  check type subfield (00 = mgt, 01 = ctl, 10 = data)\n\t *  check subtype field (next four bits)\n\t */\n\n\t/*\n\t * Not counting WDS mode, the IEEE 802.11 frame header format\n\t * has *three* MAC addresses. \n\t * (source, destination, and BSS).\n\t *\n\t * The BSS indicates which wireless \"cable segment\" we're part of;\n\t * we discover this dynamically..\n\t *\n\t * Not content to put them in a fixed order, the exact\n\t * ordering of these addresses depends on other attribute bits\n\t * in the frame control word!\n\t *\n\t * an alternate presentation which is more self-consistent:\n\t * address 1 is the \"wireless destination\" -- either the\n\t * station address,\n\t * for wireless->wireless traffic, or the BSS id of an AP.\n\t *\n\t * address 2 is the \"wireless source\" -- either the\n\t * station address of a wireless node, or the BSS id of an AP.\n\t *\n\t * address 3 is the \"other address\" -- for STA->AP, the\n\t * eventual destination; for AP->STA, the original source, and\n\t * for ad-hoc mode, the BSS id..\n\t */\n\n\tframectl = framehdr[IEEEWL_FC];\n\t\n\tif ((framectl & IEEEWL_FC_VERS_MASK) != IEEEWL_FC_VERS) {\n\t\tprintf(\"wrong vers.  drop\");\n\t\tgoto drop;\n\t}\n\n\tswitch (framectl & IEEEWL_FC_TYPE_MASK) {\n\tcase IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_mgt (sc, m, rxts, rssi);\n\t\tm = 0;\n\t\tbreak;\n\t\t\n\tcase IEEEWL_FC_TYPE_DATA << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_data (sc, m);\n\t\tm = 0;\n\t\tbreak;\n\n\tcase IEEEWL_FC_TYPE_CTL << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_ctl (sc, m);\n\tdefault:\n\t\tgoto drop;\n\t}\n\n drop:\n\tif (m) m_freem(m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m1",
            "u_int8_t*"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "sc->sc_nextpkt"
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MGET",
          "args": [
            "m1",
            "M_DONTWAIT",
            "MT_DATA"
          ],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_bytes",
          "args": [
            "sc",
            "rxd->frame",
            "sc->sc_mptr",
            "nmove"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "rxd->len",
            "sc->sc_mleft"
          ],
          "line": 1302
        },
        "resolved": true,
        "details": {
          "function_name": "am7990_meminit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am7990.c",
          "lines": "231-295",
          "snippet": "void\nam7990_meminit(sc)\n\tregister struct am7990_softc *sc;\n{\n\tu_long a;\n\tint bix;\n\tstruct leinit init;\n\tstruct lermd rmd;\n\tstruct letmd tmd;\n\n#if NBPFILTER > 0\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tinit.init_mode = LE_MODE_NORMAL | LE_MODE_PROM;\n\telse\n#endif\n\t\tinit.init_mode = LE_MODE_NORMAL;\n\tinit.init_padr[0] =\n\t    (sc->sc_arpcom.ac_enaddr[1] << 8) | sc->sc_arpcom.ac_enaddr[0];\n\tinit.init_padr[1] =\n\t    (sc->sc_arpcom.ac_enaddr[3] << 8) | sc->sc_arpcom.ac_enaddr[2];\n\tinit.init_padr[2] =\n\t    (sc->sc_arpcom.ac_enaddr[5] << 8) | sc->sc_arpcom.ac_enaddr[4];\n\tam7990_setladrf(&sc->sc_arpcom, init.init_ladrf);\n\n\tsc->sc_last_rd = 0;\n\tsc->sc_first_td = sc->sc_last_td = sc->sc_no_td = 0;\n\n\ta = sc->sc_addr + LE_RMDADDR(sc, 0);\n\tinit.init_rdra = a;\n\tinit.init_rlen = (a >> 16) | ((ffs(sc->sc_nrbuf) - 1) << 13);\n\n\ta = sc->sc_addr + LE_TMDADDR(sc, 0);\n\tinit.init_tdra = a;\n\tinit.init_tlen = (a >> 16) | ((ffs(sc->sc_ntbuf) - 1) << 13);\n\n\t(*sc->sc_copytodesc)(sc, &init, LE_INITADDR(sc), sizeof(init));\n\n\t/*\n\t * Set up receive ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_nrbuf; bix++) {\n\t\ta = sc->sc_addr + LE_RBUFADDR(sc, bix);\n\t\trmd.rmd0 = a;\n\t\trmd.rmd1_hadr = a >> 16;\n\t\trmd.rmd1_bits = LE_R1_OWN;\n\t\trmd.rmd2 = -LEBLEN | LE_XMD2_ONES;\n\t\trmd.rmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &rmd, LE_RMDADDR(sc, bix),\n\t\t    sizeof(rmd));\n\t}\n\n\t/*\n\t * Set up transmit ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_ntbuf; bix++) {\n\t\ta = sc->sc_addr + LE_TBUFADDR(sc, bix);\n\t\ttmd.tmd0 = a;\n\t\ttmd.tmd1_hadr = a >> 16;\n\t\ttmd.tmd1_bits = 0;\n\t\ttmd.tmd2 = 0 | LE_XMD2_ONES;\n\t\ttmd.tmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &tmd, LE_TMDADDR(sc, bix),\n\t\t    sizeof(tmd));\n\t}\n}",
          "includes": [
            "#include <dev/ic/am7990var.h>",
            "#include <dev/ic/am7990reg.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/socket.h>",
            "#include <sys/syslog.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tifp\t(&sc->sc_arpcom.ac_if)"
          ],
          "globals_used": [
            "am7990_rint __P((struct am7990_softc *));",
            "am7990_tint __P((struct am7990_softc *));",
            "integrate struct",
            "integrate struct",
            "mbuf *\nam7990_get(sc, boff, totlen)\n\tstruct am7990_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tifp\t(&sc->sc_arpcom.ac_if)\n\nam7990_rint __P((struct am7990_softc *));\nam7990_tint __P((struct am7990_softc *));\nintegrate struct;\nintegrate struct;\nmbuf *\nam7990_get(sc, boff, totlen)\n\tstruct am7990_softc *sc;\n\nvoid\nam7990_meminit(sc)\n\tregister struct am7990_softc *sc;\n{\n\tu_long a;\n\tint bix;\n\tstruct leinit init;\n\tstruct lermd rmd;\n\tstruct letmd tmd;\n\n#if NBPFILTER > 0\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tinit.init_mode = LE_MODE_NORMAL | LE_MODE_PROM;\n\telse\n#endif\n\t\tinit.init_mode = LE_MODE_NORMAL;\n\tinit.init_padr[0] =\n\t    (sc->sc_arpcom.ac_enaddr[1] << 8) | sc->sc_arpcom.ac_enaddr[0];\n\tinit.init_padr[1] =\n\t    (sc->sc_arpcom.ac_enaddr[3] << 8) | sc->sc_arpcom.ac_enaddr[2];\n\tinit.init_padr[2] =\n\t    (sc->sc_arpcom.ac_enaddr[5] << 8) | sc->sc_arpcom.ac_enaddr[4];\n\tam7990_setladrf(&sc->sc_arpcom, init.init_ladrf);\n\n\tsc->sc_last_rd = 0;\n\tsc->sc_first_td = sc->sc_last_td = sc->sc_no_td = 0;\n\n\ta = sc->sc_addr + LE_RMDADDR(sc, 0);\n\tinit.init_rdra = a;\n\tinit.init_rlen = (a >> 16) | ((ffs(sc->sc_nrbuf) - 1) << 13);\n\n\ta = sc->sc_addr + LE_TMDADDR(sc, 0);\n\tinit.init_tdra = a;\n\tinit.init_tlen = (a >> 16) | ((ffs(sc->sc_ntbuf) - 1) << 13);\n\n\t(*sc->sc_copytodesc)(sc, &init, LE_INITADDR(sc), sizeof(init));\n\n\t/*\n\t * Set up receive ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_nrbuf; bix++) {\n\t\ta = sc->sc_addr + LE_RBUFADDR(sc, bix);\n\t\trmd.rmd0 = a;\n\t\trmd.rmd1_hadr = a >> 16;\n\t\trmd.rmd1_bits = LE_R1_OWN;\n\t\trmd.rmd2 = -LEBLEN | LE_XMD2_ONES;\n\t\trmd.rmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &rmd, LE_RMDADDR(sc, bix),\n\t\t    sizeof(rmd));\n\t}\n\n\t/*\n\t * Set up transmit ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_ntbuf; bix++) {\n\t\ta = sc->sc_addr + LE_TBUFADDR(sc, bix);\n\t\ttmd.tmd0 = a;\n\t\ttmd.tmd1_hadr = a >> 16;\n\t\ttmd.tmd1_bits = 0;\n\t\ttmd.tmd2 = 0 | LE_XMD2_ONES;\n\t\ttmd.tmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &tmd, LE_TMDADDR(sc, bix),\n\t\t    sizeof(tmd));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "top",
            "u_int8_t*"
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MCLGET",
          "args": [
            "top",
            "M_DONTWAIT"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MGETHDR",
          "args": [
            "top",
            "M_DONTWAIT",
            "MT_DATA"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_card_hexdump",
          "args": [
            "sc",
            "bitbuf",
            "rxd->frame",
            "rxd->len"
          ],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "awi_card_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "552-565",
          "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "bitbuf",
            "sizeof bitbuf",
            "\"%b\"",
            "rxd->state",
            "AWI_RXD_ST_BITS"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"floosh: %d state \"",
            "sc->sc_flushpkt"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "rxd->frame"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rcv;\n\nu_int32_t\nawi_parse_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tstruct mbuf *top;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int32_t next;\n\t\n\tif ((rxd->state & AWI_RXD_ST_CONSUMED) == 0) {\n\t\tif (ifp->if_flags & IFF_LINK1) {\n\t\t\tint xx = awi_read_1(sc, rxd->frame);\n\t\t\tif (xx != (IEEEWL_FC_VERS |\n\t\t\t    (IEEEWL_FC_TYPE_MGT<<IEEEWL_FC_TYPE_SHIFT) |\n\t\t\t    (IEEEWL_SUBTYPE_BEACON << IEEEWL_FC_SUBTYPE_SHIFT))) {\n\t\t\t\tchar bitbuf[64];\n\t\t\t\tprintf(\"floosh: %d state \", sc->sc_flushpkt);\n\t\t\t \tsnprintf(bitbuf, sizeof bitbuf, \"%b\",\n\t\t\t\t\t rxd->state, AWI_RXD_ST_BITS);\n\t\t\t\tawi_card_hexdump(sc, bitbuf, rxd->frame,\n\t\t\t\t\t\t rxd->len);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tif ((sc->sc_flushpkt == 0) &&\n\t\t    (sc->sc_nextpkt == NULL)) {\n\t\t\tMGETHDR(top, M_DONTWAIT, MT_DATA);\n\t\t\t\n\t\t\tif (top == NULL) {\n\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t} else {\n\t\t\t\tif (rxd->len >= MINCLSIZE)\n\t\t\t\t\tMCLGET(top, M_DONTWAIT);\n\t\t\n\t\t\t\ttop->m_pkthdr.rcvif = ifp;\n\t\t\t\ttop->m_pkthdr.len = 0;\n\t\t\t\ttop->m_len = 0;\n\t\t\n\t\t\t\tsc->sc_mleft = (top->m_flags & M_EXT) ?\n\t\t\t\t    MCLBYTES : MHLEN;\n\t\t\t\tsc->sc_mptr = mtod(top, u_int8_t *);\n\t\t\t\tsc->sc_m = top;\n\t\t\t\tsc->sc_nextpkt = top;\n\t\t\t}\n\t\t}\n\t\tif (sc->sc_flushpkt == 0) {\n\t\t\t/* copy data into mbuf */\n\n\t\t\twhile (rxd->len > 0) {\n\t\t\t\tint nmove = min (rxd->len, sc->sc_mleft);\n\n\t\t\t\tawi_read_bytes (sc, rxd->frame, sc->sc_mptr,\n\t\t\t\t    nmove);\n\n\t\t\t\trxd->len -= nmove;\n\t\t\t\trxd->frame += nmove;\n\t\t\t\tsc->sc_mleft -= nmove;\n\t\t\t\tsc->sc_mptr += nmove;\n\t\t\t\t\n\t\t\t\tsc->sc_nextpkt->m_pkthdr.len += nmove;\n\t\t\t\tsc->sc_m->m_len += nmove;\n\t\t\t\t\t\t\n\t\t\t\tif ((rxd->len > 0) && (sc->sc_mleft == 0)) {\n\t\t\t\t\tstruct mbuf *m1;\n\t\t\t\t\t\n\t\t\t\t\t/* Get next mbuf.. */\n\t\t\t\t\tMGET(m1, M_DONTWAIT, MT_DATA);\n\t\t\t\t\tif (m1 == NULL) {\n\t\t\t\t\t\tm_freem(sc->sc_nextpkt);\n\t\t\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\t\t\tsc->sc_flushpkt = 1;\n\t\t\t\t\t\tsc->sc_m = NULL;\n\t\t\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsc->sc_m->m_next = m1;\n\t\t\t\t\tsc->sc_m = m1;\n\t\t\t\t\tm1->m_len = 0;\n\n\t\t\t\t\tsc->sc_mleft = MLEN;\n\t\t\t\t\tsc->sc_mptr = mtod(m1, u_int8_t *);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (rxd->state & AWI_RXD_ST_LF) {\n\t\t\tif (sc->sc_flushpkt) {\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t}\n\t\t\telse if (sc->sc_nextpkt != NULL) {\n\t\t\t\tstruct mbuf *m = sc->sc_nextpkt;\n\t\t\t\tsc->sc_nextpkt = NULL;\n\t\t\t\tsc->sc_flushpkt = 0;\n\t\t\t\tsc->sc_m = NULL;\n\t\t\t\tsc->sc_mptr = NULL;\n\t\t\t\tsc->sc_mleft = 0;\n\t\t\t\tawi_rcv(sc, m, rxd->rxts, rxd->rssi);\n\t\t\t}\n\t\t}\n\t}\n\trxd->state |= AWI_RXD_ST_CONSUMED;\n\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\tnext = cur;\n\tif ((rxd->next & AWI_RXD_NEXT_LAST) == 0) {\n\t\trxd->state |= AWI_RXD_ST_OWN;\n\t\tawi_write_1(sc, cur + AWI_RXD_HOST_DESC_STATE, rxd->state);\n\t\tnext = rxd->next;\n\t}\n\treturn next;\n}"
  },
  {
    "function_name": "awi_copy_rxd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1209-1246",
    "snippet": "void\nawi_copy_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"%x: \", cur);\n\t\tawi_card_hexdump(sc, \"rxd\", cur, AWI_RXD_SIZE);\n\t}\n\t\n\trxd->next = awi_read_4(sc, cur + AWI_RXD_NEXT);\n\trxd->state = awi_read_1(sc, cur + AWI_RXD_HOST_DESC_STATE);\n\trxd->len = awi_read_2 (sc, cur + AWI_RXD_LEN);\n\trxd->rate = awi_read_1 (sc, cur + AWI_RXD_RATE);\n\trxd->rssi = awi_read_1 (sc, cur + AWI_RXD_RSSI);\t\t\n\trxd->index = awi_read_1 (sc, cur + AWI_RXD_INDEX);\n\trxd->frame = awi_read_4 (sc, cur + AWI_RXD_START_FRAME);\n\trxd->rxts = awi_read_4 (sc, cur + AWI_RXD_LOCALTIME);\n\n\t/*\n\t * only the low order bits of \"frame\" and \"next\" are valid.\n\t * (the documentation doesn't mention this).\n\t */\n\trxd->frame &= 0xffff;\n\trxd->next &= (0xffff | AWI_RXD_NEXT_LAST);\n\n\t/*\n\t * XXX after masking, sanity check that rxd->frame and\n\t * rxd->next lie within the receive area.\n\t */\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"nxt %x frame %x state %b len %d\\n\",\n\t\t    rxd->next, rxd->frame,\n\t\t    rxd->state, AWI_RXD_ST_BITS,\n\t\t    rxd->len);\n\t}\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"nxt %x frame %x state %b len %d\\n\"",
            "rxd->next",
            "rxd->frame",
            "rxd->state",
            "AWI_RXD_ST_BITS",
            "rxd->len"
          ],
          "line": 1241
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "cur + AWI_RXD_LOCALTIME"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "cur + AWI_RXD_START_FRAME"
          ],
          "line": 1226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "cur + AWI_RXD_INDEX"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "cur + AWI_RXD_RSSI"
          ],
          "line": 1224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "cur + AWI_RXD_RATE"
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_2",
          "args": [
            "sc",
            "cur + AWI_RXD_LEN"
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "cur + AWI_RXD_HOST_DESC_STATE"
          ],
          "line": 1221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_4",
          "args": [
            "sc",
            "cur + AWI_RXD_NEXT"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_card_hexdump",
          "args": [
            "sc",
            "\"rxd\"",
            "cur",
            "AWI_RXD_SIZE"
          ],
          "line": 1217
        },
        "resolved": true,
        "details": {
          "function_name": "awi_card_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "552-565",
          "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_copy_rxd (sc, cur, rxd)\n\tstruct awi_softc *sc;\n\tu_int32_t cur;\n\tstruct awi_rxd *rxd;\n{\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"%x: \", cur);\n\t\tawi_card_hexdump(sc, \"rxd\", cur, AWI_RXD_SIZE);\n\t}\n\t\n\trxd->next = awi_read_4(sc, cur + AWI_RXD_NEXT);\n\trxd->state = awi_read_1(sc, cur + AWI_RXD_HOST_DESC_STATE);\n\trxd->len = awi_read_2 (sc, cur + AWI_RXD_LEN);\n\trxd->rate = awi_read_1 (sc, cur + AWI_RXD_RATE);\n\trxd->rssi = awi_read_1 (sc, cur + AWI_RXD_RSSI);\t\t\n\trxd->index = awi_read_1 (sc, cur + AWI_RXD_INDEX);\n\trxd->frame = awi_read_4 (sc, cur + AWI_RXD_START_FRAME);\n\trxd->rxts = awi_read_4 (sc, cur + AWI_RXD_LOCALTIME);\n\n\t/*\n\t * only the low order bits of \"frame\" and \"next\" are valid.\n\t * (the documentation doesn't mention this).\n\t */\n\trxd->frame &= 0xffff;\n\trxd->next &= (0xffff | AWI_RXD_NEXT_LAST);\n\n\t/*\n\t * XXX after masking, sanity check that rxd->frame and\n\t * rxd->next lie within the receive area.\n\t */\n\tif (sc->sc_ifp->if_flags & IFF_LINK0) {\n\t\tprintf(\"nxt %x frame %x state %b len %d\\n\",\n\t\t    rxd->next, rxd->frame,\n\t\t    rxd->state, AWI_RXD_ST_BITS,\n\t\t    rxd->len);\n\t}\n}"
  },
  {
    "function_name": "awi_rcv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "1137-1207",
    "snippet": "void\nawi_rcv (sc, m, rxts, rssi)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t *framehdr;\n\tu_int8_t framectl;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * peek at first byte of frame header.\n\t *  check version subfield (must be zero)\n\t *  check type subfield (00 = mgt, 01 = ctl, 10 = data)\n\t *  check subtype field (next four bits)\n\t */\n\n\t/*\n\t * Not counting WDS mode, the IEEE 802.11 frame header format\n\t * has *three* MAC addresses. \n\t * (source, destination, and BSS).\n\t *\n\t * The BSS indicates which wireless \"cable segment\" we're part of;\n\t * we discover this dynamically..\n\t *\n\t * Not content to put them in a fixed order, the exact\n\t * ordering of these addresses depends on other attribute bits\n\t * in the frame control word!\n\t *\n\t * an alternate presentation which is more self-consistent:\n\t * address 1 is the \"wireless destination\" -- either the\n\t * station address,\n\t * for wireless->wireless traffic, or the BSS id of an AP.\n\t *\n\t * address 2 is the \"wireless source\" -- either the\n\t * station address of a wireless node, or the BSS id of an AP.\n\t *\n\t * address 3 is the \"other address\" -- for STA->AP, the\n\t * eventual destination; for AP->STA, the original source, and\n\t * for ad-hoc mode, the BSS id..\n\t */\n\n\tframectl = framehdr[IEEEWL_FC];\n\t\n\tif ((framectl & IEEEWL_FC_VERS_MASK) != IEEEWL_FC_VERS) {\n\t\tprintf(\"wrong vers.  drop\");\n\t\tgoto drop;\n\t}\n\n\tswitch (framectl & IEEEWL_FC_TYPE_MASK) {\n\tcase IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_mgt (sc, m, rxts, rssi);\n\t\tm = 0;\n\t\tbreak;\n\t\t\n\tcase IEEEWL_FC_TYPE_DATA << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_data (sc, m);\n\t\tm = 0;\n\t\tbreak;\n\n\tcase IEEEWL_FC_TYPE_CTL << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_ctl (sc, m);\n\tdefault:\n\t\tgoto drop;\n\t}\n\n drop:\n\tif (m) m_freem(m);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_rcv",
      "void awi_rcv_mgt",
      "void awi_rcv_data",
      "void awi_rcv_ctl"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_rcv_ctl",
          "args": [
            "sc",
            "m"
          ],
          "line": 1200
        },
        "resolved": true,
        "details": {
          "function_name": "awi_rcv_ctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "822-828",
          "snippet": "void\nawi_rcv_ctl (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tprintf(\"%s: ctl\\n\", sc->sc_dev.dv_xname);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_rcv_ctl"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rcv_ctl;\n\nvoid\nawi_rcv_ctl (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tprintf(\"%s: ctl\\n\", sc->sc_dev.dv_xname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_rcv_data",
          "args": [
            "sc",
            "m"
          ],
          "line": 1195
        },
        "resolved": true,
        "details": {
          "function_name": "awi_rcv_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "830-901",
          "snippet": "void\nawi_rcv_data (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int8_t *llc;\n\tu_int8_t *to, *from;\n\tstruct awi_mac_header *amhp;\n\t\n\tsc->sc_scan_timer = awi_scan_keepalive;\t/* user data is as good\n\t\t\t\t   as a beacon as a keepalive.. */\n\n\tamhp = mtod(m, struct awi_mac_header *);\n\t\n\t/*\n\t * we have: 4 bytes useless goo.\n\t *\t    3 x 6 bytes MAC addresses.\n\t *\t    2 bytes goo.\n\t *\t    802.x LLC header, SNAP header, and data.\n\t *\n\t * for now, we fake up a \"normal\" ethernet header and feed\n\t * this to the appropriate input routine.\n\t */\n\n\tllc = (u_int8_t *)(amhp+1);\n\t\n\tif (amhp->awi_f2 & IEEEWL_FC2_TODS) {\n\t\tprintf(\"drop packet to DS\\n\");\n\t\tgoto drop;\n\t}\n\n\tto = amhp->awi_addr1;\n\tif (amhp->awi_f2 & IEEEWL_FC2_FROMDS)\n\t\tfrom = amhp->awi_addr3;\n\telse\n\t\tfrom = amhp->awi_addr2;\n\tif (memcmp (llc, snap_magic, 6) != 0)\n\t\tgoto drop;\n\n\t/* XXX overwrite llc with \"from\" address */\n\t/* XXX overwrite llc-6 with \"to\" address */\n\tbcopy(from, llc, ETHER_ADDR_LEN);\n\tbcopy(to, llc-6, ETHER_ADDR_LEN);\n\t\n\tm_adj(m, sizeof(struct awi_mac_header) + sizeof(struct awi_llc_header) \n\t    - sizeof(struct ether_header));\n\n#if NBPFILTER > 0\n\t/*\n\t * Pass packet to bpf if there is a listener.\n\t */\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n#if __NetBSD_Version__ > 104010000\n\tm->m_flags |= M_HASFCS;\n\t(*ifp->if_input)(ifp, m);\n#else\n\t{\n\t\tstruct ether_header *eh;\n\t\teh = mtod(m, struct ether_header *);\n\t\tm_adj(m, sizeof(*eh));\n\t\tm_adj(m, -ETHER_CRC_LEN);\n\t\tether_input(ifp, eh, m);\n\t}\n#endif\t\n\treturn;\n drop:\n\tm_freem(m);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define ETHER_CRC_LEN 4"
          ],
          "globals_used": [
            "void awi_rcv_data"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define ETHER_CRC_LEN 4\n\nvoid awi_rcv_data;\n\nvoid\nawi_rcv_data (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int8_t *llc;\n\tu_int8_t *to, *from;\n\tstruct awi_mac_header *amhp;\n\t\n\tsc->sc_scan_timer = awi_scan_keepalive;\t/* user data is as good\n\t\t\t\t   as a beacon as a keepalive.. */\n\n\tamhp = mtod(m, struct awi_mac_header *);\n\t\n\t/*\n\t * we have: 4 bytes useless goo.\n\t *\t    3 x 6 bytes MAC addresses.\n\t *\t    2 bytes goo.\n\t *\t    802.x LLC header, SNAP header, and data.\n\t *\n\t * for now, we fake up a \"normal\" ethernet header and feed\n\t * this to the appropriate input routine.\n\t */\n\n\tllc = (u_int8_t *)(amhp+1);\n\t\n\tif (amhp->awi_f2 & IEEEWL_FC2_TODS) {\n\t\tprintf(\"drop packet to DS\\n\");\n\t\tgoto drop;\n\t}\n\n\tto = amhp->awi_addr1;\n\tif (amhp->awi_f2 & IEEEWL_FC2_FROMDS)\n\t\tfrom = amhp->awi_addr3;\n\telse\n\t\tfrom = amhp->awi_addr2;\n\tif (memcmp (llc, snap_magic, 6) != 0)\n\t\tgoto drop;\n\n\t/* XXX overwrite llc with \"from\" address */\n\t/* XXX overwrite llc-6 with \"to\" address */\n\tbcopy(from, llc, ETHER_ADDR_LEN);\n\tbcopy(to, llc-6, ETHER_ADDR_LEN);\n\t\n\tm_adj(m, sizeof(struct awi_mac_header) + sizeof(struct awi_llc_header) \n\t    - sizeof(struct ether_header));\n\n#if NBPFILTER > 0\n\t/*\n\t * Pass packet to bpf if there is a listener.\n\t */\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n#if __NetBSD_Version__ > 104010000\n\tm->m_flags |= M_HASFCS;\n\t(*ifp->if_input)(ifp, m);\n#else\n\t{\n\t\tstruct ether_header *eh;\n\t\teh = mtod(m, struct ether_header *);\n\t\tm_adj(m, sizeof(*eh));\n\t\tm_adj(m, -ETHER_CRC_LEN);\n\t\tether_input(ifp, eh, m);\n\t}\n#endif\t\n\treturn;\n drop:\n\tm_freem(m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_rcv_mgt",
          "args": [
            "sc",
            "m",
            "rxts",
            "rssi"
          ],
          "line": 1190
        },
        "resolved": true,
        "details": {
          "function_name": "awi_rcv_mgt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "903-1126",
          "snippet": "void\nawi_rcv_mgt (sc, m, rxts, rssi) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t subtype;\n\tu_int8_t *framehdr, *mgthdr, *end, *timestamp;\n\tstruct awi_auth_hdr *auhp;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n#define IEEEWL_MGT_NATTR\t\t10 /* XXX */\n\tu_int8_t *attr[IEEEWL_MGT_NATTR];\n\tu_int8_t attrlen[IEEEWL_MGT_NATTR];\t\n\tu_int8_t *addr1, *addr2, *addr3;\n\tu_int8_t *sa, *da, *bss;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * mgt frame:\n\t *  2 bytes frame goo\n\t *  2 bytes duration\n\t *  6 bytes a1\n\t *  6 bytes a2\n\t *  6 bytes a3\n\t *  2 bytes seq control.\n\t * --\n\t * 24 bytes goo.\n\t */\n\t\n\tsubtype = (framehdr[IEEEWL_FC] & IEEEWL_FC_SUBTYPE_MASK)\n\t    >> IEEEWL_FC_SUBTYPE_SHIFT;\n\n\taddr1 = framehdr + 4;\t/* XXX */\n\taddr2 = addr1+ETHER_ADDR_LEN;\n\taddr3 = addr2+ETHER_ADDR_LEN;\n\n\t/* XXX look at to/from DS bits here!! */\n\tda = addr1;\n\tsa = addr3;\n\tbss = addr2;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\tend = framehdr + m->m_len;\n\tend -= 4;\t/* trim TLV */\n\t\t\n\tmgthdr = framehdr + 24;\t/* XXX magic */\n\t\n\tswitch (subtype) {\n\n\tcase IEEEWL_SUBTYPE_ASSOCRESP:\n\t\t/*\n\t\t * this acknowledges that the AP will be forwarding traffic\n\t\t * for us..\n\t\t *\n\t\t * contains:\n\t\t *\tcap info\n\t\t *\tstatus code\n\t\t *\tAId\n\t\t *\tsupported rates.\n\t\t */\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got assoc resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"assocresp\", m->m_data, m->m_len);\n\t\t}\n\t\tawi_drvstate (sc, AWI_DRV_INFASSOC);\n\t\tsc->sc_state = AWI_ST_RUNNING;\n\t\tsc->sc_mgt_timer = AWI_ASSOC_REFRESH;\n\t\tawi_set_timer(sc);\n\t\tif (sc->sc_new_bss) {\n\t\t\tprintf(\"%s: associated with %s, SSID: %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(sc->sc_active_bss.bss_id),\n\t\t\t    sc->sc_active_bss.ssid);\n\t\t\tsc->sc_new_bss = 0;\n\t\t}\n\t\t\n\t\t/* XXX set media status to \"i see carrier\" */\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_REASSOCRESP:\n\t\t/*\n\t\t * this indicates that we've moved from one AP to another\n\t\t * within the same DS.\n\t\t */\n\t\tprintf(\"reassoc_resp\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_PROBEREQ:\n\t\t/* discard */\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_PROBERESP:\n\t\t/*\n\t\t * 8 bytes timestamp.\n\t\t * 2 bytes beacon intvl.\n\t\t * 2 bytes cap info.\n\t\t * then tlv data..\n\t\t */\n\t\ttimestamp = mgthdr;\n\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got probe resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"proberesp\", m->m_data, m->m_len);\n\t\t}\n\t\t/* now, into the tlv goo.. */\n\t\tmgthdr += 12;\t/* XXX magic */\n\t\tawi_parse_tlv (mgthdr, end, attr, attrlen, IEEEWL_MGT_NATTR);\n\n\t\tif (attr[IEEEWL_MGT_TLV_SSID] &&\n\t\t    attr[IEEEWL_MGT_TLV_FHPARMS] &&\n\t\t    attrlen[IEEEWL_MGT_TLV_SSID] < AWI_SSID_LEN) { \n\t\t\tstruct awi_bss_binding *bp = NULL;\n\t\t\tint i;\n\t\t\t\n\t\t\tfor (i=0; i< sc->sc_nbindings; i++) {\n\t\t\t\tstruct awi_bss_binding *bp1 =\n\t\t\t\t    &sc->sc_bindings[i];\n\t\t\t\tif (memcmp(bp1->bss_id, bss, ETHER_ADDR_LEN) == 0) {\n\t\t\t\t\tbp = bp1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (bp == NULL && sc->sc_nbindings < NBND) {\n\t\t\t\tbp = &sc->sc_bindings[sc->sc_nbindings++];\n\t\t\t}\n\t\t\tif (bp != NULL) {\n\t\t\t\tu_int8_t *fhparms =\n\t\t\t\t    attr[IEEEWL_MGT_TLV_FHPARMS];\n\t\t\t\t\n\t\t\t\tbp->sslen = attrlen[IEEEWL_MGT_TLV_SSID];\n\t\t\t\t\n\t\t\t\tbcopy(attr[IEEEWL_MGT_TLV_SSID], bp->ssid,\n\t\t\t\t      bp->sslen);\n\t\t\t\tbp->ssid[bp->sslen] = 0;\n\n\t\t\t\tbcopy(bss, bp->bss_id, ETHER_ADDR_LEN);\n\t\t\t\t\n\t\t\t\t/* XXX more magic numbers.. */\n\t\t\t\tbp->dwell_time = fhparms[0] | (fhparms[1]<<8);\n\t\t\t\tbp->chanset = fhparms[2];\n\t\t\t\tbp->pattern = fhparms[3];\n\t\t\t\tbp->index = fhparms[4];\n\t\t\t\tbp->rssi = rssi;\n\t\t\t\tbp->rxtime = rxts;\n\t\t\t\tbcopy(timestamp, bp->bss_timestamp, 8);\n\t\t\t}\n\t\t}\n\t\t\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_BEACON:\n\t\tif ((ifp->if_flags & (IFF_DEBUG|IFF_LINK2)) ==\n\t\t    (IFF_DEBUG|IFF_LINK2)) {\n\t\t\tprintf(\"%s: beacon from %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(addr2));\n\t\t\tawi_hexdump(\"beacon\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * Note that AP is still alive so we don't have to go looking\n\t\t * for one for a while.\n\t\t *\n\t\t * XXX Beacons from other AP's should be recorded for\n\t\t * potential use if we lose this AP..  (also, may want\n\t\t * to notice if rssi of new AP is significantly\n\t\t * stronger than old one and jump ship..)\n\t\t */\n\t\tif ((sc->sc_state >= AWI_ST_SYNCED) &&\n\t\t    (memcmp (addr2, sc->sc_active_bss.bss_id,\n\t\t\tETHER_ADDR_LEN) == 0)) {\n\t\t\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\t\tawi_set_timer(sc);\n\t\t}\n\t\t\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DISSOC:\n\t\tprintf(\"dissoc\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_AUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got auth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"auth\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * woohoo!  somebody likes us!\n\t\t */\n\n\t\tauhp = (struct awi_auth_hdr *)mgthdr;\n\n\t\tif ((auhp->awi_status[0] == 0) && (auhp->awi_status[1] == 0))\n\t\t{\n\t\t\tawi_drvstate (sc, AWI_DRV_INFAUTH);\n\t\t\tsc->sc_state = AWI_ST_AUTHED;\n\t\t\tawi_send_assocreq (sc);\n\t\t}\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DEAUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got deauth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"deauth\", m->m_data, m->m_len);\n\t\t}\n\t\tsc->sc_state = AWI_ST_SYNCED;\n\t\tsc->sc_new_bss = 1;\n\t\tawi_send_authreq(sc);\n\t\tbreak;\n\tdefault:\n\t\tprintf(\"unk mgt subtype %x\\n\", subtype);\n\t\tbreak;\n\t}\n\tm_freem(m);\t\t/* done.. */\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define IEEEWL_MGT_NATTR\t\t10 /* XXX */"
          ],
          "globals_used": [
            "void awi_rcv_mgt",
            "void awi_send_authreq",
            "void awi_send_assocreq",
            "void awi_parse_tlv"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define IEEEWL_MGT_NATTR\t\t10 /* XXX */\n\nvoid awi_rcv_mgt;\nvoid awi_send_authreq;\nvoid awi_send_assocreq;\nvoid awi_parse_tlv;\n\nvoid\nawi_rcv_mgt (sc, m, rxts, rssi) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t subtype;\n\tu_int8_t *framehdr, *mgthdr, *end, *timestamp;\n\tstruct awi_auth_hdr *auhp;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n#define IEEEWL_MGT_NATTR\t\t10 /* XXX */\n\tu_int8_t *attr[IEEEWL_MGT_NATTR];\n\tu_int8_t attrlen[IEEEWL_MGT_NATTR];\t\n\tu_int8_t *addr1, *addr2, *addr3;\n\tu_int8_t *sa, *da, *bss;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * mgt frame:\n\t *  2 bytes frame goo\n\t *  2 bytes duration\n\t *  6 bytes a1\n\t *  6 bytes a2\n\t *  6 bytes a3\n\t *  2 bytes seq control.\n\t * --\n\t * 24 bytes goo.\n\t */\n\t\n\tsubtype = (framehdr[IEEEWL_FC] & IEEEWL_FC_SUBTYPE_MASK)\n\t    >> IEEEWL_FC_SUBTYPE_SHIFT;\n\n\taddr1 = framehdr + 4;\t/* XXX */\n\taddr2 = addr1+ETHER_ADDR_LEN;\n\taddr3 = addr2+ETHER_ADDR_LEN;\n\n\t/* XXX look at to/from DS bits here!! */\n\tda = addr1;\n\tsa = addr3;\n\tbss = addr2;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\tend = framehdr + m->m_len;\n\tend -= 4;\t/* trim TLV */\n\t\t\n\tmgthdr = framehdr + 24;\t/* XXX magic */\n\t\n\tswitch (subtype) {\n\n\tcase IEEEWL_SUBTYPE_ASSOCRESP:\n\t\t/*\n\t\t * this acknowledges that the AP will be forwarding traffic\n\t\t * for us..\n\t\t *\n\t\t * contains:\n\t\t *\tcap info\n\t\t *\tstatus code\n\t\t *\tAId\n\t\t *\tsupported rates.\n\t\t */\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got assoc resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"assocresp\", m->m_data, m->m_len);\n\t\t}\n\t\tawi_drvstate (sc, AWI_DRV_INFASSOC);\n\t\tsc->sc_state = AWI_ST_RUNNING;\n\t\tsc->sc_mgt_timer = AWI_ASSOC_REFRESH;\n\t\tawi_set_timer(sc);\n\t\tif (sc->sc_new_bss) {\n\t\t\tprintf(\"%s: associated with %s, SSID: %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(sc->sc_active_bss.bss_id),\n\t\t\t    sc->sc_active_bss.ssid);\n\t\t\tsc->sc_new_bss = 0;\n\t\t}\n\t\t\n\t\t/* XXX set media status to \"i see carrier\" */\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_REASSOCRESP:\n\t\t/*\n\t\t * this indicates that we've moved from one AP to another\n\t\t * within the same DS.\n\t\t */\n\t\tprintf(\"reassoc_resp\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_PROBEREQ:\n\t\t/* discard */\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_PROBERESP:\n\t\t/*\n\t\t * 8 bytes timestamp.\n\t\t * 2 bytes beacon intvl.\n\t\t * 2 bytes cap info.\n\t\t * then tlv data..\n\t\t */\n\t\ttimestamp = mgthdr;\n\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got probe resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"proberesp\", m->m_data, m->m_len);\n\t\t}\n\t\t/* now, into the tlv goo.. */\n\t\tmgthdr += 12;\t/* XXX magic */\n\t\tawi_parse_tlv (mgthdr, end, attr, attrlen, IEEEWL_MGT_NATTR);\n\n\t\tif (attr[IEEEWL_MGT_TLV_SSID] &&\n\t\t    attr[IEEEWL_MGT_TLV_FHPARMS] &&\n\t\t    attrlen[IEEEWL_MGT_TLV_SSID] < AWI_SSID_LEN) { \n\t\t\tstruct awi_bss_binding *bp = NULL;\n\t\t\tint i;\n\t\t\t\n\t\t\tfor (i=0; i< sc->sc_nbindings; i++) {\n\t\t\t\tstruct awi_bss_binding *bp1 =\n\t\t\t\t    &sc->sc_bindings[i];\n\t\t\t\tif (memcmp(bp1->bss_id, bss, ETHER_ADDR_LEN) == 0) {\n\t\t\t\t\tbp = bp1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (bp == NULL && sc->sc_nbindings < NBND) {\n\t\t\t\tbp = &sc->sc_bindings[sc->sc_nbindings++];\n\t\t\t}\n\t\t\tif (bp != NULL) {\n\t\t\t\tu_int8_t *fhparms =\n\t\t\t\t    attr[IEEEWL_MGT_TLV_FHPARMS];\n\t\t\t\t\n\t\t\t\tbp->sslen = attrlen[IEEEWL_MGT_TLV_SSID];\n\t\t\t\t\n\t\t\t\tbcopy(attr[IEEEWL_MGT_TLV_SSID], bp->ssid,\n\t\t\t\t      bp->sslen);\n\t\t\t\tbp->ssid[bp->sslen] = 0;\n\n\t\t\t\tbcopy(bss, bp->bss_id, ETHER_ADDR_LEN);\n\t\t\t\t\n\t\t\t\t/* XXX more magic numbers.. */\n\t\t\t\tbp->dwell_time = fhparms[0] | (fhparms[1]<<8);\n\t\t\t\tbp->chanset = fhparms[2];\n\t\t\t\tbp->pattern = fhparms[3];\n\t\t\t\tbp->index = fhparms[4];\n\t\t\t\tbp->rssi = rssi;\n\t\t\t\tbp->rxtime = rxts;\n\t\t\t\tbcopy(timestamp, bp->bss_timestamp, 8);\n\t\t\t}\n\t\t}\n\t\t\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_BEACON:\n\t\tif ((ifp->if_flags & (IFF_DEBUG|IFF_LINK2)) ==\n\t\t    (IFF_DEBUG|IFF_LINK2)) {\n\t\t\tprintf(\"%s: beacon from %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(addr2));\n\t\t\tawi_hexdump(\"beacon\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * Note that AP is still alive so we don't have to go looking\n\t\t * for one for a while.\n\t\t *\n\t\t * XXX Beacons from other AP's should be recorded for\n\t\t * potential use if we lose this AP..  (also, may want\n\t\t * to notice if rssi of new AP is significantly\n\t\t * stronger than old one and jump ship..)\n\t\t */\n\t\tif ((sc->sc_state >= AWI_ST_SYNCED) &&\n\t\t    (memcmp (addr2, sc->sc_active_bss.bss_id,\n\t\t\tETHER_ADDR_LEN) == 0)) {\n\t\t\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\t\tawi_set_timer(sc);\n\t\t}\n\t\t\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DISSOC:\n\t\tprintf(\"dissoc\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_AUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got auth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"auth\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * woohoo!  somebody likes us!\n\t\t */\n\n\t\tauhp = (struct awi_auth_hdr *)mgthdr;\n\n\t\tif ((auhp->awi_status[0] == 0) && (auhp->awi_status[1] == 0))\n\t\t{\n\t\t\tawi_drvstate (sc, AWI_DRV_INFAUTH);\n\t\t\tsc->sc_state = AWI_ST_AUTHED;\n\t\t\tawi_send_assocreq (sc);\n\t\t}\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DEAUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got deauth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"deauth\", m->m_data, m->m_len);\n\t\t}\n\t\tsc->sc_state = AWI_ST_SYNCED;\n\t\tsc->sc_new_bss = 1;\n\t\tawi_send_authreq(sc);\n\t\tbreak;\n\tdefault:\n\t\tprintf(\"unk mgt subtype %x\\n\", subtype);\n\t\tbreak;\n\t}\n\tm_freem(m);\t\t/* done.. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"wrong vers.  drop\""
          ],
          "line": 1184
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "u_int8_t*"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rcv;\nvoid awi_rcv_mgt;\nvoid awi_rcv_data;\nvoid awi_rcv_ctl;\n\nvoid\nawi_rcv (sc, m, rxts, rssi)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t *framehdr;\n\tu_int8_t framectl;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * peek at first byte of frame header.\n\t *  check version subfield (must be zero)\n\t *  check type subfield (00 = mgt, 01 = ctl, 10 = data)\n\t *  check subtype field (next four bits)\n\t */\n\n\t/*\n\t * Not counting WDS mode, the IEEE 802.11 frame header format\n\t * has *three* MAC addresses. \n\t * (source, destination, and BSS).\n\t *\n\t * The BSS indicates which wireless \"cable segment\" we're part of;\n\t * we discover this dynamically..\n\t *\n\t * Not content to put them in a fixed order, the exact\n\t * ordering of these addresses depends on other attribute bits\n\t * in the frame control word!\n\t *\n\t * an alternate presentation which is more self-consistent:\n\t * address 1 is the \"wireless destination\" -- either the\n\t * station address,\n\t * for wireless->wireless traffic, or the BSS id of an AP.\n\t *\n\t * address 2 is the \"wireless source\" -- either the\n\t * station address of a wireless node, or the BSS id of an AP.\n\t *\n\t * address 3 is the \"other address\" -- for STA->AP, the\n\t * eventual destination; for AP->STA, the original source, and\n\t * for ad-hoc mode, the BSS id..\n\t */\n\n\tframectl = framehdr[IEEEWL_FC];\n\t\n\tif ((framectl & IEEEWL_FC_VERS_MASK) != IEEEWL_FC_VERS) {\n\t\tprintf(\"wrong vers.  drop\");\n\t\tgoto drop;\n\t}\n\n\tswitch (framectl & IEEEWL_FC_TYPE_MASK) {\n\tcase IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_mgt (sc, m, rxts, rssi);\n\t\tm = 0;\n\t\tbreak;\n\t\t\n\tcase IEEEWL_FC_TYPE_DATA << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_data (sc, m);\n\t\tm = 0;\n\t\tbreak;\n\n\tcase IEEEWL_FC_TYPE_CTL << IEEEWL_FC_TYPE_SHIFT:\n\t\tawi_rcv_ctl (sc, m);\n\tdefault:\n\t\tgoto drop;\n\t}\n\n drop:\n\tif (m) m_freem(m);\n}"
  },
  {
    "function_name": "awi_rcv_mgt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "903-1126",
    "snippet": "void\nawi_rcv_mgt (sc, m, rxts, rssi) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t subtype;\n\tu_int8_t *framehdr, *mgthdr, *end, *timestamp;\n\tstruct awi_auth_hdr *auhp;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n#define IEEEWL_MGT_NATTR\t\t10 /* XXX */\n\tu_int8_t *attr[IEEEWL_MGT_NATTR];\n\tu_int8_t attrlen[IEEEWL_MGT_NATTR];\t\n\tu_int8_t *addr1, *addr2, *addr3;\n\tu_int8_t *sa, *da, *bss;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * mgt frame:\n\t *  2 bytes frame goo\n\t *  2 bytes duration\n\t *  6 bytes a1\n\t *  6 bytes a2\n\t *  6 bytes a3\n\t *  2 bytes seq control.\n\t * --\n\t * 24 bytes goo.\n\t */\n\t\n\tsubtype = (framehdr[IEEEWL_FC] & IEEEWL_FC_SUBTYPE_MASK)\n\t    >> IEEEWL_FC_SUBTYPE_SHIFT;\n\n\taddr1 = framehdr + 4;\t/* XXX */\n\taddr2 = addr1+ETHER_ADDR_LEN;\n\taddr3 = addr2+ETHER_ADDR_LEN;\n\n\t/* XXX look at to/from DS bits here!! */\n\tda = addr1;\n\tsa = addr3;\n\tbss = addr2;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\tend = framehdr + m->m_len;\n\tend -= 4;\t/* trim TLV */\n\t\t\n\tmgthdr = framehdr + 24;\t/* XXX magic */\n\t\n\tswitch (subtype) {\n\n\tcase IEEEWL_SUBTYPE_ASSOCRESP:\n\t\t/*\n\t\t * this acknowledges that the AP will be forwarding traffic\n\t\t * for us..\n\t\t *\n\t\t * contains:\n\t\t *\tcap info\n\t\t *\tstatus code\n\t\t *\tAId\n\t\t *\tsupported rates.\n\t\t */\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got assoc resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"assocresp\", m->m_data, m->m_len);\n\t\t}\n\t\tawi_drvstate (sc, AWI_DRV_INFASSOC);\n\t\tsc->sc_state = AWI_ST_RUNNING;\n\t\tsc->sc_mgt_timer = AWI_ASSOC_REFRESH;\n\t\tawi_set_timer(sc);\n\t\tif (sc->sc_new_bss) {\n\t\t\tprintf(\"%s: associated with %s, SSID: %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(sc->sc_active_bss.bss_id),\n\t\t\t    sc->sc_active_bss.ssid);\n\t\t\tsc->sc_new_bss = 0;\n\t\t}\n\t\t\n\t\t/* XXX set media status to \"i see carrier\" */\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_REASSOCRESP:\n\t\t/*\n\t\t * this indicates that we've moved from one AP to another\n\t\t * within the same DS.\n\t\t */\n\t\tprintf(\"reassoc_resp\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_PROBEREQ:\n\t\t/* discard */\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_PROBERESP:\n\t\t/*\n\t\t * 8 bytes timestamp.\n\t\t * 2 bytes beacon intvl.\n\t\t * 2 bytes cap info.\n\t\t * then tlv data..\n\t\t */\n\t\ttimestamp = mgthdr;\n\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got probe resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"proberesp\", m->m_data, m->m_len);\n\t\t}\n\t\t/* now, into the tlv goo.. */\n\t\tmgthdr += 12;\t/* XXX magic */\n\t\tawi_parse_tlv (mgthdr, end, attr, attrlen, IEEEWL_MGT_NATTR);\n\n\t\tif (attr[IEEEWL_MGT_TLV_SSID] &&\n\t\t    attr[IEEEWL_MGT_TLV_FHPARMS] &&\n\t\t    attrlen[IEEEWL_MGT_TLV_SSID] < AWI_SSID_LEN) { \n\t\t\tstruct awi_bss_binding *bp = NULL;\n\t\t\tint i;\n\t\t\t\n\t\t\tfor (i=0; i< sc->sc_nbindings; i++) {\n\t\t\t\tstruct awi_bss_binding *bp1 =\n\t\t\t\t    &sc->sc_bindings[i];\n\t\t\t\tif (memcmp(bp1->bss_id, bss, ETHER_ADDR_LEN) == 0) {\n\t\t\t\t\tbp = bp1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (bp == NULL && sc->sc_nbindings < NBND) {\n\t\t\t\tbp = &sc->sc_bindings[sc->sc_nbindings++];\n\t\t\t}\n\t\t\tif (bp != NULL) {\n\t\t\t\tu_int8_t *fhparms =\n\t\t\t\t    attr[IEEEWL_MGT_TLV_FHPARMS];\n\t\t\t\t\n\t\t\t\tbp->sslen = attrlen[IEEEWL_MGT_TLV_SSID];\n\t\t\t\t\n\t\t\t\tbcopy(attr[IEEEWL_MGT_TLV_SSID], bp->ssid,\n\t\t\t\t      bp->sslen);\n\t\t\t\tbp->ssid[bp->sslen] = 0;\n\n\t\t\t\tbcopy(bss, bp->bss_id, ETHER_ADDR_LEN);\n\t\t\t\t\n\t\t\t\t/* XXX more magic numbers.. */\n\t\t\t\tbp->dwell_time = fhparms[0] | (fhparms[1]<<8);\n\t\t\t\tbp->chanset = fhparms[2];\n\t\t\t\tbp->pattern = fhparms[3];\n\t\t\t\tbp->index = fhparms[4];\n\t\t\t\tbp->rssi = rssi;\n\t\t\t\tbp->rxtime = rxts;\n\t\t\t\tbcopy(timestamp, bp->bss_timestamp, 8);\n\t\t\t}\n\t\t}\n\t\t\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_BEACON:\n\t\tif ((ifp->if_flags & (IFF_DEBUG|IFF_LINK2)) ==\n\t\t    (IFF_DEBUG|IFF_LINK2)) {\n\t\t\tprintf(\"%s: beacon from %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(addr2));\n\t\t\tawi_hexdump(\"beacon\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * Note that AP is still alive so we don't have to go looking\n\t\t * for one for a while.\n\t\t *\n\t\t * XXX Beacons from other AP's should be recorded for\n\t\t * potential use if we lose this AP..  (also, may want\n\t\t * to notice if rssi of new AP is significantly\n\t\t * stronger than old one and jump ship..)\n\t\t */\n\t\tif ((sc->sc_state >= AWI_ST_SYNCED) &&\n\t\t    (memcmp (addr2, sc->sc_active_bss.bss_id,\n\t\t\tETHER_ADDR_LEN) == 0)) {\n\t\t\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\t\tawi_set_timer(sc);\n\t\t}\n\t\t\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DISSOC:\n\t\tprintf(\"dissoc\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_AUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got auth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"auth\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * woohoo!  somebody likes us!\n\t\t */\n\n\t\tauhp = (struct awi_auth_hdr *)mgthdr;\n\n\t\tif ((auhp->awi_status[0] == 0) && (auhp->awi_status[1] == 0))\n\t\t{\n\t\t\tawi_drvstate (sc, AWI_DRV_INFAUTH);\n\t\t\tsc->sc_state = AWI_ST_AUTHED;\n\t\t\tawi_send_assocreq (sc);\n\t\t}\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DEAUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got deauth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"deauth\", m->m_data, m->m_len);\n\t\t}\n\t\tsc->sc_state = AWI_ST_SYNCED;\n\t\tsc->sc_new_bss = 1;\n\t\tawi_send_authreq(sc);\n\t\tbreak;\n\tdefault:\n\t\tprintf(\"unk mgt subtype %x\\n\", subtype);\n\t\tbreak;\n\t}\n\tm_freem(m);\t\t/* done.. */\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define IEEEWL_MGT_NATTR\t\t10 /* XXX */"
    ],
    "globals_used": [
      "void awi_rcv_mgt",
      "void awi_send_authreq",
      "void awi_send_assocreq",
      "void awi_parse_tlv"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"unk mgt subtype %x\\n\"",
            "subtype"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_send_authreq",
          "args": [
            "sc"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "awi_send_authreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "681-739",
          "snippet": "void\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_send_frame",
            "void awi_send_authreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_send_frame;\nvoid awi_send_authreq;\n\nvoid\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_hexdump",
          "args": [
            "\"deauth\"",
            "m->m_data",
            "m->m_len"
          ],
          "line": 1115
        },
        "resolved": true,
        "details": {
          "function_name": "awi_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "541-550",
          "snippet": "void awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_send_assocreq",
          "args": [
            "sc"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "awi_send_assocreq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "741-791",
          "snippet": "void\nawi_send_assocreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_assoc_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\t/* \n\t * cap info (2 bytes)\n\t * listen interval\t(2 bytes)\n\t * ssid\t\t\t(variable)\n\t * supported rates\t(variable)\n\t */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    IEEEWL_FC_TYPE_MGT, IEEEWL_SUBTYPE_ASSOCREQ);\n\n\tamahp->awi_cap_info[0] = 4; /* XXX magic (CF-pollable) */\n\tamahp->awi_cap_info[1] = 0;\n\tamahp->awi_li[0] = 1;\n\tamahp->awi_li[1] = 0;\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending assoc request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\t\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_send_frame",
            "void awi_send_assocreq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_send_frame;\nvoid awi_send_assocreq;\n\nvoid\nawi_send_assocreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_assoc_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\t/* \n\t * cap info (2 bytes)\n\t * listen interval\t(2 bytes)\n\t * ssid\t\t\t(variable)\n\t * supported rates\t(variable)\n\t */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    IEEEWL_FC_TYPE_MGT, IEEEWL_SUBTYPE_ASSOCREQ);\n\n\tamahp->awi_cap_info[0] = 4; /* XXX magic (CF-pollable) */\n\tamahp->awi_cap_info[1] = 0;\n\tamahp->awi_li[0] = 1;\n\tamahp->awi_li[1] = 0;\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending assoc request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_drvstate",
          "args": [
            "sc",
            "AWI_DRV_INFAUTH"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_set_timer",
          "args": [
            "sc"
          ],
          "line": 1081
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "267-274",
          "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "addr2",
            "sc->sc_active_bss.bss_id",
            "ETHER_ADDR_LEN"
          ],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ether_sprintf",
          "args": [
            "addr2"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bcopy",
          "args": [
            "timestamp",
            "bp->bss_timestamp",
            "8"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "tr_bcopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/tropic.c",
          "lines": "1618-1663",
          "snippet": "void \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}",
          "includes": [
            "#include <dev/ic/tropicvar.h>",
            "#include <dev/ic/tropicreg.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <net/if_token.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_media.h>",
            "#include <net/if_llc.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/syslog.h>",
            "#include <sys/socket.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void\ttr_bcopy",
            "struct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/tropicvar.h>\n#include <dev/ic/tropicreg.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <net/if_token.h>\n#include <netinet/in_var.h>\n#include <netinet/ip.h>\n#include <netinet/if_ether.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_media.h>\n#include <net/if_llc.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/syslog.h>\n#include <sys/socket.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\ttr_bcopy;\nstruct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;\n\nvoid \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "bp1->bss_id",
            "bss",
            "ETHER_ADDR_LEN"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_parse_tlv",
          "args": [
            "mgthdr",
            "end",
            "attr",
            "attrlen",
            "IEEEWL_MGT_NATTR"
          ],
          "line": 1015
        },
        "resolved": true,
        "details": {
          "function_name": "awi_parse_tlv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "587-611",
          "snippet": "void\nawi_parse_tlv (u_int8_t *base, u_int8_t *end, u_int8_t **vals, u_int8_t *lens, size_t nattr)\n{\n\tu_int8_t tag, len;\n\n\tint i;\n\t\n\tfor (i=0; i<nattr; i++) {\n\t\tvals[i] = NULL;\n\t\tlens[i] = 0;\n\t}\n\t\n\twhile (base < end) {\n\t\ttag = base[0];\n\t\tlen = base[1];\n\n\t\tbase += 2;\n\t\t\n\t\tif (tag < nattr) {\n\t\t\tlens[tag] = len;\n\t\t\tvals[tag] = base;\n\t\t}\n\t\tbase += len;\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_parse_tlv"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_parse_tlv;\n\nvoid\nawi_parse_tlv (u_int8_t *base, u_int8_t *end, u_int8_t **vals, u_int8_t *lens, size_t nattr)\n{\n\tu_int8_t tag, len;\n\n\tint i;\n\t\n\tfor (i=0; i<nattr; i++) {\n\t\tvals[i] = NULL;\n\t\tlens[i] = 0;\n\t}\n\t\n\twhile (base < end) {\n\t\ttag = base[0];\n\t\tlen = base[1];\n\n\t\tbase += 2;\n\t\t\n\t\tif (tag < nattr) {\n\t\t\tlens[tag] = len;\n\t\t\tvals[tag] = base;\n\t\t}\n\t\tbase += len;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ether_sprintf",
          "args": [
            "sc->sc_active_bss.bss_id"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_drvstate",
          "args": [
            "sc",
            "AWI_DRV_INFASSOC"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "u_int8_t*"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "u_int8_t*"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define IEEEWL_MGT_NATTR\t\t10 /* XXX */\n\nvoid awi_rcv_mgt;\nvoid awi_send_authreq;\nvoid awi_send_assocreq;\nvoid awi_parse_tlv;\n\nvoid\nawi_rcv_mgt (sc, m, rxts, rssi) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n\tu_int32_t rxts;\n\tu_int8_t rssi;\n{\n\tu_int8_t subtype;\n\tu_int8_t *framehdr, *mgthdr, *end, *timestamp;\n\tstruct awi_auth_hdr *auhp;\n\tstruct ifnet *ifp = sc->sc_ifp;\n\t\n#define IEEEWL_MGT_NATTR\t\t10 /* XXX */\n\tu_int8_t *attr[IEEEWL_MGT_NATTR];\n\tu_int8_t attrlen[IEEEWL_MGT_NATTR];\t\n\tu_int8_t *addr1, *addr2, *addr3;\n\tu_int8_t *sa, *da, *bss;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\n\t/*\n\t * mgt frame:\n\t *  2 bytes frame goo\n\t *  2 bytes duration\n\t *  6 bytes a1\n\t *  6 bytes a2\n\t *  6 bytes a3\n\t *  2 bytes seq control.\n\t * --\n\t * 24 bytes goo.\n\t */\n\t\n\tsubtype = (framehdr[IEEEWL_FC] & IEEEWL_FC_SUBTYPE_MASK)\n\t    >> IEEEWL_FC_SUBTYPE_SHIFT;\n\n\taddr1 = framehdr + 4;\t/* XXX */\n\taddr2 = addr1+ETHER_ADDR_LEN;\n\taddr3 = addr2+ETHER_ADDR_LEN;\n\n\t/* XXX look at to/from DS bits here!! */\n\tda = addr1;\n\tsa = addr3;\n\tbss = addr2;\n\t\n\tframehdr = mtod(m, u_int8_t *);\n\tend = framehdr + m->m_len;\n\tend -= 4;\t/* trim TLV */\n\t\t\n\tmgthdr = framehdr + 24;\t/* XXX magic */\n\t\n\tswitch (subtype) {\n\n\tcase IEEEWL_SUBTYPE_ASSOCRESP:\n\t\t/*\n\t\t * this acknowledges that the AP will be forwarding traffic\n\t\t * for us..\n\t\t *\n\t\t * contains:\n\t\t *\tcap info\n\t\t *\tstatus code\n\t\t *\tAId\n\t\t *\tsupported rates.\n\t\t */\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got assoc resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"assocresp\", m->m_data, m->m_len);\n\t\t}\n\t\tawi_drvstate (sc, AWI_DRV_INFASSOC);\n\t\tsc->sc_state = AWI_ST_RUNNING;\n\t\tsc->sc_mgt_timer = AWI_ASSOC_REFRESH;\n\t\tawi_set_timer(sc);\n\t\tif (sc->sc_new_bss) {\n\t\t\tprintf(\"%s: associated with %s, SSID: %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(sc->sc_active_bss.bss_id),\n\t\t\t    sc->sc_active_bss.ssid);\n\t\t\tsc->sc_new_bss = 0;\n\t\t}\n\t\t\n\t\t/* XXX set media status to \"i see carrier\" */\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_REASSOCRESP:\n\t\t/*\n\t\t * this indicates that we've moved from one AP to another\n\t\t * within the same DS.\n\t\t */\n\t\tprintf(\"reassoc_resp\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_PROBEREQ:\n\t\t/* discard */\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_PROBERESP:\n\t\t/*\n\t\t * 8 bytes timestamp.\n\t\t * 2 bytes beacon intvl.\n\t\t * 2 bytes cap info.\n\t\t * then tlv data..\n\t\t */\n\t\ttimestamp = mgthdr;\n\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got probe resp\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"proberesp\", m->m_data, m->m_len);\n\t\t}\n\t\t/* now, into the tlv goo.. */\n\t\tmgthdr += 12;\t/* XXX magic */\n\t\tawi_parse_tlv (mgthdr, end, attr, attrlen, IEEEWL_MGT_NATTR);\n\n\t\tif (attr[IEEEWL_MGT_TLV_SSID] &&\n\t\t    attr[IEEEWL_MGT_TLV_FHPARMS] &&\n\t\t    attrlen[IEEEWL_MGT_TLV_SSID] < AWI_SSID_LEN) { \n\t\t\tstruct awi_bss_binding *bp = NULL;\n\t\t\tint i;\n\t\t\t\n\t\t\tfor (i=0; i< sc->sc_nbindings; i++) {\n\t\t\t\tstruct awi_bss_binding *bp1 =\n\t\t\t\t    &sc->sc_bindings[i];\n\t\t\t\tif (memcmp(bp1->bss_id, bss, ETHER_ADDR_LEN) == 0) {\n\t\t\t\t\tbp = bp1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (bp == NULL && sc->sc_nbindings < NBND) {\n\t\t\t\tbp = &sc->sc_bindings[sc->sc_nbindings++];\n\t\t\t}\n\t\t\tif (bp != NULL) {\n\t\t\t\tu_int8_t *fhparms =\n\t\t\t\t    attr[IEEEWL_MGT_TLV_FHPARMS];\n\t\t\t\t\n\t\t\t\tbp->sslen = attrlen[IEEEWL_MGT_TLV_SSID];\n\t\t\t\t\n\t\t\t\tbcopy(attr[IEEEWL_MGT_TLV_SSID], bp->ssid,\n\t\t\t\t      bp->sslen);\n\t\t\t\tbp->ssid[bp->sslen] = 0;\n\n\t\t\t\tbcopy(bss, bp->bss_id, ETHER_ADDR_LEN);\n\t\t\t\t\n\t\t\t\t/* XXX more magic numbers.. */\n\t\t\t\tbp->dwell_time = fhparms[0] | (fhparms[1]<<8);\n\t\t\t\tbp->chanset = fhparms[2];\n\t\t\t\tbp->pattern = fhparms[3];\n\t\t\t\tbp->index = fhparms[4];\n\t\t\t\tbp->rssi = rssi;\n\t\t\t\tbp->rxtime = rxts;\n\t\t\t\tbcopy(timestamp, bp->bss_timestamp, 8);\n\t\t\t}\n\t\t}\n\t\t\n\t\tbreak;\n\n\tcase IEEEWL_SUBTYPE_BEACON:\n\t\tif ((ifp->if_flags & (IFF_DEBUG|IFF_LINK2)) ==\n\t\t    (IFF_DEBUG|IFF_LINK2)) {\n\t\t\tprintf(\"%s: beacon from %s\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    ether_sprintf(addr2));\n\t\t\tawi_hexdump(\"beacon\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * Note that AP is still alive so we don't have to go looking\n\t\t * for one for a while.\n\t\t *\n\t\t * XXX Beacons from other AP's should be recorded for\n\t\t * potential use if we lose this AP..  (also, may want\n\t\t * to notice if rssi of new AP is significantly\n\t\t * stronger than old one and jump ship..)\n\t\t */\n\t\tif ((sc->sc_state >= AWI_ST_SYNCED) &&\n\t\t    (memcmp (addr2, sc->sc_active_bss.bss_id,\n\t\t\tETHER_ADDR_LEN) == 0)) {\n\t\t\tsc->sc_scan_timer = awi_scan_keepalive;\n\t\t\tawi_set_timer(sc);\n\t\t}\n\t\t\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DISSOC:\n\t\tprintf(\"dissoc\\n\");\n\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_AUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got auth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"auth\", m->m_data, m->m_len);\n\t\t}\n\t\t/*\n\t\t * woohoo!  somebody likes us!\n\t\t */\n\n\t\tauhp = (struct awi_auth_hdr *)mgthdr;\n\n\t\tif ((auhp->awi_status[0] == 0) && (auhp->awi_status[1] == 0))\n\t\t{\n\t\t\tawi_drvstate (sc, AWI_DRV_INFAUTH);\n\t\t\tsc->sc_state = AWI_ST_AUTHED;\n\t\t\tawi_send_assocreq (sc);\n\t\t}\n\t\tbreak;\n\t\t\n\tcase IEEEWL_SUBTYPE_DEAUTH:\n\t\tif (ifp->if_flags & IFF_DEBUG) {\n\t\t\tprintf(\"%s: got deauth\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tawi_hexdump(\"deauth\", m->m_data, m->m_len);\n\t\t}\n\t\tsc->sc_state = AWI_ST_SYNCED;\n\t\tsc->sc_new_bss = 1;\n\t\tawi_send_authreq(sc);\n\t\tbreak;\n\tdefault:\n\t\tprintf(\"unk mgt subtype %x\\n\", subtype);\n\t\tbreak;\n\t}\n\tm_freem(m);\t\t/* done.. */\n}"
  },
  {
    "function_name": "awi_rcv_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "830-901",
    "snippet": "void\nawi_rcv_data (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int8_t *llc;\n\tu_int8_t *to, *from;\n\tstruct awi_mac_header *amhp;\n\t\n\tsc->sc_scan_timer = awi_scan_keepalive;\t/* user data is as good\n\t\t\t\t   as a beacon as a keepalive.. */\n\n\tamhp = mtod(m, struct awi_mac_header *);\n\t\n\t/*\n\t * we have: 4 bytes useless goo.\n\t *\t    3 x 6 bytes MAC addresses.\n\t *\t    2 bytes goo.\n\t *\t    802.x LLC header, SNAP header, and data.\n\t *\n\t * for now, we fake up a \"normal\" ethernet header and feed\n\t * this to the appropriate input routine.\n\t */\n\n\tllc = (u_int8_t *)(amhp+1);\n\t\n\tif (amhp->awi_f2 & IEEEWL_FC2_TODS) {\n\t\tprintf(\"drop packet to DS\\n\");\n\t\tgoto drop;\n\t}\n\n\tto = amhp->awi_addr1;\n\tif (amhp->awi_f2 & IEEEWL_FC2_FROMDS)\n\t\tfrom = amhp->awi_addr3;\n\telse\n\t\tfrom = amhp->awi_addr2;\n\tif (memcmp (llc, snap_magic, 6) != 0)\n\t\tgoto drop;\n\n\t/* XXX overwrite llc with \"from\" address */\n\t/* XXX overwrite llc-6 with \"to\" address */\n\tbcopy(from, llc, ETHER_ADDR_LEN);\n\tbcopy(to, llc-6, ETHER_ADDR_LEN);\n\t\n\tm_adj(m, sizeof(struct awi_mac_header) + sizeof(struct awi_llc_header) \n\t    - sizeof(struct ether_header));\n\n#if NBPFILTER > 0\n\t/*\n\t * Pass packet to bpf if there is a listener.\n\t */\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n#if __NetBSD_Version__ > 104010000\n\tm->m_flags |= M_HASFCS;\n\t(*ifp->if_input)(ifp, m);\n#else\n\t{\n\t\tstruct ether_header *eh;\n\t\teh = mtod(m, struct ether_header *);\n\t\tm_adj(m, sizeof(*eh));\n\t\tm_adj(m, -ETHER_CRC_LEN);\n\t\tether_input(ifp, eh, m);\n\t}\n#endif\t\n\treturn;\n drop:\n\tm_freem(m);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [
      "#define ETHER_CRC_LEN 4"
    ],
    "globals_used": [
      "void awi_rcv_data"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ether_input",
          "args": [
            "ifp",
            "eh",
            "m"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_adj",
          "args": [
            "m",
            "-ETHER_CRC_LEN"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_adj",
          "args": [
            "m",
            "sizeof(*eh)"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "structether_header*"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "ifp",
            "m"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_mtap",
          "args": [
            "ifp->if_bpf",
            "m"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_adj",
          "args": [
            "m",
            "sizeof(struct awi_mac_header) + sizeof(struct awi_llc_header) \n\t    - sizeof(struct ether_header)"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bcopy",
          "args": [
            "to",
            "llc-6",
            "ETHER_ADDR_LEN"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "tr_bcopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/tropic.c",
          "lines": "1618-1663",
          "snippet": "void \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}",
          "includes": [
            "#include <dev/ic/tropicvar.h>",
            "#include <dev/ic/tropicreg.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <net/if_token.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_media.h>",
            "#include <net/if_llc.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/syslog.h>",
            "#include <sys/socket.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void\ttr_bcopy",
            "struct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/tropicvar.h>\n#include <dev/ic/tropicreg.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <net/if_token.h>\n#include <netinet/in_var.h>\n#include <netinet/ip.h>\n#include <netinet/if_ether.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_media.h>\n#include <net/if_llc.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/syslog.h>\n#include <sys/socket.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\ttr_bcopy;\nstruct mbuf *\ntr_get(sc, totlen, ifp)\nstruct tr_softc *sc;\n\nvoid \ntr_bcopy(sc, dest, len)\nstruct tr_softc *sc;\t/* pointer to softc struct for this adapter */\nu_char *dest;\t\t/* destination address */\nint len;\t\t/* number of bytes to copy */\n{\n\tstruct rbcb *rbc = &sc->rbc;\t/* pointer to rec buf ctl blk */\n\n\t/* While amount of data needed >= amount in current receive buffer. */\n\twhile (len >= rbc->data_len) {\n\t\t/* Copy all data from receive buffer to destination. */\n\n\t\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t\t    rbc->rbuf_datap, dest, (bus_size_t)rbc->data_len);\n\t\tlen -= rbc->data_len;\t/* update length left to transfer */\n\t\tdest += rbc->data_len;\t/* update destination address */\n\n\t\t/* Make next receive buffer current receive buffer. */\n\t\trbc->rbufp = rbc->rbufp_next;\n\t\tif (rbc->rbufp != 0) { /* More receive buffers? */\n\n\t\t\t/* Calculate pointer to next receive buffer. */\n\t\t\trbc->rbufp_next = RB_INW(sc, rbc->rbufp, RB_NEXTBUF);\n\t\t\tif (rbc->rbufp_next != 0)\n\t\t\t\trbc->rbufp_next -= RB_NEXTBUF;\n\n\t\t\t/* Get pointer to data in current receive buffer. */\n\t\t\trbc->rbuf_datap = rbc->rbufp + RB_DATA;\n\n\t\t\t/* Get length of data in current receive buffer. */\n\t\t\trbc->data_len = RB_INW(sc, rbc->rbufp, RB_BUFLEN);\n\t\t}\n\t\telse {\n\t\t\tif (len != 0)\t/* len should equal zero. */\n\t\t\t\tprintf(\"tr_bcopy: residual data not copied\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/* Amount of data needed is < amount in current receive buffer. */\n\n\tbus_space_read_region_1(sc->sc_memt, sc->sc_sramh,\n\t    rbc->rbuf_datap, dest, (bus_size_t)len);\n\trbc->data_len -= len;\t/* Update count of data in receive buffer. */\n\trbc->rbuf_datap += len;\t/* Update pointer to receive buffer data. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "llc",
            "snap_magic",
            "6"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"drop packet to DS\\n\""
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "structawi_mac_header*"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define ETHER_CRC_LEN 4\n\nvoid awi_rcv_data;\n\nvoid\nawi_rcv_data (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tu_int8_t *llc;\n\tu_int8_t *to, *from;\n\tstruct awi_mac_header *amhp;\n\t\n\tsc->sc_scan_timer = awi_scan_keepalive;\t/* user data is as good\n\t\t\t\t   as a beacon as a keepalive.. */\n\n\tamhp = mtod(m, struct awi_mac_header *);\n\t\n\t/*\n\t * we have: 4 bytes useless goo.\n\t *\t    3 x 6 bytes MAC addresses.\n\t *\t    2 bytes goo.\n\t *\t    802.x LLC header, SNAP header, and data.\n\t *\n\t * for now, we fake up a \"normal\" ethernet header and feed\n\t * this to the appropriate input routine.\n\t */\n\n\tllc = (u_int8_t *)(amhp+1);\n\t\n\tif (amhp->awi_f2 & IEEEWL_FC2_TODS) {\n\t\tprintf(\"drop packet to DS\\n\");\n\t\tgoto drop;\n\t}\n\n\tto = amhp->awi_addr1;\n\tif (amhp->awi_f2 & IEEEWL_FC2_FROMDS)\n\t\tfrom = amhp->awi_addr3;\n\telse\n\t\tfrom = amhp->awi_addr2;\n\tif (memcmp (llc, snap_magic, 6) != 0)\n\t\tgoto drop;\n\n\t/* XXX overwrite llc with \"from\" address */\n\t/* XXX overwrite llc-6 with \"to\" address */\n\tbcopy(from, llc, ETHER_ADDR_LEN);\n\tbcopy(to, llc-6, ETHER_ADDR_LEN);\n\t\n\tm_adj(m, sizeof(struct awi_mac_header) + sizeof(struct awi_llc_header) \n\t    - sizeof(struct ether_header));\n\n#if NBPFILTER > 0\n\t/*\n\t * Pass packet to bpf if there is a listener.\n\t */\n\tif (ifp->if_bpf)\n\t\tbpf_mtap(ifp->if_bpf, m);\n#endif\n\n#if __NetBSD_Version__ > 104010000\n\tm->m_flags |= M_HASFCS;\n\t(*ifp->if_input)(ifp, m);\n#else\n\t{\n\t\tstruct ether_header *eh;\n\t\teh = mtod(m, struct ether_header *);\n\t\tm_adj(m, sizeof(*eh));\n\t\tm_adj(m, -ETHER_CRC_LEN);\n\t\tether_input(ifp, eh, m);\n\t}\n#endif\t\n\treturn;\n drop:\n\tm_freem(m);\n}"
  },
  {
    "function_name": "awi_rcv_ctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "822-828",
    "snippet": "void\nawi_rcv_ctl (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tprintf(\"%s: ctl\\n\", sc->sc_dev.dv_xname);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_rcv_ctl"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: ctl\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_rcv_ctl;\n\nvoid\nawi_rcv_ctl (sc, m) \n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tprintf(\"%s: ctl\\n\", sc->sc_dev.dv_xname);\n}"
  },
  {
    "function_name": "awi_send_reassocreq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "794-818",
    "snippet": "void\nawi_send_reassocreq (sc)\n{\n\n\t/*\n\t * form an \"reassociation request\" message.\n\t */\n\n\t/* 2 bytes frame control\n\t   00100000 00000000\n\t   2 bytes goo\n\t   00000000 00000000\n\t   address 1: bssid\n\t   address 2: my address\n\t   address 3: bssid\n\t   2 bytes seq/ctl\n\t   00000000 00000000\n\n\t   cap info (2 bytes)\n\t   listen interval\t\t(2 bytes)\n\t   current ap address\t\t(6 bytes)\n\t   ssid\t\t\t\t(variable)\n\t   supported rates\t\t(va\n\t*/\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_send_reassocreq (sc)\n{\n\n\t/*\n\t * form an \"reassociation request\" message.\n\t */\n\n\t/* 2 bytes frame control\n\t   00100000 00000000\n\t   2 bytes goo\n\t   00000000 00000000\n\t   address 1: bssid\n\t   address 2: my address\n\t   address 3: bssid\n\t   2 bytes seq/ctl\n\t   00000000 00000000\n\n\t   cap info (2 bytes)\n\t   listen interval\t\t(2 bytes)\n\t   current ap address\t\t(6 bytes)\n\t   ssid\t\t\t\t(variable)\n\t   supported rates\t\t(va\n\t*/\n}"
  },
  {
    "function_name": "awi_send_assocreq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "741-791",
    "snippet": "void\nawi_send_assocreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_assoc_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\t/* \n\t * cap info (2 bytes)\n\t * listen interval\t(2 bytes)\n\t * ssid\t\t\t(variable)\n\t * supported rates\t(variable)\n\t */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    IEEEWL_FC_TYPE_MGT, IEEEWL_SUBTYPE_ASSOCREQ);\n\n\tamahp->awi_cap_info[0] = 4; /* XXX magic (CF-pollable) */\n\tamahp->awi_cap_info[1] = 0;\n\tamahp->awi_li[0] = 1;\n\tamahp->awi_li[1] = 0;\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending assoc request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\t\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_send_frame",
      "void awi_send_assocreq"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_set_timer",
          "args": [
            "sc"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "267-274",
          "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_send_frame",
          "args": [
            "sc",
            "m"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "awi_send_frame",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "613-621",
          "snippet": "void\nawi_send_frame (sc, m)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tIF_ENQUEUE(&sc->sc_mgtq, m);\n\n\tawi_start(sc->sc_ifp);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_start",
            "void awi_send_frame"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_start;\nvoid awi_send_frame;\n\nvoid\nawi_send_frame (sc, m)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tIF_ENQUEUE(&sc->sc_mgtq, m);\n\n\tawi_start(sc->sc_ifp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_hexdump",
          "args": [
            "\"frame\"",
            "m->m_data",
            "m->m_len"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "awi_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "541-550",
          "snippet": "void awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: sending assoc request\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "u_int8_t*"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_add_rates",
          "args": [
            "sc",
            "m",
            "tlvptr"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_add_ssid",
          "args": [
            "sc",
            "m",
            "tlvptr"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_init_hdr",
          "args": [
            "sc",
            "m",
            "IEEEWL_FC_TYPE_MGT",
            "IEEEWL_SUBTYPE_ASSOCREQ"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MGETHDR",
          "args": [
            "m",
            "M_DONTWAIT",
            "MT_DATA"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_send_frame;\nvoid awi_send_assocreq;\n\nvoid\nawi_send_assocreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_assoc_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\t/* \n\t * cap info (2 bytes)\n\t * listen interval\t(2 bytes)\n\t * ssid\t\t\t(variable)\n\t * supported rates\t(variable)\n\t */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    IEEEWL_FC_TYPE_MGT, IEEEWL_SUBTYPE_ASSOCREQ);\n\n\tamahp->awi_cap_info[0] = 4; /* XXX magic (CF-pollable) */\n\tamahp->awi_cap_info[1] = 0;\n\tamahp->awi_li[0] = 1;\n\tamahp->awi_li[1] = 0;\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending assoc request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\t\n}"
  },
  {
    "function_name": "awi_send_authreq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "681-739",
    "snippet": "void\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_send_frame",
      "void awi_send_authreq"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_set_timer",
          "args": [
            "sc"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "267-274",
          "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_send_frame",
          "args": [
            "sc",
            "m"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "awi_send_frame",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "613-621",
          "snippet": "void\nawi_send_frame (sc, m)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tIF_ENQUEUE(&sc->sc_mgtq, m);\n\n\tawi_start(sc->sc_ifp);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_start",
            "void awi_send_frame"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_start;\nvoid awi_send_frame;\n\nvoid\nawi_send_frame (sc, m)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tIF_ENQUEUE(&sc->sc_mgtq, m);\n\n\tawi_start(sc->sc_ifp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_hexdump",
          "args": [
            "\"frame\"",
            "m->m_data",
            "m->m_len"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "awi_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "541-550",
          "snippet": "void awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: sending auth request\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mtod",
          "args": [
            "m",
            "u_int8_t*"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_add_rates",
          "args": [
            "sc",
            "m",
            "tlvptr"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_add_ssid",
          "args": [
            "sc",
            "m",
            "tlvptr"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_init_hdr",
          "args": [
            "sc",
            "m",
            "(IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT))",
            "0"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MGETHDR",
          "args": [
            "m",
            "M_DONTWAIT",
            "MT_DATA"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_send_frame;\nvoid awi_send_authreq;\n\nvoid\nawi_send_authreq (sc)\n\tstruct awi_softc *sc;\n{\n\tstruct mbuf *m;\n\tstruct awi_auth_hdr *amahp;\n\tu_int8_t *tlvptr;\n\t\n\tMGETHDR(m, M_DONTWAIT, MT_DATA);\n\t\n\t/*\n\t * form an \"association request\" message.\n\t */\n\n\t/* \n\t * auth alg number.  2 bytes.  = 0\n\t * auth txn seq number = 2 bytes = 1\n\t *  status code\t       = 2 bytes = 0\n\t *  challenge text\t(not present)\n\t */\n\n\tif (m == 0)\n\t\treturn;\t\t/* we'll try again later.. */\n\n\tamahp = awi_init_hdr (sc, m,\n\t    (IEEEWL_FC_VERS | \n\t    (IEEEWL_FC_TYPE_MGT << IEEEWL_FC_TYPE_SHIFT) |\n\t    (IEEEWL_SUBTYPE_AUTH << IEEEWL_FC_SUBTYPE_SHIFT)),\n\t    0);\n\n\tamahp->awi_algno[0] = 0;\n\tamahp->awi_algno[1] = 0;\n\tamahp->awi_seqno[0] = 1;\n\tamahp->awi_seqno[1] = 0;\n\tamahp->awi_status[0] = 0;\n\tamahp->awi_status[1] = 0;\n\t\n\t/*\n\t * form an \"authentication\" message.\n\t */\n\n\ttlvptr = (u_int8_t *)(amahp+1);\n\n\ttlvptr = awi_add_ssid(sc, m, tlvptr);\n\ttlvptr = awi_add_rates(sc, m, tlvptr);\n\n\tm->m_len = tlvptr - mtod(m, u_int8_t *);\n\n\tif (sc->sc_ifp->if_flags & IFF_DEBUG) {\n\t\tprintf(\"%s: sending auth request\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_hexdump(\"frame\", m->m_data, m->m_len);\n\t}\n\t\n\tawi_send_frame(sc, m);\n\n\tsc->sc_mgt_timer = 2;\n\tawi_set_timer(sc);\n}"
  },
  {
    "function_name": "awi_send_frame",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "613-621",
    "snippet": "void\nawi_send_frame (sc, m)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tIF_ENQUEUE(&sc->sc_mgtq, m);\n\n\tawi_start(sc->sc_ifp);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_start",
      "void awi_send_frame"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_start",
          "args": [
            "sc->sc_ifp"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "awi_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "384-449",
          "snippet": "void\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_tx_packet",
            "void awi_start"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_tx_packet;\nvoid awi_start;\n\nvoid\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IF_ENQUEUE",
          "args": [
            "&sc->sc_mgtq",
            "m"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_start;\nvoid awi_send_frame;\n\nvoid\nawi_send_frame (sc, m)\n\tstruct awi_softc *sc;\n\tstruct mbuf *m;\n{\n\tIF_ENQUEUE(&sc->sc_mgtq, m);\n\n\tawi_start(sc->sc_ifp);\n}"
  },
  {
    "function_name": "awi_parse_tlv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "587-611",
    "snippet": "void\nawi_parse_tlv (u_int8_t *base, u_int8_t *end, u_int8_t **vals, u_int8_t *lens, size_t nattr)\n{\n\tu_int8_t tag, len;\n\n\tint i;\n\t\n\tfor (i=0; i<nattr; i++) {\n\t\tvals[i] = NULL;\n\t\tlens[i] = 0;\n\t}\n\t\n\twhile (base < end) {\n\t\ttag = base[0];\n\t\tlen = base[1];\n\n\t\tbase += 2;\n\t\t\n\t\tif (tag < nattr) {\n\t\t\tlens[tag] = len;\n\t\t\tvals[tag] = base;\n\t\t}\n\t\tbase += len;\n\t}\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_parse_tlv"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_parse_tlv;\n\nvoid\nawi_parse_tlv (u_int8_t *base, u_int8_t *end, u_int8_t **vals, u_int8_t *lens, size_t nattr)\n{\n\tu_int8_t tag, len;\n\n\tint i;\n\t\n\tfor (i=0; i<nattr; i++) {\n\t\tvals[i] = NULL;\n\t\tlens[i] = 0;\n\t}\n\t\n\twhile (base < end) {\n\t\ttag = base[0];\n\t\tlen = base[1];\n\n\t\tbase += 2;\n\t\t\n\t\tif (tag < nattr) {\n\t\t\tlens[tag] = len;\n\t\t\tvals[tag] = base;\n\t\t}\n\t\tbase += len;\n\t}\n}"
  },
  {
    "function_name": "awi_read_intst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "567-584",
    "snippet": "u_int8_t\nawi_read_intst(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t state;\n\t\n\tif (!awi_intlock(sc))\n\t\treturn 0;\n\n\t/* we have int lock.. */\n\n\tstate = awi_read_1 (sc, AWI_INTSTAT);\n\tawi_write_1(sc, AWI_INTSTAT, 0);\n\t\n\tawi_intunlock(sc);\n\n\treturn state;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int awi_intlock",
      "void awi_intunlock",
      "u_int8_t awi_read_intst"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_intunlock",
          "args": [
            "sc"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "awi_intunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "512-517",
          "snippet": "void\nawi_intunlock(sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_intunlock"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_intunlock;\n\nvoid\nawi_intunlock(sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_INTSTAT",
            "0"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_INTSTAT"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_intlock",
          "args": [
            "sc"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "awi_intlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "479-510",
          "snippet": "int\nawi_intlock(sc)\n\tstruct awi_softc *sc;\n{\n\tint i, j;\n\tu_int8_t lockout;\n\t\n\tDELAY(5);\n\tfor (j=0; j<10; j++) {\n\t\tfor (i=0; i<AWI_LOCKOUT_SPIN; i++) {\n\t\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\t\t\tif (!lockout)\n\t\t\t\tbreak;\n\t\t\tDELAY(5);\n\t\t}\n\t\tif (lockout)\n\t\t\tbreak;\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 1);\n\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\n\t\tif (!lockout)\n\t\t\tbreak;\n\t\t/* oops, lost the race.. try again */\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n\t}\n\t\t\n\tif (lockout) {\n\t\tawi_insane(sc);\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_insane",
            "int awi_intlock"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_insane;\nint awi_intlock;\n\nint\nawi_intlock(sc)\n\tstruct awi_softc *sc;\n{\n\tint i, j;\n\tu_int8_t lockout;\n\t\n\tDELAY(5);\n\tfor (j=0; j<10; j++) {\n\t\tfor (i=0; i<AWI_LOCKOUT_SPIN; i++) {\n\t\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\t\t\tif (!lockout)\n\t\t\t\tbreak;\n\t\t\tDELAY(5);\n\t\t}\n\t\tif (lockout)\n\t\t\tbreak;\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 1);\n\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\n\t\tif (!lockout)\n\t\t\tbreak;\n\t\t/* oops, lost the race.. try again */\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n\t}\n\t\t\n\tif (lockout) {\n\t\tawi_insane(sc);\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint awi_intlock;\nvoid awi_intunlock;\nu_int8_t awi_read_intst;\n\nu_int8_t\nawi_read_intst(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t state;\n\t\n\tif (!awi_intlock(sc))\n\t\treturn 0;\n\n\t/* we have int lock.. */\n\n\tstate = awi_read_1 (sc, AWI_INTSTAT);\n\tawi_write_1(sc, AWI_INTSTAT, 0);\n\t\n\tawi_intunlock(sc);\n\n\treturn state;\n}"
  },
  {
    "function_name": "awi_card_hexdump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "552-565",
    "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "offset+i"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "awi_hexdump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "541-550",
    "snippet": "void awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_hexdump (char *tag, u_int8_t *data, int len) \n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", data[i]);\n\t}\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "awi_intrinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "519-539",
    "snippet": "void\nawi_intrinit(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t intmask;\n\n\tam79c930_gcr_setbits(&sc->sc_chip, AM79C930_GCR_ENECINT);\n\t\n\tintmask = AWI_INT_GROGGY|AWI_INT_SCAN_CMPLT|\n\t    AWI_INT_TX|AWI_INT_RX|AWI_INT_CMD;\n\n\tintmask = ~intmask;\n\n\tif (!awi_intlock(sc))\n\t\treturn;\n\t\n\tawi_write_1(sc, AWI_INTMASK, intmask);\n\tawi_write_1(sc, AWI_INTMASK2, 0); \n\n\tawi_intunlock(sc);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int awi_intlock",
      "void awi_intunlock",
      "void awi_intrinit"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_intunlock",
          "args": [
            "sc"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "awi_intunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "512-517",
          "snippet": "void\nawi_intunlock(sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_intunlock"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_intunlock;\n\nvoid\nawi_intunlock(sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_INTMASK2",
            "0"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_INTMASK",
            "intmask"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_intlock",
          "args": [
            "sc"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "awi_intlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "479-510",
          "snippet": "int\nawi_intlock(sc)\n\tstruct awi_softc *sc;\n{\n\tint i, j;\n\tu_int8_t lockout;\n\t\n\tDELAY(5);\n\tfor (j=0; j<10; j++) {\n\t\tfor (i=0; i<AWI_LOCKOUT_SPIN; i++) {\n\t\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\t\t\tif (!lockout)\n\t\t\t\tbreak;\n\t\t\tDELAY(5);\n\t\t}\n\t\tif (lockout)\n\t\t\tbreak;\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 1);\n\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\n\t\tif (!lockout)\n\t\t\tbreak;\n\t\t/* oops, lost the race.. try again */\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n\t}\n\t\t\n\tif (lockout) {\n\t\tawi_insane(sc);\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_insane",
            "int awi_intlock"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_insane;\nint awi_intlock;\n\nint\nawi_intlock(sc)\n\tstruct awi_softc *sc;\n{\n\tint i, j;\n\tu_int8_t lockout;\n\t\n\tDELAY(5);\n\tfor (j=0; j<10; j++) {\n\t\tfor (i=0; i<AWI_LOCKOUT_SPIN; i++) {\n\t\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\t\t\tif (!lockout)\n\t\t\t\tbreak;\n\t\t\tDELAY(5);\n\t\t}\n\t\tif (lockout)\n\t\t\tbreak;\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 1);\n\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\n\t\tif (!lockout)\n\t\t\tbreak;\n\t\t/* oops, lost the race.. try again */\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n\t}\n\t\t\n\tif (lockout) {\n\t\tawi_insane(sc);\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "am79c930_gcr_setbits",
          "args": [
            "&sc->sc_chip",
            "AM79C930_GCR_ENECINT"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "am79c930_gcr_setbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "319-328",
          "snippet": "void am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nint awi_intlock;\nvoid awi_intunlock;\nvoid awi_intrinit;\n\nvoid\nawi_intrinit(sc)\n\tstruct awi_softc *sc;\n{\n\tu_int8_t intmask;\n\n\tam79c930_gcr_setbits(&sc->sc_chip, AM79C930_GCR_ENECINT);\n\t\n\tintmask = AWI_INT_GROGGY|AWI_INT_SCAN_CMPLT|\n\t    AWI_INT_TX|AWI_INT_RX|AWI_INT_CMD;\n\n\tintmask = ~intmask;\n\n\tif (!awi_intlock(sc))\n\t\treturn;\n\t\n\tawi_write_1(sc, AWI_INTMASK, intmask);\n\tawi_write_1(sc, AWI_INTMASK2, 0); \n\n\tawi_intunlock(sc);\n}"
  },
  {
    "function_name": "awi_intunlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "512-517",
    "snippet": "void\nawi_intunlock(sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_intunlock"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_LOCKOUT_MAC",
            "0"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_intunlock;\n\nvoid\nawi_intunlock(sc)\n\tstruct awi_softc *sc;\n{\n\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n}"
  },
  {
    "function_name": "awi_intlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "479-510",
    "snippet": "int\nawi_intlock(sc)\n\tstruct awi_softc *sc;\n{\n\tint i, j;\n\tu_int8_t lockout;\n\t\n\tDELAY(5);\n\tfor (j=0; j<10; j++) {\n\t\tfor (i=0; i<AWI_LOCKOUT_SPIN; i++) {\n\t\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\t\t\tif (!lockout)\n\t\t\t\tbreak;\n\t\t\tDELAY(5);\n\t\t}\n\t\tif (lockout)\n\t\t\tbreak;\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 1);\n\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\n\t\tif (!lockout)\n\t\t\tbreak;\n\t\t/* oops, lost the race.. try again */\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n\t}\n\t\t\n\tif (lockout) {\n\t\tawi_insane(sc);\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_insane",
      "int awi_intlock"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_insane",
          "args": [
            "sc"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "awi_insane",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "255-265",
          "snippet": "void\nawi_insane(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tprintf(\"%s: device timeout\\n\", sc->sc_dev.dv_xname);\n\n\t/* whap device on next timeout. */\n\tsc->sc_state = AWI_ST_INSANE;\n\tifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_insane"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_insane;\n\nvoid\nawi_insane(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tprintf(\"%s: device timeout\\n\", sc->sc_dev.dv_xname);\n\n\t/* whap device on next timeout. */\n\tsc->sc_state = AWI_ST_INSANE;\n\tifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_LOCKOUT_MAC",
            "0"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_LOCKOUT_HOST"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_write_1",
          "args": [
            "sc",
            "AWI_LOCKOUT_MAC",
            "1"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "5"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_read_1",
          "args": [
            "sc",
            "AWI_LOCKOUT_HOST"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "5"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_insane;\nint awi_intlock;\n\nint\nawi_intlock(sc)\n\tstruct awi_softc *sc;\n{\n\tint i, j;\n\tu_int8_t lockout;\n\t\n\tDELAY(5);\n\tfor (j=0; j<10; j++) {\n\t\tfor (i=0; i<AWI_LOCKOUT_SPIN; i++) {\n\t\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\t\t\tif (!lockout)\n\t\t\t\tbreak;\n\t\t\tDELAY(5);\n\t\t}\n\t\tif (lockout)\n\t\t\tbreak;\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 1);\n\t\tlockout = awi_read_1(sc, AWI_LOCKOUT_HOST);\n\n\t\tif (!lockout)\n\t\t\tbreak;\n\t\t/* oops, lost the race.. try again */\n\t\tawi_write_1 (sc, AWI_LOCKOUT_MAC, 0);\n\t}\n\t\t\n\tif (lockout) {\n\t\tawi_insane(sc);\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "awi_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "467-475",
    "snippet": "void\nawi_disable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled != 0 && sc->sc_disable != NULL) {\n\t\t(*sc->sc_disable)(sc);\n\t\tsc->sc_enabled = 0;\n\t}\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_disable"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_disable;\n\nvoid\nawi_disable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled != 0 && sc->sc_disable != NULL) {\n\t\t(*sc->sc_disable)(sc);\n\t\tsc->sc_enabled = 0;\n\t}\n}"
  },
  {
    "function_name": "awi_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "451-465",
    "snippet": "int\nawi_enable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled == 0) {\n\t\tif ((sc->sc_enable != NULL) && ((*sc->sc_enable)(sc) != 0)) {\n\t\t\tprintf(\"%s: device enable failed\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\treturn (EIO);\n\t\t}\n\t\tawi_init(sc);\n\t}\n\tsc->sc_enabled = 1;\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_init",
      "int awi_enable"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_init",
          "args": [
            "sc"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "awi_init_5",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "2354-2382",
          "snippet": "void awi_init_5 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tstruct ifnet *ifp = sc->sc_ifp;\n#endif\n\t\n#if 0\n\tprintf(\"%s: awi_init_5, st %x\\n\", sc->sc_dev.dv_xname, status);\n\tawi_card_hexdump(sc, \"init_5 CSB\", AWI_CSB, 16);\n#endif\n\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: init_rx failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\tsc->sc_rx_data_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_DATA_DESC);\n\tsc->sc_rx_mgt_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_PS_DESC);\t\n\n#if 0\n\tprintf(\"%s: data desc %x, mgt desc %x\\n\", sc->sc_dev.dv_xname,\n\t    sc->sc_rx_data_desc, sc->sc_rx_mgt_desc);\n#endif\n\tawi_restart_scan(sc);\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_reset",
            "void awi_init_5"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_reset;\nvoid awi_init_5;\n\nvoid awi_init_5 (sc, status)\n\tstruct awi_softc *sc;\n\tu_int8_t status;\n{\n#if 0\n\tstruct ifnet *ifp = sc->sc_ifp;\n#endif\n\t\n#if 0\n\tprintf(\"%s: awi_init_5, st %x\\n\", sc->sc_dev.dv_xname, status);\n\tawi_card_hexdump(sc, \"init_5 CSB\", AWI_CSB, 16);\n#endif\n\n\tif (status != AWI_STAT_OK) {\n\t\tprintf(\"%s: init_rx failed (card unhappy?)\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tawi_reset(sc);\n\t\treturn;\n\t}\n\n\tsc->sc_rx_data_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_DATA_DESC);\n\tsc->sc_rx_mgt_desc = awi_read_4(sc, AWI_CMD_PARAMS+AWI_CA_IRX_PS_DESC);\t\n\n#if 0\n\tprintf(\"%s: data desc %x, mgt desc %x\\n\", sc->sc_dev.dv_xname,\n\t    sc->sc_rx_data_desc, sc->sc_rx_mgt_desc);\n#endif\n\tawi_restart_scan(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: device enable failed\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_init;\nint awi_enable;\n\nint\nawi_enable(sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_enabled == 0) {\n\t\tif ((sc->sc_enable != NULL) && ((*sc->sc_enable)(sc) != 0)) {\n\t\t\tprintf(\"%s: device enable failed\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\treturn (EIO);\n\t\t}\n\t\tawi_init(sc);\n\t}\n\tsc->sc_enabled = 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "awi_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "384-449",
    "snippet": "void\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_tx_packet",
      "void awi_start"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_set_timer",
          "args": [
            "sc"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "awi_set_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "267-274",
          "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m0"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awi_tx_packet",
          "args": [
            "sc",
            "sc->sc_txnext",
            "m0"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "awi_tx_packet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "282-316",
          "snippet": "void\nawi_tx_packet (sc, txd, m0)\n\tstruct awi_softc *sc;\n\tint txd;\n\tstruct mbuf *m0;\n{\n\tu_int32_t frame = sc->sc_txd[txd].frame;\n\tu_int32_t len = sc->sc_txd[txd].len;\n\tstruct mbuf *m;\n\n\tfor (m = m0; m != NULL; m = m->m_next) {\n\t\tu_int32_t nmove;\n\t\tnmove = min(len, m->m_len);\n\t\tawi_write_bytes (sc, frame, m->m_data, nmove);\n\t\tif (nmove != m->m_len) {\n\t\t\tprintf(\"%s: large frame truncated\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tframe += nmove;\n\t\tlen -= nmove;\n\t}\n\t\n\tawi_init_txd (sc,\n\t    txd,\n\t    AWI_TXD_ST_OWN,\n\t    frame - sc->sc_txd[txd].frame,\n\t    AWI_RATE_1MBIT);\n\n#if 0\n\tawi_card_hexdump (sc, \"txd to go\", sc->sc_txd[txd].descr,\n\t    AWI_TXD_SIZE);\n#endif\n\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_tx_packet",
            "void awi_init_txd"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_tx_packet;\nvoid awi_init_txd;\n\nvoid\nawi_tx_packet (sc, txd, m0)\n\tstruct awi_softc *sc;\n\tint txd;\n\tstruct mbuf *m0;\n{\n\tu_int32_t frame = sc->sc_txd[txd].frame;\n\tu_int32_t len = sc->sc_txd[txd].len;\n\tstruct mbuf *m;\n\n\tfor (m = m0; m != NULL; m = m->m_next) {\n\t\tu_int32_t nmove;\n\t\tnmove = min(len, m->m_len);\n\t\tawi_write_bytes (sc, frame, m->m_data, nmove);\n\t\tif (nmove != m->m_len) {\n\t\t\tprintf(\"%s: large frame truncated\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tframe += nmove;\n\t\tlen -= nmove;\n\t}\n\t\n\tawi_init_txd (sc,\n\t    txd,\n\t    AWI_TXD_ST_OWN,\n\t    frame - sc->sc_txd[txd].frame,\n\t    AWI_RATE_1MBIT);\n\n#if 0\n\tawi_card_hexdump (sc, \"txd to go\", sc->sc_txd[txd].descr,\n\t    AWI_TXD_SIZE);\n#endif\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_output_kludge",
          "args": [
            "sc",
            "m0"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_mtap",
          "args": [
            "ifp->if_bpf",
            "m0"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&ifp->if_snd",
            "m0"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&sc->sc_mgtq",
            "m0"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: start called while not running\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_tx_packet;\nvoid awi_start;\n\nvoid\nawi_start(ifp)\n\tstruct ifnet *ifp;\n{\n\tstruct awi_softc *sc = ifp->if_softc;\n\tstruct mbuf *m0;\n\tint opending;\n\t\n\tif ((ifp->if_flags & IFF_RUNNING) == 0) {\n\t\tprintf(\"%s: start called while not running\\n\",\n\t\t    sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\t\n\t/*\n\t * loop through send queue, setting up tx descriptors\n\t * until we either run out of stuff to send, or descriptors\n\t * to send them in.\n\t */\n\topending = sc->sc_txpending;\n\t\n\twhile (sc->sc_txpending < sc->sc_ntxd) {\n\t\t/*\n\t\t * Grab a packet off the queue.\n\t\t */\n\t\tIF_DEQUEUE (&sc->sc_mgtq, m0);\n\n\t\tif (m0 == NULL) {\n\t\t\t/* XXX defer sending if not synched yet? */\n\t\t\tIF_DEQUEUE (&ifp->if_snd, m0);\n\t\t\tif (m0 == NULL) \n\t\t\t\tbreak;\n#if NBPFILTER > 0\n\t\t\t/*\n\t\t\t * Pass packet to bpf if there is a listener.\n\t\t\t */\n\t\t\tif (ifp->if_bpf)\n\t\t\t\tbpf_mtap(ifp->if_bpf, m0);\n#endif\n\t\t\t/*\n\t\t\t * We've got an ethernet-format frame.\n\t\t\t * we need to mangle it into 802.11 form..\n\t\t\t */\n\t\t\tm0 = awi_output_kludge(sc, m0);\n\t\t\tif (m0 == NULL)\n\t\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tawi_tx_packet(sc, sc->sc_txnext, m0);\n\n\t\tsc->sc_txpending++;\n\t\tsc->sc_txnext = (sc->sc_txnext + 1) % sc->sc_ntxd;\n\t\t\n\t\tm_freem(m0);\n\t}\n\tif (sc->sc_txpending >= sc->sc_ntxd) {\n\t\t/* no more slots available.. */\n\t\tifp->if_flags |= IFF_OACTIVE;\n\t}\n\tif (sc->sc_txpending != opending) {\n\t\t/* set watchdog timer in case unit flakes out */\n\t\tif (sc->sc_tx_timer == 0)\n\t\t\tsc->sc_tx_timer = 5;\n\t\tawi_set_timer(sc);\n\t}\n}"
  },
  {
    "function_name": "awi_tx_packet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "282-316",
    "snippet": "void\nawi_tx_packet (sc, txd, m0)\n\tstruct awi_softc *sc;\n\tint txd;\n\tstruct mbuf *m0;\n{\n\tu_int32_t frame = sc->sc_txd[txd].frame;\n\tu_int32_t len = sc->sc_txd[txd].len;\n\tstruct mbuf *m;\n\n\tfor (m = m0; m != NULL; m = m->m_next) {\n\t\tu_int32_t nmove;\n\t\tnmove = min(len, m->m_len);\n\t\tawi_write_bytes (sc, frame, m->m_data, nmove);\n\t\tif (nmove != m->m_len) {\n\t\t\tprintf(\"%s: large frame truncated\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tframe += nmove;\n\t\tlen -= nmove;\n\t}\n\t\n\tawi_init_txd (sc,\n\t    txd,\n\t    AWI_TXD_ST_OWN,\n\t    frame - sc->sc_txd[txd].frame,\n\t    AWI_RATE_1MBIT);\n\n#if 0\n\tawi_card_hexdump (sc, \"txd to go\", sc->sc_txd[txd].descr,\n\t    AWI_TXD_SIZE);\n#endif\n\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_tx_packet",
      "void awi_init_txd"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "awi_card_hexdump",
          "args": [
            "sc",
            "\"txd to go\"",
            "sc->sc_txd[txd].descr",
            "AWI_TXD_SIZE"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "awi_card_hexdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "552-565",
          "snippet": "void awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_card_hexdump (sc, tag, offset, len)\n\tstruct awi_softc *sc;\n\tchar *tag;\n\tu_int32_t offset;\n\tint len;\n{\n\tint i;\n\t\n\tprintf(\"%s:\", tag);\n\tfor (i=0; i<len; i++) {\n\t\tprintf(\" %02x\", awi_read_1(sc, offset+i));\n\t}\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_init_txd",
          "args": [
            "sc",
            "txd",
            "AWI_TXD_ST_OWN",
            "frame - sc->sc_txd[txd].frame",
            "AWI_RATE_1MBIT"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "awi_init_txdescr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
          "lines": "1424-1458",
          "snippet": "void\nawi_init_txdescr (sc)\n\tstruct awi_softc *sc;\n{\n\tint i;\n\tu_int32_t offset = sc->sc_txbase;\n\n\tsc->sc_txfirst = 0;\n\tsc->sc_txnext = 0;\n\n\tsc->sc_ntxd = sc->sc_txlen / (AWI_FRAME_SIZE + AWI_TXD_SIZE);\n\tif (sc->sc_ntxd > NTXD) {\n\t\tsc->sc_ntxd = NTXD;\n\t\tprintf(\"oops, no, only %d\\n\", sc->sc_ntxd);\n\t}\n\n\t/* Allocate TXD's */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].descr = offset;\n\t\toffset += AWI_TXD_SIZE;\n\t}\n\t/* now, allocate buffer space to each txd.. */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].frame = offset;\n\t\tsc->sc_txd[i].len = AWI_FRAME_SIZE;\n\t\toffset += AWI_FRAME_SIZE;\n\t\t\n\t}\n\t\n\t/* now, initialize the TX descriptors into a circular linked list. */\n\t\n\tfor (i= 0; i<sc->sc_ntxd; i++) {\n\t\tawi_init_txd(sc, i, 0, 0, 0);\n\t}\n}",
          "includes": [
            "#include <dev/ic/awivar.h>",
            "#include <dev/ic/awireg.h>",
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netns/ns_if.h>",
            "#include <netns/ns.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include <sys/device.h>",
            "#include <sys/select.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void awi_init_txdescr",
            "void awi_init_txd"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_init_txdescr;\nvoid awi_init_txd;\n\nvoid\nawi_init_txdescr (sc)\n\tstruct awi_softc *sc;\n{\n\tint i;\n\tu_int32_t offset = sc->sc_txbase;\n\n\tsc->sc_txfirst = 0;\n\tsc->sc_txnext = 0;\n\n\tsc->sc_ntxd = sc->sc_txlen / (AWI_FRAME_SIZE + AWI_TXD_SIZE);\n\tif (sc->sc_ntxd > NTXD) {\n\t\tsc->sc_ntxd = NTXD;\n\t\tprintf(\"oops, no, only %d\\n\", sc->sc_ntxd);\n\t}\n\n\t/* Allocate TXD's */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].descr = offset;\n\t\toffset += AWI_TXD_SIZE;\n\t}\n\t/* now, allocate buffer space to each txd.. */\n\tfor (i=0; i<sc->sc_ntxd; i++) {\n\t\tsc->sc_txd[i].frame = offset;\n\t\tsc->sc_txd[i].len = AWI_FRAME_SIZE;\n\t\toffset += AWI_FRAME_SIZE;\n\t\t\n\t}\n\t\n\t/* now, initialize the TX descriptors into a circular linked list. */\n\t\n\tfor (i= 0; i<sc->sc_ntxd; i++) {\n\t\tawi_init_txd(sc, i, 0, 0, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: large frame truncated\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "awi_write_bytes",
          "args": [
            "sc",
            "frame",
            "m->m_data",
            "nmove"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "len",
            "m->m_len"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "am7990_meminit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am7990.c",
          "lines": "231-295",
          "snippet": "void\nam7990_meminit(sc)\n\tregister struct am7990_softc *sc;\n{\n\tu_long a;\n\tint bix;\n\tstruct leinit init;\n\tstruct lermd rmd;\n\tstruct letmd tmd;\n\n#if NBPFILTER > 0\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tinit.init_mode = LE_MODE_NORMAL | LE_MODE_PROM;\n\telse\n#endif\n\t\tinit.init_mode = LE_MODE_NORMAL;\n\tinit.init_padr[0] =\n\t    (sc->sc_arpcom.ac_enaddr[1] << 8) | sc->sc_arpcom.ac_enaddr[0];\n\tinit.init_padr[1] =\n\t    (sc->sc_arpcom.ac_enaddr[3] << 8) | sc->sc_arpcom.ac_enaddr[2];\n\tinit.init_padr[2] =\n\t    (sc->sc_arpcom.ac_enaddr[5] << 8) | sc->sc_arpcom.ac_enaddr[4];\n\tam7990_setladrf(&sc->sc_arpcom, init.init_ladrf);\n\n\tsc->sc_last_rd = 0;\n\tsc->sc_first_td = sc->sc_last_td = sc->sc_no_td = 0;\n\n\ta = sc->sc_addr + LE_RMDADDR(sc, 0);\n\tinit.init_rdra = a;\n\tinit.init_rlen = (a >> 16) | ((ffs(sc->sc_nrbuf) - 1) << 13);\n\n\ta = sc->sc_addr + LE_TMDADDR(sc, 0);\n\tinit.init_tdra = a;\n\tinit.init_tlen = (a >> 16) | ((ffs(sc->sc_ntbuf) - 1) << 13);\n\n\t(*sc->sc_copytodesc)(sc, &init, LE_INITADDR(sc), sizeof(init));\n\n\t/*\n\t * Set up receive ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_nrbuf; bix++) {\n\t\ta = sc->sc_addr + LE_RBUFADDR(sc, bix);\n\t\trmd.rmd0 = a;\n\t\trmd.rmd1_hadr = a >> 16;\n\t\trmd.rmd1_bits = LE_R1_OWN;\n\t\trmd.rmd2 = -LEBLEN | LE_XMD2_ONES;\n\t\trmd.rmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &rmd, LE_RMDADDR(sc, bix),\n\t\t    sizeof(rmd));\n\t}\n\n\t/*\n\t * Set up transmit ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_ntbuf; bix++) {\n\t\ta = sc->sc_addr + LE_TBUFADDR(sc, bix);\n\t\ttmd.tmd0 = a;\n\t\ttmd.tmd1_hadr = a >> 16;\n\t\ttmd.tmd1_bits = 0;\n\t\ttmd.tmd2 = 0 | LE_XMD2_ONES;\n\t\ttmd.tmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &tmd, LE_TMDADDR(sc, bix),\n\t\t    sizeof(tmd));\n\t}\n}",
          "includes": [
            "#include <dev/ic/am7990var.h>",
            "#include <dev/ic/am7990reg.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/socket.h>",
            "#include <sys/syslog.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define\tifp\t(&sc->sc_arpcom.ac_if)"
          ],
          "globals_used": [
            "am7990_rint __P((struct am7990_softc *));",
            "am7990_tint __P((struct am7990_softc *));",
            "integrate struct",
            "integrate struct",
            "mbuf *\nam7990_get(sc, boff, totlen)\n\tstruct am7990_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define\tifp\t(&sc->sc_arpcom.ac_if)\n\nam7990_rint __P((struct am7990_softc *));\nam7990_tint __P((struct am7990_softc *));\nintegrate struct;\nintegrate struct;\nmbuf *\nam7990_get(sc, boff, totlen)\n\tstruct am7990_softc *sc;\n\nvoid\nam7990_meminit(sc)\n\tregister struct am7990_softc *sc;\n{\n\tu_long a;\n\tint bix;\n\tstruct leinit init;\n\tstruct lermd rmd;\n\tstruct letmd tmd;\n\n#if NBPFILTER > 0\n\tif (ifp->if_flags & IFF_PROMISC)\n\t\tinit.init_mode = LE_MODE_NORMAL | LE_MODE_PROM;\n\telse\n#endif\n\t\tinit.init_mode = LE_MODE_NORMAL;\n\tinit.init_padr[0] =\n\t    (sc->sc_arpcom.ac_enaddr[1] << 8) | sc->sc_arpcom.ac_enaddr[0];\n\tinit.init_padr[1] =\n\t    (sc->sc_arpcom.ac_enaddr[3] << 8) | sc->sc_arpcom.ac_enaddr[2];\n\tinit.init_padr[2] =\n\t    (sc->sc_arpcom.ac_enaddr[5] << 8) | sc->sc_arpcom.ac_enaddr[4];\n\tam7990_setladrf(&sc->sc_arpcom, init.init_ladrf);\n\n\tsc->sc_last_rd = 0;\n\tsc->sc_first_td = sc->sc_last_td = sc->sc_no_td = 0;\n\n\ta = sc->sc_addr + LE_RMDADDR(sc, 0);\n\tinit.init_rdra = a;\n\tinit.init_rlen = (a >> 16) | ((ffs(sc->sc_nrbuf) - 1) << 13);\n\n\ta = sc->sc_addr + LE_TMDADDR(sc, 0);\n\tinit.init_tdra = a;\n\tinit.init_tlen = (a >> 16) | ((ffs(sc->sc_ntbuf) - 1) << 13);\n\n\t(*sc->sc_copytodesc)(sc, &init, LE_INITADDR(sc), sizeof(init));\n\n\t/*\n\t * Set up receive ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_nrbuf; bix++) {\n\t\ta = sc->sc_addr + LE_RBUFADDR(sc, bix);\n\t\trmd.rmd0 = a;\n\t\trmd.rmd1_hadr = a >> 16;\n\t\trmd.rmd1_bits = LE_R1_OWN;\n\t\trmd.rmd2 = -LEBLEN | LE_XMD2_ONES;\n\t\trmd.rmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &rmd, LE_RMDADDR(sc, bix),\n\t\t    sizeof(rmd));\n\t}\n\n\t/*\n\t * Set up transmit ring descriptors.\n\t */\n\tfor (bix = 0; bix < sc->sc_ntbuf; bix++) {\n\t\ta = sc->sc_addr + LE_TBUFADDR(sc, bix);\n\t\ttmd.tmd0 = a;\n\t\ttmd.tmd1_hadr = a >> 16;\n\t\ttmd.tmd1_bits = 0;\n\t\ttmd.tmd2 = 0 | LE_XMD2_ONES;\n\t\ttmd.tmd3 = 0;\n\t\t(*sc->sc_copytodesc)(sc, &tmd, LE_TMDADDR(sc, bix),\n\t\t    sizeof(tmd));\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_tx_packet;\nvoid awi_init_txd;\n\nvoid\nawi_tx_packet (sc, txd, m0)\n\tstruct awi_softc *sc;\n\tint txd;\n\tstruct mbuf *m0;\n{\n\tu_int32_t frame = sc->sc_txd[txd].frame;\n\tu_int32_t len = sc->sc_txd[txd].len;\n\tstruct mbuf *m;\n\n\tfor (m = m0; m != NULL; m = m->m_next) {\n\t\tu_int32_t nmove;\n\t\tnmove = min(len, m->m_len);\n\t\tawi_write_bytes (sc, frame, m->m_data, nmove);\n\t\tif (nmove != m->m_len) {\n\t\t\tprintf(\"%s: large frame truncated\\n\",\n\t\t\t    sc->sc_dev.dv_xname);\n\t\t\tbreak;\n\t\t}\n\t\tframe += nmove;\n\t\tlen -= nmove;\n\t}\n\t\n\tawi_init_txd (sc,\n\t    txd,\n\t    AWI_TXD_ST_OWN,\n\t    frame - sc->sc_txd[txd].frame,\n\t    AWI_RATE_1MBIT);\n\n#if 0\n\tawi_card_hexdump (sc, \"txd to go\", sc->sc_txd[txd].descr,\n\t    AWI_TXD_SIZE);\n#endif\n\n}"
  },
  {
    "function_name": "awi_set_timer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "267-274",
    "snippet": "void\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\nawi_set_timer (sc)\n\tstruct awi_softc *sc;\n{\n\tif (sc->sc_tx_timer || sc->sc_scan_timer ||\n\t    sc->sc_mgt_timer || sc->sc_cmd_timer)\n\t\tsc->sc_ifp->if_timer = 1;\n}"
  },
  {
    "function_name": "awi_insane",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/awi.c",
    "lines": "255-265",
    "snippet": "void\nawi_insane(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tprintf(\"%s: device timeout\\n\", sc->sc_dev.dv_xname);\n\n\t/* whap device on next timeout. */\n\tsc->sc_state = AWI_ST_INSANE;\n\tifp->if_timer = 1;\n}",
    "includes": [
      "#include <dev/ic/awivar.h>",
      "#include <dev/ic/awireg.h>",
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include <netns/ns_if.h>",
      "#include <netns/ns.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_var.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if_dl.h>",
      "#include <net/if.h>",
      "#include <sys/rnd.h>",
      "#include <sys/device.h>",
      "#include <sys/select.h>",
      "#include <sys/syslog.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"bpfilter.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void awi_insane"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: device timeout\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/awivar.h>\n#include <dev/ic/awireg.h>\n#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <netns/ns_if.h>\n#include <netns/ns.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include <sys/device.h>\n#include <sys/select.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid awi_insane;\n\nvoid\nawi_insane(sc)\n\tstruct awi_softc *sc;\n{\n\tstruct ifnet *ifp = sc->sc_ifp;\n\tprintf(\"%s: device timeout\\n\", sc->sc_dev.dv_xname);\n\n\t/* whap device on next timeout. */\n\tsc->sc_state = AWI_ST_INSANE;\n\tifp->if_timer = 1;\n}"
  }
]