[
  {
    "function_name": "cmpci_trigger_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1537-1577",
    "snippet": "int\ncmpci_trigger_input(handle, start, end, blksize, intr, arg, param)\n        void *handle;\n        void *start, *end;\n        int blksize;\n        void (*intr) __P((void *));\n        void *arg;\n        struct audio_params *param;\n{\n\tstruct cmpci_softc *sc = handle;\n\tstruct cmpci_dmanode *p;\n\tint bps;\n\n\tsc->sc_rec.intr = intr;\n\tsc->sc_rec.intr_arg = arg;\n\tbps = param->channels*param->precision*param->factor/8;\n\tif (!bps)\n\t\treturn EINVAL;\n\n\t/* set DMA frame */\n\tif (!(p = cmpci_find_dmamem(sc, start)))\n\t\treturn EINVAL;\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA1_BASE,\n\t\t\t  DMAADDR(p));\n\tdelay(10);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA1_BYTES,\n\t\t\t  ((caddr_t)end-(caddr_t)start+1)/bps-1);\n\tdelay(10);\n\n\t/* set interrupt count */\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA1_SAMPLES,\n\t\t\t  (blksize+bps-1)/bps-1);\n\tdelay(10);\n\n\t/* start DMA */\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_DIR); /* REC */\n\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH1_INTR_ENABLE);\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_ENABLE);\n\t\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_set_4",
      "__P((int));",
      "__P((int));",
      "__P((int));",
      "__P((int, int));",
      "struct cmpci_dmanode * cmpci_find_dmamem",
      "int cmpci_trigger_input",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_reg_set_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_0",
            "CMPCI_REG_CH1_ENABLE"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_set_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "225-234",
          "snippet": "static __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_set_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 1569
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_DMA1_SAMPLES",
            "(blksize+bps-1)/bps-1"
          ],
          "line": 1567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_DMA1_BYTES",
            "((caddr_t)end-(caddr_t)start+1)/bps-1"
          ],
          "line": 1562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_DMA1_BASE",
            "DMAADDR(p)"
          ],
          "line": 1559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMAADDR",
          "args": [
            "p"
          ],
          "line": 1560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_find_dmamem",
          "args": [
            "sc",
            "start"
          ],
          "line": 1557
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\n__P((int));\n__P((int));\n__P((int));\n__P((int, int));\nstruct cmpci_dmanode * cmpci_find_dmamem;\nint cmpci_trigger_input;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_trigger_input(handle, start, end, blksize, intr, arg, param)\n        void *handle;\n        void *start, *end;\n        int blksize;\n        void (*intr) __P((void *));\n        void *arg;\n        struct audio_params *param;\n{\n\tstruct cmpci_softc *sc = handle;\n\tstruct cmpci_dmanode *p;\n\tint bps;\n\n\tsc->sc_rec.intr = intr;\n\tsc->sc_rec.intr_arg = arg;\n\tbps = param->channels*param->precision*param->factor/8;\n\tif (!bps)\n\t\treturn EINVAL;\n\n\t/* set DMA frame */\n\tif (!(p = cmpci_find_dmamem(sc, start)))\n\t\treturn EINVAL;\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA1_BASE,\n\t\t\t  DMAADDR(p));\n\tdelay(10);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA1_BYTES,\n\t\t\t  ((caddr_t)end-(caddr_t)start+1)/bps-1);\n\tdelay(10);\n\n\t/* set interrupt count */\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA1_SAMPLES,\n\t\t\t  (blksize+bps-1)/bps-1);\n\tdelay(10);\n\n\t/* start DMA */\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_DIR); /* REC */\n\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH1_INTR_ENABLE);\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_ENABLE);\n\t\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_trigger_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1495-1535",
    "snippet": "int\ncmpci_trigger_output(handle, start, end, blksize, intr, arg, param)\n        void *handle;\n        void *start, *end;\n        int blksize;\n        void (*intr) __P((void *));\n        void *arg;\n        struct audio_params *param;\n{\n\tstruct cmpci_softc *sc = handle;\n\tstruct cmpci_dmanode *p;\n\tint bps;\n\n\tsc->sc_play.intr = intr;\n\tsc->sc_play.intr_arg = arg;\n\tbps = param->channels * param->precision * param->factor / 8;\n\tif (!bps)\n\t\treturn EINVAL;\n\n\t/* set DMA frame */\n\tif (!(p = cmpci_find_dmamem(sc, start)))\n\t\treturn EINVAL;\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA0_BASE,\n\t\t\t  DMAADDR(p));\n\tdelay(10);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA0_BYTES,\n\t\t\t  ((caddr_t)end-(caddr_t)start+1)/bps-1);\n\tdelay(10);\n\n\t/* set interrupt count */\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA0_SAMPLES,\n\t\t\t  (blksize+bps-1)/bps-1);\n\tdelay(10);\n\n\t/* start DMA */\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_DIR); /* PLAY */\n\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH0_INTR_ENABLE);\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_ENABLE);\n\t\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_set_4",
      "static __inline void cmpci_reg_clear_4",
      "__P((int));",
      "__P((int));",
      "__P((int));",
      "__P((int, int));",
      "struct cmpci_dmanode * cmpci_find_dmamem",
      "int cmpci_trigger_output",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_reg_set_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_0",
            "CMPCI_REG_CH0_ENABLE"
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_set_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "225-234",
          "snippet": "static __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_set_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_reg_clear_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_0",
            "CMPCI_REG_CH0_DIR"
          ],
          "line": 1530
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_clear_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "236-245",
          "snippet": "static __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_clear_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_clear_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 1527
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_DMA0_SAMPLES",
            "(blksize+bps-1)/bps-1"
          ],
          "line": 1525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_DMA0_BYTES",
            "((caddr_t)end-(caddr_t)start+1)/bps-1"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_DMA0_BASE",
            "DMAADDR(p)"
          ],
          "line": 1517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMAADDR",
          "args": [
            "p"
          ],
          "line": 1518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_find_dmamem",
          "args": [
            "sc",
            "start"
          ],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstatic __inline void cmpci_reg_clear_4;\n__P((int));\n__P((int));\n__P((int));\n__P((int, int));\nstruct cmpci_dmanode * cmpci_find_dmamem;\nint cmpci_trigger_output;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_trigger_output(handle, start, end, blksize, intr, arg, param)\n        void *handle;\n        void *start, *end;\n        int blksize;\n        void (*intr) __P((void *));\n        void *arg;\n        struct audio_params *param;\n{\n\tstruct cmpci_softc *sc = handle;\n\tstruct cmpci_dmanode *p;\n\tint bps;\n\n\tsc->sc_play.intr = intr;\n\tsc->sc_play.intr_arg = arg;\n\tbps = param->channels * param->precision * param->factor / 8;\n\tif (!bps)\n\t\treturn EINVAL;\n\n\t/* set DMA frame */\n\tif (!(p = cmpci_find_dmamem(sc, start)))\n\t\treturn EINVAL;\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA0_BASE,\n\t\t\t  DMAADDR(p));\n\tdelay(10);\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA0_BYTES,\n\t\t\t  ((caddr_t)end-(caddr_t)start+1)/bps-1);\n\tdelay(10);\n\n\t/* set interrupt count */\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, CMPCI_REG_DMA0_SAMPLES,\n\t\t\t  (blksize+bps-1)/bps-1);\n\tdelay(10);\n\n\t/* start DMA */\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_DIR); /* PLAY */\n\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH0_INTR_ENABLE);\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_ENABLE);\n\t\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_get_props",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1487-1492",
    "snippet": "int\ncmpci_get_props(handle)\n\tvoid *handle;\n{\n\treturn AUDIO_PROP_MMAP | AUDIO_PROP_INDEPENDENT | AUDIO_PROP_FULLDUPLEX;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_get_props",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_get_props;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_get_props(handle)\n\tvoid *handle;\n{\n\treturn AUDIO_PROP_MMAP | AUDIO_PROP_INDEPENDENT | AUDIO_PROP_FULLDUPLEX;\n}"
  },
  {
    "function_name": "cmpci_mappage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1468-1484",
    "snippet": "int\ncmpci_mappage(handle, addr, offset, prot)\n\tvoid *handle;\n\tvoid *addr;\n\tint   offset;\n\tint   prot;\n{\n\tstruct cmpci_softc *sc = handle;\n\tstruct cmpci_dmanode *p;\n\n\tif ( offset < 0 || (p = cmpci_find_dmamem(sc, addr)) == NULL)\n\t\treturn -1;\n\n\treturn bus_dmamem_mmap(p->cd_tag, p->cd_segs,\n\t\t\t       sizeof(p->cd_segs)/sizeof(p->cd_segs[0]),\n\t\t\t       offset, prot, BUS_DMA_WAITOK);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cmpci_dmanode * cmpci_find_dmamem",
      "int cmpci_mappage",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "caddr_t addr;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_mmap",
          "args": [
            "p->cd_tag",
            "p->cd_segs",
            "sizeof(p->cd_segs)/sizeof(p->cd_segs[0])",
            "offset",
            "prot",
            "BUS_DMA_WAITOK"
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_find_dmamem",
          "args": [
            "sc",
            "addr"
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct cmpci_dmanode * cmpci_find_dmamem;\nint cmpci_mappage;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\ncaddr_t addr;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_mappage(handle, addr, offset, prot)\n\tvoid *handle;\n\tvoid *addr;\n\tint   offset;\n\tint   prot;\n{\n\tstruct cmpci_softc *sc = handle;\n\tstruct cmpci_dmanode *p;\n\n\tif ( offset < 0 || (p = cmpci_find_dmamem(sc, addr)) == NULL)\n\t\treturn -1;\n\n\treturn bus_dmamem_mmap(p->cd_tag, p->cd_segs,\n\t\t\t       sizeof(p->cd_segs)/sizeof(p->cd_segs[0]),\n\t\t\t       offset, prot, BUS_DMA_WAITOK);\n}"
  },
  {
    "function_name": "cmpci_round_buffersize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1457-1466",
    "snippet": "u_long\ncmpci_round_buffersize(handle, bufsize)\n\tvoid *handle;\n\tu_long bufsize;\n{\n\tif (bufsize > 0x10000)\n\t    bufsize = 0x10000;\n    \n\treturn bufsize;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u_long cmpci_round_buffersize",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nu_long cmpci_round_buffersize;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nu_long\ncmpci_round_buffersize(handle, bufsize)\n\tvoid *handle;\n\tu_long bufsize;\n{\n\tif (bufsize > 0x10000)\n\t    bufsize = 0x10000;\n    \n\treturn bufsize;\n}"
  },
  {
    "function_name": "cmpci_get_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1389-1454",
    "snippet": "int\ncmpci_get_port(handle, cp)\n\tvoid *handle;\n\tmixer_ctrl_t *cp;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tswitch (cp->dev) {\n\tcase CMPCI_MIC_VOL:\n\tcase CMPCI_LINE_IN_VOL:\n\t\tif (cp->un.value.num_channels != 1)\n\t\t    return EINVAL;\n\t\t/* FALLTHROUGH */\n\tcase CMPCI_TREBLE:\n\tcase CMPCI_BASS:\n\tcase CMPCI_PCSPEAKER:\n\tcase CMPCI_INPUT_GAIN:\n\tcase CMPCI_OUTPUT_GAIN:\n\tcase CMPCI_VOICE_VOL:\n\tcase CMPCI_FM_VOL:\n\tcase CMPCI_CD_VOL:\n\tcase CMPCI_MASTER_VOL:\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO] = \n\t\t\t    sc->gain[cp->dev][CMPCI_LEFT];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_LEFT] = \n\t\t\t    sc->gain[cp->dev][CMPCI_LEFT];\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT] = \n\t\t\t    sc->gain[cp->dev][CMPCI_RIGHT];\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn EINVAL;\n\t\t}\n\t\tbreak;\n\n\tcase CMPCI_RECORD_SOURCE:\n\t\tcp->un.mask = sc->in_mask;\n\t\tbreak;\n\n\tcase CMPCI_AGC:\n\t\tcp->un.ord = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_AGC);\n\t\tbreak;\n\n\tcase CMPCI_CD_IN_MUTE:\n\tcase CMPCI_MIC_IN_MUTE:\n\tcase CMPCI_LINE_IN_MUTE:\n\tcase CMPCI_FM_IN_MUTE:\n\tcase CMPCI_CD_SWAP:\n\tcase CMPCI_MIC_SWAP:\n\tcase CMPCI_LINE_SWAP:\n\tcase CMPCI_FM_SWAP:\n\tcase CMPCI_CD_OUT_MUTE:\n\tcase CMPCI_MIC_OUT_MUTE:\n\tcase CMPCI_LINE_OUT_MUTE:\n\t\tcp->un.ord = sc->gain[cp->dev][CMPCI_LR];\n\t\tbreak;\n\n\tdefault:\n\t\treturn EINVAL;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline uint8_t cmpci_mixerreg_read",
      "int cmpci_get_port",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_mixerreg_read",
          "args": [
            "sc",
            "CMPCI_SB16_MIXER_AGC"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_mixerreg_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "187-198",
          "snippet": "static __inline uint8_t\ncmpci_mixerreg_read(sc, no)\n\tstruct cmpci_softc *sc;\n\tuint8_t no;\n{\n\tuint8_t ret;\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tret = bus_space_read_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA);\n\tdelay(10);\n\treturn ret;\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline uint8_t cmpci_mixerreg_read",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline uint8_t cmpci_mixerreg_read;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline uint8_t\ncmpci_mixerreg_read(sc, no)\n\tstruct cmpci_softc *sc;\n\tuint8_t no;\n{\n\tuint8_t ret;\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tret = bus_space_read_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA);\n\tdelay(10);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline uint8_t cmpci_mixerreg_read;\nint cmpci_get_port;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_get_port(handle, cp)\n\tvoid *handle;\n\tmixer_ctrl_t *cp;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tswitch (cp->dev) {\n\tcase CMPCI_MIC_VOL:\n\tcase CMPCI_LINE_IN_VOL:\n\t\tif (cp->un.value.num_channels != 1)\n\t\t    return EINVAL;\n\t\t/* FALLTHROUGH */\n\tcase CMPCI_TREBLE:\n\tcase CMPCI_BASS:\n\tcase CMPCI_PCSPEAKER:\n\tcase CMPCI_INPUT_GAIN:\n\tcase CMPCI_OUTPUT_GAIN:\n\tcase CMPCI_VOICE_VOL:\n\tcase CMPCI_FM_VOL:\n\tcase CMPCI_CD_VOL:\n\tcase CMPCI_MASTER_VOL:\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO] = \n\t\t\t    sc->gain[cp->dev][CMPCI_LEFT];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_LEFT] = \n\t\t\t    sc->gain[cp->dev][CMPCI_LEFT];\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT] = \n\t\t\t    sc->gain[cp->dev][CMPCI_RIGHT];\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn EINVAL;\n\t\t}\n\t\tbreak;\n\n\tcase CMPCI_RECORD_SOURCE:\n\t\tcp->un.mask = sc->in_mask;\n\t\tbreak;\n\n\tcase CMPCI_AGC:\n\t\tcp->un.ord = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_AGC);\n\t\tbreak;\n\n\tcase CMPCI_CD_IN_MUTE:\n\tcase CMPCI_MIC_IN_MUTE:\n\tcase CMPCI_LINE_IN_MUTE:\n\tcase CMPCI_FM_IN_MUTE:\n\tcase CMPCI_CD_SWAP:\n\tcase CMPCI_MIC_SWAP:\n\tcase CMPCI_LINE_SWAP:\n\tcase CMPCI_FM_SWAP:\n\tcase CMPCI_CD_OUT_MUTE:\n\tcase CMPCI_MIC_OUT_MUTE:\n\tcase CMPCI_LINE_OUT_MUTE:\n\t\tcp->un.ord = sc->gain[cp->dev][CMPCI_LR];\n\t\tbreak;\n\n\tdefault:\n\t\treturn EINVAL;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_set_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1238-1387",
    "snippet": "int\ncmpci_set_port(handle, cp)\n\tvoid *handle;\n\tmixer_ctrl_t *cp;\n{\n\tstruct cmpci_softc *sc = handle;\n\tint lgain, rgain;\n\tint mask, bits;\n\tint lmask, rmask, lbits, rbits;\n\tint mute, swap;\n\t\n\tswitch (cp->dev) {\n\tcase CMPCI_TREBLE:\n\tcase CMPCI_BASS:\n\tcase CMPCI_PCSPEAKER:\n\tcase CMPCI_INPUT_GAIN:\n\tcase CMPCI_OUTPUT_GAIN:\n\tcase CMPCI_MIC_VOL:\n\tcase CMPCI_LINE_IN_VOL:\n\tcase CMPCI_VOICE_VOL:\n\tcase CMPCI_FM_VOL:\n\tcase CMPCI_CD_VOL:\n\tcase CMPCI_MASTER_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE)\n\t\t\treturn EINVAL;\n\t\tswitch (cp->dev) {\n\t\tcase CMPCI_MIC_VOL:\n\t\t\tif (cp->un.value.num_channels != 1)\n\t\t\t\treturn EINVAL;\n\n\t\t\tlgain = rgain = CMPCI_ADJUST_MIC_GAIN(sc, \n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tcase CMPCI_PCSPEAKER:\n\t\t\tif (cp->un.value.num_channels != 1)\n\t\t\t    return EINVAL;\n\t\t\t/* FALLTHROUGH */\n\t\tcase CMPCI_INPUT_GAIN:\n\t\tcase CMPCI_OUTPUT_GAIN:\n\t\t\tlgain = rgain = CMPCI_ADJUST_2_GAIN(sc, \n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tswitch (cp->un.value.num_channels) {\n\t\t\tcase 1:\n\t\t\t\tlgain = rgain = CMPCI_ADJUST_GAIN(sc, \n\t\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tlgain = CMPCI_ADJUST_GAIN(sc, \n\t\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]);\n\t\t\t\trgain = CMPCI_ADJUST_GAIN(sc, \n\t\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn EINVAL;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tsc->gain[cp->dev][CMPCI_LEFT]  = lgain;\n\t\tsc->gain[cp->dev][CMPCI_RIGHT] = rgain;\n\n\t\tcmpci_set_mixer_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase CMPCI_RECORD_SOURCE:\n\t\tif (cp->type != AUDIO_MIXER_SET)\n\t\t\treturn EINVAL;\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\tif ( cp->un.mask&(1<<CMPCI_SPDIF_IN) )\n\t\t\tcp->un.mask = 1<<CMPCI_SPDIF_IN;\n#endif\n\t\treturn cmpci_set_in_ports(sc, cp->un.mask);\n\n\tcase CMPCI_AGC:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_AGC, cp->un.ord & 1);\n\t\tbreak;\n\tcase CMPCI_CD_OUT_MUTE:\n\t\tmask = CMPCI_SB16_SW_CD;\n\t\tgoto omute;\n\tcase CMPCI_MIC_OUT_MUTE:\n\t\tmask = CMPCI_SB16_SW_MIC;\n\t\tgoto omute;\n\tcase CMPCI_LINE_OUT_MUTE:\n\t\tmask = CMPCI_SB16_SW_LINE;\n\tomute:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn EINVAL;\n\t\tbits = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_OUTMIX);\n\t\tsc->gain[cp->dev][CMPCI_LR] = cp->un.ord != 0;\n\t\tif (cp->un.ord)\n\t\t\tbits = bits & ~mask;\n\t\telse\n\t\t\tbits = bits | mask;\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_OUTMIX, bits);\n\t\tbreak;\n\n\tcase CMPCI_MIC_IN_MUTE:\n\tcase CMPCI_MIC_SWAP:\n\t\tlmask = rmask = CMPCI_SB16_SW_MIC;\n\t\tgoto imute;\n\tcase CMPCI_CD_IN_MUTE:\n\tcase CMPCI_CD_SWAP:\n\t\tlmask = CMPCI_SB16_SW_CD_L;\n\t\trmask = CMPCI_SB16_SW_CD_R;\n\t\tgoto imute;\n\tcase CMPCI_LINE_IN_MUTE:\n\tcase CMPCI_LINE_SWAP:\n\t\tlmask = CMPCI_SB16_SW_LINE_L;\n\t\trmask = CMPCI_SB16_SW_LINE_R;\n\t\tgoto imute;\n\tcase CMPCI_FM_IN_MUTE:\n\tcase CMPCI_FM_SWAP:\n\t\tlmask = CMPCI_SB16_SW_FM_L;\n\t\trmask = CMPCI_SB16_SW_FM_R;\n\timute:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn EINVAL;\n\t\tmask = lmask | rmask;\n\t\tlbits = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_ADCMIX_L)\n\t\t    & ~mask;\n\t\trbits = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_ADCMIX_R)\n\t\t    & ~mask;\n\t\tsc->gain[cp->dev][CMPCI_LR] = cp->un.ord != 0;\n\t\tif (CMPCI_IS_IN_MUTE(cp->dev)) {\n\t\t\tmute = cp->dev;\n\t\t\tswap = mute - CMPCI_CD_IN_MUTE + CMPCI_CD_SWAP;\n\t\t} else {\n\t\t\tswap = cp->dev;\n\t\t\tmute = swap + CMPCI_CD_IN_MUTE - CMPCI_CD_SWAP;\n\t\t}\n\t\tif (sc->gain[swap][CMPCI_LR]) {\n\t\t\tmask = lmask;\n\t\t\tlmask = rmask;\n\t\t\trmask = mask;\n\t\t}\n\t\tif (!sc->gain[mute][CMPCI_LR]) {\n\t\t\tlbits = lbits | lmask;\n\t\t\trbits = rbits | rmask;\n\t\t}\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, lbits);\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, rbits);\n\t\tbreak;\n\n\tdefault:\n\t\treturn EINVAL;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline uint8_t cmpci_mixerreg_read",
      "static __inline void cmpci_mixerreg_write",
      "static void cmpci_set_mixer_gain",
      "static int cmpci_set_in_ports",
      "int cmpci_set_port",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_mixerreg_write",
          "args": [
            "sc",
            "CMPCI_SB16_MIXER_ADCMIX_R",
            "rbits"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_mixerreg_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "200-209",
          "snippet": "static __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_mixerreg_write",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CMPCI_IS_IN_MUTE",
          "args": [
            "cp->dev"
          ],
          "line": 1362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_mixerreg_read",
          "args": [
            "sc",
            "CMPCI_SB16_MIXER_ADCMIX_R"
          ],
          "line": 1359
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_mixerreg_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "187-198",
          "snippet": "static __inline uint8_t\ncmpci_mixerreg_read(sc, no)\n\tstruct cmpci_softc *sc;\n\tuint8_t no;\n{\n\tuint8_t ret;\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tret = bus_space_read_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA);\n\tdelay(10);\n\treturn ret;\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline uint8_t cmpci_mixerreg_read",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline uint8_t cmpci_mixerreg_read;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline uint8_t\ncmpci_mixerreg_read(sc, no)\n\tstruct cmpci_softc *sc;\n\tuint8_t no;\n{\n\tuint8_t ret;\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tret = bus_space_read_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA);\n\tdelay(10);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_set_in_ports",
          "args": [
            "sc",
            "cp->un.mask"
          ],
          "line": 1310
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_set_in_ports",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "1204-1236",
          "snippet": "int\ncmpci_set_in_ports(sc, mask)\n\tstruct cmpci_softc *sc;\n\tint mask;\n{\n\tint bitsl, bitsr;\n\n\tif (mask & ~((1<<CMPCI_FM_VOL) | (1<<CMPCI_LINE_IN_VOL) |\n\t\t     (1<<CMPCI_CD_VOL) | (1<<CMPCI_MIC_VOL)\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t     | (1<<CMPCI_SPDIF_IN)\n#endif\n\t\t     ))\n\t\treturn EINVAL;\n\tbitsr = 0;\n\tif (mask & (1<<CMPCI_FM_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_FM_SRC_R;\n\tif (mask & (1<<CMPCI_LINE_IN_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_LINE_SRC_R;\n\tif (mask & (1<<CMPCI_CD_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_CD_SRC_R;\n\tbitsl = CMPCI_SB16_MIXER_SRC_R_TO_L(bitsr);\n\tif (mask & (1<<CMPCI_MIC_VOL)) {\n\t\tbitsl |= CMPCI_SB16_MIXER_MIC_SRC;\n\t\tbitsr |= CMPCI_SB16_MIXER_MIC_SRC;\n\t}\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, bitsl);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, bitsr);\n\n\tsc->in_mask = mask;\n\n\treturn 0;\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_mixerreg_write",
            "static int cmpci_set_in_ports",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstatic int cmpci_set_in_ports;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nint\ncmpci_set_in_ports(sc, mask)\n\tstruct cmpci_softc *sc;\n\tint mask;\n{\n\tint bitsl, bitsr;\n\n\tif (mask & ~((1<<CMPCI_FM_VOL) | (1<<CMPCI_LINE_IN_VOL) |\n\t\t     (1<<CMPCI_CD_VOL) | (1<<CMPCI_MIC_VOL)\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t     | (1<<CMPCI_SPDIF_IN)\n#endif\n\t\t     ))\n\t\treturn EINVAL;\n\tbitsr = 0;\n\tif (mask & (1<<CMPCI_FM_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_FM_SRC_R;\n\tif (mask & (1<<CMPCI_LINE_IN_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_LINE_SRC_R;\n\tif (mask & (1<<CMPCI_CD_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_CD_SRC_R;\n\tbitsl = CMPCI_SB16_MIXER_SRC_R_TO_L(bitsr);\n\tif (mask & (1<<CMPCI_MIC_VOL)) {\n\t\tbitsl |= CMPCI_SB16_MIXER_MIC_SRC;\n\t\tbitsr |= CMPCI_SB16_MIXER_MIC_SRC;\n\t}\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, bitsl);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, bitsr);\n\n\tsc->in_mask = mask;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_set_mixer_gain",
          "args": [
            "sc",
            "cp->dev"
          ],
          "line": 1300
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_set_mixer_gain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "1154-1202",
          "snippet": "void\ncmpci_set_mixer_gain(sc, port)\n\tstruct cmpci_softc *sc;\n\tint port;\n{\n\tint src;\n\n\tswitch (port) {\n\tcase CMPCI_MIC_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MIC;\n\t\tbreak;\n\tcase CMPCI_MASTER_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MASTER_L;\n\t\tbreak;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_LINE_L;\n\t\tbreak;\n\tcase CMPCI_VOICE_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_VOICE_L;\n\t\tbreak;\n\tcase CMPCI_FM_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_FM_L;\n\t\tbreak;\n\tcase CMPCI_CD_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_CDDA_L;\n\t\tbreak;\n\tcase CMPCI_INPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_INGAIN_L;\n\t\tbreak;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_OUTGAIN_L;\n\t\tbreak;\n\tcase CMPCI_TREBLE:\n\t\tsrc = CMPCI_SB16_MIXER_TREBLE_L;\n\t\tbreak;\n\tcase CMPCI_BASS:\n\t\tsrc = CMPCI_SB16_MIXER_BASS_L;\n\t\tbreak;\n\tcase CMPCI_PCSPEAKER:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_SPEAKER,\n\t\t\t\t     sc->gain[port][CMPCI_LEFT]);\n\t\treturn;\n\tdefault:\n\t\treturn;\n\t}\n\tcmpci_mixerreg_write(sc, src, sc->gain[port][CMPCI_LEFT]);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_L_TO_R(src),\n\t\t\t     sc->gain[port][CMPCI_RIGHT]);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_mixerreg_write",
            "static void cmpci_set_mixer_gain",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstatic void cmpci_set_mixer_gain;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nvoid\ncmpci_set_mixer_gain(sc, port)\n\tstruct cmpci_softc *sc;\n\tint port;\n{\n\tint src;\n\n\tswitch (port) {\n\tcase CMPCI_MIC_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MIC;\n\t\tbreak;\n\tcase CMPCI_MASTER_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MASTER_L;\n\t\tbreak;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_LINE_L;\n\t\tbreak;\n\tcase CMPCI_VOICE_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_VOICE_L;\n\t\tbreak;\n\tcase CMPCI_FM_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_FM_L;\n\t\tbreak;\n\tcase CMPCI_CD_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_CDDA_L;\n\t\tbreak;\n\tcase CMPCI_INPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_INGAIN_L;\n\t\tbreak;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_OUTGAIN_L;\n\t\tbreak;\n\tcase CMPCI_TREBLE:\n\t\tsrc = CMPCI_SB16_MIXER_TREBLE_L;\n\t\tbreak;\n\tcase CMPCI_BASS:\n\t\tsrc = CMPCI_SB16_MIXER_BASS_L;\n\t\tbreak;\n\tcase CMPCI_PCSPEAKER:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_SPEAKER,\n\t\t\t\t     sc->gain[port][CMPCI_LEFT]);\n\t\treturn;\n\tdefault:\n\t\treturn;\n\t}\n\tcmpci_mixerreg_write(sc, src, sc->gain[port][CMPCI_LEFT]);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_L_TO_R(src),\n\t\t\t     sc->gain[port][CMPCI_RIGHT]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CMPCI_ADJUST_GAIN",
          "args": [
            "sc",
            "cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMPCI_ADJUST_GAIN",
          "args": [
            "sc",
            "cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMPCI_ADJUST_GAIN",
          "args": [
            "sc",
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMPCI_ADJUST_2_GAIN",
          "args": [
            "sc",
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMPCI_ADJUST_MIC_GAIN",
          "args": [
            "sc",
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline uint8_t cmpci_mixerreg_read;\nstatic __inline void cmpci_mixerreg_write;\nstatic void cmpci_set_mixer_gain;\nstatic int cmpci_set_in_ports;\nint cmpci_set_port;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_set_port(handle, cp)\n\tvoid *handle;\n\tmixer_ctrl_t *cp;\n{\n\tstruct cmpci_softc *sc = handle;\n\tint lgain, rgain;\n\tint mask, bits;\n\tint lmask, rmask, lbits, rbits;\n\tint mute, swap;\n\t\n\tswitch (cp->dev) {\n\tcase CMPCI_TREBLE:\n\tcase CMPCI_BASS:\n\tcase CMPCI_PCSPEAKER:\n\tcase CMPCI_INPUT_GAIN:\n\tcase CMPCI_OUTPUT_GAIN:\n\tcase CMPCI_MIC_VOL:\n\tcase CMPCI_LINE_IN_VOL:\n\tcase CMPCI_VOICE_VOL:\n\tcase CMPCI_FM_VOL:\n\tcase CMPCI_CD_VOL:\n\tcase CMPCI_MASTER_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE)\n\t\t\treturn EINVAL;\n\t\tswitch (cp->dev) {\n\t\tcase CMPCI_MIC_VOL:\n\t\t\tif (cp->un.value.num_channels != 1)\n\t\t\t\treturn EINVAL;\n\n\t\t\tlgain = rgain = CMPCI_ADJUST_MIC_GAIN(sc, \n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tcase CMPCI_PCSPEAKER:\n\t\t\tif (cp->un.value.num_channels != 1)\n\t\t\t    return EINVAL;\n\t\t\t/* FALLTHROUGH */\n\t\tcase CMPCI_INPUT_GAIN:\n\t\tcase CMPCI_OUTPUT_GAIN:\n\t\t\tlgain = rgain = CMPCI_ADJUST_2_GAIN(sc, \n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tswitch (cp->un.value.num_channels) {\n\t\t\tcase 1:\n\t\t\t\tlgain = rgain = CMPCI_ADJUST_GAIN(sc, \n\t\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tlgain = CMPCI_ADJUST_GAIN(sc, \n\t\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]);\n\t\t\t\trgain = CMPCI_ADJUST_GAIN(sc, \n\t\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn EINVAL;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tsc->gain[cp->dev][CMPCI_LEFT]  = lgain;\n\t\tsc->gain[cp->dev][CMPCI_RIGHT] = rgain;\n\n\t\tcmpci_set_mixer_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase CMPCI_RECORD_SOURCE:\n\t\tif (cp->type != AUDIO_MIXER_SET)\n\t\t\treturn EINVAL;\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\tif ( cp->un.mask&(1<<CMPCI_SPDIF_IN) )\n\t\t\tcp->un.mask = 1<<CMPCI_SPDIF_IN;\n#endif\n\t\treturn cmpci_set_in_ports(sc, cp->un.mask);\n\n\tcase CMPCI_AGC:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_AGC, cp->un.ord & 1);\n\t\tbreak;\n\tcase CMPCI_CD_OUT_MUTE:\n\t\tmask = CMPCI_SB16_SW_CD;\n\t\tgoto omute;\n\tcase CMPCI_MIC_OUT_MUTE:\n\t\tmask = CMPCI_SB16_SW_MIC;\n\t\tgoto omute;\n\tcase CMPCI_LINE_OUT_MUTE:\n\t\tmask = CMPCI_SB16_SW_LINE;\n\tomute:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn EINVAL;\n\t\tbits = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_OUTMIX);\n\t\tsc->gain[cp->dev][CMPCI_LR] = cp->un.ord != 0;\n\t\tif (cp->un.ord)\n\t\t\tbits = bits & ~mask;\n\t\telse\n\t\t\tbits = bits | mask;\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_OUTMIX, bits);\n\t\tbreak;\n\n\tcase CMPCI_MIC_IN_MUTE:\n\tcase CMPCI_MIC_SWAP:\n\t\tlmask = rmask = CMPCI_SB16_SW_MIC;\n\t\tgoto imute;\n\tcase CMPCI_CD_IN_MUTE:\n\tcase CMPCI_CD_SWAP:\n\t\tlmask = CMPCI_SB16_SW_CD_L;\n\t\trmask = CMPCI_SB16_SW_CD_R;\n\t\tgoto imute;\n\tcase CMPCI_LINE_IN_MUTE:\n\tcase CMPCI_LINE_SWAP:\n\t\tlmask = CMPCI_SB16_SW_LINE_L;\n\t\trmask = CMPCI_SB16_SW_LINE_R;\n\t\tgoto imute;\n\tcase CMPCI_FM_IN_MUTE:\n\tcase CMPCI_FM_SWAP:\n\t\tlmask = CMPCI_SB16_SW_FM_L;\n\t\trmask = CMPCI_SB16_SW_FM_R;\n\timute:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn EINVAL;\n\t\tmask = lmask | rmask;\n\t\tlbits = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_ADCMIX_L)\n\t\t    & ~mask;\n\t\trbits = cmpci_mixerreg_read(sc, CMPCI_SB16_MIXER_ADCMIX_R)\n\t\t    & ~mask;\n\t\tsc->gain[cp->dev][CMPCI_LR] = cp->un.ord != 0;\n\t\tif (CMPCI_IS_IN_MUTE(cp->dev)) {\n\t\t\tmute = cp->dev;\n\t\t\tswap = mute - CMPCI_CD_IN_MUTE + CMPCI_CD_SWAP;\n\t\t} else {\n\t\t\tswap = cp->dev;\n\t\t\tmute = swap + CMPCI_CD_IN_MUTE - CMPCI_CD_SWAP;\n\t\t}\n\t\tif (sc->gain[swap][CMPCI_LR]) {\n\t\t\tmask = lmask;\n\t\t\tlmask = rmask;\n\t\t\trmask = mask;\n\t\t}\n\t\tif (!sc->gain[mute][CMPCI_LR]) {\n\t\t\tlbits = lbits | lmask;\n\t\t\trbits = rbits | rmask;\n\t\t}\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, lbits);\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, rbits);\n\t\tbreak;\n\n\tdefault:\n\t\treturn EINVAL;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_set_in_ports",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1204-1236",
    "snippet": "int\ncmpci_set_in_ports(sc, mask)\n\tstruct cmpci_softc *sc;\n\tint mask;\n{\n\tint bitsl, bitsr;\n\n\tif (mask & ~((1<<CMPCI_FM_VOL) | (1<<CMPCI_LINE_IN_VOL) |\n\t\t     (1<<CMPCI_CD_VOL) | (1<<CMPCI_MIC_VOL)\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t     | (1<<CMPCI_SPDIF_IN)\n#endif\n\t\t     ))\n\t\treturn EINVAL;\n\tbitsr = 0;\n\tif (mask & (1<<CMPCI_FM_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_FM_SRC_R;\n\tif (mask & (1<<CMPCI_LINE_IN_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_LINE_SRC_R;\n\tif (mask & (1<<CMPCI_CD_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_CD_SRC_R;\n\tbitsl = CMPCI_SB16_MIXER_SRC_R_TO_L(bitsr);\n\tif (mask & (1<<CMPCI_MIC_VOL)) {\n\t\tbitsl |= CMPCI_SB16_MIXER_MIC_SRC;\n\t\tbitsr |= CMPCI_SB16_MIXER_MIC_SRC;\n\t}\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, bitsl);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, bitsr);\n\n\tsc->in_mask = mask;\n\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_mixerreg_write",
      "static int cmpci_set_in_ports",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_mixerreg_write",
          "args": [
            "sc",
            "CMPCI_SB16_MIXER_ADCMIX_R",
            "bitsr"
          ],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_mixerreg_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "200-209",
          "snippet": "static __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_mixerreg_write",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CMPCI_SB16_MIXER_SRC_R_TO_L",
          "args": [
            "bitsr"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstatic int cmpci_set_in_ports;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nint\ncmpci_set_in_ports(sc, mask)\n\tstruct cmpci_softc *sc;\n\tint mask;\n{\n\tint bitsl, bitsr;\n\n\tif (mask & ~((1<<CMPCI_FM_VOL) | (1<<CMPCI_LINE_IN_VOL) |\n\t\t     (1<<CMPCI_CD_VOL) | (1<<CMPCI_MIC_VOL)\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t     | (1<<CMPCI_SPDIF_IN)\n#endif\n\t\t     ))\n\t\treturn EINVAL;\n\tbitsr = 0;\n\tif (mask & (1<<CMPCI_FM_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_FM_SRC_R;\n\tif (mask & (1<<CMPCI_LINE_IN_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_LINE_SRC_R;\n\tif (mask & (1<<CMPCI_CD_VOL))\n\t\tbitsr |= CMPCI_SB16_MIXER_CD_SRC_R;\n\tbitsl = CMPCI_SB16_MIXER_SRC_R_TO_L(bitsr);\n\tif (mask & (1<<CMPCI_MIC_VOL)) {\n\t\tbitsl |= CMPCI_SB16_MIXER_MIC_SRC;\n\t\tbitsr |= CMPCI_SB16_MIXER_MIC_SRC;\n\t}\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, bitsl);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, bitsr);\n\n\tsc->in_mask = mask;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_set_mixer_gain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1154-1202",
    "snippet": "void\ncmpci_set_mixer_gain(sc, port)\n\tstruct cmpci_softc *sc;\n\tint port;\n{\n\tint src;\n\n\tswitch (port) {\n\tcase CMPCI_MIC_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MIC;\n\t\tbreak;\n\tcase CMPCI_MASTER_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MASTER_L;\n\t\tbreak;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_LINE_L;\n\t\tbreak;\n\tcase CMPCI_VOICE_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_VOICE_L;\n\t\tbreak;\n\tcase CMPCI_FM_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_FM_L;\n\t\tbreak;\n\tcase CMPCI_CD_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_CDDA_L;\n\t\tbreak;\n\tcase CMPCI_INPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_INGAIN_L;\n\t\tbreak;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_OUTGAIN_L;\n\t\tbreak;\n\tcase CMPCI_TREBLE:\n\t\tsrc = CMPCI_SB16_MIXER_TREBLE_L;\n\t\tbreak;\n\tcase CMPCI_BASS:\n\t\tsrc = CMPCI_SB16_MIXER_BASS_L;\n\t\tbreak;\n\tcase CMPCI_PCSPEAKER:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_SPEAKER,\n\t\t\t\t     sc->gain[port][CMPCI_LEFT]);\n\t\treturn;\n\tdefault:\n\t\treturn;\n\t}\n\tcmpci_mixerreg_write(sc, src, sc->gain[port][CMPCI_LEFT]);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_L_TO_R(src),\n\t\t\t     sc->gain[port][CMPCI_RIGHT]);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_mixerreg_write",
      "static void cmpci_set_mixer_gain",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_mixerreg_write",
          "args": [
            "sc",
            "CMPCI_SB16_MIXER_L_TO_R(src)",
            "sc->gain[port][CMPCI_RIGHT]"
          ],
          "line": 1200
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_mixerreg_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "200-209",
          "snippet": "static __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_mixerreg_write",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CMPCI_SB16_MIXER_L_TO_R",
          "args": [
            "src"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstatic void cmpci_set_mixer_gain;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nvoid\ncmpci_set_mixer_gain(sc, port)\n\tstruct cmpci_softc *sc;\n\tint port;\n{\n\tint src;\n\n\tswitch (port) {\n\tcase CMPCI_MIC_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MIC;\n\t\tbreak;\n\tcase CMPCI_MASTER_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MASTER_L;\n\t\tbreak;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_LINE_L;\n\t\tbreak;\n\tcase CMPCI_VOICE_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_VOICE_L;\n\t\tbreak;\n\tcase CMPCI_FM_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_FM_L;\n\t\tbreak;\n\tcase CMPCI_CD_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_CDDA_L;\n\t\tbreak;\n\tcase CMPCI_INPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_INGAIN_L;\n\t\tbreak;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_OUTGAIN_L;\n\t\tbreak;\n\tcase CMPCI_TREBLE:\n\t\tsrc = CMPCI_SB16_MIXER_TREBLE_L;\n\t\tbreak;\n\tcase CMPCI_BASS:\n\t\tsrc = CMPCI_SB16_MIXER_BASS_L;\n\t\tbreak;\n\tcase CMPCI_PCSPEAKER:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_SPEAKER,\n\t\t\t\t     sc->gain[port][CMPCI_LEFT]);\n\t\treturn;\n\tdefault:\n\t\treturn;\n\t}\n\tcmpci_mixerreg_write(sc, src, sc->gain[port][CMPCI_LEFT]);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_L_TO_R(src),\n\t\t\t     sc->gain[port][CMPCI_RIGHT]);\n}"
  },
  {
    "function_name": "cmpci_adjust",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1144-1152",
    "snippet": "int\ncmpci_adjust(val, mask)\n    int val, mask;\n{\n\tval += (MAXVAL - mask) >> 1;\n\tif (val >= MAXVAL)\n\t\tval = MAXVAL-1;\n\treturn val & mask;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define MAXVAL 256"
    ],
    "globals_used": [
      "static int cmpci_adjust"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MAXVAL 256\n\nstatic int cmpci_adjust;\n\nint\ncmpci_adjust(val, mask)\n    int val, mask;\n{\n\tval += (MAXVAL - mask) >> 1;\n\tif (val >= MAXVAL)\n\t\tval = MAXVAL-1;\n\treturn val & mask;\n}"
  },
  {
    "function_name": "cmpci_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1132-1141",
    "snippet": "void\ncmpci_free(handle, addr, type)\n\tvoid    *handle;\n\tvoid    *addr;\n\tint     type;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tcmpci_free_dmamem(sc, addr, type);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_free_dmamem",
      "void cmpci_free",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "caddr_t addr;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_free_dmamem",
          "args": [
            "sc",
            "addr",
            "type"
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_free_dmamem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "1068-1090",
          "snippet": "int\ncmpci_free_dmamem(sc, addr, type)\n\tstruct cmpci_softc *sc;\n\tcaddr_t addr;\n\tint type;\n{\n    struct cmpci_dmanode **nnp;\n\n\tfor (nnp = &sc->sc_dmap; *nnp; nnp = &(*nnp)->cd_next) {\n\t\tif ((*nnp)->cd_addr == addr) {\n\t\t\tstruct cmpci_dmanode *n = *nnp;\n\n\t\t\tbus_dmamap_unload(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamap_destroy(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamem_unmap(n->cd_tag, n->cd_addr, n->cd_size);\n\t\t\tbus_dmamem_free(n->cd_tag, n->cd_segs,\n\t\t\t    sizeof(n->cd_segs)/sizeof(n->cd_segs[0]));\n\t\t\tfree(n, type);\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int cmpci_free_dmamem",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
            "caddr_t addr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_free_dmamem;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\ncaddr_t addr;\n\nint\ncmpci_free_dmamem(sc, addr, type)\n\tstruct cmpci_softc *sc;\n\tcaddr_t addr;\n\tint type;\n{\n    struct cmpci_dmanode **nnp;\n\n\tfor (nnp = &sc->sc_dmap; *nnp; nnp = &(*nnp)->cd_next) {\n\t\tif ((*nnp)->cd_addr == addr) {\n\t\t\tstruct cmpci_dmanode *n = *nnp;\n\n\t\t\tbus_dmamap_unload(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamap_destroy(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamem_unmap(n->cd_tag, n->cd_addr, n->cd_size);\n\t\t\tbus_dmamem_free(n->cd_tag, n->cd_segs,\n\t\t\t    sizeof(n->cd_segs)/sizeof(n->cd_segs[0]));\n\t\t\tfree(n, type);\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_free_dmamem;\nvoid cmpci_free;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\ncaddr_t addr;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nvoid\ncmpci_free(handle, addr, type)\n\tvoid    *handle;\n\tvoid    *addr;\n\tint     type;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tcmpci_free_dmamem(sc, addr, type);\n}"
  },
  {
    "function_name": "cmpci_print_dmamem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1108-1115",
    "snippet": "void\ncmpci_print_dmamem(p)\n\tstruct cmpci_dmanode *p;\n{\n\tDPRINTF((\"DMA at virt:%p, dmaseg:%p, mapseg:%p, size:%p\\n\",\n\t\t (void *)p->cd_addr, (void *)p->cd_segs[0].ds_addr,\n\t\t (void *)DMAADDR(p), (void *)p->cd_size));\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u_long size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"DMA at virt:%p, dmaseg:%p, mapseg:%p, size:%p\\n\",\n\t\t (void *)p->cd_addr, (void *)p->cd_segs[0].ds_addr,\n\t\t (void *)DMAADDR(p), (void *)p->cd_size)"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMAADDR",
          "args": [
            "p"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nu_long size;\n\nvoid\ncmpci_print_dmamem(p)\n\tstruct cmpci_dmanode *p;\n{\n\tDPRINTF((\"DMA at virt:%p, dmaseg:%p, mapseg:%p, size:%p\\n\",\n\t\t (void *)p->cd_addr, (void *)p->cd_segs[0].ds_addr,\n\t\t (void *)DMAADDR(p), (void *)p->cd_size));\n}"
  },
  {
    "function_name": "cmpci_free_dmamem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1068-1090",
    "snippet": "int\ncmpci_free_dmamem(sc, addr, type)\n\tstruct cmpci_softc *sc;\n\tcaddr_t addr;\n\tint type;\n{\n    struct cmpci_dmanode **nnp;\n\n\tfor (nnp = &sc->sc_dmap; *nnp; nnp = &(*nnp)->cd_next) {\n\t\tif ((*nnp)->cd_addr == addr) {\n\t\t\tstruct cmpci_dmanode *n = *nnp;\n\n\t\t\tbus_dmamap_unload(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamap_destroy(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamem_unmap(n->cd_tag, n->cd_addr, n->cd_size);\n\t\t\tbus_dmamem_free(n->cd_tag, n->cd_segs,\n\t\t\t    sizeof(n->cd_segs)/sizeof(n->cd_segs[0]));\n\t\t\tfree(n, type);\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_free_dmamem",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "caddr_t addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "n",
            "type"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "1132-1141",
          "snippet": "void\ncmpci_free(handle, addr, type)\n\tvoid    *handle;\n\tvoid    *addr;\n\tint     type;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tcmpci_free_dmamem(sc, addr, type);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int cmpci_free_dmamem",
            "void cmpci_free",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
            "caddr_t addr;",
            "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_free_dmamem;\nvoid cmpci_free;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\ncaddr_t addr;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nvoid\ncmpci_free(handle, addr, type)\n\tvoid    *handle;\n\tvoid    *addr;\n\tint     type;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tcmpci_free_dmamem(sc, addr, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_dmamem_free",
          "args": [
            "n->cd_tag",
            "n->cd_segs",
            "sizeof(n->cd_segs)/sizeof(n->cd_segs[0])"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_unmap",
          "args": [
            "n->cd_tag",
            "n->cd_addr",
            "n->cd_size"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_destroy",
          "args": [
            "n->cd_tag",
            "n->cd_map"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_unload",
          "args": [
            "n->cd_tag",
            "n->cd_map"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_free_dmamem;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\ncaddr_t addr;\n\nint\ncmpci_free_dmamem(sc, addr, type)\n\tstruct cmpci_softc *sc;\n\tcaddr_t addr;\n\tint type;\n{\n    struct cmpci_dmanode **nnp;\n\n\tfor (nnp = &sc->sc_dmap; *nnp; nnp = &(*nnp)->cd_next) {\n\t\tif ((*nnp)->cd_addr == addr) {\n\t\t\tstruct cmpci_dmanode *n = *nnp;\n\n\t\t\tbus_dmamap_unload(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamap_destroy(n->cd_tag, n->cd_map);\n\t\t\tbus_dmamem_unmap(n->cd_tag, n->cd_addr, n->cd_size);\n\t\t\tbus_dmamem_free(n->cd_tag, n->cd_segs,\n\t\t\t    sizeof(n->cd_segs)/sizeof(n->cd_segs[0]));\n\t\t\tfree(n, type);\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "cmpci_alloc_dmamem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "1013-1066",
    "snippet": "int\ncmpci_alloc_dmamem(sc, size, type, flags, r_addr)\n\tstruct cmpci_softc *sc;\n\tsize_t size;\n\tint type, flags;\n\tcaddr_t *r_addr;\n{\n\tint ret = 0;\n\tstruct cmpci_dmanode *n;\n\tint w;\n\t\n\tif ( NULL == (n=malloc(sizeof(struct cmpci_dmanode), type, flags)) ) {\n\t\tret = ENOMEM;\n\t\tgoto quit;\n\t}\n\n\tw = (flags & M_NOWAIT) ? BUS_DMA_NOWAIT : BUS_DMA_WAITOK;\n#define CMPCI_DMABUF_ALIGN    0x4\n#define CMPCI_DMABUF_BOUNDARY 0x0\n\tn->cd_tag = sc->sc_dmat;\n\tn->cd_size = size;\n\tif ( (ret=bus_dmamem_alloc(n->cd_tag, n->cd_size,\n\t\t\t\t   CMPCI_DMABUF_ALIGN, CMPCI_DMABUF_BOUNDARY,\n\t\t\t\t   n->cd_segs,\n\t\t\t\t   sizeof(n->cd_segs)/sizeof(n->cd_segs[0]),\n\t\t\t\t   &n->cd_nsegs, w)) )\n\t\tgoto mfree;\n\tif ( (ret=bus_dmamem_map(n->cd_tag, n->cd_segs, n->cd_nsegs, n->cd_size,\n\t\t\t\t &n->cd_addr, w | BUS_DMA_COHERENT)) )\n\t\tgoto dmafree;\n\tif ( (ret=bus_dmamap_create(n->cd_tag, n->cd_size, 1, n->cd_size, 0,\n\t\t\t\t    w, &n->cd_map)) )\n\t\tgoto unmap;\n\tif ( (ret=bus_dmamap_load(n->cd_tag, n->cd_map, n->cd_addr, n->cd_size,\n\t\t\t\t  NULL, w)) )\n\t\tgoto destroy;\n\n\tn->cd_next = sc->sc_dmap;\n\tsc->sc_dmap = n;\n\t*r_addr = KVADDR(n);\n\treturn 0;\n\t\ndestroy:\n\tbus_dmamap_destroy(n->cd_tag, n->cd_map);\nunmap:\n\tbus_dmamem_unmap(n->cd_tag, n->cd_addr, n->cd_size);\ndmafree:\n\tbus_dmamem_free(n->cd_tag,\n\t\t\tn->cd_segs, sizeof(n->cd_segs)/sizeof(n->cd_segs[0]));\nmfree:\n\tfree(n, type);\nquit:\n\treturn ret;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define CMPCI_DMABUF_BOUNDARY 0x0",
      "#define CMPCI_DMABUF_ALIGN    0x4"
    ],
    "globals_used": [
      "int cmpci_alloc_dmamem",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "u_long size;",
      "int    type, flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "n",
            "type"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "1132-1141",
          "snippet": "void\ncmpci_free(handle, addr, type)\n\tvoid    *handle;\n\tvoid    *addr;\n\tint     type;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tcmpci_free_dmamem(sc, addr, type);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int cmpci_free_dmamem",
            "void cmpci_free",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
            "caddr_t addr;",
            "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_free_dmamem;\nvoid cmpci_free;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\ncaddr_t addr;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nvoid\ncmpci_free(handle, addr, type)\n\tvoid    *handle;\n\tvoid    *addr;\n\tint     type;\n{\n\tstruct cmpci_softc *sc = handle;\n\t\n\tcmpci_free_dmamem(sc, addr, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_dmamem_free",
          "args": [
            "n->cd_tag",
            "n->cd_segs",
            "sizeof(n->cd_segs)/sizeof(n->cd_segs[0])"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_unmap",
          "args": [
            "n->cd_tag",
            "n->cd_addr",
            "n->cd_size"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_destroy",
          "args": [
            "n->cd_tag",
            "n->cd_map"
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KVADDR",
          "args": [
            "n"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_load",
          "args": [
            "n->cd_tag",
            "n->cd_map",
            "n->cd_addr",
            "n->cd_size",
            "NULL",
            "w"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_create",
          "args": [
            "n->cd_tag",
            "n->cd_size",
            "1",
            "n->cd_size",
            "0",
            "w",
            "&n->cd_map"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_map",
          "args": [
            "n->cd_tag",
            "n->cd_segs",
            "n->cd_nsegs",
            "n->cd_size",
            "&n->cd_addr",
            "w | BUS_DMA_COHERENT"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_alloc",
          "args": [
            "n->cd_tag",
            "n->cd_size",
            "CMPCI_DMABUF_ALIGN",
            "CMPCI_DMABUF_BOUNDARY",
            "n->cd_segs",
            "sizeof(n->cd_segs)/sizeof(n->cd_segs[0])",
            "&n->cd_nsegs",
            "w"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct cmpci_dmanode)",
            "type",
            "flags"
          ],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define CMPCI_DMABUF_BOUNDARY 0x0\n#define CMPCI_DMABUF_ALIGN    0x4\n\nint cmpci_alloc_dmamem;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nu_long size;\nint    type, flags;\n\nint\ncmpci_alloc_dmamem(sc, size, type, flags, r_addr)\n\tstruct cmpci_softc *sc;\n\tsize_t size;\n\tint type, flags;\n\tcaddr_t *r_addr;\n{\n\tint ret = 0;\n\tstruct cmpci_dmanode *n;\n\tint w;\n\t\n\tif ( NULL == (n=malloc(sizeof(struct cmpci_dmanode), type, flags)) ) {\n\t\tret = ENOMEM;\n\t\tgoto quit;\n\t}\n\n\tw = (flags & M_NOWAIT) ? BUS_DMA_NOWAIT : BUS_DMA_WAITOK;\n#define CMPCI_DMABUF_ALIGN    0x4\n#define CMPCI_DMABUF_BOUNDARY 0x0\n\tn->cd_tag = sc->sc_dmat;\n\tn->cd_size = size;\n\tif ( (ret=bus_dmamem_alloc(n->cd_tag, n->cd_size,\n\t\t\t\t   CMPCI_DMABUF_ALIGN, CMPCI_DMABUF_BOUNDARY,\n\t\t\t\t   n->cd_segs,\n\t\t\t\t   sizeof(n->cd_segs)/sizeof(n->cd_segs[0]),\n\t\t\t\t   &n->cd_nsegs, w)) )\n\t\tgoto mfree;\n\tif ( (ret=bus_dmamem_map(n->cd_tag, n->cd_segs, n->cd_nsegs, n->cd_size,\n\t\t\t\t &n->cd_addr, w | BUS_DMA_COHERENT)) )\n\t\tgoto dmafree;\n\tif ( (ret=bus_dmamap_create(n->cd_tag, n->cd_size, 1, n->cd_size, 0,\n\t\t\t\t    w, &n->cd_map)) )\n\t\tgoto unmap;\n\tif ( (ret=bus_dmamap_load(n->cd_tag, n->cd_map, n->cd_addr, n->cd_size,\n\t\t\t\t  NULL, w)) )\n\t\tgoto destroy;\n\n\tn->cd_next = sc->sc_dmap;\n\tsc->sc_dmap = n;\n\t*r_addr = KVADDR(n);\n\treturn 0;\n\t\ndestroy:\n\tbus_dmamap_destroy(n->cd_tag, n->cd_map);\nunmap:\n\tbus_dmamem_unmap(n->cd_tag, n->cd_addr, n->cd_size);\ndmafree:\n\tbus_dmamem_free(n->cd_tag,\n\t\t\tn->cd_segs, sizeof(n->cd_segs)/sizeof(n->cd_segs[0]));\nmfree:\n\tfree(n, type);\nquit:\n\treturn ret;\n}"
  },
  {
    "function_name": "cmpci_query_devinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "785-1011",
    "snippet": "int\ncmpci_query_devinfo(handle, dip)\n\tvoid *handle;\n\tmixer_devinfo_t *dip;\n{\n\tstruct cmpci_softc *sc = handle;\n\t(void)sc;\n\n\tswitch (dip->index) {\n\tcase CMPCI_MASTER_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_FM_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_FM_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNfmsynth);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_CD_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_CD_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_VOICE_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_OUTPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCoutputs);\n\t\treturn 0;\n\tcase CMPCI_MIC_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_MIC_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_LINE_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_RECORD_SOURCE:\n\t\tdip->mixer_class = CMPCI_RECORD_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNsource);\n\t\tdip->type = AUDIO_MIXER_SET;\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\tdip->un.s.num_mem = 5;\n#else\n\t\tdip->un.s.num_mem = 4;\n#endif\n\t\tstrcpy(dip->un.s.member[0].label.name, AudioNmicrophone);\n\t\tdip->un.s.member[0].mask = 1 << CMPCI_MIC_VOL;\n\t\tstrcpy(dip->un.s.member[1].label.name, AudioNcd);\n\t\tdip->un.s.member[1].mask = 1 << CMPCI_CD_VOL;\n\t\tstrcpy(dip->un.s.member[2].label.name, AudioNline);\n\t\tdip->un.s.member[2].mask = 1 << CMPCI_LINE_IN_VOL;\n\t\tstrcpy(dip->un.s.member[3].label.name, AudioNfmsynth);\n\t\tdip->un.s.member[3].mask = 1 << CMPCI_FM_VOL;\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\tstrcpy(dip->un.s.member[4].label.name, CmpciNspdif);\n\t\tdip->un.s.member[4].mask = 1 << CMPCI_SPDIF_IN;\n#endif\n\t\treturn 0;\n\tcase CMPCI_BASS:\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNbass);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_EQUALIZATION_CLASS;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNbass);\n\t\treturn 0;\n\tcase CMPCI_TREBLE:\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNtreble);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_EQUALIZATION_CLASS;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNtreble);\n\t\treturn 0;\n\tcase CMPCI_RECORD_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCrecord);\n\t\treturn 0;\n\tcase CMPCI_INPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCinputs);\n\t\treturn 0;\n\tcase CMPCI_PCSPEAKER:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"pc_speaker\");\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_INPUT_GAIN:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNinput);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNoutput);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_AGC:\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"agc\");\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\treturn 0;\n\tcase CMPCI_EQUALIZATION_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_EQUALIZATION_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCequalization);\n\t\treturn 0;\n\tcase CMPCI_CD_IN_MUTE:\n\t\tdip->prev = CMPCI_CD_VOL;\n\t\tdip->next = CMPCI_CD_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_MIC_IN_MUTE:\n\t\tdip->prev = CMPCI_MIC_VOL;\n\t\tdip->next = CMPCI_MIC_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_LINE_IN_MUTE:\n\t\tdip->prev = CMPCI_LINE_IN_VOL;\n\t\tdip->next = CMPCI_LINE_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_FM_IN_MUTE:\n\t\tdip->prev = CMPCI_FM_VOL;\n\t\tdip->next = CMPCI_FM_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_CD_SWAP:\n\t\tdip->prev = CMPCI_CD_IN_MUTE;\n\t\tdip->next = CMPCI_CD_OUT_MUTE;\n\t\tgoto swap;\n\tcase CMPCI_MIC_SWAP:\n\t\tdip->prev = CMPCI_MIC_IN_MUTE;\n\t\tdip->next = CMPCI_MIC_OUT_MUTE;\n\t\tgoto swap;\n\tcase CMPCI_LINE_SWAP:\n\t\tdip->prev = CMPCI_LINE_IN_MUTE;\n\t\tdip->next = CMPCI_LINE_OUT_MUTE;\n\t\tgoto swap;\n\tcase CMPCI_FM_SWAP:\n\t\tdip->prev = CMPCI_FM_IN_MUTE;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\tswap:\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioNswap);\n\t\tgoto mute1;\n\tcase CMPCI_CD_OUT_MUTE:\n\t\tdip->prev = CMPCI_CD_SWAP;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_MIC_OUT_MUTE:\n\t\tdip->prev = CMPCI_MIC_SWAP;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_LINE_OUT_MUTE:\n\t\tdip->prev = CMPCI_LINE_SWAP;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\tmute:\n\t\tstrcpy(dip->label.name, AudioNmute);\n\tmute1:\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\treturn 0;\n\t}\n\n\treturn ENXIO;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_query_devinfo",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNon"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNoff"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmute"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNswap"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCequalization"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNon"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNoff"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"agc\""
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNoutput"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNinput"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"pc_speaker\""
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCinputs"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCrecord"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNtreble"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNtreble"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNbass"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNbass"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.s.member[4].label.name",
            "CmpciNspdif"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.s.member[3].label.name",
            "AudioNfmsynth"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.s.member[2].label.name",
            "AudioNline"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.s.member[1].label.name",
            "AudioNcd"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.s.member[0].label.name",
            "AudioNmicrophone"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNsource"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNline"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmicrophone"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCoutputs"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNdac"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNcd"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNfmsynth"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmaster"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_query_devinfo;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_query_devinfo(handle, dip)\n\tvoid *handle;\n\tmixer_devinfo_t *dip;\n{\n\tstruct cmpci_softc *sc = handle;\n\t(void)sc;\n\n\tswitch (dip->index) {\n\tcase CMPCI_MASTER_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_FM_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_FM_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNfmsynth);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_CD_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_CD_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_VOICE_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_OUTPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCoutputs);\n\t\treturn 0;\n\tcase CMPCI_MIC_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_MIC_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = CMPCI_LINE_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_RECORD_SOURCE:\n\t\tdip->mixer_class = CMPCI_RECORD_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNsource);\n\t\tdip->type = AUDIO_MIXER_SET;\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\tdip->un.s.num_mem = 5;\n#else\n\t\tdip->un.s.num_mem = 4;\n#endif\n\t\tstrcpy(dip->un.s.member[0].label.name, AudioNmicrophone);\n\t\tdip->un.s.member[0].mask = 1 << CMPCI_MIC_VOL;\n\t\tstrcpy(dip->un.s.member[1].label.name, AudioNcd);\n\t\tdip->un.s.member[1].mask = 1 << CMPCI_CD_VOL;\n\t\tstrcpy(dip->un.s.member[2].label.name, AudioNline);\n\t\tdip->un.s.member[2].mask = 1 << CMPCI_LINE_IN_VOL;\n\t\tstrcpy(dip->un.s.member[3].label.name, AudioNfmsynth);\n\t\tdip->un.s.member[3].mask = 1 << CMPCI_FM_VOL;\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\tstrcpy(dip->un.s.member[4].label.name, CmpciNspdif);\n\t\tdip->un.s.member[4].mask = 1 << CMPCI_SPDIF_IN;\n#endif\n\t\treturn 0;\n\tcase CMPCI_BASS:\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNbass);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_EQUALIZATION_CLASS;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNbass);\n\t\treturn 0;\n\tcase CMPCI_TREBLE:\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNtreble);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_EQUALIZATION_CLASS;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNtreble);\n\t\treturn 0;\n\tcase CMPCI_RECORD_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCrecord);\n\t\treturn 0;\n\tcase CMPCI_INPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCinputs);\n\t\treturn 0;\n\tcase CMPCI_PCSPEAKER:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"pc_speaker\");\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_INPUT_GAIN:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNinput);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNoutput);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\treturn 0;\n\tcase CMPCI_AGC:\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"agc\");\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\treturn 0;\n\tcase CMPCI_EQUALIZATION_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = CMPCI_EQUALIZATION_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCequalization);\n\t\treturn 0;\n\tcase CMPCI_CD_IN_MUTE:\n\t\tdip->prev = CMPCI_CD_VOL;\n\t\tdip->next = CMPCI_CD_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_MIC_IN_MUTE:\n\t\tdip->prev = CMPCI_MIC_VOL;\n\t\tdip->next = CMPCI_MIC_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_LINE_IN_MUTE:\n\t\tdip->prev = CMPCI_LINE_IN_VOL;\n\t\tdip->next = CMPCI_LINE_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_FM_IN_MUTE:\n\t\tdip->prev = CMPCI_FM_VOL;\n\t\tdip->next = CMPCI_FM_SWAP;\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_CD_SWAP:\n\t\tdip->prev = CMPCI_CD_IN_MUTE;\n\t\tdip->next = CMPCI_CD_OUT_MUTE;\n\t\tgoto swap;\n\tcase CMPCI_MIC_SWAP:\n\t\tdip->prev = CMPCI_MIC_IN_MUTE;\n\t\tdip->next = CMPCI_MIC_OUT_MUTE;\n\t\tgoto swap;\n\tcase CMPCI_LINE_SWAP:\n\t\tdip->prev = CMPCI_LINE_IN_MUTE;\n\t\tdip->next = CMPCI_LINE_OUT_MUTE;\n\t\tgoto swap;\n\tcase CMPCI_FM_SWAP:\n\t\tdip->prev = CMPCI_FM_IN_MUTE;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\tswap:\n\t\tdip->mixer_class = CMPCI_INPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioNswap);\n\t\tgoto mute1;\n\tcase CMPCI_CD_OUT_MUTE:\n\t\tdip->prev = CMPCI_CD_SWAP;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_MIC_OUT_MUTE:\n\t\tdip->prev = CMPCI_MIC_SWAP;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\t\tgoto mute;\n\tcase CMPCI_LINE_OUT_MUTE:\n\t\tdip->prev = CMPCI_LINE_SWAP;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tdip->mixer_class = CMPCI_OUTPUT_CLASS;\n\tmute:\n\t\tstrcpy(dip->label.name, AudioNmute);\n\tmute1:\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\treturn 0;\n\t}\n\n\treturn ENXIO;\n}"
  },
  {
    "function_name": "cmpci_getdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "774-781",
    "snippet": "int\ncmpci_getdev(handle, retp)\n        void *handle;\n        struct audio_device *retp;\n{\n\t*retp = cmpci_device;\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct audio_device cmpci_device = {\n\t\"CMI PCI Audio\",\n\t\"\",\n\t\"cmpci\"\n};",
      "int cmpci_getdev",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct audio_device cmpci_device = {\n\t\"CMI PCI Audio\",\n\t\"\",\n\t\"cmpci\"\n};\nint cmpci_getdev;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_getdev(handle, retp)\n        void *handle;\n        struct audio_device *retp;\n{\n\t*retp = cmpci_device;\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_halt_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "754-772",
    "snippet": "int\ncmpci_halt_input(handle)\n\tvoid *handle;\n{\n\tstruct cmpci_softc *sc = handle;\n\tint s;\n\n\ts = splaudio();\n\tsc->sc_rec.intr = NULL;\n\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH1_INTR_ENABLE);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_ENABLE);\n\t/* wait for reset DMA */\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_RESET);\n\tdelay(10);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_RESET);\n\tsplx(s);\n\t\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_set_4",
      "static __inline void cmpci_reg_clear_4",
      "int cmpci_halt_input",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_reg_clear_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_0",
            "CMPCI_REG_CH1_RESET"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_clear_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "236-245",
          "snippet": "static __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_clear_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_clear_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_reg_set_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_0",
            "CMPCI_REG_CH1_RESET"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_set_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "225-234",
          "snippet": "static __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_set_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstatic __inline void cmpci_reg_clear_4;\nint cmpci_halt_input;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_halt_input(handle)\n\tvoid *handle;\n{\n\tstruct cmpci_softc *sc = handle;\n\tint s;\n\n\ts = splaudio();\n\tsc->sc_rec.intr = NULL;\n\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH1_INTR_ENABLE);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_ENABLE);\n\t/* wait for reset DMA */\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_RESET);\n\tdelay(10);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH1_RESET);\n\tsplx(s);\n\t\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_halt_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "734-752",
    "snippet": "int\ncmpci_halt_output(handle)\n\tvoid *handle;\n{\n\tstruct cmpci_softc *sc = handle;\n\tint s;\n\n\ts = splaudio();\n\tsc->sc_play.intr = NULL;\n\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH0_INTR_ENABLE);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_ENABLE);\n\t/* wait for reset DMA */\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_RESET);\n\tdelay(10);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_RESET);\n\tsplx(s);\n\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_set_4",
      "static __inline void cmpci_reg_clear_4",
      "int cmpci_halt_output",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_reg_clear_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_0",
            "CMPCI_REG_CH0_RESET"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_clear_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "236-245",
          "snippet": "static __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_clear_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_clear_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_reg_set_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_0",
            "CMPCI_REG_CH0_RESET"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_set_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "225-234",
          "snippet": "static __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_set_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstatic __inline void cmpci_reg_clear_4;\nint cmpci_halt_output;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_halt_output(handle)\n\tvoid *handle;\n{\n\tstruct cmpci_softc *sc = handle;\n\tint s;\n\n\ts = splaudio();\n\tsc->sc_play.intr = NULL;\n\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL, CMPCI_REG_CH0_INTR_ENABLE);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_ENABLE);\n\t/* wait for reset DMA */\n\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_RESET);\n\tdelay(10);\n\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_0, CMPCI_REG_CH0_RESET);\n\tsplx(s);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_round_blocksize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "726-732",
    "snippet": "int\ncmpci_round_blocksize(handle, block)\n\tvoid *handle;\n\tint block;\n{\n\treturn (block & -4);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_round_blocksize",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_round_blocksize;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_round_blocksize(handle, block)\n\tvoid *handle;\n\tint block;\n{\n\treturn (block & -4);\n}"
  },
  {
    "function_name": "cmpci_set_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "525-723",
    "snippet": "int\ncmpci_set_params(handle, setmode, usemode, play, rec)\n\tvoid *handle;\n\tint setmode, usemode;\n\tstruct audio_params *play, *rec;\n{\n\tint i;\n\tstruct cmpci_softc *sc = handle;\n\n\tfor (i=0; i<2; i++) {\n\t\tint md_format;\n\t\tint md_divide;\n\t\tint md_index;\n\t\tint mode;\n\t\tstruct audio_params *p;\n\n\t\tswitch (i) {\n\t\tcase 0:\n\t\t\tmode = AUMODE_PLAY;\n\t\t\tp = play;\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tmode = AUMODE_RECORD;\n\t\t\tp = rec;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (!(setmode & mode))\n\t\t\tcontinue;\n\n\t\t/* format */\n\t\tp->sw_code = NULL;\n\t\tswitch (p->channels) {\n\t\tcase 1:\n\t\t\tmd_format = CMPCI_REG_FORMAT_MONO;\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tmd_format = CMPCI_REG_FORMAT_STEREO;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t\tswitch (p->encoding) {\n\t\tcase AUDIO_ENCODING_ULAW:\n\t\t\tif (p->precision != 8)\n\t\t\t\treturn (EINVAL);\n\t\t\tif (mode & AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = mulaw_to_slinear16;\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_mulaw;\n\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ALAW:\n\t\t\tif (p->precision != 8)\n\t\t\t\treturn (EINVAL);\n\t\t\tif (mode & AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = alaw_to_slinear16;\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_alaw;\n\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_LE:\n\t\t\tswitch (p->precision) {\n\t\t\tcase 8:\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_BE:\n\t\t\tswitch (p->precision) {\n\t\t\tcase 8:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_LE:\n\t\t\tswitch ( p->precision ) {\n\t\t\tcase 8:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tp->sw_code = change_sign16;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_BE:\n\t\t\tswitch (p->precision) {\n\t\t\tcase 8:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tif ( mode&AUMODE_PLAY )\n\t\t\t\t\tp->sw_code = swap_bytes_change_sign16;\n\t\t\t\telse\n\t\t\t\t\tp->sw_code = change_sign16_swap_bytes;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t\tif (mode & AUMODE_PLAY)\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_CHANNEL_FORMAT,\n\t\t\t\t\t\t  CMPCI_REG_CH0_FORMAT_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_CH0_FORMAT_MASK,\n\t\t\t\t\t\t  md_format);\n\t\telse\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_CHANNEL_FORMAT,\n\t\t\t\t\t\t  CMPCI_REG_CH1_FORMAT_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_CH1_FORMAT_MASK,\n\t\t\t\t\t\t  md_format);\n\t\t/* sample rate */\n\t\tmd_index = cmpci_rate_to_index(p->sample_rate);\n\t\tmd_divide = cmpci_index_to_divider(md_index);\n\t\tp->sample_rate = cmpci_index_to_rate(md_index);\n#if 0\n\t\tDPRINTF((\"%s: sample:%d, divider=%d\\n\",\n\t\t\t sc->sc_dev.dv_xname, (int)p->sample_rate, md_divide));\n#endif\n\t\tif (mode & AUMODE_PLAY) {\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_DAC_FS_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_DAC_FS_MASK,\n\t\t\t\t\t\t  md_divide);\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t\tswitch (md_divide) {\n\t\t\tcase CMPCI_REG_RATE_44100:\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_MISC,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF_48K);\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF_LOOP);\n\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\tCMPCI_REG_SPDIF0_ENABLE);\n\t\t\t\tbreak;\n\t\t\tcase CMPCI_REG_RATE_48000:\n\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_MISC,\n\t\t\t\t\t\tCMPCI_REG_SPDIF_48K);\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF_LOOP);\n\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\tCMPCI_REG_SPDIF0_ENABLE);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF0_ENABLE);\n\t\t\t    cmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t    CMPCI_REG_SPDIF_LOOP);\n\t\t\t}\n#endif\n\t\t} else {\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_ADC_FS_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_ADC_FS_MASK,\n\t\t\t\t\t\t  md_divide);\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t\tif ( sc->in_mask&CMPCI_SPDIF_IN) {\n\t\t\t\tswitch (md_divide) {\n\t\t\t\tcase CMPCI_REG_RATE_44100:\n\t\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t\tCMPCI_REG_SPDIF1_ENABLE);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn EINVAL;\n\t\t\t\t}\n\t\t\t} else\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF1_ENABLE);\n#endif\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_partial_write_4",
      "static __inline void cmpci_reg_set_4",
      "static __inline void cmpci_reg_clear_4",
      "static int cmpci_rate_to_index",
      "static __inline int cmpci_index_to_rate",
      "static __inline int cmpci_index_to_divider",
      "int cmpci_set_params",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_reg_clear_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_1",
            "CMPCI_REG_SPDIF1_ENABLE"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_clear_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "236-245",
          "snippet": "static __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_clear_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_clear_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_reg_set_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_1",
            "CMPCI_REG_SPDIF1_ENABLE"
          ],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_set_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "225-234",
          "snippet": "static __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_set_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_reg_partial_write_4",
          "args": [
            "sc",
            "CMPCI_REG_FUNC_1",
            "CMPCI_REG_ADC_FS_SHIFT",
            "CMPCI_REG_ADC_FS_MASK",
            "md_divide"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_partial_write_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "212-222",
          "snippet": "static __inline void\ncmpci_reg_partial_write_4(sc, no, shift, mask, val)\n\tstruct cmpci_softc *sc;\n\tint no, shift;\n\tuint32_t mask, val;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (val<<shift) |\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~(mask<<shift)));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_partial_write_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_partial_write_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_partial_write_4(sc, no, shift, mask, val)\n\tstruct cmpci_softc *sc;\n\tint no, shift;\n\tuint32_t mask, val;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (val<<shift) |\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~(mask<<shift)));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: sample:%d, divider=%d\\n\",\n\t\t\t sc->sc_dev.dv_xname, (int)p->sample_rate, md_divide)"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_index_to_rate",
          "args": [
            "md_index"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_index_to_rate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "277-283",
          "snippet": "static __inline int\ncmpci_index_to_rate(index)\n\tint index;\n{\n\n\treturn cmpci_rate_table[index].rate;\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int cmpci_index_to_rate",
            "struct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline int cmpci_index_to_rate;\nstruct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};\n\nstatic __inline int\ncmpci_index_to_rate(index)\n\tint index;\n{\n\n\treturn cmpci_rate_table[index].rate;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_index_to_divider",
          "args": [
            "md_index"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_index_to_divider",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "285-290",
          "snippet": "static __inline int\ncmpci_index_to_divider(index)\n\tint index;\n{\n\treturn cmpci_rate_table[index].divider;\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int cmpci_index_to_divider",
            "struct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline int cmpci_index_to_divider;\nstruct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};\n\nstatic __inline int\ncmpci_index_to_divider(index)\n\tint index;\n{\n\treturn cmpci_rate_table[index].divider;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmpci_rate_to_index",
          "args": [
            "p->sample_rate"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_rate_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "265-275",
          "snippet": "int\ncmpci_rate_to_index(rate)\n\tint rate;\n{\n\tint i;\n\tfor (i=0; i<CMPCI_REG_NUMRATE-2; i++)\n\t\tif (rate <=\n\t\t    (cmpci_rate_table[i].rate + cmpci_rate_table[i+1].rate) / 2)\n\t\t\treturn i;\n\treturn i;  /* 48000 */\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int cmpci_rate_to_index",
            "struct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int cmpci_rate_to_index;\nstruct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};\n\nint\ncmpci_rate_to_index(rate)\n\tint rate;\n{\n\tint i;\n\tfor (i=0; i<CMPCI_REG_NUMRATE-2; i++)\n\t\tif (rate <=\n\t\t    (cmpci_rate_table[i].rate + cmpci_rate_table[i+1].rate) / 2)\n\t\t\treturn i;\n\treturn i;  /* 48000 */\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_partial_write_4;\nstatic __inline void cmpci_reg_set_4;\nstatic __inline void cmpci_reg_clear_4;\nstatic int cmpci_rate_to_index;\nstatic __inline int cmpci_index_to_rate;\nstatic __inline int cmpci_index_to_divider;\nint cmpci_set_params;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_set_params(handle, setmode, usemode, play, rec)\n\tvoid *handle;\n\tint setmode, usemode;\n\tstruct audio_params *play, *rec;\n{\n\tint i;\n\tstruct cmpci_softc *sc = handle;\n\n\tfor (i=0; i<2; i++) {\n\t\tint md_format;\n\t\tint md_divide;\n\t\tint md_index;\n\t\tint mode;\n\t\tstruct audio_params *p;\n\n\t\tswitch (i) {\n\t\tcase 0:\n\t\t\tmode = AUMODE_PLAY;\n\t\t\tp = play;\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tmode = AUMODE_RECORD;\n\t\t\tp = rec;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (!(setmode & mode))\n\t\t\tcontinue;\n\n\t\t/* format */\n\t\tp->sw_code = NULL;\n\t\tswitch (p->channels) {\n\t\tcase 1:\n\t\t\tmd_format = CMPCI_REG_FORMAT_MONO;\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tmd_format = CMPCI_REG_FORMAT_STEREO;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t\tswitch (p->encoding) {\n\t\tcase AUDIO_ENCODING_ULAW:\n\t\t\tif (p->precision != 8)\n\t\t\t\treturn (EINVAL);\n\t\t\tif (mode & AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = mulaw_to_slinear16;\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_mulaw;\n\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ALAW:\n\t\t\tif (p->precision != 8)\n\t\t\t\treturn (EINVAL);\n\t\t\tif (mode & AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = alaw_to_slinear16;\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_alaw;\n\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_LE:\n\t\t\tswitch (p->precision) {\n\t\t\tcase 8:\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_BE:\n\t\t\tswitch (p->precision) {\n\t\t\tcase 8:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_LE:\n\t\t\tswitch ( p->precision ) {\n\t\t\tcase 8:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tp->sw_code = change_sign16;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_BE:\n\t\t\tswitch (p->precision) {\n\t\t\tcase 8:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_8BIT;\n\t\t\t\tbreak;\n\t\t\tcase 16:\n\t\t\t\tmd_format |= CMPCI_REG_FORMAT_16BIT;\n\t\t\t\tif ( mode&AUMODE_PLAY )\n\t\t\t\t\tp->sw_code = swap_bytes_change_sign16;\n\t\t\t\telse\n\t\t\t\t\tp->sw_code = change_sign16_swap_bytes;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn (EINVAL);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t\tif (mode & AUMODE_PLAY)\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_CHANNEL_FORMAT,\n\t\t\t\t\t\t  CMPCI_REG_CH0_FORMAT_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_CH0_FORMAT_MASK,\n\t\t\t\t\t\t  md_format);\n\t\telse\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_CHANNEL_FORMAT,\n\t\t\t\t\t\t  CMPCI_REG_CH1_FORMAT_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_CH1_FORMAT_MASK,\n\t\t\t\t\t\t  md_format);\n\t\t/* sample rate */\n\t\tmd_index = cmpci_rate_to_index(p->sample_rate);\n\t\tmd_divide = cmpci_index_to_divider(md_index);\n\t\tp->sample_rate = cmpci_index_to_rate(md_index);\n#if 0\n\t\tDPRINTF((\"%s: sample:%d, divider=%d\\n\",\n\t\t\t sc->sc_dev.dv_xname, (int)p->sample_rate, md_divide));\n#endif\n\t\tif (mode & AUMODE_PLAY) {\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_DAC_FS_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_DAC_FS_MASK,\n\t\t\t\t\t\t  md_divide);\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t\tswitch (md_divide) {\n\t\t\tcase CMPCI_REG_RATE_44100:\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_MISC,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF_48K);\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF_LOOP);\n\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\tCMPCI_REG_SPDIF0_ENABLE);\n\t\t\t\tbreak;\n\t\t\tcase CMPCI_REG_RATE_48000:\n\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_MISC,\n\t\t\t\t\t\tCMPCI_REG_SPDIF_48K);\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF_LOOP);\n\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\tCMPCI_REG_SPDIF0_ENABLE);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF0_ENABLE);\n\t\t\t    cmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t    CMPCI_REG_SPDIF_LOOP);\n\t\t\t}\n#endif\n\t\t} else {\n\t\t\tcmpci_reg_partial_write_4(sc,\n\t\t\t\t\t\t  CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_ADC_FS_SHIFT,\n\t\t\t\t\t\t  CMPCI_REG_ADC_FS_MASK,\n\t\t\t\t\t\t  md_divide);\n#ifdef CMPCI_SPDIF_SUPPORT\n\t\t\tif ( sc->in_mask&CMPCI_SPDIF_IN) {\n\t\t\t\tswitch (md_divide) {\n\t\t\t\tcase CMPCI_REG_RATE_44100:\n\t\t\t\t\tcmpci_reg_set_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t\tCMPCI_REG_SPDIF1_ENABLE);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn EINVAL;\n\t\t\t\t}\n\t\t\t} else\n\t\t\t\tcmpci_reg_clear_4(sc, CMPCI_REG_FUNC_1,\n\t\t\t\t\t\t  CMPCI_REG_SPDIF1_ENABLE);\n#endif\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_query_encoding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "461-522",
    "snippet": "int\ncmpci_query_encoding(handle, fp)\n\tvoid *handle;\n\tstruct audio_encoding *fp;\n{\n\tstruct cmpci_softc *sc = handle;\n\t(void)sc;\n\t\n\tswitch (fp->index) {\n\tcase 0:\n\t\tstrcpy(fp->name, AudioEulinear);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 1:\n\t\tstrcpy(fp->name, AudioEmulaw);\n\t\tfp->encoding = AUDIO_ENCODING_ULAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 2:\n\t\tstrcpy(fp->name, AudioEalaw);\n\t\tfp->encoding = AUDIO_ENCODING_ALAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 3:\n\t\tstrcpy(fp->name, AudioEslinear);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 4:\n\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 5:\n\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 6:\n\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 7:\n\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tdefault:\n\t\treturn EINVAL;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_query_encoding",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;",
      "int    type, flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_be"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_be"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_le"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_le"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEalaw"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEmulaw"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_query_encoding;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\nint    type, flags;\n\nint\ncmpci_query_encoding(handle, fp)\n\tvoid *handle;\n\tstruct audio_encoding *fp;\n{\n\tstruct cmpci_softc *sc = handle;\n\t(void)sc;\n\t\n\tswitch (fp->index) {\n\tcase 0:\n\t\tstrcpy(fp->name, AudioEulinear);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 1:\n\t\tstrcpy(fp->name, AudioEmulaw);\n\t\tfp->encoding = AUDIO_ENCODING_ULAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 2:\n\t\tstrcpy(fp->name, AudioEalaw);\n\t\tfp->encoding = AUDIO_ENCODING_ALAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 3:\n\t\tstrcpy(fp->name, AudioEslinear);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 4:\n\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 5:\n\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 6:\n\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 7:\n\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tdefault:\n\t\treturn EINVAL;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "454-459",
    "snippet": "void\ncmpci_close(handle)\n\tvoid *handle;\n{\n\t(void)handle;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void cmpci_close",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid cmpci_close;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nvoid\ncmpci_close(handle)\n\tvoid *handle;\n{\n\t(void)handle;\n}"
  },
  {
    "function_name": "cmpci_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "442-452",
    "snippet": "int\ncmpci_open(handle, flags)\n\tvoid *handle;\n\tint flags;\n{\n\tstruct cmpci_softc *sc = handle;\n\t(void)sc;\n\t(void)flags;\n\t\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_open",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;",
      "int    type, flags;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_open;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\nint    type, flags;\n\nint\ncmpci_open(handle, flags)\n\tvoid *handle;\n\tint flags;\n{\n\tstruct cmpci_softc *sc = handle;\n\t(void)sc;\n\t(void)flags;\n\t\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_intr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "394-439",
    "snippet": "int\ncmpci_intr(handle)\n\tvoid *handle;\n{\n\tstruct cmpci_softc *sc = handle;\n\tuint32_t intrstat;\n\tint s;\n\n\tintrstat = bus_space_read_4(sc->sc_iot, sc->sc_ioh,\n\t    CMPCI_REG_INTR_STATUS);\n\tdelay(10);\n\n\tif (!(intrstat & CMPCI_REG_ANY_INTR))\n\t\treturn 0;\n\n\t/* disable and reset intr */\n\ts = splaudio();\n\tif (intrstat & CMPCI_REG_CH0_INTR)\n\t\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH0_INTR_ENABLE);\n\tif (intrstat&CMPCI_REG_CH1_INTR)\n\t\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH1_INTR_ENABLE);\n\tsplx(s);\n\n\tif (intrstat & CMPCI_REG_CH0_INTR) {\n\t\tif (sc->sc_play.intr)\n\t\t\t(*sc->sc_play.intr)(sc->sc_play.intr_arg);\n\t}\n\tif (intrstat & CMPCI_REG_CH1_INTR) {\n\t    if (sc->sc_rec.intr)\n\t\t    (*sc->sc_rec.intr)(sc->sc_rec.intr_arg);\n\t}\n\n\t/* enable intr */\n\ts = splaudio();\n\tif ( intrstat & CMPCI_REG_CH0_INTR )\n\t\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH0_INTR_ENABLE);\n\tif (intrstat & CMPCI_REG_CH1_INTR)\n\t\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH1_INTR_ENABLE);\n\tsplx(s);\n\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_set_4",
      "static __inline void cmpci_reg_clear_4",
      "int cmpci_intr",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;",
      "void *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_reg_set_4",
          "args": [
            "sc",
            "CMPCI_REG_INTR_CTRL",
            "CMPCI_REG_CH1_INTR_ENABLE"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_set_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "225-234",
          "snippet": "static __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_set_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->sc_rec.intr_arg"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->sc_play.intr_arg"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_reg_clear_4",
          "args": [
            "sc",
            "CMPCI_REG_INTR_CTRL",
            "CMPCI_REG_CH1_INTR_ENABLE"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_reg_clear_4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "236-245",
          "snippet": "static __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_reg_clear_4",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_clear_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_INTR_STATUS"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstatic __inline void cmpci_reg_clear_4;\nint cmpci_intr;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\nvoid *\ncmpci_malloc(handle, size, type, flags)\n\tvoid  *handle;\n\nint\ncmpci_intr(handle)\n\tvoid *handle;\n{\n\tstruct cmpci_softc *sc = handle;\n\tuint32_t intrstat;\n\tint s;\n\n\tintrstat = bus_space_read_4(sc->sc_iot, sc->sc_ioh,\n\t    CMPCI_REG_INTR_STATUS);\n\tdelay(10);\n\n\tif (!(intrstat & CMPCI_REG_ANY_INTR))\n\t\treturn 0;\n\n\t/* disable and reset intr */\n\ts = splaudio();\n\tif (intrstat & CMPCI_REG_CH0_INTR)\n\t\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH0_INTR_ENABLE);\n\tif (intrstat&CMPCI_REG_CH1_INTR)\n\t\tcmpci_reg_clear_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH1_INTR_ENABLE);\n\tsplx(s);\n\n\tif (intrstat & CMPCI_REG_CH0_INTR) {\n\t\tif (sc->sc_play.intr)\n\t\t\t(*sc->sc_play.intr)(sc->sc_play.intr_arg);\n\t}\n\tif (intrstat & CMPCI_REG_CH1_INTR) {\n\t    if (sc->sc_rec.intr)\n\t\t    (*sc->sc_rec.intr)(sc->sc_rec.intr_arg);\n\t}\n\n\t/* enable intr */\n\ts = splaudio();\n\tif ( intrstat & CMPCI_REG_CH0_INTR )\n\t\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH0_INTR_ENABLE);\n\tif (intrstat & CMPCI_REG_CH1_INTR)\n\t\tcmpci_reg_set_4(sc, CMPCI_REG_INTR_CTRL,\n\t\t    CMPCI_REG_CH1_INTR_ENABLE);\n\tsplx(s);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "313-392",
    "snippet": "void\ncmpci_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct cmpci_softc *sc = (struct cmpci_softc *)self;\n\tstruct pci_attach_args *pa = (struct pci_attach_args *)aux;\n\tpci_intr_handle_t ih;\n\tchar const *intrstr;\n\tint i, v;\n\n\t/* map I/O space */\n\tif (pci_mapreg_map(pa, CMPCI_PCI_IOBASEREG, PCI_MAPREG_TYPE_IO, 0,\n\t\t\t   &sc->sc_iot, &sc->sc_ioh, NULL, NULL)) {\n\t\tprintf(\"\\n%s: failed to map I/O space\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\n\t/* interrupt */\n\tif (pci_intr_map(pa->pa_pc, pa->pa_intrtag, pa->pa_intrpin,\n\t\t\t  pa->pa_intrline, &ih)) {\n\t\tprintf(\"\\n%s: failed to map interrupt\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\tintrstr = pci_intr_string(pa->pa_pc, ih);\n\tsc->sc_ih = pci_intr_establish(pa->pa_pc, ih, IPL_AUDIO, cmpci_intr,\n\t\t\t\t       sc, sc->sc_dev.dv_xname);\n\n\tif (sc->sc_ih == NULL) {\n\t\tprintf(\"\\n%s: couldn't establish interrupt\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tif (intrstr)\n\t\t\tprintf(\" at %s\", intrstr);\n\t\tprintf(\"\\n\");\n\t\treturn;\n\t}\n\tprintf(\": %s\\n\", intrstr);\n\n\tsc->sc_dmat = pa->pa_dmat;\n\n\taudio_attach_mi(&cmpci_hw_if, sc, &sc->sc_dev);\n\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_RESET, 0);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, 0);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, 0);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_OUTMIX,\n\t\t\t     CMPCI_SB16_SW_CD|CMPCI_SB16_SW_MIC|\n\t\t\t     CMPCI_SB16_SW_LINE);\n\tfor (i = 0; i < CMPCI_NDEVS; i++) {\n\t\tswitch(i) {\n\t\tcase CMPCI_MIC_VOL:\n\t\tcase CMPCI_LINE_IN_VOL:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\tcase CMPCI_BASS:\n\t\tcase CMPCI_TREBLE:\n\t\t\tv = CMPCI_ADJUST_GAIN(sc, AUDIO_MAX_GAIN / 2);\n\t\t\tbreak;\n\t\tcase CMPCI_CD_IN_MUTE:\n\t\tcase CMPCI_MIC_IN_MUTE:\n\t\tcase CMPCI_LINE_IN_MUTE:\n\t\tcase CMPCI_FM_IN_MUTE:\n\t\tcase CMPCI_CD_SWAP:\n\t\tcase CMPCI_MIC_SWAP:\n\t\tcase CMPCI_LINE_SWAP:\n\t\tcase CMPCI_FM_SWAP:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\tcase CMPCI_CD_OUT_MUTE:\n\t\tcase CMPCI_MIC_OUT_MUTE:\n\t\tcase CMPCI_LINE_OUT_MUTE:\n\t\t\tv = 1;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tv = CMPCI_ADJUST_GAIN(sc, AUDIO_MAX_GAIN / 2);\n\t\t}\n\t\tsc->gain[i][CMPCI_LEFT] = sc->gain[i][CMPCI_RIGHT] = v;\n\t\tcmpci_set_mixer_gain(sc, i);\n\t}\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_mixerreg_write",
      "static void cmpci_set_mixer_gain",
      "void cmpci_attach",
      "int cmpci_intr",
      "struct audio_hw_if cmpci_hw_if = {\n\tcmpci_open,\t\t\t/* open */\n\tcmpci_close,\t\t\t/* close */\n\tNULL,\t\t\t\t/* drain */\n\tcmpci_query_encoding,\t\t/* query_encoding */\n\tcmpci_set_params,\t\t/* set_params */\n\tcmpci_round_blocksize,\t\t/* round_blocksize */\n\tNULL,\t\t\t\t/* commit_settings */\n\tNULL,\t\t\t\t/* init_output */\n\tNULL,\t\t\t\t/* init_input */\n\tNULL,\t\t\t\t/* start_output */\n\tNULL,\t\t\t\t/* start_input */\n\tcmpci_halt_output,\t\t/* halt_output */\n\tcmpci_halt_input,\t\t/* halt_input */\n\tNULL,\t\t\t\t/* speaker_ctl */\n\tcmpci_getdev,\t\t\t/* getdev */\n\tNULL,\t\t\t\t/* setfd */\n\tcmpci_set_port,\t\t\t/* set_port */\n\tcmpci_get_port,\t\t\t/* get_port */\n\tcmpci_query_devinfo,\t\t/* query_devinfo */\n\tcmpci_malloc,\t\t\t/* malloc */\n\tcmpci_free,\t\t\t/* free */\n\tcmpci_round_buffersize,\t\t/* round_buffersize */\n\tcmpci_mappage,\t\t\t/* mappage */\n\tcmpci_get_props,\t\t/* get_props */\n\tcmpci_trigger_output,\t\t/* trigger_output */\n\tcmpci_trigger_input\t\t/* trigger_input */\n};",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpci_set_mixer_gain",
          "args": [
            "sc",
            "i"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_set_mixer_gain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "1154-1202",
          "snippet": "void\ncmpci_set_mixer_gain(sc, port)\n\tstruct cmpci_softc *sc;\n\tint port;\n{\n\tint src;\n\n\tswitch (port) {\n\tcase CMPCI_MIC_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MIC;\n\t\tbreak;\n\tcase CMPCI_MASTER_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MASTER_L;\n\t\tbreak;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_LINE_L;\n\t\tbreak;\n\tcase CMPCI_VOICE_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_VOICE_L;\n\t\tbreak;\n\tcase CMPCI_FM_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_FM_L;\n\t\tbreak;\n\tcase CMPCI_CD_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_CDDA_L;\n\t\tbreak;\n\tcase CMPCI_INPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_INGAIN_L;\n\t\tbreak;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_OUTGAIN_L;\n\t\tbreak;\n\tcase CMPCI_TREBLE:\n\t\tsrc = CMPCI_SB16_MIXER_TREBLE_L;\n\t\tbreak;\n\tcase CMPCI_BASS:\n\t\tsrc = CMPCI_SB16_MIXER_BASS_L;\n\t\tbreak;\n\tcase CMPCI_PCSPEAKER:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_SPEAKER,\n\t\t\t\t     sc->gain[port][CMPCI_LEFT]);\n\t\treturn;\n\tdefault:\n\t\treturn;\n\t}\n\tcmpci_mixerreg_write(sc, src, sc->gain[port][CMPCI_LEFT]);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_L_TO_R(src),\n\t\t\t     sc->gain[port][CMPCI_RIGHT]);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_mixerreg_write",
            "static void cmpci_set_mixer_gain",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstatic void cmpci_set_mixer_gain;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nvoid\ncmpci_set_mixer_gain(sc, port)\n\tstruct cmpci_softc *sc;\n\tint port;\n{\n\tint src;\n\n\tswitch (port) {\n\tcase CMPCI_MIC_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MIC;\n\t\tbreak;\n\tcase CMPCI_MASTER_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_MASTER_L;\n\t\tbreak;\n\tcase CMPCI_LINE_IN_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_LINE_L;\n\t\tbreak;\n\tcase CMPCI_VOICE_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_VOICE_L;\n\t\tbreak;\n\tcase CMPCI_FM_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_FM_L;\n\t\tbreak;\n\tcase CMPCI_CD_VOL:\n\t\tsrc = CMPCI_SB16_MIXER_CDDA_L;\n\t\tbreak;\n\tcase CMPCI_INPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_INGAIN_L;\n\t\tbreak;\n\tcase CMPCI_OUTPUT_GAIN:\n\t\tsrc = CMPCI_SB16_MIXER_OUTGAIN_L;\n\t\tbreak;\n\tcase CMPCI_TREBLE:\n\t\tsrc = CMPCI_SB16_MIXER_TREBLE_L;\n\t\tbreak;\n\tcase CMPCI_BASS:\n\t\tsrc = CMPCI_SB16_MIXER_BASS_L;\n\t\tbreak;\n\tcase CMPCI_PCSPEAKER:\n\t\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_SPEAKER,\n\t\t\t\t     sc->gain[port][CMPCI_LEFT]);\n\t\treturn;\n\tdefault:\n\t\treturn;\n\t}\n\tcmpci_mixerreg_write(sc, src, sc->gain[port][CMPCI_LEFT]);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_L_TO_R(src),\n\t\t\t     sc->gain[port][CMPCI_RIGHT]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CMPCI_ADJUST_GAIN",
          "args": [
            "sc",
            "AUDIO_MAX_GAIN / 2"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMPCI_ADJUST_GAIN",
          "args": [
            "sc",
            "AUDIO_MAX_GAIN / 2"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmpci_mixerreg_write",
          "args": [
            "sc",
            "CMPCI_SB16_MIXER_OUTMIX",
            "CMPCI_SB16_SW_CD|CMPCI_SB16_SW_MIC|\n\t\t\t     CMPCI_SB16_SW_LINE"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "cmpci_mixerreg_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
          "lines": "200-209",
          "snippet": "static __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}",
          "includes": [
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/pci/cmpcivar.h>",
            "#include <dev/pci/cmpcireg.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline void cmpci_mixerreg_write",
            "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "audio_attach_mi",
          "args": [
            "&cmpci_hw_if",
            "sc",
            "&sc->sc_dev"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "audio_attach_mi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "394-408",
          "snippet": "void\naudio_attach_mi(ahwp, hdlp, dev)\n\tstruct audio_hw_if *ahwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n\tif (ahwp != NULL) {\n\t\targ.type = AUDIODEV_TYPE_AUDIO;\n\t\targ.hwif = ahwp;\n\t\targ.hdl = hdlp;\n\t\t(void)config_found(dev, &arg, audioprint);\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nvoid\naudio_attach_mi(ahwp, hdlp, dev)\n\tstruct audio_hw_if *ahwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n\tif (ahwp != NULL) {\n\t\targ.type = AUDIODEV_TYPE_AUDIO;\n\t\targ.hwif = ahwp;\n\t\targ.hdl = hdlp;\n\t\t(void)config_found(dev, &arg, audioprint);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\": %s\\n\"",
            "intrstr"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pci_intr_establish",
          "args": [
            "pa->pa_pc",
            "ih",
            "IPL_AUDIO",
            "cmpci_intr",
            "sc",
            "sc->sc_dev.dv_xname"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_string",
          "args": [
            "pa->pa_pc",
            "ih"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_map",
          "args": [
            "pa->pa_pc",
            "pa->pa_intrtag",
            "pa->pa_intrpin",
            "pa->pa_intrline",
            "&ih"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_mapreg_map",
          "args": [
            "pa",
            "CMPCI_PCI_IOBASEREG",
            "PCI_MAPREG_TYPE_IO",
            "0",
            "&sc->sc_iot",
            "&sc->sc_ioh",
            "NULL",
            "NULL"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "pci_mapreg_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/pci_map.c",
          "lines": "230-275",
          "snippet": "int\npci_mapreg_map(pa, reg, type, busflags, tagp, handlep, basep, sizep)\n\tstruct pci_attach_args *pa;\n\tint reg, busflags;\n\tpcireg_t type;\n\tbus_space_tag_t *tagp;\n\tbus_space_handle_t *handlep;\n\tbus_addr_t *basep;\n\tbus_size_t *sizep;\n{\n\tbus_space_tag_t tag;\n\tbus_space_handle_t handle;\n\tbus_addr_t base;\n\tbus_size_t size;\n\tint flags;\n\n\tif (PCI_MAPREG_TYPE(type) == PCI_MAPREG_TYPE_IO) {\n\t\tif ((pa->pa_flags & PCI_FLAGS_IO_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_io_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t     &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_iot;\n\t} else {\n\t\tif ((pa->pa_flags & PCI_FLAGS_MEM_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_mem_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t      &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_memt;\n\t}\n\n\tif (bus_space_map(tag, base, size, busflags | flags, &handle))\n\t\treturn (1);\n\n\tif (tagp != 0)\n\t\t*tagp = tag;\n\tif (handlep != 0)\n\t\t*handlep = handle;\n\tif (basep != 0)\n\t\t*basep = base;\n\tif (sizep != 0)\n\t\t*sizep = size;\n\n\treturn (0);\n}",
          "includes": [
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nbsd_pci_io_find",
            "static int nbsd_pci_mem_find"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int nbsd_pci_io_find;\nstatic int nbsd_pci_mem_find;\n\nint\npci_mapreg_map(pa, reg, type, busflags, tagp, handlep, basep, sizep)\n\tstruct pci_attach_args *pa;\n\tint reg, busflags;\n\tpcireg_t type;\n\tbus_space_tag_t *tagp;\n\tbus_space_handle_t *handlep;\n\tbus_addr_t *basep;\n\tbus_size_t *sizep;\n{\n\tbus_space_tag_t tag;\n\tbus_space_handle_t handle;\n\tbus_addr_t base;\n\tbus_size_t size;\n\tint flags;\n\n\tif (PCI_MAPREG_TYPE(type) == PCI_MAPREG_TYPE_IO) {\n\t\tif ((pa->pa_flags & PCI_FLAGS_IO_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_io_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t     &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_iot;\n\t} else {\n\t\tif ((pa->pa_flags & PCI_FLAGS_MEM_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_mem_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t      &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_memt;\n\t}\n\n\tif (bus_space_map(tag, base, size, busflags | flags, &handle))\n\t\treturn (1);\n\n\tif (tagp != 0)\n\t\t*tagp = tag;\n\tif (handlep != 0)\n\t\t*handlep = handle;\n\tif (basep != 0)\n\t\t*basep = base;\n\tif (sizep != 0)\n\t\t*sizep = size;\n\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstatic void cmpci_set_mixer_gain;\nvoid cmpci_attach;\nint cmpci_intr;\nstruct audio_hw_if cmpci_hw_if = {\n\tcmpci_open,\t\t\t/* open */\n\tcmpci_close,\t\t\t/* close */\n\tNULL,\t\t\t\t/* drain */\n\tcmpci_query_encoding,\t\t/* query_encoding */\n\tcmpci_set_params,\t\t/* set_params */\n\tcmpci_round_blocksize,\t\t/* round_blocksize */\n\tNULL,\t\t\t\t/* commit_settings */\n\tNULL,\t\t\t\t/* init_output */\n\tNULL,\t\t\t\t/* init_input */\n\tNULL,\t\t\t\t/* start_output */\n\tNULL,\t\t\t\t/* start_input */\n\tcmpci_halt_output,\t\t/* halt_output */\n\tcmpci_halt_input,\t\t/* halt_input */\n\tNULL,\t\t\t\t/* speaker_ctl */\n\tcmpci_getdev,\t\t\t/* getdev */\n\tNULL,\t\t\t\t/* setfd */\n\tcmpci_set_port,\t\t\t/* set_port */\n\tcmpci_get_port,\t\t\t/* get_port */\n\tcmpci_query_devinfo,\t\t/* query_devinfo */\n\tcmpci_malloc,\t\t\t/* malloc */\n\tcmpci_free,\t\t\t/* free */\n\tcmpci_round_buffersize,\t\t/* round_buffersize */\n\tcmpci_mappage,\t\t\t/* mappage */\n\tcmpci_get_props,\t\t/* get_props */\n\tcmpci_trigger_output,\t\t/* trigger_output */\n\tcmpci_trigger_input\t\t/* trigger_input */\n};\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nvoid\ncmpci_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct cmpci_softc *sc = (struct cmpci_softc *)self;\n\tstruct pci_attach_args *pa = (struct pci_attach_args *)aux;\n\tpci_intr_handle_t ih;\n\tchar const *intrstr;\n\tint i, v;\n\n\t/* map I/O space */\n\tif (pci_mapreg_map(pa, CMPCI_PCI_IOBASEREG, PCI_MAPREG_TYPE_IO, 0,\n\t\t\t   &sc->sc_iot, &sc->sc_ioh, NULL, NULL)) {\n\t\tprintf(\"\\n%s: failed to map I/O space\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\n\t/* interrupt */\n\tif (pci_intr_map(pa->pa_pc, pa->pa_intrtag, pa->pa_intrpin,\n\t\t\t  pa->pa_intrline, &ih)) {\n\t\tprintf(\"\\n%s: failed to map interrupt\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\tintrstr = pci_intr_string(pa->pa_pc, ih);\n\tsc->sc_ih = pci_intr_establish(pa->pa_pc, ih, IPL_AUDIO, cmpci_intr,\n\t\t\t\t       sc, sc->sc_dev.dv_xname);\n\n\tif (sc->sc_ih == NULL) {\n\t\tprintf(\"\\n%s: couldn't establish interrupt\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tif (intrstr)\n\t\t\tprintf(\" at %s\", intrstr);\n\t\tprintf(\"\\n\");\n\t\treturn;\n\t}\n\tprintf(\": %s\\n\", intrstr);\n\n\tsc->sc_dmat = pa->pa_dmat;\n\n\taudio_attach_mi(&cmpci_hw_if, sc, &sc->sc_dev);\n\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_RESET, 0);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_L, 0);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_ADCMIX_R, 0);\n\tcmpci_mixerreg_write(sc, CMPCI_SB16_MIXER_OUTMIX,\n\t\t\t     CMPCI_SB16_SW_CD|CMPCI_SB16_SW_MIC|\n\t\t\t     CMPCI_SB16_SW_LINE);\n\tfor (i = 0; i < CMPCI_NDEVS; i++) {\n\t\tswitch(i) {\n\t\tcase CMPCI_MIC_VOL:\n\t\tcase CMPCI_LINE_IN_VOL:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\tcase CMPCI_BASS:\n\t\tcase CMPCI_TREBLE:\n\t\t\tv = CMPCI_ADJUST_GAIN(sc, AUDIO_MAX_GAIN / 2);\n\t\t\tbreak;\n\t\tcase CMPCI_CD_IN_MUTE:\n\t\tcase CMPCI_MIC_IN_MUTE:\n\t\tcase CMPCI_LINE_IN_MUTE:\n\t\tcase CMPCI_FM_IN_MUTE:\n\t\tcase CMPCI_CD_SWAP:\n\t\tcase CMPCI_MIC_SWAP:\n\t\tcase CMPCI_LINE_SWAP:\n\t\tcase CMPCI_FM_SWAP:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\tcase CMPCI_CD_OUT_MUTE:\n\t\tcase CMPCI_MIC_OUT_MUTE:\n\t\tcase CMPCI_LINE_OUT_MUTE:\n\t\t\tv = 1;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tv = CMPCI_ADJUST_GAIN(sc, AUDIO_MAX_GAIN / 2);\n\t\t}\n\t\tsc->gain[i][CMPCI_LEFT] = sc->gain[i][CMPCI_RIGHT] = v;\n\t\tcmpci_set_mixer_gain(sc, i);\n\t}\n}"
  },
  {
    "function_name": "cmpci_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "296-311",
    "snippet": "int\ncmpci_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = (struct pci_attach_args *)aux;\n\n\tif (PCI_VENDOR(pa->pa_id) == PCI_VENDOR_CMI &&\n\t    (PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_CMI_CMI8338A ||\n\t     PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_CMI_CMI8338B ||\n\t     PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_CMI_CMI8738))\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int cmpci_match"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PCI_PRODUCT",
          "args": [
            "pa->pa_id"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_PRODUCT",
          "args": [
            "pa->pa_id"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_PRODUCT",
          "args": [
            "pa->pa_id"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_VENDOR",
          "args": [
            "pa->pa_id"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint cmpci_match;\n\nint\ncmpci_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = (struct pci_attach_args *)aux;\n\n\tif (PCI_VENDOR(pa->pa_id) == PCI_VENDOR_CMI &&\n\t    (PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_CMI_CMI8338A ||\n\t     PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_CMI_CMI8338B ||\n\t     PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_CMI_CMI8738))\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cmpci_index_to_divider",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "285-290",
    "snippet": "static __inline int\ncmpci_index_to_divider(index)\n\tint index;\n{\n\treturn cmpci_rate_table[index].divider;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int cmpci_index_to_divider",
      "struct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline int cmpci_index_to_divider;\nstruct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};\n\nstatic __inline int\ncmpci_index_to_divider(index)\n\tint index;\n{\n\treturn cmpci_rate_table[index].divider;\n}"
  },
  {
    "function_name": "cmpci_index_to_rate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "277-283",
    "snippet": "static __inline int\ncmpci_index_to_rate(index)\n\tint index;\n{\n\n\treturn cmpci_rate_table[index].rate;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int cmpci_index_to_rate",
      "struct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline int cmpci_index_to_rate;\nstruct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};\n\nstatic __inline int\ncmpci_index_to_rate(index)\n\tint index;\n{\n\n\treturn cmpci_rate_table[index].rate;\n}"
  },
  {
    "function_name": "cmpci_rate_to_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "265-275",
    "snippet": "int\ncmpci_rate_to_index(rate)\n\tint rate;\n{\n\tint i;\n\tfor (i=0; i<CMPCI_REG_NUMRATE-2; i++)\n\t\tif (rate <=\n\t\t    (cmpci_rate_table[i].rate + cmpci_rate_table[i+1].rate) / 2)\n\t\t\treturn i;\n\treturn i;  /* 48000 */\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int cmpci_rate_to_index",
      "struct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int cmpci_rate_to_index;\nstruct {\n      int rate;\n      int divider;\n} cmpci_rate_table[CMPCI_REG_NUMRATE] = {\n#define _RATE(n) { n, CMPCI_REG_RATE_ ## n }\n\t_RATE(5512),\n\t_RATE(8000),\n\t_RATE(11025),\n\t_RATE(16000),\n\t_RATE(22050),\n\t_RATE(32000),\n\t_RATE(44100),\n\t_RATE(48000)\n#undef  _RATE\n};\n\nint\ncmpci_rate_to_index(rate)\n\tint rate;\n{\n\tint i;\n\tfor (i=0; i<CMPCI_REG_NUMRATE-2; i++)\n\t\tif (rate <=\n\t\t    (cmpci_rate_table[i].rate + cmpci_rate_table[i+1].rate) / 2)\n\t\t\treturn i;\n\treturn i;  /* 48000 */\n}"
  },
  {
    "function_name": "cmpci_reg_clear_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "236-245",
    "snippet": "static __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_clear_4",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "no",
            "(bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask)"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "no"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_clear_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_clear_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~mask));\n\tdelay(10);\n}"
  },
  {
    "function_name": "cmpci_reg_set_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "225-234",
    "snippet": "static __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_set_4",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "no",
            "(bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask)"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "no"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_set_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_set_4(sc, no, mask)\n\tstruct cmpci_softc *sc;\n\tint no;\n\tuint32_t mask;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) | mask));\n\tdelay(10);\n}"
  },
  {
    "function_name": "cmpci_reg_partial_write_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "212-222",
    "snippet": "static __inline void\ncmpci_reg_partial_write_4(sc, no, shift, mask, val)\n\tstruct cmpci_softc *sc;\n\tint no, shift;\n\tuint32_t mask, val;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (val<<shift) |\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~(mask<<shift)));\n\tdelay(10);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_reg_partial_write_4",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "no",
            "(val<<shift) |\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~(mask<<shift))"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "no"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_reg_partial_write_4;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_reg_partial_write_4(sc, no, shift, mask, val)\n\tstruct cmpci_softc *sc;\n\tint no, shift;\n\tuint32_t mask, val;\n{\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, no,\n\t    (val<<shift) |\n\t    (bus_space_read_4(sc->sc_iot, sc->sc_ioh, no) & ~(mask<<shift)));\n\tdelay(10);\n}"
  },
  {
    "function_name": "cmpci_mixerreg_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "200-209",
    "snippet": "static __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline void cmpci_mixerreg_write",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_SBDATA",
            "val"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_SBADDR",
            "no"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline void cmpci_mixerreg_write;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline void\ncmpci_mixerreg_write(sc, no, val)\n\tstruct cmpci_softc *sc;\n\tuint8_t no, val;\n{\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA, val);\n\tdelay(10);\n}"
  },
  {
    "function_name": "cmpci_mixerreg_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/cmpci.c",
    "lines": "187-198",
    "snippet": "static __inline uint8_t\ncmpci_mixerreg_read(sc, no)\n\tstruct cmpci_softc *sc;\n\tuint8_t no;\n{\n\tuint8_t ret;\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tret = bus_space_read_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA);\n\tdelay(10);\n\treturn ret;\n}",
    "includes": [
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/pci/cmpcivar.h>",
      "#include <dev/pci/cmpcireg.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline uint8_t cmpci_mixerreg_read",
      "struct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_SBDATA"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "CMPCI_REG_SBADDR",
            "no"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/pci/cmpcivar.h>\n#include <dev/pci/cmpcireg.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline uint8_t cmpci_mixerreg_read;\nstruct cmpci_dmanode *\ncmpci_find_dmamem(sc, addr)\n\tstruct cmpci_softc *sc;\n\nstatic __inline uint8_t\ncmpci_mixerreg_read(sc, no)\n\tstruct cmpci_softc *sc;\n\tuint8_t no;\n{\n\tuint8_t ret;\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBADDR, no);\n\tdelay(10);\n\tret = bus_space_read_1(sc->sc_iot, sc->sc_ioh, CMPCI_REG_SBDATA);\n\tdelay(10);\n\treturn ret;\n}"
  }
]