[
  {
    "function_name": "neo_get_props",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "1080-1087",
    "snippet": "int\nneo_get_props(addr)\n\tvoid *addr;\n{\n\n\treturn (AUDIO_PROP_INDEPENDENT | \n                AUDIO_PROP_FULLDUPLEX);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tneo_get_props",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tneo_get_props;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_get_props(addr)\n\tvoid *addr;\n{\n\n\treturn (AUDIO_PROP_INDEPENDENT | \n                AUDIO_PROP_FULLDUPLEX);\n}"
  },
  {
    "function_name": "neo_round_buffersize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "1071-1077",
    "snippet": "u_long\nneo_round_buffersize(addr, size)\n\tvoid *addr;\n\tu_long size;\n{\n\treturn (NM_BUFFSIZE);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tNM_BUFFSIZE\t16384"
    ],
    "globals_used": [
      "u_long\tneo_round_buffersize",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;",
      "u_long size;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tNM_BUFFSIZE\t16384\n\nu_long\tneo_round_buffersize;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\nu_long size;\n\nu_long\nneo_round_buffersize(addr, size)\n\tvoid *addr;\n\tu_long size;\n{\n\treturn (NM_BUFFSIZE);\n}"
  },
  {
    "function_name": "neo_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "1062-1069",
    "snippet": "void\nneo_free(addr, ptr, pool)\n\tvoid *addr;\n\tvoid *ptr;\n\tint pool;\n{\n\treturn;\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tneo_free",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tneo_free;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nvoid\nneo_free(addr, ptr, pool)\n\tvoid *addr;\n\tvoid *ptr;\n\tint pool;\n{\n\treturn;\n}"
  },
  {
    "function_name": "neo_query_devinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "1027-1035",
    "snippet": "int\nneo_query_devinfo(addr, dip)\n\tvoid *addr;\n\tmixer_devinfo_t *dip;\n{\n\tstruct neo_softc *sc = addr;\n\n\treturn ((sc->codec_if->vtbl->query_devinfo)(sc->codec_if, dip));\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_query_devinfo",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->codec_if",
            "dip"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_query_devinfo;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_query_devinfo(addr, dip)\n\tvoid *addr;\n\tmixer_devinfo_t *dip;\n{\n\tstruct neo_softc *sc = addr;\n\n\treturn ((sc->codec_if->vtbl->query_devinfo)(sc->codec_if, dip));\n}"
  },
  {
    "function_name": "neo_mixer_get_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "1016-1025",
    "snippet": "int\nneo_mixer_get_port(addr, cp)\n\tvoid *addr;\n\tmixer_ctrl_t *cp;\n{\n\tstruct neo_softc *sc = addr;\n\n\treturn ((sc->codec_if->vtbl->mixer_get_port)(sc->codec_if,\n\t\t\t\t\t\t     cp));\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_mixer_get_port",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->codec_if",
            "cp"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_mixer_get_port;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_mixer_get_port(addr, cp)\n\tvoid *addr;\n\tmixer_ctrl_t *cp;\n{\n\tstruct neo_softc *sc = addr;\n\n\treturn ((sc->codec_if->vtbl->mixer_get_port)(sc->codec_if,\n\t\t\t\t\t\t     cp));\n}"
  },
  {
    "function_name": "neo_mixer_set_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "1005-1014",
    "snippet": "int\nneo_mixer_set_port(addr, cp)\n\tvoid *addr;\n\tmixer_ctrl_t *cp;\n{\n\tstruct neo_softc *sc = addr;\n\n\treturn ((sc->codec_if->vtbl->mixer_set_port)(sc->codec_if,\n\t\t\t\t\t\t     cp));\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_mixer_set_port",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->codec_if",
            "cp"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_mixer_set_port;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_mixer_set_port(addr, cp)\n\tvoid *addr;\n\tmixer_ctrl_t *cp;\n{\n\tstruct neo_softc *sc = addr;\n\n\treturn ((sc->codec_if->vtbl->mixer_set_port)(sc->codec_if,\n\t\t\t\t\t\t     cp));\n}"
  },
  {
    "function_name": "neo_getdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "996-1003",
    "snippet": "int\nneo_getdev(addr, retp)\n\tvoid *addr;\n\tstruct audio_device *retp;\n{\n\t*retp = neo_device;\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tneo_getdev",
      "struct audio_device neo_device = {\n\t\"NeoMagic 256\",\n\t\"\",\n\t\"neo\"\n};",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tneo_getdev;\nstruct audio_device neo_device = {\n\t\"NeoMagic 256\",\n\t\"\",\n\t\"neo\"\n};\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_getdev(addr, retp)\n\tvoid *addr;\n\tstruct audio_device *retp;\n{\n\t*retp = neo_device;\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_halt_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "983-994",
    "snippet": "int\nneo_halt_input(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\n\tsc->rintr = 0;\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_halt_input",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "NM_RECORD_ENABLE_REG",
            "0",
            "1"
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_halt_input;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_halt_input(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\n\tsc->rintr = 0;\n\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_halt_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "969-981",
    "snippet": "int\nneo_halt_output(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_PLAYBACK_ENABLE_REG, 0, 1);\n\tnm_wr(sc, NM_AUDIO_MUTE_REG, NM_AUDIO_MUTE_BOTH, 2);\n\n\tsc->pintr = 0;\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_halt_output",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "NM_AUDIO_MUTE_REG",
            "NM_AUDIO_MUTE_BOTH",
            "2"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_halt_output;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_halt_output(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_PLAYBACK_ENABLE_REG, 0, 1);\n\tnm_wr(sc, NM_AUDIO_MUTE_REG, NM_AUDIO_MUTE_BOTH, 2);\n\n\tsc->pintr = 0;\n\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_trigger_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "936-967",
    "snippet": "int\nneo_trigger_input(addr, start, end, blksize, intr, arg, param)\n\tvoid *addr;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct neo_softc *sc = addr;\t\n\tint ssz;\n\n\tsc->rintr = intr;\n\tsc->rarg = arg;\n\n\tssz = (param->precision * param->factor == 16)? 2 : 1;\n\tif (param->channels == 2)\n\t\tssz <<= 1;\n\n\tsc->rbufsize = ((char*)end - (char *)start);\n\tsc->rblksize = blksize;\n\tsc->rwmark = blksize;\n\n\tnm_wr(sc, NM_RBUFFER_START, sc->rbuf, 4);\n\tnm_wr(sc, NM_RBUFFER_END, sc->rbuf + sc->rbufsize, 4);\n\tnm_wr(sc, NM_RBUFFER_CURRP, sc->rbuf, 4);\n\tnm_wr(sc, NM_RBUFFER_WMARK, sc->rbuf + sc->rwmark, 4);\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, NM_RECORD_FREERUN |\n\t    NM_RECORD_ENABLE_FLAG, 1);\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_trigger_input",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "NM_RECORD_ENABLE_REG",
            "NM_RECORD_FREERUN |\n\t    NM_RECORD_ENABLE_FLAG",
            "1"
          ],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_trigger_input;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_trigger_input(addr, start, end, blksize, intr, arg, param)\n\tvoid *addr;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct neo_softc *sc = addr;\t\n\tint ssz;\n\n\tsc->rintr = intr;\n\tsc->rarg = arg;\n\n\tssz = (param->precision * param->factor == 16)? 2 : 1;\n\tif (param->channels == 2)\n\t\tssz <<= 1;\n\n\tsc->rbufsize = ((char*)end - (char *)start);\n\tsc->rblksize = blksize;\n\tsc->rwmark = blksize;\n\n\tnm_wr(sc, NM_RBUFFER_START, sc->rbuf, 4);\n\tnm_wr(sc, NM_RBUFFER_END, sc->rbuf + sc->rbufsize, 4);\n\tnm_wr(sc, NM_RBUFFER_CURRP, sc->rbuf, 4);\n\tnm_wr(sc, NM_RBUFFER_WMARK, sc->rbuf + sc->rwmark, 4);\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, NM_RECORD_FREERUN |\n\t    NM_RECORD_ENABLE_FLAG, 1);\n\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_trigger_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "900-932",
    "snippet": "int\nneo_trigger_output(addr, start, end, blksize, intr, arg, param)\n\tvoid *addr;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct neo_softc *sc = addr;\n\tint ssz;\n\n\tsc->pintr = intr;\n\tsc->parg = arg;\n\n\tssz = (param->precision * param->factor == 16)? 2 : 1;\n\tif (param->channels == 2)\n\t\tssz <<= 1;\n\n\tsc->pbufsize = ((char*)end - (char *)start);\n\tsc->pblksize = blksize;\n\tsc->pwmark = blksize;\n\n\tnm_wr(sc, NM_PBUFFER_START, sc->pbuf, 4);\n\tnm_wr(sc, NM_PBUFFER_END, sc->pbuf + sc->pbufsize - ssz, 4); \n\tnm_wr(sc, NM_PBUFFER_CURRP, sc->pbuf, 4);\n\tnm_wr(sc, NM_PBUFFER_WMARK, sc->pbuf + sc->pwmark, 4);\n\tnm_wr(sc, NM_PLAYBACK_ENABLE_REG, NM_PLAYBACK_FREERUN |\n\t    NM_PLAYBACK_ENABLE_FLAG, 1);\n\tnm_wr(sc, NM_AUDIO_MUTE_REG, 0, 2);\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_trigger_output",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "NM_AUDIO_MUTE_REG",
            "0",
            "2"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_trigger_output;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_trigger_output(addr, start, end, blksize, intr, arg, param)\n\tvoid *addr;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct neo_softc *sc = addr;\n\tint ssz;\n\n\tsc->pintr = intr;\n\tsc->parg = arg;\n\n\tssz = (param->precision * param->factor == 16)? 2 : 1;\n\tif (param->channels == 2)\n\t\tssz <<= 1;\n\n\tsc->pbufsize = ((char*)end - (char *)start);\n\tsc->pblksize = blksize;\n\tsc->pwmark = blksize;\n\n\tnm_wr(sc, NM_PBUFFER_START, sc->pbuf, 4);\n\tnm_wr(sc, NM_PBUFFER_END, sc->pbuf + sc->pbufsize - ssz, 4); \n\tnm_wr(sc, NM_PBUFFER_CURRP, sc->pbuf, 4);\n\tnm_wr(sc, NM_PBUFFER_WMARK, sc->pbuf + sc->pwmark, 4);\n\tnm_wr(sc, NM_PLAYBACK_ENABLE_REG, NM_PLAYBACK_FREERUN |\n\t    NM_PLAYBACK_ENABLE_FLAG, 1);\n\tnm_wr(sc, NM_AUDIO_MUTE_REG, 0, 2);\n\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_round_blocksize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "892-898",
    "snippet": "int\nneo_round_blocksize(addr, blk)\n\tvoid *addr;\n\tint blk;\n{\n\treturn (NM_BUFFSIZE / 2);\t\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tNM_BUFFSIZE\t16384"
    ],
    "globals_used": [
      "int\tneo_round_blocksize",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tNM_BUFFSIZE\t16384\n\nint\tneo_round_blocksize;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_round_blocksize(addr, blk)\n\tvoid *addr;\n\tint blk;\n{\n\treturn (NM_BUFFSIZE / 2);\t\n}"
  },
  {
    "function_name": "neo_set_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "805-890",
    "snippet": "int\nneo_set_params(addr, setmode, usemode, play, rec)\n\tvoid *addr;\n\tint setmode, usemode;\n\tstruct audio_params *play, *rec;\n{\n\tstruct neo_softc *sc = addr;\n\tu_int32_t base;\n\tu_int8_t x;\n\tint mode;\n\tstruct audio_params *p;\n\n\tfor (mode = AUMODE_RECORD; mode != -1; \n\t     mode = mode == AUMODE_RECORD ? AUMODE_PLAY : -1) {\n\t\tif ((setmode & mode) == 0)\n\t\t\tcontinue;\n\n\t\tp = mode == AUMODE_PLAY ? play : rec;\n\n\t\tif (p == NULL) continue;\n\n\t\tfor (x = 0; x < 8; x++)\n\t\t\tif (p->sample_rate < (samplerates[x] + samplerates[x + 1]) / 2)\n\t\t\t\tbreak;\n\t\t\n\t\tif (x == 8) return (EINVAL);\n\n\t\tp->sample_rate = samplerates[x];\n\t\tnm_loadcoeff(sc, mode, x);\n\n\t\tx <<= 4;\n\t\tx &= NM_RATE_MASK;\n\t\tif (p->precision == 16) x |= NM_RATE_BITS_16;\n\t\tif (p->channels == 2) x |= NM_RATE_STEREO;\n\n\t\tbase = (mode == AUMODE_PLAY)? \n\t\t    NM_PLAYBACK_REG_OFFSET : NM_RECORD_REG_OFFSET;\n\t\tnm_wr(sc, base + NM_RATE_REG_OFFSET, x, 1);\n\t\t\n\t\tp->factor = 1;\n\t\tp->sw_code = 0;\n\t\tswitch (p->encoding) {\n\t\tcase AUDIO_ENCODING_SLINEAR_BE:\n\t\t\tif (p->precision == 16)\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\telse\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_LE:\n\t\t\tif (p->precision != 16)\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_BE:\n\t\t\tif (p->precision == 16) {\n\t\t\t\tif (mode == AUMODE_PLAY)\n\t\t\t\t\tp->sw_code = swap_bytes_change_sign16;\n\t\t\t\telse\n\t\t\t\t\tp->sw_code = change_sign16_swap_bytes;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_LE:\n\t\t\tif (p->precision == 16)\n\t\t\t\tp->sw_code = change_sign16;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = mulaw_to_slinear16;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_mulaw;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ALAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = alaw_to_slinear16;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_alaw;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t}\n\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
      "int\tneo_set_params",
      "static int samplerates[9] = {\n\t8000,\n\t11025,\n\t16000,\n\t22050,\n\t24000,\n\t32000,\n\t44100,\n\t48000,\n\t99999999\n};",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "base + NM_RATE_REG_OFFSET",
            "x",
            "1"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nm_loadcoeff",
          "args": [
            "sc",
            "mode",
            "x"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "nm_loadcoeff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "390-410",
          "snippet": "static int\nnm_loadcoeff(struct neo_softc *sc, int dir, int num)\n{\n\tint ofs, sz, i;\n\tu_int32_t addr;\n\n\taddr = (dir == AUMODE_PLAY)? 0x01c : 0x21c;\n\tif (dir == AUMODE_RECORD)\n\t\tnum += 8;\n\tsz = coefficientSizes[num];\n\tofs = 0;\n\twhile (num-- > 0)\n\t\tofs+= coefficientSizes[num];\n\tfor (i = 0; i < sz; i++)\n\t\tnm_wrbuf(sc, sc->cbuf + i, coefficients[ofs + i], 1);\n\tnm_wr(sc, addr, sc->cbuf, 4);\n\tif (dir == AUMODE_PLAY)\n\t\tsz--;\n\tnm_wr(sc, addr + 4, sc->cbuf + sz, 4);\n\treturn 0;\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nstatic int\nnm_loadcoeff(struct neo_softc *sc, int dir, int num)\n{\n\tint ofs, sz, i;\n\tu_int32_t addr;\n\n\taddr = (dir == AUMODE_PLAY)? 0x01c : 0x21c;\n\tif (dir == AUMODE_RECORD)\n\t\tnum += 8;\n\tsz = coefficientSizes[num];\n\tofs = 0;\n\twhile (num-- > 0)\n\t\tofs+= coefficientSizes[num];\n\tfor (i = 0; i < sz; i++)\n\t\tnm_wrbuf(sc, sc->cbuf + i, coefficients[ofs + i], 1);\n\tnm_wr(sc, addr, sc->cbuf, 4);\n\tif (dir == AUMODE_PLAY)\n\t\tsz--;\n\tnm_wr(sc, addr + 4, sc->cbuf + sz, 4);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nint\tneo_set_params;\nstatic int samplerates[9] = {\n\t8000,\n\t11025,\n\t16000,\n\t22050,\n\t24000,\n\t32000,\n\t44100,\n\t48000,\n\t99999999\n};\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_set_params(addr, setmode, usemode, play, rec)\n\tvoid *addr;\n\tint setmode, usemode;\n\tstruct audio_params *play, *rec;\n{\n\tstruct neo_softc *sc = addr;\n\tu_int32_t base;\n\tu_int8_t x;\n\tint mode;\n\tstruct audio_params *p;\n\n\tfor (mode = AUMODE_RECORD; mode != -1; \n\t     mode = mode == AUMODE_RECORD ? AUMODE_PLAY : -1) {\n\t\tif ((setmode & mode) == 0)\n\t\t\tcontinue;\n\n\t\tp = mode == AUMODE_PLAY ? play : rec;\n\n\t\tif (p == NULL) continue;\n\n\t\tfor (x = 0; x < 8; x++)\n\t\t\tif (p->sample_rate < (samplerates[x] + samplerates[x + 1]) / 2)\n\t\t\t\tbreak;\n\t\t\n\t\tif (x == 8) return (EINVAL);\n\n\t\tp->sample_rate = samplerates[x];\n\t\tnm_loadcoeff(sc, mode, x);\n\n\t\tx <<= 4;\n\t\tx &= NM_RATE_MASK;\n\t\tif (p->precision == 16) x |= NM_RATE_BITS_16;\n\t\tif (p->channels == 2) x |= NM_RATE_STEREO;\n\n\t\tbase = (mode == AUMODE_PLAY)? \n\t\t    NM_PLAYBACK_REG_OFFSET : NM_RECORD_REG_OFFSET;\n\t\tnm_wr(sc, base + NM_RATE_REG_OFFSET, x, 1);\n\t\t\n\t\tp->factor = 1;\n\t\tp->sw_code = 0;\n\t\tswitch (p->encoding) {\n\t\tcase AUDIO_ENCODING_SLINEAR_BE:\n\t\t\tif (p->precision == 16)\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\telse\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_LE:\n\t\t\tif (p->precision != 16)\n\t\t\t\tp->sw_code = change_sign8;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_BE:\n\t\t\tif (p->precision == 16) {\n\t\t\t\tif (mode == AUMODE_PLAY)\n\t\t\t\t\tp->sw_code = swap_bytes_change_sign16;\n\t\t\t\telse\n\t\t\t\t\tp->sw_code = change_sign16_swap_bytes;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULINEAR_LE:\n\t\t\tif (p->precision == 16)\n\t\t\t\tp->sw_code = change_sign16;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = mulaw_to_slinear16;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_mulaw;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ALAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = alaw_to_slinear16;\n\t\t\t} else\n\t\t\t\tp->sw_code = ulinear8_to_alaw;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t}\n\n\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_query_encoding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "745-802",
    "snippet": "int\nneo_query_encoding(addr, fp)\n\tvoid *addr;\n\tstruct audio_encoding *fp;\n{\n\tswitch (fp->index) {\n\tcase 0:\n\t\tstrcpy(fp->name, AudioEulinear);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\treturn (0);\n\tcase 1:\n\t\tstrcpy(fp->name, AudioEmulaw);\n\t\tfp->encoding = AUDIO_ENCODING_ULAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 2:\n\t\tstrcpy(fp->name, AudioEalaw);\n\t\tfp->encoding = AUDIO_ENCODING_ALAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 3:\n\t\tstrcpy(fp->name, AudioEslinear);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 4:\n\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = 0;\n\t\treturn (0);\n\tcase 5:\n\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 6:\n\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 7:\n\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tneo_query_encoding",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;",
      "int pool, flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_be"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_be"
          ],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_le"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_le"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEalaw"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEmulaw"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tneo_query_encoding;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\nint pool, flags;\n\nint\nneo_query_encoding(addr, fp)\n\tvoid *addr;\n\tstruct audio_encoding *fp;\n{\n\tswitch (fp->index) {\n\tcase 0:\n\t\tstrcpy(fp->name, AudioEulinear);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\treturn (0);\n\tcase 1:\n\t\tstrcpy(fp->name, AudioEmulaw);\n\t\tfp->encoding = AUDIO_ENCODING_ULAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 2:\n\t\tstrcpy(fp->name, AudioEalaw);\n\t\tfp->encoding = AUDIO_ENCODING_ALAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 3:\n\t\tstrcpy(fp->name, AudioEslinear);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 4:\n\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = 0;\n\t\treturn (0);\n\tcase 5:\n\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 6:\n\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tcase 7:\n\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\tfp->precision = 16;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\treturn (0);\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n}"
  },
  {
    "function_name": "neo_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "732-743",
    "snippet": "void\nneo_close(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = addr;\n    \n\tneo_halt_output(sc);\n\tneo_halt_input(sc);\n\n\tsc->pintr = 0;\n\tsc->rintr = 0;\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "void\tneo_close",
      "int\tneo_halt_output",
      "int\tneo_halt_input",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "neo_halt_input",
          "args": [
            "sc"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "neo_halt_input",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "983-994",
          "snippet": "int\nneo_halt_input(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\n\tsc->rintr = 0;\n\n\treturn (0);\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "int\tneo_halt_input",
            "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_halt_input;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_halt_input(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\n\tsc->rintr = 0;\n\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "neo_halt_output",
          "args": [
            "sc"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "neo_halt_output",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "969-981",
          "snippet": "int\nneo_halt_output(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_PLAYBACK_ENABLE_REG, 0, 1);\n\tnm_wr(sc, NM_AUDIO_MUTE_REG, NM_AUDIO_MUTE_BOTH, 2);\n\n\tsc->pintr = 0;\n\n\treturn (0);\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "int\tneo_halt_output",
            "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_halt_output;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nint\nneo_halt_output(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)addr;\n\n\tnm_wr(sc, NM_PLAYBACK_ENABLE_REG, 0, 1);\n\tnm_wr(sc, NM_AUDIO_MUTE_REG, NM_AUDIO_MUTE_BOTH, 2);\n\n\tsc->pintr = 0;\n\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nvoid\tneo_close;\nint\tneo_halt_output;\nint\tneo_halt_input;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nvoid\nneo_close(addr)\n\tvoid *addr;\n{\n\tstruct neo_softc *sc = addr;\n    \n\tneo_halt_output(sc);\n\tneo_halt_input(sc);\n\n\tsc->pintr = 0;\n\tsc->rintr = 0;\n}"
  },
  {
    "function_name": "neo_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "721-727",
    "snippet": "int\nneo_open(addr, flags)\n\tvoid *addr;\n\tint flags;\n{\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tneo_open",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;",
      "int pool, flags;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tneo_open;\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\nint pool, flags;\n\nint\nneo_open(addr, flags)\n\tvoid *addr;\n\tint flags;\n{\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_reset_codec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "708-718",
    "snippet": "void\nneo_reset_codec(sc)\n\tvoid *sc;\n{\n\tnm_wr(sc, 0x6c0, 0x01, 1);\n\tnm_wr(sc, 0x6cc, 0x87, 1);\n\tnm_wr(sc, 0x6cc, 0x80, 1);\n\tnm_wr(sc, 0x6cc, 0x00, 1);\n\n\treturn;\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "void    neo_reset_codec"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "0x6cc",
            "0x00",
            "1"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nvoid    neo_reset_codec;\n\nvoid\nneo_reset_codec(sc)\n\tvoid *sc;\n{\n\tnm_wr(sc, 0x6c0, 0x01, 1);\n\tnm_wr(sc, 0x6cc, 0x87, 1);\n\tnm_wr(sc, 0x6cc, 0x80, 1);\n\tnm_wr(sc, 0x6cc, 0x00, 1);\n\n\treturn;\n}"
  },
  {
    "function_name": "neo_attach_codec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "697-706",
    "snippet": "int\nneo_attach_codec(sc_, codec_if)\n\tvoid *sc_;\n\tstruct ac97_codec_if  *codec_if;\n{\n\tstruct neo_softc *sc = sc_;\n\n\tsc->codec_if = codec_if;\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int     neo_attach_codec"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint     neo_attach_codec;\n\nint\nneo_attach_codec(sc_, codec_if)\n\tvoid *sc_;\n\tstruct ac97_codec_if  *codec_if;\n{\n\tstruct neo_softc *sc = sc_;\n\n\tsc->codec_if = codec_if;\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_write_codec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "674-694",
    "snippet": "int\nneo_write_codec(sc_, a, d)\n        void *sc_;\n\tu_int8_t a;\n\tu_int16_t d;\n{\n\tstruct neo_softc *sc = sc_;\n\tint cnt = 3;\n\n\tif (!nm_waitcd(sc)) {\n\t\twhile (cnt-- > 0) {\n\t\t\tnm_wr(sc, sc->ac97_base + a, d, 2);\n\t\t\tif (!nm_waitcd(sc)) {\n\t\t\t\tDELAY(1000);\n\t\t\t\treturn (0);\n\t\t\t}\n\t\t}\n\t}\n\n        return (ENXIO);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_write_codec"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1000"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nm_waitcd",
          "args": [
            "sc"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "nm_waitcd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "362-377",
          "snippet": "static int\nnm_waitcd(struct neo_softc *sc)\n{\n\tint cnt = 10;\n\tint fail = 1;\n\n\twhile (cnt-- > 0) {\n\t\tif (nm_rd(sc, sc->ac97_status, 2) & sc->ac97_busy)\n\t\t\tDELAY(100);\n\t\telse {\n\t\t        fail = 0;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (fail);\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\n\nstatic int\nnm_waitcd(struct neo_softc *sc)\n{\n\tint cnt = 10;\n\tint fail = 1;\n\n\twhile (cnt-- > 0) {\n\t\tif (nm_rd(sc, sc->ac97_status, 2) & sc->ac97_busy)\n\t\t\tDELAY(100);\n\t\telse {\n\t\t        fail = 0;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (fail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "sc->ac97_base + a",
            "d",
            "2"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_write_codec;\n\nint\nneo_write_codec(sc_, a, d)\n        void *sc_;\n\tu_int8_t a;\n\tu_int16_t d;\n{\n\tstruct neo_softc *sc = sc_;\n\tint cnt = 3;\n\n\tif (!nm_waitcd(sc)) {\n\t\twhile (cnt-- > 0) {\n\t\t\tnm_wr(sc, sc->ac97_base + a, d, 2);\n\t\t\tif (!nm_waitcd(sc)) {\n\t\t\t\tDELAY(1000);\n\t\t\t\treturn (0);\n\t\t\t}\n\t\t}\n\t}\n\n        return (ENXIO);\n}"
  },
  {
    "function_name": "neo_read_codec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "656-671",
    "snippet": "int\nneo_read_codec(sc_, a, d)\n        void *sc_;\n\tu_int8_t a;\n\tu_int16_t *d;\n{\n\tstruct neo_softc *sc = sc_;\n\t\n\tif (!nm_waitcd(sc)) {\n\t\t*d = nm_rd(sc, sc->ac97_base + a, 2);\n\t\tDELAY(1000);\n\t\treturn 0;\n\t}\n\n\treturn (ENXIO);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_read_codec"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1000"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nm_rd",
          "args": [
            "sc",
            "sc->ac97_base + a",
            "2"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "nm_rdbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "324-340",
          "snippet": "static u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nm_waitcd",
          "args": [
            "sc"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "nm_waitcd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "362-377",
          "snippet": "static int\nnm_waitcd(struct neo_softc *sc)\n{\n\tint cnt = 10;\n\tint fail = 1;\n\n\twhile (cnt-- > 0) {\n\t\tif (nm_rd(sc, sc->ac97_status, 2) & sc->ac97_busy)\n\t\t\tDELAY(100);\n\t\telse {\n\t\t        fail = 0;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (fail);\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\n\nstatic int\nnm_waitcd(struct neo_softc *sc)\n{\n\tint cnt = 10;\n\tint fail = 1;\n\n\twhile (cnt-- > 0) {\n\t\tif (nm_rd(sc, sc->ac97_status, 2) & sc->ac97_busy)\n\t\t\tDELAY(100);\n\t\telse {\n\t\t        fail = 0;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (fail);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_read_codec;\n\nint\nneo_read_codec(sc_, a, d)\n        void *sc_;\n\tu_int8_t a;\n\tu_int16_t *d;\n{\n\tstruct neo_softc *sc = sc_;\n\t\n\tif (!nm_waitcd(sc)) {\n\t\t*d = nm_rd(sc, sc->ac97_base + a, 2);\n\t\tDELAY(1000);\n\t\treturn 0;\n\t}\n\n\treturn (ENXIO);\n}"
  },
  {
    "function_name": "neo_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "620-654",
    "snippet": "int\nneo_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = (struct pci_attach_args *) aux;\n#if 0\n\tu_int32_t subdev, badcard;\n#endif\n\n\tif (PCI_VENDOR(pa->pa_id) != PCI_VENDOR_NEOMAGIC)\n\t\treturn (0);\n\n#if 0\n\tsubdev = (pci_get_subdevice(dev) << 16) | pci_get_subvendor(dev);\n#endif\n\tswitch (PCI_PRODUCT(pa->pa_id)) {\n\tcase PCI_PRODUCT_NEOMAGIC_NM256AV:\n#if 0\n\t\ti = 0;\n\t\twhile ((i < NUM_BADCARDS) && (badcards[i] != subdev))\n\t\t\ti++;\n\t\tif (i == NUM_BADCARDS)\n\t\t\ts = \"NeoMagic 256AV\";\n\t\tDEB(else)\n\t\t\tDEB(device_printf(dev, \"this is a non-ac97 NM256AV, not attaching\\n\"));\n\t\treturn (1);\n#endif\n\tcase PCI_PRODUCT_NEOMAGIC_NM256ZX:\n\t\treturn (1);\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define NUM_BADCARDS (sizeof(badcards) / sizeof(u_int32_t))"
    ],
    "globals_used": [
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
      "int\tneo_match"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PCI_PRODUCT",
          "args": [
            "pa->pa_id"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_get_subvendor",
          "args": [
            "dev"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_get_subdevice",
          "args": [
            "dev"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_VENDOR",
          "args": [
            "pa->pa_id"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define NUM_BADCARDS (sizeof(badcards) / sizeof(u_int32_t))\n\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nint\tneo_match;\n\nint\nneo_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = (struct pci_attach_args *) aux;\n#if 0\n\tu_int32_t subdev, badcard;\n#endif\n\n\tif (PCI_VENDOR(pa->pa_id) != PCI_VENDOR_NEOMAGIC)\n\t\treturn (0);\n\n#if 0\n\tsubdev = (pci_get_subdevice(dev) << 16) | pci_get_subvendor(dev);\n#endif\n\tswitch (PCI_PRODUCT(pa->pa_id)) {\n\tcase PCI_PRODUCT_NEOMAGIC_NM256AV:\n#if 0\n\t\ti = 0;\n\t\twhile ((i < NUM_BADCARDS) && (badcards[i] != subdev))\n\t\t\ti++;\n\t\tif (i == NUM_BADCARDS)\n\t\t\ts = \"NeoMagic 256AV\";\n\t\tDEB(else)\n\t\t\tDEB(device_printf(dev, \"this is a non-ac97 NM256AV, not attaching\\n\"));\n\t\treturn (1);\n#endif\n\tcase PCI_PRODUCT_NEOMAGIC_NM256ZX:\n\t\treturn (1);\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "neo_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "547-618",
    "snippet": "void\nneo_attach(parent, self, aux)\n\tstruct device *parent;\n\tstruct device *self;\n\tvoid *aux;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)self;\n\tstruct pci_attach_args *pa = (struct pci_attach_args *)aux;\n\tpci_chipset_tag_t pc = pa->pa_pc;\n\tchar const *intrstr;\n\tpci_intr_handle_t ih;\n\tpcireg_t csr;\n\tint error;\n\n\tsc->type = pa->pa_id;\n\n\t/* Map I/O register */\n\tif (pci_mapreg_map(pa, PCI_MAPS, PCI_MAPREG_TYPE_MEM, 0,\n\t\t\t   &sc->bufiot, &sc->bufioh, NULL, NULL)) {\n\t\tprintf(\"\\n%s: can't map i/o space\\n\", sc->dev.dv_xname);\n\t\treturn;\n\t}\n\n\n\tif (pci_mapreg_map(pa, PCI_MAPS + 4, PCI_MAPREG_TYPE_MEM, 0,\n\t\t\t   &sc->regiot, &sc->regioh, NULL, NULL)) {\n\t\tprintf(\"\\n%s: can't map i/o space\\n\", sc->dev.dv_xname);\n\t\treturn;\n\t}\n\n\t/* Map and establish the interrupt. */\n\tif (pci_intr_map(pc, pa->pa_intrtag, pa->pa_intrpin,\n\t\t\t pa->pa_intrline, &ih)) {\n\t\tprintf(\"\\n%s: couldn't map interrupt\\n\", sc->dev.dv_xname);\n\t\treturn;\n\t}\n\tintrstr = pci_intr_string(pc, ih);\n\tsc->ih = pci_intr_establish(pc, ih, IPL_AUDIO, neo_intr, sc, \n\t\t\t\t       sc->dev.dv_xname);\n\n\tif (sc->ih == NULL) {\n\t\tprintf(\"\\n%s: couldn't establish interrupt\",\n\t\t       sc->dev.dv_xname);\n\t\tif (intrstr != NULL)\n\t\t\tprintf(\" at %s\", intrstr);\n\t\tprintf(\"\\n\");\n\t\treturn;\n\t}\n\tprintf(\": %s\\n\", intrstr);\n\n\tif ((error = nm_init(sc)) != 0)\n\t\treturn;\n\n\t/* Enable the device. */\n\tcsr = pci_conf_read(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG);\n\tpci_conf_write(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG,\n\t\t       csr | PCI_COMMAND_MASTER_ENABLE);\n\n\tsc->host_if.arg = sc;\n\n\tsc->host_if.attach = neo_attach_codec;\n\tsc->host_if.read   = neo_read_codec;\n\tsc->host_if.write  = neo_write_codec;\n\tsc->host_if.reset  = neo_reset_codec;\n\t\t\n\tif ((error = ac97_attach(&sc->host_if)) != 0)\n\t\treturn;\n\n\taudio_attach_mi(&neo_hw_if, sc, &sc->dev);\n\n\treturn;\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "void\tneo_attach",
      "int\tneo_intr",
      "int     neo_attach_codec",
      "int\tneo_read_codec",
      "int\tneo_write_codec",
      "void    neo_reset_codec",
      "struct audio_hw_if neo_hw_if = {\n\tneo_open,\n\tneo_close,\n\tNULL,\n\tneo_query_encoding,\n\tneo_set_params,\n#if 1\n\tneo_round_blocksize,\n#else\n\tNULL,\n#endif\n\tNULL,\n\tNULL,\n\tNULL,\n\tNULL,\n\tNULL,\n\tneo_halt_output,\n\tneo_halt_input,\n\tNULL,\n\tneo_getdev,\n\tNULL,\n\tneo_mixer_set_port,\n\tneo_mixer_get_port,\n\tneo_query_devinfo,\n\tneo_malloc,\n\tneo_free,\n\tneo_round_buffersize,\n\t0, /* neo_mappage, */\n\tneo_get_props,\n\tneo_trigger_output,\n\tneo_trigger_input,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "audio_attach_mi",
          "args": [
            "&neo_hw_if",
            "sc",
            "&sc->dev"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "audio_attach_mi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "394-408",
          "snippet": "void\naudio_attach_mi(ahwp, hdlp, dev)\n\tstruct audio_hw_if *ahwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n\tif (ahwp != NULL) {\n\t\targ.type = AUDIODEV_TYPE_AUDIO;\n\t\targ.hwif = ahwp;\n\t\targ.hdl = hdlp;\n\t\t(void)config_found(dev, &arg, audioprint);\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nvoid\naudio_attach_mi(ahwp, hdlp, dev)\n\tstruct audio_hw_if *ahwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n\tif (ahwp != NULL) {\n\t\targ.type = AUDIODEV_TYPE_AUDIO;\n\t\targ.hwif = ahwp;\n\t\targ.hdl = hdlp;\n\t\t(void)config_found(dev, &arg, audioprint);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ac97_attach",
          "args": [
            "&sc->host_if"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "ac97_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/ac97.c",
          "lines": "476-557",
          "snippet": "int \nac97_attach(hostIf)\n\tstruct ac97_host_if *hostIf;\n{\n\tstruct ac97_softc *as;\n\tint error, i, j;\n\tu_int16_t id1, id2, caps;\n\tu_int32_t id;\n\tmixer_ctrl_t ctl;\n\n\tas = malloc(sizeof(struct ac97_softc), M_DEVBUF, M_WAITOK);\n\n\tif (!as) return (ENOMEM);\n\n\tas->codecIf.vtbl = &ac97civ;\n\tas->hostIf = hostIf;\n\n\tif ((error = hostIf->attach(hostIf->arg, &as->codecIf))) {\n\t\tfree (as, M_DEVBUF);\n\t\treturn (error);\n\t}\n\n\thostIf->reset(hostIf->arg);\n\tDELAY(1000);\n\n\thostIf->write(hostIf->arg, AC97_REG_POWER, 0);\n\thostIf->write(hostIf->arg, AC97_REG_RESET, 0);\n\tDELAY(10000);\n\n\tif ((error = hostIf->read(hostIf->arg, AC97_REG_VENDOR_ID1, &id1)))\n\t\treturn (error);\n\n\tif ((error = hostIf->read(hostIf->arg, AC97_REG_VENDOR_ID2, &id2)))\n\t\treturn (error);\n\n\tif ((error = hostIf->read(hostIf->arg, AC97_REG_RESET, &caps)))\n\t\treturn (error);\n\n\tid = (id1 << 16) | id2;\n\n\tprintf(\"ac97: codec id 0x%8x\", id);\n\tfor (i = 0; ac97codecid[i].id; i++) {\n\t\tif (ac97codecid[i].id == id) \n\t\t\tprintf(\" (%s)\", ac97codecid[i].name);\n\t}\n\tprintf(\"\\nac97: codec features \");\n\tfor (i = j = 0; i < 10; i++) {\n\t\tif (caps & (1 << i)) {\n\t\t\tprintf(\"%s%s\", j? \", \" : \"\", ac97feature[i]);\n\t\t\tj++;\n\t\t}\n\t}\n\n\tprintf(\"%s%s\\n\", j? \", \" : \"\", ac97enhancement[(caps >> 10) & 0x1f]);\n\n\tac97_setup_source_info(as);\n\n\t/* Just enable the DAC and master volumes by default */\n\tbzero(&ctl, sizeof(ctl));\n\n\tctl.type = AUDIO_MIXER_ENUM;\n\tctl.un.ord = 0;  /* off */\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCoutputs,\n\t\t\t\t\t   AudioNmaster, AudioNmute);\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCinputs,\n\t\t\t\t\t   AudioNdac, AudioNmute);\n\t\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCrecord,\n\t\t\t\t\t   AudioNvolume, AudioNmute);\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\t\t\n\t\t\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCrecord,\n\t\t\t\t\t   AudioNsource, NULL);\n\tctl.type = AUDIO_MIXER_ENUM;\n\tctl.un.ord = 0;\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\n\treturn (0);\n}",
          "includes": [
            "#include <dev/ic/ac97.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define AC97_REG_VENDOR_ID2           0x7e",
            "#define AC97_REG_VENDOR_ID1           0x7c",
            "#define AC97_REG_POWER                0x26",
            "#define AC97_REG_RESET                0x00"
          ],
          "globals_used": [
            "int ac97_mixer_set_port",
            "int ac97_get_portnum_by_name",
            "struct ac97_codec_if_vtbl ac97civ = {\n\tac97_mixer_get_port, \n\tac97_mixer_set_port,\n\tac97_query_devinfo,\n\tac97_get_portnum_by_name\n};",
            "static struct ac97_codecid {\n\tu_int32_t id;\n\tchar *name;\n} ac97codecid[] = {\n\t{ 0x414B4D00, \"Asahi Kasei AK4540\" \t},\n\t{ 0x43525900, \"Cirrus Logic CS4297\" \t},\n\t{ 0x83847600, \"SigmaTel STAC????\" \t},\n\t{ 0x83847604, \"SigmaTel STAC9701/3/4/5\" },\n\t{ 0x83847605, \"SigmaTel STAC9704\" \t},\n\t{ 0x83847608, \"SigmaTel STAC9708\" \t},\n\t{ 0x83847609, \"SigmaTel STAC9721\" \t},\n\t{ 0, \t      NULL\t\t\t}\n};",
            "static char *ac97enhancement[] = {\n\t\"No 3D Stereo\",\n\t\"Analog Devices Phat Stereo\",\n\t\"Creative\"\n\t\"National Semi 3D\",\n\t\"Yamaha Ymersion\",\n\t\"BBE 3D\",\n\t\"Crystal Semi 3D\"\n\t\"Qsound QXpander\",\n\t\"Spatializer 3D\",\n\t\"SRS 3D\",\n\t\"Platform Tech 3D\",\n\t\"AKM 3D\",\n\t\"Aureal\",\n\t\"AZTECH 3D\",\n\t\"Binaura 3D\",\n\t\"ESS Technology\",\n\t\"Harman International VMAx\",\n\t\"Nvidea 3D\",\n\t\"Philips Incredible Sound\",\n\t\"Texas Instruments' 3D\",\n\t\"VLSI Technology 3D\",\n\t\"TriTech 3D\",\n\t\"Realtek 3D\",\n\t\"Samsung 3D\",\n\t\"Wolfson Microelectronics 3D\",\n\t\"Delta Integration 3D\",\n\t\"SigmaTel 3D\",\n\t\"Unknown 3D\",\n\t\"Rockwell 3D\",\n\t\"Unknown 3D\",\n\t\"Unknown 3D\",\n\t\"Unknown 3D\",\n};",
            "static char *ac97feature[] = {\n\t\"mic channel\",\n\t\"reserved\",\n\t\"tone\",\n\t\"simulated stereo\",\n\t\"headphone\",\n\t\"bass boost\",\n\t\"18 bit DAC\",\n\t\"20 bit DAC\",\n\t\"18 bit ADC\",\n\t\"20 bit ADC\"\n};",
            "void ac97_setup_source_info"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/ac97.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define AC97_REG_VENDOR_ID2           0x7e\n#define AC97_REG_VENDOR_ID1           0x7c\n#define AC97_REG_POWER                0x26\n#define AC97_REG_RESET                0x00\n\nint ac97_mixer_set_port;\nint ac97_get_portnum_by_name;\nstruct ac97_codec_if_vtbl ac97civ = {\n\tac97_mixer_get_port, \n\tac97_mixer_set_port,\n\tac97_query_devinfo,\n\tac97_get_portnum_by_name\n};\nstatic struct ac97_codecid {\n\tu_int32_t id;\n\tchar *name;\n} ac97codecid[] = {\n\t{ 0x414B4D00, \"Asahi Kasei AK4540\" \t},\n\t{ 0x43525900, \"Cirrus Logic CS4297\" \t},\n\t{ 0x83847600, \"SigmaTel STAC????\" \t},\n\t{ 0x83847604, \"SigmaTel STAC9701/3/4/5\" },\n\t{ 0x83847605, \"SigmaTel STAC9704\" \t},\n\t{ 0x83847608, \"SigmaTel STAC9708\" \t},\n\t{ 0x83847609, \"SigmaTel STAC9721\" \t},\n\t{ 0, \t      NULL\t\t\t}\n};\nstatic char *ac97enhancement[] = {\n\t\"No 3D Stereo\",\n\t\"Analog Devices Phat Stereo\",\n\t\"Creative\"\n\t\"National Semi 3D\",\n\t\"Yamaha Ymersion\",\n\t\"BBE 3D\",\n\t\"Crystal Semi 3D\"\n\t\"Qsound QXpander\",\n\t\"Spatializer 3D\",\n\t\"SRS 3D\",\n\t\"Platform Tech 3D\",\n\t\"AKM 3D\",\n\t\"Aureal\",\n\t\"AZTECH 3D\",\n\t\"Binaura 3D\",\n\t\"ESS Technology\",\n\t\"Harman International VMAx\",\n\t\"Nvidea 3D\",\n\t\"Philips Incredible Sound\",\n\t\"Texas Instruments' 3D\",\n\t\"VLSI Technology 3D\",\n\t\"TriTech 3D\",\n\t\"Realtek 3D\",\n\t\"Samsung 3D\",\n\t\"Wolfson Microelectronics 3D\",\n\t\"Delta Integration 3D\",\n\t\"SigmaTel 3D\",\n\t\"Unknown 3D\",\n\t\"Rockwell 3D\",\n\t\"Unknown 3D\",\n\t\"Unknown 3D\",\n\t\"Unknown 3D\",\n};\nstatic char *ac97feature[] = {\n\t\"mic channel\",\n\t\"reserved\",\n\t\"tone\",\n\t\"simulated stereo\",\n\t\"headphone\",\n\t\"bass boost\",\n\t\"18 bit DAC\",\n\t\"20 bit DAC\",\n\t\"18 bit ADC\",\n\t\"20 bit ADC\"\n};\nvoid ac97_setup_source_info;\n\nint \nac97_attach(hostIf)\n\tstruct ac97_host_if *hostIf;\n{\n\tstruct ac97_softc *as;\n\tint error, i, j;\n\tu_int16_t id1, id2, caps;\n\tu_int32_t id;\n\tmixer_ctrl_t ctl;\n\n\tas = malloc(sizeof(struct ac97_softc), M_DEVBUF, M_WAITOK);\n\n\tif (!as) return (ENOMEM);\n\n\tas->codecIf.vtbl = &ac97civ;\n\tas->hostIf = hostIf;\n\n\tif ((error = hostIf->attach(hostIf->arg, &as->codecIf))) {\n\t\tfree (as, M_DEVBUF);\n\t\treturn (error);\n\t}\n\n\thostIf->reset(hostIf->arg);\n\tDELAY(1000);\n\n\thostIf->write(hostIf->arg, AC97_REG_POWER, 0);\n\thostIf->write(hostIf->arg, AC97_REG_RESET, 0);\n\tDELAY(10000);\n\n\tif ((error = hostIf->read(hostIf->arg, AC97_REG_VENDOR_ID1, &id1)))\n\t\treturn (error);\n\n\tif ((error = hostIf->read(hostIf->arg, AC97_REG_VENDOR_ID2, &id2)))\n\t\treturn (error);\n\n\tif ((error = hostIf->read(hostIf->arg, AC97_REG_RESET, &caps)))\n\t\treturn (error);\n\n\tid = (id1 << 16) | id2;\n\n\tprintf(\"ac97: codec id 0x%8x\", id);\n\tfor (i = 0; ac97codecid[i].id; i++) {\n\t\tif (ac97codecid[i].id == id) \n\t\t\tprintf(\" (%s)\", ac97codecid[i].name);\n\t}\n\tprintf(\"\\nac97: codec features \");\n\tfor (i = j = 0; i < 10; i++) {\n\t\tif (caps & (1 << i)) {\n\t\t\tprintf(\"%s%s\", j? \", \" : \"\", ac97feature[i]);\n\t\t\tj++;\n\t\t}\n\t}\n\n\tprintf(\"%s%s\\n\", j? \", \" : \"\", ac97enhancement[(caps >> 10) & 0x1f]);\n\n\tac97_setup_source_info(as);\n\n\t/* Just enable the DAC and master volumes by default */\n\tbzero(&ctl, sizeof(ctl));\n\n\tctl.type = AUDIO_MIXER_ENUM;\n\tctl.un.ord = 0;  /* off */\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCoutputs,\n\t\t\t\t\t   AudioNmaster, AudioNmute);\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCinputs,\n\t\t\t\t\t   AudioNdac, AudioNmute);\n\t\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCrecord,\n\t\t\t\t\t   AudioNvolume, AudioNmute);\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\t\t\n\t\t\n\tctl.dev = ac97_get_portnum_by_name(&as->codecIf, AudioCrecord,\n\t\t\t\t\t   AudioNsource, NULL);\n\tctl.type = AUDIO_MIXER_ENUM;\n\tctl.un.ord = 0;\n\tac97_mixer_set_port(&as->codecIf, &ctl);\n\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pci_conf_write",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "PCI_COMMAND_STATUS_REG",
            "csr | PCI_COMMAND_MASTER_ENABLE"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_conf_read",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "PCI_COMMAND_STATUS_REG"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nm_init",
          "args": [
            "sc"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "nm_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "494-544",
          "snippet": "static int\nnm_init(struct neo_softc *sc)\n{\n\tu_int32_t ofs, i;\n\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM_MIXER_READY_MASK;\n\n\t\tsc->buftop = 2560 * 1024;\n\n\t\tsc->irsz = 2;\n\t\tsc->playint = NM_PLAYBACK_INT;\n\t\tsc->recint = NM_RECORD_INT;\n\t\tsc->misc1int = NM_MISC_INT_1;\n\t\tsc->misc2int = NM_MISC_INT_2;\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM2_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM2_MIXER_READY_MASK;\n\n\t\tsc->buftop = (nm_rd(sc, 0xa0b, 2)? 6144 : 4096) * 1024;\n\n\t\tsc->irsz = 4;\n\t\tsc->playint = NM2_PLAYBACK_INT;\n\t\tsc->recint = NM2_RECORD_INT;\n\t\tsc->misc1int = NM2_MISC_INT_1;\n\t\tsc->misc2int = NM2_MISC_INT_2;\n\t} else return -1;\n\tsc->badintr = 0;\n\tofs = sc->buftop - 0x0400;\n\tsc->buftop -= 0x1400;\n\n \tif ((nm_rdbuf(sc, ofs, 4) & NM_SIG_MASK) == NM_SIGNATURE) {\n\t\ti = nm_rdbuf(sc, ofs + 4, 4);\n\t\tif (i != 0 && i != 0xffffffff)\n\t\t\tsc->buftop = i;\n\t}\n\n\tsc->cbuf = sc->buftop - NM_MAX_COEFFICIENT;\n\tsc->rbuf = sc->cbuf - NM_BUFFSIZE;\n\tsc->pbuf = sc->rbuf - NM_BUFFSIZE;\n\tsc->acbuf = sc->pbuf - (NM_TOTAL_COEFF_COUNT * 4);\n\n\tnm_wr(sc, 0, 0x11, 1);\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\tnm_wr(sc, 0x214, 0, 2);\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define NM256ZX_PCI_ID  0x800610c8",
            "#define NM256AV_PCI_ID  0x800510c8",
            "#define\tNM_BUFFSIZE\t16384"
          ],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define NM256ZX_PCI_ID  0x800610c8\n#define NM256AV_PCI_ID  0x800510c8\n#define\tNM_BUFFSIZE\t16384\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\n\nstatic int\nnm_init(struct neo_softc *sc)\n{\n\tu_int32_t ofs, i;\n\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM_MIXER_READY_MASK;\n\n\t\tsc->buftop = 2560 * 1024;\n\n\t\tsc->irsz = 2;\n\t\tsc->playint = NM_PLAYBACK_INT;\n\t\tsc->recint = NM_RECORD_INT;\n\t\tsc->misc1int = NM_MISC_INT_1;\n\t\tsc->misc2int = NM_MISC_INT_2;\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM2_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM2_MIXER_READY_MASK;\n\n\t\tsc->buftop = (nm_rd(sc, 0xa0b, 2)? 6144 : 4096) * 1024;\n\n\t\tsc->irsz = 4;\n\t\tsc->playint = NM2_PLAYBACK_INT;\n\t\tsc->recint = NM2_RECORD_INT;\n\t\tsc->misc1int = NM2_MISC_INT_1;\n\t\tsc->misc2int = NM2_MISC_INT_2;\n\t} else return -1;\n\tsc->badintr = 0;\n\tofs = sc->buftop - 0x0400;\n\tsc->buftop -= 0x1400;\n\n \tif ((nm_rdbuf(sc, ofs, 4) & NM_SIG_MASK) == NM_SIGNATURE) {\n\t\ti = nm_rdbuf(sc, ofs + 4, 4);\n\t\tif (i != 0 && i != 0xffffffff)\n\t\t\tsc->buftop = i;\n\t}\n\n\tsc->cbuf = sc->buftop - NM_MAX_COEFFICIENT;\n\tsc->rbuf = sc->cbuf - NM_BUFFSIZE;\n\tsc->pbuf = sc->rbuf - NM_BUFFSIZE;\n\tsc->acbuf = sc->pbuf - (NM_TOTAL_COEFF_COUNT * 4);\n\n\tnm_wr(sc, 0, 0x11, 1);\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\tnm_wr(sc, 0x214, 0, 2);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\": %s\\n\"",
            "intrstr"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pci_intr_establish",
          "args": [
            "pc",
            "ih",
            "IPL_AUDIO",
            "neo_intr",
            "sc",
            "sc->dev.dv_xname"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_string",
          "args": [
            "pc",
            "ih"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_map",
          "args": [
            "pc",
            "pa->pa_intrtag",
            "pa->pa_intrpin",
            "pa->pa_intrline",
            "&ih"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_mapreg_map",
          "args": [
            "pa",
            "PCI_MAPS + 4",
            "PCI_MAPREG_TYPE_MEM",
            "0",
            "&sc->regiot",
            "&sc->regioh",
            "NULL",
            "NULL"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "pci_mapreg_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/pci_map.c",
          "lines": "230-275",
          "snippet": "int\npci_mapreg_map(pa, reg, type, busflags, tagp, handlep, basep, sizep)\n\tstruct pci_attach_args *pa;\n\tint reg, busflags;\n\tpcireg_t type;\n\tbus_space_tag_t *tagp;\n\tbus_space_handle_t *handlep;\n\tbus_addr_t *basep;\n\tbus_size_t *sizep;\n{\n\tbus_space_tag_t tag;\n\tbus_space_handle_t handle;\n\tbus_addr_t base;\n\tbus_size_t size;\n\tint flags;\n\n\tif (PCI_MAPREG_TYPE(type) == PCI_MAPREG_TYPE_IO) {\n\t\tif ((pa->pa_flags & PCI_FLAGS_IO_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_io_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t     &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_iot;\n\t} else {\n\t\tif ((pa->pa_flags & PCI_FLAGS_MEM_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_mem_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t      &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_memt;\n\t}\n\n\tif (bus_space_map(tag, base, size, busflags | flags, &handle))\n\t\treturn (1);\n\n\tif (tagp != 0)\n\t\t*tagp = tag;\n\tif (handlep != 0)\n\t\t*handlep = handle;\n\tif (basep != 0)\n\t\t*basep = base;\n\tif (sizep != 0)\n\t\t*sizep = size;\n\n\treturn (0);\n}",
          "includes": [
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nbsd_pci_io_find",
            "static int nbsd_pci_mem_find"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int nbsd_pci_io_find;\nstatic int nbsd_pci_mem_find;\n\nint\npci_mapreg_map(pa, reg, type, busflags, tagp, handlep, basep, sizep)\n\tstruct pci_attach_args *pa;\n\tint reg, busflags;\n\tpcireg_t type;\n\tbus_space_tag_t *tagp;\n\tbus_space_handle_t *handlep;\n\tbus_addr_t *basep;\n\tbus_size_t *sizep;\n{\n\tbus_space_tag_t tag;\n\tbus_space_handle_t handle;\n\tbus_addr_t base;\n\tbus_size_t size;\n\tint flags;\n\n\tif (PCI_MAPREG_TYPE(type) == PCI_MAPREG_TYPE_IO) {\n\t\tif ((pa->pa_flags & PCI_FLAGS_IO_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_io_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t     &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_iot;\n\t} else {\n\t\tif ((pa->pa_flags & PCI_FLAGS_MEM_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_mem_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t      &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_memt;\n\t}\n\n\tif (bus_space_map(tag, base, size, busflags | flags, &handle))\n\t\treturn (1);\n\n\tif (tagp != 0)\n\t\t*tagp = tag;\n\tif (handlep != 0)\n\t\t*handlep = handle;\n\tif (basep != 0)\n\t\t*basep = base;\n\tif (sizep != 0)\n\t\t*sizep = size;\n\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nvoid\tneo_attach;\nint\tneo_intr;\nint     neo_attach_codec;\nint\tneo_read_codec;\nint\tneo_write_codec;\nvoid    neo_reset_codec;\nstruct audio_hw_if neo_hw_if = {\n\tneo_open,\n\tneo_close,\n\tNULL,\n\tneo_query_encoding,\n\tneo_set_params,\n#if 1\n\tneo_round_blocksize,\n#else\n\tNULL,\n#endif\n\tNULL,\n\tNULL,\n\tNULL,\n\tNULL,\n\tNULL,\n\tneo_halt_output,\n\tneo_halt_input,\n\tNULL,\n\tneo_getdev,\n\tNULL,\n\tneo_mixer_set_port,\n\tneo_mixer_get_port,\n\tneo_query_devinfo,\n\tneo_malloc,\n\tneo_free,\n\tneo_round_buffersize,\n\t0, /* neo_mappage, */\n\tneo_get_props,\n\tneo_trigger_output,\n\tneo_trigger_input,\n};\n\nvoid\nneo_attach(parent, self, aux)\n\tstruct device *parent;\n\tstruct device *self;\n\tvoid *aux;\n{\n\tstruct neo_softc *sc = (struct neo_softc *)self;\n\tstruct pci_attach_args *pa = (struct pci_attach_args *)aux;\n\tpci_chipset_tag_t pc = pa->pa_pc;\n\tchar const *intrstr;\n\tpci_intr_handle_t ih;\n\tpcireg_t csr;\n\tint error;\n\n\tsc->type = pa->pa_id;\n\n\t/* Map I/O register */\n\tif (pci_mapreg_map(pa, PCI_MAPS, PCI_MAPREG_TYPE_MEM, 0,\n\t\t\t   &sc->bufiot, &sc->bufioh, NULL, NULL)) {\n\t\tprintf(\"\\n%s: can't map i/o space\\n\", sc->dev.dv_xname);\n\t\treturn;\n\t}\n\n\n\tif (pci_mapreg_map(pa, PCI_MAPS + 4, PCI_MAPREG_TYPE_MEM, 0,\n\t\t\t   &sc->regiot, &sc->regioh, NULL, NULL)) {\n\t\tprintf(\"\\n%s: can't map i/o space\\n\", sc->dev.dv_xname);\n\t\treturn;\n\t}\n\n\t/* Map and establish the interrupt. */\n\tif (pci_intr_map(pc, pa->pa_intrtag, pa->pa_intrpin,\n\t\t\t pa->pa_intrline, &ih)) {\n\t\tprintf(\"\\n%s: couldn't map interrupt\\n\", sc->dev.dv_xname);\n\t\treturn;\n\t}\n\tintrstr = pci_intr_string(pc, ih);\n\tsc->ih = pci_intr_establish(pc, ih, IPL_AUDIO, neo_intr, sc, \n\t\t\t\t       sc->dev.dv_xname);\n\n\tif (sc->ih == NULL) {\n\t\tprintf(\"\\n%s: couldn't establish interrupt\",\n\t\t       sc->dev.dv_xname);\n\t\tif (intrstr != NULL)\n\t\t\tprintf(\" at %s\", intrstr);\n\t\tprintf(\"\\n\");\n\t\treturn;\n\t}\n\tprintf(\": %s\\n\", intrstr);\n\n\tif ((error = nm_init(sc)) != 0)\n\t\treturn;\n\n\t/* Enable the device. */\n\tcsr = pci_conf_read(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG);\n\tpci_conf_write(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG,\n\t\t       csr | PCI_COMMAND_MASTER_ENABLE);\n\n\tsc->host_if.arg = sc;\n\n\tsc->host_if.attach = neo_attach_codec;\n\tsc->host_if.read   = neo_read_codec;\n\tsc->host_if.write  = neo_write_codec;\n\tsc->host_if.reset  = neo_reset_codec;\n\t\t\n\tif ((error = ac97_attach(&sc->host_if)) != 0)\n\t\treturn;\n\n\taudio_attach_mi(&neo_hw_if, sc, &sc->dev);\n\n\treturn;\n}"
  },
  {
    "function_name": "nm_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "494-544",
    "snippet": "static int\nnm_init(struct neo_softc *sc)\n{\n\tu_int32_t ofs, i;\n\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM_MIXER_READY_MASK;\n\n\t\tsc->buftop = 2560 * 1024;\n\n\t\tsc->irsz = 2;\n\t\tsc->playint = NM_PLAYBACK_INT;\n\t\tsc->recint = NM_RECORD_INT;\n\t\tsc->misc1int = NM_MISC_INT_1;\n\t\tsc->misc2int = NM_MISC_INT_2;\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM2_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM2_MIXER_READY_MASK;\n\n\t\tsc->buftop = (nm_rd(sc, 0xa0b, 2)? 6144 : 4096) * 1024;\n\n\t\tsc->irsz = 4;\n\t\tsc->playint = NM2_PLAYBACK_INT;\n\t\tsc->recint = NM2_RECORD_INT;\n\t\tsc->misc1int = NM2_MISC_INT_1;\n\t\tsc->misc2int = NM2_MISC_INT_2;\n\t} else return -1;\n\tsc->badintr = 0;\n\tofs = sc->buftop - 0x0400;\n\tsc->buftop -= 0x1400;\n\n \tif ((nm_rdbuf(sc, ofs, 4) & NM_SIG_MASK) == NM_SIGNATURE) {\n\t\ti = nm_rdbuf(sc, ofs + 4, 4);\n\t\tif (i != 0 && i != 0xffffffff)\n\t\t\tsc->buftop = i;\n\t}\n\n\tsc->cbuf = sc->buftop - NM_MAX_COEFFICIENT;\n\tsc->rbuf = sc->cbuf - NM_BUFFSIZE;\n\tsc->pbuf = sc->rbuf - NM_BUFFSIZE;\n\tsc->acbuf = sc->pbuf - (NM_TOTAL_COEFF_COUNT * 4);\n\n\tnm_wr(sc, 0, 0x11, 1);\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\tnm_wr(sc, 0x214, 0, 2);\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define NM256ZX_PCI_ID  0x800610c8",
      "#define NM256AV_PCI_ID  0x800510c8",
      "#define\tNM_BUFFSIZE\t16384"
    ],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "0x214",
            "0",
            "2"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nm_rdbuf",
          "args": [
            "sc",
            "ofs + 4",
            "4"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "nm_rdbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "324-340",
          "snippet": "static u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define NM256ZX_PCI_ID  0x800610c8\n#define NM256AV_PCI_ID  0x800510c8\n#define\tNM_BUFFSIZE\t16384\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\n\nstatic int\nnm_init(struct neo_softc *sc)\n{\n\tu_int32_t ofs, i;\n\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM_MIXER_READY_MASK;\n\n\t\tsc->buftop = 2560 * 1024;\n\n\t\tsc->irsz = 2;\n\t\tsc->playint = NM_PLAYBACK_INT;\n\t\tsc->recint = NM_RECORD_INT;\n\t\tsc->misc1int = NM_MISC_INT_1;\n\t\tsc->misc2int = NM_MISC_INT_2;\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tsc->ac97_base = NM_MIXER_OFFSET;\n\t\tsc->ac97_status = NM2_MIXER_STATUS_OFFSET;\n\t\tsc->ac97_busy = NM2_MIXER_READY_MASK;\n\n\t\tsc->buftop = (nm_rd(sc, 0xa0b, 2)? 6144 : 4096) * 1024;\n\n\t\tsc->irsz = 4;\n\t\tsc->playint = NM2_PLAYBACK_INT;\n\t\tsc->recint = NM2_RECORD_INT;\n\t\tsc->misc1int = NM2_MISC_INT_1;\n\t\tsc->misc2int = NM2_MISC_INT_2;\n\t} else return -1;\n\tsc->badintr = 0;\n\tofs = sc->buftop - 0x0400;\n\tsc->buftop -= 0x1400;\n\n \tif ((nm_rdbuf(sc, ofs, 4) & NM_SIG_MASK) == NM_SIGNATURE) {\n\t\ti = nm_rdbuf(sc, ofs + 4, 4);\n\t\tif (i != 0 && i != 0xffffffff)\n\t\t\tsc->buftop = i;\n\t}\n\n\tsc->cbuf = sc->buftop - NM_MAX_COEFFICIENT;\n\tsc->rbuf = sc->cbuf - NM_BUFFSIZE;\n\tsc->pbuf = sc->rbuf - NM_BUFFSIZE;\n\tsc->acbuf = sc->pbuf - (NM_TOTAL_COEFF_COUNT * 4);\n\n\tnm_wr(sc, 0, 0x11, 1);\n\tnm_wr(sc, NM_RECORD_ENABLE_REG, 0, 1);\n\tnm_wr(sc, 0x214, 0, 2);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "neo_intr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "425-486",
    "snippet": "int\nneo_intr(void *p)\n{\n\tstruct neo_softc *sc = (struct neo_softc *)p;\n\tint status, x, active;\n\tint rv = 0;\n\n\tactive = (sc->pintr || sc->rintr);\n\tstatus = nm_rd(sc, NM_INT_REG, sc->irsz);\n\n\tif (status & sc->playint) {\n\t\tstatus &= ~sc->playint;\n\n\t\tsc->pwmark += sc->pblksize;\n\t\tsc->pwmark %= sc->pbufsize;\n\n\t\tnm_wr(sc, NM_PBUFFER_WMARK, sc->pbuf + sc->pwmark, 4);\n\n\t\tnm_ackint(sc, sc->playint);\n\n\t\tif (sc->pintr)\n\t\t\t(*sc->pintr)(sc->parg);\n\n\t\trv = 1;\n\t}\n\tif (status & sc->recint) {\n\t\tstatus &= ~sc->recint;\n\n\t\tsc->rwmark += sc->rblksize;\n\t\tsc->rwmark %= sc->rbufsize;\n\n\t\tnm_ackint(sc, sc->recint);\n\t\tif (sc->rintr)\n\t\t\t(*sc->rintr)(sc->rarg);\n\n\t\trv = 1;\n\t}\n\tif (status & sc->misc1int) {\n\t\tstatus &= ~sc->misc1int;\n\t\tnm_ackint(sc, sc->misc1int);\n\t\tx = nm_rd(sc, 0x400, 1);\n\t\tnm_wr(sc, 0x400, x | 2, 1);\n\t\tprintf(\"%s: misc int 1\\n\", sc->dev.dv_xname);\n\t\trv = 1;\n\t}\n\tif (status & sc->misc2int) {\n\t\tstatus &= ~sc->misc2int;\n\t\tnm_ackint(sc, sc->misc2int);\n\t\tx = nm_rd(sc, 0x400, 1);\n\t\tnm_wr(sc, 0x400, x & ~2, 1);\n\t\tprintf(\"%s: misc int 2\\n\", sc->dev.dv_xname);\n\t\trv = 1;\n\t}\n\tif (status) {\n\t\tstatus &= ~sc->misc2int;\n\t\tnm_ackint(sc, sc->misc2int);\n\t\tprintf(\"%s: unknown int\\n\", sc->dev.dv_xname);\n\t\trv = 1;\n\t}\n\n\treturn (rv);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "int\tneo_intr"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: unknown int\\n\"",
            "sc->dev.dv_xname"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nm_ackint",
          "args": [
            "sc",
            "sc->misc2int"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "nm_ackint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "380-388",
          "snippet": "static void\nnm_ackint(struct neo_softc *sc, u_int32_t num)\n{\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num << 1, 2);\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num, 4);\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define NM256ZX_PCI_ID  0x800610c8",
            "#define NM256AV_PCI_ID  0x800510c8"
          ],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define NM256ZX_PCI_ID  0x800610c8\n#define NM256AV_PCI_ID  0x800510c8\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\n\nstatic void\nnm_ackint(struct neo_softc *sc, u_int32_t num)\n{\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num << 1, 2);\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num, 4);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "0x400",
            "x & ~2",
            "1"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nm_rd",
          "args": [
            "sc",
            "0x400",
            "1"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "nm_rdbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "324-340",
          "snippet": "static u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->rarg"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->parg"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nint\tneo_intr;\n\nint\nneo_intr(void *p)\n{\n\tstruct neo_softc *sc = (struct neo_softc *)p;\n\tint status, x, active;\n\tint rv = 0;\n\n\tactive = (sc->pintr || sc->rintr);\n\tstatus = nm_rd(sc, NM_INT_REG, sc->irsz);\n\n\tif (status & sc->playint) {\n\t\tstatus &= ~sc->playint;\n\n\t\tsc->pwmark += sc->pblksize;\n\t\tsc->pwmark %= sc->pbufsize;\n\n\t\tnm_wr(sc, NM_PBUFFER_WMARK, sc->pbuf + sc->pwmark, 4);\n\n\t\tnm_ackint(sc, sc->playint);\n\n\t\tif (sc->pintr)\n\t\t\t(*sc->pintr)(sc->parg);\n\n\t\trv = 1;\n\t}\n\tif (status & sc->recint) {\n\t\tstatus &= ~sc->recint;\n\n\t\tsc->rwmark += sc->rblksize;\n\t\tsc->rwmark %= sc->rbufsize;\n\n\t\tnm_ackint(sc, sc->recint);\n\t\tif (sc->rintr)\n\t\t\t(*sc->rintr)(sc->rarg);\n\n\t\trv = 1;\n\t}\n\tif (status & sc->misc1int) {\n\t\tstatus &= ~sc->misc1int;\n\t\tnm_ackint(sc, sc->misc1int);\n\t\tx = nm_rd(sc, 0x400, 1);\n\t\tnm_wr(sc, 0x400, x | 2, 1);\n\t\tprintf(\"%s: misc int 1\\n\", sc->dev.dv_xname);\n\t\trv = 1;\n\t}\n\tif (status & sc->misc2int) {\n\t\tstatus &= ~sc->misc2int;\n\t\tnm_ackint(sc, sc->misc2int);\n\t\tx = nm_rd(sc, 0x400, 1);\n\t\tnm_wr(sc, 0x400, x & ~2, 1);\n\t\tprintf(\"%s: misc int 2\\n\", sc->dev.dv_xname);\n\t\trv = 1;\n\t}\n\tif (status) {\n\t\tstatus &= ~sc->misc2int;\n\t\tnm_ackint(sc, sc->misc2int);\n\t\tprintf(\"%s: unknown int\\n\", sc->dev.dv_xname);\n\t\trv = 1;\n\t}\n\n\treturn (rv);\n}"
  },
  {
    "function_name": "nmchan_getptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "412-421",
    "snippet": "int\nnmchan_getptr(sc, mode)\n        struct neo_softc *sc;\n\tint mode;\n{\n\tif (mode == AUMODE_PLAY)\n\t\treturn nm_rd(sc, NM_PBUFFER_CURRP, 4) - sc->pbuf;\n\telse\n\t\treturn nm_rd(sc, NM_RBUFFER_CURRP, 4) - sc->rbuf;\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_rd",
          "args": [
            "sc",
            "NM_RBUFFER_CURRP",
            "4"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "nm_rdbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "324-340",
          "snippet": "static u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\n\nint\nnmchan_getptr(sc, mode)\n        struct neo_softc *sc;\n\tint mode;\n{\n\tif (mode == AUMODE_PLAY)\n\t\treturn nm_rd(sc, NM_PBUFFER_CURRP, 4) - sc->pbuf;\n\telse\n\t\treturn nm_rd(sc, NM_RBUFFER_CURRP, 4) - sc->rbuf;\n}"
  },
  {
    "function_name": "nm_loadcoeff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "390-410",
    "snippet": "static int\nnm_loadcoeff(struct neo_softc *sc, int dir, int num)\n{\n\tint ofs, sz, i;\n\tu_int32_t addr;\n\n\taddr = (dir == AUMODE_PLAY)? 0x01c : 0x21c;\n\tif (dir == AUMODE_RECORD)\n\t\tnum += 8;\n\tsz = coefficientSizes[num];\n\tofs = 0;\n\twhile (num-- > 0)\n\t\tofs+= coefficientSizes[num];\n\tfor (i = 0; i < sz; i++)\n\t\tnm_wrbuf(sc, sc->cbuf + i, coefficients[ofs + i], 1);\n\tnm_wr(sc, addr, sc->cbuf, 4);\n\tif (dir == AUMODE_PLAY)\n\t\tsz--;\n\tnm_wr(sc, addr + 4, sc->cbuf + sz, 4);\n\treturn 0;\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
      "void *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "addr + 4",
            "sc->cbuf + sz",
            "4"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nvoid *\nneo_malloc(addr, size, pool, flags)\n\tvoid *addr;\n\nstatic int\nnm_loadcoeff(struct neo_softc *sc, int dir, int num)\n{\n\tint ofs, sz, i;\n\tu_int32_t addr;\n\n\taddr = (dir == AUMODE_PLAY)? 0x01c : 0x21c;\n\tif (dir == AUMODE_RECORD)\n\t\tnum += 8;\n\tsz = coefficientSizes[num];\n\tofs = 0;\n\twhile (num-- > 0)\n\t\tofs+= coefficientSizes[num];\n\tfor (i = 0; i < sz; i++)\n\t\tnm_wrbuf(sc, sc->cbuf + i, coefficients[ofs + i], 1);\n\tnm_wr(sc, addr, sc->cbuf, 4);\n\tif (dir == AUMODE_PLAY)\n\t\tsz--;\n\tnm_wr(sc, addr + 4, sc->cbuf + sz, 4);\n\treturn 0;\n}"
  },
  {
    "function_name": "nm_ackint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "380-388",
    "snippet": "static void\nnm_ackint(struct neo_softc *sc, u_int32_t num)\n{\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num << 1, 2);\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num, 4);\n\t}\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define NM256ZX_PCI_ID  0x800610c8",
      "#define NM256AV_PCI_ID  0x800510c8"
    ],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nm_wr",
          "args": [
            "sc",
            "NM_INT_REG",
            "num",
            "4"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "nm_wrbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "342-359",
          "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define NM256ZX_PCI_ID  0x800610c8\n#define NM256AV_PCI_ID  0x800510c8\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int \t nm_loadcoeff(struct neo_softc *sc, int dir, int num);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\n\nstatic void\nnm_ackint(struct neo_softc *sc, u_int32_t num)\n{\n\tif (sc->type == NM256AV_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num << 1, 2);\n\t} else if (sc->type == NM256ZX_PCI_ID) {\n\t\tnm_wr(sc, NM_INT_REG, num, 4);\n\t}\n}"
  },
  {
    "function_name": "nm_waitcd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "362-377",
    "snippet": "static int\nnm_waitcd(struct neo_softc *sc)\n{\n\tint cnt = 10;\n\tint fail = 1;\n\n\twhile (cnt-- > 0) {\n\t\tif (nm_rd(sc, sc->ac97_status, 2) & sc->ac97_busy)\n\t\t\tDELAY(100);\n\t\telse {\n\t\t        fail = 0;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (fail);\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "100"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nm_rd",
          "args": [
            "sc",
            "sc->ac97_status",
            "2"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "nm_rdbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
          "lines": "324-340",
          "snippet": "static u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}",
          "includes": [
            "#include <dev/pci/neo-coeff.h>",
            "#include <dev/pci/neoreg.h>",
            "#include <dev/ic/ac97.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int \t nm_waitcd(struct neo_softc *sc);",
            "static int       nm_init(struct neo_softc *);",
            "int    nmchan_getptr(struct neo_softc *, int);",
            "static u_int32_t nm_rd(struct neo_softc *, int, int);",
            "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
            "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
            "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
            "u_long size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\n\nstatic int\nnm_waitcd(struct neo_softc *sc)\n{\n\tint cnt = 10;\n\tint fail = 1;\n\n\twhile (cnt-- > 0) {\n\t\tif (nm_rd(sc, sc->ac97_status, 2) & sc->ac97_busy)\n\t\t\tDELAY(100);\n\t\telse {\n\t\t        fail = 0;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (fail);\n}"
  },
  {
    "function_name": "nm_wrbuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "342-359",
    "snippet": "static void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
      "u_long size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "st",
            "sh",
            "regno",
            "data"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "st",
            "sh",
            "regno",
            "data"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "st",
            "sh",
            "regno",
            "data"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wrbuf(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "nm_rdbuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "324-340",
    "snippet": "static u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
      "u_long size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_4",
          "args": [
            "st",
            "sh",
            "regno"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "st",
            "sh",
            "regno"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "st",
            "sh",
            "regno"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic u_int32_t\nnm_rdbuf(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->bufiot;\n\tbus_space_handle_t sh = sc->bufioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}"
  },
  {
    "function_name": "nm_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "305-322",
    "snippet": "static void\nnm_wr(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->regiot;\n\tbus_space_handle_t sh = sc->regioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
      "u_long size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "st",
            "sh",
            "regno",
            "data"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "st",
            "sh",
            "regno",
            "data"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "st",
            "sh",
            "regno",
            "data"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic void\nnm_wr(struct neo_softc *sc, int regno, u_int32_t data, int size)\n{\n\tbus_space_tag_t st = sc->regiot;\n\tbus_space_handle_t sh = sc->regioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\tbus_space_write_1(st, sh, regno, data);\n\t\tbreak;\n\tcase 2:\n\t\tbus_space_write_2(st, sh, regno, data);\n\t\tbreak;\n\tcase 4:\n\t\tbus_space_write_4(st, sh, regno, data);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "nm_rd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/neo.c",
    "lines": "287-303",
    "snippet": "static u_int32_t\nnm_rd(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->regiot;\n\tbus_space_handle_t sh = sc->regioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}",
    "includes": [
      "#include <dev/pci/neo-coeff.h>",
      "#include <dev/pci/neoreg.h>",
      "#include <dev/ic/ac97.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int \t nm_waitcd(struct neo_softc *sc);",
      "static int       nm_init(struct neo_softc *);",
      "int    nmchan_getptr(struct neo_softc *, int);",
      "static u_int32_t nm_rd(struct neo_softc *, int, int);",
      "static void \t nm_wr(struct neo_softc *, int, u_int32_t, int);",
      "static u_int32_t nm_rdbuf(struct neo_softc *, int, int);",
      "static void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);",
      "u_long size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_4",
          "args": [
            "st",
            "sh",
            "regno"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "st",
            "sh",
            "regno"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "st",
            "sh",
            "regno"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/neo-coeff.h>\n#include <dev/pci/neoreg.h>\n#include <dev/ic/ac97.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int \t nm_waitcd(struct neo_softc *sc);\nstatic int       nm_init(struct neo_softc *);\nint    nmchan_getptr(struct neo_softc *, int);\nstatic u_int32_t nm_rd(struct neo_softc *, int, int);\nstatic void \t nm_wr(struct neo_softc *, int, u_int32_t, int);\nstatic u_int32_t nm_rdbuf(struct neo_softc *, int, int);\nstatic void \t nm_wrbuf(struct neo_softc *, int, u_int32_t, int);\nu_long size;\n\nstatic u_int32_t\nnm_rd(struct neo_softc *sc, int regno, int size)\n{\n\tbus_space_tag_t st = sc->regiot;\n\tbus_space_handle_t sh = sc->regioh;\n\n\tswitch (size) {\n\tcase 1:\n\t\treturn bus_space_read_1(st, sh, regno);\n\tcase 2:\n\t\treturn bus_space_read_2(st, sh, regno);\n\tcase 4:\n\t\treturn bus_space_read_4(st, sh, regno);\n\tdefault:\n\t\treturn 0xffffffff;\n\t}\n}"
  }
]