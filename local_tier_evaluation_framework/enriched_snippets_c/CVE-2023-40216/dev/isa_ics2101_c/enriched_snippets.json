[
  {
    "function_name": "ics2101_mix_attenuate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ics2101.c",
    "lines": "150-156",
    "snippet": "void\nics2101_mix_attenuate(sc, chan, side, value)\n\tstruct ics2101_softc *sc;\n\tunsigned int chan, side, value;\n{\n    ics2101_mix_doit(sc, chan, side, value, ICS_VALUE);\n}",
    "includes": [
      "#include <dev/isa/ics2101var.h>",
      "#include <dev/ic/ics2101reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define ICS_VALUE\t0x01"
    ],
    "globals_used": [
      "static void ics2101_mix_doit"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ics2101_mix_doit",
          "args": [
            "sc",
            "chan",
            "side",
            "value",
            "ICS_VALUE"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "ics2101_mix_doit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ics2101.c",
          "lines": "78-139",
          "snippet": "static void\nics2101_mix_doit(sc, chan, side, value, flags)\n\tstruct ics2101_softc *sc;\n\tu_int chan, side, value, flags;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tunsigned char flip_left[6] = {0x01, 0x01, 0x01, 0x02, 0x01, 0x02};\n\tunsigned char flip_right[6] = {0x02, 0x02, 0x02, 0x01, 0x02, 0x01};\n\tregister unsigned char ctrl_addr;\n\tregister unsigned char attn_addr;\n\tregister unsigned char normal;\n\tint s;\n\n\tif (chan < ICSMIX_CHAN_0 || chan > ICSMIX_CHAN_5)\n\t\treturn;\n\tif (side != ICSMIX_LEFT && side != ICSMIX_RIGHT)\n\t\treturn;\n\n\tif (flags & ICS_MUTE) {\n\t\tvalue = cvt_value(sc->sc_setting[chan][side]);\n\t\tsc->sc_mute[chan][side] = flags & ICS_MUTE_MUTED;\n\t} else if (flags & ICS_VALUE) {\n\t\tsc->sc_setting[chan][side] = value;\n\t\tvalue = cvt_value(value);\n\t\tif (value > ICSMIX_MIN_ATTN)\n\t\t\tvalue = ICSMIX_MIN_ATTN;\n\t} else\n\t\treturn;\n\n\tctrl_addr = chan << 3;\n\tattn_addr = chan << 3;\n\n\tif (side == ICSMIX_LEFT) {\n\t\tctrl_addr |= ICSMIX_CTRL_LEFT;\n\t\tattn_addr |= ICSMIX_ATTN_LEFT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_left[chan];\n\t\telse\n\t\t\tnormal = 0x01;\n\t} else {\n\t\tctrl_addr |= ICSMIX_CTRL_RIGHT;\n\t\tattn_addr |= ICSMIX_ATTN_RIGHT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_right[chan];\n\t\telse\n\t\t\tnormal = 0x02;\n\t}\n\n\ts = splaudio();\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, ctrl_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, normal);\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, attn_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, (unsigned char) value);\n\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/isa/ics2101var.h>",
            "#include <dev/ic/ics2101reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define ICS_MUTE_MUTED\t0x04",
            "#define ICS_MUTE\t0x02",
            "#define ICS_VALUE\t0x01"
          ],
          "globals_used": [
            "static void ics2101_mix_doit"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ics2101var.h>\n#include <dev/ic/ics2101reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define ICS_MUTE_MUTED\t0x04\n#define ICS_MUTE\t0x02\n#define ICS_VALUE\t0x01\n\nstatic void ics2101_mix_doit;\n\nstatic void\nics2101_mix_doit(sc, chan, side, value, flags)\n\tstruct ics2101_softc *sc;\n\tu_int chan, side, value, flags;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tunsigned char flip_left[6] = {0x01, 0x01, 0x01, 0x02, 0x01, 0x02};\n\tunsigned char flip_right[6] = {0x02, 0x02, 0x02, 0x01, 0x02, 0x01};\n\tregister unsigned char ctrl_addr;\n\tregister unsigned char attn_addr;\n\tregister unsigned char normal;\n\tint s;\n\n\tif (chan < ICSMIX_CHAN_0 || chan > ICSMIX_CHAN_5)\n\t\treturn;\n\tif (side != ICSMIX_LEFT && side != ICSMIX_RIGHT)\n\t\treturn;\n\n\tif (flags & ICS_MUTE) {\n\t\tvalue = cvt_value(sc->sc_setting[chan][side]);\n\t\tsc->sc_mute[chan][side] = flags & ICS_MUTE_MUTED;\n\t} else if (flags & ICS_VALUE) {\n\t\tsc->sc_setting[chan][side] = value;\n\t\tvalue = cvt_value(value);\n\t\tif (value > ICSMIX_MIN_ATTN)\n\t\t\tvalue = ICSMIX_MIN_ATTN;\n\t} else\n\t\treturn;\n\n\tctrl_addr = chan << 3;\n\tattn_addr = chan << 3;\n\n\tif (side == ICSMIX_LEFT) {\n\t\tctrl_addr |= ICSMIX_CTRL_LEFT;\n\t\tattn_addr |= ICSMIX_ATTN_LEFT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_left[chan];\n\t\telse\n\t\t\tnormal = 0x01;\n\t} else {\n\t\tctrl_addr |= ICSMIX_CTRL_RIGHT;\n\t\tattn_addr |= ICSMIX_ATTN_RIGHT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_right[chan];\n\t\telse\n\t\t\tnormal = 0x02;\n\t}\n\n\ts = splaudio();\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, ctrl_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, normal);\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, attn_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, (unsigned char) value);\n\n\tsplx(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/ics2101var.h>\n#include <dev/ic/ics2101reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define ICS_VALUE\t0x01\n\nstatic void ics2101_mix_doit;\n\nvoid\nics2101_mix_attenuate(sc, chan, side, value)\n\tstruct ics2101_softc *sc;\n\tunsigned int chan, side, value;\n{\n    ics2101_mix_doit(sc, chan, side, value, ICS_VALUE);\n}"
  },
  {
    "function_name": "ics2101_mix_mute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ics2101.c",
    "lines": "141-148",
    "snippet": "void\nics2101_mix_mute(sc, chan, side, domute)\n\tstruct ics2101_softc *sc;\n\tunsigned int chan, side, domute;\n{\n    ics2101_mix_doit(sc, chan, side, 0,\n\t\t     domute ? ICS_MUTE|ICS_MUTE_MUTED : ICS_MUTE);\n}",
    "includes": [
      "#include <dev/isa/ics2101var.h>",
      "#include <dev/ic/ics2101reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define ICS_MUTE_MUTED\t0x04",
      "#define ICS_MUTE\t0x02"
    ],
    "globals_used": [
      "static void ics2101_mix_doit"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ics2101_mix_doit",
          "args": [
            "sc",
            "chan",
            "side",
            "0",
            "domute ? ICS_MUTE|ICS_MUTE_MUTED : ICS_MUTE"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "ics2101_mix_doit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ics2101.c",
          "lines": "78-139",
          "snippet": "static void\nics2101_mix_doit(sc, chan, side, value, flags)\n\tstruct ics2101_softc *sc;\n\tu_int chan, side, value, flags;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tunsigned char flip_left[6] = {0x01, 0x01, 0x01, 0x02, 0x01, 0x02};\n\tunsigned char flip_right[6] = {0x02, 0x02, 0x02, 0x01, 0x02, 0x01};\n\tregister unsigned char ctrl_addr;\n\tregister unsigned char attn_addr;\n\tregister unsigned char normal;\n\tint s;\n\n\tif (chan < ICSMIX_CHAN_0 || chan > ICSMIX_CHAN_5)\n\t\treturn;\n\tif (side != ICSMIX_LEFT && side != ICSMIX_RIGHT)\n\t\treturn;\n\n\tif (flags & ICS_MUTE) {\n\t\tvalue = cvt_value(sc->sc_setting[chan][side]);\n\t\tsc->sc_mute[chan][side] = flags & ICS_MUTE_MUTED;\n\t} else if (flags & ICS_VALUE) {\n\t\tsc->sc_setting[chan][side] = value;\n\t\tvalue = cvt_value(value);\n\t\tif (value > ICSMIX_MIN_ATTN)\n\t\t\tvalue = ICSMIX_MIN_ATTN;\n\t} else\n\t\treturn;\n\n\tctrl_addr = chan << 3;\n\tattn_addr = chan << 3;\n\n\tif (side == ICSMIX_LEFT) {\n\t\tctrl_addr |= ICSMIX_CTRL_LEFT;\n\t\tattn_addr |= ICSMIX_ATTN_LEFT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_left[chan];\n\t\telse\n\t\t\tnormal = 0x01;\n\t} else {\n\t\tctrl_addr |= ICSMIX_CTRL_RIGHT;\n\t\tattn_addr |= ICSMIX_ATTN_RIGHT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_right[chan];\n\t\telse\n\t\t\tnormal = 0x02;\n\t}\n\n\ts = splaudio();\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, ctrl_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, normal);\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, attn_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, (unsigned char) value);\n\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/isa/ics2101var.h>",
            "#include <dev/ic/ics2101reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define ICS_MUTE_MUTED\t0x04",
            "#define ICS_MUTE\t0x02",
            "#define ICS_VALUE\t0x01"
          ],
          "globals_used": [
            "static void ics2101_mix_doit"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ics2101var.h>\n#include <dev/ic/ics2101reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define ICS_MUTE_MUTED\t0x04\n#define ICS_MUTE\t0x02\n#define ICS_VALUE\t0x01\n\nstatic void ics2101_mix_doit;\n\nstatic void\nics2101_mix_doit(sc, chan, side, value, flags)\n\tstruct ics2101_softc *sc;\n\tu_int chan, side, value, flags;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tunsigned char flip_left[6] = {0x01, 0x01, 0x01, 0x02, 0x01, 0x02};\n\tunsigned char flip_right[6] = {0x02, 0x02, 0x02, 0x01, 0x02, 0x01};\n\tregister unsigned char ctrl_addr;\n\tregister unsigned char attn_addr;\n\tregister unsigned char normal;\n\tint s;\n\n\tif (chan < ICSMIX_CHAN_0 || chan > ICSMIX_CHAN_5)\n\t\treturn;\n\tif (side != ICSMIX_LEFT && side != ICSMIX_RIGHT)\n\t\treturn;\n\n\tif (flags & ICS_MUTE) {\n\t\tvalue = cvt_value(sc->sc_setting[chan][side]);\n\t\tsc->sc_mute[chan][side] = flags & ICS_MUTE_MUTED;\n\t} else if (flags & ICS_VALUE) {\n\t\tsc->sc_setting[chan][side] = value;\n\t\tvalue = cvt_value(value);\n\t\tif (value > ICSMIX_MIN_ATTN)\n\t\t\tvalue = ICSMIX_MIN_ATTN;\n\t} else\n\t\treturn;\n\n\tctrl_addr = chan << 3;\n\tattn_addr = chan << 3;\n\n\tif (side == ICSMIX_LEFT) {\n\t\tctrl_addr |= ICSMIX_CTRL_LEFT;\n\t\tattn_addr |= ICSMIX_ATTN_LEFT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_left[chan];\n\t\telse\n\t\t\tnormal = 0x01;\n\t} else {\n\t\tctrl_addr |= ICSMIX_CTRL_RIGHT;\n\t\tattn_addr |= ICSMIX_ATTN_RIGHT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_right[chan];\n\t\telse\n\t\t\tnormal = 0x02;\n\t}\n\n\ts = splaudio();\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, ctrl_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, normal);\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, attn_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, (unsigned char) value);\n\n\tsplx(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/ics2101var.h>\n#include <dev/ic/ics2101reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define ICS_MUTE_MUTED\t0x04\n#define ICS_MUTE\t0x02\n\nstatic void ics2101_mix_doit;\n\nvoid\nics2101_mix_mute(sc, chan, side, domute)\n\tstruct ics2101_softc *sc;\n\tunsigned int chan, side, domute;\n{\n    ics2101_mix_doit(sc, chan, side, 0,\n\t\t     domute ? ICS_MUTE|ICS_MUTE_MUTED : ICS_MUTE);\n}"
  },
  {
    "function_name": "ics2101_mix_doit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ics2101.c",
    "lines": "78-139",
    "snippet": "static void\nics2101_mix_doit(sc, chan, side, value, flags)\n\tstruct ics2101_softc *sc;\n\tu_int chan, side, value, flags;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tunsigned char flip_left[6] = {0x01, 0x01, 0x01, 0x02, 0x01, 0x02};\n\tunsigned char flip_right[6] = {0x02, 0x02, 0x02, 0x01, 0x02, 0x01};\n\tregister unsigned char ctrl_addr;\n\tregister unsigned char attn_addr;\n\tregister unsigned char normal;\n\tint s;\n\n\tif (chan < ICSMIX_CHAN_0 || chan > ICSMIX_CHAN_5)\n\t\treturn;\n\tif (side != ICSMIX_LEFT && side != ICSMIX_RIGHT)\n\t\treturn;\n\n\tif (flags & ICS_MUTE) {\n\t\tvalue = cvt_value(sc->sc_setting[chan][side]);\n\t\tsc->sc_mute[chan][side] = flags & ICS_MUTE_MUTED;\n\t} else if (flags & ICS_VALUE) {\n\t\tsc->sc_setting[chan][side] = value;\n\t\tvalue = cvt_value(value);\n\t\tif (value > ICSMIX_MIN_ATTN)\n\t\t\tvalue = ICSMIX_MIN_ATTN;\n\t} else\n\t\treturn;\n\n\tctrl_addr = chan << 3;\n\tattn_addr = chan << 3;\n\n\tif (side == ICSMIX_LEFT) {\n\t\tctrl_addr |= ICSMIX_CTRL_LEFT;\n\t\tattn_addr |= ICSMIX_ATTN_LEFT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_left[chan];\n\t\telse\n\t\t\tnormal = 0x01;\n\t} else {\n\t\tctrl_addr |= ICSMIX_CTRL_RIGHT;\n\t\tattn_addr |= ICSMIX_ATTN_RIGHT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_right[chan];\n\t\telse\n\t\t\tnormal = 0x02;\n\t}\n\n\ts = splaudio();\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, ctrl_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, normal);\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, attn_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, (unsigned char) value);\n\n\tsplx(s);\n}",
    "includes": [
      "#include <dev/isa/ics2101var.h>",
      "#include <dev/ic/ics2101reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define ICS_MUTE_MUTED\t0x04",
      "#define ICS_MUTE\t0x02",
      "#define ICS_VALUE\t0x01"
    ],
    "globals_used": [
      "static void ics2101_mix_doit"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "sc->sc_dataio_ioh",
            "sc->sc_dataio",
            "(unsigned char) value"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "sc->sc_selio_ioh",
            "sc->sc_selio",
            "attn_addr"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "sc->sc_dataio_ioh",
            "sc->sc_dataio",
            "normal"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "sc->sc_selio_ioh",
            "sc->sc_selio",
            "ctrl_addr"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cvt_value",
          "args": [
            "value"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cvt_value",
          "args": [
            "sc->sc_setting[chan][side]"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ics2101var.h>\n#include <dev/ic/ics2101reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define ICS_MUTE_MUTED\t0x04\n#define ICS_MUTE\t0x02\n#define ICS_VALUE\t0x01\n\nstatic void ics2101_mix_doit;\n\nstatic void\nics2101_mix_doit(sc, chan, side, value, flags)\n\tstruct ics2101_softc *sc;\n\tu_int chan, side, value, flags;\n{\n\tbus_space_tag_t iot = sc->sc_iot;\n\tunsigned char flip_left[6] = {0x01, 0x01, 0x01, 0x02, 0x01, 0x02};\n\tunsigned char flip_right[6] = {0x02, 0x02, 0x02, 0x01, 0x02, 0x01};\n\tregister unsigned char ctrl_addr;\n\tregister unsigned char attn_addr;\n\tregister unsigned char normal;\n\tint s;\n\n\tif (chan < ICSMIX_CHAN_0 || chan > ICSMIX_CHAN_5)\n\t\treturn;\n\tif (side != ICSMIX_LEFT && side != ICSMIX_RIGHT)\n\t\treturn;\n\n\tif (flags & ICS_MUTE) {\n\t\tvalue = cvt_value(sc->sc_setting[chan][side]);\n\t\tsc->sc_mute[chan][side] = flags & ICS_MUTE_MUTED;\n\t} else if (flags & ICS_VALUE) {\n\t\tsc->sc_setting[chan][side] = value;\n\t\tvalue = cvt_value(value);\n\t\tif (value > ICSMIX_MIN_ATTN)\n\t\t\tvalue = ICSMIX_MIN_ATTN;\n\t} else\n\t\treturn;\n\n\tctrl_addr = chan << 3;\n\tattn_addr = chan << 3;\n\n\tif (side == ICSMIX_LEFT) {\n\t\tctrl_addr |= ICSMIX_CTRL_LEFT;\n\t\tattn_addr |= ICSMIX_ATTN_LEFT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_left[chan];\n\t\telse\n\t\t\tnormal = 0x01;\n\t} else {\n\t\tctrl_addr |= ICSMIX_CTRL_RIGHT;\n\t\tattn_addr |= ICSMIX_ATTN_RIGHT;\n\t\tif (sc->sc_mute[chan][side])\n\t\t\tnormal = 0x0;\n\t\telse if (sc->sc_flags & ICS_FLIP)\n\t\t\tnormal = flip_right[chan];\n\t\telse\n\t\t\tnormal = 0x02;\n\t}\n\n\ts = splaudio();\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, ctrl_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, normal);\n\n\tbus_space_write_1(iot, sc->sc_selio_ioh, sc->sc_selio, attn_addr);\n\tbus_space_write_1(iot, sc->sc_dataio_ioh, sc->sc_dataio, (unsigned char) value);\n\n\tsplx(s);\n}"
  }
]