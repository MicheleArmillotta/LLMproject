[
  {
    "function_name": "vgafb_invert_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "555-576",
    "snippet": "static void\nvgafb_invert_char ( vc, cx, cy)\n\tstruct vgafb_config *vc;\n\tint cx, cy;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       invertPixel(vc, x, y);\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_HEIGHT 16",
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "static void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "invertPixel",
          "args": [
            "vc",
            "x",
            "y"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "invertPixel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
          "lines": "506-518",
          "snippet": "static void \ninvertPixel(vc, x, y)\n\tstruct vgafb_config *vc;\n\tint x, y;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\tu_int8_t v;\n\n\tv = bus_space_read_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)));\n\tv = ~v & 0xf;\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}",
          "includes": [
            "#include <dev/ic/vgafbvar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define FONT_WIDTH 8"
          ],
          "globals_used": [
            "static void setPixel( struct vgafb_config *vc, int x, int y, int v);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_WIDTH 8\n\nstatic void setPixel( struct vgafb_config *vc, int x, int y, int v);\n\nstatic void \ninvertPixel(vc, x, y)\n\tstruct vgafb_config *vc;\n\tint x, y;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\tu_int8_t v;\n\n\tv = bus_space_read_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)));\n\tv = ~v & 0xf;\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nstatic void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);\n\nstatic void\nvgafb_invert_char ( vc, cx, cy)\n\tstruct vgafb_config *vc;\n\tint cx, cy;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       invertPixel(vc, x, y);\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}"
  },
  {
    "function_name": "drawChar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "520-554",
    "snippet": "static void\ndrawChar ( vc, ch, cx, cy, at)\n\tstruct vgafb_config *vc;\n\tchar ch;\n\tint cx, cy;\n\tchar at;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   i = ch * FONT_HEIGHT;\n   cp = &fontdata_8x16[ i ];\n\n   if ((cx == vc->vc_ccol) && (cy == vc->vc_crow)) {\n\tchar tmp = at;\n\tat =  ((at  & 0xf) << 4) | ((at >> 4) & 0xf);\n   }\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       mask = 0x80 >> j;\n       if ( *cp & mask )\n\t setPixel(vc, x, y, (at >> 4) & 0xf );\n       else\n\t setPixel(vc, x, y,  at & 0xf );\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_HEIGHT 16",
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "static void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);",
      "static void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);",
      "extern const char fontdata_8x16[];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "setPixel",
          "args": [
            "vc",
            "x",
            "y",
            "at & 0xf"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "setPixel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
          "lines": "496-505",
          "snippet": "static void\nsetPixel(vc, x, y, v)\n\tstruct vgafb_config *vc;\n\tint x, y, v;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}",
          "includes": [
            "#include <dev/ic/vgafbvar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define FONT_WIDTH 8"
          ],
          "globals_used": [
            "static void setPixel( struct vgafb_config *vc, int x, int y, int v);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_WIDTH 8\n\nstatic void setPixel( struct vgafb_config *vc, int x, int y, int v);\n\nstatic void\nsetPixel(vc, x, y, v)\n\tstruct vgafb_config *vc;\n\tint x, y, v;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nstatic void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);\nstatic void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);\nextern const char fontdata_8x16[];\n\nstatic void\ndrawChar ( vc, ch, cx, cy, at)\n\tstruct vgafb_config *vc;\n\tchar ch;\n\tint cx, cy;\n\tchar at;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   i = ch * FONT_HEIGHT;\n   cp = &fontdata_8x16[ i ];\n\n   if ((cx == vc->vc_ccol) && (cy == vc->vc_crow)) {\n\tchar tmp = at;\n\tat =  ((at  & 0xf) << 4) | ((at >> 4) & 0xf);\n   }\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       mask = 0x80 >> j;\n       if ( *cp & mask )\n\t setPixel(vc, x, y, (at >> 4) & 0xf );\n       else\n\t setPixel(vc, x, y,  at & 0xf );\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}"
  },
  {
    "function_name": "invertPixel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "506-518",
    "snippet": "static void \ninvertPixel(vc, x, y)\n\tstruct vgafb_config *vc;\n\tint x, y;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\tu_int8_t v;\n\n\tv = bus_space_read_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)));\n\tv = ~v & 0xf;\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "static void setPixel( struct vgafb_config *vc, int x, int y, int v);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "memt",
            "memh",
            "x+(y*(vc->vc_ncol*FONT_WIDTH))",
            "v"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "memt",
            "memh",
            "x+(y*(vc->vc_ncol*FONT_WIDTH))"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_WIDTH 8\n\nstatic void setPixel( struct vgafb_config *vc, int x, int y, int v);\n\nstatic void \ninvertPixel(vc, x, y)\n\tstruct vgafb_config *vc;\n\tint x, y;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\tu_int8_t v;\n\n\tv = bus_space_read_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)));\n\tv = ~v & 0xf;\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}"
  },
  {
    "function_name": "setPixel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "496-505",
    "snippet": "static void\nsetPixel(vc, x, y, v)\n\tstruct vgafb_config *vc;\n\tint x, y, v;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "static void setPixel( struct vgafb_config *vc, int x, int y, int v);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "memt",
            "memh",
            "x+(y*(vc->vc_ncol*FONT_WIDTH))",
            "v"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_WIDTH 8\n\nstatic void setPixel( struct vgafb_config *vc, int x, int y, int v);\n\nstatic void\nsetPixel(vc, x, y, v)\n\tstruct vgafb_config *vc;\n\tint x, y, v;\n{\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\n\tbus_space_write_1(memt, memh, x+(y*(vc->vc_ncol*FONT_WIDTH)), v);\n}"
  },
  {
    "function_name": "vgafb_set_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "486-494",
    "snippet": "void\nvgafb_set_attr(id, val)\n\tvoid *id;\n\tint val;\n{\n\tstruct vgafb_config *vc = id;\n\n\tvc->vc_so = val;\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tvgafb_set_attr"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tvgafb_set_attr;\n\nvoid\nvgafb_set_attr(id, val)\n\tvoid *id;\n\tint val;\n{\n\tstruct vgafb_config *vc = id;\n\n\tvc->vc_so = val;\n}"
  },
  {
    "function_name": "vgafb_eraserows",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "469-484",
    "snippet": "void\nvgafb_eraserows(id, startrow, nrows)\n\tvoid *id;\n\tint startrow, nrows;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t off, count;\n\tu_int16_t val;\n\n\toff = (startrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0;\n\tcount = (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH);\n\n\tval = (vc->vc_at & 0xf);\n\n\tbus_space_set_region_1(vc->vc_memt, vc->vc_memh, off, val, count);\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_HEIGHT 16",
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "void\tvgafb_eraserows"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_set_region_1",
          "args": [
            "vc->vc_memt",
            "vc->vc_memh",
            "off",
            "val",
            "count"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nvoid\tvgafb_eraserows;\n\nvoid\nvgafb_eraserows(id, startrow, nrows)\n\tvoid *id;\n\tint startrow, nrows;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t off, count;\n\tu_int16_t val;\n\n\toff = (startrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0;\n\tcount = (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH);\n\n\tval = (vc->vc_at & 0xf);\n\n\tbus_space_set_region_1(vc->vc_memt, vc->vc_memh, off, val, count);\n}"
  },
  {
    "function_name": "vgafb_copyrows",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "444-467",
    "snippet": "void\nvgafb_copyrows(id, srcrow, dstrow, nrows)\n\tvoid *id;\n\tint srcrow, dstrow, nrows;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t srcoff, dstoff;\n\n\tsrcoff = ((srcrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0);\n\tdstoff = ((dstrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0);\n\n#if 0\n\tbus_space_copy_1(vc->vc_memt, vc->vc_memh, srcoff, vc->vc_memh, dstoff,\n\t    (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH));\n#else\n\t/* since pci memory space base address is a power of two, and\n\t * the screen is a mulitple of 4 (since FONT_WIDTH is 8)\n\t * aka The Screen base is always 4 byte aligned RIGHT?\n\t * copying words will be faster than bytes.\n\t */\n\tbus_space_copy_4(vc->vc_memt, vc->vc_memh, srcoff, vc->vc_memh, dstoff,\n\t    (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)/4);\n#endif\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_HEIGHT 16",
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "void\tvgafb_copyrows"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_copy_4",
          "args": [
            "vc->vc_memt",
            "vc->vc_memh",
            "srcoff",
            "vc->vc_memh",
            "dstoff",
            "(nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)/4"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_copy_1",
          "args": [
            "vc->vc_memt",
            "vc->vc_memh",
            "srcoff",
            "vc->vc_memh",
            "dstoff",
            "(nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nvoid\tvgafb_copyrows;\n\nvoid\nvgafb_copyrows(id, srcrow, dstrow, nrows)\n\tvoid *id;\n\tint srcrow, dstrow, nrows;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t srcoff, dstoff;\n\n\tsrcoff = ((srcrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0);\n\tdstoff = ((dstrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0);\n\n#if 0\n\tbus_space_copy_1(vc->vc_memt, vc->vc_memh, srcoff, vc->vc_memh, dstoff,\n\t    (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH));\n#else\n\t/* since pci memory space base address is a power of two, and\n\t * the screen is a mulitple of 4 (since FONT_WIDTH is 8)\n\t * aka The Screen base is always 4 byte aligned RIGHT?\n\t * copying words will be faster than bytes.\n\t */\n\tbus_space_copy_4(vc->vc_memt, vc->vc_memh, srcoff, vc->vc_memh, dstoff,\n\t    (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)/4);\n#endif\n}"
  },
  {
    "function_name": "vgafb_erasecols",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "430-442",
    "snippet": "void\nvgafb_erasecols(id, row, startcol, ncols)\n\tvoid *id;\n\tint row, startcol, ncols;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t off;\n\tint i;\n\n\tfor (i=0; i < ncols; i++) {\n\t\tdrawChar( vc, ' ', startcol+i, row, vc->vc_at);\n\t}\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tvgafb_erasecols"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "drawChar",
          "args": [
            "vc",
            "' '",
            "startcol+i",
            "row",
            "vc->vc_at"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "drawChar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
          "lines": "520-554",
          "snippet": "static void\ndrawChar ( vc, ch, cx, cy, at)\n\tstruct vgafb_config *vc;\n\tchar ch;\n\tint cx, cy;\n\tchar at;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   i = ch * FONT_HEIGHT;\n   cp = &fontdata_8x16[ i ];\n\n   if ((cx == vc->vc_ccol) && (cy == vc->vc_crow)) {\n\tchar tmp = at;\n\tat =  ((at  & 0xf) << 4) | ((at >> 4) & 0xf);\n   }\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       mask = 0x80 >> j;\n       if ( *cp & mask )\n\t setPixel(vc, x, y, (at >> 4) & 0xf );\n       else\n\t setPixel(vc, x, y,  at & 0xf );\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}",
          "includes": [
            "#include <dev/ic/vgafbvar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define FONT_HEIGHT 16",
            "#define FONT_WIDTH 8"
          ],
          "globals_used": [
            "static void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);",
            "static void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);",
            "extern const char fontdata_8x16[];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nstatic void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);\nstatic void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);\nextern const char fontdata_8x16[];\n\nstatic void\ndrawChar ( vc, ch, cx, cy, at)\n\tstruct vgafb_config *vc;\n\tchar ch;\n\tint cx, cy;\n\tchar at;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   i = ch * FONT_HEIGHT;\n   cp = &fontdata_8x16[ i ];\n\n   if ((cx == vc->vc_ccol) && (cy == vc->vc_crow)) {\n\tchar tmp = at;\n\tat =  ((at  & 0xf) << 4) | ((at >> 4) & 0xf);\n   }\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       mask = 0x80 >> j;\n       if ( *cp & mask )\n\t setPixel(vc, x, y, (at >> 4) & 0xf );\n       else\n\t setPixel(vc, x, y,  at & 0xf );\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tvgafb_erasecols;\n\nvoid\nvgafb_erasecols(id, row, startcol, ncols)\n\tvoid *id;\n\tint row, startcol, ncols;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t off;\n\tint i;\n\n\tfor (i=0; i < ncols; i++) {\n\t\tdrawChar( vc, ' ', startcol+i, row, vc->vc_at);\n\t}\n}"
  },
  {
    "function_name": "vgafb_copycols",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "407-428",
    "snippet": "void\nvgafb_copycols(id, row, srccol, dstcol, ncols)\n\tvoid *id;\n\tint row, srccol, dstcol, ncols;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t srcoff, dstoff;\n\tint i;\n\n\tfor (i = 0; i < FONT_HEIGHT; i++) {\n\t\tsrcoff = ((row*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)\n\t\t\t+ srccol*FONT_WIDTH) + (i * (vc->vc_ncol*FONT_WIDTH));\n\t\tdstoff = ((row*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)\n\t\t\t+ dstcol*FONT_WIDTH) + (i * (vc->vc_ncol*FONT_WIDTH));\n\n/* this could be sped up using bus_space_copy_4, but the copies tend\n * to be slow and it didn't work correctly on ppc???\n */\n\t\tbus_space_copy_1(vc->vc_memt, vc->vc_memh, srcoff,\n\t\t\tvc->vc_memh, dstoff, ncols*FONT_WIDTH);\n\t}\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_HEIGHT 16",
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "void\tvgafb_copycols"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_copy_1",
          "args": [
            "vc->vc_memt",
            "vc->vc_memh",
            "srcoff",
            "vc->vc_memh",
            "dstoff",
            "ncols*FONT_WIDTH"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nvoid\tvgafb_copycols;\n\nvoid\nvgafb_copycols(id, row, srccol, dstcol, ncols)\n\tvoid *id;\n\tint row, srccol, dstcol, ncols;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t srcoff, dstoff;\n\tint i;\n\n\tfor (i = 0; i < FONT_HEIGHT; i++) {\n\t\tsrcoff = ((row*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)\n\t\t\t+ srccol*FONT_WIDTH) + (i * (vc->vc_ncol*FONT_WIDTH));\n\t\tdstoff = ((row*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH)\n\t\t\t+ dstcol*FONT_WIDTH) + (i * (vc->vc_ncol*FONT_WIDTH));\n\n/* this could be sped up using bus_space_copy_4, but the copies tend\n * to be slow and it didn't work correctly on ppc???\n */\n\t\tbus_space_copy_1(vc->vc_memt, vc->vc_memh, srcoff,\n\t\t\tvc->vc_memh, dstoff, ncols*FONT_WIDTH);\n\t}\n}"
  },
  {
    "function_name": "vgafb_putstr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "390-405",
    "snippet": "void\nvgafb_putstr(id, row, col, cp, len)\n\tvoid *id;\n\tint row, col;\n\tchar *cp;\n\tint len;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\tint i, off;\n\n\tfor (i = 0; i < len; i++, cp++, col++) {\n\t\tdrawChar(vc, *cp, col, row, vc->vc_so ? vc->vc_so_at : vc->vc_at);\n\t}\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tvgafb_putstr"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "drawChar",
          "args": [
            "vc",
            "*cp",
            "col",
            "row",
            "vc->vc_so ? vc->vc_so_at : vc->vc_at"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "drawChar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
          "lines": "520-554",
          "snippet": "static void\ndrawChar ( vc, ch, cx, cy, at)\n\tstruct vgafb_config *vc;\n\tchar ch;\n\tint cx, cy;\n\tchar at;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   i = ch * FONT_HEIGHT;\n   cp = &fontdata_8x16[ i ];\n\n   if ((cx == vc->vc_ccol) && (cy == vc->vc_crow)) {\n\tchar tmp = at;\n\tat =  ((at  & 0xf) << 4) | ((at >> 4) & 0xf);\n   }\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       mask = 0x80 >> j;\n       if ( *cp & mask )\n\t setPixel(vc, x, y, (at >> 4) & 0xf );\n       else\n\t setPixel(vc, x, y,  at & 0xf );\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}",
          "includes": [
            "#include <dev/ic/vgafbvar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define FONT_HEIGHT 16",
            "#define FONT_WIDTH 8"
          ],
          "globals_used": [
            "static void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);",
            "static void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);",
            "extern const char fontdata_8x16[];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nstatic void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);\nstatic void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);\nextern const char fontdata_8x16[];\n\nstatic void\ndrawChar ( vc, ch, cx, cy, at)\n\tstruct vgafb_config *vc;\n\tchar ch;\n\tint cx, cy;\n\tchar at;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   i = ch * FONT_HEIGHT;\n   cp = &fontdata_8x16[ i ];\n\n   if ((cx == vc->vc_ccol) && (cy == vc->vc_crow)) {\n\tchar tmp = at;\n\tat =  ((at  & 0xf) << 4) | ((at >> 4) & 0xf);\n   }\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       mask = 0x80 >> j;\n       if ( *cp & mask )\n\t setPixel(vc, x, y, (at >> 4) & 0xf );\n       else\n\t setPixel(vc, x, y,  at & 0xf );\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tvgafb_putstr;\n\nvoid\nvgafb_putstr(id, row, col, cp, len)\n\tvoid *id;\n\tint row, col;\n\tchar *cp;\n\tint len;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_space_tag_t memt = vc->vc_memt;\n\tbus_space_handle_t memh = vc->vc_memh;\n\tint i, off;\n\n\tfor (i = 0; i < len; i++, cp++, col++) {\n\t\tdrawChar(vc, *cp, col, row, vc->vc_so ? vc->vc_so_at : vc->vc_at);\n\t}\n}"
  },
  {
    "function_name": "vgafb_cursor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "353-388",
    "snippet": "void\nvgafb_cursor(id, on, row, col)\n\tvoid *id;\n\tint on, row, col;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_space_tag_t iot = vc->vc_iot;\n\tbus_space_handle_t ioh_d = vc->vc_ioh_d;\n\tint pos;\n\n#if 0\n\tprintf(\"vgafb_cursor: %d %d\\n\", row, col);\n#endif\n\tif (( vc->vc_crow != -1) && (vc->vc_ccol != -1)) {\n\t\tvgafb_invert_char (vc, vc->vc_ccol, vc->vc_crow);\n\t}\n\t/* turn the cursor off */\n\tif (!on) {\n\t\t/* XXX disable cursor how??? */\n\t\tvc->vc_crow = vc->vc_ccol = -1;\n\t} else {\n\t\tvc->vc_crow = row;\n\n\t\tvc->vc_ccol = col;\n\t\tvgafb_invert_char (vc, col, row);\n\t}\n\n#if 0\n\tpos = row * vc->vc_ncol + col;\n\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_ADDR, 14);\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_DATA, pos >> 8);\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_ADDR, 15);\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_DATA, pos);\n#endif\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tvgafb_cursor"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "ioh_d",
            "VGA_IO_D_6845_DATA",
            "pos"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "ioh_d",
            "VGA_IO_D_6845_ADDR",
            "15"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "ioh_d",
            "VGA_IO_D_6845_DATA",
            "pos >> 8"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "ioh_d",
            "VGA_IO_D_6845_ADDR",
            "14"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vgafb_invert_char",
          "args": [
            "vc",
            "col",
            "row"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "vgafb_invert_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
          "lines": "555-576",
          "snippet": "static void\nvgafb_invert_char ( vc, cx, cy)\n\tstruct vgafb_config *vc;\n\tint cx, cy;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       invertPixel(vc, x, y);\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}",
          "includes": [
            "#include <dev/ic/vgafbvar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define FONT_HEIGHT 16",
            "#define FONT_WIDTH 8"
          ],
          "globals_used": [
            "static void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nstatic void vgafb_invert_char ( struct vgafb_config *vc, int cx, int cy);\n\nstatic void\nvgafb_invert_char ( vc, cx, cy)\n\tstruct vgafb_config *vc;\n\tint cx, cy;\n{\n   const char *cp;\n   unsigned char mask;\n   int i, j;\n   int x, y;\n\n   x = cx*FONT_WIDTH; y = cy*FONT_HEIGHT;\n\n   for ( i = 0; i < FONT_HEIGHT; i++ )\n   {\n     for ( j = 0; j < FONT_WIDTH; j++)\n     {\n       invertPixel(vc, x, y);\n       x++;\n     }\n     cp++; y++; x = cx*FONT_WIDTH;\n   }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"vgafb_cursor: %d %d\\n\"",
            "row",
            "col"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tvgafb_cursor;\n\nvoid\nvgafb_cursor(id, on, row, col)\n\tvoid *id;\n\tint on, row, col;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_space_tag_t iot = vc->vc_iot;\n\tbus_space_handle_t ioh_d = vc->vc_ioh_d;\n\tint pos;\n\n#if 0\n\tprintf(\"vgafb_cursor: %d %d\\n\", row, col);\n#endif\n\tif (( vc->vc_crow != -1) && (vc->vc_ccol != -1)) {\n\t\tvgafb_invert_char (vc, vc->vc_ccol, vc->vc_crow);\n\t}\n\t/* turn the cursor off */\n\tif (!on) {\n\t\t/* XXX disable cursor how??? */\n\t\tvc->vc_crow = vc->vc_ccol = -1;\n\t} else {\n\t\tvc->vc_crow = row;\n\n\t\tvc->vc_ccol = col;\n\t\tvgafb_invert_char (vc, col, row);\n\t}\n\n#if 0\n\tpos = row * vc->vc_ncol + col;\n\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_ADDR, 14);\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_DATA, pos >> 8);\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_ADDR, 15);\n\tbus_space_write_1(iot, ioh_d, VGA_IO_D_6845_DATA, pos);\n#endif\n}"
  },
  {
    "function_name": "vgafbmmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "304-347",
    "snippet": "int\nvgafbmmap(v, offset, prot)\n\tvoid *v;\n\toff_t offset;\n\tint prot;\n{\n\tstruct vgafb_config *vc = v;\n\tbus_space_handle_t h;\n\tu_int32_t *port;\n\n\t/* memsize... */\n\tif (offset >= 0x00000 && offset < 0x800000)\t/* 8MB of mem??? */\n\t\th = vc->vc_memh + offset;\n\telse if (offset >= 0x10000000 && offset < 0x10040000 )\n\t\t/* 256KB of iohb */\n\t\th = vc->vc_ioh_b;\n\telse if (offset >= 0x10040000 && offset < 0x10080000)\n\t\t/* 256KB of iohc */\n\t\th = vc->vc_ioh_c;\n\telse if (offset >= 0x18880000 && offset < 0x100c0000)\n\t\t/* 256KB of iohd */\n\t\th = vc->vc_ioh_d;\n\telse if (offset >= 0x20000000 && offset < 0x30000000)\n\t\t/* mmiosize... */\n\t\th = vc->vc_mmioh + (offset - 0x20000000);\n\telse\n\t\treturn (-1);\n\n#ifdef alpha\n\tport = (u_int32_t *)(h << 5);\n\treturn alpha_btop(port);\t\t/* XXX */\n#elif defined(i386)\n\tport = (u_int32_t *)(h << 5);\n\treturn i386_btop(port);\n#elif defined(__powerpc__)\n\t{\n\t/* huh ??? */\n\treturn h;\n\t/*\n\treturn powerpc_btop(port);\n\t*/\n\t}\n#endif\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void setPixel( struct vgafb_config *vc, int x, int y, int v);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "i386_btop",
          "args": [
            "port"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alpha_btop",
          "args": [
            "port"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void setPixel( struct vgafb_config *vc, int x, int y, int v);\n\nint\nvgafbmmap(v, offset, prot)\n\tvoid *v;\n\toff_t offset;\n\tint prot;\n{\n\tstruct vgafb_config *vc = v;\n\tbus_space_handle_t h;\n\tu_int32_t *port;\n\n\t/* memsize... */\n\tif (offset >= 0x00000 && offset < 0x800000)\t/* 8MB of mem??? */\n\t\th = vc->vc_memh + offset;\n\telse if (offset >= 0x10000000 && offset < 0x10040000 )\n\t\t/* 256KB of iohb */\n\t\th = vc->vc_ioh_b;\n\telse if (offset >= 0x10040000 && offset < 0x10080000)\n\t\t/* 256KB of iohc */\n\t\th = vc->vc_ioh_c;\n\telse if (offset >= 0x18880000 && offset < 0x100c0000)\n\t\t/* 256KB of iohd */\n\t\th = vc->vc_ioh_d;\n\telse if (offset >= 0x20000000 && offset < 0x30000000)\n\t\t/* mmiosize... */\n\t\th = vc->vc_mmioh + (offset - 0x20000000);\n\telse\n\t\treturn (-1);\n\n#ifdef alpha\n\tport = (u_int32_t *)(h << 5);\n\treturn alpha_btop(port);\t\t/* XXX */\n#elif defined(i386)\n\tport = (u_int32_t *)(h << 5);\n\treturn i386_btop(port);\n#elif defined(__powerpc__)\n\t{\n\t/* huh ??? */\n\treturn h;\n\t/*\n\treturn powerpc_btop(port);\n\t*/\n\t}\n#endif\n}"
  },
  {
    "function_name": "vgafbioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "290-302",
    "snippet": "int\nvgafbioctl(v, cmd, data, flag, p)\n\tvoid *v;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\t/*struct vgafb_config *vc = v;*/\n\n\t/* XXX */\n\treturn -1;\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void setPixel( struct vgafb_config *vc, int x, int y, int v);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void setPixel( struct vgafb_config *vc, int x, int y, int v);\n\nint\nvgafbioctl(v, cmd, data, flag, p)\n\tvoid *v;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\t/*struct vgafb_config *vc = v;*/\n\n\t/* XXX */\n\treturn -1;\n}"
  },
  {
    "function_name": "vgafb_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "279-288",
    "snippet": "int\nvgafb_print(aux, pnp)\n\tvoid *aux;\n\tconst char *pnp;\n{\n\n\tif (pnp)\n\t\tprintf(\"wscons at %s\", pnp);\n\treturn (UNCONF);\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);",
      "int\tvgafb_print"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"wscons at %s\"",
            "pnp"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void drawChar ( struct vgafb_config *vc, char ch, int cx,\n\tint cy, char at);\nint\tvgafb_print;\n\nint\nvgafb_print(aux, pnp)\n\tvoid *aux;\n\tconst char *pnp;\n{\n\n\tif (pnp)\n\t\tprintf(\"wscons at %s\", pnp);\n\treturn (UNCONF);\n}"
  },
  {
    "function_name": "vgafb_wscons_console",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "260-277",
    "snippet": "void\nvgafb_wscons_console(vc)\n\tstruct vgafb_config *vc;\n{\n\tstruct wscons_odev_spec wo;\n\n        wo.wo_emulfuncs = &vgafb_emulfuncs;\n\two.wo_emulfuncs_cookie = vc;\n\n\t/* ioctl and mmap are unused until real attachment. */\n\n        wo.wo_nrows = vc->vc_nrow;\n        wo.wo_ncols = vc->vc_ncol;\n        wo.wo_crow = vc->vc_crow;\n        wo.wo_ccol = vc->vc_ccol;\n \n        wscons_attach_console(&wo);\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct wscons_emulfuncs vgafb_emulfuncs = {\n\tvgafb_cursor,\n\tvgafb_putstr,\n\tvgafb_copycols,\n\tvgafb_erasecols,\n\tvgafb_copyrows,\n\tvgafb_eraserows,\n\tvgafb_set_attr,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wscons_attach_console",
          "args": [
            "&wo"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct wscons_emulfuncs vgafb_emulfuncs = {\n\tvgafb_cursor,\n\tvgafb_putstr,\n\tvgafb_copycols,\n\tvgafb_erasecols,\n\tvgafb_copyrows,\n\tvgafb_eraserows,\n\tvgafb_set_attr,\n};\n\nvoid\nvgafb_wscons_console(vc)\n\tstruct vgafb_config *vc;\n{\n\tstruct wscons_odev_spec wo;\n\n        wo.wo_emulfuncs = &vgafb_emulfuncs;\n\two.wo_emulfuncs_cookie = vc;\n\n\t/* ioctl and mmap are unused until real attachment. */\n\n        wo.wo_nrows = vc->vc_nrow;\n        wo.wo_ncols = vc->vc_ncol;\n        wo.wo_crow = vc->vc_crow;\n        wo.wo_ccol = vc->vc_ccol;\n \n        wscons_attach_console(&wo);\n}"
  },
  {
    "function_name": "vgafb_wscons_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "233-258",
    "snippet": "void\nvgafb_wscons_attach(parent, vc, console)\n\tstruct device *parent;\n\tstruct vgafb_config *vc;\n\tint console;\n{\n\tstruct wscons_attach_args waa;\n\tstruct wscons_odev_spec *wo;\n\n        waa.waa_isconsole = console;\n        wo = &waa.waa_odev_spec;\n\n        wo->wo_emulfuncs = &vgafb_emulfuncs;\n\two->wo_emulfuncs_cookie = vc;\n\n        wo->wo_ioctl = vc->vc_ioctl;\n        wo->wo_mmap = vc->vc_mmap;\n        wo->wo_miscfuncs_cookie = vc;\n\n        wo->wo_nrows = vc->vc_nrow;\n        wo->wo_ncols = vc->vc_ncol;\n        wo->wo_crow = vc->vc_crow;\n        wo->wo_ccol = vc->vc_ccol;\n \n        config_found(parent, &waa, vgafb_print);\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct wscons_emulfuncs vgafb_emulfuncs = {\n\tvgafb_cursor,\n\tvgafb_putstr,\n\tvgafb_copycols,\n\tvgafb_erasecols,\n\tvgafb_copyrows,\n\tvgafb_eraserows,\n\tvgafb_set_attr,\n};",
      "int\tvgafb_print"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_found",
          "args": [
            "parent",
            "&waa",
            "vgafb_print"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct wscons_emulfuncs vgafb_emulfuncs = {\n\tvgafb_cursor,\n\tvgafb_putstr,\n\tvgafb_copycols,\n\tvgafb_erasecols,\n\tvgafb_copyrows,\n\tvgafb_eraserows,\n\tvgafb_set_attr,\n};\nint\tvgafb_print;\n\nvoid\nvgafb_wscons_attach(parent, vc, console)\n\tstruct device *parent;\n\tstruct vgafb_config *vc;\n\tint console;\n{\n\tstruct wscons_attach_args waa;\n\tstruct wscons_odev_spec *wo;\n\n        waa.waa_isconsole = console;\n        wo = &waa.waa_odev_spec;\n\n        wo->wo_emulfuncs = &vgafb_emulfuncs;\n\two->wo_emulfuncs_cookie = vc;\n\n        wo->wo_ioctl = vc->vc_ioctl;\n        wo->wo_mmap = vc->vc_mmap;\n        wo->wo_miscfuncs_cookie = vc;\n\n        wo->wo_nrows = vc->vc_nrow;\n        wo->wo_ncols = vc->vc_ncol;\n        wo->wo_crow = vc->vc_crow;\n        wo->wo_ccol = vc->vc_ccol;\n \n        config_found(parent, &waa, vgafb_print);\n}"
  },
  {
    "function_name": "vgafb_common_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "144-231",
    "snippet": "void\nvgafb_common_setup(iot, memt, vc, iobase, iosize, membase, memsize, mmiobase, mmiosize)\n\tbus_space_tag_t iot, memt;\n\tstruct vgafb_config *vc;\n\tu_int32_t iobase, membase, mmiobase;\n\tsize_t iosize, memsize, mmiosize;\n{\n\tint cpos;\n\tint width, height;\n\n        vc->vc_iot = iot;\n        vc->vc_memt = memt;\n\n\tif (iosize != 0) {\n           if (bus_space_map(vc->vc_iot, iobase+0x3b0, 0xc, 0, &vc->vc_ioh_b))\n\t\tpanic(\"vgafb_common_setup: couldn't map io b\");\n           if (bus_space_map(vc->vc_iot, iobase+0x3c0, 0x10, 0, &vc->vc_ioh_c))\n\t\tpanic(\"vgafb_common_setup: couldn't map io c\");\n           if (bus_space_map(vc->vc_iot, iobase+0x3d0, 0x10, 0, &vc->vc_ioh_d))\n\t\tpanic(\"vgafb_common_setup: couldn't map io d\");\n\t}\n\tif (mmiosize != 0) {\n           if (bus_space_map(vc->vc_memt, mmiobase, mmiosize, 0, &vc->vc_mmioh))\n\t\tpanic(\"vgafb_common_setup: couldn't map mmio\");\n\t}\n        if (bus_space_map(vc->vc_memt, membase, memsize, 0, &vc->vc_memh))\n\t\tpanic(\"vgafb_common_setup: couldn't map memory\"); \n\n\tif (iosize != 0) {\n\t\t/* CR1 - Horiz. Display End */\n\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x1);\n\t\twidth = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\t\t/* (stored value + 1) * depth -> pixel width */\n\t\twidth = ( width + 1 ) * 8;   \n\n\t\t/* CR1 - Horiz. Display End */\n\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x12);\n\t\t{ \n\t\t\tu_int8_t t1, t2, t3;\n\t\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x12);\n\t\t\tt1 = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\n\t\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x7);\n\t\t\tt2 = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\t\t\theight = t1 + ((t2&0x40) << 3) \n\t\t\t\t    + ((t2&0x02) << 7) + 1; \n\t\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x17);\n\t\t\tt3 = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\t\t\tif (t3 & 0x04) {\n\t\t\t\theight *= 2;\n\t\t\t}\n\t\t\tif (t1 == 0xff && t2 == 0xff && t3 == 0xff) {\n\t\t\t\t/* iospace not working??? */\n\t\t\t\t/* hope, better guess than 2048x2048 */\n\t\t\t\twidth = 640;\n\t\t\t\theight = 480;\n\t\t\t}\n\t\t}\n\t\tvc->vc_ncol = width / FONT_WIDTH;\n\t\tvc->vc_nrow = height / FONT_HEIGHT;\n\t} else {\n\t\t/* iosize == 0\n\t\t * default to 640x480 and hope \n\t\t */\n\t\tvc->vc_ncol = 640 / FONT_WIDTH;\n\t\tvc->vc_nrow = 480 / FONT_HEIGHT;\n\t}\n\tprintf(\", %dx%d\", vc->vc_ncol, vc->vc_nrow);\n\n\tvc->vc_crow = vc->vc_ccol = 0; /* Has to be some onscreen value */\n\tvc->vc_so = 0;\n\n\t/* clear screen, frob cursor, etc.? */\n\tvgafb_eraserows(vc, 0, vc->vc_nrow);\n\n#if defined(alpha)\n\t/*\n\t * XXX DEC HAS SWITCHED THE CODES FOR BLUE AND RED!!!\n\t * XXX Therefore, though the comments say \"blue bg\", the code uses\n\t * XXX the value for a red background!\n\t */\n\tvc->vc_at = 0x40 | 0x0f;\t\t/* blue bg|white fg */\n\tvc->vc_so_at = 0x40 | 0x0f | 0x80;\t/* blue bg|white fg|blink */\n#else\n\tvc->vc_at = 0x00 | 0xf;\t\t\t/* black bg|white fg */\n\tvc->vc_so_at = 0x00 | 0xf | 0x80;\t/* black bg|white fg|blink */\n#endif\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define FONT_HEIGHT 16",
      "#define FONT_WIDTH 8"
    ],
    "globals_used": [
      "void\tvgafb_eraserows"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vgafb_eraserows",
          "args": [
            "vc",
            "0",
            "vc->vc_nrow"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "vgafb_eraserows",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
          "lines": "469-484",
          "snippet": "void\nvgafb_eraserows(id, startrow, nrows)\n\tvoid *id;\n\tint startrow, nrows;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t off, count;\n\tu_int16_t val;\n\n\toff = (startrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0;\n\tcount = (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH);\n\n\tval = (vc->vc_at & 0xf);\n\n\tbus_space_set_region_1(vc->vc_memt, vc->vc_memh, off, val, count);\n}",
          "includes": [
            "#include <dev/ic/vgafbvar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define FONT_HEIGHT 16",
            "#define FONT_WIDTH 8"
          ],
          "globals_used": [
            "void\tvgafb_eraserows"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nvoid\tvgafb_eraserows;\n\nvoid\nvgafb_eraserows(id, startrow, nrows)\n\tvoid *id;\n\tint startrow, nrows;\n{\n\tstruct vgafb_config *vc = id;\n\tbus_size_t off, count;\n\tu_int16_t val;\n\n\toff = (startrow*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH) + 0;\n\tcount = (nrows*FONT_HEIGHT) * (vc->vc_ncol*FONT_WIDTH);\n\n\tval = (vc->vc_at & 0xf);\n\n\tbus_space_set_region_1(vc->vc_memt, vc->vc_memh, off, val, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\", %dx%d\"",
            "vc->vc_ncol",
            "vc->vc_nrow"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "5"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "4",
            "0x17"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "5"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "4",
            "0x7"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "5"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "4",
            "0x12"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "4",
            "0x12"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "5"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "vc->vc_ioh_d",
            "4",
            "0x1"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"vgafb_common_setup: couldn't map memory\""
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "vc->vc_memt",
            "membase",
            "memsize",
            "0",
            "&vc->vc_memh"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"vgafb_common_setup: couldn't map mmio\""
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "vc->vc_memt",
            "mmiobase",
            "mmiosize",
            "0",
            "&vc->vc_mmioh"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"vgafb_common_setup: couldn't map io d\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "vc->vc_iot",
            "iobase+0x3d0",
            "0x10",
            "0",
            "&vc->vc_ioh_d"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"vgafb_common_setup: couldn't map io c\""
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "vc->vc_iot",
            "iobase+0x3c0",
            "0x10",
            "0",
            "&vc->vc_ioh_c"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"vgafb_common_setup: couldn't map io b\""
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "vc->vc_iot",
            "iobase+0x3b0",
            "0xc",
            "0",
            "&vc->vc_ioh_b"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define FONT_HEIGHT 16\n#define FONT_WIDTH 8\n\nvoid\tvgafb_eraserows;\n\nvoid\nvgafb_common_setup(iot, memt, vc, iobase, iosize, membase, memsize, mmiobase, mmiosize)\n\tbus_space_tag_t iot, memt;\n\tstruct vgafb_config *vc;\n\tu_int32_t iobase, membase, mmiobase;\n\tsize_t iosize, memsize, mmiosize;\n{\n\tint cpos;\n\tint width, height;\n\n        vc->vc_iot = iot;\n        vc->vc_memt = memt;\n\n\tif (iosize != 0) {\n           if (bus_space_map(vc->vc_iot, iobase+0x3b0, 0xc, 0, &vc->vc_ioh_b))\n\t\tpanic(\"vgafb_common_setup: couldn't map io b\");\n           if (bus_space_map(vc->vc_iot, iobase+0x3c0, 0x10, 0, &vc->vc_ioh_c))\n\t\tpanic(\"vgafb_common_setup: couldn't map io c\");\n           if (bus_space_map(vc->vc_iot, iobase+0x3d0, 0x10, 0, &vc->vc_ioh_d))\n\t\tpanic(\"vgafb_common_setup: couldn't map io d\");\n\t}\n\tif (mmiosize != 0) {\n           if (bus_space_map(vc->vc_memt, mmiobase, mmiosize, 0, &vc->vc_mmioh))\n\t\tpanic(\"vgafb_common_setup: couldn't map mmio\");\n\t}\n        if (bus_space_map(vc->vc_memt, membase, memsize, 0, &vc->vc_memh))\n\t\tpanic(\"vgafb_common_setup: couldn't map memory\"); \n\n\tif (iosize != 0) {\n\t\t/* CR1 - Horiz. Display End */\n\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x1);\n\t\twidth = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\t\t/* (stored value + 1) * depth -> pixel width */\n\t\twidth = ( width + 1 ) * 8;   \n\n\t\t/* CR1 - Horiz. Display End */\n\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x12);\n\t\t{ \n\t\t\tu_int8_t t1, t2, t3;\n\t\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x12);\n\t\t\tt1 = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\n\t\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x7);\n\t\t\tt2 = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\t\t\theight = t1 + ((t2&0x40) << 3) \n\t\t\t\t    + ((t2&0x02) << 7) + 1; \n\t\t\tbus_space_write_1(iot, vc->vc_ioh_d, 4, 0x17);\n\t\t\tt3 = bus_space_read_1(iot, vc->vc_ioh_d, 5);\n\t\t\tif (t3 & 0x04) {\n\t\t\t\theight *= 2;\n\t\t\t}\n\t\t\tif (t1 == 0xff && t2 == 0xff && t3 == 0xff) {\n\t\t\t\t/* iospace not working??? */\n\t\t\t\t/* hope, better guess than 2048x2048 */\n\t\t\t\twidth = 640;\n\t\t\t\theight = 480;\n\t\t\t}\n\t\t}\n\t\tvc->vc_ncol = width / FONT_WIDTH;\n\t\tvc->vc_nrow = height / FONT_HEIGHT;\n\t} else {\n\t\t/* iosize == 0\n\t\t * default to 640x480 and hope \n\t\t */\n\t\tvc->vc_ncol = 640 / FONT_WIDTH;\n\t\tvc->vc_nrow = 480 / FONT_HEIGHT;\n\t}\n\tprintf(\", %dx%d\", vc->vc_ncol, vc->vc_nrow);\n\n\tvc->vc_crow = vc->vc_ccol = 0; /* Has to be some onscreen value */\n\tvc->vc_so = 0;\n\n\t/* clear screen, frob cursor, etc.? */\n\tvgafb_eraserows(vc, 0, vc->vc_nrow);\n\n#if defined(alpha)\n\t/*\n\t * XXX DEC HAS SWITCHED THE CODES FOR BLUE AND RED!!!\n\t * XXX Therefore, though the comments say \"blue bg\", the code uses\n\t * XXX the value for a red background!\n\t */\n\tvc->vc_at = 0x40 | 0x0f;\t\t/* blue bg|white fg */\n\tvc->vc_so_at = 0x40 | 0x0f | 0x80;\t/* blue bg|white fg|blink */\n#else\n\tvc->vc_at = 0x00 | 0xf;\t\t\t/* black bg|white fg */\n\tvc->vc_so_at = 0x00 | 0xf | 0x80;\t/* black bg|white fg|blink */\n#endif\n}"
  },
  {
    "function_name": "vgafb_common_probe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vgafb.c",
    "lines": "78-142",
    "snippet": "int\nvgafb_common_probe(iot, memt, iobase, iosize, membase, memsize, mmiobase, mmiosize)\n\tbus_space_tag_t iot, memt;\n\tu_int32_t iobase, membase, mmiobase;\n\tsize_t iosize, memsize, mmiosize;\n{\n\tbus_space_handle_t ioh_b, ioh_c, ioh_d, memh, mmioh;\n\tu_int16_t vgadata;\n\tint gotio_b, gotio_c, gotio_d, gotmem, gotmmio, rv;\n\tint width;\n\n\tgotio_b = gotio_c = gotio_d = gotmem = gotmmio = rv = 0;\n\n\tif (iosize != 0) {\n\t\tif (bus_space_map(iot, iobase+0x3b0, 0xc, 0, &ioh_b))\n\t\t\tgoto bad;\n\t\tgotio_b = 1;\n\t\tif (bus_space_map(iot, iobase+0x3c0, 0x10, 0, &ioh_c))\n\t\t\tgoto bad;\n\t\tgotio_c = 1;\n\t\tif (bus_space_map(iot, iobase+0x3d0, 0x10, 0, &ioh_d))\n\t\t\tgoto bad;\n\t\tgotio_d = 1;\n\t}\n\tif (mmiosize != 0) {\n\t\tif (bus_space_map(iot, mmiobase, mmiosize, 0, &mmioh))\n\t\t\tgoto bad;\n\t\tgotmmio = 1;\n\t}\n\tif (bus_space_map(memt, membase, memsize, 0, &memh))\n\t\tgoto bad;\n\tgotmem = 1;\n\n#if 0\n\t/* CR1 - Horiz. Display End */\n\tbus_space_write_1(iot, ioh_d, 4, 0x1);\n\twidth = bus_space_read_1(iot, ioh_d, 5);\n\t/* this is not bit width yet */\n\n\t/* use CR17 - mode control for this?? */\n\tif ((width != 0xff) && (width < 600)) {\n\t\t/* not accessable or in graphics mode? */\n\t\tgoto bad;\n\t}\n#endif\n\n\tvgadata = bus_space_read_2(memt, memh, 0);\n\tbus_space_write_2(memt, memh, 0, 0xa55a);\n\trv = (bus_space_read_2(memt, memh, 0) == 0xa55a);\n\tbus_space_write_2(memt, memh, 0, vgadata);\n\nbad:\n\tif (gotio_b)\n\t\tbus_space_unmap(iot, ioh_b, 0xc);\n\tif (gotio_c)\n\t\tbus_space_unmap(iot, ioh_c, 0x10);\n\tif (gotio_d)\n\t\tbus_space_unmap(iot, ioh_d, 0x10);\n\tif (gotmmio)\n\t\tbus_space_unmap(memt, mmioh, mmiosize);\n\tif (gotmem)\n\t\tbus_space_unmap(memt, memh, memsize);\n\n\treturn (rv);\n}",
    "includes": [
      "#include <dev/ic/vgafbvar.h>",
      "#include <dev/wscons/wsconsvar.h>",
      "#include <machine/bus.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_unmap",
          "args": [
            "memt",
            "memh",
            "memsize"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_unmap",
          "args": [
            "memt",
            "mmioh",
            "mmiosize"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_unmap",
          "args": [
            "iot",
            "ioh_d",
            "0x10"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_unmap",
          "args": [
            "iot",
            "ioh_c",
            "0x10"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_unmap",
          "args": [
            "iot",
            "ioh_b",
            "0xc"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "memt",
            "memh",
            "0",
            "vgadata"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "memt",
            "memh",
            "0"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "memt",
            "memh",
            "0",
            "0xa55a"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_2",
          "args": [
            "memt",
            "memh",
            "0"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "iot",
            "ioh_d",
            "5"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "iot",
            "ioh_d",
            "4",
            "0x1"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "memt",
            "membase",
            "memsize",
            "0",
            "&memh"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "iot",
            "mmiobase",
            "mmiosize",
            "0",
            "&mmioh"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "iot",
            "iobase+0x3d0",
            "0x10",
            "0",
            "&ioh_d"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "iot",
            "iobase+0x3c0",
            "0x10",
            "0",
            "&ioh_c"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "iot",
            "iobase+0x3b0",
            "0xc",
            "0",
            "&ioh_b"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/vgafbvar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\nvgafb_common_probe(iot, memt, iobase, iosize, membase, memsize, mmiobase, mmiosize)\n\tbus_space_tag_t iot, memt;\n\tu_int32_t iobase, membase, mmiobase;\n\tsize_t iosize, memsize, mmiosize;\n{\n\tbus_space_handle_t ioh_b, ioh_c, ioh_d, memh, mmioh;\n\tu_int16_t vgadata;\n\tint gotio_b, gotio_c, gotio_d, gotmem, gotmmio, rv;\n\tint width;\n\n\tgotio_b = gotio_c = gotio_d = gotmem = gotmmio = rv = 0;\n\n\tif (iosize != 0) {\n\t\tif (bus_space_map(iot, iobase+0x3b0, 0xc, 0, &ioh_b))\n\t\t\tgoto bad;\n\t\tgotio_b = 1;\n\t\tif (bus_space_map(iot, iobase+0x3c0, 0x10, 0, &ioh_c))\n\t\t\tgoto bad;\n\t\tgotio_c = 1;\n\t\tif (bus_space_map(iot, iobase+0x3d0, 0x10, 0, &ioh_d))\n\t\t\tgoto bad;\n\t\tgotio_d = 1;\n\t}\n\tif (mmiosize != 0) {\n\t\tif (bus_space_map(iot, mmiobase, mmiosize, 0, &mmioh))\n\t\t\tgoto bad;\n\t\tgotmmio = 1;\n\t}\n\tif (bus_space_map(memt, membase, memsize, 0, &memh))\n\t\tgoto bad;\n\tgotmem = 1;\n\n#if 0\n\t/* CR1 - Horiz. Display End */\n\tbus_space_write_1(iot, ioh_d, 4, 0x1);\n\twidth = bus_space_read_1(iot, ioh_d, 5);\n\t/* this is not bit width yet */\n\n\t/* use CR17 - mode control for this?? */\n\tif ((width != 0xff) && (width < 600)) {\n\t\t/* not accessable or in graphics mode? */\n\t\tgoto bad;\n\t}\n#endif\n\n\tvgadata = bus_space_read_2(memt, memh, 0);\n\tbus_space_write_2(memt, memh, 0, 0xa55a);\n\trv = (bus_space_read_2(memt, memh, 0) == 0xa55a);\n\tbus_space_write_2(memt, memh, 0, vgadata);\n\nbad:\n\tif (gotio_b)\n\t\tbus_space_unmap(iot, ioh_b, 0xc);\n\tif (gotio_c)\n\t\tbus_space_unmap(iot, ioh_c, 0x10);\n\tif (gotio_d)\n\t\tbus_space_unmap(iot, ioh_d, 0x10);\n\tif (gotmmio)\n\t\tbus_space_unmap(memt, mmioh, mmiosize);\n\tif (gotmem)\n\t\tbus_space_unmap(memt, memh, memsize);\n\n\treturn (rv);\n}"
  }
]