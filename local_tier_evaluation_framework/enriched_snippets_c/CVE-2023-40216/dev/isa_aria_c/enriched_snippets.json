[
  {
    "function_name": "aria_mixer_query_devinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1525-1714",
    "snippet": "int\naria_mixer_query_devinfo(addr, dip)\n\t   void *addr;\n\t   register mixer_devinfo_t *dip;\n{\n\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_mixer_query_devinfo\\n\"));\n\n\tif (!(ARIA_MIXER&sc->sc_hardware))  /* This could be done better, no mixer still has some controls. */\n\t\treturn ENXIO;\n\n\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\n\tswitch(dip->index) {\n\tcase ARIAMIX_MIC_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_MIC_MUTE;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_LINE_IN_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_LINE_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_CD_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_CD_MUTE;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_TEL_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_TEL_MUTE;\n\t\tstrcpy(dip->label.name, \"telephone\");\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_DAC_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_DAC_MUTE;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_AUX_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_AUX_MUTE;\n\t\tstrcpy(dip->label.name, AudioNoutput);\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_MIC_MUTE:\n\t\tdip->prev = ARIAMIX_MIC_LVL;\n\t\tgoto mode;\n\n\tcase ARIAMIX_LINE_IN_MUTE:\n\t\tdip->prev = ARIAMIX_LINE_IN_LVL;\n\t\tgoto mode;\n\t\n\tcase ARIAMIX_CD_MUTE:\n\t\tdip->prev = ARIAMIX_CD_LVL;\n\t\tgoto mode;\n\t\n\tcase ARIAMIX_DAC_MUTE:\n\t\tdip->prev = ARIAMIX_DAC_LVL;\n\t\tgoto mode;\n\n\tcase ARIAMIX_AUX_MUTE:\n\t\tdip->prev = ARIAMIX_AUX_LVL;\n\t\tgoto mode;\n\n\tcase ARIAMIX_TEL_MUTE:\n\t\tdip->prev = ARIAMIX_TEL_LVL;\n\t\tgoto mode;\n\nmode:\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tstrcpy(dip->label.name, AudioNmute);\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tdip->next = ARIAMIX_MASTER_TREBLE;\n\t\tstrcpy(dip->label.name, AudioNvolume);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_TREBLE:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tdip->prev = ARIAMIX_MASTER_LVL;\n\t\tdip->next = ARIAMIX_MASTER_BASS;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNtreble);\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_BASS:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tdip->prev = ARIAMIX_MASTER_TREBLE;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNbass);\n\t\tbreak;\n\n\tcase ARIAMIX_OUT_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioNoutput);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_RECORD_SOURCE:\n\t\tdip->mixer_class = ARIAMIX_RECORD_CLASS;\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tstrcpy(dip->label.name, AudioNsource);\n\t\tdip->un.e.num_mem = 6;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoutput);\n\t\tdip->un.e.member[0].ord = ARIAMIX_AUX_LVL;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNmicrophone);\n\t\tdip->un.e.member[1].ord = ARIAMIX_MIC_LVL;\n\t\tstrcpy(dip->un.e.member[2].label.name, AudioNdac);\n\t\tdip->un.e.member[2].ord = ARIAMIX_DAC_LVL;\n\t\tstrcpy(dip->un.e.member[3].label.name, AudioNline);\n\t\tdip->un.e.member[3].ord = ARIAMIX_LINE_IN_LVL;\n\t\tstrcpy(dip->un.e.member[3].label.name, AudioNcd);\n\t\tdip->un.e.member[4].ord = ARIAMIX_CD_LVL;\n\t\tstrcpy(dip->un.e.member[3].label.name, \"telephone\");\n\t\tdip->un.e.member[5].ord = ARIAMIX_TEL_LVL;\n\t\tbreak;\n\n\tcase ARIAMIX_INPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioCInputs);\n\t\tbreak;\n\n\tcase ARIAMIX_OUTPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioCOutputs);\n\t\tbreak;\n\n\tcase ARIAMIX_RECORD_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_RECORD_CLASS;\n\t\tstrcpy(dip->label.name, AudioCRecord);\n\t\tbreak;\n\n\tcase ARIAMIX_EQ_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_EQ_CLASS;\n\t\tstrcpy(dip->label.name, AudioCEqualization);\n\t\tbreak;\n\n\tdefault:\n\t\treturn ENXIO;\n\t\t/*NOTREACHED*/\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [
      "#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCEqualization"
          ],
          "line": 1706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCRecord"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCOutputs"
          ],
          "line": 1694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCInputs"
          ],
          "line": 1688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[3].label.name",
            "\"telephone\""
          ],
          "line": 1681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[3].label.name",
            "AudioNcd"
          ],
          "line": 1679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[3].label.name",
            "AudioNline"
          ],
          "line": 1677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[2].label.name",
            "AudioNdac"
          ],
          "line": 1675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNmicrophone"
          ],
          "line": 1673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNoutput"
          ],
          "line": 1671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNsource"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNoutput"
          ],
          "line": 1661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNbass"
          ],
          "line": 1655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmaster"
          ],
          "line": 1653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNtreble"
          ],
          "line": 1646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmaster"
          ],
          "line": 1644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNvolume"
          ],
          "line": 1634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNon"
          ],
          "line": 1626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNoff"
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmute"
          ],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNoutput"
          ],
          "line": 1590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNdac"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"telephone\""
          ],
          "line": 1572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNcd"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNline"
          ],
          "line": 1554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmicrophone"
          ],
          "line": 1545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_mixer_query_devinfo\\n\")"
          ],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\n#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */\n\nint\naria_mixer_query_devinfo(addr, dip)\n\t   void *addr;\n\t   register mixer_devinfo_t *dip;\n{\n\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_mixer_query_devinfo\\n\"));\n\n\tif (!(ARIA_MIXER&sc->sc_hardware))  /* This could be done better, no mixer still has some controls. */\n\t\treturn ENXIO;\n\n\tdip->prev = dip->next = AUDIO_MIXER_LAST;\n\n\tswitch(dip->index) {\n\tcase ARIAMIX_MIC_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_MIC_MUTE;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_LINE_IN_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_LINE_IN_MUTE;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_CD_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_CD_MUTE;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_TEL_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_TEL_MUTE;\n\t\tstrcpy(dip->label.name, \"telephone\");\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_DAC_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_DAC_MUTE;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_AUX_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->next = ARIAMIX_AUX_MUTE;\n\t\tstrcpy(dip->label.name, AudioNoutput);\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_MIC_MUTE:\n\t\tdip->prev = ARIAMIX_MIC_LVL;\n\t\tgoto mode;\n\n\tcase ARIAMIX_LINE_IN_MUTE:\n\t\tdip->prev = ARIAMIX_LINE_IN_LVL;\n\t\tgoto mode;\n\t\n\tcase ARIAMIX_CD_MUTE:\n\t\tdip->prev = ARIAMIX_CD_LVL;\n\t\tgoto mode;\n\t\n\tcase ARIAMIX_DAC_MUTE:\n\t\tdip->prev = ARIAMIX_DAC_LVL;\n\t\tgoto mode;\n\n\tcase ARIAMIX_AUX_MUTE:\n\t\tdip->prev = ARIAMIX_AUX_LVL;\n\t\tgoto mode;\n\n\tcase ARIAMIX_TEL_MUTE:\n\t\tdip->prev = ARIAMIX_TEL_LVL;\n\t\tgoto mode;\n\nmode:\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tstrcpy(dip->label.name, AudioNmute);\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tdip->next = ARIAMIX_MASTER_TREBLE;\n\t\tstrcpy(dip->label.name, AudioNvolume);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_TREBLE:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tdip->prev = ARIAMIX_MASTER_LVL;\n\t\tdip->next = ARIAMIX_MASTER_BASS;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNtreble);\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_BASS:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tdip->prev = ARIAMIX_MASTER_TREBLE;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNbass);\n\t\tbreak;\n\n\tcase ARIAMIX_OUT_LVL:\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioNoutput);\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ARIAMIX_RECORD_SOURCE:\n\t\tdip->mixer_class = ARIAMIX_RECORD_CLASS;\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tstrcpy(dip->label.name, AudioNsource);\n\t\tdip->un.e.num_mem = 6;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoutput);\n\t\tdip->un.e.member[0].ord = ARIAMIX_AUX_LVL;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNmicrophone);\n\t\tdip->un.e.member[1].ord = ARIAMIX_MIC_LVL;\n\t\tstrcpy(dip->un.e.member[2].label.name, AudioNdac);\n\t\tdip->un.e.member[2].ord = ARIAMIX_DAC_LVL;\n\t\tstrcpy(dip->un.e.member[3].label.name, AudioNline);\n\t\tdip->un.e.member[3].ord = ARIAMIX_LINE_IN_LVL;\n\t\tstrcpy(dip->un.e.member[3].label.name, AudioNcd);\n\t\tdip->un.e.member[4].ord = ARIAMIX_CD_LVL;\n\t\tstrcpy(dip->un.e.member[3].label.name, \"telephone\");\n\t\tdip->un.e.member[5].ord = ARIAMIX_TEL_LVL;\n\t\tbreak;\n\n\tcase ARIAMIX_INPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_INPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioCInputs);\n\t\tbreak;\n\n\tcase ARIAMIX_OUTPUT_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_OUTPUT_CLASS;\n\t\tstrcpy(dip->label.name, AudioCOutputs);\n\t\tbreak;\n\n\tcase ARIAMIX_RECORD_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_RECORD_CLASS;\n\t\tstrcpy(dip->label.name, AudioCRecord);\n\t\tbreak;\n\n\tcase ARIAMIX_EQ_CLASS:\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tdip->mixer_class = ARIAMIX_EQ_CLASS;\n\t\tstrcpy(dip->label.name, AudioCEqualization);\n\t\tbreak;\n\n\tdefault:\n\t\treturn ENXIO;\n\t\t/*NOTREACHED*/\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "aria_mixer_get_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1367-1523",
    "snippet": "int\naria_mixer_get_port(addr, cp)\n    void *addr;\n    mixer_ctrl_t *cp;\n{\n\tregister struct aria_softc *sc = addr;\n\tint error = EINVAL;\n\n\tDPRINTF((\"aria_mixer_get_port\\n\"));\n\n\tif (!(ARIA_MIXER&sc->sc_hardware))  /* This could be done better, no mixer still has some controls. */\n\t\treturn ENXIO;\n\n\tswitch (cp->dev) {\n\tcase ARIAMIX_MIC_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_MIC_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_MIC_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_MIC_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\t\t\t\n\tcase ARIAMIX_LINE_IN_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_LINE_IN_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_LINE_IN_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_LINE_IN_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_CD_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_CD_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_CD_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_CD_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_TEL_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_TEL_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_TEL_LVL].level[0];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\tcase ARIAMIX_DAC_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_DAC_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_DAC_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_DAC_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_AUX_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_AUX_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_AUX_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_AUX_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MIC_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_MIC_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_LINE_IN_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_LINE_IN_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_CD_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_CD_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_DAC_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_DAC_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_AUX_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_AUX_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_TEL_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_TEL_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->ariamix_master.num_channels;\n\t\t\tcp->un.value.level[0] = sc->ariamix_master.level[0];\n\t\t\tcp->un.value.level[1] = sc->ariamix_master.level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_TREBLE:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = 2;\n\t\t\tcp->un.value.level[0] = sc->ariamix_master.treble[0];\n\t\t\tcp->un.value.level[1] = sc->ariamix_master.treble[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_BASS:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = 2;\n\t\t\tcp->un.value.level[0] = sc->ariamix_master.bass[0];\n\t\t\tcp->un.value.level[1] = sc->ariamix_master.bass[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_OUT_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->sc_chans;\n\t\t\tcp->un.value.level[0] = sc->gain[0];\n\t\t\tcp->un.value.level[1] = sc->gain[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\tcase ARIAMIX_RECORD_SOURCE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix_source;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\treturn ENXIO;\n\t\t/* NOT REACHED */\n\t}\n\n\treturn(error);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [
      "#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_mixer_get_port\\n\")"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\n#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */\n\nint\naria_mixer_get_port(addr, cp)\n    void *addr;\n    mixer_ctrl_t *cp;\n{\n\tregister struct aria_softc *sc = addr;\n\tint error = EINVAL;\n\n\tDPRINTF((\"aria_mixer_get_port\\n\"));\n\n\tif (!(ARIA_MIXER&sc->sc_hardware))  /* This could be done better, no mixer still has some controls. */\n\t\treturn ENXIO;\n\n\tswitch (cp->dev) {\n\tcase ARIAMIX_MIC_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_MIC_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_MIC_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_MIC_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\t\t\t\n\tcase ARIAMIX_LINE_IN_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_LINE_IN_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_LINE_IN_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_LINE_IN_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_CD_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_CD_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_CD_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_CD_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_TEL_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_TEL_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_TEL_LVL].level[0];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\tcase ARIAMIX_DAC_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_DAC_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_DAC_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_DAC_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_AUX_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->aria_mix[ARIAMIX_AUX_LVL].num_channels;\n\t\t\tcp->un.value.level[0] = sc->aria_mix[ARIAMIX_AUX_LVL].level[0];\n\t\t\tcp->un.value.level[1] = sc->aria_mix[ARIAMIX_AUX_LVL].level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MIC_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_MIC_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_LINE_IN_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_LINE_IN_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_CD_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_CD_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_DAC_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_DAC_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_AUX_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_AUX_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_TEL_MUTE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix[ARIAMIX_TEL_LVL].mute;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->ariamix_master.num_channels;\n\t\t\tcp->un.value.level[0] = sc->ariamix_master.level[0];\n\t\t\tcp->un.value.level[1] = sc->ariamix_master.level[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_TREBLE:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = 2;\n\t\t\tcp->un.value.level[0] = sc->ariamix_master.treble[0];\n\t\t\tcp->un.value.level[1] = sc->ariamix_master.treble[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_MASTER_BASS:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = 2;\n\t\t\tcp->un.value.level[0] = sc->ariamix_master.bass[0];\n\t\t\tcp->un.value.level[1] = sc->ariamix_master.bass[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tcase ARIAMIX_OUT_LVL:\n\t\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\t\tcp->un.value.num_channels = sc->sc_chans;\n\t\t\tcp->un.value.level[0] = sc->gain[0];\n\t\t\tcp->un.value.level[1] = sc->gain[1];\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\tcase ARIAMIX_RECORD_SOURCE:\n\t\tif (cp->type == AUDIO_MIXER_ENUM) {\n\t\t\tcp->un.ord = sc->aria_mix_source;\n\t\t\terror = 0;\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\treturn ENXIO;\n\t\t/* NOT REACHED */\n\t}\n\n\treturn(error);\n}"
  },
  {
    "function_name": "aria_mixer_set_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1205-1365",
    "snippet": "int\naria_mixer_set_port(addr, cp)\n    void *addr;\n    mixer_ctrl_t *cp;\n{\n\tregister struct aria_softc *sc = addr;\n\tint error = EINVAL;\n\n\tDPRINTF((\"aria_mixer_set_port\\n\"));\n\n\tif (!(ARIA_MIXER&sc->sc_hardware))  /* This could be done better, no mixer still has some controls. */\n\t\treturn ENXIO;\n\n\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\tregister mixer_level_t *mv = &cp->un.value;\n\t\tswitch (cp->dev) {\n\t\tcase ARIAMIX_MIC_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_LINE_IN_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_CD_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_TEL_LVL:\n\t\t\tif (mv->num_channels == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_TEL_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_TEL_LVL].level[0] = mv->level[0];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_DAC_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_AUX_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_MASTER_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->ariamix_master.num_channels = mv->num_channels;\n\t\t\t\tsc->ariamix_master.level[0] = mv->level[0];\n\t\t\t\tsc->ariamix_master.level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_MASTER_TREBLE:\n\t\t\tif (mv->num_channels == 2) {\n\t\t\t\tsc->ariamix_master.treble[0] = (mv->level[0]==0)?1:mv->level[0];\n\t\t\t\tsc->ariamix_master.treble[1] = (mv->level[1]==0)?1:mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ARIAMIX_MASTER_BASS:\n\t\t\tif (mv->num_channels == 2) {\n\t\t\t\tsc->ariamix_master.bass[0] = (mv->level[0]==0)?1:mv->level[0];\n\t\t\t\tsc->ariamix_master.bass[1] = (mv->level[1]==0)?1:mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ARIAMIX_OUT_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->gain[0] = mv->level[0];\n\t\t\t\tsc->gain[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t}\n\t}\n\n\tif (cp->type == AUDIO_MIXER_ENUM)\n\t\tswitch(cp->dev) {\n\t\tcase ARIAMIX_RECORD_SOURCE:\n\t\t\tif (cp->un.ord>=0 && cp->un.ord<=6) {\n\t\t\t\tsc->aria_mix_source = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_MIC_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_LINE_IN_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_CD_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_DAC_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_AUX_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_TEL_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_TEL_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\treturn ENXIO;\n\t\t\t/* NOTREACHED */\n\t\t}\n\n\treturn(error);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [
      "#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_mixer_set_port\\n\")"
          ],
          "line": 1213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\n#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */\n\nint\naria_mixer_set_port(addr, cp)\n    void *addr;\n    mixer_ctrl_t *cp;\n{\n\tregister struct aria_softc *sc = addr;\n\tint error = EINVAL;\n\n\tDPRINTF((\"aria_mixer_set_port\\n\"));\n\n\tif (!(ARIA_MIXER&sc->sc_hardware))  /* This could be done better, no mixer still has some controls. */\n\t\treturn ENXIO;\n\n\tif (cp->type == AUDIO_MIXER_VALUE) {\n\t\tregister mixer_level_t *mv = &cp->un.value;\n\t\tswitch (cp->dev) {\n\t\tcase ARIAMIX_MIC_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_LINE_IN_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_CD_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_TEL_LVL:\n\t\t\tif (mv->num_channels == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_TEL_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_TEL_LVL].level[0] = mv->level[0];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_DAC_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_AUX_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].num_channels = mv->num_channels;\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].level[0] = mv->level[0];\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_MASTER_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->ariamix_master.num_channels = mv->num_channels;\n\t\t\t\tsc->ariamix_master.level[0] = mv->level[0];\n\t\t\t\tsc->ariamix_master.level[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\n\t\tcase ARIAMIX_MASTER_TREBLE:\n\t\t\tif (mv->num_channels == 2) {\n\t\t\t\tsc->ariamix_master.treble[0] = (mv->level[0]==0)?1:mv->level[0];\n\t\t\t\tsc->ariamix_master.treble[1] = (mv->level[1]==0)?1:mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ARIAMIX_MASTER_BASS:\n\t\t\tif (mv->num_channels == 2) {\n\t\t\t\tsc->ariamix_master.bass[0] = (mv->level[0]==0)?1:mv->level[0];\n\t\t\t\tsc->ariamix_master.bass[1] = (mv->level[1]==0)?1:mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ARIAMIX_OUT_LVL:\n\t\t\tif (mv->num_channels == 1 || mv->num_channels == 2) {\n\t\t\t\tsc->gain[0] = mv->level[0];\n\t\t\t\tsc->gain[1] = mv->level[1];\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t}\n\t}\n\n\tif (cp->type == AUDIO_MIXER_ENUM)\n\t\tswitch(cp->dev) {\n\t\tcase ARIAMIX_RECORD_SOURCE:\n\t\t\tif (cp->un.ord>=0 && cp->un.ord<=6) {\n\t\t\t\tsc->aria_mix_source = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_MIC_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_MIC_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_LINE_IN_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_LINE_IN_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_CD_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_CD_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_DAC_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_DAC_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_AUX_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_AUX_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ARIAMIX_TEL_MUTE:\n\t\t\tif (cp->un.ord == 0 || cp->un.ord == 1) {\n\t\t\t\tsc->aria_mix[ARIAMIX_TEL_LVL].mute = cp->un.ord;\n\t\t\t\terror = 0;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\treturn ENXIO;\n\t\t\t/* NOTREACHED */\n\t\t}\n\n\treturn(error);\n}"
  },
  {
    "function_name": "aria_setfd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1193-1203",
    "snippet": "int\naria_setfd(addr, flag)\n\tvoid *addr;\n\tint flag;\n{\n/*\n * okay return yes.  I'll assume that it will only\n * ask when the file open read/write...  Or before...\n */\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_setfd(addr, flag)\n\tvoid *addr;\n\tint flag;\n{\n/*\n * okay return yes.  I'll assume that it will only\n * ask when the file open read/write...  Or before...\n */\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_intr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1150-1191",
    "snippet": "int\naria_intr(arg)\n\tvoid *arg;\n{\n\tregister struct  aria_softc *sc = arg;\n\tregister u_short iobase = sc->sc_iobase;\n\tregister u_short *pdata = sc->sc_pdiobuffer;\n\tregister u_short *rdata = sc->sc_rdiobuffer;\n\tu_short address;\n\tint i;\n\n\tif (inw(iobase) & 1 != 0x1) \n\t\treturn 0;  /* not for us */\n\n\tsc->sc_interrupts++;\n\n\tDPRINTF((\"aria_intr\\n\"));\n\n\tif ((sc->sc_open & ARIAR_OPEN_PLAY) && (pdata!=NULL)) {\n\t\tDPRINTF((\"aria_intr play=(%x)\\n\", pdata));\n\t\taddress = 0x8000 - 2*(sc->sc_blocksize);\n\t\taddress+= aria_getdspmem(iobase, ARIAA_PLAY_FIFO_A);\n\t\toutw(iobase+ARIADSP_DMAADDRESS, address);\n\t\toutsw(iobase + ARIADSP_DMADATA, pdata, sc->sc_blocksize/2);\n\t\tif (sc->sc_pintr != NULL)\n\t\t\t(*sc->sc_pintr)(sc->sc_parg);\n\t}\n\n\tif ((sc->sc_open & ARIAR_OPEN_RECORD) && (rdata!=NULL)) {\n\t\tDPRINTF((\"aria_intr record=(%x)\\n\", rdata));\n\t\taddress = 0x8000 - (sc->sc_blocksize);\n\t\taddress+= aria_getdspmem(iobase, ARIAA_REC_FIFO_A);\n\t\toutw(iobase+ARIADSP_DMAADDRESS, address);\n\t\tinsw(iobase + ARIADSP_DMADATA, rdata, sc->sc_blocksize/2);\n\t\tif (sc->sc_rintr != NULL)\n\t\t\t(*sc->sc_rintr)(sc->sc_rarg);\n\t}\n\n\taria_sendcmd(iobase, ARIADSPC_TRANSCOMPLETE, -1, -1, -1);\n\n\treturn 1;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "iobase",
            "ARIADSPC_TRANSCOMPLETE",
            "-1",
            "-1",
            "-1"
          ],
          "line": 1188
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->sc_rarg"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "insw",
          "args": [
            "iobase + ARIADSP_DMADATA",
            "rdata",
            "sc->sc_blocksize/2"
          ],
          "line": 1183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase+ARIADSP_DMAADDRESS",
            "address"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aria_getdspmem",
          "args": [
            "iobase",
            "ARIAA_REC_FIFO_A"
          ],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "aria_getdspmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "945-952",
          "snippet": "u_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nu_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_intr record=(%x)\\n\", rdata)"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "sc->sc_parg"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outsw",
          "args": [
            "iobase + ARIADSP_DMADATA",
            "pdata",
            "sc->sc_blocksize/2"
          ],
          "line": 1173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase+ARIADSP_DMAADDRESS",
            "address"
          ],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_intr play=(%x)\\n\", pdata)"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_intr\\n\")"
          ],
          "line": 1166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_intr(arg)\n\tvoid *arg;\n{\n\tregister struct  aria_softc *sc = arg;\n\tregister u_short iobase = sc->sc_iobase;\n\tregister u_short *pdata = sc->sc_pdiobuffer;\n\tregister u_short *rdata = sc->sc_rdiobuffer;\n\tu_short address;\n\tint i;\n\n\tif (inw(iobase) & 1 != 0x1) \n\t\treturn 0;  /* not for us */\n\n\tsc->sc_interrupts++;\n\n\tDPRINTF((\"aria_intr\\n\"));\n\n\tif ((sc->sc_open & ARIAR_OPEN_PLAY) && (pdata!=NULL)) {\n\t\tDPRINTF((\"aria_intr play=(%x)\\n\", pdata));\n\t\taddress = 0x8000 - 2*(sc->sc_blocksize);\n\t\taddress+= aria_getdspmem(iobase, ARIAA_PLAY_FIFO_A);\n\t\toutw(iobase+ARIADSP_DMAADDRESS, address);\n\t\toutsw(iobase + ARIADSP_DMADATA, pdata, sc->sc_blocksize/2);\n\t\tif (sc->sc_pintr != NULL)\n\t\t\t(*sc->sc_pintr)(sc->sc_parg);\n\t}\n\n\tif ((sc->sc_open & ARIAR_OPEN_RECORD) && (rdata!=NULL)) {\n\t\tDPRINTF((\"aria_intr record=(%x)\\n\", rdata));\n\t\taddress = 0x8000 - (sc->sc_blocksize);\n\t\taddress+= aria_getdspmem(iobase, ARIAA_REC_FIFO_A);\n\t\toutw(iobase+ARIADSP_DMAADDRESS, address);\n\t\tinsw(iobase + ARIADSP_DMADATA, rdata, sc->sc_blocksize/2);\n\t\tif (sc->sc_rintr != NULL)\n\t\t\t(*sc->sc_rintr)(sc->sc_rarg);\n\t}\n\n\taria_sendcmd(iobase, ARIADSPC_TRANSCOMPLETE, -1, -1, -1);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "aria_start_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1114-1143",
    "snippet": "int\naria_start_output(addr, p, cc, intr, arg)\n\tvoid *addr;\n\tvoid *p;\n\tint cc;\n\tvoid (*intr)();\n\tvoid *arg;\n{\n\tregister struct aria_softc *sc = addr;\n\tregister int i;\n\n\tDPRINTF((\"aria_start_output %d @ %x\\n\", cc, p));\n\n\tif (cc != sc->sc_blocksize) {\n\t\tDPRINTF((\"aria_start_output reqsize %d not sc_blocksize %d\\n\",\n\t\t\tcc, sc->sc_blocksize));\n\t\treturn EINVAL;\n\t}\n\n\tsc->sc_parg = arg;\n\tsc->sc_pintr = intr;\n\tsc->sc_pdiobuffer = p;\n\n\tif (!(sc->sc_play&(1<<1))) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_PLAY,  1, -1, -1);\n\t\tsc->sc_play |= (1<<1);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "sc->sc_iobase",
            "ARIADSPC_START_PLAY",
            "1",
            "-1",
            "-1"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_start_output reqsize %d not sc_blocksize %d\\n\",\n\t\t\tcc, sc->sc_blocksize)"
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_start_output %d @ %x\\n\", cc, p)"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_start_output(addr, p, cc, intr, arg)\n\tvoid *addr;\n\tvoid *p;\n\tint cc;\n\tvoid (*intr)();\n\tvoid *arg;\n{\n\tregister struct aria_softc *sc = addr;\n\tregister int i;\n\n\tDPRINTF((\"aria_start_output %d @ %x\\n\", cc, p));\n\n\tif (cc != sc->sc_blocksize) {\n\t\tDPRINTF((\"aria_start_output reqsize %d not sc_blocksize %d\\n\",\n\t\t\tcc, sc->sc_blocksize));\n\t\treturn EINVAL;\n\t}\n\n\tsc->sc_parg = arg;\n\tsc->sc_pintr = intr;\n\tsc->sc_pdiobuffer = p;\n\n\tif (!(sc->sc_play&(1<<1))) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_PLAY,  1, -1, -1);\n\t\tsc->sc_play |= (1<<1);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "aria_start_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1083-1112",
    "snippet": "int\naria_start_input(addr, p, cc, intr, arg)\n\tvoid *addr;\n\tvoid *p;\n\tint cc;\n\tvoid (*intr)();\n\tvoid *arg;\n{\n\tregister struct aria_softc *sc = addr;\n\tregister int i;\n\n\tDPRINTF((\"aria_start_input %d @ %x\\n\", cc, p));\n\n\tif (cc != sc->sc_blocksize) {\n\t\tDPRINTF((\"aria_start_input reqsize %d not sc_blocksize %d\\n\",\n\t\t\tcc, sc->sc_blocksize));\n\t\treturn EINVAL;\n\t}\n\n\tsc->sc_rarg = arg;\n\tsc->sc_rintr = intr;\n\tsc->sc_rdiobuffer = p;\n\n\tif (!(sc->sc_record&(1<<0))) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_REC,  0, -1, -1);\n\t\tsc->sc_record |= (1<<0);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "sc->sc_iobase",
            "ARIADSPC_START_REC",
            "0",
            "-1",
            "-1"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_start_input reqsize %d not sc_blocksize %d\\n\",\n\t\t\tcc, sc->sc_blocksize)"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_start_input %d @ %x\\n\", cc, p)"
          ],
          "line": 1094
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_start_input(addr, p, cc, intr, arg)\n\tvoid *addr;\n\tvoid *p;\n\tint cc;\n\tvoid (*intr)();\n\tvoid *arg;\n{\n\tregister struct aria_softc *sc = addr;\n\tregister int i;\n\n\tDPRINTF((\"aria_start_input %d @ %x\\n\", cc, p));\n\n\tif (cc != sc->sc_blocksize) {\n\t\tDPRINTF((\"aria_start_input reqsize %d not sc_blocksize %d\\n\",\n\t\t\tcc, sc->sc_blocksize));\n\t\treturn EINVAL;\n\t}\n\n\tsc->sc_rarg = arg;\n\tsc->sc_rintr = intr;\n\tsc->sc_rdiobuffer = p;\n\n\tif (!(sc->sc_record&(1<<0))) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_REC,  0, -1, -1);\n\t\tsc->sc_record |= (1<<0);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "aria_cont",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1057-1076",
    "snippet": "int\naria_cont(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_cont\\n\"));\n\n\tif (!sc->sc_record&(1<<0) && (sc->sc_open&ARIAR_OPEN_RECORD)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_REC,  ARIAR_RECORD_CHAN, -1, -1);\n\t\tsc->sc_record |= ~(1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tif (!sc->sc_play&(1<<ARIAR_PLAY_CHAN) && (sc->sc_open&ARIAR_OPEN_PLAY)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_PLAY, 1, -1, -1);\n\t\tsc->sc_play |= ~(1<<ARIAR_PLAY_CHAN);\n\t}\n\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "sc->sc_iobase",
            "ARIADSPC_START_PLAY",
            "1",
            "-1",
            "-1"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_cont\\n\")"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_cont(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_cont\\n\"));\n\n\tif (!sc->sc_record&(1<<0) && (sc->sc_open&ARIAR_OPEN_RECORD)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_REC,  ARIAR_RECORD_CHAN, -1, -1);\n\t\tsc->sc_record |= ~(1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tif (!sc->sc_play&(1<<ARIAR_PLAY_CHAN) && (sc->sc_open&ARIAR_OPEN_PLAY)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_START_PLAY, 1, -1, -1);\n\t\tsc->sc_play |= ~(1<<ARIAR_PLAY_CHAN);\n\t}\n\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_halt_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1038-1052",
    "snippet": "int\naria_halt_output(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_halt_output\\n\"));\n\n\tif (sc->sc_play & (1<<1)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_STOP_PLAY, 1, -1, -1);\n\t\tsc->sc_play &= ~(1<<1);\n\t}\n\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "sc->sc_iobase",
            "ARIADSPC_STOP_PLAY",
            "1",
            "-1",
            "-1"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_halt_output\\n\")"
          ],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_halt_output(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_halt_output\\n\"));\n\n\tif (sc->sc_play & (1<<1)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_STOP_PLAY, 1, -1, -1);\n\t\tsc->sc_play &= ~(1<<1);\n\t}\n\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_halt_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "1022-1036",
    "snippet": "int\naria_halt_input(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_halt_input\\n\"));\n\n\tif (sc->sc_record&(1<<0)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_STOP_REC, 0, -1, -1);\n\t\tsc->sc_record &= ~(1<<0);\n\t}\n\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "sc->sc_iobase",
            "ARIADSPC_STOP_REC",
            "0",
            "-1",
            "-1"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_halt_input\\n\")"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_halt_input(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_halt_input\\n\"));\n\n\tif (sc->sc_record&(1<<0)) {\n\t\taria_sendcmd(sc->sc_iobase, ARIADSPC_STOP_REC, 0, -1, -1);\n\t\tsc->sc_record &= ~(1<<0);\n\t}\n\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_sendcmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "960-1020",
    "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail)"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_WRITE",
            "(u_short) ARIADSPC_TERM"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_WRITE",
            "(u_short) arg3"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_WRITE",
            "(u_short) arg2"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_WRITE",
            "(u_short) arg1"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_WRITE",
            "(u_short) command"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase + ARIADSP_STATUS"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
  },
  {
    "function_name": "aria_getdspmem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "945-952",
    "snippet": "u_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase+ARIADSP_DMADATA"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase+ARIADSP_DMAADDRESS",
            "loc"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nu_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}"
  },
  {
    "function_name": "aria_putdspmem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "935-943",
    "snippet": "u_short\naria_putdspmem(iobase, loc, val)\n\tregister u_short iobase;\n\tregister u_short loc;\n\tregister u_short val;\n{\n\toutw(iobase + ARIADSP_DMAADDRESS, loc);\n\toutw(iobase + ARIADSP_DMADATA, val);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_DMADATA",
            "val"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_DMAADDRESS",
            "loc"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nu_short\naria_putdspmem(iobase, loc, val)\n\tregister u_short iobase;\n\tregister u_short loc;\n\tregister u_short val;\n{\n\toutw(iobase + ARIADSP_DMAADDRESS, loc);\n\toutw(iobase + ARIADSP_DMADATA, val);\n}"
  },
  {
    "function_name": "aria_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "910-929",
    "snippet": "int\naria_reset(sc)\n\tregister struct aria_softc *sc;\n{\n\tregister u_short iobase = sc->sc_iobase;\n\tint fail=0;\n\n\toutw(iobase + ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR);\n\taria_putdspmem(iobase, 0x6102, 0);\n\n\tfail |= aria_sendcmd(iobase, ARIADSPC_SYSINIT, 0x0000, 0x0000, 0x0000);\n\n\twhile (aria_getdspmem(iobase, ARIAA_TASK_A) != 1)\n\t\t;\n\n\toutw(iobase+ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR|ARIAR_PCINTWR);\n\tfail |= aria_sendcmd(iobase, ARIADSPC_MODE, ARIAV_MODE_NO_SYNTH,-1,-1);\n\n\treturn (fail);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "iobase",
            "ARIADSPC_MODE",
            "ARIAV_MODE_NO_SYNTH",
            "-1",
            "-1"
          ],
          "line": 926
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase+ARIADSP_CONTROL",
            "ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR|ARIAR_PCINTWR"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aria_getdspmem",
          "args": [
            "iobase",
            "ARIAA_TASK_A"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "aria_getdspmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "945-952",
          "snippet": "u_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nu_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aria_putdspmem",
          "args": [
            "iobase",
            "0x6102",
            "0"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "aria_putdspmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "935-943",
          "snippet": "u_short\naria_putdspmem(iobase, loc, val)\n\tregister u_short iobase;\n\tregister u_short loc;\n\tregister u_short val;\n{\n\toutw(iobase + ARIADSP_DMAADDRESS, loc);\n\toutw(iobase + ARIADSP_DMADATA, val);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nu_short\naria_putdspmem(iobase, loc, val)\n\tregister u_short iobase;\n\tregister u_short loc;\n\tregister u_short val;\n{\n\toutw(iobase + ARIADSP_DMAADDRESS, loc);\n\toutw(iobase + ARIADSP_DMADATA, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase + ARIADSP_CONTROL",
            "ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_reset(sc)\n\tregister struct aria_softc *sc;\n{\n\tregister u_short iobase = sc->sc_iobase;\n\tint fail=0;\n\n\toutw(iobase + ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR);\n\taria_putdspmem(iobase, 0x6102, 0);\n\n\tfail |= aria_sendcmd(iobase, ARIADSPC_SYSINIT, 0x0000, 0x0000, 0x0000);\n\n\twhile (aria_getdspmem(iobase, ARIAA_TASK_A) != 1)\n\t\t;\n\n\toutw(iobase+ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR|ARIAR_PCINTWR);\n\tfail |= aria_sendcmd(iobase, ARIADSPC_MODE, ARIAV_MODE_NO_SYNTH,-1,-1);\n\n\treturn (fail);\n}"
  },
  {
    "function_name": "ariaclose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "873-904",
    "snippet": "void\nariaclose(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\tregister u_int iobase = sc->sc_iobase;\n\n\tDPRINTF((\"aria_close sc=0x%x\\n\", sc));\n\n        sc->spkr_state = SPKR_OFF;\n        sc->sc_rintr = 0;\n        sc->sc_pintr = 0;\n\tsc->sc_rdiobuffer = 0;\n\tsc->sc_pdiobuffer = 0;\n\n\tif (sc->sc_play&(1<<ARIAR_PLAY_CHAN) && sc->sc_open & ARIAR_OPEN_PLAY) {\n\t\taria_sendcmd(iobase, ARIADSPC_STOP_PLAY, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play &= ~(1<<ARIAR_PLAY_CHAN);\n\t}\n\n\tif (sc->sc_record&(1<<ARIAR_RECORD_CHAN) && sc->sc_open & ARIAR_OPEN_RECORD) {\n\t\taria_sendcmd(iobase, ARIADSPC_STOP_REC, ARIAR_RECORD_CHAN, -1, -1);\n\t\tsc->sc_record &= ~(1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tsc->sc_open = 0;\n\n\tif (aria_reset(sc) != 0) {\n\t\tdelay(500);\n\t\taria_reset(sc);\n\t}\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_reset",
          "args": [
            "sc"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "aria_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "910-929",
          "snippet": "int\naria_reset(sc)\n\tregister struct aria_softc *sc;\n{\n\tregister u_short iobase = sc->sc_iobase;\n\tint fail=0;\n\n\toutw(iobase + ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR);\n\taria_putdspmem(iobase, 0x6102, 0);\n\n\tfail |= aria_sendcmd(iobase, ARIADSPC_SYSINIT, 0x0000, 0x0000, 0x0000);\n\n\twhile (aria_getdspmem(iobase, ARIAA_TASK_A) != 1)\n\t\t;\n\n\toutw(iobase+ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR|ARIAR_PCINTWR);\n\tfail |= aria_sendcmd(iobase, ARIADSPC_MODE, ARIAV_MODE_NO_SYNTH,-1,-1);\n\n\treturn (fail);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_reset(sc)\n\tregister struct aria_softc *sc;\n{\n\tregister u_short iobase = sc->sc_iobase;\n\tint fail=0;\n\n\toutw(iobase + ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR);\n\taria_putdspmem(iobase, 0x6102, 0);\n\n\tfail |= aria_sendcmd(iobase, ARIADSPC_SYSINIT, 0x0000, 0x0000, 0x0000);\n\n\twhile (aria_getdspmem(iobase, ARIAA_TASK_A) != 1)\n\t\t;\n\n\toutw(iobase+ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR|ARIAR_PCINTWR);\n\tfail |= aria_sendcmd(iobase, ARIADSPC_MODE, ARIAV_MODE_NO_SYNTH,-1,-1);\n\n\treturn (fail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "500"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "iobase",
            "ARIADSPC_STOP_REC",
            "ARIAR_RECORD_CHAN",
            "-1",
            "-1"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_close sc=0x%x\\n\", sc)"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nvoid\nariaclose(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\tregister u_int iobase = sc->sc_iobase;\n\n\tDPRINTF((\"aria_close sc=0x%x\\n\", sc));\n\n        sc->spkr_state = SPKR_OFF;\n        sc->sc_rintr = 0;\n        sc->sc_pintr = 0;\n\tsc->sc_rdiobuffer = 0;\n\tsc->sc_pdiobuffer = 0;\n\n\tif (sc->sc_play&(1<<ARIAR_PLAY_CHAN) && sc->sc_open & ARIAR_OPEN_PLAY) {\n\t\taria_sendcmd(iobase, ARIADSPC_STOP_PLAY, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play &= ~(1<<ARIAR_PLAY_CHAN);\n\t}\n\n\tif (sc->sc_record&(1<<ARIAR_RECORD_CHAN) && sc->sc_open & ARIAR_OPEN_RECORD) {\n\t\taria_sendcmd(iobase, ARIADSPC_STOP_REC, ARIAR_RECORD_CHAN, -1, -1);\n\t\tsc->sc_record &= ~(1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tsc->sc_open = 0;\n\n\tif (aria_reset(sc) != 0) {\n\t\tdelay(500);\n\t\taria_reset(sc);\n\t}\n}"
  },
  {
    "function_name": "aria_commit_settings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "766-871",
    "snippet": "int\naria_commit_settings(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\tregister u_short iobase = sc->sc_iobase;\n\tu_char tones[16] = { 7, 6, 5, 4, 3, 2, 1, 0, 8, 9, 10, 11, 12, 13, 14, 15 };\n\tu_short format;\n\tu_short left, right;\n\tu_short samp;\n\tu_char i;\n\n\tDPRINTF((\"aria_commit_settings\\n\"));\n\n\tswitch (sc->sc_rate) {\n\t\tcase  7875: format = 0x00; samp = 0x60; break;\n\t\tcase 11025: format = 0x00; samp = 0x40; break;\n\t\tcase 15750: format = 0x10; samp = 0x60; break;\n\t\tcase 22050: format = 0x10; samp = 0x40; break;\n\t\tcase 31500: format = 0x10; samp = 0x20; break;\n\t\tcase 44100: format = 0x20; samp = 0x00; break;\n\t\tdefault:    format = 0x00; samp = 0x40; break;\n\t}\n\n\tformat |= (sc->sc_chans==2)?1:0;\n\tformat |= (sc->sc_precision==16)?2:0;\n\n\taria_sendcmd(iobase, ARIADSPC_FORMAT, format, -1, -1);\n\toutw(iobase+ARIADSP_CONTROL, (inw(iobase+ARIADSP_STATUS)&~0x60)|samp); /* Addition parm for sample rate */\n\n\tif (sc->sc_hardware&ARIA_MIXER) {\n\t\tfor (i=0; i<6; i++) {\n\t\t\tu_char source;\n\t\t\tswitch(i) {\n\t\t\tcase ARIAMIX_MIC_LVL:     source = 0x0001; break;\n\t\t\tcase ARIAMIX_CD_LVL:      source = 0x0002; break;\n\t\t\tcase ARIAMIX_LINE_IN_LVL: source = 0x0008; break;\n\t\t\tcase ARIAMIX_TEL_LVL:     source = 0x0020; break;\n\t\t\tcase ARIAMIX_AUX_LVL:     source = 0x0010; break;\n\t\t\tcase ARIAMIX_DAC_LVL:     source = 0x0004; break;\n\t\t\tdefault:               source = 0x0000; break;\n\t\t\t}\n\t\t\t\t\n\t\t\tif (source != 0x0000 && source != 0x0004) {\n\t\t\t\tif (sc->aria_mix[i].mute == 1)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, 3, -1);\n\t\t\t\telse\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, (sc->aria_mix[i].num_channels==2)?0:1, -1); \n\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, 0x8000|source, (sc->aria_mix[i].num_channels==2)?0:1, -1);\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, source, sc->aria_mix[i].level[0] << 7, sc->aria_mix[i].level[1] << 7);\n\t\t\t}\n\n\t\t\tif (sc->aria_mix_source == i) {\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCSOURCE, source, -1, -1);\n\n\t\t\t\tif (sc->sc_open & ARIAR_OPEN_RECORD)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 1, -1, -1);\n\t\t\t\telse \n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 0, -1, -1);\n\t\t\t}\n\t\t}\n\n\t\tif (sc->sc_chans==2) {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, (sc->gain[0]+sc->gain[1])/2, -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, (sc->gain[0]-sc->gain[1])/4+0x40, -1, -1);\n\t\t} else {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, sc->gain[0], -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, 0x40, -1, -1);\n\t\t}\n\n\t\t/* aria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1 | (1<<8), -1, -1); */\n\t\taria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1, -1, -1);\n\n\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, 0x0004, sc->ariamix_master.level[0] << 7, sc->ariamix_master.level[1] << 7);\n\n\t\t/* Convert treb/bass from byte to soundcard style */\n\n\t\tleft  = tones[(sc->ariamix_master.bass[0]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[0]>>4)&0x0f];\n\t\tright = tones[(sc->ariamix_master.bass[1]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[1]>>4)&0x0f];\n\n\t\taria_sendcmd(iobase, ARIADSPC_TONE, left, right, -1);\n\t}\n\n\tif (sc->sc_change != 0)\n\t\taria_sendcmd(iobase, ARIADSPC_BLOCKSIZE, sc->sc_blocksize/2, -1, -1);\n\n/*\n * If we think that the card is recording or playing, start it up again here.\n * Some of the previous commands turn the channels off.\n */\n\n\tif (sc->sc_record&(1<<ARIAR_RECORD_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_REC, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tif (sc->sc_play&(1<<ARIAR_PLAY_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_PLAY, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_PLAY_CHAN);\n\t}\n\n\tsc->sc_change = 0;\n\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [
      "#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aria_sendcmd",
          "args": [
            "iobase",
            "ARIADSPC_START_PLAY",
            "ARIAR_PLAY_CHAN",
            "-1",
            "-1"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "aria_sendcmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "960-1020",
          "snippet": "int\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_sendcmd(iobase, command, arg1, arg2, arg3)\n\tu_short iobase;\n\tu_short command;\n\tint arg1;\n\tint arg2;\n\tint arg3;\n{\n\tint i, fail = 0;\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:1;\n\toutw(iobase + ARIADSP_WRITE, (u_short) command); \n\n\tif (arg1 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:2;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg1); \n\t}\n\n\tif (arg2 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:4;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg2); \n\t}\n\n\tif (arg3 != -1) {\n\t\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t\t;\n\n\t\tfail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:8;\n\t\toutw(iobase + ARIADSP_WRITE, (u_short) arg3); \n\t}\n\n\tfor (i = ARIAR_NPOLL; (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY) != 0 && i>0; i-- )\n\t\t;\n\n        fail |= (inw(iobase + ARIADSP_STATUS) & ARIAR_BUSY)==0?0:16;\n\toutw(iobase + ARIADSP_WRITE, (u_short) ARIADSPC_TERM); \n\t\n#ifdef AUDIO_DEBUG\n\tif (fail) {\n\t\t++ariaerr.sendcmd;\n\t\tDPRINTF((\"aria_sendcmd: failure=(%d) cmd=(0x%x) fail=(0x%x)\\n\", ariaerr.sendcmd, command, fail));\n\t\treturn -1;\n\t}\n#else\n\tif (fail != 0) {\n\t\t++ariaerr.sendcmd;\n\t\treturn -1;\n\t}\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "iobase+ARIADSP_CONTROL",
            "(inw(iobase+ARIADSP_STATUS)&~0x60)|samp"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inw",
          "args": [
            "iobase+ARIADSP_STATUS"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_commit_settings\\n\")"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\n#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */\n\nint\naria_commit_settings(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\tregister u_short iobase = sc->sc_iobase;\n\tu_char tones[16] = { 7, 6, 5, 4, 3, 2, 1, 0, 8, 9, 10, 11, 12, 13, 14, 15 };\n\tu_short format;\n\tu_short left, right;\n\tu_short samp;\n\tu_char i;\n\n\tDPRINTF((\"aria_commit_settings\\n\"));\n\n\tswitch (sc->sc_rate) {\n\t\tcase  7875: format = 0x00; samp = 0x60; break;\n\t\tcase 11025: format = 0x00; samp = 0x40; break;\n\t\tcase 15750: format = 0x10; samp = 0x60; break;\n\t\tcase 22050: format = 0x10; samp = 0x40; break;\n\t\tcase 31500: format = 0x10; samp = 0x20; break;\n\t\tcase 44100: format = 0x20; samp = 0x00; break;\n\t\tdefault:    format = 0x00; samp = 0x40; break;\n\t}\n\n\tformat |= (sc->sc_chans==2)?1:0;\n\tformat |= (sc->sc_precision==16)?2:0;\n\n\taria_sendcmd(iobase, ARIADSPC_FORMAT, format, -1, -1);\n\toutw(iobase+ARIADSP_CONTROL, (inw(iobase+ARIADSP_STATUS)&~0x60)|samp); /* Addition parm for sample rate */\n\n\tif (sc->sc_hardware&ARIA_MIXER) {\n\t\tfor (i=0; i<6; i++) {\n\t\t\tu_char source;\n\t\t\tswitch(i) {\n\t\t\tcase ARIAMIX_MIC_LVL:     source = 0x0001; break;\n\t\t\tcase ARIAMIX_CD_LVL:      source = 0x0002; break;\n\t\t\tcase ARIAMIX_LINE_IN_LVL: source = 0x0008; break;\n\t\t\tcase ARIAMIX_TEL_LVL:     source = 0x0020; break;\n\t\t\tcase ARIAMIX_AUX_LVL:     source = 0x0010; break;\n\t\t\tcase ARIAMIX_DAC_LVL:     source = 0x0004; break;\n\t\t\tdefault:               source = 0x0000; break;\n\t\t\t}\n\t\t\t\t\n\t\t\tif (source != 0x0000 && source != 0x0004) {\n\t\t\t\tif (sc->aria_mix[i].mute == 1)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, 3, -1);\n\t\t\t\telse\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, (sc->aria_mix[i].num_channels==2)?0:1, -1); \n\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, 0x8000|source, (sc->aria_mix[i].num_channels==2)?0:1, -1);\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, source, sc->aria_mix[i].level[0] << 7, sc->aria_mix[i].level[1] << 7);\n\t\t\t}\n\n\t\t\tif (sc->aria_mix_source == i) {\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCSOURCE, source, -1, -1);\n\n\t\t\t\tif (sc->sc_open & ARIAR_OPEN_RECORD)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 1, -1, -1);\n\t\t\t\telse \n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 0, -1, -1);\n\t\t\t}\n\t\t}\n\n\t\tif (sc->sc_chans==2) {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, (sc->gain[0]+sc->gain[1])/2, -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, (sc->gain[0]-sc->gain[1])/4+0x40, -1, -1);\n\t\t} else {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, sc->gain[0], -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, 0x40, -1, -1);\n\t\t}\n\n\t\t/* aria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1 | (1<<8), -1, -1); */\n\t\taria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1, -1, -1);\n\n\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, 0x0004, sc->ariamix_master.level[0] << 7, sc->ariamix_master.level[1] << 7);\n\n\t\t/* Convert treb/bass from byte to soundcard style */\n\n\t\tleft  = tones[(sc->ariamix_master.bass[0]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[0]>>4)&0x0f];\n\t\tright = tones[(sc->ariamix_master.bass[1]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[1]>>4)&0x0f];\n\n\t\taria_sendcmd(iobase, ARIADSPC_TONE, left, right, -1);\n\t}\n\n\tif (sc->sc_change != 0)\n\t\taria_sendcmd(iobase, ARIADSPC_BLOCKSIZE, sc->sc_blocksize/2, -1, -1);\n\n/*\n * If we think that the card is recording or playing, start it up again here.\n * Some of the previous commands turn the channels off.\n */\n\n\tif (sc->sc_record&(1<<ARIAR_RECORD_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_REC, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tif (sc->sc_play&(1<<ARIAR_PLAY_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_PLAY, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_PLAY_CHAN);\n\t}\n\n\tsc->sc_change = 0;\n\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_round_blocksize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "747-760",
    "snippet": "int\naria_round_blocksize(addr, blk)\n\tvoid *addr;\n\tint blk;\n{\n\tint i;\n        struct aria_softc *sc = addr;\n\tfor (i=64; i<1024; i*=2)\n\t\tif (blk <= i)\n\t\t\tbreak;\n\tsc->sc_blocksize = i;\n\tsc->sc_change = 1;\n\treturn(i);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_round_blocksize(addr, blk)\n\tvoid *addr;\n\tint blk;\n{\n\tint i;\n        struct aria_softc *sc = addr;\n\tfor (i=64; i<1024; i*=2)\n\t\tif (blk <= i)\n\t\t\tbreak;\n\tsc->sc_blocksize = i;\n\tsc->sc_change = 1;\n\treturn(i);\n}"
  },
  {
    "function_name": "aria_speaker_ctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "733-739",
    "snippet": "int\naria_speaker_ctl(addr, newstate)\n\tvoid *addr;\n\tint newstate;\n{\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_speaker_ctl(addr, newstate)\n\tvoid *addr;\n\tint newstate;\n{\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_get_in_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "717-726",
    "snippet": "int\naria_get_in_port(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_in_port\\n\"));\n\n\treturn(sc->aria_mix_source);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_get_in_port\\n\")"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_get_in_port(addr)\n\tvoid *addr;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_in_port\\n\"));\n\n\treturn(sc->aria_mix_source);\n}"
  },
  {
    "function_name": "aria_set_in_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "701-715",
    "snippet": "int\naria_set_in_port(addr, port)\n\tvoid *addr;\n\tint port;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_set_in_port\\n\"));\n\n\tif (port<0 || port>6)\n\t\treturn ENXIO;\n\n\tsc->aria_mix_source = port;\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_set_in_port\\n\")"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_set_in_port(addr, port)\n\tvoid *addr;\n\tint port;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_set_in_port\\n\"));\n\n\tif (port<0 || port>6)\n\t\treturn ENXIO;\n\n\tsc->aria_mix_source = port;\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_get_out_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "692-698",
    "snippet": "int\naria_get_out_port(addr)\n\tvoid *addr;\n{\n\tDPRINTF((\"aria_get_out_port\\n\"));\n\treturn(ARIAMIX_OUT_LVL);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_get_out_port\\n\")"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_get_out_port(addr)\n\tvoid *addr;\n{\n\tDPRINTF((\"aria_get_out_port\\n\"));\n\treturn(ARIAMIX_OUT_LVL);\n}"
  },
  {
    "function_name": "aria_set_out_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "683-690",
    "snippet": "int\naria_set_out_port(addr, port)\n\tvoid *addr;\n\tint port;\n{\n\tDPRINTF((\"aria_set_out_port\\n\"));\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_set_out_port\\n\")"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_set_out_port(addr, port)\n\tvoid *addr;\n\tint port;\n{\n\tDPRINTF((\"aria_set_out_port\\n\"));\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_get_channels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "668-677",
    "snippet": "int\naria_get_channels(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_channels\\n\"));\n\n\treturn sc->sc_chans;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_get_channels\\n\")"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_get_channels(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_channels\\n\"));\n\n\treturn sc->sc_chans;\n}"
  },
  {
    "function_name": "aria_set_channels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "651-666",
    "snippet": "int\naria_set_channels(addr, chans)\n\tvoid *addr;\n\tint chans;\n{\n        struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_set_channels\\n\"));\n\n\tif (chans != 1 && chans != 2)\n\t\treturn EINVAL;\n\n\tsc->sc_chans = chans;\n\n\treturn(0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_set_channels\\n\")"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_set_channels(addr, chans)\n\tvoid *addr;\n\tint chans;\n{\n        struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_set_channels\\n\"));\n\n\tif (chans != 1 && chans != 2)\n\t\treturn EINVAL;\n\n\tsc->sc_chans = chans;\n\n\treturn(0);\n}"
  },
  {
    "function_name": "aria_get_precision",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "640-649",
    "snippet": "int\naria_get_precision(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_precision\\n\"));\n\n\treturn sc->sc_precision;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_get_precision\\n\")"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_get_precision(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_precision\\n\"));\n\n\treturn sc->sc_precision;\n}"
  },
  {
    "function_name": "aria_get_encoding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "629-638",
    "snippet": "int\naria_get_encoding(addr)\n\tvoid *addr;\n{\n        register struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_encoding\\n\"));\n\n        return(sc->encoding);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_get_encoding\\n\")"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_get_encoding(addr)\n\tvoid *addr;\n{\n        register struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_get_encoding\\n\"));\n\n        return(sc->encoding);\n}"
  },
  {
    "function_name": "aria_set_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "600-627",
    "snippet": "int\naria_set_format(addr, enc, precision)\n\tvoid *addr;\n\tu_int enc, prec;\n{\n        register struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_set_format\\n\"));\n\n        switch(enc){\n        case AUDIO_ENCODING_ULAW:\n        case AUDIO_ENCODING_PCM16:\n\tcase AUDIO_ENCODING_PCM8:\n\t\tbreak;\n        default:\n                return (EINVAL);\n        }\n\n\tif (prec!=8 && prec!=16)\n\t\treturn (EINVAL);\n\n\tif (sc->encoding!=AUDIO_ENCODING_PCM16 && prec==16)\n\t\treturn (EINVAL);\n\n\tsc->sc_encoding = enc;\n\tsc->sc_precision = prec;\n        return (0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_set_format\\n\")"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_set_format(addr, enc, precision)\n\tvoid *addr;\n\tu_int enc, prec;\n{\n        register struct aria_softc *sc = addr;\n\n\tDPRINTF((\"aria_set_format\\n\"));\n\n        switch(enc){\n        case AUDIO_ENCODING_ULAW:\n        case AUDIO_ENCODING_PCM16:\n\tcase AUDIO_ENCODING_PCM8:\n\t\tbreak;\n        default:\n                return (EINVAL);\n        }\n\n\tif (prec!=8 && prec!=16)\n\t\treturn (EINVAL);\n\n\tif (sc->encoding!=AUDIO_ENCODING_PCM16 && prec==16)\n\t\treturn (EINVAL);\n\n\tsc->sc_encoding = enc;\n\tsc->sc_precision = prec;\n        return (0);\n}"
  },
  {
    "function_name": "aria_query_encoding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "576-598",
    "snippet": "int\naria_query_encoding(addr, fp)\n    void *addr;\n    struct audio_encoding *fp;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tswitch (fp->index) {\n\t\tcase 0:\n\t\t\tstrcpy(fp->name, AudioEmulaw);\n\t\t\tfp->format_id = AUDIO_ENCODING_ULAW;\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tstrcpy(fp->name, AudioEpcm16);\n\t\t\tfp->format_id = AUDIO_ENCODING_PCM16;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn(EINVAL);\n\t\t/*NOTREACHED*/\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEpcm16"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEmulaw"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_query_encoding(addr, fp)\n    void *addr;\n    struct audio_encoding *fp;\n{\n\tregister struct aria_softc *sc = addr;\n\n\tswitch (fp->index) {\n\t\tcase 0:\n\t\t\tstrcpy(fp->name, AudioEmulaw);\n\t\t\tfp->format_id = AUDIO_ENCODING_ULAW;\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tstrcpy(fp->name, AudioEpcm16);\n\t\t\tfp->format_id = AUDIO_ENCODING_PCM16;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn(EINVAL);\n\t\t/*NOTREACHED*/\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "aria_get_sr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "568-574",
    "snippet": "u_long\naria_get_sr(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\treturn sc->sc_rate;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nu_long\naria_get_sr(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\treturn sc->sc_rate;\n}"
  },
  {
    "function_name": "aria_set_sr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "544-566",
    "snippet": "int\naria_set_sr(addr, sr)\n\tvoid *addr;\n\tu_long sr;\n{\n        struct aria_softc *sc = addr;\n\n\tif (sr<=9000)\n\t\tsr = 7875;\n\telse if (sr<=15000)\n\t\tsr = 11025;\n\telse if (sr<=20000)\n\t\tsr = 15750;\n\telse if (sr<=25000)\n\t\tsr = 22050;\n\telse if (sr<=40000)\n\t\tsr = 31500;\n\telse\n\t\tsr = 44100;\n\n\tsc->sc_rate = sr;\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_set_sr(addr, sr)\n\tvoid *addr;\n\tu_long sr;\n{\n        struct aria_softc *sc = addr;\n\n\tif (sr<=9000)\n\t\tsr = 7875;\n\telse if (sr<=15000)\n\t\tsr = 11025;\n\telse if (sr<=20000)\n\t\tsr = 15750;\n\telse if (sr<=25000)\n\t\tsr = 22050;\n\telse if (sr<=40000)\n\t\tsr = 31500;\n\telse\n\t\tsr = 44100;\n\n\tsc->sc_rate = sr;\n\treturn 0;\n}"
  },
  {
    "function_name": "aria_printsc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "528-536",
    "snippet": "void\naria_printsc(struct aria_softc *sc)\n{\n\tprintf(\"open %x dmachan %d irq %d iobase %x nintr %d\\n\", sc->sc_open, sc->sc_drq,\n\t\tsc->sc_irq, sc->sc_iobase, sc->sc_interrupts);\n\tprintf(\"irate %d encoding %x chans %d\\n\", sc->sc_rate, sc->encoding,\n\t\tsc->sc_chans);\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nvoid\naria_printsc(struct aria_softc *sc)\n{\n\tprintf(\"open %x dmachan %d irq %d iobase %x nintr %d\\n\", sc->sc_open, sc->sc_drq,\n\t\tsc->sc_irq, sc->sc_iobase, sc->sc_interrupts);\n\tprintf(\"irate %d encoding %x chans %d\\n\", sc->sc_rate, sc->encoding,\n\t\tsc->sc_chans);\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "aria_getdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "518-525",
    "snippet": "int\naria_getdev(addr, retp)\n\tvoid *addr;\n\tstruct audio_device *retp;\n{\n\t*retp = aria_device;\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_getdev(addr, retp)\n\tvoid *addr;\n\tstruct audio_device *retp;\n{\n\t*retp = aria_device;\n\treturn 0;\n}"
  },
  {
    "function_name": "ariaopen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "482-516",
    "snippet": "int\nariaopen(dev, flags)\n\tdev_t dev;\n\tint flags;\n{\n\tstruct aria_softc *sc;\n\tregister u_short iobase = sc->sc_iobase;\n\tint unit = AUDIOUNIT(dev);\n\tshort err;\n\n\tDPRINTF((\"ariaopen() called\\n\"));\n    \n\tif (unit >= aria_cd.cd_ndevs)\n\t\treturn ENODEV;\n    \n\tsc = aria_cd.cd_devs[unit];\n\n\tif (!sc || sc->sc_open != 0)\n\t\treturn ENXIO;\n    \n\tsc->sc_open  = 0;\n\tif (flags&FREAD)\n\t\tsc->sc_open |= ARIAR_OPEN_RECORD;\n\tif (flags&FWRITE)\n\t\tsc->sc_open |= ARIAR_OPEN_PLAY;\n\tsc->sc_play  = 0;\n\tsc->sc_record= 0;\n\tsc->sc_rintr = 0;\n\tsc->sc_rarg  = 0;\n\tsc->sc_pintr = 0;\n\tsc->sc_parg  = 0;\n\tsc->sc_change= 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [
      "#define FWRITE 2",
      "#define FREAD 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"ariaopen() called\\n\")"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUDIOUNIT",
          "args": [
            "dev"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\n#define FWRITE 2\n#define FREAD 1\n\nint\nariaopen(dev, flags)\n\tdev_t dev;\n\tint flags;\n{\n\tstruct aria_softc *sc;\n\tregister u_short iobase = sc->sc_iobase;\n\tint unit = AUDIOUNIT(dev);\n\tshort err;\n\n\tDPRINTF((\"ariaopen() called\\n\"));\n    \n\tif (unit >= aria_cd.cd_ndevs)\n\t\treturn ENODEV;\n    \n\tsc = aria_cd.cd_devs[unit];\n\n\tif (!sc || sc->sc_open != 0)\n\t\treturn ENXIO;\n    \n\tsc->sc_open  = 0;\n\tif (flags&FREAD)\n\t\tsc->sc_open |= ARIAR_OPEN_RECORD;\n\tif (flags&FWRITE)\n\t\tsc->sc_open |= ARIAR_OPEN_PLAY;\n\tsc->sc_play  = 0;\n\tsc->sc_record= 0;\n\tsc->sc_rintr = 0;\n\tsc->sc_rarg  = 0;\n\tsc->sc_pintr = 0;\n\tsc->sc_parg  = 0;\n\tsc->sc_change= 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ariaattach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "408-476",
    "snippet": "void\nariaattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct aria_softc *sc = (struct aria_softc *)self;\n\tstruct isa_attach_args *ia = (struct isa_attach_args *)aux;\n\tregister u_short iobase = ia->ia_iobase;\n\tregister u_short i;\n\tint err;\n\t\n\tsc->sc_ih = isa_intr_establish(ia->ia_ic, ia->ia_irq, IST_EDGE,\n\t    IPL_AUDIO, aria_intr, sc, sc->sc_dev.dv_xname);\n\n\ti = aria_getdspmem(iobase, ARIAA_HARDWARE_A);\n\n\tsc->sc_hardware  = 0;\n\tsc->sc_hardware |= ((i>>13)&0x01==1)?ARIA_TELEPHONE:0;\n\tsc->sc_hardware |= (((i>>5)&0x07)==0x04)?ARIA_MIXER:0;\n\tsc->sc_hardware |= (aria_getdspmem(iobase, ARIAA_MODEL_A)==1)?ARIA_MODEL:0;\n\n\tsc->sc_open       = 0;\n\tsc->sc_play       = 0;\n\tsc->sc_record     = 0;\n\tsc->sc_rate       = 7875;\n\tsc->sc_chans      = 1;\n\tsc->sc_change     = 1;\n\tsc->sc_blocksize  = 1024;\n\tsc->sc_precision  = 8;\n        sc->sc_rintr      = 0;\n        sc->sc_rarg       = 0;\n        sc->sc_pintr      = 0;\n        sc->sc_parg       = 0;\n\tsc->gain[0]       = 127;\n\tsc->gain[1]       = 127;\n\n\tfor (i=0; i<6; i++) {\n\t\tif (i == ARIAMIX_TEL_LVL)\n\t\t\tsc->aria_mix[i].num_channels = 1;\n\t\telse\n\t\t\tsc->aria_mix[i].num_channels = 2;\n\t\tsc->aria_mix[i].level[0] = 127;\n\t\tsc->aria_mix[i].level[1] = 127;\n\t}\n\n\tsc->ariamix_master.num_channels = 2;\n\tsc->ariamix_master.level[0] = 222;\n\tsc->ariamix_master.level[1] = 222;\n\tsc->ariamix_master.bass[0] = 127;\n\tsc->ariamix_master.bass[1] = 127;\n\tsc->ariamix_master.treble[0] = 127;\n\tsc->ariamix_master.treble[1] = 127;\n\tsc->aria_mix_source = 0;\n\n\tsc->sc_change = 1;\n\taria_commit_settings(sc); /* so that my cdplayer is at the 'right' vol */\n\n\tprintf(\": dsp %s\", (ARIA_MODEL&sc->sc_hardware)?\"SC18026\":\"SC18025\");\n\tif (ARIA_TELEPHONE&sc->sc_hardware)\n\t\tprintf(\", tel\");\n\tif (ARIA_MIXER&sc->sc_hardware)\n\t\tprintf(\", SC18075 mixer\");\n\tprintf(\"\\n\");\n\n\tsprintf(aria_device.version, \"%s\", (ARIA_MODEL&sc->sc_hardware?\"SC18026\":\"SC18025\"));\n\n\tif ((err = audio_hardware_attach(&aria_hw_if, sc)) != 0)\n\t\tprintf(\"aria: could not attach to audio pseudo-device driver (%d)\\n\", err);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [
      "#define ARIA_MODEL\t0x0004\t\t/* is SC18025 (=0) or SC18026 (=1) */",
      "#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */",
      "#define ARIA_TELEPHONE\t0x0001\t\t/* has telephone input */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"aria: could not attach to audio pseudo-device driver (%d)\\n\"",
            "err"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "audio_hardware_attach",
          "args": [
            "&aria_hw_if",
            "sc"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "aria_device.version",
            "\"%s\"",
            "(ARIA_MODEL&sc->sc_hardware?\"SC18026\":\"SC18025\")"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aria_commit_settings",
          "args": [
            "sc"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "aria_commit_settings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "766-871",
          "snippet": "int\naria_commit_settings(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\tregister u_short iobase = sc->sc_iobase;\n\tu_char tones[16] = { 7, 6, 5, 4, 3, 2, 1, 0, 8, 9, 10, 11, 12, 13, 14, 15 };\n\tu_short format;\n\tu_short left, right;\n\tu_short samp;\n\tu_char i;\n\n\tDPRINTF((\"aria_commit_settings\\n\"));\n\n\tswitch (sc->sc_rate) {\n\t\tcase  7875: format = 0x00; samp = 0x60; break;\n\t\tcase 11025: format = 0x00; samp = 0x40; break;\n\t\tcase 15750: format = 0x10; samp = 0x60; break;\n\t\tcase 22050: format = 0x10; samp = 0x40; break;\n\t\tcase 31500: format = 0x10; samp = 0x20; break;\n\t\tcase 44100: format = 0x20; samp = 0x00; break;\n\t\tdefault:    format = 0x00; samp = 0x40; break;\n\t}\n\n\tformat |= (sc->sc_chans==2)?1:0;\n\tformat |= (sc->sc_precision==16)?2:0;\n\n\taria_sendcmd(iobase, ARIADSPC_FORMAT, format, -1, -1);\n\toutw(iobase+ARIADSP_CONTROL, (inw(iobase+ARIADSP_STATUS)&~0x60)|samp); /* Addition parm for sample rate */\n\n\tif (sc->sc_hardware&ARIA_MIXER) {\n\t\tfor (i=0; i<6; i++) {\n\t\t\tu_char source;\n\t\t\tswitch(i) {\n\t\t\tcase ARIAMIX_MIC_LVL:     source = 0x0001; break;\n\t\t\tcase ARIAMIX_CD_LVL:      source = 0x0002; break;\n\t\t\tcase ARIAMIX_LINE_IN_LVL: source = 0x0008; break;\n\t\t\tcase ARIAMIX_TEL_LVL:     source = 0x0020; break;\n\t\t\tcase ARIAMIX_AUX_LVL:     source = 0x0010; break;\n\t\t\tcase ARIAMIX_DAC_LVL:     source = 0x0004; break;\n\t\t\tdefault:               source = 0x0000; break;\n\t\t\t}\n\t\t\t\t\n\t\t\tif (source != 0x0000 && source != 0x0004) {\n\t\t\t\tif (sc->aria_mix[i].mute == 1)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, 3, -1);\n\t\t\t\telse\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, (sc->aria_mix[i].num_channels==2)?0:1, -1); \n\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, 0x8000|source, (sc->aria_mix[i].num_channels==2)?0:1, -1);\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, source, sc->aria_mix[i].level[0] << 7, sc->aria_mix[i].level[1] << 7);\n\t\t\t}\n\n\t\t\tif (sc->aria_mix_source == i) {\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCSOURCE, source, -1, -1);\n\n\t\t\t\tif (sc->sc_open & ARIAR_OPEN_RECORD)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 1, -1, -1);\n\t\t\t\telse \n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 0, -1, -1);\n\t\t\t}\n\t\t}\n\n\t\tif (sc->sc_chans==2) {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, (sc->gain[0]+sc->gain[1])/2, -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, (sc->gain[0]-sc->gain[1])/4+0x40, -1, -1);\n\t\t} else {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, sc->gain[0], -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, 0x40, -1, -1);\n\t\t}\n\n\t\t/* aria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1 | (1<<8), -1, -1); */\n\t\taria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1, -1, -1);\n\n\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, 0x0004, sc->ariamix_master.level[0] << 7, sc->ariamix_master.level[1] << 7);\n\n\t\t/* Convert treb/bass from byte to soundcard style */\n\n\t\tleft  = tones[(sc->ariamix_master.bass[0]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[0]>>4)&0x0f];\n\t\tright = tones[(sc->ariamix_master.bass[1]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[1]>>4)&0x0f];\n\n\t\taria_sendcmd(iobase, ARIADSPC_TONE, left, right, -1);\n\t}\n\n\tif (sc->sc_change != 0)\n\t\taria_sendcmd(iobase, ARIADSPC_BLOCKSIZE, sc->sc_blocksize/2, -1, -1);\n\n/*\n * If we think that the card is recording or playing, start it up again here.\n * Some of the previous commands turn the channels off.\n */\n\n\tif (sc->sc_record&(1<<ARIAR_RECORD_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_REC, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tif (sc->sc_play&(1<<ARIAR_PLAY_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_PLAY, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_PLAY_CHAN);\n\t}\n\n\tsc->sc_change = 0;\n\n\treturn(0);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [
            "#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\n#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */\n\nint\naria_commit_settings(addr)\n\tvoid *addr;\n{\n        struct aria_softc *sc = addr;\n\tregister u_short iobase = sc->sc_iobase;\n\tu_char tones[16] = { 7, 6, 5, 4, 3, 2, 1, 0, 8, 9, 10, 11, 12, 13, 14, 15 };\n\tu_short format;\n\tu_short left, right;\n\tu_short samp;\n\tu_char i;\n\n\tDPRINTF((\"aria_commit_settings\\n\"));\n\n\tswitch (sc->sc_rate) {\n\t\tcase  7875: format = 0x00; samp = 0x60; break;\n\t\tcase 11025: format = 0x00; samp = 0x40; break;\n\t\tcase 15750: format = 0x10; samp = 0x60; break;\n\t\tcase 22050: format = 0x10; samp = 0x40; break;\n\t\tcase 31500: format = 0x10; samp = 0x20; break;\n\t\tcase 44100: format = 0x20; samp = 0x00; break;\n\t\tdefault:    format = 0x00; samp = 0x40; break;\n\t}\n\n\tformat |= (sc->sc_chans==2)?1:0;\n\tformat |= (sc->sc_precision==16)?2:0;\n\n\taria_sendcmd(iobase, ARIADSPC_FORMAT, format, -1, -1);\n\toutw(iobase+ARIADSP_CONTROL, (inw(iobase+ARIADSP_STATUS)&~0x60)|samp); /* Addition parm for sample rate */\n\n\tif (sc->sc_hardware&ARIA_MIXER) {\n\t\tfor (i=0; i<6; i++) {\n\t\t\tu_char source;\n\t\t\tswitch(i) {\n\t\t\tcase ARIAMIX_MIC_LVL:     source = 0x0001; break;\n\t\t\tcase ARIAMIX_CD_LVL:      source = 0x0002; break;\n\t\t\tcase ARIAMIX_LINE_IN_LVL: source = 0x0008; break;\n\t\t\tcase ARIAMIX_TEL_LVL:     source = 0x0020; break;\n\t\t\tcase ARIAMIX_AUX_LVL:     source = 0x0010; break;\n\t\t\tcase ARIAMIX_DAC_LVL:     source = 0x0004; break;\n\t\t\tdefault:               source = 0x0000; break;\n\t\t\t}\n\t\t\t\t\n\t\t\tif (source != 0x0000 && source != 0x0004) {\n\t\t\t\tif (sc->aria_mix[i].mute == 1)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, 3, -1);\n\t\t\t\telse\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, source, (sc->aria_mix[i].num_channels==2)?0:1, -1); \n\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_INPMONMODE, 0x8000|source, (sc->aria_mix[i].num_channels==2)?0:1, -1);\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, source, sc->aria_mix[i].level[0] << 7, sc->aria_mix[i].level[1] << 7);\n\t\t\t}\n\n\t\t\tif (sc->aria_mix_source == i) {\n\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCSOURCE, source, -1, -1);\n\n\t\t\t\tif (sc->sc_open & ARIAR_OPEN_RECORD)\n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 1, -1, -1);\n\t\t\t\telse \n\t\t\t\t\taria_sendcmd(iobase, ARIADSPC_ADCCONTROL, 0, -1, -1);\n\t\t\t}\n\t\t}\n\n\t\tif (sc->sc_chans==2) {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, (sc->gain[0]+sc->gain[1])/2, -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, (sc->gain[0]-sc->gain[1])/4+0x40, -1, -1);\n\t\t} else {\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_VOL, sc->gain[0], -1, -1);\n\t\t\taria_sendcmd(iobase, ARIADSPC_CHAN_PAN, 0x40, -1, -1);\n\t\t}\n\n\t\t/* aria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1 | (1<<8), -1, -1); */\n\t\taria_sendcmd(iobase, ARIADSPC_MASMONMODE, (sc->ariamix_master.num_channels==2)?0:1, -1, -1);\n\n\t\taria_sendcmd(iobase, ARIADSPC_MIXERVOL, 0x0004, sc->ariamix_master.level[0] << 7, sc->ariamix_master.level[1] << 7);\n\n\t\t/* Convert treb/bass from byte to soundcard style */\n\n\t\tleft  = tones[(sc->ariamix_master.bass[0]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[0]>>4)&0x0f];\n\t\tright = tones[(sc->ariamix_master.bass[1]>>4)&0x0f]<<8 | tones[(sc->ariamix_master.treble[1]>>4)&0x0f];\n\n\t\taria_sendcmd(iobase, ARIADSPC_TONE, left, right, -1);\n\t}\n\n\tif (sc->sc_change != 0)\n\t\taria_sendcmd(iobase, ARIADSPC_BLOCKSIZE, sc->sc_blocksize/2, -1, -1);\n\n/*\n * If we think that the card is recording or playing, start it up again here.\n * Some of the previous commands turn the channels off.\n */\n\n\tif (sc->sc_record&(1<<ARIAR_RECORD_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_REC, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_RECORD_CHAN);\n\t}\n\n\tif (sc->sc_play&(1<<ARIAR_PLAY_CHAN)) {\n\t\taria_sendcmd(iobase, ARIADSPC_START_PLAY, ARIAR_PLAY_CHAN, -1, -1);\n\t\tsc->sc_play |= (1<<ARIAR_PLAY_CHAN);\n\t}\n\n\tsc->sc_change = 0;\n\n\treturn(0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aria_getdspmem",
          "args": [
            "iobase",
            "ARIAA_MODEL_A"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "aria_getdspmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "945-952",
          "snippet": "u_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nu_short\naria_getdspmem(iobase, loc)\n\tregister u_short iobase;\n\tregister u_short loc;\n{\n\toutw(iobase+ARIADSP_DMAADDRESS, loc);\n\treturn inw(iobase+ARIADSP_DMADATA);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isa_intr_establish",
          "args": [
            "ia->ia_ic",
            "ia->ia_irq",
            "IST_EDGE",
            "IPL_AUDIO",
            "aria_intr",
            "sc",
            "sc->sc_dev.dv_xname"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\n#define ARIA_MODEL\t0x0004\t\t/* is SC18025 (=0) or SC18026 (=1) */\n#define ARIA_MIXER\t0x0002\t\t/* has SC18075 digital mixer */\n#define ARIA_TELEPHONE\t0x0001\t\t/* has telephone input */\n\nvoid\nariaattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct aria_softc *sc = (struct aria_softc *)self;\n\tstruct isa_attach_args *ia = (struct isa_attach_args *)aux;\n\tregister u_short iobase = ia->ia_iobase;\n\tregister u_short i;\n\tint err;\n\t\n\tsc->sc_ih = isa_intr_establish(ia->ia_ic, ia->ia_irq, IST_EDGE,\n\t    IPL_AUDIO, aria_intr, sc, sc->sc_dev.dv_xname);\n\n\ti = aria_getdspmem(iobase, ARIAA_HARDWARE_A);\n\n\tsc->sc_hardware  = 0;\n\tsc->sc_hardware |= ((i>>13)&0x01==1)?ARIA_TELEPHONE:0;\n\tsc->sc_hardware |= (((i>>5)&0x07)==0x04)?ARIA_MIXER:0;\n\tsc->sc_hardware |= (aria_getdspmem(iobase, ARIAA_MODEL_A)==1)?ARIA_MODEL:0;\n\n\tsc->sc_open       = 0;\n\tsc->sc_play       = 0;\n\tsc->sc_record     = 0;\n\tsc->sc_rate       = 7875;\n\tsc->sc_chans      = 1;\n\tsc->sc_change     = 1;\n\tsc->sc_blocksize  = 1024;\n\tsc->sc_precision  = 8;\n        sc->sc_rintr      = 0;\n        sc->sc_rarg       = 0;\n        sc->sc_pintr      = 0;\n        sc->sc_parg       = 0;\n\tsc->gain[0]       = 127;\n\tsc->gain[1]       = 127;\n\n\tfor (i=0; i<6; i++) {\n\t\tif (i == ARIAMIX_TEL_LVL)\n\t\t\tsc->aria_mix[i].num_channels = 1;\n\t\telse\n\t\t\tsc->aria_mix[i].num_channels = 2;\n\t\tsc->aria_mix[i].level[0] = 127;\n\t\tsc->aria_mix[i].level[1] = 127;\n\t}\n\n\tsc->ariamix_master.num_channels = 2;\n\tsc->ariamix_master.level[0] = 222;\n\tsc->ariamix_master.level[1] = 222;\n\tsc->ariamix_master.bass[0] = 127;\n\tsc->ariamix_master.bass[1] = 127;\n\tsc->ariamix_master.treble[0] = 127;\n\tsc->ariamix_master.treble[1] = 127;\n\tsc->aria_mix_source = 0;\n\n\tsc->sc_change = 1;\n\taria_commit_settings(sc); /* so that my cdplayer is at the 'right' vol */\n\n\tprintf(\": dsp %s\", (ARIA_MODEL&sc->sc_hardware)?\"SC18026\":\"SC18025\");\n\tif (ARIA_TELEPHONE&sc->sc_hardware)\n\t\tprintf(\", tel\");\n\tif (ARIA_MIXER&sc->sc_hardware)\n\t\tprintf(\", SC18075 mixer\");\n\tprintf(\"\\n\");\n\n\tsprintf(aria_device.version, \"%s\", (ARIA_MODEL&sc->sc_hardware?\"SC18026\":\"SC18025\"));\n\n\tif ((err = audio_hardware_attach(&aria_hw_if, sc)) != 0)\n\t\tprintf(\"aria: could not attach to audio pseudo-device driver (%d)\\n\", err);\n}"
  },
  {
    "function_name": "aria_do_kludge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "380-402",
    "snippet": "void\naria_do_kludge(func, bits, and, or, rba)\n\tu_short func;\n\tu_short bits;\n\tu_short and;\n\tu_short or;\n\tu_short rba;\n{\n\tu_int i;\n\tif (func & 0x100) {\n\t\tfunc &= ~0x100;\n\t\tif (bits) {\n\t\t\toutw(0x200, func-1);\n\t\t\toutb(0x201, bits);\n\t\t}\n\t} else\n\t\tor |= bits;\n\n\toutb(0x200, func);\n\ti = inb(rba);\n\toutw(0x200, func);\n\toutb(0x201, (i&and) | or);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "outb",
          "args": [
            "0x201",
            "(i&and) | or"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "ee16_eeprom_outbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ie.c",
          "lines": "1718-1740",
          "snippet": "void\nee16_eeprom_outbits(sc, edata, count)\n\tstruct ie_softc *sc;\n\tint edata, count;\n{\n\tint ectrl, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (i = count - 1; i >= 0; i--) {\n\t\tectrl &= ~IEE16_ECTRL_EEDI;\n\t\tif (edata & (1 << i)) {\n\t\t\tectrl |= IEE16_ECTRL_EEDI;\n\t\t}\n\t\toutb(PORT + IEE16_ECTRL, ectrl);\n\t\tdelay(1);\t/* eeprom data must be setup for 0.4 uSec */\n\t\tee16_eeprom_clock(sc, 1);\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\tectrl &= ~IEE16_ECTRL_EEDI;\n\toutb(PORT + IEE16_ECTRL, ectrl);\n\tdelay(1);\t\t/* eeprom data must be held for 0.4 uSec */\n}",
          "includes": [
            "#include <dev/isa/elink.h>",
            "#include <dev/isa/if_iee16.h>",
            "#include <dev/isa/if_ie507.h>",
            "#include <dev/isa/if_ieatt.h>",
            "#include <dev/ic/i82586reg.h>",
            "#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/pio.h>\t\t/* XXX convert this driver! */",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/protosw.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define PORT\tsc->sc_iobase"
          ],
          "globals_used": [
            "void ee16_eeprom_outbits",
            "void ee16_eeprom_clock",
            "struct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/elink.h>\n#include <dev/isa/if_iee16.h>\n#include <dev/isa/if_ie507.h>\n#include <dev/isa/if_ieatt.h>\n#include <dev/ic/i82586reg.h>\n#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/pio.h>\t\t/* XXX convert this driver! */\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/protosw.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define PORT\tsc->sc_iobase\n\nvoid ee16_eeprom_outbits;\nvoid ee16_eeprom_clock;\nstruct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;\n\nvoid\nee16_eeprom_outbits(sc, edata, count)\n\tstruct ie_softc *sc;\n\tint edata, count;\n{\n\tint ectrl, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (i = count - 1; i >= 0; i--) {\n\t\tectrl &= ~IEE16_ECTRL_EEDI;\n\t\tif (edata & (1 << i)) {\n\t\t\tectrl |= IEE16_ECTRL_EEDI;\n\t\t}\n\t\toutb(PORT + IEE16_ECTRL, ectrl);\n\t\tdelay(1);\t/* eeprom data must be setup for 0.4 uSec */\n\t\tee16_eeprom_clock(sc, 1);\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\tectrl &= ~IEE16_ECTRL_EEDI;\n\toutb(PORT + IEE16_ECTRL, ectrl);\n\tdelay(1);\t\t/* eeprom data must be held for 0.4 uSec */\n}"
        }
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "0x200",
            "func"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inb",
          "args": [
            "rba"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "ee16_eeprom_inbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ie.c",
          "lines": "1742-1760",
          "snippet": "int\nee16_eeprom_inbits(sc)\n\tstruct ie_softc *sc;\n{\n\tint ectrl, edata, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (edata = 0, i = 0; i < 16; i++) {\n\t\tedata = edata << 1;\n\t\tee16_eeprom_clock(sc, 1);\n\t\tectrl = inb(PORT + IEE16_ECTRL);\n\t\tif (ectrl & IEE16_ECTRL_EEDO) {\n\t\t\tedata |= 1;\n\t\t}\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\treturn (edata);\n}",
          "includes": [
            "#include <dev/isa/elink.h>",
            "#include <dev/isa/if_iee16.h>",
            "#include <dev/isa/if_ie507.h>",
            "#include <dev/isa/if_ieatt.h>",
            "#include <dev/ic/i82586reg.h>",
            "#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/pio.h>\t\t/* XXX convert this driver! */",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/protosw.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define PORT\tsc->sc_iobase"
          ],
          "globals_used": [
            "void ee16_eeprom_clock",
            "int ee16_eeprom_inbits",
            "struct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/elink.h>\n#include <dev/isa/if_iee16.h>\n#include <dev/isa/if_ie507.h>\n#include <dev/isa/if_ieatt.h>\n#include <dev/ic/i82586reg.h>\n#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/pio.h>\t\t/* XXX convert this driver! */\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/protosw.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define PORT\tsc->sc_iobase\n\nvoid ee16_eeprom_clock;\nint ee16_eeprom_inbits;\nstruct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;\n\nint\nee16_eeprom_inbits(sc)\n\tstruct ie_softc *sc;\n{\n\tint ectrl, edata, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (edata = 0, i = 0; i < 16; i++) {\n\t\tedata = edata << 1;\n\t\tee16_eeprom_clock(sc, 1);\n\t\tectrl = inb(PORT + IEE16_ECTRL);\n\t\tif (ectrl & IEE16_ECTRL_EEDO) {\n\t\t\tedata |= 1;\n\t\t}\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\treturn (edata);\n}"
        }
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "0x200",
            "func-1"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nvoid\naria_do_kludge(func, bits, and, or, rba)\n\tu_short func;\n\tu_short bits;\n\tu_short and;\n\tu_short or;\n\tu_short rba;\n{\n\tu_int i;\n\tif (func & 0x100) {\n\t\tfunc &= ~0x100;\n\t\tif (bits) {\n\t\t\toutw(0x200, func-1);\n\t\t\toutb(0x201, bits);\n\t\t}\n\t} else\n\t\tor |= bits;\n\n\toutb(0x200, func);\n\ti = inb(rba);\n\toutw(0x200, func);\n\toutb(0x201, (i&and) | or);\n}"
  },
  {
    "function_name": "aria_prometheus_kludge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "331-378",
    "snippet": "void\naria_prometheus_kludge(ia)\n\tregister struct isa_attach_args *ia;\n{\n\tint\ti, j;\n\tu_short\tend;\n\tu_short rba = ia->ia_iobase;\n\n\tDPRINTF((\"aria_prometheus_kludge\\n\"));\n\n/* Begin Config Sequence */\n\n        outb(0x204, 0x4c);\n        outb(0x205, 0x42);\n        outb(0x206, 0x00);\n        outw(0x200, 0x0f);\n        outb(0x201, 0x00);\n        outw(0x200, 0x02);\n        outb(0x201, rba>>2);\n\n/* These next three lines set up the iobase, and the irq; and disable the drq.  */\n\n\taria_do_kludge(0x111, ((ia->ia_iobase-0x280)>>2)+0xA0, 0xbf, 0xa0, rba);\n\taria_do_kludge(0x011, ia->ia_irq-6, 0xf8, 0x00, rba);\n\taria_do_kludge(0x011, 0x00, 0xef, 0x00, rba);\n\n/* The rest of these lines just disable everything else */\n\n\taria_do_kludge(0x113, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xf8, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xef, 0x00, rba);\n\taria_do_kludge(0x117, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x017, 0x00, 0xff, 0x00, rba);\n\n/* End Sequence */\n\n\toutb(0x200, 0x0f);\n\tend = inb(rba);\n\toutw(0x200, 0x0f);\n\toutb(0x201, end|0x80);\n\tinb(0x200);\n/*\n * This delay is necessary for some reason,\n * at least it would crash, and sometimes not\n * probe properly if it did not exist.\n */\n\tdelay(1000000);\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "1000000"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inb",
          "args": [
            "0x200"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "ee16_eeprom_inbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ie.c",
          "lines": "1742-1760",
          "snippet": "int\nee16_eeprom_inbits(sc)\n\tstruct ie_softc *sc;\n{\n\tint ectrl, edata, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (edata = 0, i = 0; i < 16; i++) {\n\t\tedata = edata << 1;\n\t\tee16_eeprom_clock(sc, 1);\n\t\tectrl = inb(PORT + IEE16_ECTRL);\n\t\tif (ectrl & IEE16_ECTRL_EEDO) {\n\t\t\tedata |= 1;\n\t\t}\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\treturn (edata);\n}",
          "includes": [
            "#include <dev/isa/elink.h>",
            "#include <dev/isa/if_iee16.h>",
            "#include <dev/isa/if_ie507.h>",
            "#include <dev/isa/if_ieatt.h>",
            "#include <dev/ic/i82586reg.h>",
            "#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/pio.h>\t\t/* XXX convert this driver! */",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/protosw.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define PORT\tsc->sc_iobase"
          ],
          "globals_used": [
            "void ee16_eeprom_clock",
            "int ee16_eeprom_inbits",
            "struct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/elink.h>\n#include <dev/isa/if_iee16.h>\n#include <dev/isa/if_ie507.h>\n#include <dev/isa/if_ieatt.h>\n#include <dev/ic/i82586reg.h>\n#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/pio.h>\t\t/* XXX convert this driver! */\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/protosw.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define PORT\tsc->sc_iobase\n\nvoid ee16_eeprom_clock;\nint ee16_eeprom_inbits;\nstruct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;\n\nint\nee16_eeprom_inbits(sc)\n\tstruct ie_softc *sc;\n{\n\tint ectrl, edata, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (edata = 0, i = 0; i < 16; i++) {\n\t\tedata = edata << 1;\n\t\tee16_eeprom_clock(sc, 1);\n\t\tectrl = inb(PORT + IEE16_ECTRL);\n\t\tif (ectrl & IEE16_ECTRL_EEDO) {\n\t\t\tedata |= 1;\n\t\t}\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\treturn (edata);\n}"
        }
      },
      {
        "call_info": {
          "callee": "outb",
          "args": [
            "0x201",
            "end|0x80"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "ee16_eeprom_outbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/if_ie.c",
          "lines": "1718-1740",
          "snippet": "void\nee16_eeprom_outbits(sc, edata, count)\n\tstruct ie_softc *sc;\n\tint edata, count;\n{\n\tint ectrl, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (i = count - 1; i >= 0; i--) {\n\t\tectrl &= ~IEE16_ECTRL_EEDI;\n\t\tif (edata & (1 << i)) {\n\t\t\tectrl |= IEE16_ECTRL_EEDI;\n\t\t}\n\t\toutb(PORT + IEE16_ECTRL, ectrl);\n\t\tdelay(1);\t/* eeprom data must be setup for 0.4 uSec */\n\t\tee16_eeprom_clock(sc, 1);\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\tectrl &= ~IEE16_ECTRL_EEDI;\n\toutb(PORT + IEE16_ECTRL, ectrl);\n\tdelay(1);\t\t/* eeprom data must be held for 0.4 uSec */\n}",
          "includes": [
            "#include <dev/isa/elink.h>",
            "#include <dev/isa/if_iee16.h>",
            "#include <dev/isa/if_ie507.h>",
            "#include <dev/isa/if_ieatt.h>",
            "#include <dev/ic/i82586reg.h>",
            "#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/pio.h>\t\t/* XXX convert this driver! */",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include <net/route.h>",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/protosw.h>",
            "#include <sys/buf.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [
            "#define PORT\tsc->sc_iobase"
          ],
          "globals_used": [
            "void ee16_eeprom_outbits",
            "void ee16_eeprom_clock",
            "struct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/elink.h>\n#include <dev/isa/if_iee16.h>\n#include <dev/isa/if_ie507.h>\n#include <dev/isa/if_ieatt.h>\n#include <dev/ic/i82586reg.h>\n#include <i386/isa/isa_machdep.h>\t/* XXX USES ISA HOLE DIRECTLY */\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/pio.h>\t\t/* XXX convert this driver! */\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include <net/route.h>\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/protosw.h>\n#include <sys/buf.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\n#define PORT\tsc->sc_iobase\n\nvoid ee16_eeprom_outbits;\nvoid ee16_eeprom_clock;\nstruct mbuf *\nieget(sc, ehp, to_bpf)\n\tstruct ie_softc *sc;\n\nvoid\nee16_eeprom_outbits(sc, edata, count)\n\tstruct ie_softc *sc;\n\tint edata, count;\n{\n\tint ectrl, i;\n\n\tectrl = inb(PORT + IEE16_ECTRL);\n\tectrl &= ~IEE16_RESET_ASIC;\n\tfor (i = count - 1; i >= 0; i--) {\n\t\tectrl &= ~IEE16_ECTRL_EEDI;\n\t\tif (edata & (1 << i)) {\n\t\t\tectrl |= IEE16_ECTRL_EEDI;\n\t\t}\n\t\toutb(PORT + IEE16_ECTRL, ectrl);\n\t\tdelay(1);\t/* eeprom data must be setup for 0.4 uSec */\n\t\tee16_eeprom_clock(sc, 1);\n\t\tee16_eeprom_clock(sc, 0);\n\t}\n\tectrl &= ~IEE16_ECTRL_EEDI;\n\toutb(PORT + IEE16_ECTRL, ectrl);\n\tdelay(1);\t\t/* eeprom data must be held for 0.4 uSec */\n}"
        }
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "0x200",
            "0x0f"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aria_do_kludge",
          "args": [
            "0x017",
            "0x00",
            "0xff",
            "0x00",
            "rba"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "aria_do_kludge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "380-402",
          "snippet": "void\naria_do_kludge(func, bits, and, or, rba)\n\tu_short func;\n\tu_short bits;\n\tu_short and;\n\tu_short or;\n\tu_short rba;\n{\n\tu_int i;\n\tif (func & 0x100) {\n\t\tfunc &= ~0x100;\n\t\tif (bits) {\n\t\t\toutw(0x200, func-1);\n\t\t\toutb(0x201, bits);\n\t\t}\n\t} else\n\t\tor |= bits;\n\n\toutb(0x200, func);\n\ti = inb(rba);\n\toutw(0x200, func);\n\toutb(0x201, (i&and) | or);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nvoid\naria_do_kludge(func, bits, and, or, rba)\n\tu_short func;\n\tu_short bits;\n\tu_short and;\n\tu_short or;\n\tu_short rba;\n{\n\tu_int i;\n\tif (func & 0x100) {\n\t\tfunc &= ~0x100;\n\t\tif (bits) {\n\t\t\toutw(0x200, func-1);\n\t\t\toutb(0x201, bits);\n\t\t}\n\t} else\n\t\tor |= bits;\n\n\toutb(0x200, func);\n\ti = inb(rba);\n\toutw(0x200, func);\n\toutb(0x201, (i&and) | or);\n}"
        }
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "0x200",
            "0x02"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outw",
          "args": [
            "0x200",
            "0x0f"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria_prometheus_kludge\\n\")"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nvoid\naria_prometheus_kludge(ia)\n\tregister struct isa_attach_args *ia;\n{\n\tint\ti, j;\n\tu_short\tend;\n\tu_short rba = ia->ia_iobase;\n\n\tDPRINTF((\"aria_prometheus_kludge\\n\"));\n\n/* Begin Config Sequence */\n\n        outb(0x204, 0x4c);\n        outb(0x205, 0x42);\n        outb(0x206, 0x00);\n        outw(0x200, 0x0f);\n        outb(0x201, 0x00);\n        outw(0x200, 0x02);\n        outb(0x201, rba>>2);\n\n/* These next three lines set up the iobase, and the irq; and disable the drq.  */\n\n\taria_do_kludge(0x111, ((ia->ia_iobase-0x280)>>2)+0xA0, 0xbf, 0xa0, rba);\n\taria_do_kludge(0x011, ia->ia_irq-6, 0xf8, 0x00, rba);\n\taria_do_kludge(0x011, 0x00, 0xef, 0x00, rba);\n\n/* The rest of these lines just disable everything else */\n\n\taria_do_kludge(0x113, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xf8, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xef, 0x00, rba);\n\taria_do_kludge(0x117, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x017, 0x00, 0xff, 0x00, rba);\n\n/* End Sequence */\n\n\toutb(0x200, 0x0f);\n\tend = inb(rba);\n\toutw(0x200, 0x0f);\n\toutb(0x201, end|0x80);\n\tinb(0x200);\n/*\n * This delay is necessary for some reason,\n * at least it would crash, and sometimes not\n * probe properly if it did not exist.\n */\n\tdelay(1000000);\n}"
  },
  {
    "function_name": "ariaprobe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
    "lines": "274-312",
    "snippet": "int\nariaprobe(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct aria_softc *sc = (void *)self;\n\tregister struct isa_attach_args *ia = aux;\n        struct cfdata *cf = sc->sc_dev.dv_cfdata;\n\tregister u_short iobase = ia->ia_iobase;\n\tstatic u_char irq_conf[11] = {\n\t    -1, -1, 0x01, -1, -1, 0x02, -1, 0x04, -1, 0x01, 0x08\n\t};\n\tint i,j;\n\tint flags = cf->cf_flags;\n\n\tif (!ARIA_BASE_VALID(ia->ia_iobase)) {\n\t\tprintf(\"aria: configured iobase %d invalid\\n\", ia->ia_iobase);\n\t\treturn 0;\n\t}\n\tsc->sc_iobase = iobase;\n\t\t\n\tif (!ARIA_IRQ_VALID(ia->ia_irq)) {\n\t\tprintf(\"aria: configured irq %d invalid\\n\", ia->ia_irq);\n\t\treturn 0;\n\t}\n\n\tsc->sc_irq = ia->ia_irq;\n\n\tif (flags & ARIAR_PROMETHEUS_KLUDGE)\n\t\taria_prometheus_kludge(ia);\n\n\tif (aria_reset(sc) != 0) {\n\t\tDPRINTF((\"aria: aria probe failed\\n\"));\n\t\treturn 0;\n\t}\n\n\tia->ia_iosize = ARIADSP_NPORT;\n\treturn 1;\n}",
    "includes": [
      "#include <dev/isa/ariareg.h>",
      "#include <i386/isa/icu.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/pio.h>",
      "#include <machine/cpu.h>",
      "#include <vm/vm.h>",
      "#include <sys/buf.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"aria.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"aria: aria probe failed\\n\")"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aria_reset",
          "args": [
            "sc"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "aria_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "910-929",
          "snippet": "int\naria_reset(sc)\n\tregister struct aria_softc *sc;\n{\n\tregister u_short iobase = sc->sc_iobase;\n\tint fail=0;\n\n\toutw(iobase + ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR);\n\taria_putdspmem(iobase, 0x6102, 0);\n\n\tfail |= aria_sendcmd(iobase, ARIADSPC_SYSINIT, 0x0000, 0x0000, 0x0000);\n\n\twhile (aria_getdspmem(iobase, ARIAA_TASK_A) != 1)\n\t\t;\n\n\toutw(iobase+ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR|ARIAR_PCINTWR);\n\tfail |= aria_sendcmd(iobase, ARIADSPC_MODE, ARIAV_MODE_NO_SYNTH,-1,-1);\n\n\treturn (fail);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\naria_reset(sc)\n\tregister struct aria_softc *sc;\n{\n\tregister u_short iobase = sc->sc_iobase;\n\tint fail=0;\n\n\toutw(iobase + ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR);\n\taria_putdspmem(iobase, 0x6102, 0);\n\n\tfail |= aria_sendcmd(iobase, ARIADSPC_SYSINIT, 0x0000, 0x0000, 0x0000);\n\n\twhile (aria_getdspmem(iobase, ARIAA_TASK_A) != 1)\n\t\t;\n\n\toutw(iobase+ARIADSP_CONTROL, ARIAR_ARIA_SYNTH|ARIAR_SR22K|ARIAR_DSPINTWR|ARIAR_PCINTWR);\n\tfail |= aria_sendcmd(iobase, ARIADSPC_MODE, ARIAV_MODE_NO_SYNTH,-1,-1);\n\n\treturn (fail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aria_prometheus_kludge",
          "args": [
            "ia"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "aria_prometheus_kludge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/aria.c",
          "lines": "331-378",
          "snippet": "void\naria_prometheus_kludge(ia)\n\tregister struct isa_attach_args *ia;\n{\n\tint\ti, j;\n\tu_short\tend;\n\tu_short rba = ia->ia_iobase;\n\n\tDPRINTF((\"aria_prometheus_kludge\\n\"));\n\n/* Begin Config Sequence */\n\n        outb(0x204, 0x4c);\n        outb(0x205, 0x42);\n        outb(0x206, 0x00);\n        outw(0x200, 0x0f);\n        outb(0x201, 0x00);\n        outw(0x200, 0x02);\n        outb(0x201, rba>>2);\n\n/* These next three lines set up the iobase, and the irq; and disable the drq.  */\n\n\taria_do_kludge(0x111, ((ia->ia_iobase-0x280)>>2)+0xA0, 0xbf, 0xa0, rba);\n\taria_do_kludge(0x011, ia->ia_irq-6, 0xf8, 0x00, rba);\n\taria_do_kludge(0x011, 0x00, 0xef, 0x00, rba);\n\n/* The rest of these lines just disable everything else */\n\n\taria_do_kludge(0x113, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xf8, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xef, 0x00, rba);\n\taria_do_kludge(0x117, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x017, 0x00, 0xff, 0x00, rba);\n\n/* End Sequence */\n\n\toutb(0x200, 0x0f);\n\tend = inb(rba);\n\toutw(0x200, 0x0f);\n\toutb(0x201, end|0x80);\n\tinb(0x200);\n/*\n * This delay is necessary for some reason,\n * at least it would crash, and sometimes not\n * probe properly if it did not exist.\n */\n\tdelay(1000000);\n}",
          "includes": [
            "#include <dev/isa/ariareg.h>",
            "#include <i386/isa/icu.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/pio.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"aria.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nvoid\naria_prometheus_kludge(ia)\n\tregister struct isa_attach_args *ia;\n{\n\tint\ti, j;\n\tu_short\tend;\n\tu_short rba = ia->ia_iobase;\n\n\tDPRINTF((\"aria_prometheus_kludge\\n\"));\n\n/* Begin Config Sequence */\n\n        outb(0x204, 0x4c);\n        outb(0x205, 0x42);\n        outb(0x206, 0x00);\n        outw(0x200, 0x0f);\n        outb(0x201, 0x00);\n        outw(0x200, 0x02);\n        outb(0x201, rba>>2);\n\n/* These next three lines set up the iobase, and the irq; and disable the drq.  */\n\n\taria_do_kludge(0x111, ((ia->ia_iobase-0x280)>>2)+0xA0, 0xbf, 0xa0, rba);\n\taria_do_kludge(0x011, ia->ia_irq-6, 0xf8, 0x00, rba);\n\taria_do_kludge(0x011, 0x00, 0xef, 0x00, rba);\n\n/* The rest of these lines just disable everything else */\n\n\taria_do_kludge(0x113, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xf8, 0x00, rba);\n\taria_do_kludge(0x013, 0x00, 0xef, 0x00, rba);\n\taria_do_kludge(0x117, 0x00, 0x88, 0x00, rba);\n\taria_do_kludge(0x017, 0x00, 0xff, 0x00, rba);\n\n/* End Sequence */\n\n\toutb(0x200, 0x0f);\n\tend = inb(rba);\n\toutw(0x200, 0x0f);\n\toutb(0x201, end|0x80);\n\tinb(0x200);\n/*\n * This delay is necessary for some reason,\n * at least it would crash, and sometimes not\n * probe properly if it did not exist.\n */\n\tdelay(1000000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"aria: configured irq %d invalid\\n\"",
            "ia->ia_irq"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARIA_IRQ_VALID",
          "args": [
            "ia->ia_irq"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARIA_BASE_VALID",
          "args": [
            "ia->ia_iobase"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/ariareg.h>\n#include <i386/isa/icu.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/pio.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"aria.h\"\n\nint\nariaprobe(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct aria_softc *sc = (void *)self;\n\tregister struct isa_attach_args *ia = aux;\n        struct cfdata *cf = sc->sc_dev.dv_cfdata;\n\tregister u_short iobase = ia->ia_iobase;\n\tstatic u_char irq_conf[11] = {\n\t    -1, -1, 0x01, -1, -1, 0x02, -1, 0x04, -1, 0x01, 0x08\n\t};\n\tint i,j;\n\tint flags = cf->cf_flags;\n\n\tif (!ARIA_BASE_VALID(ia->ia_iobase)) {\n\t\tprintf(\"aria: configured iobase %d invalid\\n\", ia->ia_iobase);\n\t\treturn 0;\n\t}\n\tsc->sc_iobase = iobase;\n\t\t\n\tif (!ARIA_IRQ_VALID(ia->ia_irq)) {\n\t\tprintf(\"aria: configured irq %d invalid\\n\", ia->ia_irq);\n\t\treturn 0;\n\t}\n\n\tsc->sc_irq = ia->ia_irq;\n\n\tif (flags & ARIAR_PROMETHEUS_KLUDGE)\n\t\taria_prometheus_kludge(ia);\n\n\tif (aria_reset(sc) != 0) {\n\t\tDPRINTF((\"aria: aria probe failed\\n\"));\n\t\treturn 0;\n\t}\n\n\tia->ia_iosize = ARIADSP_NPORT;\n\treturn 1;\n}"
  }
]