[
  {
    "function_name": "rf_MapSIDToPSIDRAID5_RS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_raid5_rotatedspare.c",
    "lines": "161-170",
    "snippet": "void \nrf_MapSIDToPSIDRAID5_RS(\n    RF_RaidLayout_t * layoutPtr,\n    RF_StripeNum_t stripeID,\n    RF_StripeNum_t * psID,\n    RF_ReconUnitNum_t * which_ru)\n{\n\t*which_ru = 0;\n\t*psID = stripeID;\n}",
    "includes": [
      "#include \"rf_raid5_rotatedspare.h\"",
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_dagfuncs.h\"",
      "#include \"rf_dagutils.h\"",
      "#include \"rf_dag.h\"",
      "#include \"rf_raid5.h\"",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rf_raid5_rotatedspare.h\"\n#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include \"rf_dagfuncs.h\"\n#include \"rf_dagutils.h\"\n#include \"rf_dag.h\"\n#include \"rf_raid5.h\"\n#include \"rf_raid.h\"\n\nvoid \nrf_MapSIDToPSIDRAID5_RS(\n    RF_RaidLayout_t * layoutPtr,\n    RF_StripeNum_t stripeID,\n    RF_StripeNum_t * psID,\n    RF_ReconUnitNum_t * which_ru)\n{\n\t*which_ru = 0;\n\t*psID = stripeID;\n}"
  },
  {
    "function_name": "rf_IdentifyStripeRAID5_RS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_raid5_rotatedspare.c",
    "lines": "147-159",
    "snippet": "void \nrf_IdentifyStripeRAID5_RS(\n    RF_Raid_t * raidPtr,\n    RF_RaidAddr_t addr,\n    RF_RowCol_t ** diskids,\n    RF_RowCol_t * outRow)\n{\n\tRF_StripeNum_t stripeID = rf_RaidAddressToStripeID(&raidPtr->Layout, addr);\n\tRF_Raid5RSConfigInfo_t *info = (RF_Raid5RSConfigInfo_t *) raidPtr->Layout.layoutSpecificInfo;\n\t*outRow = 0;\n\t*diskids = info->stripeIdentifier[stripeID % raidPtr->numCol];\n\n}",
    "includes": [
      "#include \"rf_raid5_rotatedspare.h\"",
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_dagfuncs.h\"",
      "#include \"rf_dagutils.h\"",
      "#include \"rf_dag.h\"",
      "#include \"rf_raid5.h\"",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_RaidAddressToStripeID",
          "args": [
            "&raidPtr->Layout",
            "addr"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_raid5_rotatedspare.h\"\n#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include \"rf_dagfuncs.h\"\n#include \"rf_dagutils.h\"\n#include \"rf_dag.h\"\n#include \"rf_raid5.h\"\n#include \"rf_raid.h\"\n\nvoid \nrf_IdentifyStripeRAID5_RS(\n    RF_Raid_t * raidPtr,\n    RF_RaidAddr_t addr,\n    RF_RowCol_t ** diskids,\n    RF_RowCol_t * outRow)\n{\n\tRF_StripeNum_t stripeID = rf_RaidAddressToStripeID(&raidPtr->Layout, addr);\n\tRF_Raid5RSConfigInfo_t *info = (RF_Raid5RSConfigInfo_t *) raidPtr->Layout.layoutSpecificInfo;\n\t*outRow = 0;\n\t*diskids = info->stripeIdentifier[stripeID % raidPtr->numCol];\n\n}"
  },
  {
    "function_name": "rf_MapParityRAID5_RS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_raid5_rotatedspare.c",
    "lines": "128-145",
    "snippet": "void \nrf_MapParityRAID5_RS(\n    RF_Raid_t * raidPtr,\n    RF_RaidAddr_t raidSector,\n    RF_RowCol_t * row,\n    RF_RowCol_t * col,\n    RF_SectorNum_t * diskSector,\n    int remap)\n{\n\tRF_StripeNum_t SUID = raidSector / raidPtr->Layout.sectorsPerStripeUnit;\n\n\t*row = 0;\n\t*col = raidPtr->numCol - 1 - (1 + SUID / raidPtr->Layout.numDataCol) % raidPtr->numCol;\n\t*diskSector = (SUID / (raidPtr->Layout.numDataCol)) * raidPtr->Layout.sectorsPerStripeUnit +\n\t    (raidSector % raidPtr->Layout.sectorsPerStripeUnit);\n\tif (remap)\n\t\t*col = (*col + 1) % raidPtr->numCol;\n}",
    "includes": [
      "#include \"rf_raid5_rotatedspare.h\"",
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_dagfuncs.h\"",
      "#include \"rf_dagutils.h\"",
      "#include \"rf_dag.h\"",
      "#include \"rf_raid5.h\"",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rf_raid5_rotatedspare.h\"\n#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include \"rf_dagfuncs.h\"\n#include \"rf_dagutils.h\"\n#include \"rf_dag.h\"\n#include \"rf_raid5.h\"\n#include \"rf_raid.h\"\n\nvoid \nrf_MapParityRAID5_RS(\n    RF_Raid_t * raidPtr,\n    RF_RaidAddr_t raidSector,\n    RF_RowCol_t * row,\n    RF_RowCol_t * col,\n    RF_SectorNum_t * diskSector,\n    int remap)\n{\n\tRF_StripeNum_t SUID = raidSector / raidPtr->Layout.sectorsPerStripeUnit;\n\n\t*row = 0;\n\t*col = raidPtr->numCol - 1 - (1 + SUID / raidPtr->Layout.numDataCol) % raidPtr->numCol;\n\t*diskSector = (SUID / (raidPtr->Layout.numDataCol)) * raidPtr->Layout.sectorsPerStripeUnit +\n\t    (raidSector % raidPtr->Layout.sectorsPerStripeUnit);\n\tif (remap)\n\t\t*col = (*col + 1) % raidPtr->numCol;\n}"
  },
  {
    "function_name": "rf_MapSectorRAID5_RS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_raid5_rotatedspare.c",
    "lines": "104-126",
    "snippet": "void \nrf_MapSectorRAID5_RS(\n    RF_Raid_t * raidPtr,\n    RF_RaidAddr_t raidSector,\n    RF_RowCol_t * row,\n    RF_RowCol_t * col,\n    RF_SectorNum_t * diskSector,\n    int remap)\n{\n\tRF_StripeNum_t SUID = raidSector / raidPtr->Layout.sectorsPerStripeUnit;\n\n\t*row = 0;\n\tif (remap) {\n\t\t*col = raidPtr->numCol - 1 - (1 + SUID / raidPtr->Layout.numDataCol) % raidPtr->numCol;\n\t\t*col = (*col + 1) % raidPtr->numCol;\t/* spare unit is rotated\n\t\t\t\t\t\t\t * with parity; line\n\t\t\t\t\t\t\t * above maps to parity */\n\t} else {\n\t\t*col = (SUID + (SUID / raidPtr->Layout.numDataCol)) % raidPtr->numCol;\n\t}\n\t*diskSector = (SUID / (raidPtr->Layout.numDataCol)) * raidPtr->Layout.sectorsPerStripeUnit +\n\t    (raidSector % raidPtr->Layout.sectorsPerStripeUnit);\n}",
    "includes": [
      "#include \"rf_raid5_rotatedspare.h\"",
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_dagfuncs.h\"",
      "#include \"rf_dagutils.h\"",
      "#include \"rf_dag.h\"",
      "#include \"rf_raid5.h\"",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rf_raid5_rotatedspare.h\"\n#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include \"rf_dagfuncs.h\"\n#include \"rf_dagutils.h\"\n#include \"rf_dag.h\"\n#include \"rf_raid5.h\"\n#include \"rf_raid.h\"\n\nvoid \nrf_MapSectorRAID5_RS(\n    RF_Raid_t * raidPtr,\n    RF_RaidAddr_t raidSector,\n    RF_RowCol_t * row,\n    RF_RowCol_t * col,\n    RF_SectorNum_t * diskSector,\n    int remap)\n{\n\tRF_StripeNum_t SUID = raidSector / raidPtr->Layout.sectorsPerStripeUnit;\n\n\t*row = 0;\n\tif (remap) {\n\t\t*col = raidPtr->numCol - 1 - (1 + SUID / raidPtr->Layout.numDataCol) % raidPtr->numCol;\n\t\t*col = (*col + 1) % raidPtr->numCol;\t/* spare unit is rotated\n\t\t\t\t\t\t\t * with parity; line\n\t\t\t\t\t\t\t * above maps to parity */\n\t} else {\n\t\t*col = (SUID + (SUID / raidPtr->Layout.numDataCol)) % raidPtr->numCol;\n\t}\n\t*diskSector = (SUID / (raidPtr->Layout.numDataCol)) * raidPtr->Layout.sectorsPerStripeUnit +\n\t    (raidSector % raidPtr->Layout.sectorsPerStripeUnit);\n}"
  },
  {
    "function_name": "rf_GetNumSpareRUsRAID5_RS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_raid5_rotatedspare.c",
    "lines": "97-102",
    "snippet": "RF_ReconUnitCount_t \nrf_GetNumSpareRUsRAID5_RS(raidPtr)\n\tRF_Raid_t *raidPtr;\n{\n\treturn (raidPtr->Layout.stripeUnitsPerDisk / raidPtr->numCol);\n}",
    "includes": [
      "#include \"rf_raid5_rotatedspare.h\"",
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_dagfuncs.h\"",
      "#include \"rf_dagutils.h\"",
      "#include \"rf_dag.h\"",
      "#include \"rf_raid5.h\"",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rf_raid5_rotatedspare.h\"\n#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include \"rf_dagfuncs.h\"\n#include \"rf_dagutils.h\"\n#include \"rf_dag.h\"\n#include \"rf_raid5.h\"\n#include \"rf_raid.h\"\n\nRF_ReconUnitCount_t \nrf_GetNumSpareRUsRAID5_RS(raidPtr)\n\tRF_Raid_t *raidPtr;\n{\n\treturn (raidPtr->Layout.stripeUnitsPerDisk / raidPtr->numCol);\n}"
  },
  {
    "function_name": "rf_ConfigureRAID5_RS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_raid5_rotatedspare.c",
    "lines": "50-95",
    "snippet": "int \nrf_ConfigureRAID5_RS(\n    RF_ShutdownList_t ** listp,\n    RF_Raid_t * raidPtr,\n    RF_Config_t * cfgPtr)\n{\n\tRF_RaidLayout_t *layoutPtr = &raidPtr->Layout;\n\tRF_Raid5RSConfigInfo_t *info;\n\tRF_RowCol_t i, j, startdisk;\n\n\t/* create a RAID level 5 configuration structure */\n\tRF_MallocAndAdd(info, sizeof(RF_Raid5RSConfigInfo_t), (RF_Raid5RSConfigInfo_t *), raidPtr->cleanupList);\n\tif (info == NULL)\n\t\treturn (ENOMEM);\n\tlayoutPtr->layoutSpecificInfo = (void *) info;\n\n\tRF_ASSERT(raidPtr->numRow == 1);\n\tRF_ASSERT(raidPtr->numCol >= 3);\n\n\t/* the stripe identifier must identify the disks in each stripe, IN\n\t * THE ORDER THAT THEY APPEAR IN THE STRIPE. */\n\tinfo->stripeIdentifier = rf_make_2d_array(raidPtr->numCol, raidPtr->numCol, raidPtr->cleanupList);\n\tif (info->stripeIdentifier == NULL)\n\t\treturn (ENOMEM);\n\tstartdisk = 0;\n\tfor (i = 0; i < raidPtr->numCol; i++) {\n\t\tfor (j = 0; j < raidPtr->numCol; j++) {\n\t\t\tinfo->stripeIdentifier[i][j] = (startdisk + j) % raidPtr->numCol;\n\t\t}\n\t\tif ((--startdisk) < 0)\n\t\t\tstartdisk = raidPtr->numCol - 1;\n\t}\n\n\t/* fill in the remaining layout parameters */\n\tlayoutPtr->numStripe = layoutPtr->stripeUnitsPerDisk;\n\tlayoutPtr->bytesPerStripeUnit = layoutPtr->sectorsPerStripeUnit << raidPtr->logBytesPerSector;\n\tlayoutPtr->numDataCol = raidPtr->numCol - 2;\n\tlayoutPtr->dataSectorsPerStripe = layoutPtr->numDataCol * layoutPtr->sectorsPerStripeUnit;\n\tlayoutPtr->numParityCol = 1;\n\tlayoutPtr->dataStripeUnitsPerDisk = layoutPtr->stripeUnitsPerDisk;\n\traidPtr->sectorsPerDisk = layoutPtr->stripeUnitsPerDisk * layoutPtr->sectorsPerStripeUnit;\n\n\traidPtr->totalSectors = layoutPtr->stripeUnitsPerDisk * layoutPtr->numDataCol * layoutPtr->sectorsPerStripeUnit;\n\n\treturn (0);\n}",
    "includes": [
      "#include \"rf_raid5_rotatedspare.h\"",
      "#include \"rf_utils.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_dagfuncs.h\"",
      "#include \"rf_dagutils.h\"",
      "#include \"rf_dag.h\"",
      "#include \"rf_raid5.h\"",
      "#include \"rf_raid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_make_2d_array",
          "args": [
            "raidPtr->numCol",
            "raidPtr->numCol",
            "raidPtr->cleanupList"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "raidPtr->numCol >= 3"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "raidPtr->numRow == 1"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_MallocAndAdd",
          "args": [
            "info",
            "sizeof(RF_Raid5RSConfigInfo_t)",
            "(RF_Raid5RSConfigInfo_t *), raidPtr->cleanupList"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_raid5_rotatedspare.h\"\n#include \"rf_utils.h\"\n#include \"rf_general.h\"\n#include \"rf_dagfuncs.h\"\n#include \"rf_dagutils.h\"\n#include \"rf_dag.h\"\n#include \"rf_raid5.h\"\n#include \"rf_raid.h\"\n\nint \nrf_ConfigureRAID5_RS(\n    RF_ShutdownList_t ** listp,\n    RF_Raid_t * raidPtr,\n    RF_Config_t * cfgPtr)\n{\n\tRF_RaidLayout_t *layoutPtr = &raidPtr->Layout;\n\tRF_Raid5RSConfigInfo_t *info;\n\tRF_RowCol_t i, j, startdisk;\n\n\t/* create a RAID level 5 configuration structure */\n\tRF_MallocAndAdd(info, sizeof(RF_Raid5RSConfigInfo_t), (RF_Raid5RSConfigInfo_t *), raidPtr->cleanupList);\n\tif (info == NULL)\n\t\treturn (ENOMEM);\n\tlayoutPtr->layoutSpecificInfo = (void *) info;\n\n\tRF_ASSERT(raidPtr->numRow == 1);\n\tRF_ASSERT(raidPtr->numCol >= 3);\n\n\t/* the stripe identifier must identify the disks in each stripe, IN\n\t * THE ORDER THAT THEY APPEAR IN THE STRIPE. */\n\tinfo->stripeIdentifier = rf_make_2d_array(raidPtr->numCol, raidPtr->numCol, raidPtr->cleanupList);\n\tif (info->stripeIdentifier == NULL)\n\t\treturn (ENOMEM);\n\tstartdisk = 0;\n\tfor (i = 0; i < raidPtr->numCol; i++) {\n\t\tfor (j = 0; j < raidPtr->numCol; j++) {\n\t\t\tinfo->stripeIdentifier[i][j] = (startdisk + j) % raidPtr->numCol;\n\t\t}\n\t\tif ((--startdisk) < 0)\n\t\t\tstartdisk = raidPtr->numCol - 1;\n\t}\n\n\t/* fill in the remaining layout parameters */\n\tlayoutPtr->numStripe = layoutPtr->stripeUnitsPerDisk;\n\tlayoutPtr->bytesPerStripeUnit = layoutPtr->sectorsPerStripeUnit << raidPtr->logBytesPerSector;\n\tlayoutPtr->numDataCol = raidPtr->numCol - 2;\n\tlayoutPtr->dataSectorsPerStripe = layoutPtr->numDataCol * layoutPtr->sectorsPerStripeUnit;\n\tlayoutPtr->numParityCol = 1;\n\tlayoutPtr->dataStripeUnitsPerDisk = layoutPtr->stripeUnitsPerDisk;\n\traidPtr->sectorsPerDisk = layoutPtr->stripeUnitsPerDisk * layoutPtr->sectorsPerStripeUnit;\n\n\traidPtr->totalSectors = layoutPtr->stripeUnitsPerDisk * layoutPtr->numDataCol * layoutPtr->sectorsPerStripeUnit;\n\n\treturn (0);\n}"
  }
]