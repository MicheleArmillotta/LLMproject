[
  {
    "function_name": "ym_isapnp_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ym_isapnp.c",
    "lines": "92-123",
    "snippet": "void\nym_isapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct ym_softc *sc = (struct ym_softc *)self;\n\tstruct isa_attach_args *ia = aux;\n\n\tsc->sc_iot = ia->ia_iot;\n\tsc->sc_ioh = ia->ipa_io[1].h;\n\tsc->sc_ic = ia->ia_ic;\n\n\tsc->ym_irq = ia->ipa_irq[0].num;\n\tsc->ym_drq = ia->ipa_drq[0].num;\n\tsc->ym_recdrq = ia->ipa_drq[1].num;\n\n\tsc->sc_controlioh = ia->ipa_io[4].h; \n\n\tsc->sc_ad1848.sc_ioh = sc->sc_ioh;\n\tsc->sc_ad1848.sc_isa = parent->dv_parent;\n\tsc->sc_ad1848.sc_iot = sc->sc_iot;\n\tsc->sc_ad1848.sc_iooffs = WSS_CODEC;\n\tsc->sc_ad1848.mode = 2;\n\tsc->sc_ad1848.MCE_bit = MODE_CHANGE_ENABLE;\n\n#if NMIDI > 0\n\tsc->sc_mpu_sc.iobase = ia->ipa_io[3].base;\n\tsc->sc_mpu_sc.ioh = ia->ipa_io[3].h;\n#endif\n\n\tym_attach(sc);\n}",
    "includes": [
      "#include <dev/isa/ymvar.h>",
      "#include <dev/isa/wssreg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/isa/cs4231var.h>",
      "#include <dev/ic/cs4231reg.h>",
      "#include <dev/isa/ad1848var.h>",
      "#include <dev/ic/ad1848reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"midi.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void\tym_isapnp_attach"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ym_attach",
          "args": [
            "sc"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "ym_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ym.c",
          "lines": "142-182",
          "snippet": "void\nym_attach(sc)\n\tstruct ym_softc *sc;\n\n{\n\tstruct ad1848_volume vol_mid = {220, 220};\n#if NMIDI > 0\n\tstruct midi_hw_if *mhw = &ym_mpu401_hw_if;\n#endif\n\n\tsc->sc_ih = isa_intr_establish(sc->sc_ic, sc->ym_irq, IST_EDGE,\n\t    IPL_AUDIO, ym_intr, &sc->sc_ad1848, sc->sc_dev.dv_xname);\n\n\tad1848_attach(&sc->sc_ad1848);\n\tprintf(\"\\n\");\n\tsc->sc_ad1848.parent = sc;\n\n\t/* Establish chip in well known mode */\n\tym_set_master_gain(sc, &vol_mid);\n\tym_set_mic_gain(sc, 0);\n\tsc->master_mute = 0;\n\tym_mute(sc, SA3_VOL_L, sc->master_mute);\n\tym_mute(sc, SA3_VOL_R, sc->master_mute);\n\n\tsc->mic_mute = 1;\n\tym_mute(sc, SA3_MIC_VOL, sc->mic_mute);\n\n#if NMIDI > 0\n\tsc->sc_hasmpu = 0;\n\tif (sc->sc_mpu_sc.iobase) {\n\t\tsc->sc_mpu_sc.iot = sc->sc_iot;\n\t\tif (mpu_find(&sc->sc_mpu_sc)) {\n\t\t\tsc->sc_hasmpu = 1;\n\t\t\tmhw = &ym_mpu401_hw_if;\n\t\t}\n\t}\n\tmidi_attach_mi(mhw, sc, &sc->sc_dev);\n#endif\n\n\taudio_attach_mi(&ym_hw_if, &sc->sc_ad1848, &sc->sc_dev);\n}",
          "includes": [
            "#include <dev/isa/ymvar.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/ic/opl3sa3reg.h>",
            "#include <dev/isa/ad1848var.h>",
            "#include <dev/ic/ad1848reg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/intr.h>",
            "#include <machine/cpu.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int ym_intr",
            "static void ym_mute",
            "static void ym_set_master_gain",
            "static void ym_set_mic_gain",
            "struct audio_hw_if ym_hw_if = {\n\tad1848_open,\n\tad1848_close,\n\tNULL,\n\tad1848_query_encoding,\n\tad1848_set_params,\n\tad1848_round_blocksize,\n\tad1848_commit_settings,\n\tad1848_dma_init_output,\n\tad1848_dma_init_input,\n\tad1848_dma_output,\n\tad1848_dma_input,\n\tad1848_halt_out_dma,\n\tad1848_halt_in_dma,\n\tNULL,\n\tym_getdev,\n\tNULL,\n\tym_mixer_set_port,\n\tym_mixer_get_port,\n\tym_query_devinfo,\n\tad1848_malloc,\n\tad1848_free,\n\tad1848_round,\n\tad1848_mappage,\n\tad1848_get_props,\n\tNULL,\n\tNULL\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/ymvar.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/ic/opl3sa3reg.h>\n#include <dev/isa/ad1848var.h>\n#include <dev/ic/ad1848reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/intr.h>\n#include <machine/cpu.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"midi.h\"\n\nint ym_intr;\nstatic void ym_mute;\nstatic void ym_set_master_gain;\nstatic void ym_set_mic_gain;\nstruct audio_hw_if ym_hw_if = {\n\tad1848_open,\n\tad1848_close,\n\tNULL,\n\tad1848_query_encoding,\n\tad1848_set_params,\n\tad1848_round_blocksize,\n\tad1848_commit_settings,\n\tad1848_dma_init_output,\n\tad1848_dma_init_input,\n\tad1848_dma_output,\n\tad1848_dma_input,\n\tad1848_halt_out_dma,\n\tad1848_halt_in_dma,\n\tNULL,\n\tym_getdev,\n\tNULL,\n\tym_mixer_set_port,\n\tym_mixer_get_port,\n\tym_query_devinfo,\n\tad1848_malloc,\n\tad1848_free,\n\tad1848_round,\n\tad1848_mappage,\n\tad1848_get_props,\n\tNULL,\n\tNULL\n};\n\nvoid\nym_attach(sc)\n\tstruct ym_softc *sc;\n\n{\n\tstruct ad1848_volume vol_mid = {220, 220};\n#if NMIDI > 0\n\tstruct midi_hw_if *mhw = &ym_mpu401_hw_if;\n#endif\n\n\tsc->sc_ih = isa_intr_establish(sc->sc_ic, sc->ym_irq, IST_EDGE,\n\t    IPL_AUDIO, ym_intr, &sc->sc_ad1848, sc->sc_dev.dv_xname);\n\n\tad1848_attach(&sc->sc_ad1848);\n\tprintf(\"\\n\");\n\tsc->sc_ad1848.parent = sc;\n\n\t/* Establish chip in well known mode */\n\tym_set_master_gain(sc, &vol_mid);\n\tym_set_mic_gain(sc, 0);\n\tsc->master_mute = 0;\n\tym_mute(sc, SA3_VOL_L, sc->master_mute);\n\tym_mute(sc, SA3_VOL_R, sc->master_mute);\n\n\tsc->mic_mute = 1;\n\tym_mute(sc, SA3_MIC_VOL, sc->mic_mute);\n\n#if NMIDI > 0\n\tsc->sc_hasmpu = 0;\n\tif (sc->sc_mpu_sc.iobase) {\n\t\tsc->sc_mpu_sc.iot = sc->sc_iot;\n\t\tif (mpu_find(&sc->sc_mpu_sc)) {\n\t\t\tsc->sc_hasmpu = 1;\n\t\t\tmhw = &ym_mpu401_hw_if;\n\t\t}\n\t}\n\tmidi_attach_mi(mhw, sc, &sc->sc_dev);\n#endif\n\n\taudio_attach_mi(&ym_hw_if, &sc->sc_ad1848, &sc->sc_dev);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/ymvar.h>\n#include <dev/isa/wssreg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/isa/cs4231var.h>\n#include <dev/ic/cs4231reg.h>\n#include <dev/isa/ad1848var.h>\n#include <dev/ic/ad1848reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"midi.h\"\n\nvoid\tym_isapnp_attach;\n\nvoid\nym_isapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct ym_softc *sc = (struct ym_softc *)self;\n\tstruct isa_attach_args *ia = aux;\n\n\tsc->sc_iot = ia->ia_iot;\n\tsc->sc_ioh = ia->ipa_io[1].h;\n\tsc->sc_ic = ia->ia_ic;\n\n\tsc->ym_irq = ia->ipa_irq[0].num;\n\tsc->ym_drq = ia->ipa_drq[0].num;\n\tsc->ym_recdrq = ia->ipa_drq[1].num;\n\n\tsc->sc_controlioh = ia->ipa_io[4].h; \n\n\tsc->sc_ad1848.sc_ioh = sc->sc_ioh;\n\tsc->sc_ad1848.sc_isa = parent->dv_parent;\n\tsc->sc_ad1848.sc_iot = sc->sc_iot;\n\tsc->sc_ad1848.sc_iooffs = WSS_CODEC;\n\tsc->sc_ad1848.mode = 2;\n\tsc->sc_ad1848.MCE_bit = MODE_CHANGE_ENABLE;\n\n#if NMIDI > 0\n\tsc->sc_mpu_sc.iobase = ia->ipa_io[3].base;\n\tsc->sc_mpu_sc.ioh = ia->ipa_io[3].h;\n#endif\n\n\tym_attach(sc);\n}"
  },
  {
    "function_name": "ym_isapnp_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/ym_isapnp.c",
    "lines": "76-86",
    "snippet": "int\nym_isapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct isa_attach_args *ia = aux;\n\n\tif (ia->ipa_nio < 5)\n\t\treturn 0;\n\treturn 1;\n}",
    "includes": [
      "#include <dev/isa/ymvar.h>",
      "#include <dev/isa/wssreg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/isa/cs4231var.h>",
      "#include <dev/ic/cs4231reg.h>",
      "#include <dev/isa/ad1848var.h>",
      "#include <dev/ic/ad1848reg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"midi.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int\tym_isapnp_match"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/ymvar.h>\n#include <dev/isa/wssreg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/isa/cs4231var.h>\n#include <dev/ic/cs4231reg.h>\n#include <dev/isa/ad1848var.h>\n#include <dev/ic/ad1848reg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"midi.h\"\n\nint\tym_isapnp_match;\n\nint\nym_isapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct isa_attach_args *ia = aux;\n\n\tif (ia->ipa_nio < 5)\n\t\treturn 0;\n\treturn 1;\n}"
  }
]