[
  {
    "function_name": "oplsyn_loadpatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "576-594",
    "snippet": "void\noplsyn_loadpatch(ms, sysex, uio)\n\tmidisyn *ms;\n\tstruct sysex_info *sysex;\n\tstruct uio *uio;\n{\n#if 0\n\tstruct opl_softc *sc = ms->data;\n\tstruct sbi_instrument ins;\n\n\tDPRINTFN(1, (\"oplsyn_loadpatch: %p\\n\", sc));\n\n\tmemcpy(&ins, sysex, sizeof *sysex);\n\tif (uio->uio_resid >= sizeof ins - sizeof *sysex)\n\t\treturn EINVAL;\n\tuiomove((char *)&ins + sizeof *sysex, sizeof ins - sizeof *sysex, uio);\n\t/* XXX */\n#endif\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_loadpatch"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "(char *)&ins + sizeof *sysex",
            "sizeof ins - sizeof *sysex",
            "uio"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ins",
            "sysex",
            "sizeof *sysex"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "1",
            "(\"oplsyn_loadpatch: %p\\n\", sc)"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_loadpatch;\n\nvoid\noplsyn_loadpatch(ms, sysex, uio)\n\tmidisyn *ms;\n\tstruct sysex_info *sysex;\n\tstruct uio *uio;\n{\n#if 0\n\tstruct opl_softc *sc = ms->data;\n\tstruct sbi_instrument ins;\n\n\tDPRINTFN(1, (\"oplsyn_loadpatch: %p\\n\", sc));\n\n\tmemcpy(&ins, sysex, sizeof *sysex);\n\tif (uio->uio_resid >= sizeof ins - sizeof *sysex)\n\t\treturn EINVAL;\n\tuiomove((char *)&ins + sizeof *sysex, sizeof ins - sizeof *sysex, uio);\n\t/* XXX */\n#endif\n}"
  },
  {
    "function_name": "oplsyn_pitchbend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "565-574",
    "snippet": "void\noplsyn_pitchbend(ms, voice, parm, x)\n\tmidisyn *ms;\n\tu_int32_t voice, parm, x;\n{\n#ifdef AUDIO_DEBUG\n\tstruct opl_softc *sc = ms->data;\n\tDPRINTFN(1, (\"oplsyn_pitchbend: %p %d\\n\", sc, voice));\n#endif\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_pitchbend"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "1",
            "(\"oplsyn_pitchbend: %p %d\\n\", sc, voice)"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_pitchbend;\n\nvoid\noplsyn_pitchbend(ms, voice, parm, x)\n\tmidisyn *ms;\n\tu_int32_t voice, parm, x;\n{\n#ifdef AUDIO_DEBUG\n\tstruct opl_softc *sc = ms->data;\n\tDPRINTFN(1, (\"oplsyn_pitchbend: %p %d\\n\", sc, voice));\n#endif\n}"
  },
  {
    "function_name": "oplsyn_ctlchange",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "554-563",
    "snippet": "void\noplsyn_ctlchange(ms, voice, parm, w14)\n\tmidisyn *ms;\n\tu_int32_t voice, parm, w14;\n{\n#ifdef AUDIO_DEBUG\n\tstruct opl_softc *sc = ms->data;\n\tDPRINTFN(1, (\"oplsyn_ctlchange: %p %d\\n\", sc, voice));\n#endif\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_ctlchange"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "1",
            "(\"oplsyn_ctlchange: %p %d\\n\", sc, voice)"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_ctlchange;\n\nvoid\noplsyn_ctlchange(ms, voice, parm, w14)\n\tmidisyn *ms;\n\tu_int32_t voice, parm, w14;\n{\n#ifdef AUDIO_DEBUG\n\tstruct opl_softc *sc = ms->data;\n\tDPRINTFN(1, (\"oplsyn_ctlchange: %p %d\\n\", sc, voice));\n#endif\n}"
  },
  {
    "function_name": "oplsyn_keypressure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "543-552",
    "snippet": "void\noplsyn_keypressure(ms, voice, note, vel)\n\tmidisyn *ms;\n\tu_int32_t voice, note, vel;\n{\n#ifdef AUDIO_DEBUG\n\tstruct opl_softc *sc = ms->data;\n\tDPRINTFN(1, (\"oplsyn_keypressure: %p %d\\n\", sc, note));\n#endif\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_keypressure"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "1",
            "(\"oplsyn_keypressure: %p %d\\n\", sc, note)"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_keypressure;\n\nvoid\noplsyn_keypressure(ms, voice, note, vel)\n\tmidisyn *ms;\n\tu_int32_t voice, note, vel;\n{\n#ifdef AUDIO_DEBUG\n\tstruct opl_softc *sc = ms->data;\n\tDPRINTFN(1, (\"oplsyn_keypressure: %p %d\\n\", sc, note));\n#endif\n}"
  },
  {
    "function_name": "oplsyn_noteoff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "522-541",
    "snippet": "void\noplsyn_noteoff(ms, voice, note, vel)\n\tmidisyn *ms;\n\tu_int32_t voice, note, vel;\n{\n\tstruct opl_softc *sc = ms->data;\n\tstruct opl_voice *v;\n\n\tDPRINTFN(3, (\"oplsyn_noteoff: %p %d %d\\n\", sc, voice, \n\t\t     MIDISYN_FREQ_TO_HZ(note)));\n\n#ifdef DIAGNOSTIC\n\tif (voice < 0 || voice >= sc->syn.nvoice) {\n\t\tprintf(\"oplsyn_noteoff: bad voice %d\\n\", voice);\n\t\treturn;\n\t}\n#endif\n\tv = &sc->voices[voice];\n\topl_set_ch_reg(sc, 0xB0, voice, v->rB0 & ~OPL_KEYON_BIT);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_noteoff",
      "void opl_set_ch_reg"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opl_set_ch_reg",
          "args": [
            "sc",
            "0xB0",
            "voice",
            "v->rB0 & ~OPL_KEYON_BIT"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "opl_set_ch_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "265-274",
          "snippet": "void \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);",
            "void opl_set_ch_reg"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_ch_reg;\n\nvoid \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"oplsyn_noteoff: bad voice %d\\n\"",
            "voice"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "3",
            "(\"oplsyn_noteoff: %p %d %d\\n\", sc, voice, \n\t\t     MIDISYN_FREQ_TO_HZ(note))"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIDISYN_FREQ_TO_HZ",
          "args": [
            "note"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_noteoff;\nvoid opl_set_ch_reg;\n\nvoid\noplsyn_noteoff(ms, voice, note, vel)\n\tmidisyn *ms;\n\tu_int32_t voice, note, vel;\n{\n\tstruct opl_softc *sc = ms->data;\n\tstruct opl_voice *v;\n\n\tDPRINTFN(3, (\"oplsyn_noteoff: %p %d %d\\n\", sc, voice, \n\t\t     MIDISYN_FREQ_TO_HZ(note)));\n\n#ifdef DIAGNOSTIC\n\tif (voice < 0 || voice >= sc->syn.nvoice) {\n\t\tprintf(\"oplsyn_noteoff: bad voice %d\\n\", voice);\n\t\treturn;\n\t}\n#endif\n\tv = &sc->voices[voice];\n\topl_set_ch_reg(sc, 0xB0, voice, v->rB0 & ~OPL_KEYON_BIT);\n}"
  },
  {
    "function_name": "oplsyn_noteon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "431-520",
    "snippet": "void\noplsyn_noteon(ms, voice, freq, vel)\n\tmidisyn *ms;\n\tu_int32_t voice, freq, vel;\n{\n\tstruct opl_softc *sc = ms->data;\n\tstruct opl_voice *v;\n\tstruct opl_operators *p;\n\tu_int32_t block_fnum;\n\tint mult;\n\tint c_mult, m_mult;\n\tu_int8_t chars0, chars1, ksl0, ksl1, fbc;\n\tu_int8_t r20m, r20c, r40m, r40c, rA0, rB0;\n\tu_int8_t vol0, vol1;\n\n\tDPRINTFN(3, (\"oplsyn_noteon: %p %d %d\\n\", sc, voice, \n\t\t     MIDISYN_FREQ_TO_HZ(freq)));\n\n#ifdef DIAGNOSTIC\n\tif (voice < 0 || voice >= sc->syn.nvoice) {\n\t\tprintf(\"oplsyn_noteon: bad voice %d\\n\", voice);\n\t\treturn;\n\t}\n#endif\n\t/* Turn off old note */\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 0, 0xff);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 1, 0xff);\n\topl_set_ch_reg(sc, OPL_KEYON_BLOCK, voice,    0);\n\n\tv = &sc->voices[voice];\n\t\n\tp = &opl2_instrs[MS_GETPGM(ms, voice)];\n\tv->patch = p;\n\topl_load_patch(sc, voice);\n\n\tmult = 1;\n\tfor (;;) {\n\t\tblock_fnum = opl_get_block_fnum(freq / mult);\n\t\tif (block_fnum != OPL_FNUM_FAIL)\n\t\t\tbreak;\n\t\tmult *= 2;\n\t\tif (mult == 16)\n\t\t\tmult = 15;\n\t}\n\n\tchars0 = p->ops[OO_CHARS+0];\n\tchars1 = p->ops[OO_CHARS+1];\n\tm_mult = (chars0 & OPL_MULTIPLE_MASK) * mult;\n\tc_mult = (chars1 & OPL_MULTIPLE_MASK) * mult;\n\tif ((block_fnum == OPL_FNUM_FAIL) || (m_mult > 15) || (c_mult > 15)) {\n\t\tprintf(\"oplsyn_noteon: frequence out of range %d\\n\",\n\t\t       MIDISYN_FREQ_TO_HZ(freq));\n\t\treturn;\n\t}\n\tr20m = (chars0 &~ OPL_MULTIPLE_MASK) | m_mult;\n\tr20c = (chars1 &~ OPL_MULTIPLE_MASK) | c_mult;\n\n\t/* 2 voice */\n\tksl0 = p->ops[OO_KSL_LEV+0];\n\tksl1 = p->ops[OO_KSL_LEV+1];\n\tif (p->ops[OO_FB_CONN] & 0x01) {\n\t\tvol0 = opl_calc_vol(ksl0, vel, sc->volume);\n\t\tvol1 = opl_calc_vol(ksl1, vel, sc->volume);\n\t} else {\n\t\tvol0 = ksl0;\n\t\tvol1 = opl_calc_vol(ksl1, vel, sc->volume);\n\t}\n\tr40m = (ksl0 & OPL_KSL_MASK) | vol0;\n\tr40c = (ksl1 & OPL_KSL_MASK) | vol1;\n\n\trA0  = block_fnum & 0xFF;\n\trB0  = (block_fnum >> 8) | OPL_KEYON_BIT;\n\n\tv->rB0 = rB0;\n\n\tfbc = p->ops[OO_FB_CONN];\n\tif (sc->model == OPL_3) {\n\t\tfbc &= ~OPL_STEREO_BITS;\n\t\t/* XXX use pan */\n\t\tfbc |= OPL_VOICE_TO_LEFT | OPL_VOICE_TO_RIGHT;\n\t}\n\topl_set_ch_reg(sc, OPL_FEEDBACK_CONNECTION, voice, fbc);\n\n\topl_set_op_reg(sc, OPL_AM_VIB,      voice, 0, r20m);\n\topl_set_op_reg(sc, OPL_AM_VIB,      voice, 1, r20c);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 0, r40m);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 1, r40c);\n\topl_set_ch_reg(sc, OPL_FNUM_LOW,    voice,    rA0);\n\topl_set_ch_reg(sc, OPL_KEYON_BLOCK, voice,    rB0);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define OPL_FNUM_FAIL 0xffff"
    ],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_noteon",
      "void opl_set_op_reg",
      "void opl_set_ch_reg",
      "void opl_load_patch",
      "u_int32_t opl_get_block_fnum",
      "__P((int freq));",
      "int opl_calc_vol"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opl_set_ch_reg",
          "args": [
            "sc",
            "OPL_KEYON_BLOCK",
            "voice",
            "rB0"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "opl_set_ch_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "265-274",
          "snippet": "void \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);",
            "void opl_set_ch_reg"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_ch_reg;\n\nvoid \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "opl_set_op_reg",
          "args": [
            "sc",
            "OPL_KSL_LEVEL",
            "voice",
            "1",
            "r40c"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "opl_set_op_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "253-263",
          "snippet": "void \nopl_set_op_reg(sc, base, voice, op, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tint op;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->op[op], value);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);",
            "void opl_set_op_reg"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_op_reg;\n\nvoid \nopl_set_op_reg(sc, base, voice, op, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tint op;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->op[op], value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "opl_calc_vol",
          "args": [
            "ksl1",
            "vel",
            "sc->volume"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "opl_calc_vol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "407-429",
          "snippet": "int\nopl_calc_vol(regbyte, volume, mainvol)\n\tint regbyte; \n\tint volume;\n\tint mainvol;\n{\n\tint level = ~regbyte & OPL_TOTAL_LEVEL_MASK;\n\n\tif (mainvol > 127)\n\t\tmainvol = 127;\n\n\tvolume = (volume * mainvol) / 127;\n\n\tif (level)\n\t\tlevel += opl_volume_table[volume];\n\n\tif (level > OPL_TOTAL_LEVEL_MASK)\n\t\tlevel = OPL_TOTAL_LEVEL_MASK;\n\tif (level < 0)\n\t\tlevel = 0;\n\n\treturn (~level & OPL_TOTAL_LEVEL_MASK);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int opl_calc_vol",
            "int8_t opl_volume_table[128] =\n    {-64, -48, -40, -35, -32, -29, -27, -26,\n     -24, -23, -21, -20, -19, -18, -18, -17,\n     -16, -15, -15, -14, -13, -13, -12, -12,\n     -11, -11, -10, -10, -10, -9, -9, -8,\n     -8, -8, -7, -7, -7, -6, -6, -6,\n     -5, -5, -5, -5, -4, -4, -4, -4,\n     -3, -3, -3, -3, -2, -2, -2, -2,\n     -2, -1, -1, -1, -1, 0, 0, 0,\n     0, 0, 0, 1, 1, 1, 1, 1,\n     1, 2, 2, 2, 2, 2, 2, 2,\n     3, 3, 3, 3, 3, 3, 3, 4,\n     4, 4, 4, 4, 4, 4, 4, 5,\n     5, 5, 5, 5, 5, 5, 5, 5,\n     6, 6, 6, 6, 6, 6, 6, 6,\n     6, 7, 7, 7, 7, 7, 7, 7,\n     7, 7, 7, 8, 8, 8, 8, 8};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint opl_calc_vol;\nint8_t opl_volume_table[128] =\n    {-64, -48, -40, -35, -32, -29, -27, -26,\n     -24, -23, -21, -20, -19, -18, -18, -17,\n     -16, -15, -15, -14, -13, -13, -12, -12,\n     -11, -11, -10, -10, -10, -9, -9, -8,\n     -8, -8, -7, -7, -7, -6, -6, -6,\n     -5, -5, -5, -5, -4, -4, -4, -4,\n     -3, -3, -3, -3, -2, -2, -2, -2,\n     -2, -1, -1, -1, -1, 0, 0, 0,\n     0, 0, 0, 1, 1, 1, 1, 1,\n     1, 2, 2, 2, 2, 2, 2, 2,\n     3, 3, 3, 3, 3, 3, 3, 4,\n     4, 4, 4, 4, 4, 4, 4, 5,\n     5, 5, 5, 5, 5, 5, 5, 5,\n     6, 6, 6, 6, 6, 6, 6, 6,\n     6, 7, 7, 7, 7, 7, 7, 7,\n     7, 7, 7, 8, 8, 8, 8, 8};\n\nint\nopl_calc_vol(regbyte, volume, mainvol)\n\tint regbyte; \n\tint volume;\n\tint mainvol;\n{\n\tint level = ~regbyte & OPL_TOTAL_LEVEL_MASK;\n\n\tif (mainvol > 127)\n\t\tmainvol = 127;\n\n\tvolume = (volume * mainvol) / 127;\n\n\tif (level)\n\t\tlevel += opl_volume_table[volume];\n\n\tif (level > OPL_TOTAL_LEVEL_MASK)\n\t\tlevel = OPL_TOTAL_LEVEL_MASK;\n\tif (level < 0)\n\t\tlevel = 0;\n\n\treturn (~level & OPL_TOTAL_LEVEL_MASK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"oplsyn_noteon: frequence out of range %d\\n\"",
            "MIDISYN_FREQ_TO_HZ(freq)"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIDISYN_FREQ_TO_HZ",
          "args": [
            "freq"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opl_get_block_fnum",
          "args": [
            "freq / mult"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "opl_get_block_fnum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "298-314",
          "snippet": "u_int32_t\nopl_get_block_fnum(freq)\n\tint freq;\n{\n\tu_int32_t f_num = freq / 3125;\n\tu_int32_t  block = 0;\n\n\twhile (f_num > 0x3FF && block < 8) {\n\t\tblock++;\n\t\tf_num >>= 1;\n\t}\n\n\tif (block > 7)\n\t\treturn (OPL_FNUM_FAIL);\n\telse\n\t\treturn ((block << 10) | f_num);\n  }",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define OPL_FNUM_FAIL 0xffff"
          ],
          "globals_used": [
            "u_int32_t opl_get_block_fnum",
            "__P((int freq));"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define OPL_FNUM_FAIL 0xffff\n\nu_int32_t opl_get_block_fnum;\n__P((int freq));\n\nu_int32_t\nopl_get_block_fnum(freq)\n\tint freq;\n{\n\tu_int32_t f_num = freq / 3125;\n\tu_int32_t  block = 0;\n\n\twhile (f_num > 0x3FF && block < 8) {\n\t\tblock++;\n\t\tf_num >>= 1;\n\t}\n\n\tif (block > 7)\n\t\treturn (OPL_FNUM_FAIL);\n\telse\n\t\treturn ((block << 10) | f_num);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "opl_load_patch",
          "args": [
            "sc",
            "voice"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "opl_load_patch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "277-295",
          "snippet": "void \nopl_load_patch(sc, v)\n\tstruct opl_softc *sc;\n\tint v;\n{\n\tstruct opl_operators *p = sc->voices[v].patch;\n\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 0, p->ops[OO_CHARS+0]);\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 1, p->ops[OO_CHARS+1]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 0, p->ops[OO_KSL_LEV+0]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 1, p->ops[OO_KSL_LEV+1]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 0, p->ops[OO_ATT_DEC+0]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 1, p->ops[OO_ATT_DEC+1]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 0, p->ops[OO_SUS_REL+0]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 1, p->ops[OO_SUS_REL+1]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 0, p->ops[OO_WAV_SEL+0]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 1, p->ops[OO_WAV_SEL+1]);\n\topl_set_ch_reg(sc, OPL_FEEDBACK_CONNECTION, v, p->ops[OO_FB_CONN]);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);",
            "void opl_set_op_reg",
            "void opl_set_ch_reg",
            "void opl_load_patch"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_op_reg;\nvoid opl_set_ch_reg;\nvoid opl_load_patch;\n\nvoid \nopl_load_patch(sc, v)\n\tstruct opl_softc *sc;\n\tint v;\n{\n\tstruct opl_operators *p = sc->voices[v].patch;\n\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 0, p->ops[OO_CHARS+0]);\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 1, p->ops[OO_CHARS+1]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 0, p->ops[OO_KSL_LEV+0]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 1, p->ops[OO_KSL_LEV+1]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 0, p->ops[OO_ATT_DEC+0]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 1, p->ops[OO_ATT_DEC+1]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 0, p->ops[OO_SUS_REL+0]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 1, p->ops[OO_SUS_REL+1]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 0, p->ops[OO_WAV_SEL+0]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 1, p->ops[OO_WAV_SEL+1]);\n\topl_set_ch_reg(sc, OPL_FEEDBACK_CONNECTION, v, p->ops[OO_FB_CONN]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MS_GETPGM",
          "args": [
            "ms",
            "voice"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "3",
            "(\"oplsyn_noteon: %p %d %d\\n\", sc, voice, \n\t\t     MIDISYN_FREQ_TO_HZ(freq))"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIDISYN_FREQ_TO_HZ",
          "args": [
            "freq"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define OPL_FNUM_FAIL 0xffff\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_noteon;\nvoid opl_set_op_reg;\nvoid opl_set_ch_reg;\nvoid opl_load_patch;\nu_int32_t opl_get_block_fnum;\n__P((int freq));\nint opl_calc_vol;\n\nvoid\noplsyn_noteon(ms, voice, freq, vel)\n\tmidisyn *ms;\n\tu_int32_t voice, freq, vel;\n{\n\tstruct opl_softc *sc = ms->data;\n\tstruct opl_voice *v;\n\tstruct opl_operators *p;\n\tu_int32_t block_fnum;\n\tint mult;\n\tint c_mult, m_mult;\n\tu_int8_t chars0, chars1, ksl0, ksl1, fbc;\n\tu_int8_t r20m, r20c, r40m, r40c, rA0, rB0;\n\tu_int8_t vol0, vol1;\n\n\tDPRINTFN(3, (\"oplsyn_noteon: %p %d %d\\n\", sc, voice, \n\t\t     MIDISYN_FREQ_TO_HZ(freq)));\n\n#ifdef DIAGNOSTIC\n\tif (voice < 0 || voice >= sc->syn.nvoice) {\n\t\tprintf(\"oplsyn_noteon: bad voice %d\\n\", voice);\n\t\treturn;\n\t}\n#endif\n\t/* Turn off old note */\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 0, 0xff);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 1, 0xff);\n\topl_set_ch_reg(sc, OPL_KEYON_BLOCK, voice,    0);\n\n\tv = &sc->voices[voice];\n\t\n\tp = &opl2_instrs[MS_GETPGM(ms, voice)];\n\tv->patch = p;\n\topl_load_patch(sc, voice);\n\n\tmult = 1;\n\tfor (;;) {\n\t\tblock_fnum = opl_get_block_fnum(freq / mult);\n\t\tif (block_fnum != OPL_FNUM_FAIL)\n\t\t\tbreak;\n\t\tmult *= 2;\n\t\tif (mult == 16)\n\t\t\tmult = 15;\n\t}\n\n\tchars0 = p->ops[OO_CHARS+0];\n\tchars1 = p->ops[OO_CHARS+1];\n\tm_mult = (chars0 & OPL_MULTIPLE_MASK) * mult;\n\tc_mult = (chars1 & OPL_MULTIPLE_MASK) * mult;\n\tif ((block_fnum == OPL_FNUM_FAIL) || (m_mult > 15) || (c_mult > 15)) {\n\t\tprintf(\"oplsyn_noteon: frequence out of range %d\\n\",\n\t\t       MIDISYN_FREQ_TO_HZ(freq));\n\t\treturn;\n\t}\n\tr20m = (chars0 &~ OPL_MULTIPLE_MASK) | m_mult;\n\tr20c = (chars1 &~ OPL_MULTIPLE_MASK) | c_mult;\n\n\t/* 2 voice */\n\tksl0 = p->ops[OO_KSL_LEV+0];\n\tksl1 = p->ops[OO_KSL_LEV+1];\n\tif (p->ops[OO_FB_CONN] & 0x01) {\n\t\tvol0 = opl_calc_vol(ksl0, vel, sc->volume);\n\t\tvol1 = opl_calc_vol(ksl1, vel, sc->volume);\n\t} else {\n\t\tvol0 = ksl0;\n\t\tvol1 = opl_calc_vol(ksl1, vel, sc->volume);\n\t}\n\tr40m = (ksl0 & OPL_KSL_MASK) | vol0;\n\tr40c = (ksl1 & OPL_KSL_MASK) | vol1;\n\n\trA0  = block_fnum & 0xFF;\n\trB0  = (block_fnum >> 8) | OPL_KEYON_BIT;\n\n\tv->rB0 = rB0;\n\n\tfbc = p->ops[OO_FB_CONN];\n\tif (sc->model == OPL_3) {\n\t\tfbc &= ~OPL_STEREO_BITS;\n\t\t/* XXX use pan */\n\t\tfbc |= OPL_VOICE_TO_LEFT | OPL_VOICE_TO_RIGHT;\n\t}\n\topl_set_ch_reg(sc, OPL_FEEDBACK_CONNECTION, voice, fbc);\n\n\topl_set_op_reg(sc, OPL_AM_VIB,      voice, 0, r20m);\n\topl_set_op_reg(sc, OPL_AM_VIB,      voice, 1, r20c);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 0, r40m);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,   voice, 1, r40c);\n\topl_set_ch_reg(sc, OPL_FNUM_LOW,    voice,    rA0);\n\topl_set_ch_reg(sc, OPL_KEYON_BLOCK, voice,    rB0);\n}"
  },
  {
    "function_name": "opl_calc_vol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "407-429",
    "snippet": "int\nopl_calc_vol(regbyte, volume, mainvol)\n\tint regbyte; \n\tint volume;\n\tint mainvol;\n{\n\tint level = ~regbyte & OPL_TOTAL_LEVEL_MASK;\n\n\tif (mainvol > 127)\n\t\tmainvol = 127;\n\n\tvolume = (volume * mainvol) / 127;\n\n\tif (level)\n\t\tlevel += opl_volume_table[volume];\n\n\tif (level > OPL_TOTAL_LEVEL_MASK)\n\t\tlevel = OPL_TOTAL_LEVEL_MASK;\n\tif (level < 0)\n\t\tlevel = 0;\n\n\treturn (~level & OPL_TOTAL_LEVEL_MASK);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int opl_calc_vol",
      "int8_t opl_volume_table[128] =\n    {-64, -48, -40, -35, -32, -29, -27, -26,\n     -24, -23, -21, -20, -19, -18, -18, -17,\n     -16, -15, -15, -14, -13, -13, -12, -12,\n     -11, -11, -10, -10, -10, -9, -9, -8,\n     -8, -8, -7, -7, -7, -6, -6, -6,\n     -5, -5, -5, -5, -4, -4, -4, -4,\n     -3, -3, -3, -3, -2, -2, -2, -2,\n     -2, -1, -1, -1, -1, 0, 0, 0,\n     0, 0, 0, 1, 1, 1, 1, 1,\n     1, 2, 2, 2, 2, 2, 2, 2,\n     3, 3, 3, 3, 3, 3, 3, 4,\n     4, 4, 4, 4, 4, 4, 4, 5,\n     5, 5, 5, 5, 5, 5, 5, 5,\n     6, 6, 6, 6, 6, 6, 6, 6,\n     6, 7, 7, 7, 7, 7, 7, 7,\n     7, 7, 7, 8, 8, 8, 8, 8};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint opl_calc_vol;\nint8_t opl_volume_table[128] =\n    {-64, -48, -40, -35, -32, -29, -27, -26,\n     -24, -23, -21, -20, -19, -18, -18, -17,\n     -16, -15, -15, -14, -13, -13, -12, -12,\n     -11, -11, -10, -10, -10, -9, -9, -8,\n     -8, -8, -7, -7, -7, -6, -6, -6,\n     -5, -5, -5, -5, -4, -4, -4, -4,\n     -3, -3, -3, -3, -2, -2, -2, -2,\n     -2, -1, -1, -1, -1, 0, 0, 0,\n     0, 0, 0, 1, 1, 1, 1, 1,\n     1, 2, 2, 2, 2, 2, 2, 2,\n     3, 3, 3, 3, 3, 3, 3, 4,\n     4, 4, 4, 4, 4, 4, 4, 5,\n     5, 5, 5, 5, 5, 5, 5, 5,\n     6, 6, 6, 6, 6, 6, 6, 6,\n     6, 7, 7, 7, 7, 7, 7, 7,\n     7, 7, 7, 8, 8, 8, 8, 8};\n\nint\nopl_calc_vol(regbyte, volume, mainvol)\n\tint regbyte; \n\tint volume;\n\tint mainvol;\n{\n\tint level = ~regbyte & OPL_TOTAL_LEVEL_MASK;\n\n\tif (mainvol > 127)\n\t\tmainvol = 127;\n\n\tvolume = (volume * mainvol) / 127;\n\n\tif (level)\n\t\tlevel += opl_volume_table[volume];\n\n\tif (level > OPL_TOTAL_LEVEL_MASK)\n\t\tlevel = OPL_TOTAL_LEVEL_MASK;\n\tif (level < 0)\n\t\tlevel = 0;\n\n\treturn (~level & OPL_TOTAL_LEVEL_MASK);\n}"
  },
  {
    "function_name": "oplsyn_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "380-387",
    "snippet": "void\noplsyn_reset(addr)\n\tvoid *addr;\n{\n\tstruct opl_softc *sc = addr;\n\tDPRINTFN(3, (\"oplsyn_reset:\\n\"));\n\topl_reset(sc);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_reset"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opl_reset",
          "args": [
            "sc"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "opl_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "317-334",
          "snippet": "void\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nvoid\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "3",
            "(\"oplsyn_reset:\\n\")"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_reset;\n\nvoid\noplsyn_reset(addr)\n\tvoid *addr;\n{\n\tstruct opl_softc *sc = addr;\n\tDPRINTFN(3, (\"oplsyn_reset:\\n\"));\n\topl_reset(sc);\n}"
  },
  {
    "function_name": "oplsyn_getinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "365-377",
    "snippet": "void\noplsyn_getinfo(addr, sd)\n\tvoid *addr;\n\tstruct synth_dev *sd;\n{\n\tstruct opl_softc *sc = addr;\n\n\tsd->name = sc->model == OPL_2 ? \"Yamaha OPL2\" : \"Yamaha OPL3\";\n\tsd->type = SYNTH_TYPE_FM;\n\tsd->subtype = sc->model == OPL_2 ? SYNTH_SUB_FM_TYPE_ADLIB \n\t\t: SYNTH_SUB_FM_TYPE_OPL3;\n\tsd->capabilities = 0;\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nvoid\noplsyn_getinfo(addr, sd)\n\tvoid *addr;\n\tstruct synth_dev *sd;\n{\n\tstruct opl_softc *sc = addr;\n\n\tsd->name = sc->model == OPL_2 ? \"Yamaha OPL2\" : \"Yamaha OPL3\";\n\tsd->type = SYNTH_TYPE_FM;\n\tsd->subtype = sc->model == OPL_2 ? SYNTH_SUB_FM_TYPE_ADLIB \n\t\t: SYNTH_SUB_FM_TYPE_OPL3;\n\tsd->capabilities = 0;\n}"
  },
  {
    "function_name": "oplsyn_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "351-362",
    "snippet": "void\noplsyn_close(ms)\n\tmidisyn *ms;\n{\n\tstruct opl_softc *sc = ms->data;\n\n\tDPRINTFN(2, (\"oplsyn_close:\\n\"));\n\n\t/*opl_reset(ms->data);*/\n\tif (sc->spkrctl)\n\t\tsc->spkrctl(sc->spkrarg, 0);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void oplsyn_close"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc->spkrctl",
          "args": [
            "sc->spkrarg",
            "0"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"oplsyn_close:\\n\")"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid oplsyn_close;\n\nvoid\noplsyn_close(ms)\n\tmidisyn *ms;\n{\n\tstruct opl_softc *sc = ms->data;\n\n\tDPRINTFN(2, (\"oplsyn_close:\\n\"));\n\n\t/*opl_reset(ms->data);*/\n\tif (sc->spkrctl)\n\t\tsc->spkrctl(sc->spkrarg, 0);\n}"
  },
  {
    "function_name": "oplsyn_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "336-349",
    "snippet": "int\noplsyn_open(ms, flags)\n\tmidisyn *ms;\n\tint flags;\n{\n\tstruct opl_softc *sc = ms->data;\n\n\tDPRINTFN(2, (\"oplsyn_open: %d\\n\", flags));\n\n\topl_reset(ms->data);\n\tif (sc->spkrctl)\n\t\tsc->spkrctl(sc->spkrarg, 1);\n\treturn (0);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "int oplsyn_open"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc->spkrctl",
          "args": [
            "sc->spkrarg",
            "1"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opl_reset",
          "args": [
            "ms->data"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "opl_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "317-334",
          "snippet": "void\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nvoid\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"oplsyn_open: %d\\n\", flags)"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nint oplsyn_open;\n\nint\noplsyn_open(ms, flags)\n\tmidisyn *ms;\n\tint flags;\n{\n\tstruct opl_softc *sc = ms->data;\n\n\tDPRINTFN(2, (\"oplsyn_open: %d\\n\", flags));\n\n\topl_reset(ms->data);\n\tif (sc->spkrctl)\n\t\tsc->spkrctl(sc->spkrarg, 1);\n\treturn (0);\n}"
  },
  {
    "function_name": "opl_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "317-334",
    "snippet": "void\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opl_command",
          "args": [
            "sc",
            "OPL_R",
            "OPL_CONNECTION_SELECT",
            "OPL_NOCONNECTION"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "opl_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "179-198",
          "snippet": "static void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nstatic void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nvoid\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}"
  },
  {
    "function_name": "opl_get_block_fnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "298-314",
    "snippet": "u_int32_t\nopl_get_block_fnum(freq)\n\tint freq;\n{\n\tu_int32_t f_num = freq / 3125;\n\tu_int32_t  block = 0;\n\n\twhile (f_num > 0x3FF && block < 8) {\n\t\tblock++;\n\t\tf_num >>= 1;\n\t}\n\n\tif (block > 7)\n\t\treturn (OPL_FNUM_FAIL);\n\telse\n\t\treturn ((block << 10) | f_num);\n  }",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define OPL_FNUM_FAIL 0xffff"
    ],
    "globals_used": [
      "u_int32_t opl_get_block_fnum",
      "__P((int freq));"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define OPL_FNUM_FAIL 0xffff\n\nu_int32_t opl_get_block_fnum;\n__P((int freq));\n\nu_int32_t\nopl_get_block_fnum(freq)\n\tint freq;\n{\n\tu_int32_t f_num = freq / 3125;\n\tu_int32_t  block = 0;\n\n\twhile (f_num > 0x3FF && block < 8) {\n\t\tblock++;\n\t\tf_num >>= 1;\n\t}\n\n\tif (block > 7)\n\t\treturn (OPL_FNUM_FAIL);\n\telse\n\t\treturn ((block << 10) | f_num);\n  }"
  },
  {
    "function_name": "opl_load_patch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "277-295",
    "snippet": "void \nopl_load_patch(sc, v)\n\tstruct opl_softc *sc;\n\tint v;\n{\n\tstruct opl_operators *p = sc->voices[v].patch;\n\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 0, p->ops[OO_CHARS+0]);\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 1, p->ops[OO_CHARS+1]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 0, p->ops[OO_KSL_LEV+0]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 1, p->ops[OO_KSL_LEV+1]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 0, p->ops[OO_ATT_DEC+0]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 1, p->ops[OO_ATT_DEC+1]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 0, p->ops[OO_SUS_REL+0]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 1, p->ops[OO_SUS_REL+1]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 0, p->ops[OO_WAV_SEL+0]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 1, p->ops[OO_WAV_SEL+1]);\n\topl_set_ch_reg(sc, OPL_FEEDBACK_CONNECTION, v, p->ops[OO_FB_CONN]);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void opl_set_op_reg",
      "void opl_set_ch_reg",
      "void opl_load_patch"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opl_set_ch_reg",
          "args": [
            "sc",
            "OPL_FEEDBACK_CONNECTION",
            "v",
            "p->ops[OO_FB_CONN]"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "opl_set_ch_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "265-274",
          "snippet": "void \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);",
            "void opl_set_ch_reg"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_ch_reg;\n\nvoid \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "opl_set_op_reg",
          "args": [
            "sc",
            "OPL_WAVE_SELECT",
            "v",
            "1",
            "p->ops[OO_WAV_SEL+1]"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "opl_set_op_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "253-263",
          "snippet": "void \nopl_set_op_reg(sc, base, voice, op, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tint op;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->op[op], value);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);",
            "void opl_set_op_reg"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_op_reg;\n\nvoid \nopl_set_op_reg(sc, base, voice, op, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tint op;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->op[op], value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_op_reg;\nvoid opl_set_ch_reg;\nvoid opl_load_patch;\n\nvoid \nopl_load_patch(sc, v)\n\tstruct opl_softc *sc;\n\tint v;\n{\n\tstruct opl_operators *p = sc->voices[v].patch;\n\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 0, p->ops[OO_CHARS+0]);\n\topl_set_op_reg(sc, OPL_AM_VIB,          v, 1, p->ops[OO_CHARS+1]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 0, p->ops[OO_KSL_LEV+0]);\n\topl_set_op_reg(sc, OPL_KSL_LEVEL,       v, 1, p->ops[OO_KSL_LEV+1]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 0, p->ops[OO_ATT_DEC+0]);\n\topl_set_op_reg(sc, OPL_ATTACK_DECAY,    v, 1, p->ops[OO_ATT_DEC+1]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 0, p->ops[OO_SUS_REL+0]);\n\topl_set_op_reg(sc, OPL_SUSTAIN_RELEASE, v, 1, p->ops[OO_SUS_REL+1]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 0, p->ops[OO_WAV_SEL+0]);\n\topl_set_op_reg(sc, OPL_WAVE_SELECT,     v, 1, p->ops[OO_WAV_SEL+1]);\n\topl_set_ch_reg(sc, OPL_FEEDBACK_CONNECTION, v, p->ops[OO_FB_CONN]);\n}"
  },
  {
    "function_name": "opl_set_ch_reg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "265-274",
    "snippet": "void \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void opl_set_ch_reg"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opl_command",
          "args": [
            "sc",
            "v->iooffs",
            "base + v->voiceno",
            "value"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "opl_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "179-198",
          "snippet": "static void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nstatic void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_ch_reg;\n\nvoid \nopl_set_ch_reg(sc, base, voice, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->voiceno, value);\n}"
  },
  {
    "function_name": "opl_set_op_reg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "253-263",
    "snippet": "void \nopl_set_op_reg(sc, base, voice, op, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tint op;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->op[op], value);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "void opl_set_op_reg"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opl_command",
          "args": [
            "sc",
            "v->iooffs",
            "base + v->op[op]",
            "value"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "opl_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "179-198",
          "snippet": "static void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nstatic void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nvoid opl_set_op_reg;\n\nvoid \nopl_set_op_reg(sc, base, voice, op, value)\n\tstruct opl_softc *sc;\n\tint base;\n\tint voice;\n\tint op;\n\tu_char value;\n{\n\tstruct opl_voice *v = &sc->voices[voice];\n\topl_command(sc, v->iooffs, base + v->op[op], value);\n}"
  },
  {
    "function_name": "opl_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "200-251",
    "snippet": "int\nopl_find(sc)\n\tstruct opl_softc *sc;\n{\n\tu_int8_t status1, status2;\n\n\tDPRINTFN(2,(\"opl_find: ioh=0x%x\\n\", (int)sc->ioh));\n\tsc->model = OPL_2;\t/* worst case assumtion */\n\n\t/* Reset timers 1 and 2 */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\t/* Reset the IRQ of the FM chip */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\t/* get status bits */\n\tstatus1 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER1, -2); /* wait 2 ticks */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, /* start timer1 */\n\t\t    OPL_TIMER1_START | OPL_TIMER2_MASK);\n\tdelay(1000);\t\t/* wait for timer to expire */\n\n\t/* get status bits again */\n\tstatus2 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\tDPRINTFN(2,(\"opl_find: %02x %02x\\n\", status1, status2));\n\n\tif ((status1 & OPL_STATUS_MASK) != 0 ||\n\t    (status2 & OPL_STATUS_MASK) != (OPL_STATUS_IRQ | OPL_STATUS_FT1))\n\t\treturn (0);\n\n\tswitch(status1) {\n\tcase 0x00:\n\tcase 0x0f:\n\t\tsc->model = OPL_3;\n\t\tbreak;\n\tcase 0x06:\n\t\tsc->model = OPL_2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tDPRINTFN(2,(\"opl_find: OPL%d at 0x%x detected\\n\", \n\t\t    sc->model, (int)sc->ioh));\n\treturn (1);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"opl_find: OPL%d at 0x%x detected\\n\", \n\t\t    sc->model, (int)sc->ioh)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"opl_find: %02x %02x\\n\", status1, status2)"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opl_command",
          "args": [
            "sc",
            "OPL_L",
            "OPL_TIMER_CONTROL",
            "OPL_IRQ_RESET"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "opl_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "179-198",
          "snippet": "static void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nstatic void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->iot",
            "sc->ioh",
            "OPL_STATUS+OPL_L+sc->offs"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "1000"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "dc_delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/dc.c",
          "lines": "215-222",
          "snippet": "void dc_delay(sc)\n\tstruct dc_softc\t\t*sc;\n{\n\tint\t\t\tidx;\n\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\tCSR_READ_4(sc, DC_BUSCTL);\n}",
          "includes": [
            "#include <dev/ic/dcreg.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <vm/pmap.h>            /* for vtophys */",
            "#include <vm/vm.h>              /* for vtophys */",
            "#include <net/bpf.h>",
            "#include <net/if_media.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/protosw.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void dc_delay"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/dcreg.h>\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <vm/pmap.h>            /* for vtophys */\n#include <vm/vm.h>              /* for vtophys */\n#include <net/bpf.h>\n#include <net/if_media.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/protosw.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid dc_delay;\n\nvoid dc_delay(sc)\n\tstruct dc_softc\t\t*sc;\n{\n\tint\t\t\tidx;\n\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\tCSR_READ_4(sc, DC_BUSCTL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->iot",
            "sc->ioh",
            "OPL_STATUS+OPL_L+sc->offs"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"opl_find: ioh=0x%x\\n\", (int)sc->ioh)"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nint\nopl_find(sc)\n\tstruct opl_softc *sc;\n{\n\tu_int8_t status1, status2;\n\n\tDPRINTFN(2,(\"opl_find: ioh=0x%x\\n\", (int)sc->ioh));\n\tsc->model = OPL_2;\t/* worst case assumtion */\n\n\t/* Reset timers 1 and 2 */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\t/* Reset the IRQ of the FM chip */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\t/* get status bits */\n\tstatus1 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER1, -2); /* wait 2 ticks */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, /* start timer1 */\n\t\t    OPL_TIMER1_START | OPL_TIMER2_MASK);\n\tdelay(1000);\t\t/* wait for timer to expire */\n\n\t/* get status bits again */\n\tstatus2 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\tDPRINTFN(2,(\"opl_find: %02x %02x\\n\", status1, status2));\n\n\tif ((status1 & OPL_STATUS_MASK) != 0 ||\n\t    (status2 & OPL_STATUS_MASK) != (OPL_STATUS_IRQ | OPL_STATUS_FT1))\n\t\treturn (0);\n\n\tswitch(status1) {\n\tcase 0x00:\n\tcase 0x0f:\n\t\tsc->model = OPL_3;\n\t\tbreak;\n\tcase 0x06:\n\t\tsc->model = OPL_2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tDPRINTFN(2,(\"opl_find: OPL%d at 0x%x detected\\n\", \n\t\t    sc->model, (int)sc->ioh));\n\treturn (1);\n}"
  },
  {
    "function_name": "opl_command",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "179-198",
    "snippet": "static void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "6"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "dc_delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/dc.c",
          "lines": "215-222",
          "snippet": "void dc_delay(sc)\n\tstruct dc_softc\t\t*sc;\n{\n\tint\t\t\tidx;\n\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\tCSR_READ_4(sc, DC_BUSCTL);\n}",
          "includes": [
            "#include <dev/ic/dcreg.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/mii/miivar.h>",
            "#include <dev/mii/mii.h>",
            "#include <vm/pmap.h>            /* for vtophys */",
            "#include <vm/vm.h>              /* for vtophys */",
            "#include <net/bpf.h>",
            "#include <net/if_media.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_var.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_types.h>",
            "#include <net/if_dl.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/protosw.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void dc_delay"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/dcreg.h>\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <dev/mii/miivar.h>\n#include <dev/mii/mii.h>\n#include <vm/pmap.h>            /* for vtophys */\n#include <vm/vm.h>              /* for vtophys */\n#include <net/bpf.h>\n#include <net/if_media.h>\n#include <netinet/if_ether.h>\n#include <netinet/ip.h>\n#include <netinet/in_var.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_types.h>\n#include <net/if_dl.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/protosw.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid dc_delay;\n\nvoid dc_delay(sc)\n\tstruct dc_softc\t\t*sc;\n{\n\tint\t\t\tidx;\n\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\tCSR_READ_4(sc, DC_BUSCTL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->iot",
            "sc->ioh",
            "OPL_DATA+offs",
            "data"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->iot",
            "sc->ioh",
            "OPL_ADDR+offs",
            "addr"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "4",
            "(\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nstatic void\nopl_command(sc, offs, addr, data)\n\tstruct opl_softc *sc;\n\tint offs;\n\tint addr, data;\n{\n\tDPRINTFN(4, (\"opl_command: sc=%p, offs=%d addr=0x%02x data=0x%02x\\n\", \n\t\t     sc, offs, addr, data));\n\toffs += sc->offs;\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_ADDR+offs, addr);\n\tif (sc->model == OPL_2)\n\t\tdelay(10);\n\telse\n\t\tdelay(6);\n\tbus_space_write_1(sc->iot, sc->ioh, OPL_DATA+offs, data);\n\tif (sc->model == OPL_2)\n\t\tdelay(30);\n\telse\n\t\tdelay(6);\n}"
  },
  {
    "function_name": "opl_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
    "lines": "150-177",
    "snippet": "void\nopl_attach(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tif (!opl_find(sc)) {\n\t\tprintf(\"\\nopl: find failed\\n\");\n\t\treturn;\n\t}\n\n\tsc->syn.mets = &opl3_midi;\n\tsprintf(sc->syn.name, \"%sYamaha OPL%d\", sc->syn.name, sc->model);\n\tsc->syn.data = sc;\n\tsc->syn.nvoice = sc->model == OPL_2 ? OPL2_NVOICE : OPL3_NVOICE;\n\tsc->syn.flags =  MS_DOALLOC | MS_FREQXLATE;\n\tmidisyn_attach(&sc->mididev, &sc->syn);\n\t\n\t/* Set up voice table */\n\tfor (i = 0; i < OPL3_NVOICE; i++)\n\t\tsc->voices[i] = voicetab[i];\n\n\topl_reset(sc);\n\n\tprintf(\": model OPL%d\\n\", sc->model);\n\n\tmidi_attach_mi(&midisyn_hw_if, &sc->syn, &sc->mididev.dev);\n}",
    "includes": [
      "#include <dev/ic/oplvar.h>",
      "#include <dev/ic/oplreg.h>",
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/select.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct opl_voice voicetab[] = {\n/*       No    I/O offs\t\tOP1\tOP2\tOP3   OP4\t*/\n/*\t---------------------------------------------------\t*/\n\t{ 0,   OPL_L,\t{0x00,\t0x03,\t0x08, 0x0b}},\n\t{ 1,   OPL_L,\t{0x01,\t0x04,\t0x09, 0x0c}},\n\t{ 2,   OPL_L,\t{0x02,\t0x05,\t0x0a, 0x0d}},\n\n\t{ 3,   OPL_L,\t{0x08,\t0x0b,\t0x00, 0x00}},\n\t{ 4,   OPL_L,\t{0x09,\t0x0c,\t0x00, 0x00}},\n\t{ 5,   OPL_L,\t{0x0a,\t0x0d,\t0x00, 0x00}},\n\n\t{ 6,   OPL_L,\t{0x10,\t0x13,\t0x00, 0x00}},\n\t{ 7,   OPL_L,\t{0x11,\t0x14,\t0x00, 0x00}},\n\t{ 8,   OPL_L,\t{0x12,\t0x15,\t0x00, 0x00}},\n\n\t{ 0,   OPL_R,\t{0x00,\t0x03,\t0x08, 0x0b}},\n\t{ 1,   OPL_R,\t{0x01,\t0x04,\t0x09, 0x0c}},\n\t{ 2,   OPL_R,\t{0x02,\t0x05,\t0x0a, 0x0d}},\n\t{ 3,   OPL_R,\t{0x08,\t0x0b,\t0x00, 0x00}},\n\t{ 4,   OPL_R,\t{0x09,\t0x0c,\t0x00, 0x00}},\n\t{ 5,   OPL_R,\t{0x0a,\t0x0d,\t0x00, 0x00}},\n\n\t{ 6,   OPL_R,\t{0x10,\t0x13,\t0x00, 0x00}},\n\t{ 7,   OPL_R,\t{0x11,\t0x14,\t0x00, 0x00}},\n\t{ 8,   OPL_R,\t{0x12,\t0x15,\t0x00, 0x00}}\n};",
      "static void opl_command(struct opl_softc *, int, int, int);",
      "void opl_reset(struct opl_softc *);",
      "struct midisyn_methods opl3_midi = {\n\toplsyn_open,\n\toplsyn_close,\n\t0,\n\t0,\n\toplsyn_noteon,\n\toplsyn_noteoff,\n\toplsyn_keypressure,\n\toplsyn_ctlchange,\n\t0,\n\t0,\n\toplsyn_pitchbend,\n\t0\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "midi_attach_mi",
          "args": [
            "&midisyn_hw_if",
            "&sc->syn",
            "&sc->mididev.dev"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "midi_attach_mi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "749-767",
          "snippet": "void\nmidi_attach_mi(mhwp, hdlp, dev)\n\tstruct midi_hw_if *mhwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n#ifdef DIAGNOSTIC\n\tif (mhwp == NULL) {\n\t\tprintf(\"midi_attach_mi: NULL\\n\");\n\t\treturn;\n\t}\n#endif\n\targ.type = AUDIODEV_TYPE_MIDI;\n\targ.hwif = mhwp;\n\targ.hdl = hdlp;\n\t(void)config_found(dev, &arg, midiprint);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_attach_mi(mhwp, hdlp, dev)\n\tstruct midi_hw_if *mhwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n#ifdef DIAGNOSTIC\n\tif (mhwp == NULL) {\n\t\tprintf(\"midi_attach_mi: NULL\\n\");\n\t\treturn;\n\t}\n#endif\n\targ.type = AUDIODEV_TYPE_MIDI;\n\targ.hwif = mhwp;\n\targ.hdl = hdlp;\n\t(void)config_found(dev, &arg, midiprint);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\": model OPL%d\\n\"",
            "sc->model"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "opl_reset",
          "args": [
            "sc"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "opl_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "317-334",
          "snippet": "void\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nvoid\nopl_reset(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tfor (i = 1; i <= OPL_MAXREG; i++)\n\t\topl_command(sc, OPL_L, OPL_KEYON_BLOCK + i, 0);\n\n\topl_command(sc, OPL_L, OPL_TEST, OPL_ENABLE_WAVE_SELECT);\n\topl_command(sc, OPL_L, OPL_PERCUSSION, 0);\n\tif (sc->model == OPL_3) {\n\t\topl_command(sc, OPL_R, OPL_MODE, OPL3_ENABLE);\n\t\topl_command(sc, OPL_R,OPL_CONNECTION_SELECT,OPL_NOCONNECTION);\n\t}\n\n\tsc->volume = 64;\n}"
        }
      },
      {
        "call_info": {
          "callee": "midisyn_attach",
          "args": [
            "&sc->mididev",
            "&sc->syn"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "midisyn_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midisyn.c",
          "lines": "175-191",
          "snippet": "void\nmidisyn_attach(sc, ms)\n\tstruct midi_softc *sc;\n\tmidisyn *ms;\n{\n\tif (ms->flags & MS_DOALLOC) {\n\t\tms->voices = malloc(ms->nvoice * sizeof (struct voice), \n\t\t\t\t    M_DEVBUF, M_WAITOK);\n\t\tmemset(ms->voices, 0, ms->nvoice * sizeof (struct voice));\n\t\tms->seqno = 1;\n\t\tif (ms->mets->allocv == 0)\n\t\t\tms->mets->allocv = &midisyn_allocvoice;\n\t}\n\tsc->hw_if = &midisyn_hw_if;\n\tsc->hw_hdl = ms;\n\tDPRINTF((\"midisyn_attach: ms=%p\\n\", sc->hw_hdl));\n}",
          "includes": [
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tmidisyn_allocvoice",
            "struct midi_hw_if midisyn_hw_if = {\n\tmidisyn_open,\n\tmidisyn_close,\n\tmidisyn_output,\n\tmidisyn_getinfo,\n\tmidisyn_ioctl,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n\nint\tmidisyn_allocvoice;\nstruct midi_hw_if midisyn_hw_if = {\n\tmidisyn_open,\n\tmidisyn_close,\n\tmidisyn_output,\n\tmidisyn_getinfo,\n\tmidisyn_ioctl,\n};\n\nvoid\nmidisyn_attach(sc, ms)\n\tstruct midi_softc *sc;\n\tmidisyn *ms;\n{\n\tif (ms->flags & MS_DOALLOC) {\n\t\tms->voices = malloc(ms->nvoice * sizeof (struct voice), \n\t\t\t\t    M_DEVBUF, M_WAITOK);\n\t\tmemset(ms->voices, 0, ms->nvoice * sizeof (struct voice));\n\t\tms->seqno = 1;\n\t\tif (ms->mets->allocv == 0)\n\t\t\tms->mets->allocv = &midisyn_allocvoice;\n\t}\n\tsc->hw_if = &midisyn_hw_if;\n\tsc->hw_hdl = ms;\n\tDPRINTF((\"midisyn_attach: ms=%p\\n\", sc->hw_hdl));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "sc->syn.name",
            "\"%sYamaha OPL%d\"",
            "sc->syn.name",
            "sc->model"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opl_find",
          "args": [
            "sc"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "opl_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/opl.c",
          "lines": "200-251",
          "snippet": "int\nopl_find(sc)\n\tstruct opl_softc *sc;\n{\n\tu_int8_t status1, status2;\n\n\tDPRINTFN(2,(\"opl_find: ioh=0x%x\\n\", (int)sc->ioh));\n\tsc->model = OPL_2;\t/* worst case assumtion */\n\n\t/* Reset timers 1 and 2 */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\t/* Reset the IRQ of the FM chip */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\t/* get status bits */\n\tstatus1 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER1, -2); /* wait 2 ticks */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, /* start timer1 */\n\t\t    OPL_TIMER1_START | OPL_TIMER2_MASK);\n\tdelay(1000);\t\t/* wait for timer to expire */\n\n\t/* get status bits again */\n\tstatus2 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\tDPRINTFN(2,(\"opl_find: %02x %02x\\n\", status1, status2));\n\n\tif ((status1 & OPL_STATUS_MASK) != 0 ||\n\t    (status2 & OPL_STATUS_MASK) != (OPL_STATUS_IRQ | OPL_STATUS_FT1))\n\t\treturn (0);\n\n\tswitch(status1) {\n\tcase 0x00:\n\tcase 0x0f:\n\t\tsc->model = OPL_3;\n\t\tbreak;\n\tcase 0x06:\n\t\tsc->model = OPL_2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tDPRINTFN(2,(\"opl_find: OPL%d at 0x%x detected\\n\", \n\t\t    sc->model, (int)sc->ioh));\n\treturn (1);\n}",
          "includes": [
            "#include <dev/ic/oplvar.h>",
            "#include <dev/ic/oplreg.h>",
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/select.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void opl_command(struct opl_softc *, int, int, int);",
            "void opl_reset(struct opl_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\n\nint\nopl_find(sc)\n\tstruct opl_softc *sc;\n{\n\tu_int8_t status1, status2;\n\n\tDPRINTFN(2,(\"opl_find: ioh=0x%x\\n\", (int)sc->ioh));\n\tsc->model = OPL_2;\t/* worst case assumtion */\n\n\t/* Reset timers 1 and 2 */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\t/* Reset the IRQ of the FM chip */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\t/* get status bits */\n\tstatus1 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER1, -2); /* wait 2 ticks */\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, /* start timer1 */\n\t\t    OPL_TIMER1_START | OPL_TIMER2_MASK);\n\tdelay(1000);\t\t/* wait for timer to expire */\n\n\t/* get status bits again */\n\tstatus2 = bus_space_read_1(sc->iot,sc->ioh,OPL_STATUS+OPL_L+sc->offs);\n\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, \n\t\t    OPL_TIMER1_MASK | OPL_TIMER2_MASK);\n\topl_command(sc, OPL_L, OPL_TIMER_CONTROL, OPL_IRQ_RESET);\n\n\tDPRINTFN(2,(\"opl_find: %02x %02x\\n\", status1, status2));\n\n\tif ((status1 & OPL_STATUS_MASK) != 0 ||\n\t    (status2 & OPL_STATUS_MASK) != (OPL_STATUS_IRQ | OPL_STATUS_FT1))\n\t\treturn (0);\n\n\tswitch(status1) {\n\tcase 0x00:\n\tcase 0x0f:\n\t\tsc->model = OPL_3;\n\t\tbreak;\n\tcase 0x06:\n\t\tsc->model = OPL_2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tDPRINTFN(2,(\"opl_find: OPL%d at 0x%x detected\\n\", \n\t\t    sc->model, (int)sc->ioh));\n\treturn (1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/oplvar.h>\n#include <dev/ic/oplreg.h>\n#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/select.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct opl_voice voicetab[] = {\n/*       No    I/O offs\t\tOP1\tOP2\tOP3   OP4\t*/\n/*\t---------------------------------------------------\t*/\n\t{ 0,   OPL_L,\t{0x00,\t0x03,\t0x08, 0x0b}},\n\t{ 1,   OPL_L,\t{0x01,\t0x04,\t0x09, 0x0c}},\n\t{ 2,   OPL_L,\t{0x02,\t0x05,\t0x0a, 0x0d}},\n\n\t{ 3,   OPL_L,\t{0x08,\t0x0b,\t0x00, 0x00}},\n\t{ 4,   OPL_L,\t{0x09,\t0x0c,\t0x00, 0x00}},\n\t{ 5,   OPL_L,\t{0x0a,\t0x0d,\t0x00, 0x00}},\n\n\t{ 6,   OPL_L,\t{0x10,\t0x13,\t0x00, 0x00}},\n\t{ 7,   OPL_L,\t{0x11,\t0x14,\t0x00, 0x00}},\n\t{ 8,   OPL_L,\t{0x12,\t0x15,\t0x00, 0x00}},\n\n\t{ 0,   OPL_R,\t{0x00,\t0x03,\t0x08, 0x0b}},\n\t{ 1,   OPL_R,\t{0x01,\t0x04,\t0x09, 0x0c}},\n\t{ 2,   OPL_R,\t{0x02,\t0x05,\t0x0a, 0x0d}},\n\t{ 3,   OPL_R,\t{0x08,\t0x0b,\t0x00, 0x00}},\n\t{ 4,   OPL_R,\t{0x09,\t0x0c,\t0x00, 0x00}},\n\t{ 5,   OPL_R,\t{0x0a,\t0x0d,\t0x00, 0x00}},\n\n\t{ 6,   OPL_R,\t{0x10,\t0x13,\t0x00, 0x00}},\n\t{ 7,   OPL_R,\t{0x11,\t0x14,\t0x00, 0x00}},\n\t{ 8,   OPL_R,\t{0x12,\t0x15,\t0x00, 0x00}}\n};\nstatic void opl_command(struct opl_softc *, int, int, int);\nvoid opl_reset(struct opl_softc *);\nstruct midisyn_methods opl3_midi = {\n\toplsyn_open,\n\toplsyn_close,\n\t0,\n\t0,\n\toplsyn_noteon,\n\toplsyn_noteoff,\n\toplsyn_keypressure,\n\toplsyn_ctlchange,\n\t0,\n\t0,\n\toplsyn_pitchbend,\n\t0\n};\n\nvoid\nopl_attach(sc)\n\tstruct opl_softc *sc;\n{\n\tint i;\n\n\tif (!opl_find(sc)) {\n\t\tprintf(\"\\nopl: find failed\\n\");\n\t\treturn;\n\t}\n\n\tsc->syn.mets = &opl3_midi;\n\tsprintf(sc->syn.name, \"%sYamaha OPL%d\", sc->syn.name, sc->model);\n\tsc->syn.data = sc;\n\tsc->syn.nvoice = sc->model == OPL_2 ? OPL2_NVOICE : OPL3_NVOICE;\n\tsc->syn.flags =  MS_DOALLOC | MS_FREQXLATE;\n\tmidisyn_attach(&sc->mididev, &sc->syn);\n\t\n\t/* Set up voice table */\n\tfor (i = 0; i < OPL3_NVOICE; i++)\n\t\tsc->voices[i] = voicetab[i];\n\n\topl_reset(sc);\n\n\tprintf(\": model OPL%d\\n\", sc->model);\n\n\tmidi_attach_mi(&midisyn_hw_if, &sc->syn, &sc->mididev.dev);\n}"
  }
]