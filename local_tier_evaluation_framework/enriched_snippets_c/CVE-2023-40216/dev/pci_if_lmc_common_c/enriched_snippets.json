[
  {
    "function_name": "lmc_initcsrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
    "lines": "388-408",
    "snippet": "void\nlmc_initcsrs(lmc_softc_t * const sc, lmc_csrptr_t csr_base,\n\t     size_t csr_size)\n{\n\tsc->lmc_csrs.csr_busmode\t= csr_base +  0 * csr_size;\n\tsc->lmc_csrs.csr_txpoll\t\t= csr_base +  1 * csr_size;\n\tsc->lmc_csrs.csr_rxpoll\t\t= csr_base +  2 * csr_size;\n\tsc->lmc_csrs.csr_rxlist\t\t= csr_base +  3 * csr_size;\n\tsc->lmc_csrs.csr_txlist\t\t= csr_base +  4 * csr_size;\n\tsc->lmc_csrs.csr_status\t\t= csr_base +  5 * csr_size;\n\tsc->lmc_csrs.csr_command\t= csr_base +  6 * csr_size;\n\tsc->lmc_csrs.csr_intr\t\t= csr_base +  7 * csr_size;\n\tsc->lmc_csrs.csr_missed_frames\t= csr_base +  8 * csr_size;\n\tsc->lmc_csrs.csr_9\t\t= csr_base +  9 * csr_size;\n\tsc->lmc_csrs.csr_10\t\t= csr_base + 10 * csr_size;\n\tsc->lmc_csrs.csr_11\t\t= csr_base + 11 * csr_size;\n\tsc->lmc_csrs.csr_12\t\t= csr_base + 12 * csr_size;\n\tsc->lmc_csrs.csr_13\t\t= csr_base + 13 * csr_size;\n\tsc->lmc_csrs.csr_14\t\t= csr_base + 14 * csr_size;\n\tsc->lmc_csrs.csr_15\t\t= csr_base + 15 * csr_size;\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_initcsrs(lmc_softc_t * const sc, lmc_csrptr_t csr_base,\n\t     size_t csr_size)\n{\n\tsc->lmc_csrs.csr_busmode\t= csr_base +  0 * csr_size;\n\tsc->lmc_csrs.csr_txpoll\t\t= csr_base +  1 * csr_size;\n\tsc->lmc_csrs.csr_rxpoll\t\t= csr_base +  2 * csr_size;\n\tsc->lmc_csrs.csr_rxlist\t\t= csr_base +  3 * csr_size;\n\tsc->lmc_csrs.csr_txlist\t\t= csr_base +  4 * csr_size;\n\tsc->lmc_csrs.csr_status\t\t= csr_base +  5 * csr_size;\n\tsc->lmc_csrs.csr_command\t= csr_base +  6 * csr_size;\n\tsc->lmc_csrs.csr_intr\t\t= csr_base +  7 * csr_size;\n\tsc->lmc_csrs.csr_missed_frames\t= csr_base +  8 * csr_size;\n\tsc->lmc_csrs.csr_9\t\t= csr_base +  9 * csr_size;\n\tsc->lmc_csrs.csr_10\t\t= csr_base + 10 * csr_size;\n\tsc->lmc_csrs.csr_11\t\t= csr_base + 11 * csr_size;\n\tsc->lmc_csrs.csr_12\t\t= csr_base + 12 * csr_size;\n\tsc->lmc_csrs.csr_13\t\t= csr_base + 13 * csr_size;\n\tsc->lmc_csrs.csr_14\t\t= csr_base + 14 * csr_size;\n\tsc->lmc_csrs.csr_15\t\t= csr_base + 15 * csr_size;\n}"
  },
  {
    "function_name": "lmc_dec_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
    "lines": "250-386",
    "snippet": "void\nlmc_dec_reset(lmc_softc_t * const sc)\n{\n#ifndef __linux__\n\tlmc_ringinfo_t *ri;\n\ttulip_desc_t *di;\n#endif\n\tu_int32_t val;\n\n\t/*\n\t * disable all interrupts\n\t */\n\tsc->lmc_intrmask = 0;\n\tLMC_CSR_WRITE(sc, csr_intr, sc->lmc_intrmask);\n\n\t/*\n\t * we are, obviously, down.\n\t */\n#ifndef __linux__\n\tsc->lmc_flags &= ~(LMC_IFUP | LMC_MODEMOK);\n\n\tDP((\"lmc_dec_reset\\n\"));\n#endif\n\n\t/*\n\t * Reset the chip with a software reset command.\n\t * Wait 10 microseconds (actually 50 PCI cycles but at \n\t * 33MHz that comes to two microseconds but wait a\n\t * bit longer anyways)\n\t */\n\tLMC_CSR_WRITE(sc, csr_busmode, TULIP_BUSMODE_SWRESET);\n\tDELAY(10);\n\tsc->lmc_cmdmode = LMC_CSR_READ(sc, csr_command);\n\n\t/*\n\t * We want:\n\t *   no ethernet address in frames we write\n\t *   disable padding (txdesc, padding disable)\n\t *   ignore runt frames (rdes0 bit 15)\n\t *   no receiver watchdog or transmitter jabber timer\n\t *       (csr15 bit 0,14 == 1)\n\t *   if using 16-bit CRC, turn off CRC (trans desc, crc disable)\n\t */\n\n#ifndef TULIP_CMD_RECEIVEALL\n#define TULIP_CMD_RECEIVEALL 0x40000000L\n#endif\n\n\tsc->lmc_cmdmode |= ( TULIP_CMD_PROMISCUOUS\n\t\t\t       | TULIP_CMD_FULLDUPLEX\n\t\t\t       | TULIP_CMD_PASSBADPKT\n\t\t\t       | TULIP_CMD_NOHEARTBEAT\n\t\t\t       | TULIP_CMD_PORTSELECT\n\t\t\t       | TULIP_CMD_RECEIVEALL\n\t\t\t       | TULIP_CMD_MUSTBEONE\n\t\t\t       );\n\tsc->lmc_cmdmode &= ~( TULIP_CMD_OPERMODE\n\t\t\t\t| TULIP_CMD_THRESHOLDCTL\n\t\t\t\t| TULIP_CMD_STOREFWD\n\t\t\t\t| TULIP_CMD_TXTHRSHLDCTL\n\t\t\t\t);\n\n\tLMC_CSR_WRITE(sc, csr_command, sc->lmc_cmdmode);\n\n\t/*\n\t * disable receiver watchdog and transmit jabber\n\t */\n\tval = LMC_CSR_READ(sc, csr_sia_general);\n\tval |= (TULIP_WATCHDOG_TXDISABLE | TULIP_WATCHDOG_RXDISABLE);\n\tLMC_CSR_WRITE(sc, csr_sia_general, val);\n\n\t/*\n\t * turn off those LEDs...\n\t */\n\tsc->lmc_miireg16 |= LMC_MII16_LED_ALL;\n\tlmc_led_on(sc, LMC_MII16_LED0);\n\n#ifndef __linux__\n\t/*\n\t * reprogram the tx desc, rx desc, and PCI bus options\n\t */\n\tLMC_CSR_WRITE(sc, csr_txlist,\n\t\t\tLMC_KVATOPHYS(sc, &sc->lmc_txinfo.ri_first[0]));\n\tLMC_CSR_WRITE(sc, csr_rxlist,\n\t\t\tLMC_KVATOPHYS(sc, &sc->lmc_rxinfo.ri_first[0]));\n\tLMC_CSR_WRITE(sc, csr_busmode,\n\t\t\t(1 << (LMC_BURSTSIZE(sc->lmc_unit) + 8))\n\t\t\t|TULIP_BUSMODE_CACHE_ALIGN8\n\t\t\t|TULIP_BUSMODE_READMULTIPLE\n\t\t\t|(BYTE_ORDER != LITTLE_ENDIAN ? TULIP_BUSMODE_BIGENDIAN : 0));\n\n\tsc->lmc_txq.ifq_maxlen = LMC_TXDESCS;\n\n\t/*\n\t * Free all the mbufs that were on the transmit ring.\n\t */\n\tfor (;;) {\n\t\tstruct mbuf *m;\n\n\t\tIF_DEQUEUE(&sc->lmc_txq, m);\n\t\tif (m == NULL)\n\t\t\tbreak;\n\t\tm_freem(m);\n\t}\n\n\t/*\n\t * reset descriptor state and reclaim all descriptors.\n\t */\n\tri = &sc->lmc_txinfo;\n\tri->ri_nextin = ri->ri_nextout = ri->ri_first;\n\tri->ri_free = ri->ri_max;\n\tfor (di = ri->ri_first; di < ri->ri_last; di++)\n\t\tdi->d_status = 0;\n\n\t/*\n\t * We need to collect all the mbufs were on the \n\t * receive ring before we reinit it either to put\n\t * them back on or to know if we have to allocate\n\t * more.\n\t */\n\tri = &sc->lmc_rxinfo;\n\tri->ri_nextin = ri->ri_nextout = ri->ri_first;\n\tri->ri_free = ri->ri_max;\n\tfor (di = ri->ri_first; di < ri->ri_last; di++) {\n\t\tdi->d_status = 0;\n\t\tdi->d_length1 = 0; di->d_addr1 = 0;\n\t\tdi->d_length2 = 0; di->d_addr2 = 0;\n\t}\n\tfor (;;) {\n\t\tstruct mbuf *m;\n\t\tIF_DEQUEUE(&sc->lmc_rxq, m);\n\t\tif (m == NULL)\n\t\t\tbreak;\n\t\tm_freem(m);\n\t}\n#endif\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define TULIP_CMD_RECEIVEALL 0x40000000L",
      "#define d_length2 u.bd_length2",
      "#define d_length1 u.bd_length1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&sc->lmc_rxq",
            "m"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_freem",
          "args": [
            "m"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IF_DEQUEUE",
          "args": [
            "&sc->lmc_txq",
            "m"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_busmode",
            "(1 << (LMC_BURSTSIZE(sc->lmc_unit) + 8))\n\t\t\t|TULIP_BUSMODE_CACHE_ALIGN8\n\t\t\t|TULIP_BUSMODE_READMULTIPLE\n\t\t\t|(BYTE_ORDER != LITTLE_ENDIAN ? TULIP_BUSMODE_BIGENDIAN : 0)"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_BURSTSIZE",
          "args": [
            "sc->lmc_unit"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_rxlist",
            "LMC_KVATOPHYS(sc, &sc->lmc_rxinfo.ri_first[0])"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_KVATOPHYS",
          "args": [
            "sc",
            "&sc->lmc_rxinfo.ri_first[0]"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_txlist",
            "LMC_KVATOPHYS(sc, &sc->lmc_txinfo.ri_first[0])"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_KVATOPHYS",
          "args": [
            "sc",
            "&sc->lmc_txinfo.ri_first[0]"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lmc_led_on",
          "args": [
            "sc",
            "LMC_MII16_LED0"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_on",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "193-198",
          "snippet": "void\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_sia_general",
            "val"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_READ",
          "args": [
            "sc",
            "csr_sia_general"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_command",
            "sc->lmc_cmdmode"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_READ",
          "args": [
            "sc",
            "csr_command"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "10"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_busmode",
            "TULIP_BUSMODE_SWRESET"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DP",
          "args": [
            "(\"lmc_dec_reset\\n\")"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_intr",
            "sc->lmc_intrmask"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define TULIP_CMD_RECEIVEALL 0x40000000L\n#define d_length2 u.bd_length2\n#define d_length1 u.bd_length1\n\nvoid\nlmc_dec_reset(lmc_softc_t * const sc)\n{\n#ifndef __linux__\n\tlmc_ringinfo_t *ri;\n\ttulip_desc_t *di;\n#endif\n\tu_int32_t val;\n\n\t/*\n\t * disable all interrupts\n\t */\n\tsc->lmc_intrmask = 0;\n\tLMC_CSR_WRITE(sc, csr_intr, sc->lmc_intrmask);\n\n\t/*\n\t * we are, obviously, down.\n\t */\n#ifndef __linux__\n\tsc->lmc_flags &= ~(LMC_IFUP | LMC_MODEMOK);\n\n\tDP((\"lmc_dec_reset\\n\"));\n#endif\n\n\t/*\n\t * Reset the chip with a software reset command.\n\t * Wait 10 microseconds (actually 50 PCI cycles but at \n\t * 33MHz that comes to two microseconds but wait a\n\t * bit longer anyways)\n\t */\n\tLMC_CSR_WRITE(sc, csr_busmode, TULIP_BUSMODE_SWRESET);\n\tDELAY(10);\n\tsc->lmc_cmdmode = LMC_CSR_READ(sc, csr_command);\n\n\t/*\n\t * We want:\n\t *   no ethernet address in frames we write\n\t *   disable padding (txdesc, padding disable)\n\t *   ignore runt frames (rdes0 bit 15)\n\t *   no receiver watchdog or transmitter jabber timer\n\t *       (csr15 bit 0,14 == 1)\n\t *   if using 16-bit CRC, turn off CRC (trans desc, crc disable)\n\t */\n\n#ifndef TULIP_CMD_RECEIVEALL\n#define TULIP_CMD_RECEIVEALL 0x40000000L\n#endif\n\n\tsc->lmc_cmdmode |= ( TULIP_CMD_PROMISCUOUS\n\t\t\t       | TULIP_CMD_FULLDUPLEX\n\t\t\t       | TULIP_CMD_PASSBADPKT\n\t\t\t       | TULIP_CMD_NOHEARTBEAT\n\t\t\t       | TULIP_CMD_PORTSELECT\n\t\t\t       | TULIP_CMD_RECEIVEALL\n\t\t\t       | TULIP_CMD_MUSTBEONE\n\t\t\t       );\n\tsc->lmc_cmdmode &= ~( TULIP_CMD_OPERMODE\n\t\t\t\t| TULIP_CMD_THRESHOLDCTL\n\t\t\t\t| TULIP_CMD_STOREFWD\n\t\t\t\t| TULIP_CMD_TXTHRSHLDCTL\n\t\t\t\t);\n\n\tLMC_CSR_WRITE(sc, csr_command, sc->lmc_cmdmode);\n\n\t/*\n\t * disable receiver watchdog and transmit jabber\n\t */\n\tval = LMC_CSR_READ(sc, csr_sia_general);\n\tval |= (TULIP_WATCHDOG_TXDISABLE | TULIP_WATCHDOG_RXDISABLE);\n\tLMC_CSR_WRITE(sc, csr_sia_general, val);\n\n\t/*\n\t * turn off those LEDs...\n\t */\n\tsc->lmc_miireg16 |= LMC_MII16_LED_ALL;\n\tlmc_led_on(sc, LMC_MII16_LED0);\n\n#ifndef __linux__\n\t/*\n\t * reprogram the tx desc, rx desc, and PCI bus options\n\t */\n\tLMC_CSR_WRITE(sc, csr_txlist,\n\t\t\tLMC_KVATOPHYS(sc, &sc->lmc_txinfo.ri_first[0]));\n\tLMC_CSR_WRITE(sc, csr_rxlist,\n\t\t\tLMC_KVATOPHYS(sc, &sc->lmc_rxinfo.ri_first[0]));\n\tLMC_CSR_WRITE(sc, csr_busmode,\n\t\t\t(1 << (LMC_BURSTSIZE(sc->lmc_unit) + 8))\n\t\t\t|TULIP_BUSMODE_CACHE_ALIGN8\n\t\t\t|TULIP_BUSMODE_READMULTIPLE\n\t\t\t|(BYTE_ORDER != LITTLE_ENDIAN ? TULIP_BUSMODE_BIGENDIAN : 0));\n\n\tsc->lmc_txq.ifq_maxlen = LMC_TXDESCS;\n\n\t/*\n\t * Free all the mbufs that were on the transmit ring.\n\t */\n\tfor (;;) {\n\t\tstruct mbuf *m;\n\n\t\tIF_DEQUEUE(&sc->lmc_txq, m);\n\t\tif (m == NULL)\n\t\t\tbreak;\n\t\tm_freem(m);\n\t}\n\n\t/*\n\t * reset descriptor state and reclaim all descriptors.\n\t */\n\tri = &sc->lmc_txinfo;\n\tri->ri_nextin = ri->ri_nextout = ri->ri_first;\n\tri->ri_free = ri->ri_max;\n\tfor (di = ri->ri_first; di < ri->ri_last; di++)\n\t\tdi->d_status = 0;\n\n\t/*\n\t * We need to collect all the mbufs were on the \n\t * receive ring before we reinit it either to put\n\t * them back on or to know if we have to allocate\n\t * more.\n\t */\n\tri = &sc->lmc_rxinfo;\n\tri->ri_nextin = ri->ri_nextout = ri->ri_first;\n\tri->ri_free = ri->ri_max;\n\tfor (di = ri->ri_first; di < ri->ri_last; di++) {\n\t\tdi->d_status = 0;\n\t\tdi->d_length1 = 0; di->d_addr1 = 0;\n\t\tdi->d_length2 = 0; di->d_addr2 = 0;\n\t}\n\tfor (;;) {\n\t\tstruct mbuf *m;\n\t\tIF_DEQUEUE(&sc->lmc_rxq, m);\n\t\tif (m == NULL)\n\t\t\tbreak;\n\t\tm_freem(m);\n\t}\n#endif\n}"
  },
  {
    "function_name": "lmc_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
    "lines": "207-248",
    "snippet": "void\nlmc_reset(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 |= LMC_MII16_FIFO_RESET;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n\n\tsc->lmc_miireg16 &= ~LMC_MII16_FIFO_RESET;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n\n\t/*\n\t * make some of the GPIO pins be outputs\n\t */\n\tlmc_gpio_mkoutput(sc, LMC_GEP_DP | LMC_GEP_RESET);\n\n\t/*\n\t * drive DP and RESET low to force configuration.  This also forces\n\t * the transmitter clock to be internal, but we expect to reset\n\t * that later anyway.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_DP | LMC_GEP_RESET);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * hold for more than 10 microseconds\n\t */\n\tDELAY(50);\n\n\t/*\n\t * stop driving Xilinx-related signals\n\t */\n\tlmc_gpio_mkinput(sc, LMC_GEP_DP | LMC_GEP_RESET);\n\n\t/*\n\t * busy wait for the chip to reset\n\t */\n\twhile ((LMC_CSR_READ(sc, csr_gp) & LMC_GEP_DP) == 0);\n\n\t/*\n\t * Call media specific init routine\n\t */\n\tsc->lmc_media->init(sc);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc->lmc_media->init",
          "args": [
            "sc"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_READ",
          "args": [
            "sc",
            "csr_gp"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lmc_gpio_mkinput",
          "args": [
            "sc",
            "LMC_GEP_DP | LMC_GEP_RESET"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_gpio_mkinput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "179-184",
          "snippet": "void\nlmc_gpio_mkinput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io &= ~bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkinput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io &= ~bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "50"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lmc_gpio_mkoutput",
          "args": [
            "sc",
            "LMC_GEP_DP | LMC_GEP_RESET"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_gpio_mkoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "186-191",
          "snippet": "void\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_reset(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 |= LMC_MII16_FIFO_RESET;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n\n\tsc->lmc_miireg16 &= ~LMC_MII16_FIFO_RESET;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n\n\t/*\n\t * make some of the GPIO pins be outputs\n\t */\n\tlmc_gpio_mkoutput(sc, LMC_GEP_DP | LMC_GEP_RESET);\n\n\t/*\n\t * drive DP and RESET low to force configuration.  This also forces\n\t * the transmitter clock to be internal, but we expect to reset\n\t * that later anyway.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_DP | LMC_GEP_RESET);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * hold for more than 10 microseconds\n\t */\n\tDELAY(50);\n\n\t/*\n\t * stop driving Xilinx-related signals\n\t */\n\tlmc_gpio_mkinput(sc, LMC_GEP_DP | LMC_GEP_RESET);\n\n\t/*\n\t * busy wait for the chip to reset\n\t */\n\twhile ((LMC_CSR_READ(sc, csr_gp) & LMC_GEP_DP) == 0);\n\n\t/*\n\t * Call media specific init routine\n\t */\n\tsc->lmc_media->init(sc);\n}"
  },
  {
    "function_name": "lmc_led_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
    "lines": "200-205",
    "snippet": "void\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_led_on",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
    "lines": "193-198",
    "snippet": "void\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_gpio_mkoutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
    "lines": "186-191",
    "snippet": "void\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "TULIP_GP_PINSET | (sc->lmc_gpio_io)"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
  },
  {
    "function_name": "lmc_gpio_mkinput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
    "lines": "179-184",
    "snippet": "void\nlmc_gpio_mkinput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io &= ~bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "TULIP_GP_PINSET | (sc->lmc_gpio_io)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkinput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io &= ~bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
  }
]