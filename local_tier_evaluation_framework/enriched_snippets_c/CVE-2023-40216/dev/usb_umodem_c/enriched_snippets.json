[
  {
    "function_name": "umodem_activate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "604-624",
    "snippet": "int\numodem_activate(self, act)\n\tdevice_ptr_t self;\n\tenum devact act;\n{\n\tstruct umodem_softc *sc = (struct umodem_softc *)self;\n\tint rv = 0;\n\n\tswitch (act) {\n\tcase DVACT_ACTIVATE:\n\t\treturn (EOPNOTSUPP);\n\t\tbreak;\n\n\tcase DVACT_DEACTIVATE:\n\t\tsc->sc_dying = 1;\n\t\tif (sc->sc_subdev)\n\t\t\trv = config_deactivate(sc->sc_subdev);\n\t\tbreak;\n\t}\n\treturn (rv);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_deactivate",
          "args": [
            "sc->sc_subdev"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nint\numodem_activate(self, act)\n\tdevice_ptr_t self;\n\tenum devact act;\n{\n\tstruct umodem_softc *sc = (struct umodem_softc *)self;\n\tint rv = 0;\n\n\tswitch (act) {\n\tcase DVACT_ACTIVATE:\n\t\treturn (EOPNOTSUPP);\n\t\tbreak;\n\n\tcase DVACT_DEACTIVATE:\n\t\tsc->sc_dying = 1;\n\t\tif (sc->sc_subdev)\n\t\t\trv = config_deactivate(sc->sc_subdev);\n\t\tbreak;\n\t}\n\treturn (rv);\n}"
  },
  {
    "function_name": "umodem_set_comm_feature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "574-602",
    "snippet": "usbd_status\numodem_set_comm_feature(sc, feature, state)\n\tstruct umodem_softc *sc;\n\tint feature;\n\tint state;\n{\n\tusb_device_request_t req;\n\tusbd_status err;\n\tusb_cdc_abstract_state_t ast;\n\n\tDPRINTF((\"umodem_set_comm_feature: feature=%d state=%d\\n\", feature,\n\t\t state));\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_COMM_FEATURE;\n\tUSETW(req.wValue, feature);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, UCDC_ABSTRACT_STATE_LENGTH);\n\tUSETW(ast.wState, state);\n\n\terr = usbd_do_request(sc->sc_udev, &req, &ast);\n\tif (err) {\n\t\tDPRINTF((\"umodem_set_comm_feature: feature=%d, err=%s\\n\",\n\t\t\t feature, usbd_errstr(err)));\n\t\treturn (err);\n\t}\n\n\treturn (USBD_NORMAL_COMPLETION);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Static usbd_status",
      "umodem_set_comm_feature\n\t\t__P((struct umodem_softc *sc, int feature, int state));",
      "Static usbd_status",
      "umodem_set_line_coding\n\t\t__P((struct umodem_softc *sc, usb_cdc_line_state_t *state));",
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_set_comm_feature: feature=%d, err=%s\\n\",\n\t\t\t feature, usbd_errstr(err))"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usbd_errstr",
          "args": [
            "err"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usbd_do_request",
          "args": [
            "sc->sc_udev",
            "&req",
            "&ast"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "usbd_do_request_async",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/usbdi.c",
          "lines": "1059-1079",
          "snippet": "usbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}",
          "includes": [
            "#include \"usb_if.h\"",
            "#include <dev/usb/usb_mem.h>",
            "#include <dev/usb/usbdivar.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usb.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <machine/cpu.h>",
            "#include \"usb_if.h\"",
            "#include <sys/conf.h>",
            "#include <sys/bus.h>",
            "#include <sys/module.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Static usbd_status",
            "usbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));",
            "Static usbd_status",
            "usbd_xfer_isread __P((usbd_xfer_handle xfer));",
            "void *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;",
            "void *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;",
            "usb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;",
            "usb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;",
            "struct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"usb_if.h\"\n#include <dev/usb/usb_mem.h>\n#include <dev/usb/usbdivar.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usb.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <machine/cpu.h>\n#include \"usb_if.h\"\n#include <sys/conf.h>\n#include <sys/bus.h>\n#include <sys/module.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\nusbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));\nStatic usbd_status;\nusbd_xfer_isread __P((usbd_xfer_handle xfer));\nvoid *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;\nvoid *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;\nusb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;\nusb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;\nstruct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;\n\nusbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}"
        }
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "ast.wState",
            "state"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wLength",
            "UCDC_ABSTRACT_STATE_LENGTH"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wIndex",
            "sc->sc_ctl_iface_no"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wValue",
            "feature"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_set_comm_feature: feature=%d state=%d\\n\", feature,\n\t\t state)"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\numodem_set_comm_feature\n\t\t__P((struct umodem_softc *sc, int feature, int state));\nStatic usbd_status;\numodem_set_line_coding\n\t\t__P((struct umodem_softc *sc, usb_cdc_line_state_t *state));\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nusbd_status\numodem_set_comm_feature(sc, feature, state)\n\tstruct umodem_softc *sc;\n\tint feature;\n\tint state;\n{\n\tusb_device_request_t req;\n\tusbd_status err;\n\tusb_cdc_abstract_state_t ast;\n\n\tDPRINTF((\"umodem_set_comm_feature: feature=%d state=%d\\n\", feature,\n\t\t state));\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_COMM_FEATURE;\n\tUSETW(req.wValue, feature);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, UCDC_ABSTRACT_STATE_LENGTH);\n\tUSETW(ast.wState, state);\n\n\terr = usbd_do_request(sc->sc_udev, &req, &ast);\n\tif (err) {\n\t\tDPRINTF((\"umodem_set_comm_feature: feature=%d, err=%s\\n\",\n\t\t\t feature, usbd_errstr(err)));\n\t\treturn (err);\n\t}\n\n\treturn (USBD_NORMAL_COMPLETION);\n}"
  },
  {
    "function_name": "umodem_set_line_coding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "517-550",
    "snippet": "usbd_status\numodem_set_line_coding(sc, state)\n\tstruct umodem_softc *sc;\n\tusb_cdc_line_state_t *state;\n{\n\tusb_device_request_t req;\n\tusbd_status err;\n\n\tDPRINTF((\"umodem_set_line_coding: rate=%d fmt=%d parity=%d bits=%d\\n\",\n\t\t UGETDW(state->dwDTERate), state->bCharFormat,\n\t\t state->bParityType, state->bDataBits));\n\n\tif (memcmp(state, &sc->sc_line_state, UCDC_LINE_STATE_LENGTH) == 0) {\n\t\tDPRINTF((\"umodem_set_line_coding: already set\\n\"));\n\t\treturn (USBD_NORMAL_COMPLETION);\n\t}\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_LINE_CODING;\n\tUSETW(req.wValue, 0);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, UCDC_LINE_STATE_LENGTH);\n\n\terr = usbd_do_request(sc->sc_udev, &req, state);\n\tif (err) {\n\t\tDPRINTF((\"umodem_set_line_coding: failed, err=%s\\n\", \n\t\t\t usbd_errstr(err)));\n\t\treturn (err);\n\t}\n\n\tsc->sc_line_state = *state;\n\n\treturn (USBD_NORMAL_COMPLETION);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Static usbd_status",
      "umodem_set_comm_feature\n\t\t__P((struct umodem_softc *sc, int feature, int state));",
      "Static usbd_status",
      "umodem_set_line_coding\n\t\t__P((struct umodem_softc *sc, usb_cdc_line_state_t *state));",
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_set_line_coding: failed, err=%s\\n\", \n\t\t\t usbd_errstr(err))"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usbd_errstr",
          "args": [
            "err"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usbd_do_request",
          "args": [
            "sc->sc_udev",
            "&req",
            "state"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "usbd_do_request_async",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/usbdi.c",
          "lines": "1059-1079",
          "snippet": "usbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}",
          "includes": [
            "#include \"usb_if.h\"",
            "#include <dev/usb/usb_mem.h>",
            "#include <dev/usb/usbdivar.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usb.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <machine/cpu.h>",
            "#include \"usb_if.h\"",
            "#include <sys/conf.h>",
            "#include <sys/bus.h>",
            "#include <sys/module.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Static usbd_status",
            "usbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));",
            "Static usbd_status",
            "usbd_xfer_isread __P((usbd_xfer_handle xfer));",
            "void *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;",
            "void *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;",
            "usb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;",
            "usb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;",
            "struct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"usb_if.h\"\n#include <dev/usb/usb_mem.h>\n#include <dev/usb/usbdivar.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usb.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <machine/cpu.h>\n#include \"usb_if.h\"\n#include <sys/conf.h>\n#include <sys/bus.h>\n#include <sys/module.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\nusbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));\nStatic usbd_status;\nusbd_xfer_isread __P((usbd_xfer_handle xfer));\nvoid *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;\nvoid *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;\nusb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;\nusb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;\nstruct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;\n\nusbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}"
        }
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wLength",
            "UCDC_LINE_STATE_LENGTH"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wIndex",
            "sc->sc_ctl_iface_no"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wValue",
            "0"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_set_line_coding: already set\\n\")"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "state",
            "&sc->sc_line_state",
            "UCDC_LINE_STATE_LENGTH"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_set_line_coding: rate=%d fmt=%d parity=%d bits=%d\\n\",\n\t\t UGETDW(state->dwDTERate), state->bCharFormat,\n\t\t state->bParityType, state->bDataBits)"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UGETDW",
          "args": [
            "state->dwDTERate"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\numodem_set_comm_feature\n\t\t__P((struct umodem_softc *sc, int feature, int state));\nStatic usbd_status;\numodem_set_line_coding\n\t\t__P((struct umodem_softc *sc, usb_cdc_line_state_t *state));\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nusbd_status\numodem_set_line_coding(sc, state)\n\tstruct umodem_softc *sc;\n\tusb_cdc_line_state_t *state;\n{\n\tusb_device_request_t req;\n\tusbd_status err;\n\n\tDPRINTF((\"umodem_set_line_coding: rate=%d fmt=%d parity=%d bits=%d\\n\",\n\t\t UGETDW(state->dwDTERate), state->bCharFormat,\n\t\t state->bParityType, state->bDataBits));\n\n\tif (memcmp(state, &sc->sc_line_state, UCDC_LINE_STATE_LENGTH) == 0) {\n\t\tDPRINTF((\"umodem_set_line_coding: already set\\n\"));\n\t\treturn (USBD_NORMAL_COMPLETION);\n\t}\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_LINE_CODING;\n\tUSETW(req.wValue, 0);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, UCDC_LINE_STATE_LENGTH);\n\n\terr = usbd_do_request(sc->sc_udev, &req, state);\n\tif (err) {\n\t\tDPRINTF((\"umodem_set_line_coding: failed, err=%s\\n\", \n\t\t\t usbd_errstr(err)));\n\t\treturn (err);\n\t}\n\n\tsc->sc_line_state = *state;\n\n\treturn (USBD_NORMAL_COMPLETION);\n}"
  },
  {
    "function_name": "umodem_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "493-515",
    "snippet": "void\numodem_set(addr, portno, reg, onoff)\n\tvoid *addr;\n\tint portno;\n\tint reg;\n\tint onoff;\n{\n\tstruct umodem_softc *sc = addr;\n\n\tswitch (reg) {\n\tcase UCOM_SET_DTR:\n\t\tumodem_dtr(sc, onoff);\n\t\tbreak;\n\tcase UCOM_SET_RTS:\n\t\tumodem_rts(sc, onoff);\n\t\tbreak;\n\tcase UCOM_SET_BREAK:\n\t\tumodem_break(sc, onoff);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "umodem_break",
          "args": [
            "sc",
            "onoff"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "umodem_break",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
          "lines": "472-491",
          "snippet": "void\numodem_break(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tusb_device_request_t req;\n\n\tDPRINTF((\"umodem_break: onoff=%d\\n\", onoff));\n\n\tif (!(sc->sc_acm_cap & USB_CDC_ACM_HAS_BREAK))\n\t\treturn;\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SEND_BREAK;\n\tUSETW(req.wValue, onoff ? UCDC_BREAK_ON : UCDC_BREAK_OFF);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n}",
          "includes": [
            "#include <dev/usb/ucomvar.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usb_quirks.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usbcdc.h>",
            "#include <dev/usb/usb.h>",
            "#include <sys/poll.h>",
            "#include <sys/device.h>",
            "#include <sys/vnode.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/file.h>",
            "#include <sys/tty.h>",
            "#include <sys/conf.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "umodem_dtr\t__P((struct umodem_softc *, int));",
            "umodem_rts\t__P((struct umodem_softc *, int));",
            "umodem_break\t__P((struct umodem_softc *, int));",
            "umodem_set_line_state __P((struct umodem_softc *));",
            "Static struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_break(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tusb_device_request_t req;\n\n\tDPRINTF((\"umodem_break: onoff=%d\\n\", onoff));\n\n\tif (!(sc->sc_acm_cap & USB_CDC_ACM_HAS_BREAK))\n\t\treturn;\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SEND_BREAK;\n\tUSETW(req.wValue, onoff ? UCDC_BREAK_ON : UCDC_BREAK_OFF);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "umodem_rts",
          "args": [
            "sc",
            "onoff"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "umodem_rts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
          "lines": "439-451",
          "snippet": "void\numodem_rts(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_rts == onoff)\n\t\treturn;\n\tsc->sc_rts = onoff;\n\n\tumodem_set_line_state(sc);\n}",
          "includes": [
            "#include <dev/usb/ucomvar.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usb_quirks.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usbcdc.h>",
            "#include <dev/usb/usb.h>",
            "#include <sys/poll.h>",
            "#include <sys/device.h>",
            "#include <sys/vnode.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/file.h>",
            "#include <sys/tty.h>",
            "#include <sys/conf.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "umodem_dtr\t__P((struct umodem_softc *, int));",
            "umodem_rts\t__P((struct umodem_softc *, int));",
            "umodem_break\t__P((struct umodem_softc *, int));",
            "umodem_set_line_state __P((struct umodem_softc *));",
            "Static struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_rts(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_rts == onoff)\n\t\treturn;\n\tsc->sc_rts = onoff;\n\n\tumodem_set_line_state(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "umodem_dtr",
          "args": [
            "sc",
            "onoff"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "umodem_dtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
          "lines": "425-437",
          "snippet": "void\numodem_dtr(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_dtr == onoff)\n\t\treturn;\n\tsc->sc_dtr = onoff;\n\n\tumodem_set_line_state(sc);\n}",
          "includes": [
            "#include <dev/usb/ucomvar.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usb_quirks.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usbcdc.h>",
            "#include <dev/usb/usb.h>",
            "#include <sys/poll.h>",
            "#include <sys/device.h>",
            "#include <sys/vnode.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/file.h>",
            "#include <sys/tty.h>",
            "#include <sys/conf.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "umodem_dtr\t__P((struct umodem_softc *, int));",
            "umodem_rts\t__P((struct umodem_softc *, int));",
            "umodem_break\t__P((struct umodem_softc *, int));",
            "umodem_set_line_state __P((struct umodem_softc *));",
            "Static struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_dtr(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_dtr == onoff)\n\t\treturn;\n\tsc->sc_dtr = onoff;\n\n\tumodem_set_line_state(sc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_set(addr, portno, reg, onoff)\n\tvoid *addr;\n\tint portno;\n\tint reg;\n\tint onoff;\n{\n\tstruct umodem_softc *sc = addr;\n\n\tswitch (reg) {\n\tcase UCOM_SET_DTR:\n\t\tumodem_dtr(sc, onoff);\n\t\tbreak;\n\tcase UCOM_SET_RTS:\n\t\tumodem_rts(sc, onoff);\n\t\tbreak;\n\tcase UCOM_SET_BREAK:\n\t\tumodem_break(sc, onoff);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "umodem_break",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "472-491",
    "snippet": "void\numodem_break(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tusb_device_request_t req;\n\n\tDPRINTF((\"umodem_break: onoff=%d\\n\", onoff));\n\n\tif (!(sc->sc_acm_cap & USB_CDC_ACM_HAS_BREAK))\n\t\treturn;\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SEND_BREAK;\n\tUSETW(req.wValue, onoff ? UCDC_BREAK_ON : UCDC_BREAK_OFF);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "usbd_do_request",
          "args": [
            "sc->sc_udev",
            "&req",
            "0"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "usbd_do_request_async",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/usbdi.c",
          "lines": "1059-1079",
          "snippet": "usbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}",
          "includes": [
            "#include \"usb_if.h\"",
            "#include <dev/usb/usb_mem.h>",
            "#include <dev/usb/usbdivar.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usb.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <machine/cpu.h>",
            "#include \"usb_if.h\"",
            "#include <sys/conf.h>",
            "#include <sys/bus.h>",
            "#include <sys/module.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Static usbd_status",
            "usbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));",
            "Static usbd_status",
            "usbd_xfer_isread __P((usbd_xfer_handle xfer));",
            "void *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;",
            "void *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;",
            "usb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;",
            "usb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;",
            "struct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"usb_if.h\"\n#include <dev/usb/usb_mem.h>\n#include <dev/usb/usbdivar.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usb.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <machine/cpu.h>\n#include \"usb_if.h\"\n#include <sys/conf.h>\n#include <sys/bus.h>\n#include <sys/module.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\nusbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));\nStatic usbd_status;\nusbd_xfer_isread __P((usbd_xfer_handle xfer));\nvoid *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;\nvoid *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;\nusb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;\nusb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;\nstruct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;\n\nusbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}"
        }
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wLength",
            "0"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wIndex",
            "sc->sc_ctl_iface_no"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wValue",
            "onoff ? UCDC_BREAK_ON : UCDC_BREAK_OFF"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_break: onoff=%d\\n\", onoff)"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_break(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tusb_device_request_t req;\n\n\tDPRINTF((\"umodem_break: onoff=%d\\n\", onoff));\n\n\tif (!(sc->sc_acm_cap & USB_CDC_ACM_HAS_BREAK))\n\t\treturn;\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SEND_BREAK;\n\tUSETW(req.wValue, onoff ? UCDC_BREAK_ON : UCDC_BREAK_OFF);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n}"
  },
  {
    "function_name": "umodem_set_line_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "453-470",
    "snippet": "void\numodem_set_line_state(sc)\n\tstruct umodem_softc *sc;\n{\n\tusb_device_request_t req;\n\tint ls;\n\n\tls = (sc->sc_dtr ? UCDC_LINE_DTR : 0) |\n\t     (sc->sc_rts ? UCDC_LINE_RTS : 0);\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_CONTROL_LINE_STATE;\n\tUSETW(req.wValue, ls);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "usbd_do_request",
          "args": [
            "sc->sc_udev",
            "&req",
            "0"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "usbd_do_request_async",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/usbdi.c",
          "lines": "1059-1079",
          "snippet": "usbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}",
          "includes": [
            "#include \"usb_if.h\"",
            "#include <dev/usb/usb_mem.h>",
            "#include <dev/usb/usbdivar.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usb.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <machine/cpu.h>",
            "#include \"usb_if.h\"",
            "#include <sys/conf.h>",
            "#include <sys/bus.h>",
            "#include <sys/module.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Static usbd_status",
            "usbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));",
            "Static usbd_status",
            "usbd_xfer_isread __P((usbd_xfer_handle xfer));",
            "void *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;",
            "void *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;",
            "usb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;",
            "usb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;",
            "struct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"usb_if.h\"\n#include <dev/usb/usb_mem.h>\n#include <dev/usb/usbdivar.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usb.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <machine/cpu.h>\n#include \"usb_if.h\"\n#include <sys/conf.h>\n#include <sys/bus.h>\n#include <sys/module.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\nusbd_do_request_async_cb \n    __P((usbd_xfer_handle, usbd_private_handle, usbd_status));\nStatic usbd_status;\nusbd_xfer_isread __P((usbd_xfer_handle xfer));\nvoid *\nusbd_alloc_buffer(xfer, size)\n\tusbd_xfer_handle xfer;\nvoid *\nusbd_get_buffer(xfer)\n\tusbd_xfer_handle xfer;\nusb_config_descriptor_t *\nusbd_get_config_descriptor(dev)\n\tusbd_device_handle dev;\nusb_device_descriptor_t *\nusbd_get_device_descriptor(dev)\n\tusbd_device_handle dev;\nstruct usbd_quirks *\nusbd_get_quirks(dev)\n\tusbd_device_handle dev;\n\nusbd_status\nusbd_do_request_async(dev, req, data)\n\tusbd_device_handle dev;\n\tusb_device_request_t *req;\n\tvoid *data;\n{\n\tusbd_xfer_handle xfer;\n\tusbd_status err;\n\n\txfer = usbd_alloc_xfer(dev);\n\tif (xfer == NULL)\n\t\treturn (USBD_NOMEM);\n\tusbd_setup_default_xfer(xfer, dev, 0, USBD_DEFAULT_TIMEOUT, req,\n\t    data, UGETW(req->wLength), 0, usbd_do_request_async_cb);\n\terr = usbd_transfer(xfer);\n\tif (err != USBD_IN_PROGRESS) {\n\t\tusbd_free_xfer(xfer);\n\t\treturn (err);\n\t}\n\treturn (USBD_NORMAL_COMPLETION);\n}"
        }
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wLength",
            "0"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wIndex",
            "sc->sc_ctl_iface_no"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETW",
          "args": [
            "req.wValue",
            "ls"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_set_line_state(sc)\n\tstruct umodem_softc *sc;\n{\n\tusb_device_request_t req;\n\tint ls;\n\n\tls = (sc->sc_dtr ? UCDC_LINE_DTR : 0) |\n\t     (sc->sc_rts ? UCDC_LINE_RTS : 0);\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_CONTROL_LINE_STATE;\n\tUSETW(req.wValue, ls);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n\n}"
  },
  {
    "function_name": "umodem_rts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "439-451",
    "snippet": "void\numodem_rts(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_rts == onoff)\n\t\treturn;\n\tsc->sc_rts = onoff;\n\n\tumodem_set_line_state(sc);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "umodem_set_line_state",
          "args": [
            "sc"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "umodem_set_line_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
          "lines": "453-470",
          "snippet": "void\numodem_set_line_state(sc)\n\tstruct umodem_softc *sc;\n{\n\tusb_device_request_t req;\n\tint ls;\n\n\tls = (sc->sc_dtr ? UCDC_LINE_DTR : 0) |\n\t     (sc->sc_rts ? UCDC_LINE_RTS : 0);\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_CONTROL_LINE_STATE;\n\tUSETW(req.wValue, ls);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n\n}",
          "includes": [
            "#include <dev/usb/ucomvar.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usb_quirks.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usbcdc.h>",
            "#include <dev/usb/usb.h>",
            "#include <sys/poll.h>",
            "#include <sys/device.h>",
            "#include <sys/vnode.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/file.h>",
            "#include <sys/tty.h>",
            "#include <sys/conf.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "umodem_dtr\t__P((struct umodem_softc *, int));",
            "umodem_rts\t__P((struct umodem_softc *, int));",
            "umodem_break\t__P((struct umodem_softc *, int));",
            "umodem_set_line_state __P((struct umodem_softc *));",
            "Static struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_set_line_state(sc)\n\tstruct umodem_softc *sc;\n{\n\tusb_device_request_t req;\n\tint ls;\n\n\tls = (sc->sc_dtr ? UCDC_LINE_DTR : 0) |\n\t     (sc->sc_rts ? UCDC_LINE_RTS : 0);\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_CONTROL_LINE_STATE;\n\tUSETW(req.wValue, ls);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_modem: onoff=%d\\n\", onoff)"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_rts(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_rts == onoff)\n\t\treturn;\n\tsc->sc_rts = onoff;\n\n\tumodem_set_line_state(sc);\n}"
  },
  {
    "function_name": "umodem_dtr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "425-437",
    "snippet": "void\numodem_dtr(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_dtr == onoff)\n\t\treturn;\n\tsc->sc_dtr = onoff;\n\n\tumodem_set_line_state(sc);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "umodem_set_line_state",
          "args": [
            "sc"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "umodem_set_line_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
          "lines": "453-470",
          "snippet": "void\numodem_set_line_state(sc)\n\tstruct umodem_softc *sc;\n{\n\tusb_device_request_t req;\n\tint ls;\n\n\tls = (sc->sc_dtr ? UCDC_LINE_DTR : 0) |\n\t     (sc->sc_rts ? UCDC_LINE_RTS : 0);\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_CONTROL_LINE_STATE;\n\tUSETW(req.wValue, ls);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n\n}",
          "includes": [
            "#include <dev/usb/ucomvar.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usb_quirks.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usbcdc.h>",
            "#include <dev/usb/usb.h>",
            "#include <sys/poll.h>",
            "#include <sys/device.h>",
            "#include <sys/vnode.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/file.h>",
            "#include <sys/tty.h>",
            "#include <sys/conf.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "umodem_dtr\t__P((struct umodem_softc *, int));",
            "umodem_rts\t__P((struct umodem_softc *, int));",
            "umodem_break\t__P((struct umodem_softc *, int));",
            "umodem_set_line_state __P((struct umodem_softc *));",
            "Static struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_set_line_state(sc)\n\tstruct umodem_softc *sc;\n{\n\tusb_device_request_t req;\n\tint ls;\n\n\tls = (sc->sc_dtr ? UCDC_LINE_DTR : 0) |\n\t     (sc->sc_rts ? UCDC_LINE_RTS : 0);\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_CONTROL_LINE_STATE;\n\tUSETW(req.wValue, ls);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, 0);\n\n\t(void)usbd_do_request(sc->sc_udev, &req, 0);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_modem: onoff=%d\\n\", onoff)"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nvoid\numodem_dtr(sc, onoff)\n\tstruct umodem_softc *sc;\n\tint onoff;\n{\n\tDPRINTF((\"umodem_modem: onoff=%d\\n\", onoff));\n\n\tif (sc->sc_dtr == onoff)\n\t\treturn;\n\tsc->sc_dtr = onoff;\n\n\tumodem_set_line_state(sc);\n}"
  },
  {
    "function_name": "umodem_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "388-423",
    "snippet": "int\numodem_ioctl(addr, portno, cmd, data, flag, p)\n\tvoid *addr;\n\tint portno;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct umodem_softc *sc = addr;\n\tint error = 0;\n\n\tif (sc->sc_dying)\n\t\treturn (EIO);\n \n\tDPRINTF((\"umodemioctl: cmd=0x%08lx\\n\", cmd));\n\n\tswitch (cmd) {\n\tcase USB_GET_CM_OVER_DATA:\n\t\t*(int *)data = sc->sc_cm_over_data;\n\t\tbreak;\n\n\tcase USB_SET_CM_OVER_DATA:\n\t\tif (*(int *)data != sc->sc_cm_over_data) {\n\t\t\t/* XXX change it */\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tDPRINTF((\"umodemioctl: unknown\\n\"));\n\t\terror = ENOTTY;\n\t\tbreak;\n\t}\n\n\treturn (error);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "umodem_ioctl\t__P((void *, int, u_long, caddr_t, int,\n\t\t\t\t     struct proc *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodemioctl: unknown\\n\")"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodemioctl: cmd=0x%08lx\\n\", cmd)"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\numodem_ioctl\t__P((void *, int, u_long, caddr_t, int,\n\t\t\t\t     struct proc *));\nStatic struct;\n\nint\numodem_ioctl(addr, portno, cmd, data, flag, p)\n\tvoid *addr;\n\tint portno;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct umodem_softc *sc = addr;\n\tint error = 0;\n\n\tif (sc->sc_dying)\n\t\treturn (EIO);\n \n\tDPRINTF((\"umodemioctl: cmd=0x%08lx\\n\", cmd));\n\n\tswitch (cmd) {\n\tcase USB_GET_CM_OVER_DATA:\n\t\t*(int *)data = sc->sc_cm_over_data;\n\t\tbreak;\n\n\tcase USB_SET_CM_OVER_DATA:\n\t\tif (*(int *)data != sc->sc_cm_over_data) {\n\t\t\t/* XXX change it */\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tDPRINTF((\"umodemioctl: unknown\\n\"));\n\t\terror = ENOTTY;\n\t\tbreak;\n\t}\n\n\treturn (error);\n}"
  },
  {
    "function_name": "umodem_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "341-386",
    "snippet": "int\numodem_param(addr, portno, t)\n\tvoid *addr;\n\tint portno;\n\tstruct termios *t;\n{\n\tstruct umodem_softc *sc = addr;\n\tusbd_status err;\n\tusb_cdc_line_state_t ls;\n\n\tDPRINTF((\"umodem_param: sc=%p\\n\", sc));\n\n\tUSETDW(ls.dwDTERate, t->c_ospeed);\n\tif (ISSET(t->c_cflag, CSTOPB))\n\t\tls.bCharFormat = UCDC_STOP_BIT_2;\n\telse\n\t\tls.bCharFormat = UCDC_STOP_BIT_1;\n\tif (ISSET(t->c_cflag, PARENB)) {\n\t\tif (ISSET(t->c_cflag, PARODD))\n\t\t\tls.bParityType = UCDC_PARITY_ODD;\n\t\telse\n\t\t\tls.bParityType = UCDC_PARITY_EVEN;\n\t} else\n\t\tls.bParityType = UCDC_PARITY_NONE;\n\tswitch (ISSET(t->c_cflag, CSIZE)) {\n\tcase CS5:\n\t\tls.bDataBits = 5;\n\t\tbreak;\n\tcase CS6:\n\t\tls.bDataBits = 6;\n\t\tbreak;\n\tcase CS7:\n\t\tls.bDataBits = 7;\n\t\tbreak;\n\tcase CS8:\n\t\tls.bDataBits = 8;\n\t\tbreak;\n\t}\n\n\terr = umodem_set_line_coding(sc, &ls);\n\tif (err) {\n\t\tDPRINTF((\"umodem_param: err=%s\\n\", usbd_errstr(err)));\n\t\treturn (1);\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Static usbd_status",
      "Static usbd_status",
      "umodem_dtr\t__P((struct umodem_softc *, int));",
      "umodem_rts\t__P((struct umodem_softc *, int));",
      "umodem_break\t__P((struct umodem_softc *, int));",
      "umodem_set_line_state __P((struct umodem_softc *));",
      "umodem_param\t__P((void *, int, struct termios *));",
      "Static struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_param: err=%s\\n\", usbd_errstr(err))"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usbd_errstr",
          "args": [
            "err"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "umodem_set_line_coding",
          "args": [
            "sc",
            "&ls"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "umodem_set_line_coding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
          "lines": "517-550",
          "snippet": "usbd_status\numodem_set_line_coding(sc, state)\n\tstruct umodem_softc *sc;\n\tusb_cdc_line_state_t *state;\n{\n\tusb_device_request_t req;\n\tusbd_status err;\n\n\tDPRINTF((\"umodem_set_line_coding: rate=%d fmt=%d parity=%d bits=%d\\n\",\n\t\t UGETDW(state->dwDTERate), state->bCharFormat,\n\t\t state->bParityType, state->bDataBits));\n\n\tif (memcmp(state, &sc->sc_line_state, UCDC_LINE_STATE_LENGTH) == 0) {\n\t\tDPRINTF((\"umodem_set_line_coding: already set\\n\"));\n\t\treturn (USBD_NORMAL_COMPLETION);\n\t}\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_LINE_CODING;\n\tUSETW(req.wValue, 0);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, UCDC_LINE_STATE_LENGTH);\n\n\terr = usbd_do_request(sc->sc_udev, &req, state);\n\tif (err) {\n\t\tDPRINTF((\"umodem_set_line_coding: failed, err=%s\\n\", \n\t\t\t usbd_errstr(err)));\n\t\treturn (err);\n\t}\n\n\tsc->sc_line_state = *state;\n\n\treturn (USBD_NORMAL_COMPLETION);\n}",
          "includes": [
            "#include <dev/usb/ucomvar.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usb_quirks.h>",
            "#include <dev/usb/usbdevs.h>",
            "#include <dev/usb/usbdi_util.h>",
            "#include <dev/usb/usbdi.h>",
            "#include <dev/usb/usbcdc.h>",
            "#include <dev/usb/usb.h>",
            "#include <sys/poll.h>",
            "#include <sys/device.h>",
            "#include <sys/vnode.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/file.h>",
            "#include <sys/tty.h>",
            "#include <sys/conf.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Static usbd_status",
            "umodem_set_comm_feature\n\t\t__P((struct umodem_softc *sc, int feature, int state));",
            "Static usbd_status",
            "umodem_set_line_coding\n\t\t__P((struct umodem_softc *sc, usb_cdc_line_state_t *state));",
            "umodem_dtr\t__P((struct umodem_softc *, int));",
            "umodem_rts\t__P((struct umodem_softc *, int));",
            "umodem_break\t__P((struct umodem_softc *, int));",
            "umodem_set_line_state __P((struct umodem_softc *));",
            "Static struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\numodem_set_comm_feature\n\t\t__P((struct umodem_softc *sc, int feature, int state));\nStatic usbd_status;\numodem_set_line_coding\n\t\t__P((struct umodem_softc *sc, usb_cdc_line_state_t *state));\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\nStatic struct;\n\nusbd_status\numodem_set_line_coding(sc, state)\n\tstruct umodem_softc *sc;\n\tusb_cdc_line_state_t *state;\n{\n\tusb_device_request_t req;\n\tusbd_status err;\n\n\tDPRINTF((\"umodem_set_line_coding: rate=%d fmt=%d parity=%d bits=%d\\n\",\n\t\t UGETDW(state->dwDTERate), state->bCharFormat,\n\t\t state->bParityType, state->bDataBits));\n\n\tif (memcmp(state, &sc->sc_line_state, UCDC_LINE_STATE_LENGTH) == 0) {\n\t\tDPRINTF((\"umodem_set_line_coding: already set\\n\"));\n\t\treturn (USBD_NORMAL_COMPLETION);\n\t}\n\n\treq.bmRequestType = UT_WRITE_CLASS_INTERFACE;\n\treq.bRequest = UCDC_SET_LINE_CODING;\n\tUSETW(req.wValue, 0);\n\tUSETW(req.wIndex, sc->sc_ctl_iface_no);\n\tUSETW(req.wLength, UCDC_LINE_STATE_LENGTH);\n\n\terr = usbd_do_request(sc->sc_udev, &req, state);\n\tif (err) {\n\t\tDPRINTF((\"umodem_set_line_coding: failed, err=%s\\n\", \n\t\t\t usbd_errstr(err)));\n\t\treturn (err);\n\t}\n\n\tsc->sc_line_state = *state;\n\n\treturn (USBD_NORMAL_COMPLETION);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISSET",
          "args": [
            "t->c_cflag",
            "CSIZE"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSET",
          "args": [
            "t->c_cflag",
            "PARODD"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSET",
          "args": [
            "t->c_cflag",
            "PARENB"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSET",
          "args": [
            "t->c_cflag",
            "CSTOPB"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USETDW",
          "args": [
            "ls.dwDTERate",
            "t->c_ospeed"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_param: sc=%p\\n\", sc)"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic usbd_status;\nStatic usbd_status;\numodem_dtr\t__P((struct umodem_softc *, int));\numodem_rts\t__P((struct umodem_softc *, int));\numodem_break\t__P((struct umodem_softc *, int));\numodem_set_line_state __P((struct umodem_softc *));\numodem_param\t__P((void *, int, struct termios *));\nStatic struct;\n\nint\numodem_param(addr, portno, t)\n\tvoid *addr;\n\tint portno;\n\tstruct termios *t;\n{\n\tstruct umodem_softc *sc = addr;\n\tusbd_status err;\n\tusb_cdc_line_state_t ls;\n\n\tDPRINTF((\"umodem_param: sc=%p\\n\", sc));\n\n\tUSETDW(ls.dwDTERate, t->c_ospeed);\n\tif (ISSET(t->c_cflag, CSTOPB))\n\t\tls.bCharFormat = UCDC_STOP_BIT_2;\n\telse\n\t\tls.bCharFormat = UCDC_STOP_BIT_1;\n\tif (ISSET(t->c_cflag, PARENB)) {\n\t\tif (ISSET(t->c_cflag, PARODD))\n\t\t\tls.bParityType = UCDC_PARITY_ODD;\n\t\telse\n\t\t\tls.bParityType = UCDC_PARITY_EVEN;\n\t} else\n\t\tls.bParityType = UCDC_PARITY_NONE;\n\tswitch (ISSET(t->c_cflag, CSIZE)) {\n\tcase CS5:\n\t\tls.bDataBits = 5;\n\t\tbreak;\n\tcase CS6:\n\t\tls.bDataBits = 6;\n\t\tbreak;\n\tcase CS7:\n\t\tls.bDataBits = 7;\n\t\tbreak;\n\tcase CS8:\n\t\tls.bDataBits = 8;\n\t\tbreak;\n\t}\n\n\terr = umodem_set_line_coding(sc, &ls);\n\tif (err) {\n\t\tDPRINTF((\"umodem_param: err=%s\\n\", usbd_errstr(err)));\n\t\treturn (1);\n\t}\n\treturn (0);\n}"
  },
  {
    "function_name": "umodem_get_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "327-339",
    "snippet": "void\numodem_get_status(addr, portno, lsr, msr)\n\tvoid *addr;\n\tint portno;\n\tu_char *lsr, *msr;\n{\n\tDPRINTF((\"umodem_get_status:\\n\"));\n\n\tif (lsr != NULL)\n\t\t*lsr = 0;\t/* XXX */\n\tif (msr != NULL)\n\t\t*msr = 0;\t/* XXX */\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "umodem_get_status\n\t\t__P((void *, int portno, u_char *lsr, u_char *msr));"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_get_status:\\n\")"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\numodem_get_status\n\t\t__P((void *, int portno, u_char *lsr, u_char *msr));\n\nvoid\numodem_get_status(addr, portno, lsr, msr)\n\tvoid *addr;\n\tint portno;\n\tu_char *lsr, *msr;\n{\n\tDPRINTF((\"umodem_get_status:\\n\"));\n\n\tif (lsr != NULL)\n\t\t*lsr = 0;\t/* XXX */\n\tif (msr != NULL)\n\t\t*msr = 0;\t/* XXX */\n}"
  },
  {
    "function_name": "umodem_get_caps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/usb/umodem.c",
    "lines": "302-325",
    "snippet": "void\numodem_get_caps(dev, cm, acm)\n\tusbd_device_handle dev;\n\tint *cm, *acm;\n{\n\tusb_cdc_cm_descriptor_t *cmd;\n\tusb_cdc_acm_descriptor_t *cad;\n\n\t*cm = *acm = 0;\n\n\tcmd = umodem_get_desc(dev, UDESC_CS_INTERFACE, UDESCSUB_CDC_CM);\n\tif (cmd == NULL) {\n\t\tDPRINTF((\"umodem_get_desc: no CM desc\\n\"));\n\t\treturn;\n\t}\n\t*cm = cmd->bmCapabilities;\n\n\tcad = umodem_get_desc(dev, UDESC_CS_INTERFACE, UDESCSUB_CDC_ACM);\n\tif (cad == NULL) {\n\t\tDPRINTF((\"umodem_get_desc: no ACM desc\\n\"));\n\t\treturn;\n\t}\n\t*acm = cad->bmCapabilities;\n}",
    "includes": [
      "#include <dev/usb/ucomvar.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usb_quirks.h>",
      "#include <dev/usb/usbdevs.h>",
      "#include <dev/usb/usbdi_util.h>",
      "#include <dev/usb/usbdi.h>",
      "#include <dev/usb/usbcdc.h>",
      "#include <dev/usb/usb.h>",
      "#include <sys/poll.h>",
      "#include <sys/device.h>",
      "#include <sys/vnode.h>",
      "#include <sys/proc.h>",
      "#include <sys/select.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/conf.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Static void\t*umodem_get_desc",
      "umodem_get_caps\t__P((usbd_device_handle, int *, int *));",
      "void *\numodem_get_desc(dev, type, subtype)\n\tusbd_device_handle dev;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_get_desc: no ACM desc\\n\")"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "umodem_get_desc",
          "args": [
            "dev",
            "UDESC_CS_INTERFACE",
            "UDESCSUB_CDC_ACM"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"umodem_get_desc: no CM desc\\n\")"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "umodem_get_desc",
          "args": [
            "dev",
            "UDESC_CS_INTERFACE",
            "UDESCSUB_CDC_CM"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/usb/ucomvar.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usb_quirks.h>\n#include <dev/usb/usbdevs.h>\n#include <dev/usb/usbdi_util.h>\n#include <dev/usb/usbdi.h>\n#include <dev/usb/usbcdc.h>\n#include <dev/usb/usb.h>\n#include <sys/poll.h>\n#include <sys/device.h>\n#include <sys/vnode.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/conf.h>\n#include <sys/ioctl.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nStatic void\t*umodem_get_desc;\numodem_get_caps\t__P((usbd_device_handle, int *, int *));\nvoid *\numodem_get_desc(dev, type, subtype)\n\tusbd_device_handle dev;\n\nvoid\numodem_get_caps(dev, cm, acm)\n\tusbd_device_handle dev;\n\tint *cm, *acm;\n{\n\tusb_cdc_cm_descriptor_t *cmd;\n\tusb_cdc_acm_descriptor_t *cad;\n\n\t*cm = *acm = 0;\n\n\tcmd = umodem_get_desc(dev, UDESC_CS_INTERFACE, UDESCSUB_CDC_CM);\n\tif (cmd == NULL) {\n\t\tDPRINTF((\"umodem_get_desc: no CM desc\\n\"));\n\t\treturn;\n\t}\n\t*cm = cmd->bmCapabilities;\n\n\tcad = umodem_get_desc(dev, UDESC_CS_INTERFACE, UDESCSUB_CDC_ACM);\n\tif (cad == NULL) {\n\t\tDPRINTF((\"umodem_get_desc: no ACM desc\\n\"));\n\t\treturn;\n\t}\n\t*acm = cad->bmCapabilities;\n}"
  }
]