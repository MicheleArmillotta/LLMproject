[
  {
    "function_name": "OF_clock_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "238-277",
    "snippet": "int\nOF_clock_read(int *sec, int *min, int *hour, int *day,\n         int *mon, int *yr)\n{\n\tstruct ofrtc_softc *of;\n        char path[256];\n        int l;\n\n\tif (!(of = ofrtc_cd.cd_devs[0]))\n\t\treturn 1;\n\tif ((l = OF_package_to_path(of->sc_phandle, path, sizeof path - 1)) < 0)\n\t\treturn 1;\n\tif (l >= sizeof path)\n\t\treturn 1;\n\tpath[l] = 0;\n\t\n\tif (!(of->sc_ihandle = OF_open(path))) {\n\t\tif (of->sc_ihandle) {\n\t\t\tOF_close(of->sc_ihandle);\n\t\t\tof->sc_ihandle = 0;\n\t\t}\n\t\treturn 1;\n\t}\n\tif (OF_call_method(\"get-time\", of->sc_ihandle, 0, 6,\n\t\t\tsec, min, hour, day, mon, yr))\n\t{\n\treturn 1;\n\t}\n\tprintf(\"y:%d m:%d d:%d H:%d M:%d S:%d\\n\",\n\t\t*yr, *mon, *day, *hour, *min, *sec);\n\t*yr -= YEAR0; /* bsd expects 0 - 200, not something like 1998 */\n\t*yr = TOBCD(*yr);\n\t*mon = TOBCD(*mon);\n\t*day = TOBCD(*day);\n\t*hour = TOBCD(*hour);\n\t*min = TOBCD(*min);\n\t*sec = TOBCD(*sec);\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define YEAR0\t\t1900"
    ],
    "globals_used": [
      "struct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};",
      "int OF_clock_read(int *sec, int *min, int *hour, int *day,\n         int *mon, int *yr);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TOBCD",
          "args": [
            "*sec"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TOBCD",
          "args": [
            "*min"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TOBCD",
          "args": [
            "*hour"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TOBCD",
          "args": [
            "*day"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TOBCD",
          "args": [
            "*mon"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TOBCD",
          "args": [
            "*yr"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"y:%d m:%d d:%d H:%d M:%d S:%d\\n\"",
            "*yr",
            "*mon",
            "*day",
            "*hour",
            "*min",
            "*sec"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "OF_call_method",
          "args": [
            "\"get-time\"",
            "of->sc_ihandle",
            "0",
            "6",
            "sec",
            "min",
            "hour",
            "day",
            "mon",
            "yr"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_close",
          "args": [
            "of->sc_ihandle"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_open",
          "args": [
            "path"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_package_to_path",
          "args": [
            "of->sc_phandle",
            "path",
            "sizeof path - 1"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\n#define YEAR0\t\t1900\n\nstruct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};\nint OF_clock_read(int *sec, int *min, int *hour, int *day,\n         int *mon, int *yr);\n\nint\nOF_clock_read(int *sec, int *min, int *hour, int *day,\n         int *mon, int *yr)\n{\n\tstruct ofrtc_softc *of;\n        char path[256];\n        int l;\n\n\tif (!(of = ofrtc_cd.cd_devs[0]))\n\t\treturn 1;\n\tif ((l = OF_package_to_path(of->sc_phandle, path, sizeof path - 1)) < 0)\n\t\treturn 1;\n\tif (l >= sizeof path)\n\t\treturn 1;\n\tpath[l] = 0;\n\t\n\tif (!(of->sc_ihandle = OF_open(path))) {\n\t\tif (of->sc_ihandle) {\n\t\t\tOF_close(of->sc_ihandle);\n\t\t\tof->sc_ihandle = 0;\n\t\t}\n\t\treturn 1;\n\t}\n\tif (OF_call_method(\"get-time\", of->sc_ihandle, 0, 6,\n\t\t\tsec, min, hour, day, mon, yr))\n\t{\n\treturn 1;\n\t}\n\tprintf(\"y:%d m:%d d:%d H:%d M:%d S:%d\\n\",\n\t\t*yr, *mon, *day, *hour, *min, *sec);\n\t*yr -= YEAR0; /* bsd expects 0 - 200, not something like 1998 */\n\t*yr = TOBCD(*yr);\n\t*mon = TOBCD(*mon);\n\t*day = TOBCD(*day);\n\t*hour = TOBCD(*hour);\n\t*min = TOBCD(*min);\n\t*sec = TOBCD(*sec);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ofrtcwrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "199-230",
    "snippet": "int\nofrtcwrite(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofrtc_softc *of = ofrtc_cd.cd_devs[minor(dev)];\n\tchar buf[14];\n\tint cnt, year, error;\n\t\n\t/*\n\t * We require atomic updates!\n\t */\n\tcnt = uio->uio_resid;\n\tif (uio->uio_offset || (cnt != sizeof buf && cnt != sizeof buf - 1))\n\t\treturn EINVAL;\n\t\n\tif (error = uiomove((caddr_t)buf, sizeof buf, uio))\n\t\treturn error;\n\n\tif (cnt == sizeof buf && buf[sizeof buf - 1] != '\\n')\n\t\treturn EINVAL;\n\t\n\tyear = twodigits(buf) + 1900;\n\tif (year < 1970)\n\t\tyear += 100;\n\tif (OF_call_method(\"set-time\", of->sc_ihandle, 6, 0,\n\t\t\t   twodigits(buf + 11), twodigits(buf + 8), twodigits(buf + 6),\n\t\t\t   twodigits(buf + 4), twodigits(buf + 2), year))\n\t\treturn EIO;\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "OF_call_method",
          "args": [
            "\"set-time\"",
            "of->sc_ihandle",
            "6",
            "0",
            "twodigits(buf + 11)",
            "twodigits(buf + 8)",
            "twodigits(buf + 6)",
            "twodigits(buf + 4)",
            "twodigits(buf + 2)",
            "year"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "twodigits",
          "args": [
            "buf + 2"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "twodigits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
          "lines": "154-162",
          "snippet": "static int\ntwodigits(bp)\n\tchar *bp;\n{\n\tint i;\n\t\n\ti = *bp++ - '0';\n\treturn i * 10 + *bp++ - '0';\n}",
          "includes": [
            "#include <dev/ofw/openfirm.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstatic int\ntwodigits(bp)\n\tchar *bp;\n{\n\tint i;\n\t\n\ti = *bp++ - '0';\n\treturn i * 10 + *bp++ - '0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "(caddr_t)buf",
            "sizeof buf",
            "uio"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstruct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};\n\nint\nofrtcwrite(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofrtc_softc *of = ofrtc_cd.cd_devs[minor(dev)];\n\tchar buf[14];\n\tint cnt, year, error;\n\t\n\t/*\n\t * We require atomic updates!\n\t */\n\tcnt = uio->uio_resid;\n\tif (uio->uio_offset || (cnt != sizeof buf && cnt != sizeof buf - 1))\n\t\treturn EINVAL;\n\t\n\tif (error = uiomove((caddr_t)buf, sizeof buf, uio))\n\t\treturn error;\n\n\tif (cnt == sizeof buf && buf[sizeof buf - 1] != '\\n')\n\t\treturn EINVAL;\n\t\n\tyear = twodigits(buf) + 1900;\n\tif (year < 1970)\n\t\tyear += 100;\n\tif (OF_call_method(\"set-time\", of->sc_ihandle, 6, 0,\n\t\t\t   twodigits(buf + 11), twodigits(buf + 8), twodigits(buf + 6),\n\t\t\t   twodigits(buf + 4), twodigits(buf + 2), year))\n\t\treturn EIO;\n\treturn 0;\n}"
  },
  {
    "function_name": "ofrtcread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "164-197",
    "snippet": "int\nofrtcread(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofrtc_softc *of = ofrtc_cd.cd_devs[minor(dev)];\n\tint date[6];\n\tchar buf[14];\n\tint xlen;\n\t\n\tif (uio->uio_offset >= sizeof buf)\n\t\treturn 0;\n\t\n\tif (OF_call_method(\"get-time\", of->sc_ihandle, 0, 6,\n\t\t\t   date, date + 1, date + 2,\n\t\t\t   date + 3, date + 4, date + 5))\n\t\treturn EIO;\n\n\ttwodigit(buf, date[5] % 100);\n\ttwodigit(buf + 2, date[4]);\n\ttwodigit(buf + 4, date[3]);\n\ttwodigit(buf + 6, date[2]);\n\ttwodigit(buf + 8, date[1]);\n\tbuf[10] = '.';\n\ttwodigit(buf + 11, date[0]);\n\tbuf[13] = '\\n';\n\t\n\txlen = sizeof(buf) - uio->uio_offset;\n\tif (xlen > uio->uio_resid)\n\t\txlen = uio->uio_resid;\n\t\n\treturn uiomove((caddr_t)buf, xlen, uio);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "(caddr_t)buf",
            "xlen",
            "uio"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "twodigit",
          "args": [
            "buf + 11",
            "date[0]"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "twodigits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
          "lines": "154-162",
          "snippet": "static int\ntwodigits(bp)\n\tchar *bp;\n{\n\tint i;\n\t\n\ti = *bp++ - '0';\n\treturn i * 10 + *bp++ - '0';\n}",
          "includes": [
            "#include <dev/ofw/openfirm.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstatic int\ntwodigits(bp)\n\tchar *bp;\n{\n\tint i;\n\t\n\ti = *bp++ - '0';\n\treturn i * 10 + *bp++ - '0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "OF_call_method",
          "args": [
            "\"get-time\"",
            "of->sc_ihandle",
            "0",
            "6",
            "date",
            "date + 1",
            "date + 2",
            "date + 3",
            "date + 4",
            "date + 5"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstruct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};\n\nint\nofrtcread(dev, uio, flag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint flag;\n{\n\tstruct ofrtc_softc *of = ofrtc_cd.cd_devs[minor(dev)];\n\tint date[6];\n\tchar buf[14];\n\tint xlen;\n\t\n\tif (uio->uio_offset >= sizeof buf)\n\t\treturn 0;\n\t\n\tif (OF_call_method(\"get-time\", of->sc_ihandle, 0, 6,\n\t\t\t   date, date + 1, date + 2,\n\t\t\t   date + 3, date + 4, date + 5))\n\t\treturn EIO;\n\n\ttwodigit(buf, date[5] % 100);\n\ttwodigit(buf + 2, date[4]);\n\ttwodigit(buf + 4, date[3]);\n\ttwodigit(buf + 6, date[2]);\n\ttwodigit(buf + 8, date[1]);\n\tbuf[10] = '.';\n\ttwodigit(buf + 11, date[0]);\n\tbuf[13] = '\\n';\n\t\n\txlen = sizeof(buf) - uio->uio_offset;\n\tif (xlen > uio->uio_resid)\n\t\txlen = uio->uio_resid;\n\t\n\treturn uiomove((caddr_t)buf, xlen, uio);\n}"
  },
  {
    "function_name": "twodigits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "154-162",
    "snippet": "static int\ntwodigits(bp)\n\tchar *bp;\n{\n\tint i;\n\t\n\ti = *bp++ - '0';\n\treturn i * 10 + *bp++ - '0';\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstatic int\ntwodigits(bp)\n\tchar *bp;\n{\n\tint i;\n\t\n\ti = *bp++ - '0';\n\treturn i * 10 + *bp++ - '0';\n}"
  },
  {
    "function_name": "twodigit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "145-152",
    "snippet": "static void\ntwodigit(bp, i)\n\tchar *bp;\n\tint i;\n{\n\t*bp++ = i / 10 + '0';\n\t*bp = i % 10 + '0';\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstatic void\ntwodigit(bp, i)\n\tchar *bp;\n\tint i;\n{\n\t*bp++ = i / 10 + '0';\n\t*bp = i % 10 + '0';\n}"
  },
  {
    "function_name": "ofrtcclose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "136-143",
    "snippet": "int\nofrtcclose(dev, flags, fmt)\n\tdev_t dev;\n\tint flags;\n\tint fmt;\n{\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nint\nofrtcclose(dev, flags, fmt)\n\tdev_t dev;\n\tint flags;\n\tint fmt;\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "ofrtcopen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "101-134",
    "snippet": "int\nofrtcopen(dev, flags, fmt)\n\tdev_t dev;\n\tint flags;\n\tint fmt;\n{\n\tstruct ofrtc_softc *of;\n\tint unit = minor(dev);\n\tchar path[256];\n\tint l;\n\t\n\tif (unit >= ofrtc_cd.cd_ndevs)\n\t\treturn ENXIO;\n\tif (!(of = ofrtc_cd.cd_devs[unit]))\n\t\treturn ENXIO;\n\tif (!of->sc_ihandle) {\n\t\tif ((l = OF_package_to_path(of->sc_phandle, path, sizeof path - 1)) < 0)\n\t\t\treturn ENXIO;\n\t\tif (l >= sizeof path)\n\t\t\treturn ENXIO;\n\t\tpath[l] = 0;\n\t\t\n\t\tif (!(of->sc_ihandle = OF_open(path))) {\n\t\t\tif (of->sc_ihandle) {\n\t\t\t\tOF_close(of->sc_ihandle);\n\t\t\t\tof->sc_ihandle = 0;\n\t\t\t}\n\t\t\treturn ENXIO;\n\t\t}\n\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "OF_close",
          "args": [
            "of->sc_ihandle"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_open",
          "args": [
            "path"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_package_to_path",
          "args": [
            "of->sc_phandle",
            "path",
            "sizeof path - 1"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "dev"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstruct cfdriver ofrtc_cd = {\n\tNULL, \"ofrtc\", DV_DULL\n};\n\nint\nofrtcopen(dev, flags, fmt)\n\tdev_t dev;\n\tint flags;\n\tint fmt;\n{\n\tstruct ofrtc_softc *of;\n\tint unit = minor(dev);\n\tchar path[256];\n\tint l;\n\t\n\tif (unit >= ofrtc_cd.cd_ndevs)\n\t\treturn ENXIO;\n\tif (!(of = ofrtc_cd.cd_devs[unit]))\n\t\treturn ENXIO;\n\tif (!of->sc_ihandle) {\n\t\tif ((l = OF_package_to_path(of->sc_phandle, path, sizeof path - 1)) < 0)\n\t\t\treturn ENXIO;\n\t\tif (l >= sizeof path)\n\t\t\treturn ENXIO;\n\t\tpath[l] = 0;\n\t\t\n\t\tif (!(of->sc_ihandle = OF_open(path))) {\n\t\t\tif (of->sc_ihandle) {\n\t\t\t\tOF_close(of->sc_ihandle);\n\t\t\t\tof->sc_ihandle = 0;\n\t\t\t}\n\t\t\treturn ENXIO;\n\t\t}\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ofrtcattach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "80-99",
    "snippet": "static void\nofrtcattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct ofrtc_softc *of = (void *)self;\n\tstruct ofprobe *ofp = aux;\n\tchar name[32];\n\tint l;\n\t\n\tclock_read = &OF_clock_read;\n\tof->sc_phandle = ofp->phandle;\n\tof->sc_ihandle = 0;\n\tif ((l = OF_getprop(of->sc_phandle, \"name\", name, sizeof name - 1)) < 0)\n\t\tpanic(\"Device without name?\");\n\tif (l >= sizeof name)\n\t\tl = sizeof name - 1;\n\tname[l] = 0;\n\tprintf(\": %s\\n\", name);\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ofrtcattach",
      "extern clock_read_t *clock_read;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\": %s\\n\"",
            "name"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"Device without name?\""
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_getprop",
          "args": [
            "of->sc_phandle",
            "\"name\"",
            "name",
            "sizeof name - 1"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstatic void ofrtcattach;\nextern clock_read_t *clock_read;\n\nstatic void\nofrtcattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct ofrtc_softc *of = (void *)self;\n\tstruct ofprobe *ofp = aux;\n\tchar name[32];\n\tint l;\n\t\n\tclock_read = &OF_clock_read;\n\tof->sc_phandle = ofp->phandle;\n\tof->sc_ihandle = 0;\n\tif ((l = OF_getprop(of->sc_phandle, \"name\", name, sizeof name - 1)) < 0)\n\t\tpanic(\"Device without name?\");\n\tif (l >= sizeof name)\n\t\tl = sizeof name - 1;\n\tname[l] = 0;\n\tprintf(\": %s\\n\", name);\n}"
  },
  {
    "function_name": "ofrtcprobe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ofw/ofrtc.c",
    "lines": "57-72",
    "snippet": "static int\nofrtcprobe(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct ofprobe *ofp = aux;\n\tchar type[8];\n\tint l;\n\t\n\tif ((l = OF_getprop(ofp->phandle, \"device_type\", type, sizeof type - 1)) < 0)\n\t\treturn 0;\n\tif (l >= sizeof type)\n\t\treturn 0;\n\t\n\treturn !strcmp(type, \"rtc\");\n}",
    "includes": [
      "#include <dev/ofw/openfirm.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int ofrtcprobe"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "\"rtc\""
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OF_getprop",
          "args": [
            "ofp->phandle",
            "\"device_type\"",
            "type",
            "sizeof type - 1"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ofw/openfirm.h>\n#include <sys/device.h>\n#include <sys/param.h>\n\nstatic int ofrtcprobe;\n\nstatic int\nofrtcprobe(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct ofprobe *ofp = aux;\n\tchar type[8];\n\tint l;\n\t\n\tif ((l = OF_getprop(ofp->phandle, \"device_type\", type, sizeof type - 1)) < 0)\n\t\treturn 0;\n\tif (l >= sizeof type)\n\t\treturn 0;\n\t\n\treturn !strcmp(type, \"rtc\");\n}"
  }
]