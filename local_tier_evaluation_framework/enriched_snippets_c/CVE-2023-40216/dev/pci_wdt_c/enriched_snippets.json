[
  {
    "function_name": "wdt_sched",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "566-605",
    "snippet": "static int\nwdt_sched (struct wdt_softc *wdt, struct proc *p)\n{\n\tint error;\n\tint s;\n\n\t/*\n\t * Regardless of the device permissions, you must be\n\t * root to do this -- a process which is STOPPED\n\t * while in this function can cause a reboot to occur\n\t * if the counters aren't reloaded within wdt->timeout_secs\n\t * seconds.\n\t */\n\tif ((error = suser(p->p_ucred, &p->p_acflag)))\n\t\treturn(error);\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\t/* indicate that we are sleeping */\n\t++wdt->procs;\n\n\t/* loop until the process is signaled */\n\twhile (1) {\n\t\terror = tsleep(wdt, PCATCH | PSWP, \"wdtsch\", 0);\n\n\t\twdt_set_timeout(wdt, wdt->timeout_secs);\n\n\t\tif (error != 0)\n\t\t\tbreak;\n\t}\n\n\t/* remove sleeping indication */\n\t--wdt->procs;\n\n\t/* re-enable timeout handler */\n\tsplx(s);\n\n\treturn(error);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wdt_set_timeout",
          "args": [
            "wdt",
            "wdt->timeout_secs"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_set_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "318-332",
          "snippet": "static void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_ENABLE_TIMER\t7",
            "#define WDT_DISABLE_TIMER\t7",
            "#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_ENABLE_TIMER\t7\n#define WDT_DISABLE_TIMER\t7\n#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */\n\nstatic void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tsleep",
          "args": [
            "wdt",
            "PCATCH | PSWP",
            "\"wdtsch\"",
            "0"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splclock",
          "args": [],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suser",
          "args": [
            "p->p_ucred",
            "&p->p_acflag"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic int\nwdt_sched (struct wdt_softc *wdt, struct proc *p)\n{\n\tint error;\n\tint s;\n\n\t/*\n\t * Regardless of the device permissions, you must be\n\t * root to do this -- a process which is STOPPED\n\t * while in this function can cause a reboot to occur\n\t * if the counters aren't reloaded within wdt->timeout_secs\n\t * seconds.\n\t */\n\tif ((error = suser(p->p_ucred, &p->p_acflag)))\n\t\treturn(error);\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\t/* indicate that we are sleeping */\n\t++wdt->procs;\n\n\t/* loop until the process is signaled */\n\twhile (1) {\n\t\terror = tsleep(wdt, PCATCH | PSWP, \"wdtsch\", 0);\n\n\t\twdt_set_timeout(wdt, wdt->timeout_secs);\n\n\t\tif (error != 0)\n\t\t\tbreak;\n\t}\n\n\t/* remove sleeping indication */\n\t--wdt->procs;\n\n\t/* re-enable timeout handler */\n\tsplx(s);\n\n\treturn(error);\n}"
  },
  {
    "function_name": "wdt_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "542-548",
    "snippet": "static void\nwdt_shutdown (void *arg)\n{\n\tstruct wdt_softc *wdt = (struct wdt_softc *)arg;\n\n\twdt_timer_disable(wdt);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wdt_timer_disable",
          "args": [
            "wdt"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_timer_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "371-376",
          "snippet": "static void\nwdt_timer_disable (struct wdt_softc *wdt)\n{\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\tuntimeout(wdt_timeout, wdt);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_DISABLE_TIMER\t7"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_DISABLE_TIMER\t7\n\nstatic void\nwdt_timer_disable (struct wdt_softc *wdt)\n{\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\tuntimeout(wdt_timeout, wdt);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic void\nwdt_shutdown (void *arg)\n{\n\tstruct wdt_softc *wdt = (struct wdt_softc *)arg;\n\n\twdt_timer_disable(wdt);\n}"
  },
  {
    "function_name": "wdt_get_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "528-535",
    "snippet": "static int\nwdt_get_state (struct wdt_softc *wdt, struct wdt_state *state)\n{\n\tstate->temperature\t= wdt_read_temperature(wdt);\n\tstate->status\t\t= wdt_read_status(wdt);\n\n\treturn(0);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wdt_read_status",
          "args": [
            "wdt"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_read_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "485-490",
          "snippet": "static int\nwdt_read_status (struct wdt_softc *wdt)\n{\n\t/* mask off counter refresh & IRQ generated bits */\n\treturn(bus_space_read_1(wdt->iot, wdt->ioh, WDT_STATUS_REG) & 0x7E);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_STATUS_REG\t\t4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_STATUS_REG\t\t4\n\nstatic int\nwdt_read_status (struct wdt_softc *wdt)\n{\n\t/* mask off counter refresh & IRQ generated bits */\n\treturn(bus_space_read_1(wdt->iot, wdt->ioh, WDT_STATUS_REG) & 0x7E);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_read_temperature",
          "args": [
            "wdt"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_read_temperature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "471-477",
          "snippet": "static int\nwdt_read_temperature (struct wdt_softc *wdt)\n{\n\tunsigned v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\treturn((v * 11) / 15 + 7);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_TEMPERATURE\t\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_TEMPERATURE\t\t5\n\nstatic int\nwdt_read_temperature (struct wdt_softc *wdt)\n{\n\tunsigned v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\treturn((v * 11) / 15 + 7);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic int\nwdt_get_state (struct wdt_softc *wdt, struct wdt_state *state)\n{\n\tstate->temperature\t= wdt_read_temperature(wdt);\n\tstate->status\t\t= wdt_read_status(wdt);\n\n\treturn(0);\n}"
  },
  {
    "function_name": "wdt_display_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "498-521",
    "snippet": "static void\nwdt_display_status (struct wdt_softc *wdt)\n{\n\tif (wdt->features) {\n\t\tint status = wdt_read_status(wdt);\n\t\tint temp   = wdt_read_temperature(wdt);\n\n\t\tprintf(\"wdt%d: WDT501 timeout %d secs, temp %d F\",\n\t\t\t   wdt->unit, wdt->timeout_secs, temp);\n\n\t\t/* overvoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_OVER) == 0)\n\t\t\tprintf(\" <PS overvoltage>\");\n\n\t\t/* undervoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_UNDER) == 0)\n\t\t\tprintf(\" <PS undervoltage>\");\n\t} else {\n\t\tprintf(\"wdt%d: WDT500 timeout %d secs\",\n\t\t\t   wdt->unit, wdt->timeout_secs);\n\t}\n\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_read_temperature",
          "args": [
            "wdt"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_read_temperature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "471-477",
          "snippet": "static int\nwdt_read_temperature (struct wdt_softc *wdt)\n{\n\tunsigned v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\treturn((v * 11) / 15 + 7);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_TEMPERATURE\t\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_TEMPERATURE\t\t5\n\nstatic int\nwdt_read_temperature (struct wdt_softc *wdt)\n{\n\tunsigned v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\treturn((v * 11) / 15 + 7);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_read_status",
          "args": [
            "wdt"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_read_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "485-490",
          "snippet": "static int\nwdt_read_status (struct wdt_softc *wdt)\n{\n\t/* mask off counter refresh & IRQ generated bits */\n\treturn(bus_space_read_1(wdt->iot, wdt->ioh, WDT_STATUS_REG) & 0x7E);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_STATUS_REG\t\t4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_STATUS_REG\t\t4\n\nstatic int\nwdt_read_status (struct wdt_softc *wdt)\n{\n\t/* mask off counter refresh & IRQ generated bits */\n\treturn(bus_space_read_1(wdt->iot, wdt->ioh, WDT_STATUS_REG) & 0x7E);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic void\nwdt_display_status (struct wdt_softc *wdt)\n{\n\tif (wdt->features) {\n\t\tint status = wdt_read_status(wdt);\n\t\tint temp   = wdt_read_temperature(wdt);\n\n\t\tprintf(\"wdt%d: WDT501 timeout %d secs, temp %d F\",\n\t\t\t   wdt->unit, wdt->timeout_secs, temp);\n\n\t\t/* overvoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_OVER) == 0)\n\t\t\tprintf(\" <PS overvoltage>\");\n\n\t\t/* undervoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_UNDER) == 0)\n\t\t\tprintf(\" <PS undervoltage>\");\n\t} else {\n\t\tprintf(\"wdt%d: WDT500 timeout %d secs\",\n\t\t\t   wdt->unit, wdt->timeout_secs);\n\t}\n\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "wdt_read_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "485-490",
    "snippet": "static int\nwdt_read_status (struct wdt_softc *wdt)\n{\n\t/* mask off counter refresh & IRQ generated bits */\n\treturn(bus_space_read_1(wdt->iot, wdt->ioh, WDT_STATUS_REG) & 0x7E);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_STATUS_REG\t\t4"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_STATUS_REG"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_STATUS_REG\t\t4\n\nstatic int\nwdt_read_status (struct wdt_softc *wdt)\n{\n\t/* mask off counter refresh & IRQ generated bits */\n\treturn(bus_space_read_1(wdt->iot, wdt->ioh, WDT_STATUS_REG) & 0x7E);\n}"
  },
  {
    "function_name": "wdt_read_temperature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "471-477",
    "snippet": "static int\nwdt_read_temperature (struct wdt_softc *wdt)\n{\n\tunsigned v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\treturn((v * 11) / 15 + 7);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_TEMPERATURE\t\t5"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_TEMPERATURE"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_TEMPERATURE\t\t5\n\nstatic int\nwdt_read_temperature (struct wdt_softc *wdt)\n{\n\tunsigned v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\treturn((v * 11) / 15 + 7);\n}"
  },
  {
    "function_name": "wdt_buzzer_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "459-463",
    "snippet": "static void\nwdt_buzzer_disable (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 0);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_8254_BUZZER\t\t2"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wdt_8254_mode",
          "args": [
            "wdt",
            "WDT_8254_BUZZER",
            "0"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_8254_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "306-311",
          "snippet": "static void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)\n\nstatic void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_BUZZER\t\t2\n\nstatic void\nwdt_buzzer_disable (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 0);\n}"
  },
  {
    "function_name": "wdt_buzzer_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "446-451",
    "snippet": "static void\nwdt_buzzer_enable (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BUZZER, 1);\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 1);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_8254_BUZZER\t\t2"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wdt_8254_mode",
          "args": [
            "wdt",
            "WDT_8254_BUZZER",
            "1"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_8254_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "306-311",
          "snippet": "static void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)\n\nstatic void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_8254_BUZZER",
            "1"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_BUZZER\t\t2\n\nstatic void\nwdt_buzzer_enable (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BUZZER, 1);\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 1);\n}"
  },
  {
    "function_name": "wdt_buzzer_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "434-438",
    "snippet": "static void\nwdt_buzzer_off (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_STOP_BUZZER, 0);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_STOP_BUZZER\t\t5"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_STOP_BUZZER",
            "0"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_STOP_BUZZER\t\t5\n\nstatic void\nwdt_buzzer_off (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_STOP_BUZZER, 0);\n}"
  },
  {
    "function_name": "wdt_init_timer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "417-423",
    "snippet": "static void\nwdt_init_timer (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_TC_LO, 3);\n\twdt_8254_mode(wdt, WDT_8254_TC_HI, 2);\n\twdt_8254_count(wdt, WDT_8254_TC_LO, 41666);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */",
      "#define WDT_8254_TC_LO\t\t0\t/* low 16 bits of timeout counter  */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wdt_8254_count",
          "args": [
            "wdt",
            "WDT_8254_TC_LO",
            "41666"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_8254_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "293-299",
          "snippet": "static void\nwdt_8254_count (struct wdt_softc *wdt, int counter, u_int16_t v)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh,\n\t\t\tWDT_8254_BASE + counter, v & 0xFF);\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BASE + counter, v >> 8);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_8254_BASE\t\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_BASE\t\t0\n\nstatic void\nwdt_8254_count (struct wdt_softc *wdt, int counter, u_int16_t v)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh,\n\t\t\tWDT_8254_BASE + counter, v & 0xFF);\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BASE + counter, v >> 8);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_8254_mode",
          "args": [
            "wdt",
            "WDT_8254_TC_HI",
            "2"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_8254_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "306-311",
          "snippet": "static void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)\n\nstatic void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */\n#define WDT_8254_TC_LO\t\t0\t/* low 16 bits of timeout counter  */\n\nstatic void\nwdt_init_timer (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_TC_LO, 3);\n\twdt_8254_mode(wdt, WDT_8254_TC_HI, 2);\n\twdt_8254_count(wdt, WDT_8254_TC_LO, 41666);\n}"
  },
  {
    "function_name": "wdt_timer_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "385-408",
    "snippet": "static void\nwdt_timer_enable (struct wdt_softc *wdt, unsigned seconds)\n{\n\tint s;\n\n\t/* clamp range */\n\tif (seconds < 2)\n\t\tseconds = 2;\n\n\tif (seconds > 1800)\n\t\tseconds = 1800;\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\twdt_timer_disable(wdt);\n\twdt->timeout_secs = seconds;\n\n\ttimeout(wdt_timeout, wdt, hz * seconds / 2);\n\twdt_set_timeout(wdt, seconds);\n\n\t/* re-enable clock interrupts */\n\tsplx(s);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wdt_set_timeout",
          "args": [
            "wdt",
            "seconds"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_set_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "318-332",
          "snippet": "static void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_ENABLE_TIMER\t7",
            "#define WDT_DISABLE_TIMER\t7",
            "#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_ENABLE_TIMER\t7\n#define WDT_DISABLE_TIMER\t7\n#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */\n\nstatic void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "wdt_timeout",
            "wdt",
            "hz * seconds / 2"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "midi_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "478-486",
          "snippet": "void\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_timer_disable",
          "args": [
            "wdt"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_timer_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "371-376",
          "snippet": "static void\nwdt_timer_disable (struct wdt_softc *wdt)\n{\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\tuntimeout(wdt_timeout, wdt);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_DISABLE_TIMER\t7"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_DISABLE_TIMER\t7\n\nstatic void\nwdt_timer_disable (struct wdt_softc *wdt)\n{\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\tuntimeout(wdt_timeout, wdt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splclock",
          "args": [],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic void\nwdt_timer_enable (struct wdt_softc *wdt, unsigned seconds)\n{\n\tint s;\n\n\t/* clamp range */\n\tif (seconds < 2)\n\t\tseconds = 2;\n\n\tif (seconds > 1800)\n\t\tseconds = 1800;\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\twdt_timer_disable(wdt);\n\twdt->timeout_secs = seconds;\n\n\ttimeout(wdt_timeout, wdt, hz * seconds / 2);\n\twdt_set_timeout(wdt, seconds);\n\n\t/* re-enable clock interrupts */\n\tsplx(s);\n}"
  },
  {
    "function_name": "wdt_timer_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "371-376",
    "snippet": "static void\nwdt_timer_disable (struct wdt_softc *wdt)\n{\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\tuntimeout(wdt_timeout, wdt);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_DISABLE_TIMER\t7"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "untimeout",
          "args": [
            "wdt_timeout",
            "wdt"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_DISABLE_TIMER"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_DISABLE_TIMER\t7\n\nstatic void\nwdt_timer_disable (struct wdt_softc *wdt)\n{\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\tuntimeout(wdt_timeout, wdt);\n}"
  },
  {
    "function_name": "wdt_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "350-363",
    "snippet": "static void\nwdt_timeout (void *arg)\n{\n\tstruct wdt_softc *wdt = (struct wdt_softc *)arg;\n\n\t/* reload counters from proc in WIOCSCHED ioctl()? */\n\tif (wdt->procs)\n\t\twakeup(wdt);\n\telse\n\t\twdt_set_timeout(wdt, wdt->timeout_secs);\n\n\t/* schedule another timeout in half the countdown time */\n\ttimeout(wdt_timeout, arg, wdt->timeout_secs * hz / 2);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "wdt_timeout",
            "arg",
            "wdt->timeout_secs * hz / 2"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "midi_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "478-486",
          "snippet": "void\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_timeout(arg)\n\tvoid *arg;\n{\n\tstruct midi_softc *sc = arg;\n\n\tDPRINTFN(3,(\"midi_timeout: %p\\n\", sc));\n\tmidi_start_output(sc, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_set_timeout",
          "args": [
            "wdt",
            "wdt->timeout_secs"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_set_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "318-332",
          "snippet": "static void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_ENABLE_TIMER\t7",
            "#define WDT_DISABLE_TIMER\t7",
            "#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_ENABLE_TIMER\t7\n#define WDT_DISABLE_TIMER\t7\n#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */\n\nstatic void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wakeup",
          "args": [
            "wdt"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "audio_wakeup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "765-774",
          "snippet": "static __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nstatic __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic void\nwdt_timeout (void *arg)\n{\n\tstruct wdt_softc *wdt = (struct wdt_softc *)arg;\n\n\t/* reload counters from proc in WIOCSCHED ioctl()? */\n\tif (wdt->procs)\n\t\twakeup(wdt);\n\telse\n\t\twdt_set_timeout(wdt, wdt->timeout_secs);\n\n\t/* schedule another timeout in half the countdown time */\n\ttimeout(wdt_timeout, arg, wdt->timeout_secs * hz / 2);\n}"
  },
  {
    "function_name": "wdt_set_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "318-332",
    "snippet": "static void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_ENABLE_TIMER\t7",
      "#define WDT_DISABLE_TIMER\t7",
      "#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_ENABLE_TIMER",
            "0"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wdt_8254_count",
          "args": [
            "wdt",
            "WDT_8254_TC_HI",
            "v"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_8254_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "293-299",
          "snippet": "static void\nwdt_8254_count (struct wdt_softc *wdt, int counter, u_int16_t v)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh,\n\t\t\tWDT_8254_BASE + counter, v & 0xFF);\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BASE + counter, v >> 8);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_8254_BASE\t\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_BASE\t\t0\n\nstatic void\nwdt_8254_count (struct wdt_softc *wdt, int counter, u_int16_t v)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh,\n\t\t\tWDT_8254_BASE + counter, v & 0xFF);\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BASE + counter, v >> 8);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_DISABLE_TIMER"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_ENABLE_TIMER\t7\n#define WDT_DISABLE_TIMER\t7\n#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */\n\nstatic void\nwdt_set_timeout (struct wdt_softc *wdt, unsigned seconds)\n{\n\t/* 8254 has been programmed with a 2ms period */\n\tu_int16_t v = (u_int16_t)seconds * 50;\n\n\t/* disable the timer */\n\t(void)bus_space_read_1(wdt->iot, wdt->ioh, WDT_DISABLE_TIMER);\n\n\t/* load the new timeout count */\n\twdt_8254_count(wdt, WDT_8254_TC_HI, v);\n\n\t/* enable the timer */\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_ENABLE_TIMER, 0);\n}"
  },
  {
    "function_name": "wdt_8254_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "306-311",
    "snippet": "static void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_8254_CTL",
            "(counter << 6) | 0x30 | (mode << 1)"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_CTL\t\t(WDT_8254_BASE + 3)\n\nstatic void\nwdt_8254_mode (struct wdt_softc *wdt, int counter, int mode)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_CTL,\n\t\t(counter << 6) | 0x30 | (mode << 1));\n}"
  },
  {
    "function_name": "wdt_8254_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "293-299",
    "snippet": "static void\nwdt_8254_count (struct wdt_softc *wdt, int counter, u_int16_t v)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh,\n\t\t\tWDT_8254_BASE + counter, v & 0xFF);\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BASE + counter, v >> 8);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_8254_BASE\t\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_8254_BASE + counter",
            "v >> 8"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_8254_BASE + counter",
            "v & 0xFF"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_BASE\t\t0\n\nstatic void\nwdt_8254_count (struct wdt_softc *wdt, int counter, u_int16_t v)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh,\n\t\t\tWDT_8254_BASE + counter, v & 0xFF);\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BASE + counter, v >> 8);\n}"
  },
  {
    "function_name": "wdt_is501",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "271-286",
    "snippet": "static int\nwdt_is501 (struct wdt_softc *wdt)\n{\n\t/*\n\t *\tIt makes too much sense to detect the card type\n\t *\tby the device ID, so we have to resort to testing\n\t *\tthe presence of a register to determine the type.\n\t */\n\tint v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\t/* XXX may not be reliable */\n\tif (v == 0 || v == 0xFF)\n\t\treturn(0);\n\n\treturn(1);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [
      "#define WDT_TEMPERATURE\t\t5"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "wdt->iot",
            "wdt->ioh",
            "WDT_TEMPERATURE"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_TEMPERATURE\t\t5\n\nstatic int\nwdt_is501 (struct wdt_softc *wdt)\n{\n\t/*\n\t *\tIt makes too much sense to detect the card type\n\t *\tby the device ID, so we have to resort to testing\n\t *\tthe presence of a register to determine the type.\n\t */\n\tint v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\t/* XXX may not be reliable */\n\tif (v == 0 || v == 0xFF)\n\t\treturn(0);\n\n\treturn(1);\n}"
  },
  {
    "function_name": "wdtioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "239-264",
    "snippet": "int\nwdtioctl (dev_t dev, u_long cmd, caddr_t arg, int flag, struct proc *p)\n{\n\tstruct wdt_softc *wdt = wdt_cd.cd_devs[UNIT(dev)];\n\tint error;\n\n\tswitch (cmd) {\n\t\tcase WIOCSCHED:\n\t\t\terror = wdt_sched(wdt, p);\n\t\t\tbreak;\n\n\t\tcase WIOCGETSTATE:\n\t\t\tif (wdt->features)\n\t\t\t\terror = wdt_get_state(wdt,\n\t\t\t\t\t(struct wdt_state *)arg);\n\t\t\telse\n\t\t\t\terror = ENXIO;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\terror = ENXIO;\n\t\t\tbreak;\n\t}\n\n\treturn(error);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wdt_get_state",
          "args": [
            "wdt",
            "(struct wdt_state *)arg"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_get_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "528-535",
          "snippet": "static int\nwdt_get_state (struct wdt_softc *wdt, struct wdt_state *state)\n{\n\tstate->temperature\t= wdt_read_temperature(wdt);\n\tstate->status\t\t= wdt_read_status(wdt);\n\n\treturn(0);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic int\nwdt_get_state (struct wdt_softc *wdt, struct wdt_state *state)\n{\n\tstate->temperature\t= wdt_read_temperature(wdt);\n\tstate->status\t\t= wdt_read_status(wdt);\n\n\treturn(0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_sched",
          "args": [
            "wdt",
            "p"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_sched",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "566-605",
          "snippet": "static int\nwdt_sched (struct wdt_softc *wdt, struct proc *p)\n{\n\tint error;\n\tint s;\n\n\t/*\n\t * Regardless of the device permissions, you must be\n\t * root to do this -- a process which is STOPPED\n\t * while in this function can cause a reboot to occur\n\t * if the counters aren't reloaded within wdt->timeout_secs\n\t * seconds.\n\t */\n\tif ((error = suser(p->p_ucred, &p->p_acflag)))\n\t\treturn(error);\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\t/* indicate that we are sleeping */\n\t++wdt->procs;\n\n\t/* loop until the process is signaled */\n\twhile (1) {\n\t\terror = tsleep(wdt, PCATCH | PSWP, \"wdtsch\", 0);\n\n\t\twdt_set_timeout(wdt, wdt->timeout_secs);\n\n\t\tif (error != 0)\n\t\t\tbreak;\n\t}\n\n\t/* remove sleeping indication */\n\t--wdt->procs;\n\n\t/* re-enable timeout handler */\n\tsplx(s);\n\n\treturn(error);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic int\nwdt_sched (struct wdt_softc *wdt, struct proc *p)\n{\n\tint error;\n\tint s;\n\n\t/*\n\t * Regardless of the device permissions, you must be\n\t * root to do this -- a process which is STOPPED\n\t * while in this function can cause a reboot to occur\n\t * if the counters aren't reloaded within wdt->timeout_secs\n\t * seconds.\n\t */\n\tif ((error = suser(p->p_ucred, &p->p_acflag)))\n\t\treturn(error);\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\t/* indicate that we are sleeping */\n\t++wdt->procs;\n\n\t/* loop until the process is signaled */\n\twhile (1) {\n\t\terror = tsleep(wdt, PCATCH | PSWP, \"wdtsch\", 0);\n\n\t\twdt_set_timeout(wdt, wdt->timeout_secs);\n\n\t\tif (error != 0)\n\t\t\tbreak;\n\t}\n\n\t/* remove sleeping indication */\n\t--wdt->procs;\n\n\t/* re-enable timeout handler */\n\tsplx(s);\n\n\treturn(error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UNIT",
          "args": [
            "dev"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nint\nwdtioctl (dev_t dev, u_long cmd, caddr_t arg, int flag, struct proc *p)\n{\n\tstruct wdt_softc *wdt = wdt_cd.cd_devs[UNIT(dev)];\n\tint error;\n\n\tswitch (cmd) {\n\t\tcase WIOCSCHED:\n\t\t\terror = wdt_sched(wdt, p);\n\t\t\tbreak;\n\n\t\tcase WIOCGETSTATE:\n\t\t\tif (wdt->features)\n\t\t\t\terror = wdt_get_state(wdt,\n\t\t\t\t\t(struct wdt_state *)arg);\n\t\t\telse\n\t\t\t\terror = ENXIO;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\terror = ENXIO;\n\t\t\tbreak;\n\t}\n\n\treturn(error);\n}"
  },
  {
    "function_name": "wdtclose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "233-237",
    "snippet": "int\nwdtclose (dev_t dev, int flags, int fmt, struct proc *p)\n{\n\treturn(0);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nint\nwdtclose (dev_t dev, int flags, int fmt, struct proc *p)\n{\n\treturn(0);\n}"
  },
  {
    "function_name": "wdtopen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "224-231",
    "snippet": "int\nwdtopen (dev_t dev, int flags, int fmt, struct proc *p)\n{\n\tif (UNIT(dev) >= wdt_cd.cd_ndevs)\n\t\treturn(ENXIO);\n\n\treturn(0);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UNIT",
          "args": [
            "dev"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nint\nwdtopen (dev_t dev, int flags, int fmt, struct proc *p)\n{\n\tif (UNIT(dev) >= wdt_cd.cd_ndevs)\n\t\treturn(ENXIO);\n\n\treturn(0);\n}"
  },
  {
    "function_name": "wdtattach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "143-222",
    "snippet": "void\nwdtattach (parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct wdt_softc *wdt = (struct wdt_softc *)self;\n\tstruct pci_attach_args *const pa = (struct pci_attach_args *)aux;\n\tint unit;\n\tbus_size_t iosize;\n\tbus_addr_t iobase;\n\n\twdt->iot = pa->pa_iot;\n\n\tunit = wdt->wdt_dev.dv_unit;\n\n\t/* retrieve the I/O region (BAR2) */\n\tif (pci_io_find(pa->pa_pc, pa->pa_tag, 0x18, &iobase,\n\t    &iosize) != 0) {\n\t\tprintf(\"wdt%d: couldn't find PCI I/O region\\n\", unit);\n\t\treturn;\n\t}\n\n\t/* sanity check I/O size */\n\tif (iosize != (bus_size_t)16) {\n\t\tprintf(\"wdt%d: invalid I/O region size\\n\", unit);\n\t\treturn;\n\t}\n\n\t/* map I/O region */\n\tif (bus_space_map(pa->pa_iot, iobase, iosize, 0, &wdt->ioh) != 0) {\n\t\tprintf(\"wdt%d: couldn't map PCI I/O region\\n\", unit);\n\t\treturn;\n\t}\n\n\t/* initialize the watchdog timer structure */\n\twdt->unit  = unit;\n\twdt->procs = 0;\n\n\t/* check the feature set available */\n\tif (wdt_is501(wdt))\n\t\twdt->features = 1;\n\telse\n\t\twdt->features = 0;\n\n\t/*\n\t * register a callback for system shutdown\n\t * (we need to disable the watchdog timer during shutdown)\n\t */\n\tif (shutdownhook_establish(wdt_shutdown, wdt) == NULL)\n\t\treturn;\n\n\tif (wdt->features) {\n\t\t/*\n\t\t * turn off the buzzer, it may have been activated\n\t\t * by a previous timeout\n\t\t */\n\t\twdt_buzzer_off(wdt);\n\n#ifdef WDT_DISABLE_BUZZER\n\t\twdt_buzzer_disable(wdt);\n#else\n\t\twdt_buzzer_enable(wdt);\n#endif\n\t}\n\n\t/* initialize the timer modes and the lower 16-bit counter */\n\twdt_init_timer(wdt);\n\n\t/*\n\t * it appears the timeout queue isn't processed until the\n\t * kernel has fully booted, so we set the first timeout\n\t * far in advance, and subsequent timeouts at the normal\n\t * 30 second interval\n\t */\n\twdt_timer_enable(wdt, 90/*seconds*/);\n\twdt->timeout_secs = 30;\n\n\tprintf(\"\\n\");\n\twdt_display_status(wdt);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wdt_display_status",
          "args": [
            "wdt"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_display_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "498-521",
          "snippet": "static void\nwdt_display_status (struct wdt_softc *wdt)\n{\n\tif (wdt->features) {\n\t\tint status = wdt_read_status(wdt);\n\t\tint temp   = wdt_read_temperature(wdt);\n\n\t\tprintf(\"wdt%d: WDT501 timeout %d secs, temp %d F\",\n\t\t\t   wdt->unit, wdt->timeout_secs, temp);\n\n\t\t/* overvoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_OVER) == 0)\n\t\t\tprintf(\" <PS overvoltage>\");\n\n\t\t/* undervoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_UNDER) == 0)\n\t\t\tprintf(\" <PS undervoltage>\");\n\t} else {\n\t\tprintf(\"wdt%d: WDT500 timeout %d secs\",\n\t\t\t   wdt->unit, wdt->timeout_secs);\n\t}\n\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic void\nwdt_display_status (struct wdt_softc *wdt)\n{\n\tif (wdt->features) {\n\t\tint status = wdt_read_status(wdt);\n\t\tint temp   = wdt_read_temperature(wdt);\n\n\t\tprintf(\"wdt%d: WDT501 timeout %d secs, temp %d F\",\n\t\t\t   wdt->unit, wdt->timeout_secs, temp);\n\n\t\t/* overvoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_OVER) == 0)\n\t\t\tprintf(\" <PS overvoltage>\");\n\n\t\t/* undervoltage bit is active low */\n\t\tif ((status & WDT_SR_PS_UNDER) == 0)\n\t\t\tprintf(\" <PS undervoltage>\");\n\t} else {\n\t\tprintf(\"wdt%d: WDT500 timeout %d secs\",\n\t\t\t   wdt->unit, wdt->timeout_secs);\n\t}\n\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_timer_enable",
          "args": [
            "wdt",
            "90/*seconds*/"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_timer_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "385-408",
          "snippet": "static void\nwdt_timer_enable (struct wdt_softc *wdt, unsigned seconds)\n{\n\tint s;\n\n\t/* clamp range */\n\tif (seconds < 2)\n\t\tseconds = 2;\n\n\tif (seconds > 1800)\n\t\tseconds = 1800;\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\twdt_timer_disable(wdt);\n\twdt->timeout_secs = seconds;\n\n\ttimeout(wdt_timeout, wdt, hz * seconds / 2);\n\twdt_set_timeout(wdt, seconds);\n\n\t/* re-enable clock interrupts */\n\tsplx(s);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstatic void\nwdt_timer_enable (struct wdt_softc *wdt, unsigned seconds)\n{\n\tint s;\n\n\t/* clamp range */\n\tif (seconds < 2)\n\t\tseconds = 2;\n\n\tif (seconds > 1800)\n\t\tseconds = 1800;\n\n\t/* block out the timeout handler */\n\ts = splclock();\n\n\twdt_timer_disable(wdt);\n\twdt->timeout_secs = seconds;\n\n\ttimeout(wdt_timeout, wdt, hz * seconds / 2);\n\twdt_set_timeout(wdt, seconds);\n\n\t/* re-enable clock interrupts */\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_init_timer",
          "args": [
            "wdt"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_init_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "417-423",
          "snippet": "static void\nwdt_init_timer (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_TC_LO, 3);\n\twdt_8254_mode(wdt, WDT_8254_TC_HI, 2);\n\twdt_8254_count(wdt, WDT_8254_TC_LO, 41666);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */",
            "#define WDT_8254_TC_LO\t\t0\t/* low 16 bits of timeout counter  */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define\tWDT_8254_TC_HI\t\t1\t/* high 16 bits of timeout counter */\n#define WDT_8254_TC_LO\t\t0\t/* low 16 bits of timeout counter  */\n\nstatic void\nwdt_init_timer (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_TC_LO, 3);\n\twdt_8254_mode(wdt, WDT_8254_TC_HI, 2);\n\twdt_8254_count(wdt, WDT_8254_TC_LO, 41666);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_buzzer_enable",
          "args": [
            "wdt"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_buzzer_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "446-451",
          "snippet": "static void\nwdt_buzzer_enable (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BUZZER, 1);\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 1);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_8254_BUZZER\t\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_BUZZER\t\t2\n\nstatic void\nwdt_buzzer_enable (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_8254_BUZZER, 1);\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_buzzer_disable",
          "args": [
            "wdt"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_buzzer_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "459-463",
          "snippet": "static void\nwdt_buzzer_disable (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 0);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_8254_BUZZER\t\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_8254_BUZZER\t\t2\n\nstatic void\nwdt_buzzer_disable (struct wdt_softc *wdt)\n{\n\twdt_8254_mode(wdt, WDT_8254_BUZZER, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wdt_buzzer_off",
          "args": [
            "wdt"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_buzzer_off",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "434-438",
          "snippet": "static void\nwdt_buzzer_off (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_STOP_BUZZER, 0);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_STOP_BUZZER\t\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_STOP_BUZZER\t\t5\n\nstatic void\nwdt_buzzer_off (struct wdt_softc *wdt)\n{\n\tbus_space_write_1(wdt->iot, wdt->ioh, WDT_STOP_BUZZER, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shutdownhook_establish",
          "args": [
            "wdt_shutdown",
            "wdt"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wdt_is501",
          "args": [
            "wdt"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "wdt_is501",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
          "lines": "271-286",
          "snippet": "static int\nwdt_is501 (struct wdt_softc *wdt)\n{\n\t/*\n\t *\tIt makes too much sense to detect the card type\n\t *\tby the device ID, so we have to resort to testing\n\t *\tthe presence of a register to determine the type.\n\t */\n\tint v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\t/* XXX may not be reliable */\n\tif (v == 0 || v == 0xFF)\n\t\treturn(0);\n\n\treturn(1);\n}",
          "includes": [
            "#include \"wdt.h\"",
            "#include \"wdt50x.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <machine/bus.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [
            "#define WDT_TEMPERATURE\t\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\n#define WDT_TEMPERATURE\t\t5\n\nstatic int\nwdt_is501 (struct wdt_softc *wdt)\n{\n\t/*\n\t *\tIt makes too much sense to detect the card type\n\t *\tby the device ID, so we have to resort to testing\n\t *\tthe presence of a register to determine the type.\n\t */\n\tint v = bus_space_read_1(wdt->iot, wdt->ioh, WDT_TEMPERATURE);\n\n\t/* XXX may not be reliable */\n\tif (v == 0 || v == 0xFF)\n\t\treturn(0);\n\n\treturn(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "pa->pa_iot",
            "iobase",
            "iosize",
            "0",
            "&wdt->ioh"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_io_find",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "0x18",
            "&iobase",
            "&iosize"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "pci_io_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/pci_map.c",
          "lines": "186-195",
          "snippet": "int\npci_io_find(pc, pcitag, reg, iobasep, iosizep)\n\tpci_chipset_tag_t pc;\n\tpcitag_t pcitag;\n\tint reg;\n\tbus_addr_t *iobasep;\n\tbus_size_t *iosizep;\n{\n\treturn (nbsd_pci_io_find(pc, pcitag, reg, 0, iobasep, iosizep, 0));\n}",
          "includes": [
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nbsd_pci_io_find"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int nbsd_pci_io_find;\n\nint\npci_io_find(pc, pcitag, reg, iobasep, iosizep)\n\tpci_chipset_tag_t pc;\n\tpcitag_t pcitag;\n\tint reg;\n\tbus_addr_t *iobasep;\n\tbus_size_t *iosizep;\n{\n\treturn (nbsd_pci_io_find(pc, pcitag, reg, 0, iobasep, iosizep, 0));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nvoid\nwdtattach (parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct wdt_softc *wdt = (struct wdt_softc *)self;\n\tstruct pci_attach_args *const pa = (struct pci_attach_args *)aux;\n\tint unit;\n\tbus_size_t iosize;\n\tbus_addr_t iobase;\n\n\twdt->iot = pa->pa_iot;\n\n\tunit = wdt->wdt_dev.dv_unit;\n\n\t/* retrieve the I/O region (BAR2) */\n\tif (pci_io_find(pa->pa_pc, pa->pa_tag, 0x18, &iobase,\n\t    &iosize) != 0) {\n\t\tprintf(\"wdt%d: couldn't find PCI I/O region\\n\", unit);\n\t\treturn;\n\t}\n\n\t/* sanity check I/O size */\n\tif (iosize != (bus_size_t)16) {\n\t\tprintf(\"wdt%d: invalid I/O region size\\n\", unit);\n\t\treturn;\n\t}\n\n\t/* map I/O region */\n\tif (bus_space_map(pa->pa_iot, iobase, iosize, 0, &wdt->ioh) != 0) {\n\t\tprintf(\"wdt%d: couldn't map PCI I/O region\\n\", unit);\n\t\treturn;\n\t}\n\n\t/* initialize the watchdog timer structure */\n\twdt->unit  = unit;\n\twdt->procs = 0;\n\n\t/* check the feature set available */\n\tif (wdt_is501(wdt))\n\t\twdt->features = 1;\n\telse\n\t\twdt->features = 0;\n\n\t/*\n\t * register a callback for system shutdown\n\t * (we need to disable the watchdog timer during shutdown)\n\t */\n\tif (shutdownhook_establish(wdt_shutdown, wdt) == NULL)\n\t\treturn;\n\n\tif (wdt->features) {\n\t\t/*\n\t\t * turn off the buzzer, it may have been activated\n\t\t * by a previous timeout\n\t\t */\n\t\twdt_buzzer_off(wdt);\n\n#ifdef WDT_DISABLE_BUZZER\n\t\twdt_buzzer_disable(wdt);\n#else\n\t\twdt_buzzer_enable(wdt);\n#endif\n\t}\n\n\t/* initialize the timer modes and the lower 16-bit counter */\n\twdt_init_timer(wdt);\n\n\t/*\n\t * it appears the timeout queue isn't processed until the\n\t * kernel has fully booted, so we set the first timeout\n\t * far in advance, and subsequent timeouts at the normal\n\t * 30 second interval\n\t */\n\twdt_timer_enable(wdt, 90/*seconds*/);\n\twdt->timeout_secs = 30;\n\n\tprintf(\"\\n\");\n\twdt_display_status(wdt);\n}"
  },
  {
    "function_name": "wdtprobe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/wdt.c",
    "lines": "129-141",
    "snippet": "int\nwdtprobe (parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct pci_attach_args *const pa = (struct pci_attach_args *)aux;\n\n\tif (PCI_VENDOR(pa->pa_id) != PCI_VENDOR_INDCOMPSRC ||\n\t    PCI_PRODUCT(pa->pa_id) != PCI_PRODUCT_INDCOMPSRC_WDT50x)\n\t\treturn(0);\n\n\treturn(1);\n}",
    "includes": [
      "#include \"wdt.h\"",
      "#include \"wdt50x.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PCI_PRODUCT",
          "args": [
            "pa->pa_id"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_VENDOR",
          "args": [
            "pa->pa_id"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"wdt.h\"\n#include \"wdt50x.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcireg.h>\n#include <dev/pci/pcivar.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nint\nwdtprobe (parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct pci_attach_args *const pa = (struct pci_attach_args *)aux;\n\n\tif (PCI_VENDOR(pa->pa_id) != PCI_VENDOR_INDCOMPSRC ||\n\t    PCI_PRODUCT(pa->pa_id) != PCI_PRODUCT_INDCOMPSRC_WDT50x)\n\t\treturn(0);\n\n\treturn(1);\n}"
  }
]