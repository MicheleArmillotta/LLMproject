[
  {
    "function_name": "wsemul_dumb_resetop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_dumb.c",
    "lines": "234-251",
    "snippet": "void\nwsemul_dumb_resetop(cookie, op)\n\tvoid *cookie;\n\tenum wsemul_resetops op;\n{\n\tstruct wsemul_dumb_emuldata *edp = cookie;\n\n\tswitch (op) {\n\tcase WSEMUL_CLEARSCREEN:\n\t\t(*edp->emulops->eraserows)(edp->emulcookie, 0, edp->nrows,\n\t\t\t\t\t   edp->defattr);\n\t\tedp->ccol = edp->crow = 0;\n\t\t(*edp->emulops->cursor)(edp->emulcookie, 1, 0, 0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include <sys/cdefs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\twsemul_dumb_resetop",
      "void *cookie;",
      "int ccol, crow;",
      "long defattr;",
      "void *cookie;",
      "int ccol, crow;",
      "long defattr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "1",
            "0",
            "0"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "0",
            "edp->nrows",
            "edp->defattr"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\nvoid\twsemul_dumb_resetop;\nvoid *cookie;\nint ccol, crow;\nlong defattr;\nvoid *cookie;\nint ccol, crow;\nlong defattr;\n\nvoid\nwsemul_dumb_resetop(cookie, op)\n\tvoid *cookie;\n\tenum wsemul_resetops op;\n{\n\tstruct wsemul_dumb_emuldata *edp = cookie;\n\n\tswitch (op) {\n\tcase WSEMUL_CLEARSCREEN:\n\t\t(*edp->emulops->eraserows)(edp->emulcookie, 0, edp->nrows,\n\t\t\t\t\t   edp->defattr);\n\t\tedp->ccol = edp->crow = 0;\n\t\t(*edp->emulops->cursor)(edp->emulcookie, 1, 0, 0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "wsemul_dumb_detach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_dumb.c",
    "lines": "221-232",
    "snippet": "void\nwsemul_dumb_detach(cookie, crowp, ccolp)\n\tvoid *cookie;\n\tu_int *crowp, *ccolp;\n{\n\tstruct wsemul_dumb_emuldata *edp = cookie;\n\n\t*crowp = edp->crow;\n\t*ccolp = edp->ccol;\n\tif (edp != &wsemul_dumb_console_emuldata)\n\t\tfree(edp, M_DEVBUF);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include <sys/cdefs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\twsemul_dumb_detach",
      "struct wsemul_dumb_emuldata wsemul_dumb_console_emuldata;",
      "void *cookie;",
      "int ccol, crow;",
      "void *cookie;",
      "int ccol, crow;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "edp",
            "M_DEVBUF"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "wskbd_pickfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbd.c",
          "lines": "1057-1070",
          "snippet": "int\nwskbd_pickfree()\n{\n\tint i;\n\tstruct wskbd_softc *sc;\n\n\tfor (i = 0; i < wskbd_cd.cd_ndevs; i++) {\n\t\tif ((sc = wskbd_cd.cd_devs[i]) == NULL)\n\t\t\tcontinue;\n\t\tif (sc->sc_displaydv == NULL)\n\t\t\treturn (i);\n\t}\n\treturn (-1);\n}",
          "includes": [
            "#include <dev/wscons/wsmuxvar.h>",
            "#include \"wsmux.h\"",
            "#include \"wsdisplay.h\"",
            "#include <dev/wscons/wscons_callbacks.h>",
            "#include <dev/wscons/wseventvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <dev/wscons/wskbdvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/errno.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/tty.h>",
            "#include <sys/malloc.h>",
            "#include <sys/timeout.h>",
            "#include <sys/systm.h>",
            "#include <sys/syslog.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>",
            "#include <sys/cdefs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cfdriver wskbd_cd = {\n\tNULL, \"wskbd\", DV_TTY\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsmuxvar.h>\n#include \"wsmux.h\"\n#include \"wsdisplay.h\"\n#include <dev/wscons/wscons_callbacks.h>\n#include <dev/wscons/wseventvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <dev/wscons/wskbdvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/errno.h>\n#include <sys/signalvar.h>\n#include <sys/tty.h>\n#include <sys/malloc.h>\n#include <sys/timeout.h>\n#include <sys/systm.h>\n#include <sys/syslog.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/ioctl.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\nstruct cfdriver wskbd_cd = {\n\tNULL, \"wskbd\", DV_TTY\n};\n\nint\nwskbd_pickfree()\n{\n\tint i;\n\tstruct wskbd_softc *sc;\n\n\tfor (i = 0; i < wskbd_cd.cd_ndevs; i++) {\n\t\tif ((sc = wskbd_cd.cd_devs[i]) == NULL)\n\t\t\tcontinue;\n\t\tif (sc->sc_displaydv == NULL)\n\t\t\treturn (i);\n\t}\n\treturn (-1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\nvoid\twsemul_dumb_detach;\nstruct wsemul_dumb_emuldata wsemul_dumb_console_emuldata;\nvoid *cookie;\nint ccol, crow;\nvoid *cookie;\nint ccol, crow;\n\nvoid\nwsemul_dumb_detach(cookie, crowp, ccolp)\n\tvoid *cookie;\n\tu_int *crowp, *ccolp;\n{\n\tstruct wsemul_dumb_emuldata *edp = cookie;\n\n\t*crowp = edp->crow;\n\t*ccolp = edp->ccol;\n\tif (edp != &wsemul_dumb_console_emuldata)\n\t\tfree(edp, M_DEVBUF);\n}"
  },
  {
    "function_name": "wsemul_dumb_translate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_dumb.c",
    "lines": "212-219",
    "snippet": "int\nwsemul_dumb_translate(cookie, in, out)\n\tvoid *cookie;\n\tkeysym_t in;\n\tchar **out;\n{\n\treturn (0);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include <sys/cdefs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\twsemul_dumb_translate",
      "void *cookie;",
      "void *cookie;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\nint\twsemul_dumb_translate;\nvoid *cookie;\nvoid *cookie;\n\nint\nwsemul_dumb_translate(cookie, in, out)\n\tvoid *cookie;\n\tkeysym_t in;\n\tchar **out;\n{\n\treturn (0);\n}"
  },
  {
    "function_name": "wsemul_dumb_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_dumb.c",
    "lines": "130-210",
    "snippet": "void\nwsemul_dumb_output(cookie, data, count, kernel)\n\tvoid *cookie;\n\tconst u_char *data;\n\tu_int count;\n\tint kernel; /* ignored */\n{\n\tstruct wsemul_dumb_emuldata *edp = cookie;\n\tu_char c;\n\tint n;\n\n\t/* XXX */\n\t(*edp->emulops->cursor)(edp->emulcookie, 0, edp->crow, edp->ccol);\n\twhile (count-- > 0) {\n\t\tc = *data++;\n\t\tswitch (c) {\n\t\tcase ASCII_BEL:\n\t\t\twsdisplay_emulbell(edp->cbcookie);\n\t\t\tbreak;\n\n\t\tcase ASCII_BS:\n\t\t\tif (edp->ccol > 0)\n\t\t\t\tedp->ccol--;\n\t\t\tbreak;\n\n\t\tcase ASCII_CR:\n\t\t\tedp->ccol = 0;\n\t\t\tbreak;\n\n\t\tcase ASCII_HT:\n\t\t\tn = min(8 - (edp->ccol & 7),\n\t\t\t    edp->ncols - edp->ccol - 1);\n\t\t\t(*edp->emulops->erasecols)(edp->emulcookie,\n\t\t\t    edp->crow, edp->ccol, n, edp->defattr);\n\t\t\tedp->ccol += n;\n\t\t\tbreak;\n\n\t\tcase ASCII_FF:\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie, 0,\n\t\t\t    edp->nrows, edp->defattr);\n\t\t\tedp->ccol = 0;\n\t\t\tedp->crow = 0;\n\t\t\tbreak;\n\n\t\tcase ASCII_VT:\n\t\t\tif (edp->crow > 0)\n\t\t\t\tedp->crow--;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\t(*edp->emulops->putchar)(edp->emulcookie, edp->crow,\n\t\t\t    edp->ccol, c, edp->defattr);\n\t\t\tedp->ccol++;\n\n\t\t\t/* if cur col is still on cur line, done. */\n\t\t\tif (edp->ccol < edp->ncols)\n\t\t\t\tbreak;\n\n\t\t\t/* wrap the column around. */\n\t\t\tedp->ccol = 0;\n\n                \t/* FALLTHRU */\n\n\t\tcase ASCII_LF:\n\t                /* if the cur line isn't the last, incr and leave. */\n\t\t\tif (edp->crow < edp->nrows - 1) {\n\t\t\t\tedp->crow++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tn = 1;\t\t/* number of lines to scroll */\n\t\t\t(*edp->emulops->copyrows)(edp->emulcookie, n, 0,\n\t\t\t    edp->nrows - n);\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t    edp->nrows - n, n, edp->defattr);\n\t\t\tedp->crow -= n - 1;\n\t\t\tbreak;\n\t\t}\t\n\t}\n\t/* XXX */\n\t(*edp->emulops->cursor)(edp->emulcookie, 1, edp->crow, edp->ccol);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include <sys/cdefs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\twsemul_dumb_output",
      "void *cookie;",
      "int ccol, crow;",
      "long defattr;",
      "void *cookie;",
      "int ccol, crow;",
      "void *cbcookie;",
      "long defattr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "1",
            "edp->crow",
            "edp->ccol"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->nrows - n",
            "n",
            "edp->defattr"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "n",
            "0",
            "edp->nrows - n"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->crow",
            "edp->ccol",
            "c",
            "edp->defattr"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "0",
            "edp->nrows",
            "edp->defattr"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->crow",
            "edp->ccol",
            "n",
            "edp->defattr"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "8 - (edp->ccol & 7)",
            "edp->ncols - edp->ccol - 1"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_timing",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "804-819",
          "snippet": "int\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}"
        }
      },
      {
        "call_info": {
          "callee": "wsdisplay_emulbell",
          "args": [
            "edp->cbcookie"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "wsdisplay_emulbell",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsdisplay.c",
          "lines": "1249-1263",
          "snippet": "void\nwsdisplay_emulbell(v)\n\tvoid *v;\n{\n\tstruct wsscreen *scr = v;\n\n\tif (scr == NULL)\t\t/* console, before real attach */\n\t\treturn;\n\n\tif (scr->scr_flags & SCR_GRAPHICS) /* can this happen? */\n\t\treturn;\n\n\t(void) wsdisplay_internal_ioctl(scr->sc, scr, WSKBDIO_BELL, NULL,\n\t\t\t\t\tFWRITE, NULL);\n}",
          "includes": [
            "#include <dev/wscons/wsmuxvar.h>",
            "#include <dev/wscons/wseventvar.h>",
            "#include \"wsmux.h\"",
            "#include \"wskbd.h\"",
            "#include <dev/cons.h>",
            "#include <dev/wscons/wscons_callbacks.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/errno.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/tty.h>",
            "#include <sys/systm.h>",
            "#include <sys/syslog.h>",
            "#include <sys/malloc.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>",
            "#include <sys/cdefs.h>"
          ],
          "macros_used": [
            "#define SCR_GRAPHICS 4\t\t/* graphics mode, no text (emulation) output */"
          ],
          "globals_used": [
            "struct wsscreen *\nwsscreen_attach(sc, console, emul, type, cookie, ccol, crow, defattr)\n\tstruct wsdisplay_softc *sc;",
            "int console;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsmuxvar.h>\n#include <dev/wscons/wseventvar.h>\n#include \"wsmux.h\"\n#include \"wskbd.h\"\n#include <dev/cons.h>\n#include <dev/wscons/wscons_callbacks.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/errno.h>\n#include <sys/signalvar.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/syslog.h>\n#include <sys/malloc.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/ioctl.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\n#define SCR_GRAPHICS 4\t\t/* graphics mode, no text (emulation) output */\n\nstruct wsscreen *\nwsscreen_attach(sc, console, emul, type, cookie, ccol, crow, defattr)\n\tstruct wsdisplay_softc *sc;\nint console;\n\nvoid\nwsdisplay_emulbell(v)\n\tvoid *v;\n{\n\tstruct wsscreen *scr = v;\n\n\tif (scr == NULL)\t\t/* console, before real attach */\n\t\treturn;\n\n\tif (scr->scr_flags & SCR_GRAPHICS) /* can this happen? */\n\t\treturn;\n\n\t(void) wsdisplay_internal_ioctl(scr->sc, scr, WSKBDIO_BELL, NULL,\n\t\t\t\t\tFWRITE, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "0",
            "edp->crow",
            "edp->ccol"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\nvoid\twsemul_dumb_output;\nvoid *cookie;\nint ccol, crow;\nlong defattr;\nvoid *cookie;\nint ccol, crow;\nvoid *cbcookie;\nlong defattr;\n\nvoid\nwsemul_dumb_output(cookie, data, count, kernel)\n\tvoid *cookie;\n\tconst u_char *data;\n\tu_int count;\n\tint kernel; /* ignored */\n{\n\tstruct wsemul_dumb_emuldata *edp = cookie;\n\tu_char c;\n\tint n;\n\n\t/* XXX */\n\t(*edp->emulops->cursor)(edp->emulcookie, 0, edp->crow, edp->ccol);\n\twhile (count-- > 0) {\n\t\tc = *data++;\n\t\tswitch (c) {\n\t\tcase ASCII_BEL:\n\t\t\twsdisplay_emulbell(edp->cbcookie);\n\t\t\tbreak;\n\n\t\tcase ASCII_BS:\n\t\t\tif (edp->ccol > 0)\n\t\t\t\tedp->ccol--;\n\t\t\tbreak;\n\n\t\tcase ASCII_CR:\n\t\t\tedp->ccol = 0;\n\t\t\tbreak;\n\n\t\tcase ASCII_HT:\n\t\t\tn = min(8 - (edp->ccol & 7),\n\t\t\t    edp->ncols - edp->ccol - 1);\n\t\t\t(*edp->emulops->erasecols)(edp->emulcookie,\n\t\t\t    edp->crow, edp->ccol, n, edp->defattr);\n\t\t\tedp->ccol += n;\n\t\t\tbreak;\n\n\t\tcase ASCII_FF:\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie, 0,\n\t\t\t    edp->nrows, edp->defattr);\n\t\t\tedp->ccol = 0;\n\t\t\tedp->crow = 0;\n\t\t\tbreak;\n\n\t\tcase ASCII_VT:\n\t\t\tif (edp->crow > 0)\n\t\t\t\tedp->crow--;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\t(*edp->emulops->putchar)(edp->emulcookie, edp->crow,\n\t\t\t    edp->ccol, c, edp->defattr);\n\t\t\tedp->ccol++;\n\n\t\t\t/* if cur col is still on cur line, done. */\n\t\t\tif (edp->ccol < edp->ncols)\n\t\t\t\tbreak;\n\n\t\t\t/* wrap the column around. */\n\t\t\tedp->ccol = 0;\n\n                \t/* FALLTHRU */\n\n\t\tcase ASCII_LF:\n\t                /* if the cur line isn't the last, incr and leave. */\n\t\t\tif (edp->crow < edp->nrows - 1) {\n\t\t\t\tedp->crow++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tn = 1;\t\t/* number of lines to scroll */\n\t\t\t(*edp->emulops->copyrows)(edp->emulcookie, n, 0,\n\t\t\t    edp->nrows - n);\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t    edp->nrows - n, n, edp->defattr);\n\t\t\tedp->crow -= n - 1;\n\t\t\tbreak;\n\t\t}\t\n\t}\n\t/* XXX */\n\t(*edp->emulops->cursor)(edp->emulcookie, 1, edp->crow, edp->ccol);\n}"
  }
]