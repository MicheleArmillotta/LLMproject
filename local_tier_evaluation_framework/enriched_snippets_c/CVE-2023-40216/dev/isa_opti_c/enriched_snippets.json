[
  {
    "function_name": "opti_snd_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "307-342",
    "snippet": "int\nopti_snd_setup(ift, addr, irq, drq)\n\tint\tift, addr, irq, drq;\n{\n\tXDEBUG( 2, (\"opti: do SND setup type=%u,addr=%x,irq=%d,drq=%d\\n\",\n\t\t    ift, addr, irq, drq));\n\n\tif( !opti_present() )\n\t\tXDEBUG( 2, (\"opti: not present.\\n\"));\n\telse if( !OPTI_snd_valid_ift(ift) )\n\t\tXDEBUG( 2, (\"opti: invalid SND interface type.\\n\"));\n\telse if( OPTI_snd_addr(addr) == -1)\n\t\tXDEBUG( 2, (\"opti: illegal SND interface address.\\n\"));\n\telse if( OPTI_snd_irq(irq) == -1)\n\t\tXDEBUG( 2, (\"opti: wrong SND irq number.\\n\"));\n\telse if( OPTI_snd_drq(drq) == -1)\n\t\tXDEBUG( 2, (\"opti: bad SND drq number.\\n\"));\n\telse {\n\t\t\t/* so the setup */\n\t\tint s = splhigh();\n\t\tregister u_char\ta;\n\n\t\tif (ift == OPTI_WSS) {\n\t\t\ta = opti_inb(OPTI_IFTP);\n\t\t\topti_outb(OPTI_IFTP, ((a & ~OPTI_SND_MASK)\n\t\t\t\t  | (OPTI_snd_addr(addr)*16)) + 1);\n\t\t\topti_outb(OPTI_ENBL, 0x1a);\n\t\t}\n\n\t\tsplx(s);\n\t\tDELAY(1000);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_snd_addr",
      "static __inline int OPTI_snd_irq",
      "static __inline int OPTI_snd_drq",
      "static __inline void opti_outb",
      "static __inline u_char opti_inb",
      "static int opti_present"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1000"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opti_outb",
          "args": [
            "OPTI_ENBL",
            "0x1a"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "opti_outb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "200-207",
          "snippet": "static __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline void opti_outb"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\n\nstatic __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}"
        }
      },
      {
        "call_info": {
          "callee": "OPTI_snd_addr",
          "args": [
            "addr"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "OPTI_snd_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "137-157",
          "snippet": "static __inline int\nOPTI_snd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x220:\n\t\treturn 0x0;\n\tcase 0x240:\n\t\treturn 0x3;\n\tcase 0x530:\n\t\treturn 0x8;\n\tcase 0xE80:\n\t\treturn 0x9;\n\tcase 0xF40:\n\t\treturn 0xa;\n\tcase 0x604:\n\t\treturn 0xb;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int OPTI_snd_addr"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_snd_addr;\n\nstatic __inline int\nOPTI_snd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x220:\n\t\treturn 0x0;\n\tcase 0x240:\n\t\treturn 0x3;\n\tcase 0x530:\n\t\treturn 0x8;\n\tcase 0xE80:\n\t\treturn 0x9;\n\tcase 0xF40:\n\t\treturn 0xa;\n\tcase 0x604:\n\t\treturn 0xb;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "opti_inb",
          "args": [
            "OPTI_IFTP"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "opti_inb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "209-215",
          "snippet": "static __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline u_char opti_inb"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline u_char opti_inb;\n\nstatic __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}"
        }
      },
      {
        "call_info": {
          "callee": "splhigh",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: bad SND drq number.\\n\")"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPTI_snd_drq",
          "args": [
            "drq"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "OPTI_snd_drq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "183-198",
          "snippet": "static __inline int\nOPTI_snd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int OPTI_snd_drq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_snd_drq;\n\nstatic __inline int\nOPTI_snd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: wrong SND irq number.\\n\")"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPTI_snd_irq",
          "args": [
            "irq"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "OPTI_snd_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "159-181",
          "snippet": "static __inline int\nOPTI_snd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int OPTI_snd_irq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_snd_irq;\n\nstatic __inline int\nOPTI_snd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: illegal SND interface address.\\n\")"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: invalid SND interface type.\\n\")"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPTI_snd_valid_ift",
          "args": [
            "ift"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: not present.\\n\")"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opti_present",
          "args": [],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "opti_present",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "217-240",
          "snippet": "static int\nopti_present()\n{\n\tregister u_char\ta, b;\n\tint s = splhigh();\n\n\ta = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, 0x00 );\n\tb = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, a );\n\n\tif (b != 2) {\n\t\topti_type = OPTI_C928;\n\n\t\ta = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, 0x00 );\n\t\tb = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, a );\n\t}\n\n\tsplx(s);\n\n\treturn b == 2;\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline void opti_outb",
            "static __inline u_char opti_inb",
            "static int opti_present"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\nstatic __inline u_char opti_inb;\nstatic int opti_present;\n\nstatic int\nopti_present()\n{\n\tregister u_char\ta, b;\n\tint s = splhigh();\n\n\ta = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, 0x00 );\n\tb = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, a );\n\n\tif (b != 2) {\n\t\topti_type = OPTI_C928;\n\n\t\ta = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, 0x00 );\n\t\tb = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, a );\n\t}\n\n\tsplx(s);\n\n\treturn b == 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: do SND setup type=%u,addr=%x,irq=%d,drq=%d\\n\",\n\t\t    ift, addr, irq, drq)"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_snd_addr;\nstatic __inline int OPTI_snd_irq;\nstatic __inline int OPTI_snd_drq;\nstatic __inline void opti_outb;\nstatic __inline u_char opti_inb;\nstatic int opti_present;\n\nint\nopti_snd_setup(ift, addr, irq, drq)\n\tint\tift, addr, irq, drq;\n{\n\tXDEBUG( 2, (\"opti: do SND setup type=%u,addr=%x,irq=%d,drq=%d\\n\",\n\t\t    ift, addr, irq, drq));\n\n\tif( !opti_present() )\n\t\tXDEBUG( 2, (\"opti: not present.\\n\"));\n\telse if( !OPTI_snd_valid_ift(ift) )\n\t\tXDEBUG( 2, (\"opti: invalid SND interface type.\\n\"));\n\telse if( OPTI_snd_addr(addr) == -1)\n\t\tXDEBUG( 2, (\"opti: illegal SND interface address.\\n\"));\n\telse if( OPTI_snd_irq(irq) == -1)\n\t\tXDEBUG( 2, (\"opti: wrong SND irq number.\\n\"));\n\telse if( OPTI_snd_drq(drq) == -1)\n\t\tXDEBUG( 2, (\"opti: bad SND drq number.\\n\"));\n\telse {\n\t\t\t/* so the setup */\n\t\tint s = splhigh();\n\t\tregister u_char\ta;\n\n\t\tif (ift == OPTI_WSS) {\n\t\t\ta = opti_inb(OPTI_IFTP);\n\t\t\topti_outb(OPTI_IFTP, ((a & ~OPTI_SND_MASK)\n\t\t\t\t  | (OPTI_snd_addr(addr)*16)) + 1);\n\t\t\topti_outb(OPTI_ENBL, 0x1a);\n\t\t}\n\n\t\tsplx(s);\n\t\tDELAY(1000);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "opti_cd_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "242-305",
    "snippet": "int\nopti_cd_setup(ift, addr, irq, drq)\n\tint\tift, addr, irq, drq;\n{\n\tint\tret = 0;\n\n\tXDEBUG( 2, (\"opti: do CD setup type=%u, addr=0x%x, irq=%d, drq=%d\\n\",\n\t\t    ift, addr, irq, drq));\n\n\tif( !opti_present() )\n\t\tXDEBUG( 2, (\"opti: not present.\\n\"));\n\telse if( !OPTI_cd_valid_ift(ift) )\n\t\tXDEBUG( 2, (\"opti: invalid CD-ROM interface type.\\n\"));\n\telse if( OPTI_cd_addr(addr) == -1)\n\t\tXDEBUG( 2, (\"opti: illegal CD-ROM interface address.\\n\"));\n\telse if( OPTI_cd_irq(irq) == -1)\n\t\tXDEBUG( 2, (\"opti: wrong CD-ROM irq number.\\n\"));\n\telse if( OPTI_cd_drq(drq) == -1)\n\t\tXDEBUG( 2, (\"opti: bad CD_ROM drq number.\\n\"));\n\telse {\n\t\t\t/* so the setup */\n\t\tint s = splhigh();\n\t\tregister u_char\ta, b;\n\n\t\t\t/* set interface type */\n\t\ta = opti_inb( OPTI_IFTP );\n\t\tb = (opti_inb( OPTI_DATA ) & 0x20) | 3 ;\n\t\topti_outb( OPTI_DATA,  b );\n\t\topti_outb( OPTI_IFTP, (a & OPTI_SND_MASK) | 2 * ift );\n\t\topti_outb( OPTI_ENBL, 0x80 );\n\n\t\t\t/* we don't need any additional setup for IDE CD-ROM */\n\t\tif( ift != OPTI_IDE )\n\t\t{\n\t\t\t\t/* set address */\n\t\t\ta = opti_inb( OPTI_DATA );\n\t\t\topti_outb( OPTI_DATA, (a & 0x3f) |\n\t\t\t     (0x40 * OPTI_cd_addr(addr)) );\n\n\t\t\t\t/* set irq */\n\t\t\tif( irq != IRQUNK )\n\t\t\t{\n\t\t\t\ta = opti_inb( OPTI_DATA );\n\t\t\t\topti_outb( OPTI_DATA,\n\t\t\t\t\t  (inb( OPTI_DATA ) & 0xe3) |\n\t\t\t\t\t  OPTI_cd_irq(irq) );\n\t\t\t}\n\n\t\t\t\t/* set drq */\n\t\t\tif( drq != DRQUNK )\n\t\t\t{\n\t\t\t\ta = opti_inb( OPTI_DATA );\n\t\t\t\topti_outb( OPTI_DATA,\n\t\t\t\t\t  (inb( OPTI_DATA ) & 0xfc) |\n\t\t\t\t\t  OPTI_cd_drq(drq) );\n\t\t\t}\n\t\t}\n\t\tsplx(s);\n\t\tDELAY(1000);\n\t\tret = 1;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_cd_addr",
      "static __inline int OPTI_cd_irq",
      "static __inline int OPTI_cd_drq",
      "static __inline void opti_outb",
      "static __inline u_char opti_inb",
      "static int opti_present"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1000"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opti_outb",
          "args": [
            "OPTI_DATA",
            "(inb( OPTI_DATA ) & 0xfc) |\n\t\t\t\t\t  OPTI_cd_drq(drq)"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "opti_outb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "200-207",
          "snippet": "static __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline void opti_outb"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\n\nstatic __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}"
        }
      },
      {
        "call_info": {
          "callee": "OPTI_cd_drq",
          "args": [
            "drq"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "OPTI_cd_drq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "118-133",
          "snippet": "static __inline int\nOPTI_cd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int OPTI_cd_drq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_cd_drq;\n\nstatic __inline int\nOPTI_cd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "inb",
          "args": [
            "OPTI_DATA"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "opti_inb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "209-215",
          "snippet": "static __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline u_char opti_inb"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline u_char opti_inb;\n\nstatic __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}"
        }
      },
      {
        "call_info": {
          "callee": "OPTI_cd_irq",
          "args": [
            "irq"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "OPTI_cd_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "94-116",
          "snippet": "static __inline int\nOPTI_cd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int OPTI_cd_irq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_cd_irq;\n\nstatic __inline int\nOPTI_cd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "OPTI_cd_addr",
          "args": [
            "addr"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "OPTI_cd_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "76-92",
          "snippet": "static __inline int\nOPTI_cd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x320:\n\t\treturn 0xc0;\n\tcase 0x330:\n\t\treturn 0x40;\n\tcase 0x340:\n\t\treturn 0x00;\n\tcase 0x360:\n\t\treturn 0x80;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline int OPTI_cd_addr"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_cd_addr;\n\nstatic __inline int\nOPTI_cd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x320:\n\t\treturn 0xc0;\n\tcase 0x330:\n\t\treturn 0x40;\n\tcase 0x340:\n\t\treturn 0x00;\n\tcase 0x360:\n\t\treturn 0x80;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "splhigh",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: bad CD_ROM drq number.\\n\")"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: wrong CD-ROM irq number.\\n\")"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: illegal CD-ROM interface address.\\n\")"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: invalid CD-ROM interface type.\\n\")"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPTI_cd_valid_ift",
          "args": [
            "ift"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: not present.\\n\")"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opti_present",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "opti_present",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "217-240",
          "snippet": "static int\nopti_present()\n{\n\tregister u_char\ta, b;\n\tint s = splhigh();\n\n\ta = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, 0x00 );\n\tb = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, a );\n\n\tif (b != 2) {\n\t\topti_type = OPTI_C928;\n\n\t\ta = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, 0x00 );\n\t\tb = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, a );\n\t}\n\n\tsplx(s);\n\n\treturn b == 2;\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline void opti_outb",
            "static __inline u_char opti_inb",
            "static int opti_present"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\nstatic __inline u_char opti_inb;\nstatic int opti_present;\n\nstatic int\nopti_present()\n{\n\tregister u_char\ta, b;\n\tint s = splhigh();\n\n\ta = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, 0x00 );\n\tb = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, a );\n\n\tif (b != 2) {\n\t\topti_type = OPTI_C928;\n\n\t\ta = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, 0x00 );\n\t\tb = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, a );\n\t}\n\n\tsplx(s);\n\n\treturn b == 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XDEBUG",
          "args": [
            "2",
            "(\"opti: do CD setup type=%u, addr=0x%x, irq=%d, drq=%d\\n\",\n\t\t    ift, addr, irq, drq)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_cd_addr;\nstatic __inline int OPTI_cd_irq;\nstatic __inline int OPTI_cd_drq;\nstatic __inline void opti_outb;\nstatic __inline u_char opti_inb;\nstatic int opti_present;\n\nint\nopti_cd_setup(ift, addr, irq, drq)\n\tint\tift, addr, irq, drq;\n{\n\tint\tret = 0;\n\n\tXDEBUG( 2, (\"opti: do CD setup type=%u, addr=0x%x, irq=%d, drq=%d\\n\",\n\t\t    ift, addr, irq, drq));\n\n\tif( !opti_present() )\n\t\tXDEBUG( 2, (\"opti: not present.\\n\"));\n\telse if( !OPTI_cd_valid_ift(ift) )\n\t\tXDEBUG( 2, (\"opti: invalid CD-ROM interface type.\\n\"));\n\telse if( OPTI_cd_addr(addr) == -1)\n\t\tXDEBUG( 2, (\"opti: illegal CD-ROM interface address.\\n\"));\n\telse if( OPTI_cd_irq(irq) == -1)\n\t\tXDEBUG( 2, (\"opti: wrong CD-ROM irq number.\\n\"));\n\telse if( OPTI_cd_drq(drq) == -1)\n\t\tXDEBUG( 2, (\"opti: bad CD_ROM drq number.\\n\"));\n\telse {\n\t\t\t/* so the setup */\n\t\tint s = splhigh();\n\t\tregister u_char\ta, b;\n\n\t\t\t/* set interface type */\n\t\ta = opti_inb( OPTI_IFTP );\n\t\tb = (opti_inb( OPTI_DATA ) & 0x20) | 3 ;\n\t\topti_outb( OPTI_DATA,  b );\n\t\topti_outb( OPTI_IFTP, (a & OPTI_SND_MASK) | 2 * ift );\n\t\topti_outb( OPTI_ENBL, 0x80 );\n\n\t\t\t/* we don't need any additional setup for IDE CD-ROM */\n\t\tif( ift != OPTI_IDE )\n\t\t{\n\t\t\t\t/* set address */\n\t\t\ta = opti_inb( OPTI_DATA );\n\t\t\topti_outb( OPTI_DATA, (a & 0x3f) |\n\t\t\t     (0x40 * OPTI_cd_addr(addr)) );\n\n\t\t\t\t/* set irq */\n\t\t\tif( irq != IRQUNK )\n\t\t\t{\n\t\t\t\ta = opti_inb( OPTI_DATA );\n\t\t\t\topti_outb( OPTI_DATA,\n\t\t\t\t\t  (inb( OPTI_DATA ) & 0xe3) |\n\t\t\t\t\t  OPTI_cd_irq(irq) );\n\t\t\t}\n\n\t\t\t\t/* set drq */\n\t\t\tif( drq != DRQUNK )\n\t\t\t{\n\t\t\t\ta = opti_inb( OPTI_DATA );\n\t\t\t\topti_outb( OPTI_DATA,\n\t\t\t\t\t  (inb( OPTI_DATA ) & 0xfc) |\n\t\t\t\t\t  OPTI_cd_drq(drq) );\n\t\t\t}\n\t\t}\n\t\tsplx(s);\n\t\tDELAY(1000);\n\t\tret = 1;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "opti_present",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "217-240",
    "snippet": "static int\nopti_present()\n{\n\tregister u_char\ta, b;\n\tint s = splhigh();\n\n\ta = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, 0x00 );\n\tb = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, a );\n\n\tif (b != 2) {\n\t\topti_type = OPTI_C928;\n\n\t\ta = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, 0x00 );\n\t\tb = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, a );\n\t}\n\n\tsplx(s);\n\n\treturn b == 2;\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\topti_type = OPTI_C929;",
      "static __inline void opti_outb",
      "static __inline u_char opti_inb",
      "static int opti_present"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opti_outb",
          "args": [
            "OPTI_PASSWD",
            "a"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "opti_outb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "200-207",
          "snippet": "static __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline void opti_outb"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\n\nstatic __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}"
        }
      },
      {
        "call_info": {
          "callee": "opti_inb",
          "args": [
            "OPTI_PASSWD"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "opti_inb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "209-215",
          "snippet": "static __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline u_char opti_inb"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline u_char opti_inb;\n\nstatic __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}"
        }
      },
      {
        "call_info": {
          "callee": "splhigh",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\nstatic __inline u_char opti_inb;\nstatic int opti_present;\n\nstatic int\nopti_present()\n{\n\tregister u_char\ta, b;\n\tint s = splhigh();\n\n\ta = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, 0x00 );\n\tb = opti_inb( OPTI_PASSWD );\n\topti_outb( OPTI_PASSWD, a );\n\n\tif (b != 2) {\n\t\topti_type = OPTI_C928;\n\n\t\ta = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, 0x00 );\n\t\tb = opti_inb( OPTI_PASSWD );\n\t\topti_outb( OPTI_PASSWD, a );\n\t}\n\n\tsplx(s);\n\n\treturn b == 2;\n}"
  },
  {
    "function_name": "opti_inb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "209-215",
    "snippet": "static __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\topti_type = OPTI_C929;",
      "static __inline u_char opti_inb"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "inb",
          "args": [
            "port"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "opti_inb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "209-215",
          "snippet": "static __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "outb",
          "args": [
            "OPTI_PASSWD",
            "opti_type"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "opti_outb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "200-207",
          "snippet": "static __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}",
          "includes": [
            "#include <dev/isa/opti.h>",
            "#include <dev/isa/isavar.h>",
            "#include <i386/isa/icu.h>",
            "#include <machine/pio.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\topti_type = OPTI_C929;",
            "static __inline void opti_outb"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\n\nstatic __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline u_char opti_inb;\n\nstatic __inline u_char\nopti_inb(port)\n\tu_short port;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\treturn inb( port );\n}"
  },
  {
    "function_name": "opti_outb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "200-207",
    "snippet": "static __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\topti_type = OPTI_C929;",
      "static __inline void opti_outb"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "outb",
          "args": [
            "port",
            "byte"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "opti_outb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
          "lines": "200-207",
          "snippet": "static __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nint\topti_type = OPTI_C929;\nstatic __inline void opti_outb;\n\nstatic __inline void\nopti_outb(port, byte)\n\tu_short port;\n\tu_char byte;\n{\n\toutb( OPTI_PASSWD, opti_type );\n\toutb( port, byte );\n}"
  },
  {
    "function_name": "OPTI_snd_drq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "183-198",
    "snippet": "static __inline int\nOPTI_snd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_snd_drq"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_snd_drq;\n\nstatic __inline int\nOPTI_snd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}"
  },
  {
    "function_name": "OPTI_snd_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "159-181",
    "snippet": "static __inline int\nOPTI_snd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_snd_irq"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_snd_irq;\n\nstatic __inline int\nOPTI_snd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
  },
  {
    "function_name": "OPTI_snd_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "137-157",
    "snippet": "static __inline int\nOPTI_snd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x220:\n\t\treturn 0x0;\n\tcase 0x240:\n\t\treturn 0x3;\n\tcase 0x530:\n\t\treturn 0x8;\n\tcase 0xE80:\n\t\treturn 0x9;\n\tcase 0xF40:\n\t\treturn 0xa;\n\tcase 0x604:\n\t\treturn 0xb;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_snd_addr"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_snd_addr;\n\nstatic __inline int\nOPTI_snd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x220:\n\t\treturn 0x0;\n\tcase 0x240:\n\t\treturn 0x3;\n\tcase 0x530:\n\t\treturn 0x8;\n\tcase 0xE80:\n\t\treturn 0x9;\n\tcase 0xF40:\n\t\treturn 0xa;\n\tcase 0x604:\n\t\treturn 0xb;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
  },
  {
    "function_name": "OPTI_cd_drq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "118-133",
    "snippet": "static __inline int\nOPTI_cd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_cd_drq"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_cd_drq;\n\nstatic __inline int\nOPTI_cd_drq(d)\n\tint\td;\n{\n\tswitch(d) {\n\tcase 3:\n\tcase 5:\n\t\treturn 0;\n\tcase 6:\n\t\treturn 1;\n\tcase 7:\n\t\treturn 2;\n\tdefault:\n\t\treturn 3;\n\t}\n}"
  },
  {
    "function_name": "OPTI_cd_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "94-116",
    "snippet": "static __inline int\nOPTI_cd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_cd_irq"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_cd_irq;\n\nstatic __inline int\nOPTI_cd_irq(i)\n\tint\ti;\n{\n\tswitch(i) {\n\tcase 5:\n\t\treturn 0x04;\n\tcase 7:\n\t\treturn 0x08;\n\tcase 3:\n\t\treturn 0x0c;\n\tcase 9:\n\t\treturn 0x10;\n\tcase 10:\n\t\treturn 0x14;\n\tcase 11:\n\t\treturn 0x18;\n\tcase -1:\n\t\treturn 0x00;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
  },
  {
    "function_name": "OPTI_cd_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/opti.c",
    "lines": "76-92",
    "snippet": "static __inline int\nOPTI_cd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x320:\n\t\treturn 0xc0;\n\tcase 0x330:\n\t\treturn 0x40;\n\tcase 0x340:\n\t\treturn 0x00;\n\tcase 0x360:\n\t\treturn 0x80;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
    "includes": [
      "#include <dev/isa/opti.h>",
      "#include <dev/isa/isavar.h>",
      "#include <i386/isa/icu.h>",
      "#include <machine/pio.h>",
      "#include <sys/device.h>",
      "#include <sys/conf.h>",
      "#include <sys/kernel.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline int OPTI_cd_addr"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/opti.h>\n#include <dev/isa/isavar.h>\n#include <i386/isa/icu.h>\n#include <machine/pio.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic __inline int OPTI_cd_addr;\n\nstatic __inline int\nOPTI_cd_addr(a)\n\tint\ta;\n{\n\tswitch(a) {\n\tcase 0x320:\n\t\treturn 0xc0;\n\tcase 0x330:\n\t\treturn 0x40;\n\tcase 0x340:\n\t\treturn 0x00;\n\tcase 0x360:\n\t\treturn 0x80;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
  }
]