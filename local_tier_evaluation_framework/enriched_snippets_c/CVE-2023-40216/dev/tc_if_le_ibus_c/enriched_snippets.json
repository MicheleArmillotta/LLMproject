[
  {
    "function_name": "le_dec_zerobuf_gap2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_ibus.c",
    "lines": "173-193",
    "snippet": "void\nle_dec_zerobuf_gap2(sc, boff, len)\n\tstruct am7990_softc *sc;\n\tint boff, len;\n{\n\tvolatile caddr_t buf = sc->sc_mem;\n\tregister volatile u_int16_t *bptr;\n\n\tif ((unsigned)boff & 0x1) {\n\t\tbptr = ((volatile u_int16_t *)buf) + (boff - 1);\n\t\t*bptr &= 0xff;\n\t\tbptr += 2;\n\t\tlen--;\n\t} else\n\t\tbptr = ((volatile u_int16_t *)buf) + boff;\n\twhile (len > 0) {\n\t\t*bptr = 0;\n\t\tbptr += 2;\n\t\tlen -= 2;\n\t}\n}",
    "includes": [
      "#include <pmax/pmax/kn01var.h>",
      "#include <pmax/pmax/kn01.h>",
      "#include <machine/autoconf.h>",
      "#include <dev/tc/tcvar.h>",
      "#include <dev/tc/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "le_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <pmax/pmax/kn01var.h>\n#include <pmax/pmax/kn01.h>\n#include <machine/autoconf.h>\n#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nle_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));\n\nvoid\nle_dec_zerobuf_gap2(sc, boff, len)\n\tstruct am7990_softc *sc;\n\tint boff, len;\n{\n\tvolatile caddr_t buf = sc->sc_mem;\n\tregister volatile u_int16_t *bptr;\n\n\tif ((unsigned)boff & 0x1) {\n\t\tbptr = ((volatile u_int16_t *)buf) + (boff - 1);\n\t\t*bptr &= 0xff;\n\t\tbptr += 2;\n\t\tlen--;\n\t} else\n\t\tbptr = ((volatile u_int16_t *)buf) + boff;\n\twhile (len > 0) {\n\t\t*bptr = 0;\n\t\tbptr += 2;\n\t\tlen -= 2;\n\t}\n}"
  },
  {
    "function_name": "le_dec_copyfrombuf_gap2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_ibus.c",
    "lines": "143-171",
    "snippet": "void\nle_dec_copyfrombuf_gap2(sc, tov, boff, len)\n\tstruct am7990_softc *sc;\n\tvoid *tov;\n\tint boff, len;\n{\n\tvolatile caddr_t buf = sc->sc_mem;\n\tregister caddr_t to = tov;\n\tregister volatile u_int16_t *bptr;\n\tregister u_int16_t tmp;\n\n\tif (boff & 0x1) {\n\t\t/* handle unaligned first byte */\n\t\tbptr = ((volatile u_int16_t *)buf) + (boff - 1);\n\t\t*to++ = (*bptr >> 8) & 0xff;\n\t\tbptr += 2;\n\t\tlen--;\n\t} else\n\t\tbptr = ((volatile u_int16_t *)buf) + boff;\n\twhile (len > 1) {\n\t\ttmp = *bptr;\n\t\t*to++ = tmp & 0xff;\n\t\t*to++ = (tmp >> 8) & 0xff;\n\t\tbptr += 2;\n\t\tlen -= 2;\n\t}\n\tif (len == 1)\n\t\t*to = *bptr & 0xff;\n}",
    "includes": [
      "#include <pmax/pmax/kn01var.h>",
      "#include <pmax/pmax/kn01.h>",
      "#include <machine/autoconf.h>",
      "#include <dev/tc/tcvar.h>",
      "#include <dev/tc/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void le_dec_copyfrombuf_gap2",
      "le_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <pmax/pmax/kn01var.h>\n#include <pmax/pmax/kn01.h>\n#include <machine/autoconf.h>\n#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nextern void le_dec_copyfrombuf_gap2;\nle_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));\n\nvoid\nle_dec_copyfrombuf_gap2(sc, tov, boff, len)\n\tstruct am7990_softc *sc;\n\tvoid *tov;\n\tint boff, len;\n{\n\tvolatile caddr_t buf = sc->sc_mem;\n\tregister caddr_t to = tov;\n\tregister volatile u_int16_t *bptr;\n\tregister u_int16_t tmp;\n\n\tif (boff & 0x1) {\n\t\t/* handle unaligned first byte */\n\t\tbptr = ((volatile u_int16_t *)buf) + (boff - 1);\n\t\t*to++ = (*bptr >> 8) & 0xff;\n\t\tbptr += 2;\n\t\tlen--;\n\t} else\n\t\tbptr = ((volatile u_int16_t *)buf) + boff;\n\twhile (len > 1) {\n\t\ttmp = *bptr;\n\t\t*to++ = tmp & 0xff;\n\t\t*to++ = (tmp >> 8) & 0xff;\n\t\tbptr += 2;\n\t\tlen -= 2;\n\t}\n\tif (len == 1)\n\t\t*to = *bptr & 0xff;\n}"
  },
  {
    "function_name": "le_dec_copytobuf_gap2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_ibus.c",
    "lines": "114-141",
    "snippet": "void\nle_dec_copytobuf_gap2(sc, fromv, boff, len)\n\tstruct am7990_softc *sc;  \n\tvoid *fromv;\n\tint boff;\n\tregister int len;\n{\n\tvolatile caddr_t buf = sc->sc_mem;\n\tregister caddr_t from = fromv;\n\tregister volatile u_int16_t *bptr;  \n\n\tif (boff & 0x1) {\n\t\t/* handle unaligned first byte */\n\t\tbptr = ((volatile u_int16_t *)buf) + (boff - 1);\n\t\t*bptr = (*from++ << 8) | (*bptr & 0xff);\n\t\tbptr += 2;  \n\t\tlen--;\n\t} else\n\t\tbptr = ((volatile u_int16_t *)buf) + boff;\n\twhile (len > 1) {\n\t\t*bptr = (from[1] << 8) | (from[0] & 0xff);\n\t\tbptr += 2;\n\t\tfrom += 2;\n\t\tlen -= 2;\n\t}\n\tif (len == 1)\n\t\t*bptr = (u_int16_t)*from;\n}",
    "includes": [
      "#include <pmax/pmax/kn01var.h>",
      "#include <pmax/pmax/kn01.h>",
      "#include <machine/autoconf.h>",
      "#include <dev/tc/tcvar.h>",
      "#include <dev/tc/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void le_dec_copytobuf_gap2",
      "le_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <pmax/pmax/kn01var.h>\n#include <pmax/pmax/kn01.h>\n#include <machine/autoconf.h>\n#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nextern void le_dec_copytobuf_gap2;\nle_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));\n\nvoid\nle_dec_copytobuf_gap2(sc, fromv, boff, len)\n\tstruct am7990_softc *sc;  \n\tvoid *fromv;\n\tint boff;\n\tregister int len;\n{\n\tvolatile caddr_t buf = sc->sc_mem;\n\tregister caddr_t from = fromv;\n\tregister volatile u_int16_t *bptr;  \n\n\tif (boff & 0x1) {\n\t\t/* handle unaligned first byte */\n\t\tbptr = ((volatile u_int16_t *)buf) + (boff - 1);\n\t\t*bptr = (*from++ << 8) | (*bptr & 0xff);\n\t\tbptr += 2;  \n\t\tlen--;\n\t} else\n\t\tbptr = ((volatile u_int16_t *)buf) + boff;\n\twhile (len > 1) {\n\t\t*bptr = (from[1] << 8) | (from[0] & 0xff);\n\t\tbptr += 2;\n\t\tfrom += 2;\n\t\tlen -= 2;\n\t}\n\tif (len == 1)\n\t\t*bptr = (u_int16_t)*from;\n}"
  },
  {
    "function_name": "le_pmax_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_ibus.c",
    "lines": "78-105",
    "snippet": "void\nle_pmax_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct le_softc *lesc = (void *)self;\n\tregister struct am7990_softc *sc = &lesc->sc_am7990;\n\tregister u_char *cp;\n\tregister struct confargs *ca = aux;\n\n\t/*\n\t * It's on the baseboard, with a dedicated interrupt line.\n\t */\n\tlesc->sc_r1 = (struct lereg1 *)(ca->ca_addr);\n/*XXX*/\tsc->sc_mem = (void *)TC_PHYS_TO_UNCACHED(0x19000000);\n/*XXX*/\tcp = (u_char *)(TC_PHYS_TO_UNCACHED(KN01_SYS_CLOCK) + 1);\n\n\tsc->sc_copytodesc = le_dec_copytobuf_gap2;\n\tsc->sc_copyfromdesc = le_dec_copyfrombuf_gap2;\n\tsc->sc_copytobuf = le_dec_copytobuf_gap2;\n\tsc->sc_copyfrombuf = le_dec_copyfrombuf_gap2;\n\tsc->sc_zerobuf = le_dec_zerobuf_gap2;\n\n\tdec_le_common_attach(sc, cp);\n\t/* XXX more thought about ca->slotpri */\n\tkn01_intr_establish(parent, (void*)ca->ca_slotpri, TC_IPL_NET,\n\t\t\t  am7990_intr, sc);\n}",
    "includes": [
      "#include <pmax/pmax/kn01var.h>",
      "#include <pmax/pmax/kn01.h>",
      "#include <machine/autoconf.h>",
      "#include <dev/tc/tcvar.h>",
      "#include <dev/tc/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void le_dec_copytobuf_gap2",
      "extern void le_dec_copyfrombuf_gap2",
      "le_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));",
      "void\tle_pmax_attach"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kn01_intr_establish",
          "args": [
            "parent",
            "(void*)ca->ca_slotpri",
            "TC_IPL_NET",
            "am7990_intr",
            "sc"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dec_le_common_attach",
          "args": [
            "sc",
            "cp"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "dec_le_common_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_dec.c",
          "lines": "74-98",
          "snippet": "void\ndec_le_common_attach(sc, eap)\n\tstruct am7990_softc *sc;\n\tu_char *eap;\n{\n\tint i;\n\n\tsc->sc_rdcsr = le_dec_rdcsr;\n\tsc->sc_wrcsr = le_dec_wrcsr;\n\tsc->sc_hwinit = NULL;\n\n\tsc->sc_conf3 = 0;\n\tsc->sc_addr = 0;\n\tsc->sc_memsize = 65536;\n\n\t/*\n\t * Get the ethernet address out of rom\n\t */\n\tfor (i = 0; i < sizeof(sc->sc_arpcom.ac_enaddr); i++) {\n\t\tsc->sc_arpcom.ac_enaddr[i] = *eap;\n\t\teap += 4;\n\t}\n\n\tam7990_config(sc);\n}",
          "includes": [
            "#include <dev/tc/tcvar.h>",
            "#include <dev/tc/if_levar.h>",
            "#include <dev/ic/am7990var.h>",
            "#include <dev/ic/am7990reg.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/socket.h>",
            "#include <sys/syslog.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\ndec_le_common_attach(sc, eap)\n\tstruct am7990_softc *sc;\n\tu_char *eap;\n{\n\tint i;\n\n\tsc->sc_rdcsr = le_dec_rdcsr;\n\tsc->sc_wrcsr = le_dec_wrcsr;\n\tsc->sc_hwinit = NULL;\n\n\tsc->sc_conf3 = 0;\n\tsc->sc_addr = 0;\n\tsc->sc_memsize = 65536;\n\n\t/*\n\t * Get the ethernet address out of rom\n\t */\n\tfor (i = 0; i < sizeof(sc->sc_arpcom.ac_enaddr); i++) {\n\t\tsc->sc_arpcom.ac_enaddr[i] = *eap;\n\t\teap += 4;\n\t}\n\n\tam7990_config(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TC_PHYS_TO_UNCACHED",
          "args": [
            "KN01_SYS_CLOCK"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TC_PHYS_TO_UNCACHED",
          "args": [
            "0x19000000"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <pmax/pmax/kn01var.h>\n#include <pmax/pmax/kn01.h>\n#include <machine/autoconf.h>\n#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nextern void le_dec_copytobuf_gap2;\nextern void le_dec_copyfrombuf_gap2;\nle_dec_zerobuf_gap2 __P((struct am7990_softc *, int, int));\nvoid\tle_pmax_attach;\n\nvoid\nle_pmax_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct le_softc *lesc = (void *)self;\n\tregister struct am7990_softc *sc = &lesc->sc_am7990;\n\tregister u_char *cp;\n\tregister struct confargs *ca = aux;\n\n\t/*\n\t * It's on the baseboard, with a dedicated interrupt line.\n\t */\n\tlesc->sc_r1 = (struct lereg1 *)(ca->ca_addr);\n/*XXX*/\tsc->sc_mem = (void *)TC_PHYS_TO_UNCACHED(0x19000000);\n/*XXX*/\tcp = (u_char *)(TC_PHYS_TO_UNCACHED(KN01_SYS_CLOCK) + 1);\n\n\tsc->sc_copytodesc = le_dec_copytobuf_gap2;\n\tsc->sc_copyfromdesc = le_dec_copyfrombuf_gap2;\n\tsc->sc_copytobuf = le_dec_copytobuf_gap2;\n\tsc->sc_copyfrombuf = le_dec_copyfrombuf_gap2;\n\tsc->sc_zerobuf = le_dec_zerobuf_gap2;\n\n\tdec_le_common_attach(sc, cp);\n\t/* XXX more thought about ca->slotpri */\n\tkn01_intr_establish(parent, (void*)ca->ca_slotpri, TC_IPL_NET,\n\t\t\t  am7990_intr, sc);\n}"
  },
  {
    "function_name": "le_pmax_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_ibus.c",
    "lines": "65-76",
    "snippet": "int\nle_pmax_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tif (parent->dv_cfdata->cf_driver == &mainbus_cd) {\n\t  \tstruct confargs *d = aux;\n\t\tif (strcmp(\"lance\", d->ca_name) == 0)\n\t\t\treturn (1);\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include <pmax/pmax/kn01var.h>",
      "#include <pmax/pmax/kn01.h>",
      "#include <machine/autoconf.h>",
      "#include <dev/tc/tcvar.h>",
      "#include <dev/tc/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct cfdriver mainbus_cd;",
      "int\tle_pmax_match"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "\"lance\"",
            "d->ca_name"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <pmax/pmax/kn01var.h>\n#include <pmax/pmax/kn01.h>\n#include <machine/autoconf.h>\n#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nextern struct cfdriver mainbus_cd;\nint\tle_pmax_match;\n\nint\nle_pmax_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tif (parent->dv_cfdata->cf_driver == &mainbus_cd) {\n\t  \tstruct confargs *d = aux;\n\t\tif (strcmp(\"lance\", d->ca_name) == 0)\n\t\t\treturn (1);\n\t}\n\treturn (0);\n}"
  }
]