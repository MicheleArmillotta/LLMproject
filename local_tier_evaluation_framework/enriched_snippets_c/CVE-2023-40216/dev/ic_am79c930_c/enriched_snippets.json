[
  {
    "function_name": "am79c930_chip_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "371-380",
    "snippet": "void am79c930_chip_init (sc, how)\n\tstruct am79c930_softc *sc;\n{\n\t/* zero the bank select register, and leave it that way.. */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_BSS, 0);\n\tif (how)\n\t  \tsc->sc_ops = &memspace_ops;\n\telse\n\t  \tsc->sc_ops = &iospace_ops;\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct am79c930_ops iospace_ops = {\n\tio_write_1,\n\tio_write_2,\n\tio_write_4,\n\tio_write_bytes,\n\tio_read_1,\n\tio_read_2,\n\tio_read_4,\n\tio_read_bytes\n};",
      "struct am79c930_ops memspace_ops = {\n\tmem_write_1,\n\tmem_write_2,\n\tmem_write_4,\n\tmem_write_bytes,\n\tmem_read_1,\n\tmem_read_2,\n\tmem_read_4,\n\tmem_read_bytes\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_BSS",
            "0"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic struct am79c930_ops iospace_ops = {\n\tio_write_1,\n\tio_write_2,\n\tio_write_4,\n\tio_write_bytes,\n\tio_read_1,\n\tio_read_2,\n\tio_read_4,\n\tio_read_bytes\n};\nstruct am79c930_ops memspace_ops = {\n\tmem_write_1,\n\tmem_write_2,\n\tmem_write_4,\n\tmem_write_bytes,\n\tmem_read_1,\n\tmem_read_2,\n\tmem_read_4,\n\tmem_read_bytes\n};\n\nvoid am79c930_chip_init (sc, how)\n\tstruct am79c930_softc *sc;\n{\n\t/* zero the bank select register, and leave it that way.. */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_BSS, 0);\n\tif (how)\n\t  \tsc->sc_ops = &memspace_ops;\n\telse\n\t  \tsc->sc_ops = &iospace_ops;\n}"
  },
  {
    "function_name": "am79c930_regdump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "352-368",
    "snippet": "void am79c930_regdump (sc) \n\tstruct am79c930_softc *sc;\n{\n\tu_int8_t buf[8];\n\tint i;\n\n\tAM930_DELAY(5);\n\tfor (i=0; i<8; i++) {\n\t\tbuf[i] = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, i);\n\t\tAM930_DELAY(5);\n\t}\n\tprintf(\"am79c930: regdump:\");\n\tfor (i=0; i<8; i++) {\n\t\tprintf(\" %02x\", buf[i]);\n\t}\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void am79c930_regdump"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "5"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "i"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "5"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_regdump;\n\nvoid am79c930_regdump (sc) \n\tstruct am79c930_softc *sc;\n{\n\tu_int8_t buf[8];\n\tint i;\n\n\tAM930_DELAY(5);\n\tfor (i=0; i<8; i++) {\n\t\tbuf[i] = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, i);\n\t\tAM930_DELAY(5);\n\t}\n\tprintf(\"am79c930: regdump:\");\n\tfor (i=0; i<8; i++) {\n\t\tprintf(\" %02x\", buf[i]);\n\t}\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "am79c930_gcr_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "345-349",
    "snippet": "u_int8_t am79c930_gcr_read (sc)\n\tstruct am79c930_softc *sc;\n{\n\treturn bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_GCR"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nu_int8_t am79c930_gcr_read (sc)\n\tstruct am79c930_softc *sc;\n{\n\treturn bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n}"
  },
  {
    "function_name": "am79c930_gcr_clearbits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "334-343",
    "snippet": "void am79c930_gcr_clearbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr &= ~bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_GCR",
            "gcr"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_GCR"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_gcr_clearbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr &= ~bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}"
  },
  {
    "function_name": "am79c930_gcr_setbits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "319-328",
    "snippet": "void am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_GCR",
            "gcr"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_GCR"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid am79c930_gcr_setbits (sc, bits)\n\tstruct am79c930_softc *sc;\n\tu_int8_t bits;\n{\n\tu_int8_t gcr = bus_space_read_1 (sc->sc_iot, sc->sc_ioh, AM79C930_GCR);\n\n\tgcr |= bits;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_GCR, gcr);\n}"
  },
  {
    "function_name": "mem_read_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "298-310",
    "snippet": "static void mem_read_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t\n\t/* XXX higher offset values needed for bank-switching! */\n\n\tfor (i=0; i<len; i++) \n\t\tptr[i] = bus_space_read_1(sc->sc_memt, sc->sc_memh, off+i);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void mem_read_bytes"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+i"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void mem_read_bytes;\n\nstatic void mem_read_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t\n\t/* XXX higher offset values needed for bank-switching! */\n\n\tfor (i=0; i<len; i++) \n\t\tptr[i] = bus_space_read_1(sc->sc_memt, sc->sc_memh, off+i);\n}"
  },
  {
    "function_name": "mem_read_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "284-294",
    "snippet": "static u_int32_t mem_read_4 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\treturn\n\t    bus_space_read_1(sc->sc_memt, sc->sc_memh, off) |\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+1) <<8)|\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+2) <<16) |\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+3) <<24);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u_int32_t mem_read_4"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+3"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+2"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+1"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int32_t mem_read_4;\n\nstatic u_int32_t mem_read_4 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\treturn\n\t    bus_space_read_1(sc->sc_memt, sc->sc_memh, off) |\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+1) <<8)|\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+2) <<16) |\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+3) <<24);\n}"
  },
  {
    "function_name": "mem_read_2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "274-282",
    "snippet": "static u_int16_t mem_read_2 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\treturn\n\t    bus_space_read_1(sc->sc_memt, sc->sc_memh, off) |\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+1) <<8);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u_int16_t mem_read_2"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+1"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int16_t mem_read_2;\n\nstatic u_int16_t mem_read_2 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\treturn\n\t    bus_space_read_1(sc->sc_memt, sc->sc_memh, off) |\n\t    (bus_space_read_1(sc->sc_memt, sc->sc_memh, off+1) <<8);\n}"
  },
  {
    "function_name": "mem_read_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "266-272",
    "snippet": "static u_int8_t mem_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\treturn bus_space_read_1(sc->sc_memt, sc->sc_memh, off);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u_int8_t mem_read_1"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t mem_read_1;\n\nstatic u_int8_t mem_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\treturn bus_space_read_1(sc->sc_memt, sc->sc_memh, off);\n}"
  },
  {
    "function_name": "mem_write_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "252-263",
    "snippet": "static void mem_write_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t/* XXX higher offset values needed for bank-switching! */\n\t\n\tfor (i=0; i<len; i++)\n\t\tbus_space_write_1 (sc->sc_memt, sc->sc_memh, off+i, ptr[i]);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void mem_write_bytes"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+i",
            "ptr[i]"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void mem_write_bytes;\n\nstatic void mem_write_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t/* XXX higher offset values needed for bank-switching! */\n\t\n\tfor (i=0; i<len; i++)\n\t\tbus_space_write_1 (sc->sc_memt, sc->sc_memh, off+i, ptr[i]);\n}"
  },
  {
    "function_name": "mem_write_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "240-250",
    "snippet": "static void mem_write_4 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int32_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off,    val        & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+1, (val >>  8) & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+2, (val >> 16) & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+3, (val >> 24) & 0xff);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void mem_write_4"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+3",
            "(val >> 24) & 0xff"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+2",
            "(val >> 16) & 0xff"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+1",
            "(val >>  8) & 0xff"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off",
            "val        & 0xff"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void mem_write_4;\n\nstatic void mem_write_4 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int32_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off,    val        & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+1, (val >>  8) & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+2, (val >> 16) & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+3, (val >> 24) & 0xff);\n}"
  },
  {
    "function_name": "mem_write_2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "230-238",
    "snippet": "static void mem_write_2 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int16_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off,    val       & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+1, (val >> 8) & 0xff);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void mem_write_2"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off+1",
            "(val >> 8) & 0xff"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off",
            "val       & 0xff"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void mem_write_2;\n\nstatic void mem_write_2 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int16_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off,    val       & 0xff);\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off+1, (val >> 8) & 0xff);\n}"
  },
  {
    "function_name": "mem_write_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "221-228",
    "snippet": "static void mem_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off, val);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void mem_write_1"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_memt",
            "sc->sc_memh",
            "off",
            "val"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void mem_write_1;\n\nstatic void mem_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tbus_space_write_1(sc->sc_memt, sc->sc_memh, off, val);\n}"
  },
  {
    "function_name": "io_read_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "207-217",
    "snippet": "static void io_read_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t\n\tfor (i=0; i<len; i++) \n\t\tptr[i] = io_read_1(sc, off+i);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u_int8_t io_read_1",
      "static void io_read_bytes"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_read_1",
          "args": [
            "sc",
            "off+i"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "io_read_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "172-186",
          "snippet": "static u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u_int8_t io_read_1"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t io_read_1;\n\nstatic u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t io_read_1;\nstatic void io_read_bytes;\n\nstatic void io_read_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t\n\tfor (i=0; i<len; i++) \n\t\tptr[i] = io_read_1(sc, off+i);\n}"
  },
  {
    "function_name": "io_read_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "196-205",
    "snippet": "static u_int32_t io_read_4 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX bank-switching? */\n\treturn io_read_1 (sc, off) |\n\t    (io_read_1 (sc, off+1) << 8) |\n\t    (io_read_1 (sc, off+2) << 16) |\n\t    (io_read_1 (sc, off+3) << 24);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u_int8_t io_read_1",
      "static u_int32_t io_read_4"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_read_1",
          "args": [
            "sc",
            "off+3"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "io_read_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "172-186",
          "snippet": "static u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u_int8_t io_read_1"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t io_read_1;\n\nstatic u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t io_read_1;\nstatic u_int32_t io_read_4;\n\nstatic u_int32_t io_read_4 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\t/* XXX bank-switching? */\n\treturn io_read_1 (sc, off) |\n\t    (io_read_1 (sc, off+1) << 8) |\n\t    (io_read_1 (sc, off+2) << 16) |\n\t    (io_read_1 (sc, off+3) << 24);\n}"
  },
  {
    "function_name": "io_read_2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "188-194",
    "snippet": "static u_int16_t io_read_2 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\treturn io_read_1 (sc, off) |\n\t    (io_read_1 (sc, off+1) << 8);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u_int8_t io_read_1",
      "static u_int16_t io_read_2"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_read_1",
          "args": [
            "sc",
            "off+1"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "io_read_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "172-186",
          "snippet": "static u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u_int8_t io_read_1"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t io_read_1;\n\nstatic u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t io_read_1;\nstatic u_int16_t io_read_2;\n\nstatic u_int16_t io_read_2 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\treturn io_read_1 (sc, off) |\n\t    (io_read_1 (sc, off+1) << 8);\n}"
  },
  {
    "function_name": "io_read_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "172-186",
    "snippet": "static u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u_int8_t io_read_1"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_IODPA"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "1"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_LMA_LO",
            "(off&0xff)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "1"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_LMA_HI",
            "((off>>8)& 0x7f)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int8_t io_read_1;\n\nstatic u_int8_t io_read_1 (sc, off)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n{\n\tu_int8_t val;\n\t\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tval = bus_space_read_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA);\n\tAM930_DELAY(1);\n\treturn val;\n}"
  },
  {
    "function_name": "io_write_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "159-170",
    "snippet": "static void io_write_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t/* XXX higher offset values needed for bank-switching! */\n\t\n\tfor (i=0; i<len; i++)\n\t\tio_write_1 (sc, off+i, ptr[i]);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void io_write_1",
      "static void io_write_bytes"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_write_1",
          "args": [
            "sc",
            "off+i",
            "ptr[i]"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "io_write_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "122-136",
          "snippet": "static void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void io_write_1"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void io_write_1;\n\nstatic void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void io_write_1;\nstatic void io_write_bytes;\n\nstatic void io_write_bytes (sc, off, ptr, len)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t *ptr;\n\tsize_t len;\n{\n\tint i;\n\t/* XXX higher offset values needed for bank-switching! */\n\t\n\tfor (i=0; i<len; i++)\n\t\tio_write_1 (sc, off+i, ptr[i]);\n}"
  },
  {
    "function_name": "io_write_4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "147-157",
    "snippet": "static void io_write_4 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int32_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tio_write_1(sc, off,    val        & 0xff);\n\tio_write_1(sc, off+1, (val >>  8) & 0xff);\n\tio_write_1(sc, off+2, (val >> 16) & 0xff);\n\tio_write_1(sc, off+3, (val >> 24) & 0xff);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void io_write_1",
      "static void io_write_4"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_write_1",
          "args": [
            "sc",
            "off+3",
            "(val >> 24) & 0xff"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "io_write_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "122-136",
          "snippet": "static void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void io_write_1"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void io_write_1;\n\nstatic void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void io_write_1;\nstatic void io_write_4;\n\nstatic void io_write_4 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int32_t val;\n{\n\t/* XXX higher offset values needed for bank-switching! */\n\tio_write_1(sc, off,    val        & 0xff);\n\tio_write_1(sc, off+1, (val >>  8) & 0xff);\n\tio_write_1(sc, off+2, (val >> 16) & 0xff);\n\tio_write_1(sc, off+3, (val >> 24) & 0xff);\n}"
  },
  {
    "function_name": "io_write_2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "138-145",
    "snippet": "static void io_write_2 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int16_t val;\n{\n\tio_write_1(sc, off,    val       & 0xff);\n\tio_write_1(sc, off+1, (val >> 8) & 0xff);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void io_write_1",
      "static void io_write_2"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_write_1",
          "args": [
            "sc",
            "off+1",
            "(val >> 8) & 0xff"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "io_write_1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
          "lines": "122-136",
          "snippet": "static void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}",
          "includes": [
            "#include <dev/ic/am79c930var.h>",
            "#include <dev/ic/am79c930reg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <machine/cpu.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void io_write_1"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void io_write_1;\n\nstatic void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void io_write_1;\nstatic void io_write_2;\n\nstatic void io_write_2 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int16_t val;\n{\n\tio_write_1(sc, off,    val       & 0xff);\n\tio_write_1(sc, off+1, (val >> 8) & 0xff);\n}"
  },
  {
    "function_name": "io_write_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/am79c930.c",
    "lines": "122-136",
    "snippet": "static void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}",
    "includes": [
      "#include <dev/ic/am79c930var.h>",
      "#include <dev/ic/am79c930reg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <machine/cpu.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void io_write_1"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "1"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_IODPA",
            "val"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "1"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_LMA_LO",
            "(off&0xff)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "1"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "AM79C930_LMA_HI",
            "((off>>8)& 0x7f)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AM930_DELAY",
          "args": [
            "1"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/am79c930var.h>\n#include <dev/ic/am79c930reg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <machine/cpu.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void io_write_1;\n\nstatic void io_write_1 (sc, off, val)\n\tstruct am79c930_softc *sc;\n\tu_int32_t off;\n\tu_int8_t val;\n{\n\t/* XXX bank-switching? */\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_HI,\n\t    ((off>>8)& 0x7f));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_LMA_LO, (off&0xff));\n\tAM930_DELAY(1);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, AM79C930_IODPA, val);\n\tAM930_DELAY(1);\n}"
  }
]