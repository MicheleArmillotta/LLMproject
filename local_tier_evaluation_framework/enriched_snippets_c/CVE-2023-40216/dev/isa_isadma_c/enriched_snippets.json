[
  {
    "function_name": "isa_mappage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "729-745",
    "snippet": "int\nisa_mappage(mem, off, prot)\n\tvoid *mem;\n\tint off;\n\tint prot;\n{\n\tstruct isa_mem *m;\n\n\tfor(m = isa_mem_head; m && m->kva != (caddr_t)mem; m = m->next)\n\t\t;\n\tif (!m) {\n\t\tprintf(\"isa_mappage: mapping unallocted memory\\n\");\n\t\treturn -1;\n\t}\n\treturn (isa_dmamem_mmap(m->isadev, m->chan, m->addr, m->size, off,\n\t    prot, BUS_DMA_WAITOK));\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct isa_mem {\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tbus_addr_t addr;\n\tcaddr_t kva;\n\tstruct isa_mem *next;\n} *isa_mem_head = 0;",
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isa_dmamem_mmap",
          "args": [
            "m->isadev",
            "m->chan",
            "m->addr",
            "m->size",
            "off",
            "prot",
            "BUS_DMA_WAITOK"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmamem_mmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "633-656",
          "snippet": "int\nisa_dmamem_mmap(isadev, chan, addr, size, off, prot, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n\tint off, prot, flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_mmap: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tif (off < 0)\n\t\treturn (-1);\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\treturn (bus_dmamem_mmap(sc->sc_dmat, &seg, 1, off, prot, flags));\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
            "int chan;",
            "size_t size;",
            "int flags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\nint flags;\n\nint\nisa_dmamem_mmap(isadev, chan, addr, size, off, prot, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n\tint off, prot, flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_mmap: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tif (off < 0)\n\t\treturn (-1);\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\treturn (bus_dmamem_mmap(sc->sc_dmat, &seg, 1, off, prot, flags));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"isa_mappage: mapping unallocted memory\\n\""
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct isa_mem {\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tbus_addr_t addr;\n\tcaddr_t kva;\n\tstruct isa_mem *next;\n} *isa_mem_head = 0;\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\n\nint\nisa_mappage(mem, off, prot)\n\tvoid *mem;\n\tint off;\n\tint prot;\n{\n\tstruct isa_mem *m;\n\n\tfor(m = isa_mem_head; m && m->kva != (caddr_t)mem; m = m->next)\n\t\t;\n\tif (!m) {\n\t\tprintf(\"isa_mappage: mapping unallocted memory\\n\");\n\t\treturn -1;\n\t}\n\treturn (isa_dmamem_mmap(m->isadev, m->chan, m->addr, m->size, off,\n\t    prot, BUS_DMA_WAITOK));\n}"
  },
  {
    "function_name": "isa_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "708-727",
    "snippet": "void\nisa_free(addr, pool)\n\tvoid *addr;\n\tint pool;\n{\n\tstruct isa_mem **mp, *m;\n\tcaddr_t kva = (caddr_t)addr;\n\n\tfor(mp = &isa_mem_head; *mp && (*mp)->kva != kva; mp = &(*mp)->next)\n\t\t;\n\tm = *mp;\n\tif (!m) {\n\t\tprintf(\"isa_free: freeing unallocted memory\\n\");\n\t\treturn;\n\t}\n\t*mp = m->next;\n\tisa_dmamem_unmap(m->isadev, m->chan, kva, m->size);\n\tisa_dmamem_free(m->isadev, m->chan, m->addr, m->size);\n\tfree(m, pool);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct isa_mem {\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tbus_addr_t addr;\n\tcaddr_t kva;\n\tstruct isa_mem *next;\n} *isa_mem_head = 0;",
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;",
      "int pool;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "m",
            "pool"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "isa_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "708-727",
          "snippet": "void\nisa_free(addr, pool)\n\tvoid *addr;\n\tint pool;\n{\n\tstruct isa_mem **mp, *m;\n\tcaddr_t kva = (caddr_t)addr;\n\n\tfor(mp = &isa_mem_head; *mp && (*mp)->kva != kva; mp = &(*mp)->next)\n\t\t;\n\tm = *mp;\n\tif (!m) {\n\t\tprintf(\"isa_free: freeing unallocted memory\\n\");\n\t\treturn;\n\t}\n\t*mp = m->next;\n\tisa_dmamem_unmap(m->isadev, m->chan, kva, m->size);\n\tisa_dmamem_free(m->isadev, m->chan, m->addr, m->size);\n\tfree(m, pool);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "isa_dmamem_free",
          "args": [
            "m->isadev",
            "m->chan",
            "m->addr",
            "m->size"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmamem_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "572-591",
          "snippet": "void\nisa_dmamem_free(isadev, chan, addr, size)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_free: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\tbus_dmamem_free(sc->sc_dmat, &seg, 1);\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
            "int chan;",
            "size_t size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\n\nvoid\nisa_dmamem_free(isadev, chan, addr, size)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_free: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\tbus_dmamem_free(sc->sc_dmat, &seg, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isa_dmamem_unmap",
          "args": [
            "m->isadev",
            "m->chan",
            "kva",
            "m->size"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmamem_unmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "616-631",
          "snippet": "void\nisa_dmamem_unmap(isadev, chan, kva, size)\n\tstruct device *isadev;\n\tint chan;\n\tcaddr_t kva;\n\tsize_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_unmap: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tbus_dmamem_unmap(sc->sc_dmat, kva, size);\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
            "int chan;",
            "size_t size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\n\nvoid\nisa_dmamem_unmap(isadev, chan, kva, size)\n\tstruct device *isadev;\n\tint chan;\n\tcaddr_t kva;\n\tsize_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_unmap: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tbus_dmamem_unmap(sc->sc_dmat, kva, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"isa_free: freeing unallocted memory\\n\""
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct isa_mem {\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tbus_addr_t addr;\n\tcaddr_t kva;\n\tstruct isa_mem *next;\n} *isa_mem_head = 0;\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\nint pool;\n\nvoid\nisa_free(addr, pool)\n\tvoid *addr;\n\tint pool;\n{\n\tstruct isa_mem **mp, *m;\n\tcaddr_t kva = (caddr_t)addr;\n\n\tfor(mp = &isa_mem_head; *mp && (*mp)->kva != kva; mp = &(*mp)->next)\n\t\t;\n\tm = *mp;\n\tif (!m) {\n\t\tprintf(\"isa_free: freeing unallocted memory\\n\");\n\t\treturn;\n\t}\n\t*mp = m->next;\n\tisa_dmamem_unmap(m->isadev, m->chan, kva, m->size);\n\tisa_dmamem_free(m->isadev, m->chan, m->addr, m->size);\n\tfree(m, pool);\n}"
  },
  {
    "function_name": "isa_drq_isfree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "658-669",
    "snippet": "int\nisa_drq_isfree(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_drq_isfree: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\treturn ISA_DRQ_ISFREE(sc, chan);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ISA_DRQ_ISFREE",
          "args": [
            "sc",
            "chan"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_drq_isfree: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nint\nisa_drq_isfree(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_drq_isfree: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\treturn ISA_DRQ_ISFREE(sc, chan);\n}"
  },
  {
    "function_name": "isa_dmamem_mmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "633-656",
    "snippet": "int\nisa_dmamem_mmap(isadev, chan, addr, size, off, prot, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n\tint off, prot, flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_mmap: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tif (off < 0)\n\t\treturn (-1);\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\treturn (bus_dmamem_mmap(sc->sc_dmat, &seg, 1, off, prot, flags));\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;",
      "int flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_mmap",
          "args": [
            "sc->sc_dmat",
            "&seg",
            "1",
            "off",
            "prot",
            "flags"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmamem_mmap: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\nint flags;\n\nint\nisa_dmamem_mmap(isadev, chan, addr, size, off, prot, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n\tint off, prot, flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_mmap: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tif (off < 0)\n\t\treturn (-1);\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\treturn (bus_dmamem_mmap(sc->sc_dmat, &seg, 1, off, prot, flags));\n}"
  },
  {
    "function_name": "isa_dmamem_unmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "616-631",
    "snippet": "void\nisa_dmamem_unmap(isadev, chan, kva, size)\n\tstruct device *isadev;\n\tint chan;\n\tcaddr_t kva;\n\tsize_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_unmap: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tbus_dmamem_unmap(sc->sc_dmat, kva, size);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_unmap",
          "args": [
            "sc->sc_dmat",
            "kva",
            "size"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmamem_unmap: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\n\nvoid\nisa_dmamem_unmap(isadev, chan, kva, size)\n\tstruct device *isadev;\n\tint chan;\n\tcaddr_t kva;\n\tsize_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_unmap: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tbus_dmamem_unmap(sc->sc_dmat, kva, size);\n}"
  },
  {
    "function_name": "isa_dmamem_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "593-614",
    "snippet": "int\nisa_dmamem_map(isadev, chan, addr, size, kvap, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n\tcaddr_t *kvap;\n\tint flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_map: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\treturn (bus_dmamem_map(sc->sc_dmat, &seg, 1, size, kvap, flags));\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;",
      "int flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_map",
          "args": [
            "sc->sc_dmat",
            "&seg",
            "1",
            "size",
            "kvap",
            "flags"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmamem_map: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\nint flags;\n\nint\nisa_dmamem_map(isadev, chan, addr, size, kvap, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n\tcaddr_t *kvap;\n\tint flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_map: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\treturn (bus_dmamem_map(sc->sc_dmat, &seg, 1, size, kvap, flags));\n}"
  },
  {
    "function_name": "isa_dmamem_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "572-591",
    "snippet": "void\nisa_dmamem_free(isadev, chan, addr, size)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_free: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\tbus_dmamem_free(sc->sc_dmat, &seg, 1);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_free",
          "args": [
            "sc->sc_dmat",
            "&seg",
            "1"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmamem_free: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\n\nvoid\nisa_dmamem_free(isadev, chan, addr, size)\n\tstruct device *isadev;\n\tint chan;\n\tbus_addr_t addr;\n\tbus_size_t size;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_free: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tseg.ds_addr = addr;\n\tseg.ds_len = size;\n\n\tbus_dmamem_free(sc->sc_dmat, &seg, 1);\n}"
  },
  {
    "function_name": "isa_dmamem_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "542-570",
    "snippet": "int\nisa_dmamem_alloc(isadev, chan, size, addrp, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tbus_addr_t *addrp;\n\tint flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\tint error, boundary, rsegs;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_alloc: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tboundary = (chan & 4) ? (1 << 17) : (1 << 16);\n\n\tsize = round_page(size);\n\n\terror = bus_dmamem_alloc(sc->sc_dmat, size, NBPG, boundary,\n\t    &seg, 1, &rsegs, flags);\n\tif (error)\n\t\treturn (error);\n\n\t*addrp = seg.ds_addr;\n\treturn (0);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;",
      "int flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_alloc",
          "args": [
            "sc->sc_dmat",
            "size",
            "NBPG",
            "boundary",
            "&seg",
            "1",
            "&rsegs",
            "flags"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_page",
          "args": [
            "size"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmamem_alloc: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\nint flags;\n\nint\nisa_dmamem_alloc(isadev, chan, size, addrp, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tbus_addr_t *addrp;\n\tint flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dma_segment_t seg;\n\tint error, boundary, rsegs;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmamem_alloc: %s: bogus drq %d\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t}\n\n\tboundary = (chan & 4) ? (1 << 17) : (1 << 16);\n\n\tsize = round_page(size);\n\n\terror = bus_dmamem_alloc(sc->sc_dmat, size, NBPG, boundary,\n\t    &seg, 1, &rsegs, flags);\n\tif (error)\n\t\treturn (error);\n\n\t*addrp = seg.ds_addr;\n\treturn (0);\n}"
  },
  {
    "function_name": "isa_dmadone",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "513-540",
    "snippet": "void\nisa_dmadone(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dmamap_t dmam;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmadone: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tdmam = sc->sc_dmamaps[chan];\n\n\tisa_dmamask(sc, chan);\n\n\tif (isa_dmafinished(isadev, chan) == 0)\n\t\tprintf(\"%s: isa_dmadone: channel %d not finished\\n\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\n\tbus_dmamap_sync(sc->sc_dmat, dmam,\n\t    (sc->sc_dmareads & (1 << chan)) ? BUS_DMASYNC_POSTREAD :\n\t    BUS_DMASYNC_POSTWRITE);\n\n\tbus_dmamap_unload(sc->sc_dmat, dmam);\n\tsc->sc_dmareads &= ~(1 << chan);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline void isa_dmamask",
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamap_unload",
          "args": [
            "sc->sc_dmat",
            "dmam"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_sync",
          "args": [
            "sc->sc_dmat",
            "dmam",
            "(sc->sc_dmareads & (1 << chan)) ? BUS_DMASYNC_POSTREAD :\n\t    BUS_DMASYNC_POSTWRITE"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: isa_dmadone: channel %d not finished\\n\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isa_dmafinished",
          "args": [
            "isadev",
            "chan"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmafinished",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "490-511",
          "snippet": "int\nisa_dmafinished(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmafinished: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\t/* check that the terminal count was reached */\n\tif ((chan & 4) == 0)\n\t\tsc->sc_dmafinished |= bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma1h, DMA1_SR) & 0x0f;\n\telse\n\t\tsc->sc_dmafinished |= (bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma2h, DMA2_SR) & 0x0f) << 4;\n\n\treturn ((sc->sc_dmafinished & (1 << chan)) != 0);\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nint\nisa_dmafinished(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmafinished: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\t/* check that the terminal count was reached */\n\tif ((chan & 4) == 0)\n\t\tsc->sc_dmafinished |= bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma1h, DMA1_SR) & 0x0f;\n\telse\n\t\tsc->sc_dmafinished |= (bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma2h, DMA2_SR) & 0x0f) << 4;\n\n\treturn ((sc->sc_dmafinished & (1 << chan)) != 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isa_dmamask",
          "args": [
            "sc",
            "chan"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmamask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "160-179",
          "snippet": "static inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void isa_dmamask",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmamask;\nint chan;\n\nstatic inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmadone: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmamask;\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nvoid\nisa_dmadone(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dmamap_t dmam;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmadone: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tdmam = sc->sc_dmamaps[chan];\n\n\tisa_dmamask(sc, chan);\n\n\tif (isa_dmafinished(isadev, chan) == 0)\n\t\tprintf(\"%s: isa_dmadone: channel %d not finished\\n\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\n\tbus_dmamap_sync(sc->sc_dmat, dmam,\n\t    (sc->sc_dmareads & (1 << chan)) ? BUS_DMASYNC_POSTREAD :\n\t    BUS_DMASYNC_POSTWRITE);\n\n\tbus_dmamap_unload(sc->sc_dmat, dmam);\n\tsc->sc_dmareads &= ~(1 << chan);\n}"
  },
  {
    "function_name": "isa_dmafinished",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "490-511",
    "snippet": "int\nisa_dmafinished(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmafinished: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\t/* check that the terminal count was reached */\n\tif ((chan & 4) == 0)\n\t\tsc->sc_dmafinished |= bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma1h, DMA1_SR) & 0x0f;\n\telse\n\t\tsc->sc_dmafinished |= (bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma2h, DMA2_SR) & 0x0f) << 4;\n\n\treturn ((sc->sc_dmafinished & (1 << chan)) != 0);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "DMA2_SR"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "DMA1_SR"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmafinished: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nint\nisa_dmafinished(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmafinished: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\t/* check that the terminal count was reached */\n\tif ((chan & 4) == 0)\n\t\tsc->sc_dmafinished |= bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma1h, DMA1_SR) & 0x0f;\n\telse\n\t\tsc->sc_dmafinished |= (bus_space_read_1(sc->sc_iot,\n\t\t    sc->sc_dma2h, DMA2_SR) & 0x0f) << 4;\n\n\treturn ((sc->sc_dmafinished & (1 << chan)) != 0);\n}"
  },
  {
    "function_name": "isa_dmacount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "441-488",
    "snippet": "bus_size_t\nisa_dmacount(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tint waport;\n\tbus_size_t nbytes;\n\tint ochan = chan & 3;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmacount: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tisa_dmamask(sc, chan);\n\n\t/*\n\t * We have to shift the byte count by 1.  If we're in auto-initialize\n\t * mode, the count may have wrapped around to the initial value.  We\n\t * can't use the TC bit to check for this case, so instead we compare\n\t * against the original byte count.\n\t * If we're not in auto-initialize mode, then the count will wrap to\n\t * -1, so we also handle that case.\n\t */\n\tif ((chan & 4) == 0) {\n\t\twaport = DMA1_CHN(ochan);\n\t\tnbytes = bus_space_read_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    waport + 1) + 1;\n\t\tnbytes += bus_space_read_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    waport + 1) << 8;\n\t\tnbytes &= 0xffff;\n\t} else {\n\t\twaport = DMA2_CHN(ochan);\n\t\tnbytes = bus_space_read_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    waport + 2) + 1;\n\t\tnbytes += bus_space_read_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    waport + 2) << 8;\n\t\tnbytes <<= 1;\n\t\tnbytes &= 0x1ffff;\n\t}\n\n\tif (nbytes == sc->sc_dmalength[chan])\n\t\tnbytes = 0;\n\n\tisa_dmaunmask(sc, chan);\n\treturn (nbytes);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline void isa_dmaunmask",
      "static inline void isa_dmamask",
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isa_dmaunmask",
          "args": [
            "sc",
            "chan"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmaunmask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "144-158",
          "snippet": "static inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void isa_dmaunmask",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmaunmask;\nint chan;\n\nstatic inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "waport + 2"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "waport + 2"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMA2_CHN",
          "args": [
            "ochan"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "waport + 1"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "waport + 1"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMA1_CHN",
          "args": [
            "ochan"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isa_dmamask",
          "args": [
            "sc",
            "chan"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmamask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "160-179",
          "snippet": "static inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void isa_dmamask",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmamask;\nint chan;\n\nstatic inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmacount: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmaunmask;\nstatic inline void isa_dmamask;\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nbus_size_t\nisa_dmacount(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tint waport;\n\tbus_size_t nbytes;\n\tint ochan = chan & 3;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmacount: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tisa_dmamask(sc, chan);\n\n\t/*\n\t * We have to shift the byte count by 1.  If we're in auto-initialize\n\t * mode, the count may have wrapped around to the initial value.  We\n\t * can't use the TC bit to check for this case, so instead we compare\n\t * against the original byte count.\n\t * If we're not in auto-initialize mode, then the count will wrap to\n\t * -1, so we also handle that case.\n\t */\n\tif ((chan & 4) == 0) {\n\t\twaport = DMA1_CHN(ochan);\n\t\tnbytes = bus_space_read_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    waport + 1) + 1;\n\t\tnbytes += bus_space_read_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    waport + 1) << 8;\n\t\tnbytes &= 0xffff;\n\t} else {\n\t\twaport = DMA2_CHN(ochan);\n\t\tnbytes = bus_space_read_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    waport + 2) + 1;\n\t\tnbytes += bus_space_read_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    waport + 2) << 8;\n\t\tnbytes <<= 1;\n\t\tnbytes &= 0x1ffff;\n\t}\n\n\tif (nbytes == sc->sc_dmalength[chan])\n\t\tnbytes = 0;\n\n\tisa_dmaunmask(sc, chan);\n\treturn (nbytes);\n}"
  },
  {
    "function_name": "isa_dmaabort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "424-439",
    "snippet": "void\nisa_dmaabort(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmaabort: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tisa_dmamask(sc, chan);\n\tbus_dmamap_unload(sc->sc_dmat, sc->sc_dmamaps[chan]);\n\tsc->sc_dmareads &= ~(1 << chan);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline void isa_dmamask",
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamap_unload",
          "args": [
            "sc->sc_dmat",
            "sc->sc_dmamaps[chan]"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isa_dmamask",
          "args": [
            "sc",
            "chan"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmamask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "160-179",
          "snippet": "static inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void isa_dmamask",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmamask;\nint chan;\n\nstatic inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmaabort: %s: bogus drq %d\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmamask;\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nvoid\nisa_dmaabort(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_dmaabort: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\n\tisa_dmamask(sc, chan);\n\tbus_dmamap_unload(sc->sc_dmat, sc->sc_dmamaps[chan]);\n\tsc->sc_dmareads &= ~(1 << chan);\n}"
  },
  {
    "function_name": "isa_dmastart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "288-422",
    "snippet": "int\nisa_dmastart(isadev, chan, addr, nbytes, p, flags, busdmaflags)\n\tstruct device *isadev;\n\tint chan;\n\tvoid *addr;\n\tbus_size_t nbytes;\n\tstruct proc *p;\n\tint flags;\n\tint busdmaflags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dmamap_t dmam;\n\tbus_addr_t dmaaddr;\n\tint waport;\n\tint ochan = chan & 3;\n\tint error;\n#ifdef __ISADMA_COMPAT\n\tint compat = busdmaflags & BUS_DMA_BUS1;\n\n\tbusdmaflags &= ~BUS_DMA_BUS1;\n#endif /* __ISADMA_COMPAT */\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n#ifdef ISADMA_DEBUG\n\tprintf(\"isa_dmastart: drq %d, addr %p, nbytes 0x%lx, p %p, \"\n\t    \"flags 0x%x, dmaflags 0x%x\\n\",\n\t    chan, addr, nbytes, p, flags, busdmaflags);\n#endif\n\n\tif (chan & 4) {\n\t\tif (nbytes > (1 << 17) || nbytes & 1 || (u_long)addr & 1) {\n\t\t\tprintf(\"%s: drq %d, nbytes 0x%lx, addr %p\\n\",\n\t\t\t    sc->sc_dev.dv_xname, chan, nbytes, addr);\n\t\t\tgoto lose;\n\t\t}\n\t} else {\n\t\tif (nbytes > (1 << 16)) {\n\t\t\tprintf(\"%s: drq %d, nbytes 0x%lx\\n\",\n\t\t\t    sc->sc_dev.dv_xname, chan, nbytes);\n\t\t\tgoto lose;\n\t\t}\n\t}\n\n\tdmam = sc->sc_dmamaps[chan];\n\tif (dmam == NULL) {\n#ifdef __ISADMA_COMPAT\n\t\tif (compat)\n\t\t\tdmam = sc->sc_dmamaps[chan] = isadma_dmam[chan];\n\t\telse\n#endif /* __ISADMA_COMPAT */\n\t\tpanic(\"isa_dmastart: no DMA map for chan %d\", chan);\n\t}\n\n\terror = bus_dmamap_load(sc->sc_dmat, dmam, addr, nbytes, p,\n\t    busdmaflags);\n\tif (error)\n\t\treturn (error);\n\n#ifdef ISADMA_DEBUG\n\t__asm(\".globl isa_dmastart_afterload ; isa_dmastart_afterload:\");\n#endif\n\n\tif (flags & DMAMODE_READ) {\n\t\tbus_dmamap_sync(sc->sc_dmat, dmam, BUS_DMASYNC_PREREAD);\n\t\tsc->sc_dmareads |= (1 << chan);\n\t} else {\n\t\tbus_dmamap_sync(sc->sc_dmat, dmam, BUS_DMASYNC_PREWRITE);\n\t\tsc->sc_dmareads &= ~(1 << chan);\n\t}\n\n\tdmaaddr = dmam->dm_segs[0].ds_addr;\n\n#ifdef ISADMA_DEBUG\n\tprintf(\"     dmaaddr 0x%lx\\n\", dmaaddr);\n\n\t__asm(\".globl isa_dmastart_aftersync ; isa_dmastart_aftersync:\");\n#endif\n\n\tsc->sc_dmalength[chan] = nbytes;\n\n\tisa_dmamask(sc, chan);\n\tsc->sc_dmafinished &= ~(1 << chan);\n\n\tif ((chan & 4) == 0) {\n\t\t/* set dma channel mode */\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, DMA1_MODE,\n\t\t    ochan | dmamode[flags]);\n\n\t\t/* send start address */\n\t\twaport = DMA1_CHN(ochan);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dmapgh,\n\t\t    dmapageport[0][ochan], (dmaaddr >> 16) & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport,\n\t\t    dmaaddr & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport,\n\t\t    (dmaaddr >> 8) & 0xff);\n\n\t\t/* send count */\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport + 1,\n\t\t    (--nbytes) & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport + 1,\n\t\t    (nbytes >> 8) & 0xff);\n\t} else {\n\t\t/* set dma channel mode */\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, DMA2_MODE,\n\t\t    ochan | dmamode[flags]);\n\n\t\t/* send start address */\n\t\twaport = DMA2_CHN(ochan);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dmapgh,\n\t\t    dmapageport[1][ochan], (dmaaddr >> 16) & 0xff);\n\t\tdmaaddr >>= 1;\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport,\n\t\t    dmaaddr & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport,\n\t\t    (dmaaddr >> 8) & 0xff);\n\n\t\t/* send count */\n\t\tnbytes >>= 1;\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport + 2,\n\t\t    (--nbytes) & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport + 2,\n\t\t    (nbytes >> 8) & 0xff);\n\t}\n\n\tisa_dmaunmask(sc, chan);\n\treturn (0);\n\n lose:\n\tpanic(\"isa_dmastart\");\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int dmapageport[2][4] = {\n\t{0x7, 0x3, 0x1, 0x2},\n\t{0xf, 0xb, 0x9, 0xa}\n};",
      "static u_int8_t dmamode[4] = {\n\tDMA37MD_READ | DMA37MD_SINGLE,\n\tDMA37MD_WRITE | DMA37MD_SINGLE,\n\tDMA37MD_READ | DMA37MD_SINGLE | DMA37MD_LOOP,\n\tDMA37MD_WRITE | DMA37MD_SINGLE | DMA37MD_LOOP\n};",
      "static inline void isa_dmaunmask",
      "static inline void isa_dmamask",
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "int flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmastart\""
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isa_dmaunmask",
          "args": [
            "sc",
            "chan"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmaunmask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "144-158",
          "snippet": "static inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void isa_dmaunmask",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmaunmask;\nint chan;\n\nstatic inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "waport + 2",
            "(nbytes >> 8) & 0xff"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "waport + 2",
            "(--nbytes) & 0xff"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "waport",
            "(dmaaddr >> 8) & 0xff"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "waport",
            "dmaaddr & 0xff"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dmapgh",
            "dmapageport[1][ochan]",
            "(dmaaddr >> 16) & 0xff"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMA2_CHN",
          "args": [
            "ochan"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "DMA2_MODE",
            "ochan | dmamode[flags]"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "waport + 1",
            "(nbytes >> 8) & 0xff"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "waport + 1",
            "(--nbytes) & 0xff"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "waport",
            "(dmaaddr >> 8) & 0xff"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "waport",
            "dmaaddr & 0xff"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dmapgh",
            "dmapageport[0][ochan]",
            "(dmaaddr >> 16) & 0xff"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMA1_CHN",
          "args": [
            "ochan"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "DMA1_MODE",
            "ochan | dmamode[flags]"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isa_dmamask",
          "args": [
            "sc",
            "chan"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmamask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "160-179",
          "snippet": "static inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void isa_dmamask",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmamask;\nint chan;\n\nstatic inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"     dmaaddr 0x%lx\\n\"",
            "dmaaddr"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_dmamap_sync",
          "args": [
            "sc->sc_dmat",
            "dmam",
            "BUS_DMASYNC_PREWRITE"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_sync",
          "args": [
            "sc->sc_dmat",
            "dmam",
            "BUS_DMASYNC_PREREAD"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_load",
          "args": [
            "sc->sc_dmat",
            "dmam",
            "addr",
            "nbytes",
            "p",
            "busdmaflags"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmastart: no DMA map for chan %d\"",
            "chan"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int dmapageport[2][4] = {\n\t{0x7, 0x3, 0x1, 0x2},\n\t{0xf, 0xb, 0x9, 0xa}\n};\nstatic u_int8_t dmamode[4] = {\n\tDMA37MD_READ | DMA37MD_SINGLE,\n\tDMA37MD_WRITE | DMA37MD_SINGLE,\n\tDMA37MD_READ | DMA37MD_SINGLE | DMA37MD_LOOP,\n\tDMA37MD_WRITE | DMA37MD_SINGLE | DMA37MD_LOOP\n};\nstatic inline void isa_dmaunmask;\nstatic inline void isa_dmamask;\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nint flags;\n\nint\nisa_dmastart(isadev, chan, addr, nbytes, p, flags, busdmaflags)\n\tstruct device *isadev;\n\tint chan;\n\tvoid *addr;\n\tbus_size_t nbytes;\n\tstruct proc *p;\n\tint flags;\n\tint busdmaflags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_dmamap_t dmam;\n\tbus_addr_t dmaaddr;\n\tint waport;\n\tint ochan = chan & 3;\n\tint error;\n#ifdef __ISADMA_COMPAT\n\tint compat = busdmaflags & BUS_DMA_BUS1;\n\n\tbusdmaflags &= ~BUS_DMA_BUS1;\n#endif /* __ISADMA_COMPAT */\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n#ifdef ISADMA_DEBUG\n\tprintf(\"isa_dmastart: drq %d, addr %p, nbytes 0x%lx, p %p, \"\n\t    \"flags 0x%x, dmaflags 0x%x\\n\",\n\t    chan, addr, nbytes, p, flags, busdmaflags);\n#endif\n\n\tif (chan & 4) {\n\t\tif (nbytes > (1 << 17) || nbytes & 1 || (u_long)addr & 1) {\n\t\t\tprintf(\"%s: drq %d, nbytes 0x%lx, addr %p\\n\",\n\t\t\t    sc->sc_dev.dv_xname, chan, nbytes, addr);\n\t\t\tgoto lose;\n\t\t}\n\t} else {\n\t\tif (nbytes > (1 << 16)) {\n\t\t\tprintf(\"%s: drq %d, nbytes 0x%lx\\n\",\n\t\t\t    sc->sc_dev.dv_xname, chan, nbytes);\n\t\t\tgoto lose;\n\t\t}\n\t}\n\n\tdmam = sc->sc_dmamaps[chan];\n\tif (dmam == NULL) {\n#ifdef __ISADMA_COMPAT\n\t\tif (compat)\n\t\t\tdmam = sc->sc_dmamaps[chan] = isadma_dmam[chan];\n\t\telse\n#endif /* __ISADMA_COMPAT */\n\t\tpanic(\"isa_dmastart: no DMA map for chan %d\", chan);\n\t}\n\n\terror = bus_dmamap_load(sc->sc_dmat, dmam, addr, nbytes, p,\n\t    busdmaflags);\n\tif (error)\n\t\treturn (error);\n\n#ifdef ISADMA_DEBUG\n\t__asm(\".globl isa_dmastart_afterload ; isa_dmastart_afterload:\");\n#endif\n\n\tif (flags & DMAMODE_READ) {\n\t\tbus_dmamap_sync(sc->sc_dmat, dmam, BUS_DMASYNC_PREREAD);\n\t\tsc->sc_dmareads |= (1 << chan);\n\t} else {\n\t\tbus_dmamap_sync(sc->sc_dmat, dmam, BUS_DMASYNC_PREWRITE);\n\t\tsc->sc_dmareads &= ~(1 << chan);\n\t}\n\n\tdmaaddr = dmam->dm_segs[0].ds_addr;\n\n#ifdef ISADMA_DEBUG\n\tprintf(\"     dmaaddr 0x%lx\\n\", dmaaddr);\n\n\t__asm(\".globl isa_dmastart_aftersync ; isa_dmastart_aftersync:\");\n#endif\n\n\tsc->sc_dmalength[chan] = nbytes;\n\n\tisa_dmamask(sc, chan);\n\tsc->sc_dmafinished &= ~(1 << chan);\n\n\tif ((chan & 4) == 0) {\n\t\t/* set dma channel mode */\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, DMA1_MODE,\n\t\t    ochan | dmamode[flags]);\n\n\t\t/* send start address */\n\t\twaport = DMA1_CHN(ochan);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dmapgh,\n\t\t    dmapageport[0][ochan], (dmaaddr >> 16) & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport,\n\t\t    dmaaddr & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport,\n\t\t    (dmaaddr >> 8) & 0xff);\n\n\t\t/* send count */\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport + 1,\n\t\t    (--nbytes) & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h, waport + 1,\n\t\t    (nbytes >> 8) & 0xff);\n\t} else {\n\t\t/* set dma channel mode */\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, DMA2_MODE,\n\t\t    ochan | dmamode[flags]);\n\n\t\t/* send start address */\n\t\twaport = DMA2_CHN(ochan);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dmapgh,\n\t\t    dmapageport[1][ochan], (dmaaddr >> 16) & 0xff);\n\t\tdmaaddr >>= 1;\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport,\n\t\t    dmaaddr & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport,\n\t\t    (dmaaddr >> 8) & 0xff);\n\n\t\t/* send count */\n\t\tnbytes >>= 1;\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport + 2,\n\t\t    (--nbytes) & 0xff);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h, waport + 2,\n\t\t    (nbytes >> 8) & 0xff);\n\t}\n\n\tisa_dmaunmask(sc, chan);\n\treturn (0);\n\n lose:\n\tpanic(\"isa_dmastart\");\n}"
  },
  {
    "function_name": "isa_dmamap_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "257-282",
    "snippet": "void\nisa_dmamap_destroy(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tif (ISA_DRQ_ISFREE(sc, chan)) {\n\t\tprintf(\"%s: drq %d is already free\\n\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tISA_DRQ_FREE(sc, chan);\n\n\tbus_dmamap_destroy(sc->sc_dmat, sc->sc_dmamaps[chan]);\n\treturn;\n\n lose:\n\tpanic(\"isa_dmamap_destroy\");\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmamap_destroy\""
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_destroy",
          "args": [
            "sc->sc_dmat",
            "sc->sc_dmamaps[chan]"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISA_DRQ_FREE",
          "args": [
            "sc",
            "chan"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: drq %d is already free\\n\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISA_DRQ_ISFREE",
          "args": [
            "sc",
            "chan"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nvoid\nisa_dmamap_destroy(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tif (ISA_DRQ_ISFREE(sc, chan)) {\n\t\tprintf(\"%s: drq %d is already free\\n\",\n\t\t    sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tISA_DRQ_FREE(sc, chan);\n\n\tbus_dmamap_destroy(sc->sc_dmat, sc->sc_dmamaps[chan]);\n\treturn;\n\n lose:\n\tpanic(\"isa_dmamap_destroy\");\n}"
  },
  {
    "function_name": "isa_dmamap_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "220-255",
    "snippet": "int\nisa_dmamap_create(isadev, chan, size, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tint flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_size_t maxsize;\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tif (chan & 4)\n\t\tmaxsize = (1 << 17);\n\telse\n\t\tmaxsize = (1 << 16);\n\n\tif (size > maxsize)\n\t\treturn (EINVAL);\n\n\tif (ISA_DRQ_ISFREE(sc, chan) == 0) {\n\t\tprintf(\"%s: drq %d is not free\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tISA_DRQ_ALLOC(sc, chan);\n\n\treturn (bus_dmamap_create(sc->sc_dmat, size, 1, size, maxsize,\n\t    flags, &sc->sc_dmamaps[chan]));\n\n lose:\n\tpanic(\"isa_dmamap_create\");\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;",
      "size_t size;",
      "int flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmamap_create\""
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_create",
          "args": [
            "sc->sc_dmat",
            "size",
            "1",
            "size",
            "maxsize",
            "flags",
            "&sc->sc_dmamaps[chan]"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISA_DRQ_ALLOC",
          "args": [
            "sc",
            "chan"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: drq %d is not free\\n\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISA_DRQ_ISFREE",
          "args": [
            "sc",
            "chan"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\nsize_t size;\nint flags;\n\nint\nisa_dmamap_create(isadev, chan, size, flags)\n\tstruct device *isadev;\n\tint chan;\n\tbus_size_t size;\n\tint flags;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tbus_size_t maxsize;\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tif (chan & 4)\n\t\tmaxsize = (1 << 17);\n\telse\n\t\tmaxsize = (1 << 16);\n\n\tif (size > maxsize)\n\t\treturn (EINVAL);\n\n\tif (ISA_DRQ_ISFREE(sc, chan) == 0) {\n\t\tprintf(\"%s: drq %d is not free\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tISA_DRQ_ALLOC(sc, chan);\n\n\treturn (bus_dmamap_create(sc->sc_dmat, size, 1, size, maxsize,\n\t    flags, &sc->sc_dmamaps[chan]));\n\n lose:\n\tpanic(\"isa_dmamap_create\");\n}"
  },
  {
    "function_name": "isa_dmacascade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "185-218",
    "snippet": "void\nisa_dmacascade(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tint ochan = chan & 3;\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tif (ISA_DRQ_ISFREE(sc, chan) == 0) {\n\t\tprintf(\"%s: DRQ %d is not free\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tISA_DRQ_ALLOC(sc, chan);\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_MODE, ochan | DMA37MD_CASCADE);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_MODE, ochan | DMA37MD_CASCADE);\n\n\tisa_dmaunmask(sc, chan);\n\treturn;\n\n lose:\n\tpanic(\"isa_dmacascade\");\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline void isa_dmaunmask",
      "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isa_dmacascade\""
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isa_dmaunmask",
          "args": [
            "sc",
            "chan"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "isa_dmaunmask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "144-158",
          "snippet": "static inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void isa_dmaunmask",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmaunmask;\nint chan;\n\nstatic inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "DMA2_MODE",
            "ochan | DMA37MD_CASCADE"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "DMA1_MODE",
            "ochan | DMA37MD_CASCADE"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISA_DRQ_ALLOC",
          "args": [
            "sc",
            "chan"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: DRQ %d is not free\\n\"",
            "sc->sc_dev.dv_xname",
            "chan"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISA_DRQ_ISFREE",
          "args": [
            "sc",
            "chan"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmaunmask;\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nvoid\nisa_dmacascade(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tint ochan = chan & 3;\n\n\tif (chan < 0 || chan > 7) {\n\t\tprintf(\"%s: bogus drq %d\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tif (ISA_DRQ_ISFREE(sc, chan) == 0) {\n\t\tprintf(\"%s: DRQ %d is not free\\n\", sc->sc_dev.dv_xname, chan);\n\t\tgoto lose;\n\t}\n\n\tISA_DRQ_ALLOC(sc, chan);\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_MODE, ochan | DMA37MD_CASCADE);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_MODE, ochan | DMA37MD_CASCADE);\n\n\tisa_dmaunmask(sc, chan);\n\treturn;\n\n lose:\n\tpanic(\"isa_dmacascade\");\n}"
  },
  {
    "function_name": "isa_dmamask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "160-179",
    "snippet": "static inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline void isa_dmamask",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "DMA2_FFC",
            "0"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "DMA2_SMSK",
            "ochan | DMA37SM_SET"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "DMA1_FFC",
            "0"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "DMA1_SMSK",
            "ochan | DMA37SM_SET"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmamask;\nint chan;\n\nstatic inline void\nisa_dmamask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0) {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_FFC, 0);\n\t} else {\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_SET);\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_FFC, 0);\n\t}\n}"
  },
  {
    "function_name": "isa_dmaunmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "144-158",
    "snippet": "static inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline void isa_dmaunmask",
      "int chan;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma2h",
            "DMA2_SMSK",
            "ochan | DMA37SM_CLEAR"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_dma1h",
            "DMA1_SMSK",
            "ochan | DMA37SM_CLEAR"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic inline void isa_dmaunmask;\nint chan;\n\nstatic inline void\nisa_dmaunmask(sc, chan)\n\tstruct isa_softc *sc;\n\tint chan;\n{\n\tint ochan = chan & 3;\n\n\t/* set dma channel mode, and set dma channel mode */\n\tif ((chan & 4) == 0)\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma1h,\n\t\t    DMA1_SMSK, ochan | DMA37SM_CLEAR);\n\telse\n\t\tbus_space_write_1(sc->sc_iot, sc->sc_dma2h,\n\t\t    DMA2_SMSK, ochan | DMA37SM_CLEAR);\n}"
  },
  {
    "function_name": "isadmaattach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "116-139",
    "snippet": "void\nisadmaattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n#ifdef __ISADMA_COMPAT\n\tint i, sz;\n\tstruct isa_softc *sc = (struct isa_softc *)parent;\n\n\t/* XXX ugly, but will go away soon... */\n\tisa_dev = parent;\n\n\tfor (i = 0; i < 8; i++) {\n\t\tsz = (i & 4) ? 1 << 17 : 1 << 16;\n\t\tif ((bus_dmamap_create(sc->sc_dmat, sz, 1, sz, sz,\n\t\t    BUS_DMA_NOWAIT|BUS_DMA_ALLOCNOW, &isadma_dmam[i])) != 0)\n\t\t\tpanic(\"isadmaattach: can not create DMA map\");\n\t}\n#endif\n\n\t/* XXX I'd like to map the DMA ports here, see isa.c why not... */\n\n\tprintf(\"\\n\");\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isadmaattach"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"isadmaattach: can not create DMA map\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_create",
          "args": [
            "sc->sc_dmat",
            "sz",
            "1",
            "sz",
            "sz",
            "BUS_DMA_NOWAIT|BUS_DMA_ALLOCNOW",
            "&isadma_dmam[i]"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isadmaattach;\n\nvoid\nisadmaattach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n#ifdef __ISADMA_COMPAT\n\tint i, sz;\n\tstruct isa_softc *sc = (struct isa_softc *)parent;\n\n\t/* XXX ugly, but will go away soon... */\n\tisa_dev = parent;\n\n\tfor (i = 0; i < 8; i++) {\n\t\tsz = (i & 4) ? 1 << 17 : 1 << 16;\n\t\tif ((bus_dmamap_create(sc->sc_dmat, sz, 1, sz, sz,\n\t\t    BUS_DMA_NOWAIT|BUS_DMA_ALLOCNOW, &isadma_dmam[i])) != 0)\n\t\t\tpanic(\"isadmaattach: can not create DMA map\");\n\t}\n#endif\n\n\t/* XXX I'd like to map the DMA ports here, see isa.c why not... */\n\n\tprintf(\"\\n\");\n}"
  },
  {
    "function_name": "isadmamatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
    "lines": "104-114",
    "snippet": "int\nisadmamatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct isa_attach_args *ia = aux;\n\n\t/* Sure we exist */\n\tia->ia_iosize = 0;\n\treturn (1);\n}",
    "includes": [
      "#include <sys/malloc.h>",
      "#include <dev/isa/isadmareg.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isareg.h>",
      "#include <machine/bus.h>",
      "#include <vm/vm.h>",
      "#include <sys/device.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isadmamatch"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isadmamatch;\n\nint\nisadmamatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct isa_attach_args *ia = aux;\n\n\t/* Sure we exist */\n\tia->ia_iosize = 0;\n\treturn (1);\n}"
  }
]