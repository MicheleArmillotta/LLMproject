[
  {
    "function_name": "wskbd_load_keymap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
    "lines": "407-477",
    "snippet": "int\nwskbd_load_keymap(mapdata, map, maplen)\n\tconst struct wskbd_mapdata *mapdata;\n\tstruct wscons_keymap **map;\n\tint *maplen;\n{\n\tint i, s, kc, stack_ptr;\n\tconst keysym_t *kp;\n\tconst struct wscons_keydesc *mp, *stack[10];\n\tkbd_t cur;\n\n\tfor (cur = mapdata->layout & ~KB_HANDLEDBYWSKBD, stack_ptr = 0;\n\t     cur != 0; stack_ptr++) {\n\t\tmp = mapdata->keydesc;\n\t\twhile (mp->map_size > 0) {\n\t\t\tif (cur == 0 || mp->name == cur) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmp++;\n\t\t}\n\n\t\tif (stack_ptr == sizeof(stack)/sizeof(stack[0]))\n\t\t\tpanic(\"wskbd_load_keymap: %d: recursion too deep\",\n\t\t\t      mapdata->layout);\n\t\tif (mp->map_size <= 0)\n\t\t\treturn(EINVAL);\n\n\t\tstack[stack_ptr] = mp;\n\t\tcur = mp->base;\n\t}\n\n\tfor (i = 0, s = stack_ptr - 1; s >= 0; s--) {\n\t\tmp = stack[s];\n\t\tfor (kp = mp->map; kp < mp->map + mp->map_size; kp++)\n\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Keycode && KS_VALUE(*kp) > i)\n\t\t\t\ti = KS_VALUE(*kp);\n\t}\n\n\twskbd_init_keymap(i + 1, map, maplen);\n\n\tfor (s = stack_ptr - 1; s >= 0; s--) {\n\t\tmp = stack[s];\n\t\tfor (kp = mp->map; kp < mp->map + mp->map_size; ) {\n\t\t\tif (KS_GROUP(*kp) != KS_GROUP_Keycode)\n\t\t\t\tpanic(\"wskbd_load_keymap: %d(%d): bad entry\",\n\t\t\t\t      mp->name, *kp);\n\n\t\t\tkc = KS_VALUE(*kp);\n\t\t\tkp++;\n\n\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Command ||\n\t\t\t    *kp == KS_Cmd || *kp == KS_Cmd1 || *kp == KS_Cmd2) {\n\t\t\t\t(*map)[kc].command = *kp;\n\t\t\t\tkp++;\n\t\t\t}\n\n\t\t\tfor (i = 0; kp + i < mp->map + mp->map_size; i++)\n\t\t\t\tif (KS_GROUP(kp[i]) == KS_GROUP_Keycode)\n\t\t\t\t\tbreak;\n\n\t\t\tif (i > 4)\n\t\t\t\tpanic(\"wskbd_load_keymap: %d(%d): bad entry\",\n\t\t\t\t      mp->name, *kp);\n\n\t\t\tfillmapentry(kp, i, &(*map)[kc]);\n\t\t\tkp += i;\n\t\t}\n\t}\n\n\treturn(0);\n}",
    "includes": [
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <sys/malloc.h>",
      "#include <sys/systm.h>",
      "#include <sys/errno.h>",
      "#include <sys/cdefs.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void fillmapentry"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fillmapentry",
          "args": [
            "kp",
            "i",
            "&(*map)[kc]"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "fillmapentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
          "lines": "285-328",
          "snippet": "static void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}",
          "includes": [
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <sys/malloc.h>",
            "#include <sys/systm.h>",
            "#include <sys/errno.h>",
            "#include <sys/cdefs.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static keysym_t ksym_upcase",
            "static void fillmapentry"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic keysym_t ksym_upcase;\nstatic void fillmapentry;\n\nstatic void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"wskbd_load_keymap: %d(%d): bad entry\"",
            "mp->name",
            "*kp"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "kp[i]"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "*kp"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_VALUE",
          "args": [
            "*kp"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"wskbd_load_keymap: %d(%d): bad entry\"",
            "mp->name",
            "*kp"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "*kp"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wskbd_init_keymap",
          "args": [
            "i + 1",
            "map",
            "maplen"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "wskbd_init_keymap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
          "lines": "382-405",
          "snippet": "void\nwskbd_init_keymap(newlen, map, maplen)\n\tint newlen;\n\tstruct wscons_keymap **map;\n\tint *maplen;\n{\n\tint i;\n\n\tif (newlen != *maplen) {\n\t\tif (*maplen > 0)\n\t\t\tfree(*map, M_TEMP);\n\t\t*maplen = newlen;\n\t\t*map = malloc(newlen*sizeof(struct wscons_keymap),\n\t\t\t      M_TEMP, M_WAITOK);\n\t}\n\n\tfor (i = 0; i < *maplen; i++) {\n\t\t(*map)[i].command = KS_voidSymbol;\n\t\t(*map)[i].group1[0] = KS_voidSymbol;\n\t\t(*map)[i].group1[1] = KS_voidSymbol;\n\t\t(*map)[i].group2[0] = KS_voidSymbol;\n\t\t(*map)[i].group2[1] = KS_voidSymbol;\n\t}\n}",
          "includes": [
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <sys/malloc.h>",
            "#include <sys/systm.h>",
            "#include <sys/errno.h>",
            "#include <sys/cdefs.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nvoid\nwskbd_init_keymap(newlen, map, maplen)\n\tint newlen;\n\tstruct wscons_keymap **map;\n\tint *maplen;\n{\n\tint i;\n\n\tif (newlen != *maplen) {\n\t\tif (*maplen > 0)\n\t\t\tfree(*map, M_TEMP);\n\t\t*maplen = newlen;\n\t\t*map = malloc(newlen*sizeof(struct wscons_keymap),\n\t\t\t      M_TEMP, M_WAITOK);\n\t}\n\n\tfor (i = 0; i < *maplen; i++) {\n\t\t(*map)[i].command = KS_voidSymbol;\n\t\t(*map)[i].group1[0] = KS_voidSymbol;\n\t\t(*map)[i].group1[1] = KS_voidSymbol;\n\t\t(*map)[i].group2[0] = KS_voidSymbol;\n\t\t(*map)[i].group2[1] = KS_voidSymbol;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "KS_VALUE",
          "args": [
            "*kp"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_VALUE",
          "args": [
            "*kp"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "*kp"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"wskbd_load_keymap: %d: recursion too deep\"",
            "mapdata->layout"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic void fillmapentry;\n\nint\nwskbd_load_keymap(mapdata, map, maplen)\n\tconst struct wskbd_mapdata *mapdata;\n\tstruct wscons_keymap **map;\n\tint *maplen;\n{\n\tint i, s, kc, stack_ptr;\n\tconst keysym_t *kp;\n\tconst struct wscons_keydesc *mp, *stack[10];\n\tkbd_t cur;\n\n\tfor (cur = mapdata->layout & ~KB_HANDLEDBYWSKBD, stack_ptr = 0;\n\t     cur != 0; stack_ptr++) {\n\t\tmp = mapdata->keydesc;\n\t\twhile (mp->map_size > 0) {\n\t\t\tif (cur == 0 || mp->name == cur) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmp++;\n\t\t}\n\n\t\tif (stack_ptr == sizeof(stack)/sizeof(stack[0]))\n\t\t\tpanic(\"wskbd_load_keymap: %d: recursion too deep\",\n\t\t\t      mapdata->layout);\n\t\tif (mp->map_size <= 0)\n\t\t\treturn(EINVAL);\n\n\t\tstack[stack_ptr] = mp;\n\t\tcur = mp->base;\n\t}\n\n\tfor (i = 0, s = stack_ptr - 1; s >= 0; s--) {\n\t\tmp = stack[s];\n\t\tfor (kp = mp->map; kp < mp->map + mp->map_size; kp++)\n\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Keycode && KS_VALUE(*kp) > i)\n\t\t\t\ti = KS_VALUE(*kp);\n\t}\n\n\twskbd_init_keymap(i + 1, map, maplen);\n\n\tfor (s = stack_ptr - 1; s >= 0; s--) {\n\t\tmp = stack[s];\n\t\tfor (kp = mp->map; kp < mp->map + mp->map_size; ) {\n\t\t\tif (KS_GROUP(*kp) != KS_GROUP_Keycode)\n\t\t\t\tpanic(\"wskbd_load_keymap: %d(%d): bad entry\",\n\t\t\t\t      mp->name, *kp);\n\n\t\t\tkc = KS_VALUE(*kp);\n\t\t\tkp++;\n\n\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Command ||\n\t\t\t    *kp == KS_Cmd || *kp == KS_Cmd1 || *kp == KS_Cmd2) {\n\t\t\t\t(*map)[kc].command = *kp;\n\t\t\t\tkp++;\n\t\t\t}\n\n\t\t\tfor (i = 0; kp + i < mp->map + mp->map_size; i++)\n\t\t\t\tif (KS_GROUP(kp[i]) == KS_GROUP_Keycode)\n\t\t\t\t\tbreak;\n\n\t\t\tif (i > 4)\n\t\t\t\tpanic(\"wskbd_load_keymap: %d(%d): bad entry\",\n\t\t\t\t      mp->name, *kp);\n\n\t\t\tfillmapentry(kp, i, &(*map)[kc]);\n\t\t\tkp += i;\n\t\t}\n\t}\n\n\treturn(0);\n}"
  },
  {
    "function_name": "wskbd_init_keymap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
    "lines": "382-405",
    "snippet": "void\nwskbd_init_keymap(newlen, map, maplen)\n\tint newlen;\n\tstruct wscons_keymap **map;\n\tint *maplen;\n{\n\tint i;\n\n\tif (newlen != *maplen) {\n\t\tif (*maplen > 0)\n\t\t\tfree(*map, M_TEMP);\n\t\t*maplen = newlen;\n\t\t*map = malloc(newlen*sizeof(struct wscons_keymap),\n\t\t\t      M_TEMP, M_WAITOK);\n\t}\n\n\tfor (i = 0; i < *maplen; i++) {\n\t\t(*map)[i].command = KS_voidSymbol;\n\t\t(*map)[i].group1[0] = KS_voidSymbol;\n\t\t(*map)[i].group1[1] = KS_voidSymbol;\n\t\t(*map)[i].group2[0] = KS_voidSymbol;\n\t\t(*map)[i].group2[1] = KS_voidSymbol;\n\t}\n}",
    "includes": [
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <sys/malloc.h>",
      "#include <sys/systm.h>",
      "#include <sys/errno.h>",
      "#include <sys/cdefs.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "newlen*sizeof(struct wscons_keymap)",
            "M_TEMP",
            "M_WAITOK"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "*map",
            "M_TEMP"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "wskbd_pickfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbd.c",
          "lines": "1057-1070",
          "snippet": "int\nwskbd_pickfree()\n{\n\tint i;\n\tstruct wskbd_softc *sc;\n\n\tfor (i = 0; i < wskbd_cd.cd_ndevs; i++) {\n\t\tif ((sc = wskbd_cd.cd_devs[i]) == NULL)\n\t\t\tcontinue;\n\t\tif (sc->sc_displaydv == NULL)\n\t\t\treturn (i);\n\t}\n\treturn (-1);\n}",
          "includes": [
            "#include <dev/wscons/wsmuxvar.h>",
            "#include \"wsmux.h\"",
            "#include \"wsdisplay.h\"",
            "#include <dev/wscons/wscons_callbacks.h>",
            "#include <dev/wscons/wseventvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <dev/wscons/wskbdvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/errno.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/tty.h>",
            "#include <sys/malloc.h>",
            "#include <sys/timeout.h>",
            "#include <sys/systm.h>",
            "#include <sys/syslog.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>",
            "#include <sys/cdefs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cfdriver wskbd_cd = {\n\tNULL, \"wskbd\", DV_TTY\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsmuxvar.h>\n#include \"wsmux.h\"\n#include \"wsdisplay.h\"\n#include <dev/wscons/wscons_callbacks.h>\n#include <dev/wscons/wseventvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <dev/wscons/wskbdvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/errno.h>\n#include <sys/signalvar.h>\n#include <sys/tty.h>\n#include <sys/malloc.h>\n#include <sys/timeout.h>\n#include <sys/systm.h>\n#include <sys/syslog.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/ioctl.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\nstruct cfdriver wskbd_cd = {\n\tNULL, \"wskbd\", DV_TTY\n};\n\nint\nwskbd_pickfree()\n{\n\tint i;\n\tstruct wskbd_softc *sc;\n\n\tfor (i = 0; i < wskbd_cd.cd_ndevs; i++) {\n\t\tif ((sc = wskbd_cd.cd_devs[i]) == NULL)\n\t\t\tcontinue;\n\t\tif (sc->sc_displaydv == NULL)\n\t\t\treturn (i);\n\t}\n\treturn (-1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nvoid\nwskbd_init_keymap(newlen, map, maplen)\n\tint newlen;\n\tstruct wscons_keymap **map;\n\tint *maplen;\n{\n\tint i;\n\n\tif (newlen != *maplen) {\n\t\tif (*maplen > 0)\n\t\t\tfree(*map, M_TEMP);\n\t\t*maplen = newlen;\n\t\t*map = malloc(newlen*sizeof(struct wscons_keymap),\n\t\t\t      M_TEMP, M_WAITOK);\n\t}\n\n\tfor (i = 0; i < *maplen; i++) {\n\t\t(*map)[i].command = KS_voidSymbol;\n\t\t(*map)[i].group1[0] = KS_voidSymbol;\n\t\t(*map)[i].group1[1] = KS_voidSymbol;\n\t\t(*map)[i].group2[0] = KS_voidSymbol;\n\t\t(*map)[i].group2[1] = KS_voidSymbol;\n\t}\n}"
  },
  {
    "function_name": "wskbd_get_mapentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
    "lines": "330-380",
    "snippet": "void\nwskbd_get_mapentry(mapdata, kc, mapentry)\n\tconst struct wskbd_mapdata *mapdata;\n\tint kc;\n\tstruct wscons_keymap *mapentry;\n{\n\tkbd_t cur;\n\tconst keysym_t *kp;\n\tconst struct wscons_keydesc *mp;\n\tint l;\n\n\tmapentry->command = KS_voidSymbol;\n\tmapentry->group1[0] = KS_voidSymbol;\n\tmapentry->group1[1] = KS_voidSymbol;\n\tmapentry->group2[0] = KS_voidSymbol;\n\tmapentry->group2[1] = KS_voidSymbol;\n\n\tfor (cur = mapdata->layout & ~KB_HANDLEDBYWSKBD; cur != 0; ) {\n\t\tmp = mapdata->keydesc;\n\t\twhile (mp->map_size > 0) {\n\t\t\tif (mp->name == cur)\n\t\t\t\tbreak;\n\t\t\tmp++;\n\t\t}\n\n\t\t/* If map not found, return */\n\t\tif (mp->map_size <= 0)\n\t\t\treturn;\n\n\t\tfor (kp = mp->map; kp < mp->map + mp->map_size; kp++)\n\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Keycode &&\n\t\t\t    KS_VALUE(*kp) == kc) {\n\t\t\t\t/* First skip keycode and possible command */\n\t\t\t\tkp++;\n\t\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Command ||\n\t\t\t\t    *kp == KS_Cmd || *kp == KS_Cmd1 || *kp == KS_Cmd2)\n\t\t\t\t\tmapentry->command = *kp++;\n\n\t\t\t\tfor (l = 0; kp + l < mp->map + mp->map_size; l++)\n\t\t\t\t\tif (KS_GROUP(kp[l]) == KS_GROUP_Keycode)\n\t\t\t\t\t\tbreak;\n\t\t\t\tif (l > 4)\n\t\t\t\t\tpanic(\"wskbd_get_mapentry: %d(%d): bad entry\",\n\t\t\t\t\t      mp->name, *kp);\n\t\t\t\tfillmapentry(kp, l, mapentry);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\tcur = mp->base;\n\t}\n}",
    "includes": [
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <sys/malloc.h>",
      "#include <sys/systm.h>",
      "#include <sys/errno.h>",
      "#include <sys/cdefs.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void fillmapentry"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fillmapentry",
          "args": [
            "kp",
            "l",
            "mapentry"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "fillmapentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
          "lines": "285-328",
          "snippet": "static void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}",
          "includes": [
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <sys/malloc.h>",
            "#include <sys/systm.h>",
            "#include <sys/errno.h>",
            "#include <sys/cdefs.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static keysym_t ksym_upcase",
            "static void fillmapentry"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic keysym_t ksym_upcase;\nstatic void fillmapentry;\n\nstatic void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"wskbd_get_mapentry: %d(%d): bad entry\"",
            "mp->name",
            "*kp"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "kp[l]"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "*kp"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_VALUE",
          "args": [
            "*kp"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "*kp"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic void fillmapentry;\n\nvoid\nwskbd_get_mapentry(mapdata, kc, mapentry)\n\tconst struct wskbd_mapdata *mapdata;\n\tint kc;\n\tstruct wscons_keymap *mapentry;\n{\n\tkbd_t cur;\n\tconst keysym_t *kp;\n\tconst struct wscons_keydesc *mp;\n\tint l;\n\n\tmapentry->command = KS_voidSymbol;\n\tmapentry->group1[0] = KS_voidSymbol;\n\tmapentry->group1[1] = KS_voidSymbol;\n\tmapentry->group2[0] = KS_voidSymbol;\n\tmapentry->group2[1] = KS_voidSymbol;\n\n\tfor (cur = mapdata->layout & ~KB_HANDLEDBYWSKBD; cur != 0; ) {\n\t\tmp = mapdata->keydesc;\n\t\twhile (mp->map_size > 0) {\n\t\t\tif (mp->name == cur)\n\t\t\t\tbreak;\n\t\t\tmp++;\n\t\t}\n\n\t\t/* If map not found, return */\n\t\tif (mp->map_size <= 0)\n\t\t\treturn;\n\n\t\tfor (kp = mp->map; kp < mp->map + mp->map_size; kp++)\n\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Keycode &&\n\t\t\t    KS_VALUE(*kp) == kc) {\n\t\t\t\t/* First skip keycode and possible command */\n\t\t\t\tkp++;\n\t\t\t\tif (KS_GROUP(*kp) == KS_GROUP_Command ||\n\t\t\t\t    *kp == KS_Cmd || *kp == KS_Cmd1 || *kp == KS_Cmd2)\n\t\t\t\t\tmapentry->command = *kp++;\n\n\t\t\t\tfor (l = 0; kp + l < mp->map + mp->map_size; l++)\n\t\t\t\t\tif (KS_GROUP(kp[l]) == KS_GROUP_Keycode)\n\t\t\t\t\t\tbreak;\n\t\t\t\tif (l > 4)\n\t\t\t\t\tpanic(\"wskbd_get_mapentry: %d(%d): bad entry\",\n\t\t\t\t\t      mp->name, *kp);\n\t\t\t\tfillmapentry(kp, l, mapentry);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\tcur = mp->base;\n\t}\n}"
  },
  {
    "function_name": "fillmapentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
    "lines": "285-328",
    "snippet": "static void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}",
    "includes": [
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <sys/malloc.h>",
      "#include <sys/systm.h>",
      "#include <sys/errno.h>",
      "#include <sys/cdefs.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static keysym_t ksym_upcase",
      "static void fillmapentry"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ksym_upcase",
          "args": [
            "kp[2]"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "ksym_upcase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
          "lines": "271-283",
          "snippet": "static keysym_t\nksym_upcase(ksym)\n\tkeysym_t ksym;\n{\n\tif (ksym >= KS_f1 && ksym <= KS_f20)\n\t\treturn(KS_F1 - KS_f1 + ksym);\n\n\tif (KS_GROUP(ksym) == KS_GROUP_Ascii && ksym <= 0xff &&\n\t    latin1_to_upper[ksym] != 0x00)\n\t\treturn(latin1_to_upper[ksym]);\n\n\treturn(ksym);\n}",
          "includes": [
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <sys/malloc.h>",
            "#include <sys/systm.h>",
            "#include <sys/errno.h>",
            "#include <sys/cdefs.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static keysym_t ksym_upcase",
            "static const u_char latin1_to_upper[256] = {\n/*      0  8  1  9  2  a  3  b  4  c  5  d  6  e  7  f               */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00,  'A',  'B',  'C',  'D',  'E',  'F',  'G',\t\t/* 6 */\n\t 'H',  'I',  'J',  'K',  'L',  'M',  'N',  'O',\t\t/* 6 */\n\t 'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',\t\t/* 7 */\n\t 'X',  'Y',  'Z', 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 7 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0xc0, 0xc1, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7,\t\t/* e */\n\t0xc8, 0xc9, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xcf,\t\t/* e */\n\t0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0x00,\t\t/* f */\n\t0xd8, 0xd9, 0xda, 0xdb, 0xdc, 0xdd, 0xde, 0x00,\t\t/* f */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic keysym_t ksym_upcase;\nstatic const u_char latin1_to_upper[256] = {\n/*      0  8  1  9  2  a  3  b  4  c  5  d  6  e  7  f               */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00,  'A',  'B',  'C',  'D',  'E',  'F',  'G',\t\t/* 6 */\n\t 'H',  'I',  'J',  'K',  'L',  'M',  'N',  'O',\t\t/* 6 */\n\t 'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',\t\t/* 7 */\n\t 'X',  'Y',  'Z', 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 7 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0xc0, 0xc1, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7,\t\t/* e */\n\t0xc8, 0xc9, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xcf,\t\t/* e */\n\t0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0x00,\t\t/* f */\n\t0xd8, 0xd9, 0xda, 0xdb, 0xdc, 0xdd, 0xde, 0x00,\t\t/* f */\n};\n\nstatic keysym_t\nksym_upcase(ksym)\n\tkeysym_t ksym;\n{\n\tif (ksym >= KS_f1 && ksym <= KS_f20)\n\t\treturn(KS_F1 - KS_f1 + ksym);\n\n\tif (KS_GROUP(ksym) == KS_GROUP_Ascii && ksym <= 0xff &&\n\t    latin1_to_upper[ksym] != 0x00)\n\t\treturn(latin1_to_upper[ksym]);\n\n\treturn(ksym);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic keysym_t ksym_upcase;\nstatic void fillmapentry;\n\nstatic void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}"
  },
  {
    "function_name": "ksym_upcase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
    "lines": "271-283",
    "snippet": "static keysym_t\nksym_upcase(ksym)\n\tkeysym_t ksym;\n{\n\tif (ksym >= KS_f1 && ksym <= KS_f20)\n\t\treturn(KS_F1 - KS_f1 + ksym);\n\n\tif (KS_GROUP(ksym) == KS_GROUP_Ascii && ksym <= 0xff &&\n\t    latin1_to_upper[ksym] != 0x00)\n\t\treturn(latin1_to_upper[ksym]);\n\n\treturn(ksym);\n}",
    "includes": [
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <sys/malloc.h>",
      "#include <sys/systm.h>",
      "#include <sys/errno.h>",
      "#include <sys/cdefs.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static keysym_t ksym_upcase",
      "static const u_char latin1_to_upper[256] = {\n/*      0  8  1  9  2  a  3  b  4  c  5  d  6  e  7  f               */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00,  'A',  'B',  'C',  'D',  'E',  'F',  'G',\t\t/* 6 */\n\t 'H',  'I',  'J',  'K',  'L',  'M',  'N',  'O',\t\t/* 6 */\n\t 'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',\t\t/* 7 */\n\t 'X',  'Y',  'Z', 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 7 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0xc0, 0xc1, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7,\t\t/* e */\n\t0xc8, 0xc9, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xcf,\t\t/* e */\n\t0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0x00,\t\t/* f */\n\t0xd8, 0xd9, 0xda, 0xdb, 0xdc, 0xdd, 0xde, 0x00,\t\t/* f */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "KS_GROUP",
          "args": [
            "ksym"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic keysym_t ksym_upcase;\nstatic const u_char latin1_to_upper[256] = {\n/*      0  8  1  9  2  a  3  b  4  c  5  d  6  e  7  f               */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 0 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 1 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 2 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 3 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 4 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 5 */\n\t0x00,  'A',  'B',  'C',  'D',  'E',  'F',  'G',\t\t/* 6 */\n\t 'H',  'I',  'J',  'K',  'L',  'M',  'N',  'O',\t\t/* 6 */\n\t 'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',\t\t/* 7 */\n\t 'X',  'Y',  'Z', 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 7 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 8 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* 9 */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* a */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* b */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* c */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\t\t/* d */\n\t0xc0, 0xc1, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7,\t\t/* e */\n\t0xc8, 0xc9, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xcf,\t\t/* e */\n\t0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0x00,\t\t/* f */\n\t0xd8, 0xd9, 0xda, 0xdb, 0xdc, 0xdd, 0xde, 0x00,\t\t/* f */\n};\n\nstatic keysym_t\nksym_upcase(ksym)\n\tkeysym_t ksym;\n{\n\tif (ksym >= KS_f1 && ksym <= KS_f20)\n\t\treturn(KS_F1 - KS_f1 + ksym);\n\n\tif (KS_GROUP(ksym) == KS_GROUP_Ascii && ksym <= 0xff &&\n\t    latin1_to_upper[ksym] != 0x00)\n\t\treturn(latin1_to_upper[ksym]);\n\n\treturn(ksym);\n}"
  },
  {
    "function_name": "wskbd_compose_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
    "lines": "200-233",
    "snippet": "keysym_t\nwskbd_compose_value(compose_buf)\n\tkeysym_t *compose_buf;\n{\n\tint i, j, r;\n\tstruct compose_tab_s v;\n\n\tif (! compose_tab_inorder) {\n\t\t/* Insertion sort. */\n\t\tfor (i = 1; i < COMPOSE_SIZE; i++) {\n\t\t\tv = compose_tab[i];\n\t\t\t/* find correct slot, moving others up */\n\t\t\tfor (j = i; --j >= 0 && compose_tab_cmp(& v, & compose_tab[j]) < 0; )\n\t\t\t\tcompose_tab[j + 1] = compose_tab[j];\n\t\t\tcompose_tab[j + 1] = v;\n\t\t}\n\t\tcompose_tab_inorder = 1;\n\t}\n\n\tfor (j = 0, i = COMPOSE_SIZE; i != 0; i /= 2) {\n\t\tif (compose_tab[j + i/2].elem[0] == compose_buf[0]) {\n\t\t\tif (compose_tab[j + i/2].elem[1] == compose_buf[1])\n\t\t\t\treturn(compose_tab[j + i/2].result);\n\t\t\tr = compose_tab[j + i/2].elem[1] < compose_buf[1];\n\t\t} else\n\t\t\tr = compose_tab[j + i/2].elem[0] < compose_buf[0];\n\t\tif (r) {\n\t\t\tj += i/2 + 1;\n\t\t\ti--;\n\t\t}\n\t}\n\n\treturn(KS_voidSymbol);\n}",
    "includes": [
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <sys/malloc.h>",
      "#include <sys/systm.h>",
      "#include <sys/errno.h>",
      "#include <sys/cdefs.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define COMPOSE_SIZE\tsizeof(compose_tab)/sizeof(compose_tab[0])"
    ],
    "globals_used": [
      "static struct compose_tab_s {\n\tkeysym_t elem[2];\n\tkeysym_t result;\n} compose_tab[] = {\n\t{ { KS_plus,\t\t\tKS_plus },\t\tKS_numbersign },\n\t{ { KS_a,\t\t\tKS_a },\t\t\tKS_at },\n\t{ { KS_parenleft,\t\tKS_parenleft },\t\tKS_bracketleft },\n\t{ { KS_slash,\t\t\tKS_slash },\t\tKS_backslash },\n\t{ { KS_parenright,\t\tKS_parenright },\tKS_bracketright },\n\t{ { KS_parenleft,\t\tKS_minus },\t\tKS_braceleft },\n\t{ { KS_slash,\t\t\tKS_minus },\t\tKS_bar },\n\t{ { KS_parenright,\t\tKS_minus },\t\tKS_braceright },\n\t{ { KS_exclam,\t\t\tKS_exclam },\t\tKS_exclamdown },\n\t{ { KS_c,\t\t\tKS_slash },\t\tKS_cent },\n\t{ { KS_l,\t\t\tKS_minus },\t\tKS_sterling },\n\t{ { KS_y,\t\t\tKS_minus },\t\tKS_yen },\n\t{ { KS_s,\t\t\tKS_o },\t\t\tKS_section },\n\t{ { KS_x,\t\t\tKS_o },\t\t\tKS_currency },\n\t{ { KS_c,\t\t\tKS_o },\t\t\tKS_copyright },\n\t{ { KS_less,\t\t\tKS_less },\t\tKS_guillemotleft },\n\t{ { KS_greater,\t\t\tKS_greater },\t\tKS_guillemotright },\n\t{ { KS_question,\t\tKS_question },\t\tKS_questiondown },\n\t{ { KS_dead_acute,\t\tKS_space },\t\tKS_acute },\n\t{ { KS_dead_grave,\t\tKS_space },\t\tKS_grave },\n\t{ { KS_dead_tilde,\t\tKS_space },\t\tKS_asciitilde },\n\t{ { KS_dead_circumflex,\t\tKS_space },\t\tKS_asciicircum },\n\t{ { KS_dead_circumflex,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_dead_abovering,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_dead_tilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_dead_cedilla,\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_dead_acute,\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_dead_circumflex,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_dead_acute,\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_dead_circumflex,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_dead_tilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_dead_acute,\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_dead_circumflex,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_dead_tilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_dead_acute,\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_dead_circumflex,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_dead_acute,\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_dead_acute,\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_dead_circumflex,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_dead_abovering,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_dead_tilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_dead_cedilla,\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_dead_acute,\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_dead_circumflex,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_dead_acute,\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_dead_circumflex,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_dead_tilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_dead_acute,\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_dead_circumflex,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_dead_tilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_dead_acute,\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_dead_circumflex,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_dead_acute,\t\tKS_y },\t\t\tKS_yacute },\n\t{ { KS_dead_diaeresis,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_quotedbl,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_acute,\t\t\tKS_A },\t\t\tKS_Aacute },\n\t{ { KS_asciicircum,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_grave,\t\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_asterisk,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_asciitilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_cedilla,\t\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_acute,\t\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_asciicircum,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_grave,\t\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_acute,\t\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_asciicircum,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_grave,\t\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_asciitilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_acute,\t\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_asciicircum,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_grave,\t\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_asciitilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_acute,\t\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_asciicircum,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_grave,\t\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_acute,\t\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_acute,\t\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_asciicircum,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_grave,\t\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_asterisk,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_asciitilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_cedilla,\t\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_acute,\t\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_asciicircum,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_grave,\t\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_acute,\t\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_asciicircum,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_grave,\t\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_asciitilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_acute,\t\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_asciicircum,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_grave,\t\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_asciitilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_acute,\t\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_asciicircum,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_grave,\t\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_acute,\t\t\tKS_y },\t\t\tKS_yacute }\n};",
      "static int compose_tab_inorder = 0;",
      "static inline int compose_tab_cmp"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "compose_tab_cmp",
          "args": [
            "& v",
            "& compose_tab[j]"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "compose_tab_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
          "lines": "190-198",
          "snippet": "static inline int\ncompose_tab_cmp(i, j)\n\tstruct compose_tab_s *i, *j;\n{\n\tif (i->elem[0] == j->elem[0])\n\t\treturn(i->elem[1] - j->elem[1]);\n\telse\n\t\treturn(i->elem[0] - j->elem[0]);\n}",
          "includes": [
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <sys/malloc.h>",
            "#include <sys/systm.h>",
            "#include <sys/errno.h>",
            "#include <sys/cdefs.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct compose_tab_s {\n\tkeysym_t elem[2];\n\tkeysym_t result;\n} compose_tab[] = {\n\t{ { KS_plus,\t\t\tKS_plus },\t\tKS_numbersign },\n\t{ { KS_a,\t\t\tKS_a },\t\t\tKS_at },\n\t{ { KS_parenleft,\t\tKS_parenleft },\t\tKS_bracketleft },\n\t{ { KS_slash,\t\t\tKS_slash },\t\tKS_backslash },\n\t{ { KS_parenright,\t\tKS_parenright },\tKS_bracketright },\n\t{ { KS_parenleft,\t\tKS_minus },\t\tKS_braceleft },\n\t{ { KS_slash,\t\t\tKS_minus },\t\tKS_bar },\n\t{ { KS_parenright,\t\tKS_minus },\t\tKS_braceright },\n\t{ { KS_exclam,\t\t\tKS_exclam },\t\tKS_exclamdown },\n\t{ { KS_c,\t\t\tKS_slash },\t\tKS_cent },\n\t{ { KS_l,\t\t\tKS_minus },\t\tKS_sterling },\n\t{ { KS_y,\t\t\tKS_minus },\t\tKS_yen },\n\t{ { KS_s,\t\t\tKS_o },\t\t\tKS_section },\n\t{ { KS_x,\t\t\tKS_o },\t\t\tKS_currency },\n\t{ { KS_c,\t\t\tKS_o },\t\t\tKS_copyright },\n\t{ { KS_less,\t\t\tKS_less },\t\tKS_guillemotleft },\n\t{ { KS_greater,\t\t\tKS_greater },\t\tKS_guillemotright },\n\t{ { KS_question,\t\tKS_question },\t\tKS_questiondown },\n\t{ { KS_dead_acute,\t\tKS_space },\t\tKS_acute },\n\t{ { KS_dead_grave,\t\tKS_space },\t\tKS_grave },\n\t{ { KS_dead_tilde,\t\tKS_space },\t\tKS_asciitilde },\n\t{ { KS_dead_circumflex,\t\tKS_space },\t\tKS_asciicircum },\n\t{ { KS_dead_circumflex,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_dead_abovering,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_dead_tilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_dead_cedilla,\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_dead_acute,\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_dead_circumflex,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_dead_acute,\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_dead_circumflex,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_dead_tilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_dead_acute,\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_dead_circumflex,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_dead_tilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_dead_acute,\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_dead_circumflex,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_dead_acute,\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_dead_acute,\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_dead_circumflex,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_dead_abovering,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_dead_tilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_dead_cedilla,\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_dead_acute,\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_dead_circumflex,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_dead_acute,\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_dead_circumflex,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_dead_tilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_dead_acute,\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_dead_circumflex,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_dead_tilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_dead_acute,\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_dead_circumflex,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_dead_acute,\t\tKS_y },\t\t\tKS_yacute },\n\t{ { KS_dead_diaeresis,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_quotedbl,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_acute,\t\t\tKS_A },\t\t\tKS_Aacute },\n\t{ { KS_asciicircum,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_grave,\t\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_asterisk,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_asciitilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_cedilla,\t\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_acute,\t\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_asciicircum,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_grave,\t\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_acute,\t\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_asciicircum,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_grave,\t\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_asciitilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_acute,\t\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_asciicircum,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_grave,\t\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_asciitilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_acute,\t\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_asciicircum,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_grave,\t\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_acute,\t\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_acute,\t\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_asciicircum,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_grave,\t\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_asterisk,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_asciitilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_cedilla,\t\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_acute,\t\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_asciicircum,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_grave,\t\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_acute,\t\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_asciicircum,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_grave,\t\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_asciitilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_acute,\t\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_asciicircum,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_grave,\t\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_asciitilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_acute,\t\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_asciicircum,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_grave,\t\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_acute,\t\t\tKS_y },\t\t\tKS_yacute }\n};",
            "static inline int compose_tab_cmp"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic struct compose_tab_s {\n\tkeysym_t elem[2];\n\tkeysym_t result;\n} compose_tab[] = {\n\t{ { KS_plus,\t\t\tKS_plus },\t\tKS_numbersign },\n\t{ { KS_a,\t\t\tKS_a },\t\t\tKS_at },\n\t{ { KS_parenleft,\t\tKS_parenleft },\t\tKS_bracketleft },\n\t{ { KS_slash,\t\t\tKS_slash },\t\tKS_backslash },\n\t{ { KS_parenright,\t\tKS_parenright },\tKS_bracketright },\n\t{ { KS_parenleft,\t\tKS_minus },\t\tKS_braceleft },\n\t{ { KS_slash,\t\t\tKS_minus },\t\tKS_bar },\n\t{ { KS_parenright,\t\tKS_minus },\t\tKS_braceright },\n\t{ { KS_exclam,\t\t\tKS_exclam },\t\tKS_exclamdown },\n\t{ { KS_c,\t\t\tKS_slash },\t\tKS_cent },\n\t{ { KS_l,\t\t\tKS_minus },\t\tKS_sterling },\n\t{ { KS_y,\t\t\tKS_minus },\t\tKS_yen },\n\t{ { KS_s,\t\t\tKS_o },\t\t\tKS_section },\n\t{ { KS_x,\t\t\tKS_o },\t\t\tKS_currency },\n\t{ { KS_c,\t\t\tKS_o },\t\t\tKS_copyright },\n\t{ { KS_less,\t\t\tKS_less },\t\tKS_guillemotleft },\n\t{ { KS_greater,\t\t\tKS_greater },\t\tKS_guillemotright },\n\t{ { KS_question,\t\tKS_question },\t\tKS_questiondown },\n\t{ { KS_dead_acute,\t\tKS_space },\t\tKS_acute },\n\t{ { KS_dead_grave,\t\tKS_space },\t\tKS_grave },\n\t{ { KS_dead_tilde,\t\tKS_space },\t\tKS_asciitilde },\n\t{ { KS_dead_circumflex,\t\tKS_space },\t\tKS_asciicircum },\n\t{ { KS_dead_circumflex,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_dead_abovering,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_dead_tilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_dead_cedilla,\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_dead_acute,\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_dead_circumflex,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_dead_acute,\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_dead_circumflex,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_dead_tilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_dead_acute,\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_dead_circumflex,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_dead_tilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_dead_acute,\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_dead_circumflex,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_dead_acute,\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_dead_acute,\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_dead_circumflex,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_dead_abovering,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_dead_tilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_dead_cedilla,\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_dead_acute,\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_dead_circumflex,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_dead_acute,\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_dead_circumflex,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_dead_tilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_dead_acute,\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_dead_circumflex,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_dead_tilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_dead_acute,\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_dead_circumflex,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_dead_acute,\t\tKS_y },\t\t\tKS_yacute },\n\t{ { KS_dead_diaeresis,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_quotedbl,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_acute,\t\t\tKS_A },\t\t\tKS_Aacute },\n\t{ { KS_asciicircum,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_grave,\t\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_asterisk,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_asciitilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_cedilla,\t\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_acute,\t\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_asciicircum,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_grave,\t\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_acute,\t\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_asciicircum,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_grave,\t\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_asciitilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_acute,\t\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_asciicircum,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_grave,\t\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_asciitilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_acute,\t\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_asciicircum,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_grave,\t\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_acute,\t\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_acute,\t\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_asciicircum,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_grave,\t\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_asterisk,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_asciitilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_cedilla,\t\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_acute,\t\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_asciicircum,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_grave,\t\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_acute,\t\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_asciicircum,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_grave,\t\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_asciitilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_acute,\t\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_asciicircum,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_grave,\t\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_asciitilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_acute,\t\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_asciicircum,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_grave,\t\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_acute,\t\t\tKS_y },\t\t\tKS_yacute }\n};\nstatic inline int compose_tab_cmp;\n\nstatic inline int\ncompose_tab_cmp(i, j)\n\tstruct compose_tab_s *i, *j;\n{\n\tif (i->elem[0] == j->elem[0])\n\t\treturn(i->elem[1] - j->elem[1]);\n\telse\n\t\treturn(i->elem[0] - j->elem[0]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\n#define COMPOSE_SIZE\tsizeof(compose_tab)/sizeof(compose_tab[0])\n\nstatic struct compose_tab_s {\n\tkeysym_t elem[2];\n\tkeysym_t result;\n} compose_tab[] = {\n\t{ { KS_plus,\t\t\tKS_plus },\t\tKS_numbersign },\n\t{ { KS_a,\t\t\tKS_a },\t\t\tKS_at },\n\t{ { KS_parenleft,\t\tKS_parenleft },\t\tKS_bracketleft },\n\t{ { KS_slash,\t\t\tKS_slash },\t\tKS_backslash },\n\t{ { KS_parenright,\t\tKS_parenright },\tKS_bracketright },\n\t{ { KS_parenleft,\t\tKS_minus },\t\tKS_braceleft },\n\t{ { KS_slash,\t\t\tKS_minus },\t\tKS_bar },\n\t{ { KS_parenright,\t\tKS_minus },\t\tKS_braceright },\n\t{ { KS_exclam,\t\t\tKS_exclam },\t\tKS_exclamdown },\n\t{ { KS_c,\t\t\tKS_slash },\t\tKS_cent },\n\t{ { KS_l,\t\t\tKS_minus },\t\tKS_sterling },\n\t{ { KS_y,\t\t\tKS_minus },\t\tKS_yen },\n\t{ { KS_s,\t\t\tKS_o },\t\t\tKS_section },\n\t{ { KS_x,\t\t\tKS_o },\t\t\tKS_currency },\n\t{ { KS_c,\t\t\tKS_o },\t\t\tKS_copyright },\n\t{ { KS_less,\t\t\tKS_less },\t\tKS_guillemotleft },\n\t{ { KS_greater,\t\t\tKS_greater },\t\tKS_guillemotright },\n\t{ { KS_question,\t\tKS_question },\t\tKS_questiondown },\n\t{ { KS_dead_acute,\t\tKS_space },\t\tKS_acute },\n\t{ { KS_dead_grave,\t\tKS_space },\t\tKS_grave },\n\t{ { KS_dead_tilde,\t\tKS_space },\t\tKS_asciitilde },\n\t{ { KS_dead_circumflex,\t\tKS_space },\t\tKS_asciicircum },\n\t{ { KS_dead_circumflex,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_dead_abovering,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_dead_tilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_dead_cedilla,\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_dead_acute,\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_dead_circumflex,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_dead_acute,\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_dead_circumflex,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_dead_tilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_dead_acute,\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_dead_circumflex,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_dead_tilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_dead_acute,\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_dead_circumflex,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_dead_acute,\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_dead_acute,\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_dead_circumflex,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_dead_abovering,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_dead_tilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_dead_cedilla,\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_dead_acute,\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_dead_circumflex,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_dead_acute,\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_dead_circumflex,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_dead_tilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_dead_acute,\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_dead_circumflex,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_dead_tilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_dead_acute,\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_dead_circumflex,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_dead_acute,\t\tKS_y },\t\t\tKS_yacute },\n\t{ { KS_dead_diaeresis,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_quotedbl,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_acute,\t\t\tKS_A },\t\t\tKS_Aacute },\n\t{ { KS_asciicircum,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_grave,\t\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_asterisk,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_asciitilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_cedilla,\t\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_acute,\t\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_asciicircum,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_grave,\t\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_acute,\t\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_asciicircum,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_grave,\t\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_asciitilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_acute,\t\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_asciicircum,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_grave,\t\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_asciitilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_acute,\t\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_asciicircum,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_grave,\t\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_acute,\t\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_acute,\t\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_asciicircum,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_grave,\t\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_asterisk,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_asciitilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_cedilla,\t\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_acute,\t\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_asciicircum,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_grave,\t\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_acute,\t\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_asciicircum,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_grave,\t\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_asciitilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_acute,\t\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_asciicircum,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_grave,\t\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_asciitilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_acute,\t\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_asciicircum,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_grave,\t\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_acute,\t\t\tKS_y },\t\t\tKS_yacute }\n};\nstatic int compose_tab_inorder = 0;\nstatic inline int compose_tab_cmp;\n\nkeysym_t\nwskbd_compose_value(compose_buf)\n\tkeysym_t *compose_buf;\n{\n\tint i, j, r;\n\tstruct compose_tab_s v;\n\n\tif (! compose_tab_inorder) {\n\t\t/* Insertion sort. */\n\t\tfor (i = 1; i < COMPOSE_SIZE; i++) {\n\t\t\tv = compose_tab[i];\n\t\t\t/* find correct slot, moving others up */\n\t\t\tfor (j = i; --j >= 0 && compose_tab_cmp(& v, & compose_tab[j]) < 0; )\n\t\t\t\tcompose_tab[j + 1] = compose_tab[j];\n\t\t\tcompose_tab[j + 1] = v;\n\t\t}\n\t\tcompose_tab_inorder = 1;\n\t}\n\n\tfor (j = 0, i = COMPOSE_SIZE; i != 0; i /= 2) {\n\t\tif (compose_tab[j + i/2].elem[0] == compose_buf[0]) {\n\t\t\tif (compose_tab[j + i/2].elem[1] == compose_buf[1])\n\t\t\t\treturn(compose_tab[j + i/2].result);\n\t\t\tr = compose_tab[j + i/2].elem[1] < compose_buf[1];\n\t\t} else\n\t\t\tr = compose_tab[j + i/2].elem[0] < compose_buf[0];\n\t\tif (r) {\n\t\t\tj += i/2 + 1;\n\t\t\ti--;\n\t\t}\n\t}\n\n\treturn(KS_voidSymbol);\n}"
  },
  {
    "function_name": "compose_tab_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
    "lines": "190-198",
    "snippet": "static inline int\ncompose_tab_cmp(i, j)\n\tstruct compose_tab_s *i, *j;\n{\n\tif (i->elem[0] == j->elem[0])\n\t\treturn(i->elem[1] - j->elem[1]);\n\telse\n\t\treturn(i->elem[0] - j->elem[0]);\n}",
    "includes": [
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <sys/malloc.h>",
      "#include <sys/systm.h>",
      "#include <sys/errno.h>",
      "#include <sys/cdefs.h>",
      "#include <sys/types.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct compose_tab_s {\n\tkeysym_t elem[2];\n\tkeysym_t result;\n} compose_tab[] = {\n\t{ { KS_plus,\t\t\tKS_plus },\t\tKS_numbersign },\n\t{ { KS_a,\t\t\tKS_a },\t\t\tKS_at },\n\t{ { KS_parenleft,\t\tKS_parenleft },\t\tKS_bracketleft },\n\t{ { KS_slash,\t\t\tKS_slash },\t\tKS_backslash },\n\t{ { KS_parenright,\t\tKS_parenright },\tKS_bracketright },\n\t{ { KS_parenleft,\t\tKS_minus },\t\tKS_braceleft },\n\t{ { KS_slash,\t\t\tKS_minus },\t\tKS_bar },\n\t{ { KS_parenright,\t\tKS_minus },\t\tKS_braceright },\n\t{ { KS_exclam,\t\t\tKS_exclam },\t\tKS_exclamdown },\n\t{ { KS_c,\t\t\tKS_slash },\t\tKS_cent },\n\t{ { KS_l,\t\t\tKS_minus },\t\tKS_sterling },\n\t{ { KS_y,\t\t\tKS_minus },\t\tKS_yen },\n\t{ { KS_s,\t\t\tKS_o },\t\t\tKS_section },\n\t{ { KS_x,\t\t\tKS_o },\t\t\tKS_currency },\n\t{ { KS_c,\t\t\tKS_o },\t\t\tKS_copyright },\n\t{ { KS_less,\t\t\tKS_less },\t\tKS_guillemotleft },\n\t{ { KS_greater,\t\t\tKS_greater },\t\tKS_guillemotright },\n\t{ { KS_question,\t\tKS_question },\t\tKS_questiondown },\n\t{ { KS_dead_acute,\t\tKS_space },\t\tKS_acute },\n\t{ { KS_dead_grave,\t\tKS_space },\t\tKS_grave },\n\t{ { KS_dead_tilde,\t\tKS_space },\t\tKS_asciitilde },\n\t{ { KS_dead_circumflex,\t\tKS_space },\t\tKS_asciicircum },\n\t{ { KS_dead_circumflex,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_dead_abovering,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_dead_tilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_dead_cedilla,\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_dead_acute,\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_dead_circumflex,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_dead_acute,\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_dead_circumflex,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_dead_tilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_dead_acute,\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_dead_circumflex,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_dead_tilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_dead_acute,\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_dead_circumflex,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_dead_acute,\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_dead_acute,\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_dead_circumflex,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_dead_abovering,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_dead_tilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_dead_cedilla,\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_dead_acute,\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_dead_circumflex,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_dead_acute,\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_dead_circumflex,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_dead_tilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_dead_acute,\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_dead_circumflex,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_dead_tilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_dead_acute,\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_dead_circumflex,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_dead_acute,\t\tKS_y },\t\t\tKS_yacute },\n\t{ { KS_dead_diaeresis,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_quotedbl,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_acute,\t\t\tKS_A },\t\t\tKS_Aacute },\n\t{ { KS_asciicircum,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_grave,\t\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_asterisk,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_asciitilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_cedilla,\t\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_acute,\t\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_asciicircum,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_grave,\t\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_acute,\t\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_asciicircum,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_grave,\t\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_asciitilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_acute,\t\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_asciicircum,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_grave,\t\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_asciitilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_acute,\t\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_asciicircum,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_grave,\t\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_acute,\t\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_acute,\t\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_asciicircum,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_grave,\t\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_asterisk,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_asciitilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_cedilla,\t\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_acute,\t\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_asciicircum,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_grave,\t\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_acute,\t\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_asciicircum,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_grave,\t\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_asciitilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_acute,\t\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_asciicircum,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_grave,\t\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_asciitilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_acute,\t\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_asciicircum,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_grave,\t\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_acute,\t\t\tKS_y },\t\t\tKS_yacute }\n};",
      "static inline int compose_tab_cmp"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic struct compose_tab_s {\n\tkeysym_t elem[2];\n\tkeysym_t result;\n} compose_tab[] = {\n\t{ { KS_plus,\t\t\tKS_plus },\t\tKS_numbersign },\n\t{ { KS_a,\t\t\tKS_a },\t\t\tKS_at },\n\t{ { KS_parenleft,\t\tKS_parenleft },\t\tKS_bracketleft },\n\t{ { KS_slash,\t\t\tKS_slash },\t\tKS_backslash },\n\t{ { KS_parenright,\t\tKS_parenright },\tKS_bracketright },\n\t{ { KS_parenleft,\t\tKS_minus },\t\tKS_braceleft },\n\t{ { KS_slash,\t\t\tKS_minus },\t\tKS_bar },\n\t{ { KS_parenright,\t\tKS_minus },\t\tKS_braceright },\n\t{ { KS_exclam,\t\t\tKS_exclam },\t\tKS_exclamdown },\n\t{ { KS_c,\t\t\tKS_slash },\t\tKS_cent },\n\t{ { KS_l,\t\t\tKS_minus },\t\tKS_sterling },\n\t{ { KS_y,\t\t\tKS_minus },\t\tKS_yen },\n\t{ { KS_s,\t\t\tKS_o },\t\t\tKS_section },\n\t{ { KS_x,\t\t\tKS_o },\t\t\tKS_currency },\n\t{ { KS_c,\t\t\tKS_o },\t\t\tKS_copyright },\n\t{ { KS_less,\t\t\tKS_less },\t\tKS_guillemotleft },\n\t{ { KS_greater,\t\t\tKS_greater },\t\tKS_guillemotright },\n\t{ { KS_question,\t\tKS_question },\t\tKS_questiondown },\n\t{ { KS_dead_acute,\t\tKS_space },\t\tKS_acute },\n\t{ { KS_dead_grave,\t\tKS_space },\t\tKS_grave },\n\t{ { KS_dead_tilde,\t\tKS_space },\t\tKS_asciitilde },\n\t{ { KS_dead_circumflex,\t\tKS_space },\t\tKS_asciicircum },\n\t{ { KS_dead_circumflex,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_dead_abovering,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_dead_tilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_dead_cedilla,\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_dead_acute,\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_dead_circumflex,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_dead_acute,\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_dead_circumflex,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_dead_tilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_dead_acute,\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_dead_circumflex,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_dead_tilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_dead_acute,\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_dead_circumflex,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_dead_acute,\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_dead_acute,\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_dead_circumflex,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_dead_grave,\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_dead_abovering,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_dead_tilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_dead_cedilla,\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_dead_acute,\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_dead_circumflex,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_dead_grave,\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_dead_acute,\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_dead_circumflex,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_dead_grave,\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_dead_tilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_dead_acute,\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_dead_circumflex,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_dead_grave,\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_dead_tilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_dead_acute,\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_dead_circumflex,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_dead_diaeresis,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_dead_grave,\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_dead_acute,\t\tKS_y },\t\t\tKS_yacute },\n\t{ { KS_dead_diaeresis,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_quotedbl,\t\tKS_A },\t\t\tKS_Adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_E },\t\t\tKS_Ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_I },\t\t\tKS_Idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_O },\t\t\tKS_Odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_U },\t\t\tKS_Udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_a },\t\t\tKS_adiaeresis },\n\t{ { KS_quotedbl,\t\tKS_e },\t\t\tKS_ediaeresis },\n\t{ { KS_quotedbl,\t\tKS_i },\t\t\tKS_idiaeresis },\n\t{ { KS_quotedbl,\t\tKS_o },\t\t\tKS_odiaeresis },\n\t{ { KS_quotedbl,\t\tKS_u },\t\t\tKS_udiaeresis },\n\t{ { KS_quotedbl,\t\tKS_y },\t\t\tKS_ydiaeresis },\n\t{ { KS_acute,\t\t\tKS_A },\t\t\tKS_Aacute },\n\t{ { KS_asciicircum,\t\tKS_A },\t\t\tKS_Acircumflex },\n\t{ { KS_grave,\t\t\tKS_A },\t\t\tKS_Agrave },\n\t{ { KS_asterisk,\t\tKS_A },\t\t\tKS_Aring },\n\t{ { KS_asciitilde,\t\tKS_A },\t\t\tKS_Atilde },\n\t{ { KS_cedilla,\t\t\tKS_C },\t\t\tKS_Ccedilla },\n\t{ { KS_acute,\t\t\tKS_E },\t\t\tKS_Eacute },\n\t{ { KS_asciicircum,\t\tKS_E },\t\t\tKS_Ecircumflex },\n\t{ { KS_grave,\t\t\tKS_E },\t\t\tKS_Egrave },\n\t{ { KS_acute,\t\t\tKS_I },\t\t\tKS_Iacute },\n\t{ { KS_asciicircum,\t\tKS_I },\t\t\tKS_Icircumflex },\n\t{ { KS_grave,\t\t\tKS_I },\t\t\tKS_Igrave },\n\t{ { KS_asciitilde,\t\tKS_N },\t\t\tKS_Ntilde },\n\t{ { KS_acute,\t\t\tKS_O },\t\t\tKS_Oacute },\n\t{ { KS_asciicircum,\t\tKS_O },\t\t\tKS_Ocircumflex },\n\t{ { KS_grave,\t\t\tKS_O },\t\t\tKS_Ograve },\n\t{ { KS_asciitilde,\t\tKS_O },\t\t\tKS_Otilde },\n\t{ { KS_acute,\t\t\tKS_U },\t\t\tKS_Uacute },\n\t{ { KS_asciicircum,\t\tKS_U },\t\t\tKS_Ucircumflex },\n\t{ { KS_grave,\t\t\tKS_U },\t\t\tKS_Ugrave },\n\t{ { KS_acute,\t\t\tKS_Y },\t\t\tKS_Yacute },\n\t{ { KS_acute,\t\t\tKS_a },\t\t\tKS_aacute },\n\t{ { KS_asciicircum,\t\tKS_a },\t\t\tKS_acircumflex },\n\t{ { KS_grave,\t\t\tKS_a },\t\t\tKS_agrave },\n\t{ { KS_asterisk,\t\tKS_a },\t\t\tKS_aring },\n\t{ { KS_asciitilde,\t\tKS_a },\t\t\tKS_atilde },\n\t{ { KS_cedilla,\t\t\tKS_c },\t\t\tKS_ccedilla },\n\t{ { KS_acute,\t\t\tKS_e },\t\t\tKS_eacute },\n\t{ { KS_asciicircum,\t\tKS_e },\t\t\tKS_ecircumflex },\n\t{ { KS_grave,\t\t\tKS_e },\t\t\tKS_egrave },\n\t{ { KS_acute,\t\t\tKS_i },\t\t\tKS_iacute },\n\t{ { KS_asciicircum,\t\tKS_i },\t\t\tKS_icircumflex },\n\t{ { KS_grave,\t\t\tKS_i },\t\t\tKS_igrave },\n\t{ { KS_asciitilde,\t\tKS_n },\t\t\tKS_ntilde },\n\t{ { KS_acute,\t\t\tKS_o },\t\t\tKS_oacute },\n\t{ { KS_asciicircum,\t\tKS_o },\t\t\tKS_ocircumflex },\n\t{ { KS_grave,\t\t\tKS_o },\t\t\tKS_ograve },\n\t{ { KS_asciitilde,\t\tKS_o },\t\t\tKS_otilde },\n\t{ { KS_acute,\t\t\tKS_u },\t\t\tKS_uacute },\n\t{ { KS_asciicircum,\t\tKS_u },\t\t\tKS_ucircumflex },\n\t{ { KS_grave,\t\t\tKS_u },\t\t\tKS_ugrave },\n\t{ { KS_acute,\t\t\tKS_y },\t\t\tKS_yacute }\n};\nstatic inline int compose_tab_cmp;\n\nstatic inline int\ncompose_tab_cmp(i, j)\n\tstruct compose_tab_s *i, *j;\n{\n\tif (i->elem[0] == j->elem[0])\n\t\treturn(i->elem[1] - j->elem[1]);\n\telse\n\t\treturn(i->elem[0] - j->elem[0]);\n}"
  }
]