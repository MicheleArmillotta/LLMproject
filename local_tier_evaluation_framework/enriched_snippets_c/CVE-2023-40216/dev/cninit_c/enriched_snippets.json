[
  {
    "function_name": "cnset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/cninit.c",
    "lines": "89-114",
    "snippet": "int\ncnset(dev)\n\tdev_t dev;\n{\n\tstruct consdev *cp;\n\n\t/*\n\t * Look for the specified console device and use it.\n\t */\n\tfor (cp = constab; cp->cn_probe; cp++) {\n\t\tif (major(cp->cn_dev) == major(dev)) {\n\t\t\t/* short-circuit noop */\n\t\t\tif (cp == cn_tab && cp->cn_dev == dev)\n\t\t\t\treturn (0);\n\t\t\tif (cp->cn_pri > CN_DEAD) {\n\t\t\t\tcn_tab = cp;\n\t\t\t\tcp->cn_dev = dev;\n\t\t\t\t/* Turn it on.  */\n\t\t\t\t(cp->cn_init)(cp);\n\t\t\t\treturn (0);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (1);\n}",
    "includes": [
      "#include <dev/cons.h>",
      "#include <sys/vnode.h>",
      "#include <sys/conf.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/buf.h>",
      "#include <sys/user.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct consdev constab[];",
      "extern struct\tconsdev *cn_tab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "cp"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "dev"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "cp->cn_dev"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/cons.h>\n#include <sys/vnode.h>\n#include <sys/conf.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/ioctl.h>\n#include <sys/buf.h>\n#include <sys/user.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nextern struct consdev constab[];\nextern struct\tconsdev *cn_tab;\n\nint\ncnset(dev)\n\tdev_t dev;\n{\n\tstruct consdev *cp;\n\n\t/*\n\t * Look for the specified console device and use it.\n\t */\n\tfor (cp = constab; cp->cn_probe; cp++) {\n\t\tif (major(cp->cn_dev) == major(dev)) {\n\t\t\t/* short-circuit noop */\n\t\t\tif (cp == cn_tab && cp->cn_dev == dev)\n\t\t\t\treturn (0);\n\t\t\tif (cp->cn_pri > CN_DEAD) {\n\t\t\t\tcn_tab = cp;\n\t\t\t\tcp->cn_dev = dev;\n\t\t\t\t/* Turn it on.  */\n\t\t\t\t(cp->cn_init)(cp);\n\t\t\t\treturn (0);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn (1);\n}"
  },
  {
    "function_name": "cninit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/cninit.c",
    "lines": "63-87",
    "snippet": "void\ncninit()\n{\n\tregister struct consdev *cp;\n\n\t/*\n\t * Collect information about all possible consoles\n\t * and find the one with highest priority\n\t */\n\tfor (cp = constab; cp->cn_probe; cp++) {\n\t\t(*cp->cn_probe)(cp);\n\t\tif (cp->cn_pri > CN_DEAD &&\n\t\t    (cn_tab == NULL || cp->cn_pri > cn_tab->cn_pri))\n\t\t\tcn_tab = cp;\n\t}\n\t/*\n\t * No console, we can handle it\n\t */\n\tif ((cp = cn_tab) == NULL)\n\t\treturn;\n\t/*\n\t * Turn on console\n\t */\n\t(*cp->cn_init)(cp);\n}",
    "includes": [
      "#include <dev/cons.h>",
      "#include <sys/vnode.h>",
      "#include <sys/conf.h>",
      "#include <sys/file.h>",
      "#include <sys/tty.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/buf.h>",
      "#include <sys/user.h>",
      "#include <sys/proc.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct consdev constab[];",
      "extern struct\tconsdev *cn_tab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "cp"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "cp"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/cons.h>\n#include <sys/vnode.h>\n#include <sys/conf.h>\n#include <sys/file.h>\n#include <sys/tty.h>\n#include <sys/ioctl.h>\n#include <sys/buf.h>\n#include <sys/user.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nextern struct consdev constab[];\nextern struct\tconsdev *cn_tab;\n\nvoid\ncninit()\n{\n\tregister struct consdev *cp;\n\n\t/*\n\t * Collect information about all possible consoles\n\t * and find the one with highest priority\n\t */\n\tfor (cp = constab; cp->cn_probe; cp++) {\n\t\t(*cp->cn_probe)(cp);\n\t\tif (cp->cn_pri > CN_DEAD &&\n\t\t    (cn_tab == NULL || cp->cn_pri > cn_tab->cn_pri))\n\t\t\tcn_tab = cp;\n\t}\n\t/*\n\t * No console, we can handle it\n\t */\n\tif ((cp = cn_tab) == NULL)\n\t\treturn;\n\t/*\n\t * Turn on console\n\t */\n\t(*cp->cn_init)(cp);\n}"
  }
]