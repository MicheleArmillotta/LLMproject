[
  {
    "function_name": "rf_cond_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "188-201",
    "snippet": "int \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}"
  },
  {
    "function_name": "rf_mutex_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "173-186",
    "snippet": "int \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}"
  },
  {
    "function_name": "_rf_init_threadgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "149-167",
    "snippet": "int \n_rf_init_threadgroup(g, file, line)\n\tRF_ThreadGroup_t *g;\n\tchar   *file;\n\tint     line;\n{\n\tint     rc;\n\n\trc = rf_mutex_init(&g->mutex);\n\tif (rc)\n\t\treturn (rc);\n\trc = rf_cond_init(&g->cond);\n\tif (rc) {\n\t\trf_mutex_destroy(&g->mutex);\n\t\treturn (rc);\n\t}\n\tg->created = g->running = g->shutdown = 0;\n\treturn (0);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "&g->mutex"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_cond_init",
          "args": [
            "&g->cond"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "rf_cond_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "188-201",
          "snippet": "int \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rf_mutex_init",
          "args": [
            "&g->mutex"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "rf_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "173-186",
          "snippet": "int \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \n_rf_init_threadgroup(g, file, line)\n\tRF_ThreadGroup_t *g;\n\tchar   *file;\n\tint     line;\n{\n\tint     rc;\n\n\trc = rf_mutex_init(&g->mutex);\n\tif (rc)\n\t\treturn (rc);\n\trc = rf_cond_init(&g->cond);\n\tif (rc) {\n\t\trf_mutex_destroy(&g->mutex);\n\t\treturn (rc);\n\t}\n\tg->created = g->running = g->shutdown = 0;\n\treturn (0);\n}"
  },
  {
    "function_name": "_rf_destroy_threadgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "134-147",
    "snippet": "int \n_rf_destroy_threadgroup(g, file, line)\n\tRF_ThreadGroup_t *g;\n\tchar   *file;\n\tint     line;\n{\n\tint     rc1, rc2;\n\n\trc1 = rf_mutex_destroy(&g->mutex);\n\trc2 = rf_cond_destroy(&g->cond);\n\tif (rc1)\n\t\treturn (rc1);\n\treturn (rc2);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_cond_destroy",
          "args": [
            "&g->cond"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "&g->mutex"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \n_rf_destroy_threadgroup(g, file, line)\n\tRF_ThreadGroup_t *g;\n\tchar   *file;\n\tint     line;\n{\n\tint     rc1, rc2;\n\n\trc1 = rf_mutex_destroy(&g->mutex);\n\trc2 = rf_cond_destroy(&g->cond);\n\tif (rc1)\n\t\treturn (rc1);\n\treturn (rc2);\n}"
  },
  {
    "function_name": "_rf_init_managed_threadgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "115-132",
    "snippet": "int \n_rf_init_managed_threadgroup(listp, g, file, line)\n\tRF_ShutdownList_t **listp;\n\tRF_ThreadGroup_t *g;\n\tchar   *file;\n\tint     line;\n{\n\tint     rc;\n\n\trc = _rf_create_managed_mutex(listp, &g->mutex, file, line);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_create_managed_cond(listp, &g->cond, file, line);\n\tif (rc)\n\t\treturn (rc);\n\tg->created = g->running = g->shutdown = 0;\n\treturn (0);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_rf_create_managed_cond",
          "args": [
            "listp",
            "&g->cond",
            "file",
            "line"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "_rf_create_managed_cond",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "92-113",
          "snippet": "int \n_rf_create_managed_cond(listp, c, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_COND(*c)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_cond_init(c);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, cond_destroyer, (void *) c, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_cond_destroy(c);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying cond\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void cond_destroyer(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic void cond_destroyer(void *);\n\nint \n_rf_create_managed_cond(listp, c, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_COND(*c)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_cond_init(c);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, cond_destroyer, (void *) c, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_cond_destroy(c);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying cond\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_rf_create_managed_mutex",
          "args": [
            "listp",
            "&g->mutex",
            "file",
            "line"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "_rf_create_managed_mutex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "69-90",
          "snippet": "int \n_rf_create_managed_mutex(listp, m, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_MUTEX(*m)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_mutex_init(m);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, mutex_destroyer, (void *) m, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_mutex_destroy(m);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying mutex\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void mutex_destroyer(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic void mutex_destroyer(void *);\n\nint \n_rf_create_managed_mutex(listp, m, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_MUTEX(*m)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_mutex_init(m);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, mutex_destroyer, (void *) m, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_mutex_destroy(m);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying mutex\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \n_rf_init_managed_threadgroup(listp, g, file, line)\n\tRF_ShutdownList_t **listp;\n\tRF_ThreadGroup_t *g;\n\tchar   *file;\n\tint     line;\n{\n\tint     rc;\n\n\trc = _rf_create_managed_mutex(listp, &g->mutex, file, line);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_create_managed_cond(listp, &g->cond, file, line);\n\tif (rc)\n\t\treturn (rc);\n\tg->created = g->running = g->shutdown = 0;\n\treturn (0);\n}"
  },
  {
    "function_name": "_rf_create_managed_cond",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "92-113",
    "snippet": "int \n_rf_create_managed_cond(listp, c, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_COND(*c)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_cond_init(c);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, cond_destroyer, (void *) c, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_cond_destroy(c);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying cond\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cond_destroyer(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_ERRORMSG1",
          "args": [
            "\"RAIDFRAME: Error %d destroying cond\\n\"",
            "rc1"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_cond_destroy",
          "args": [
            "c"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG1",
          "args": [
            "\"RAIDFRAME: Error %d adding shutdown entry\\n\"",
            "rc"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_rf_ShutdownCreate",
          "args": [
            "listp",
            "cond_destroyer",
            "(void *) c",
            "file",
            "line"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "_rf_ShutdownCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_shutdown.c",
          "lines": "49-73",
          "snippet": "int \n_rf_ShutdownCreate(\n    RF_ShutdownList_t ** listp,\n    void (*cleanup) (void *arg),\n    void *arg,\n    char *file,\n    int line)\n{\n\tRF_ShutdownList_t *ent;\n\n\t/*\n         * Have to directly allocate memory here, since we start up before\n         * and shutdown after RAIDframe internal allocation system.\n         */\n\tent = (RF_ShutdownList_t *) malloc(sizeof(RF_ShutdownList_t), M_RAIDFRAME, M_WAITOK);\n\tif (ent == NULL)\n\t\treturn (ENOMEM);\n\tent->cleanup = cleanup;\n\tent->arg = arg;\n\tent->file = file;\n\tent->line = line;\n\tent->next = *listp;\n\t*listp = ent;\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_freelist.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_shutdown.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_shutdown.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \n_rf_ShutdownCreate(\n    RF_ShutdownList_t ** listp,\n    void (*cleanup) (void *arg),\n    void *arg,\n    char *file,\n    int line)\n{\n\tRF_ShutdownList_t *ent;\n\n\t/*\n         * Have to directly allocate memory here, since we start up before\n         * and shutdown after RAIDframe internal allocation system.\n         */\n\tent = (RF_ShutdownList_t *) malloc(sizeof(RF_ShutdownList_t), M_RAIDFRAME, M_WAITOK);\n\tif (ent == NULL)\n\t\treturn (ENOMEM);\n\tent->cleanup = cleanup;\n\tent->arg = arg;\n\tent->file = file;\n\tent->line = line;\n\tent->next = *listp;\n\t*listp = ent;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rf_cond_init",
          "args": [
            "c"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "rf_cond_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "188-201",
          "snippet": "int \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic void cond_destroyer(void *);\n\nint \n_rf_create_managed_cond(listp, c, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_COND(*c)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_cond_init(c);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, cond_destroyer, (void *) c, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_cond_destroy(c);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying cond\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}"
  },
  {
    "function_name": "_rf_create_managed_mutex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "69-90",
    "snippet": "int \n_rf_create_managed_mutex(listp, m, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_MUTEX(*m)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_mutex_init(m);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, mutex_destroyer, (void *) m, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_mutex_destroy(m);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying mutex\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void mutex_destroyer(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_ERRORMSG1",
          "args": [
            "\"RAIDFRAME: Error %d destroying mutex\\n\"",
            "rc1"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "m"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG1",
          "args": [
            "\"RAIDFRAME: Error %d adding shutdown entry\\n\"",
            "rc"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_rf_ShutdownCreate",
          "args": [
            "listp",
            "mutex_destroyer",
            "(void *) m",
            "file",
            "line"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "_rf_ShutdownCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_shutdown.c",
          "lines": "49-73",
          "snippet": "int \n_rf_ShutdownCreate(\n    RF_ShutdownList_t ** listp,\n    void (*cleanup) (void *arg),\n    void *arg,\n    char *file,\n    int line)\n{\n\tRF_ShutdownList_t *ent;\n\n\t/*\n         * Have to directly allocate memory here, since we start up before\n         * and shutdown after RAIDframe internal allocation system.\n         */\n\tent = (RF_ShutdownList_t *) malloc(sizeof(RF_ShutdownList_t), M_RAIDFRAME, M_WAITOK);\n\tif (ent == NULL)\n\t\treturn (ENOMEM);\n\tent->cleanup = cleanup;\n\tent->arg = arg;\n\tent->file = file;\n\tent->line = line;\n\tent->next = *listp;\n\t*listp = ent;\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_freelist.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_shutdown.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_shutdown.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \n_rf_ShutdownCreate(\n    RF_ShutdownList_t ** listp,\n    void (*cleanup) (void *arg),\n    void *arg,\n    char *file,\n    int line)\n{\n\tRF_ShutdownList_t *ent;\n\n\t/*\n         * Have to directly allocate memory here, since we start up before\n         * and shutdown after RAIDframe internal allocation system.\n         */\n\tent = (RF_ShutdownList_t *) malloc(sizeof(RF_ShutdownList_t), M_RAIDFRAME, M_WAITOK);\n\tif (ent == NULL)\n\t\treturn (ENOMEM);\n\tent->cleanup = cleanup;\n\tent->arg = arg;\n\tent->file = file;\n\tent->line = line;\n\tent->next = *listp;\n\t*listp = ent;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rf_mutex_init",
          "args": [
            "m"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "rf_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "173-186",
          "snippet": "int \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic void mutex_destroyer(void *);\n\nint \n_rf_create_managed_mutex(listp, m, file, line)\n\tRF_ShutdownList_t **listp;\nRF_DECLARE_MUTEX(*m)\n\tchar   *file;\n\tint     line;\n{\n\tint     rc, rc1;\n\n\trc = rf_mutex_init(m);\n\tif (rc)\n\t\treturn (rc);\n\trc = _rf_ShutdownCreate(listp, mutex_destroyer, (void *) m, file, line);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d adding shutdown entry\\n\", rc);\n\t\trc1 = rf_mutex_destroy(m);\n\t\tif (rc1) {\n\t\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d destroying mutex\\n\", rc1);\n\t\t}\n\t}\n\treturn (rc);\n}"
  },
  {
    "function_name": "cond_destroyer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "57-67",
    "snippet": "static void \ncond_destroyer(arg)\n\tvoid   *arg;\n{\n\tint     rc;\n\n\trc = rf_cond_destroy(arg);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d auto-destroying condition\\n\", rc);\n\t}\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cond_destroyer(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_ERRORMSG1",
          "args": [
            "\"RAIDFRAME: Error %d auto-destroying condition\\n\"",
            "rc"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_cond_destroy",
          "args": [
            "arg"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic void cond_destroyer(void *);\n\nstatic void \ncond_destroyer(arg)\n\tvoid   *arg;\n{\n\tint     rc;\n\n\trc = rf_cond_destroy(arg);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d auto-destroying condition\\n\", rc);\n\t}\n}"
  },
  {
    "function_name": "mutex_destroyer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
    "lines": "45-55",
    "snippet": "static void \nmutex_destroyer(arg)\n\tvoid   *arg;\n{\n\tint     rc;\n\n\trc = rf_mutex_destroy(arg);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d auto-destroying mutex\\n\", rc);\n\t}\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void mutex_destroyer(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_ERRORMSG1",
          "args": [
            "\"RAIDFRAME: Error %d auto-destroying mutex\\n\"",
            "rc"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "arg"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic void mutex_destroyer(void *);\n\nstatic void \nmutex_destroyer(arg)\n\tvoid   *arg;\n{\n\tint     rc;\n\n\trc = rf_mutex_destroy(arg);\n\tif (rc) {\n\t\tRF_ERRORMSG1(\"RAIDFRAME: Error %d auto-destroying mutex\\n\", rc);\n\t}\n}"
  }
]