[
  {
    "function_name": "midi_pcppi_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/midi_pcppi.c",
    "lines": "157-165",
    "snippet": "void\nmidi_pcppi_close(ms)\n\tmidisyn *ms;\n{\n\tpcppi_tag_t t = ms->data;\n\n\t/* Make sure we are quiet. */\n\tpcppi_bell(t, 0, 0, 0);\n}",
    "includes": [
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <dev/isa/pcppivar.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/select.h>",
      "#include <sys/conf.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/errno.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tmidi_pcppi_close"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pcppi_bell",
          "args": [
            "t",
            "0",
            "0",
            "0"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "pcppi_bell_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/pcppi.c",
          "lines": "219-235",
          "snippet": "static void\npcppi_bell_stop(arg)\n\tvoid *arg;\n{\n\tstruct pcppi_softc *sc = arg;\n\tint s;\n\n\ts = spltty(); /* ??? */\n\t/* disable bell */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ppi_ioh, 0,\n\t\t\t  bus_space_read_1(sc->sc_iot, sc->sc_ppi_ioh, 0)\n\t\t\t  & ~PIT_SPKR);\n\tsc->sc_bellactive = 0;\n\tif (sc->sc_slp)\n\t\twakeup(pcppi_bell_stop);\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/ic/i8253reg.h>",
            "#include <dev/isa/pcppivar.h>",
            "#include <dev/isa/pcppireg.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <sys/errno.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void pcppi_bell_stop"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/i8253reg.h>\n#include <dev/isa/pcppivar.h>\n#include <dev/isa/pcppireg.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <sys/errno.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void pcppi_bell_stop;\n\nstatic void\npcppi_bell_stop(arg)\n\tvoid *arg;\n{\n\tstruct pcppi_softc *sc = arg;\n\tint s;\n\n\ts = spltty(); /* ??? */\n\t/* disable bell */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ppi_ioh, 0,\n\t\t\t  bus_space_read_1(sc->sc_iot, sc->sc_ppi_ioh, 0)\n\t\t\t  & ~PIT_SPKR);\n\tsc->sc_bellactive = 0;\n\tif (sc->sc_slp)\n\t\twakeup(pcppi_bell_stop);\n\tsplx(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <dev/isa/pcppivar.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/select.h>\n#include <sys/conf.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tmidi_pcppi_close;\n\nvoid\nmidi_pcppi_close(ms)\n\tmidisyn *ms;\n{\n\tpcppi_tag_t t = ms->data;\n\n\t/* Make sure we are quiet. */\n\tpcppi_bell(t, 0, 0, 0);\n}"
  },
  {
    "function_name": "midi_pcppi_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/midi_pcppi.c",
    "lines": "146-155",
    "snippet": "void\nmidi_pcppi_off(ms, chan, note, vel)\n\tmidisyn *ms;\n\tu_int32_t chan, note, vel;\n{\n\tpcppi_tag_t t = ms->data;\n\n\t/*printf(\"OFF %p %d\\n\", t, note >> 16);*/\n\tpcppi_bell(t, 0, 0, 0);\n}",
    "includes": [
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <dev/isa/pcppivar.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/select.h>",
      "#include <sys/conf.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/errno.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tmidi_pcppi_off"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pcppi_bell",
          "args": [
            "t",
            "0",
            "0",
            "0"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "pcppi_bell_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/pcppi.c",
          "lines": "219-235",
          "snippet": "static void\npcppi_bell_stop(arg)\n\tvoid *arg;\n{\n\tstruct pcppi_softc *sc = arg;\n\tint s;\n\n\ts = spltty(); /* ??? */\n\t/* disable bell */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ppi_ioh, 0,\n\t\t\t  bus_space_read_1(sc->sc_iot, sc->sc_ppi_ioh, 0)\n\t\t\t  & ~PIT_SPKR);\n\tsc->sc_bellactive = 0;\n\tif (sc->sc_slp)\n\t\twakeup(pcppi_bell_stop);\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/ic/i8253reg.h>",
            "#include <dev/isa/pcppivar.h>",
            "#include <dev/isa/pcppireg.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <sys/errno.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void pcppi_bell_stop"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/i8253reg.h>\n#include <dev/isa/pcppivar.h>\n#include <dev/isa/pcppireg.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <sys/errno.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void pcppi_bell_stop;\n\nstatic void\npcppi_bell_stop(arg)\n\tvoid *arg;\n{\n\tstruct pcppi_softc *sc = arg;\n\tint s;\n\n\ts = spltty(); /* ??? */\n\t/* disable bell */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ppi_ioh, 0,\n\t\t\t  bus_space_read_1(sc->sc_iot, sc->sc_ppi_ioh, 0)\n\t\t\t  & ~PIT_SPKR);\n\tsc->sc_bellactive = 0;\n\tif (sc->sc_slp)\n\t\twakeup(pcppi_bell_stop);\n\tsplx(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <dev/isa/pcppivar.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/select.h>\n#include <sys/conf.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tmidi_pcppi_off;\n\nvoid\nmidi_pcppi_off(ms, chan, note, vel)\n\tmidisyn *ms;\n\tu_int32_t chan, note, vel;\n{\n\tpcppi_tag_t t = ms->data;\n\n\t/*printf(\"OFF %p %d\\n\", t, note >> 16);*/\n\tpcppi_bell(t, 0, 0, 0);\n}"
  },
  {
    "function_name": "midi_pcppi_on",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/midi_pcppi.c",
    "lines": "135-144",
    "snippet": "void\nmidi_pcppi_on(ms, chan, note, vel)\n\tmidisyn *ms;\n\tu_int32_t chan, note, vel;\n{\n\tpcppi_tag_t t = ms->data;\n\n\t/*printf(\"ON  %p %d\\n\", t, MIDISYN_FREQ_TO_HZ(note));*/\n\tpcppi_bell(t, MIDISYN_FREQ_TO_HZ(note), MAX_DURATION * hz, 0);\n}",
    "includes": [
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <dev/isa/pcppivar.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/select.h>",
      "#include <sys/conf.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/errno.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define MAX_DURATION 30\t\t/* turn off sound automagically after 30 s */"
    ],
    "globals_used": [
      "void\tmidi_pcppi_on"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pcppi_bell",
          "args": [
            "t",
            "MIDISYN_FREQ_TO_HZ(note)",
            "MAX_DURATION * hz",
            "0"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "pcppi_bell_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/pcppi.c",
          "lines": "219-235",
          "snippet": "static void\npcppi_bell_stop(arg)\n\tvoid *arg;\n{\n\tstruct pcppi_softc *sc = arg;\n\tint s;\n\n\ts = spltty(); /* ??? */\n\t/* disable bell */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ppi_ioh, 0,\n\t\t\t  bus_space_read_1(sc->sc_iot, sc->sc_ppi_ioh, 0)\n\t\t\t  & ~PIT_SPKR);\n\tsc->sc_bellactive = 0;\n\tif (sc->sc_slp)\n\t\twakeup(pcppi_bell_stop);\n\tsplx(s);\n}",
          "includes": [
            "#include <dev/ic/i8253reg.h>",
            "#include <dev/isa/pcppivar.h>",
            "#include <dev/isa/pcppireg.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <sys/errno.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void pcppi_bell_stop"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/i8253reg.h>\n#include <dev/isa/pcppivar.h>\n#include <dev/isa/pcppireg.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <sys/errno.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void pcppi_bell_stop;\n\nstatic void\npcppi_bell_stop(arg)\n\tvoid *arg;\n{\n\tstruct pcppi_softc *sc = arg;\n\tint s;\n\n\ts = spltty(); /* ??? */\n\t/* disable bell */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ppi_ioh, 0,\n\t\t\t  bus_space_read_1(sc->sc_iot, sc->sc_ppi_ioh, 0)\n\t\t\t  & ~PIT_SPKR);\n\tsc->sc_bellactive = 0;\n\tif (sc->sc_slp)\n\t\twakeup(pcppi_bell_stop);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIDISYN_FREQ_TO_HZ",
          "args": [
            "note"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <dev/isa/pcppivar.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/select.h>\n#include <sys/conf.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MAX_DURATION 30\t\t/* turn off sound automagically after 30 s */\n\nvoid\tmidi_pcppi_on;\n\nvoid\nmidi_pcppi_on(ms, chan, note, vel)\n\tmidisyn *ms;\n\tu_int32_t chan, note, vel;\n{\n\tpcppi_tag_t t = ms->data;\n\n\t/*printf(\"ON  %p %d\\n\", t, MIDISYN_FREQ_TO_HZ(note));*/\n\tpcppi_bell(t, MIDISYN_FREQ_TO_HZ(note), MAX_DURATION * hz, 0);\n}"
  },
  {
    "function_name": "midi_pcppi_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/midi_pcppi.c",
    "lines": "112-133",
    "snippet": "void\nmidi_pcppi_attach(parent, self, aux)\n\tstruct device *parent;\n\tstruct device *self;\n\tvoid *aux;\n{\n\tstruct midi_pcppi_softc *sc = (struct midi_pcppi_softc *)self;\n\tstruct pcppi_attach_args *pa = (struct pcppi_attach_args *)aux;\n\tmidisyn *ms;\n\n\tms = &sc->sc_midisyn;\n\tms->mets = &midi_pcppi_hw;\n\tstrcpy(ms->name, \"PC speaker\");\n\tms->nvoice = 1;\n\tms->flags = MS_DOALLOC | MS_FREQXLATE;\n\tms->data = pa->pa_cookie;\n\n\tmidi_pcppi_attached++;\n\n\tmidisyn_attach(&sc->sc_mididev, ms);\n\tmidi_attach(&sc->sc_mididev, parent);\n}",
    "includes": [
      "#include <dev/midisynvar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <dev/isa/pcppivar.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/select.h>",
      "#include <sys/conf.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/errno.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tmidi_pcppi_attach",
      "struct midisyn_methods midi_pcppi_hw = {\n\t0,\t\t\t/* open */\n\tmidi_pcppi_close,\n\t0,\t\t\t/* ioctl */\n\t0,\t\t\t/* allocv */\n\tmidi_pcppi_on,\n\tmidi_pcppi_off,\n\t0,\n\t0,\n\t0,\n\t0,\n\t0,\n\t0,\n};",
      "int midi_pcppi_attached = 0;",
      "void *aux;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "midi_attach",
          "args": [
            "&sc->sc_mididev",
            "parent"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "midi_attach_mi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "749-767",
          "snippet": "void\nmidi_attach_mi(mhwp, hdlp, dev)\n\tstruct midi_hw_if *mhwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n#ifdef DIAGNOSTIC\n\tif (mhwp == NULL) {\n\t\tprintf(\"midi_attach_mi: NULL\\n\");\n\t\treturn;\n\t}\n#endif\n\targ.type = AUDIODEV_TYPE_MIDI;\n\targ.hwif = mhwp;\n\targ.hdl = hdlp;\n\t(void)config_found(dev, &arg, midiprint);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_attach_mi(mhwp, hdlp, dev)\n\tstruct midi_hw_if *mhwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n#ifdef DIAGNOSTIC\n\tif (mhwp == NULL) {\n\t\tprintf(\"midi_attach_mi: NULL\\n\");\n\t\treturn;\n\t}\n#endif\n\targ.type = AUDIODEV_TYPE_MIDI;\n\targ.hwif = mhwp;\n\targ.hdl = hdlp;\n\t(void)config_found(dev, &arg, midiprint);\n}"
        }
      },
      {
        "call_info": {
          "callee": "midisyn_attach",
          "args": [
            "&sc->sc_mididev",
            "ms"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "midisyn_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midisyn.c",
          "lines": "175-191",
          "snippet": "void\nmidisyn_attach(sc, ms)\n\tstruct midi_softc *sc;\n\tmidisyn *ms;\n{\n\tif (ms->flags & MS_DOALLOC) {\n\t\tms->voices = malloc(ms->nvoice * sizeof (struct voice), \n\t\t\t\t    M_DEVBUF, M_WAITOK);\n\t\tmemset(ms->voices, 0, ms->nvoice * sizeof (struct voice));\n\t\tms->seqno = 1;\n\t\tif (ms->mets->allocv == 0)\n\t\t\tms->mets->allocv = &midisyn_allocvoice;\n\t}\n\tsc->hw_if = &midisyn_hw_if;\n\tsc->hw_hdl = ms;\n\tDPRINTF((\"midisyn_attach: ms=%p\\n\", sc->hw_hdl));\n}",
          "includes": [
            "#include <dev/midisynvar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/malloc.h>",
            "#include <sys/proc.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tmidisyn_allocvoice",
            "struct midi_hw_if midisyn_hw_if = {\n\tmidisyn_open,\n\tmidisyn_close,\n\tmidisyn_output,\n\tmidisyn_getinfo,\n\tmidisyn_ioctl,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/malloc.h>\n#include <sys/proc.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n\nint\tmidisyn_allocvoice;\nstruct midi_hw_if midisyn_hw_if = {\n\tmidisyn_open,\n\tmidisyn_close,\n\tmidisyn_output,\n\tmidisyn_getinfo,\n\tmidisyn_ioctl,\n};\n\nvoid\nmidisyn_attach(sc, ms)\n\tstruct midi_softc *sc;\n\tmidisyn *ms;\n{\n\tif (ms->flags & MS_DOALLOC) {\n\t\tms->voices = malloc(ms->nvoice * sizeof (struct voice), \n\t\t\t\t    M_DEVBUF, M_WAITOK);\n\t\tmemset(ms->voices, 0, ms->nvoice * sizeof (struct voice));\n\t\tms->seqno = 1;\n\t\tif (ms->mets->allocv == 0)\n\t\t\tms->mets->allocv = &midisyn_allocvoice;\n\t}\n\tsc->hw_if = &midisyn_hw_if;\n\tsc->hw_hdl = ms;\n\tDPRINTF((\"midisyn_attach: ms=%p\\n\", sc->hw_hdl));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "ms->name",
            "\"PC speaker\""
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/midisynvar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <dev/isa/pcppivar.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/select.h>\n#include <sys/conf.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/errno.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tmidi_pcppi_attach;\nstruct midisyn_methods midi_pcppi_hw = {\n\t0,\t\t\t/* open */\n\tmidi_pcppi_close,\n\t0,\t\t\t/* ioctl */\n\t0,\t\t\t/* allocv */\n\tmidi_pcppi_on,\n\tmidi_pcppi_off,\n\t0,\n\t0,\n\t0,\n\t0,\n\t0,\n\t0,\n};\nint midi_pcppi_attached = 0;\nvoid *aux;\n\nvoid\nmidi_pcppi_attach(parent, self, aux)\n\tstruct device *parent;\n\tstruct device *self;\n\tvoid *aux;\n{\n\tstruct midi_pcppi_softc *sc = (struct midi_pcppi_softc *)self;\n\tstruct pcppi_attach_args *pa = (struct pcppi_attach_args *)aux;\n\tmidisyn *ms;\n\n\tms = &sc->sc_midisyn;\n\tms->mets = &midi_pcppi_hw;\n\tstrcpy(ms->name, \"PC speaker\");\n\tms->nvoice = 1;\n\tms->flags = MS_DOALLOC | MS_FREQXLATE;\n\tms->data = pa->pa_cookie;\n\n\tmidi_pcppi_attached++;\n\n\tmidisyn_attach(&sc->sc_mididev, ms);\n\tmidi_attach(&sc->sc_mididev, parent);\n}"
  }
]