[
  {
    "function_name": "midi_writebytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1373-1380",
    "snippet": "int\nmidi_writebytes(unit, buf, cc)\n\tint unit;\n\tu_char *buf;\n\tint cc;\n{\n\treturn (ENXIO);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidi_writebytes(unit, buf, cc)\n\tint unit;\n\tu_char *buf;\n\tint cc;\n{\n\treturn (ENXIO);\n}"
  },
  {
    "function_name": "midiclose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1364-1371",
    "snippet": "int\nmidiclose(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\treturn (ENXIO);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiclose(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\treturn (ENXIO);\n}"
  },
  {
    "function_name": "midi_getinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1357-1362",
    "snippet": "void\nmidi_getinfo(dev, mi)\n\tdev_t dev;\n\tstruct midi_info *mi;\n{\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidi_getinfo(dev, mi)\n\tdev_t dev;\n\tstruct midi_info *mi;\n{\n}"
  },
  {
    "function_name": "midiopen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1346-1353",
    "snippet": "int\nmidiopen(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\treturn (ENXIO);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiopen(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\treturn (ENXIO);\n}"
  },
  {
    "function_name": "midi_unit_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1340-1344",
    "snippet": "int\nmidi_unit_count()\n{\n\treturn (0);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidi_unit_count()\n{\n\treturn (0);\n}"
  },
  {
    "function_name": "midiseq_putc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1323-1331",
    "snippet": "int\nmidiseq_putc(md, data)\n\tstruct midi_dev *md;\n\tint data;\n{\n\tu_char c = data;\n\tDPRINTFN(4,(\"midiseq_putc: 0x%02x\\n\", data));\n\treturn (midiseq_out(md, &c, 1, 0));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "&c",
            "1",
            "0"
          ],
          "line": 1330
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "4",
            "(\"midiseq_putc: 0x%02x\\n\", data)"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_putc(md, data)\n\tstruct midi_dev *md;\n\tint data;\n{\n\tu_char c = data;\n\tDPRINTFN(4,(\"midiseq_putc: 0x%02x\\n\", data));\n\treturn (midiseq_out(md, &c, 1, 0));\n}"
  },
  {
    "function_name": "midiseq_loadpatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1269-1321",
    "snippet": "int\nmidiseq_loadpatch(md, sysex, uio)\n\tstruct midi_dev *md;\n\tstruct sysex_info *sysex;\n\tstruct uio *uio;\n{\n\tu_char c, buf[128];\n\tint i, cc, error;\n\n\tif (sysex->key != SEQ_SYSEX_PATCH) {\n\t\tDPRINTFN(-1,(\"midiseq_loadpatch: bad patch key 0x%04x\\n\",\n\t\t\t     sysex->key));\n\t\treturn (EINVAL);\n\t}\n\tif (uio->uio_resid < sysex->len)\n\t\t/* adjust length, should be an error */\n\t\tsysex->len = uio->uio_resid;\n\n\tDPRINTFN(2, (\"midiseq_loadpatch: len=%d\\n\", sysex->len));\n\tif (sysex->len == 0)\n\t\treturn (EINVAL);\n\terror = uiomove(&c, 1, uio);\n\tif (error)\n\t\treturn error;\n\tif (c != MIDI_SYSEX_START)\t\t/* must start like this */\n\t\treturn (EINVAL);\n\terror = midiseq_out(md, &c, 1, 0);\n\tif (error)\n\t\treturn (error);\n\t--sysex->len;\n\twhile (sysex->len > 0) {\n\t\tcc = sysex->len;\n\t\tif (cc > sizeof buf)\n\t\t\tcc = sizeof buf;\n\t\terror = uiomove(buf, cc, uio);\n\t\tif (error)\n\t\t\tbreak;\n\t\tfor(i = 0; i < cc && !MIDI_IS_STATUS(buf[i]); i++)\n\t\t\t;\n\t\terror = midiseq_out(md, buf, i, 0);\n\t\tif (error)\n\t\t\tbreak;\n\t\tsysex->len -= i;\n\t\tif (i != cc)\n\t\t\tbreak;\n\t}\n\t/* Any leftover data in uio is rubbish; \n\t * the SYSEX should be one write ending in SYSEX_END. \n\t */\n\tuio->uio_resid = 0;\n\tc = MIDI_SYSEX_END;\n\treturn (midiseq_out(md, &c, 1, 0));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "&c",
            "1",
            "0"
          ],
          "line": 1320
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIDI_IS_STATUS",
          "args": [
            "buf[i]"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "buf",
            "cc",
            "uio"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "&c",
            "1",
            "uio"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"midiseq_loadpatch: len=%d\\n\", sysex->len)"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "-1",
            "(\"midiseq_loadpatch: bad patch key 0x%04x\\n\",\n\t\t\t     sysex->key)"
          ],
          "line": 1279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_loadpatch(md, sysex, uio)\n\tstruct midi_dev *md;\n\tstruct sysex_info *sysex;\n\tstruct uio *uio;\n{\n\tu_char c, buf[128];\n\tint i, cc, error;\n\n\tif (sysex->key != SEQ_SYSEX_PATCH) {\n\t\tDPRINTFN(-1,(\"midiseq_loadpatch: bad patch key 0x%04x\\n\",\n\t\t\t     sysex->key));\n\t\treturn (EINVAL);\n\t}\n\tif (uio->uio_resid < sysex->len)\n\t\t/* adjust length, should be an error */\n\t\tsysex->len = uio->uio_resid;\n\n\tDPRINTFN(2, (\"midiseq_loadpatch: len=%d\\n\", sysex->len));\n\tif (sysex->len == 0)\n\t\treturn (EINVAL);\n\terror = uiomove(&c, 1, uio);\n\tif (error)\n\t\treturn error;\n\tif (c != MIDI_SYSEX_START)\t\t/* must start like this */\n\t\treturn (EINVAL);\n\terror = midiseq_out(md, &c, 1, 0);\n\tif (error)\n\t\treturn (error);\n\t--sysex->len;\n\twhile (sysex->len > 0) {\n\t\tcc = sysex->len;\n\t\tif (cc > sizeof buf)\n\t\t\tcc = sizeof buf;\n\t\terror = uiomove(buf, cc, uio);\n\t\tif (error)\n\t\t\tbreak;\n\t\tfor(i = 0; i < cc && !MIDI_IS_STATUS(buf[i]); i++)\n\t\t\t;\n\t\terror = midiseq_out(md, buf, i, 0);\n\t\tif (error)\n\t\t\tbreak;\n\t\tsysex->len -= i;\n\t\tif (i != cc)\n\t\t\tbreak;\n\t}\n\t/* Any leftover data in uio is rubbish; \n\t * the SYSEX should be one write ending in SYSEX_END. \n\t */\n\tuio->uio_resid = 0;\n\tc = MIDI_SYSEX_END;\n\treturn (midiseq_out(md, &c, 1, 0));\n}"
  },
  {
    "function_name": "midiseq_pitchbend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1254-1267",
    "snippet": "int\nmidiseq_pitchbend(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PITCH_BEND | chan;\n\tbuf[1] = parm & 0x7f;\n\tbuf[2] = (parm >> 7) & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "3",
            "1"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_pitchbend(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PITCH_BEND | chan;\n\tbuf[1] = parm & 0x7f;\n\tbuf[2] = (parm >> 7) & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
  },
  {
    "function_name": "midiseq_ctlchange",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1238-1252",
    "snippet": "int\nmidiseq_ctlchange(md, chan, parm, w14)\n\tstruct midi_dev *md;\n\tint chan, parm, w14;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CTL_CHANGE | chan;\n\tbuf[1] = parm;\n\tbuf[2] = w14 & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "3",
            "1"
          ],
          "line": 1251
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_ctlchange(md, chan, parm, w14)\n\tstruct midi_dev *md;\n\tint chan, parm, w14;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CTL_CHANGE | chan;\n\tbuf[1] = parm;\n\tbuf[2] = w14 & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
  },
  {
    "function_name": "midiseq_chnpressure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1223-1236",
    "snippet": "int\nmidiseq_chnpressure(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CHN_PRESSURE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "2",
            "1"
          ],
          "line": 1235
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_chnpressure(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CHN_PRESSURE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}"
  },
  {
    "function_name": "midiseq_pgmchange",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1208-1221",
    "snippet": "int\nmidiseq_pgmchange(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PGM_CHANGE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "2",
            "1"
          ],
          "line": 1220
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_pgmchange(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PGM_CHANGE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}"
  },
  {
    "function_name": "midiseq_keypressure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1190-1206",
    "snippet": "int\nmidiseq_keypressure(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_KEY_PRESSURE | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "3",
            "1"
          ],
          "line": 1205
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_keypressure(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_KEY_PRESSURE | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
  },
  {
    "function_name": "midiseq_noteoff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1172-1188",
    "snippet": "int\nmidiseq_noteoff(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEOFF | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "3",
            "1"
          ],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_noteoff(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEOFF | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
  },
  {
    "function_name": "midiseq_noteon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1152-1170",
    "snippet": "int\nmidiseq_noteon(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tDPRINTFN(6, (\"midiseq_noteon 0x%02x %d %d\\n\", \n\t\t     MIDI_NOTEON | chan, note, vel));\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEON | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "3",
            "1"
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "6",
            "(\"midiseq_noteon 0x%02x %d %d\\n\", \n\t\t     MIDI_NOTEON | chan, note, vel)"
          ],
          "line": 1159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_noteon(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tDPRINTFN(6, (\"midiseq_noteon 0x%02x %d %d\\n\", \n\t\t     MIDI_NOTEON | chan, note, vel));\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEON | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
  },
  {
    "function_name": "midiseq_out",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1134-1150",
    "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midi_writebytes",
          "args": [
            "md->unit",
            "buf",
            "cc"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "midi_writebytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1373-1380",
          "snippet": "int\nmidi_writebytes(unit, buf, cc)\n\tint unit;\n\tu_char *buf;\n\tint cc;\n{\n\treturn (ENXIO);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidi_writebytes(unit, buf, cc)\n\tint unit;\n\tu_char *buf;\n\tint cc;\n{\n\treturn (ENXIO);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "5",
            "(\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc)"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
  },
  {
    "function_name": "midiseq_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1126-1132",
    "snippet": "void\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "3",
            "(\"midiseq_reset: %d\\n\", md->unit)"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}"
  },
  {
    "function_name": "midiseq_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1117-1124",
    "snippet": "void\nmidiseq_close(md)\n\tstruct midi_dev *md;\n{\n\tDPRINTFN(2, (\"midiseq_close: %d\\n\", md->unit));\n\tmidiclose(makedev(0, md->unit), 0, 0, 0);\n\tfree(md, M_DEVBUF);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "md",
            "M_DEVBUF"
          ],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "audio_free_ring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "493-503",
          "snippet": "void\naudio_free_ring(sc, r)\n\tstruct audio_softc *sc;\n\tstruct audio_ringbuffer *r;\n{\n\tif (sc->hw_if->freem) {\n\t    sc->hw_if->freem(sc->hw_hdl, r->start, M_DEVBUF);\n\t} else {\n\t    free(r->start, M_DEVBUF);\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nvoid\naudio_free_ring(sc, r)\n\tstruct audio_softc *sc;\n\tstruct audio_ringbuffer *r;\n{\n\tif (sc->hw_if->freem) {\n\t    sc->hw_if->freem(sc->hw_hdl, r->start, M_DEVBUF);\n\t} else {\n\t    free(r->start, M_DEVBUF);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiclose",
          "args": [
            "makedev(0, md->unit)",
            "0",
            "0",
            "0"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "midiclose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1364-1371",
          "snippet": "int\nmidiclose(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\treturn (ENXIO);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiclose(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\treturn (ENXIO);\n}"
        }
      },
      {
        "call_info": {
          "callee": "makedev",
          "args": [
            "0",
            "md->unit"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"midiseq_close: %d\\n\", md->unit)"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidiseq_close(md)\n\tstruct midi_dev *md;\n{\n\tDPRINTFN(2, (\"midiseq_close: %d\\n\", md->unit));\n\tmidiclose(makedev(0, md->unit), 0, 0, 0);\n\tfree(md, M_DEVBUF);\n}"
  },
  {
    "function_name": "midiseq_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "1042-1083",
    "snippet": "void\nmidiseq_in(md, msg, len)\n\tstruct midi_dev *md;\n\tu_char *msg;\n\tint len;\n{\n\tint unit = md->unit;\n\tseq_event_rec ev;\n\tint status, chan;\n\n\tDPRINTFN(2, (\"midiseq_in: %p %02x %02x %02x\\n\", \n\t\t     md, msg[0], msg[1], msg[2]));\n\n\tstatus = MIDI_GET_STATUS(msg[0]);\n\tchan = MIDI_GET_CHAN(msg[0]);\n\tswitch (status) {\n\tcase MIDI_NOTEON:\n\t\tif (msg[2] == 0) {\n\t\t\tstatus = MIDI_NOTEOFF;\n\t\t\tmsg[2] = MIDI_HALF_VEL;\n\t\t}\n\t\t/* fall into */\n\tcase MIDI_NOTEOFF:\n\tcase MIDI_KEY_PRESSURE:\n\t\tSEQ_MK_CHN_VOICE(&ev, unit, status, chan, msg[1], msg[2]);\n\t\tbreak;\n\tcase MIDI_CTL_CHANGE:\n\t\tSEQ_MK_CHN_COMMON(&ev, unit, status, chan, msg[1], 0, msg[2]);\n\t\tbreak;\n\tcase MIDI_PGM_CHANGE:\n\tcase MIDI_CHN_PRESSURE:\n\t\tSEQ_MK_CHN_COMMON(&ev, unit, status, chan, msg[1], 0, 0);\n\t\tbreak;\n\tcase MIDI_PITCH_BEND:\n\t\tSEQ_MK_CHN_COMMON(&ev, unit, status, chan, 0, 0, \n\t\t\t\t  (msg[1] & 0x7f) | ((msg[2] & 0x7f) << 7));\n\t\tbreak;\n\tdefault:\n\t\treturn;\n\t}\n\tseq_event_intr(md->seq, &ev);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_event_intr",
          "args": [
            "md->seq",
            "&ev"
          ],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "seq_event_intr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "355-387",
          "snippet": "void\nseq_event_intr(addr, iev)\n\tvoid *addr;\n\tseq_event_rec *iev;\n{\n\tstruct sequencer_softc *sc = addr;\n\tunion {\n\t\tu_int32_t l;\n\t\tu_int8_t b[4];\n\t} u;\n\tu_long t;\n\tstruct timeval now;\n\tseq_event_rec ev;\n\n\tmicrotime(&now);\n\tSUBTIMEVAL(&now, &sc->timer.start);\n\tt = now.tv_sec * 1000000 + now.tv_usec;\n\tt /= sc->timer.tick;\n\tif (t != sc->input_stamp) {\n\t\tev.arr[0] = SEQ_TIMING;\n\t\tev.arr[1] = TMR_WAIT_ABS;\n\t\tev.arr[2] = 0;\n\t\tev.arr[3] = 0;\n\t\tu.l = t;\n\t\tev.arr[4] = u.b[0];\n\t\tev.arr[5] = u.b[1];\n\t\tev.arr[6] = u.b[2];\n\t\tev.arr[7] = u.b[3];\n\t\tseq_input_event(sc, &ev);\n\t\tsc->input_stamp = t;\n\t}\n\tseq_input_event(sc, iev);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_event_intr(addr, iev)\n\tvoid *addr;\n\tseq_event_rec *iev;\n{\n\tstruct sequencer_softc *sc = addr;\n\tunion {\n\t\tu_int32_t l;\n\t\tu_int8_t b[4];\n\t} u;\n\tu_long t;\n\tstruct timeval now;\n\tseq_event_rec ev;\n\n\tmicrotime(&now);\n\tSUBTIMEVAL(&now, &sc->timer.start);\n\tt = now.tv_sec * 1000000 + now.tv_usec;\n\tt /= sc->timer.tick;\n\tif (t != sc->input_stamp) {\n\t\tev.arr[0] = SEQ_TIMING;\n\t\tev.arr[1] = TMR_WAIT_ABS;\n\t\tev.arr[2] = 0;\n\t\tev.arr[3] = 0;\n\t\tu.l = t;\n\t\tev.arr[4] = u.b[0];\n\t\tev.arr[5] = u.b[1];\n\t\tev.arr[6] = u.b[2];\n\t\tev.arr[7] = u.b[3];\n\t\tseq_input_event(sc, &ev);\n\t\tsc->input_stamp = t;\n\t}\n\tseq_input_event(sc, iev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_MK_CHN_COMMON",
          "args": [
            "&ev",
            "unit",
            "status",
            "chan",
            "0",
            "0",
            "(msg[1] & 0x7f) | ((msg[2] & 0x7f) << 7)"
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_MK_CHN_COMMON",
          "args": [
            "&ev",
            "unit",
            "status",
            "chan",
            "msg[1]",
            "0",
            "0"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_MK_CHN_COMMON",
          "args": [
            "&ev",
            "unit",
            "status",
            "chan",
            "msg[1]",
            "0",
            "msg[2]"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_MK_CHN_VOICE",
          "args": [
            "&ev",
            "unit",
            "status",
            "chan",
            "msg[1]",
            "msg[2]"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIDI_GET_CHAN",
          "args": [
            "msg[0]"
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIDI_GET_STATUS",
          "args": [
            "msg[0]"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"midiseq_in: %p %02x %02x %02x\\n\", \n\t\t     md, msg[0], msg[1], msg[2])"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidiseq_in(md, msg, len)\n\tstruct midi_dev *md;\n\tu_char *msg;\n\tint len;\n{\n\tint unit = md->unit;\n\tseq_event_rec ev;\n\tint status, chan;\n\n\tDPRINTFN(2, (\"midiseq_in: %p %02x %02x %02x\\n\", \n\t\t     md, msg[0], msg[1], msg[2]));\n\n\tstatus = MIDI_GET_STATUS(msg[0]);\n\tchan = MIDI_GET_CHAN(msg[0]);\n\tswitch (status) {\n\tcase MIDI_NOTEON:\n\t\tif (msg[2] == 0) {\n\t\t\tstatus = MIDI_NOTEOFF;\n\t\t\tmsg[2] = MIDI_HALF_VEL;\n\t\t}\n\t\t/* fall into */\n\tcase MIDI_NOTEOFF:\n\tcase MIDI_KEY_PRESSURE:\n\t\tSEQ_MK_CHN_VOICE(&ev, unit, status, chan, msg[1], msg[2]);\n\t\tbreak;\n\tcase MIDI_CTL_CHANGE:\n\t\tSEQ_MK_CHN_COMMON(&ev, unit, status, chan, msg[1], 0, msg[2]);\n\t\tbreak;\n\tcase MIDI_PGM_CHANGE:\n\tcase MIDI_CHN_PRESSURE:\n\t\tSEQ_MK_CHN_COMMON(&ev, unit, status, chan, msg[1], 0, 0);\n\t\tbreak;\n\tcase MIDI_PITCH_BEND:\n\t\tSEQ_MK_CHN_COMMON(&ev, unit, status, chan, 0, 0, \n\t\t\t\t  (msg[1] & 0x7f) | ((msg[2] & 0x7f) << 7));\n\t\tbreak;\n\tdefault:\n\t\treturn;\n\t}\n\tseq_event_intr(md->seq, &ev);\n}"
  },
  {
    "function_name": "seq_to_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "965-1038",
    "snippet": "int\nseq_to_new(ev, uio)\n\tseq_event_rec *ev;\n\tstruct uio *uio;\n{\n\tint cmd, chan, note, parm;\n\tu_int32_t delay;\n\tint error;\n\n\tcmd = SEQ_CMD(ev);\n\tchan = ev->arr[1];\n\tnote = ev->arr[2];\n\tparm = ev->arr[3];\n\tDPRINTFN(3, (\"seq_to_new: 0x%02x %d %d %d\\n\", cmd, chan, note, parm));\n\n\tif (cmd >= 0x80) {\n\t\t/* Fill the event record */\n\t\tif (uio->uio_resid >= sizeof *ev - SEQOLD_CMDSIZE) {\n\t\t\terror = uiomove(&ev->arr[SEQOLD_CMDSIZE], \n\t\t\t\t\tsizeof *ev - SEQOLD_CMDSIZE, uio);\n\t\t\tif (error)\n\t\t\t\treturn (error);\n\t\t} else\n\t\t\treturn (EINVAL);\n\t}\n\n\tswitch(cmd) {\n\tcase SEQOLD_NOTEOFF:\n\t\tnote = 255;\n\t\tSEQ_ECMD(ev) = MIDI_NOTEOFF;\n\t\tgoto onoff;\n\tcase SEQOLD_NOTEON:\n\t\tSEQ_ECMD(ev) = MIDI_NOTEON;\n\tonoff:\n\t\tSEQ_CMD(ev) = SEQ_CHN_VOICE;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_ENOTE(ev) = note;\n\t\tSEQ_EPARM(ev) = parm;\n\t\tbreak;\n\tcase SEQOLD_WAIT:\n\t\tdelay = *(u_int32_t *)ev->arr >> 8;\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_WAIT_REL;\n\t\t*(u_int32_t *)&ev->arr[4] = delay;\n\t\tbreak;\n\tcase SEQOLD_SYNCTIMER:\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_RESET;\n\t\tbreak;\n\tcase SEQOLD_PGMCHANGE:\n\t\tSEQ_ECMD(ev) = MIDI_PGM_CHANGE;\n\t\tSEQ_CMD(ev) = SEQ_CHN_COMMON;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_EP1(ev) = note;\n\t\tbreak;\n\tcase SEQOLD_MIDIPUTC:\n\t\tbreak;\t\t/* interpret in normal mode */\n\tcase SEQOLD_ECHO:\n\tcase SEQOLD_PRIVATE:\n\tcase SEQOLD_EXTENDED:\n\tdefault:\n\t\tDPRINTF((\"seq_to_new: not impl 0x%02x\\n\", cmd));\n\t\treturn (EINVAL);\n\t/* In case new events show up */\n\tcase SEQ_TIMING:\n\tcase SEQ_CHN_VOICE:\n\tcase SEQ_CHN_COMMON:\n\tcase SEQ_FULLSIZE:\n\t\tbreak;\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"seq_to_new: not impl 0x%02x\\n\", cmd)"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EP1",
          "args": [
            "ev"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECHAN",
          "args": [
            "ev"
          ],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EDEV",
          "args": [
            "ev"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "ev"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECMD",
          "args": [
            "ev"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_TCMD",
          "args": [
            "ev"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "ev"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_TCMD",
          "args": [
            "ev"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "ev"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EPARM",
          "args": [
            "ev"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ENOTE",
          "args": [
            "ev"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECHAN",
          "args": [
            "ev"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EDEV",
          "args": [
            "ev"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "ev"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECMD",
          "args": [
            "ev"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECMD",
          "args": [
            "ev"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "&ev->arr[SEQOLD_CMDSIZE]",
            "sizeof *ev - SEQOLD_CMDSIZE",
            "uio"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "3",
            "(\"seq_to_new: 0x%02x %d %d %d\\n\", cmd, chan, note, parm)"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "ev"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_to_new(ev, uio)\n\tseq_event_rec *ev;\n\tstruct uio *uio;\n{\n\tint cmd, chan, note, parm;\n\tu_int32_t delay;\n\tint error;\n\n\tcmd = SEQ_CMD(ev);\n\tchan = ev->arr[1];\n\tnote = ev->arr[2];\n\tparm = ev->arr[3];\n\tDPRINTFN(3, (\"seq_to_new: 0x%02x %d %d %d\\n\", cmd, chan, note, parm));\n\n\tif (cmd >= 0x80) {\n\t\t/* Fill the event record */\n\t\tif (uio->uio_resid >= sizeof *ev - SEQOLD_CMDSIZE) {\n\t\t\terror = uiomove(&ev->arr[SEQOLD_CMDSIZE], \n\t\t\t\t\tsizeof *ev - SEQOLD_CMDSIZE, uio);\n\t\t\tif (error)\n\t\t\t\treturn (error);\n\t\t} else\n\t\t\treturn (EINVAL);\n\t}\n\n\tswitch(cmd) {\n\tcase SEQOLD_NOTEOFF:\n\t\tnote = 255;\n\t\tSEQ_ECMD(ev) = MIDI_NOTEOFF;\n\t\tgoto onoff;\n\tcase SEQOLD_NOTEON:\n\t\tSEQ_ECMD(ev) = MIDI_NOTEON;\n\tonoff:\n\t\tSEQ_CMD(ev) = SEQ_CHN_VOICE;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_ENOTE(ev) = note;\n\t\tSEQ_EPARM(ev) = parm;\n\t\tbreak;\n\tcase SEQOLD_WAIT:\n\t\tdelay = *(u_int32_t *)ev->arr >> 8;\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_WAIT_REL;\n\t\t*(u_int32_t *)&ev->arr[4] = delay;\n\t\tbreak;\n\tcase SEQOLD_SYNCTIMER:\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_RESET;\n\t\tbreak;\n\tcase SEQOLD_PGMCHANGE:\n\t\tSEQ_ECMD(ev) = MIDI_PGM_CHANGE;\n\t\tSEQ_CMD(ev) = SEQ_CHN_COMMON;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_EP1(ev) = note;\n\t\tbreak;\n\tcase SEQOLD_MIDIPUTC:\n\t\tbreak;\t\t/* interpret in normal mode */\n\tcase SEQOLD_ECHO:\n\tcase SEQOLD_PRIVATE:\n\tcase SEQOLD_EXTENDED:\n\tdefault:\n\t\tDPRINTF((\"seq_to_new: not impl 0x%02x\\n\", cmd));\n\t\treturn (EINVAL);\n\t/* In case new events show up */\n\tcase SEQ_TIMING:\n\tcase SEQ_CHN_VOICE:\n\tcase SEQ_CHN_COMMON:\n\tcase SEQ_FULLSIZE:\n\t\tbreak;\n\t}\n\treturn (0);\n}"
  },
  {
    "function_name": "seq_do_fullsize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "942-962",
    "snippet": "int\nseq_do_fullsize(sc, b, uio)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n\tstruct uio *uio;\n{\n\tstruct sysex_info sysex;\n\tu_int dev;\n\n#ifdef DIAGNOSTIC\n\tif (sizeof(seq_event_rec) != SEQ_SYSEX_HDRSIZE) {\n\t\tprintf(\"seq_do_fullsize: sysex size ??\\n\");\n\t\treturn (EINVAL);\n\t}\n#endif\n\tmemcpy(&sysex, b, sizeof sysex);\n\tdev = sysex.device_no;\n\tDPRINTFN(2, (\"seq_do_fullsize: fmt=%04x, dev=%d, len=%d\\n\",\n\t\t     sysex.key, dev, sysex.len));\n\treturn (midiseq_loadpatch(sc->devs[dev], &sysex, uio));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_loadpatch",
          "args": [
            "sc->devs[dev]",
            "&sysex",
            "uio"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_loadpatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1269-1321",
          "snippet": "int\nmidiseq_loadpatch(md, sysex, uio)\n\tstruct midi_dev *md;\n\tstruct sysex_info *sysex;\n\tstruct uio *uio;\n{\n\tu_char c, buf[128];\n\tint i, cc, error;\n\n\tif (sysex->key != SEQ_SYSEX_PATCH) {\n\t\tDPRINTFN(-1,(\"midiseq_loadpatch: bad patch key 0x%04x\\n\",\n\t\t\t     sysex->key));\n\t\treturn (EINVAL);\n\t}\n\tif (uio->uio_resid < sysex->len)\n\t\t/* adjust length, should be an error */\n\t\tsysex->len = uio->uio_resid;\n\n\tDPRINTFN(2, (\"midiseq_loadpatch: len=%d\\n\", sysex->len));\n\tif (sysex->len == 0)\n\t\treturn (EINVAL);\n\terror = uiomove(&c, 1, uio);\n\tif (error)\n\t\treturn error;\n\tif (c != MIDI_SYSEX_START)\t\t/* must start like this */\n\t\treturn (EINVAL);\n\terror = midiseq_out(md, &c, 1, 0);\n\tif (error)\n\t\treturn (error);\n\t--sysex->len;\n\twhile (sysex->len > 0) {\n\t\tcc = sysex->len;\n\t\tif (cc > sizeof buf)\n\t\t\tcc = sizeof buf;\n\t\terror = uiomove(buf, cc, uio);\n\t\tif (error)\n\t\t\tbreak;\n\t\tfor(i = 0; i < cc && !MIDI_IS_STATUS(buf[i]); i++)\n\t\t\t;\n\t\terror = midiseq_out(md, buf, i, 0);\n\t\tif (error)\n\t\t\tbreak;\n\t\tsysex->len -= i;\n\t\tif (i != cc)\n\t\t\tbreak;\n\t}\n\t/* Any leftover data in uio is rubbish; \n\t * the SYSEX should be one write ending in SYSEX_END. \n\t */\n\tuio->uio_resid = 0;\n\tc = MIDI_SYSEX_END;\n\treturn (midiseq_out(md, &c, 1, 0));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_loadpatch(md, sysex, uio)\n\tstruct midi_dev *md;\n\tstruct sysex_info *sysex;\n\tstruct uio *uio;\n{\n\tu_char c, buf[128];\n\tint i, cc, error;\n\n\tif (sysex->key != SEQ_SYSEX_PATCH) {\n\t\tDPRINTFN(-1,(\"midiseq_loadpatch: bad patch key 0x%04x\\n\",\n\t\t\t     sysex->key));\n\t\treturn (EINVAL);\n\t}\n\tif (uio->uio_resid < sysex->len)\n\t\t/* adjust length, should be an error */\n\t\tsysex->len = uio->uio_resid;\n\n\tDPRINTFN(2, (\"midiseq_loadpatch: len=%d\\n\", sysex->len));\n\tif (sysex->len == 0)\n\t\treturn (EINVAL);\n\terror = uiomove(&c, 1, uio);\n\tif (error)\n\t\treturn error;\n\tif (c != MIDI_SYSEX_START)\t\t/* must start like this */\n\t\treturn (EINVAL);\n\terror = midiseq_out(md, &c, 1, 0);\n\tif (error)\n\t\treturn (error);\n\t--sysex->len;\n\twhile (sysex->len > 0) {\n\t\tcc = sysex->len;\n\t\tif (cc > sizeof buf)\n\t\t\tcc = sizeof buf;\n\t\terror = uiomove(buf, cc, uio);\n\t\tif (error)\n\t\t\tbreak;\n\t\tfor(i = 0; i < cc && !MIDI_IS_STATUS(buf[i]); i++)\n\t\t\t;\n\t\terror = midiseq_out(md, buf, i, 0);\n\t\tif (error)\n\t\t\tbreak;\n\t\tsysex->len -= i;\n\t\tif (i != cc)\n\t\t\tbreak;\n\t}\n\t/* Any leftover data in uio is rubbish; \n\t * the SYSEX should be one write ending in SYSEX_END. \n\t */\n\tuio->uio_resid = 0;\n\tc = MIDI_SYSEX_END;\n\treturn (midiseq_out(md, &c, 1, 0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"seq_do_fullsize: fmt=%04x, dev=%d, len=%d\\n\",\n\t\t     sysex.key, dev, sysex.len)"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&sysex",
            "b",
            "sizeof sysex"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"seq_do_fullsize: sysex size ??\\n\""
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_fullsize(sc, b, uio)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n\tstruct uio *uio;\n{\n\tstruct sysex_info sysex;\n\tu_int dev;\n\n#ifdef DIAGNOSTIC\n\tif (sizeof(seq_event_rec) != SEQ_SYSEX_HDRSIZE) {\n\t\tprintf(\"seq_do_fullsize: sysex size ??\\n\");\n\t\treturn (EINVAL);\n\t}\n#endif\n\tmemcpy(&sysex, b, sizeof sysex);\n\tdev = sysex.device_no;\n\tDPRINTFN(2, (\"seq_do_fullsize: fmt=%04x, dev=%d, len=%d\\n\",\n\t\t     sysex.key, dev, sysex.len));\n\treturn (midiseq_loadpatch(sc->devs[dev], &sysex, uio));\n}"
  },
  {
    "function_name": "seq_timer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "858-940",
    "snippet": "int\nseq_timer(sc, cmd, parm, b)\n\tstruct sequencer_softc *sc;\n\tint cmd, parm;\n\tseq_event_rec *b;\n{\n\tstruct syn_timer *t = &sc->timer;\n\tstruct timeval when;\n\tint ticks;\n\tint error;\n\tlong long usec;\n\n\tDPRINTFN(2,(\"seq_timer: %02x %d\\n\", cmd, parm));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase TMR_WAIT_REL:\n\t\tparm += t->last;\n\t\t/* fall into */\n\tcase TMR_WAIT_ABS:\n\t\tt->last = parm;\n\t\tusec = (long long)parm * (long long)t->tick; /* convert to usec */\n\t\twhen.tv_sec = usec / 1000000;\n\t\twhen.tv_usec = usec % 1000000;\n\t\tDPRINTFN(4, (\"seq_timer: parm=%d, sleep when=%ld.%06ld\", parm,\n\t\t\t     when.tv_sec, when.tv_usec));\n\t\tADDTIMEVAL(&when, &t->start); /* abstime for end */\n\t\tticks = hzto(&when);\n\t\tDPRINTFN(4, (\" when+start=%ld.%06ld, tick=%d\\n\",\n\t\t\t     when.tv_sec, when.tv_usec, ticks));\n\t\tif (ticks > 0) {\n#ifdef DIAGNOSTIC\n\t\t\tif (ticks > 20 * hz) {\n\t\t\t\t/* Waiting more than 20s */\n\t\t\t\tprintf(\"seq_timer: funny ticks=%d, usec=%lld, parm=%d, tick=%ld\\n\",\n\t\t\t\t       ticks, usec, parm, t->tick);\n\t\t\t}\n#endif\n\t\t\tsc->timeout = 1;\n\t\t\ttimeout(seq_timeout, sc, ticks);\n\t\t}\n#ifdef SEQUENCER_DEBUG\n\t\telse if (tick < 0)\n\t\t\tDPRINTF((\"seq_timer: ticks = %d\\n\", ticks));\n#endif\n\t\tbreak;\n\tcase TMR_START:\n\t\tmicrotime(&t->start);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_STOP:\n\t\tmicrotime(&t->stop);\n\t\tt->running = 0;\n\t\tbreak;\n\tcase TMR_CONTINUE:\n\t\tmicrotime(&when);\n\t\tSUBTIMEVAL(&when, &t->stop);\n\t\tADDTIMEVAL(&t->start, &when);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_TEMPO:\n\t\t/* parm is ticks per minute / timebase */\n\t\tif (parm < 8)\n\t\t\tparm = 8;\n\t\tif (parm > 360)\n\t\t\tparm = 360;\n\t\tt->tempo = parm;\n\t\tRECALC_TICK(t);\n\t\tbreak;\n\tcase TMR_ECHO:\n\t\terror = seq_input_event(sc, b);\n\t\tbreak;\n\tcase TMR_RESET:\n\t\tt->last = 0;\n\t\tmicrotime(&t->start);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTF((\"seq_timer: unknown %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"seq_timer: unknown %02x\\n\", cmd)"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "microtime",
          "args": [
            "&t->start"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_input_event",
          "args": [
            "sc",
            "b"
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "seq_input_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "335-353",
          "snippet": "static int\nseq_input_event(sc, cmd)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *cmd;\n{\n\tstruct sequencer_queue *q = &sc->inq;\n\n\tDPRINTFN(2, (\"seq_input_event: %02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t     cmd->arr[0], cmd->arr[1], cmd->arr[2], cmd->arr[3],\n\t\t     cmd->arr[4], cmd->arr[5], cmd->arr[6], cmd->arr[7]));\n\tif (SEQ_QFULL(q))\n\t\treturn (ENOMEM);\n\tSEQ_QPUT(q, *cmd);\n\tseq_wakeup(&sc->rchan);\n\tselwakeup(&sc->rsel);\n\tif (sc->async)\n\t\tpsignal(sc->async, SIGIO);\n\treturn (0);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_input_event(sc, cmd)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *cmd;\n{\n\tstruct sequencer_queue *q = &sc->inq;\n\n\tDPRINTFN(2, (\"seq_input_event: %02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t     cmd->arr[0], cmd->arr[1], cmd->arr[2], cmd->arr[3],\n\t\t     cmd->arr[4], cmd->arr[5], cmd->arr[6], cmd->arr[7]));\n\tif (SEQ_QFULL(q))\n\t\treturn (ENOMEM);\n\tSEQ_QPUT(q, *cmd);\n\tseq_wakeup(&sc->rchan);\n\tselwakeup(&sc->rsel);\n\tif (sc->async)\n\t\tpsignal(sc->async, SIGIO);\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RECALC_TICK",
          "args": [
            "t"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDTIMEVAL",
          "args": [
            "&t->start",
            "&when"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SUBTIMEVAL",
          "args": [
            "&when",
            "&t->stop"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "microtime",
          "args": [
            "&when"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "microtime",
          "args": [
            "&t->stop"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "microtime",
          "args": [
            "&t->start"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timeout",
          "args": [
            "seq_timeout",
            "sc",
            "ticks"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "seq_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "276-291",
          "snippet": "void\nseq_timeout(addr)\n\tvoid *addr;\n{\n\tstruct sequencer_softc *sc = addr;\n\tDPRINTFN(4, (\"seq_timeout: %p\\n\", sc));\n\tsc->timeout = 0;\n\tseq_startoutput(sc);\n\tif (SEQ_QLEN(&sc->outq) < sc->lowat) {\n\t\tseq_wakeup(&sc->wchan);\n\t\tselwakeup(&sc->wsel);\n\t\tif (sc->async)\n\t\t\tpsignal(sc->async, SIGIO);\n\t}\n\t\t\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_timeout(addr)\n\tvoid *addr;\n{\n\tstruct sequencer_softc *sc = addr;\n\tDPRINTFN(4, (\"seq_timeout: %p\\n\", sc));\n\tsc->timeout = 0;\n\tseq_startoutput(sc);\n\tif (SEQ_QLEN(&sc->outq) < sc->lowat) {\n\t\tseq_wakeup(&sc->wchan);\n\t\tselwakeup(&sc->wsel);\n\t\tif (sc->async)\n\t\t\tpsignal(sc->async, SIGIO);\n\t}\n\t\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"seq_timer: funny ticks=%d, usec=%lld, parm=%d, tick=%ld\\n\"",
            "ticks",
            "usec",
            "parm",
            "t->tick"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "4",
            "(\" when+start=%ld.%06ld, tick=%d\\n\",\n\t\t\t     when.tv_sec, when.tv_usec, ticks)"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hzto",
          "args": [
            "&when"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDTIMEVAL",
          "args": [
            "&when",
            "&t->start"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "4",
            "(\"seq_timer: parm=%d, sleep when=%ld.%06ld\", parm,\n\t\t\t     when.tv_sec, when.tv_usec)"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"seq_timer: %02x %d\\n\", cmd, parm)"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_timer(sc, cmd, parm, b)\n\tstruct sequencer_softc *sc;\n\tint cmd, parm;\n\tseq_event_rec *b;\n{\n\tstruct syn_timer *t = &sc->timer;\n\tstruct timeval when;\n\tint ticks;\n\tint error;\n\tlong long usec;\n\n\tDPRINTFN(2,(\"seq_timer: %02x %d\\n\", cmd, parm));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase TMR_WAIT_REL:\n\t\tparm += t->last;\n\t\t/* fall into */\n\tcase TMR_WAIT_ABS:\n\t\tt->last = parm;\n\t\tusec = (long long)parm * (long long)t->tick; /* convert to usec */\n\t\twhen.tv_sec = usec / 1000000;\n\t\twhen.tv_usec = usec % 1000000;\n\t\tDPRINTFN(4, (\"seq_timer: parm=%d, sleep when=%ld.%06ld\", parm,\n\t\t\t     when.tv_sec, when.tv_usec));\n\t\tADDTIMEVAL(&when, &t->start); /* abstime for end */\n\t\tticks = hzto(&when);\n\t\tDPRINTFN(4, (\" when+start=%ld.%06ld, tick=%d\\n\",\n\t\t\t     when.tv_sec, when.tv_usec, ticks));\n\t\tif (ticks > 0) {\n#ifdef DIAGNOSTIC\n\t\t\tif (ticks > 20 * hz) {\n\t\t\t\t/* Waiting more than 20s */\n\t\t\t\tprintf(\"seq_timer: funny ticks=%d, usec=%lld, parm=%d, tick=%ld\\n\",\n\t\t\t\t       ticks, usec, parm, t->tick);\n\t\t\t}\n#endif\n\t\t\tsc->timeout = 1;\n\t\t\ttimeout(seq_timeout, sc, ticks);\n\t\t}\n#ifdef SEQUENCER_DEBUG\n\t\telse if (tick < 0)\n\t\t\tDPRINTF((\"seq_timer: ticks = %d\\n\", ticks));\n#endif\n\t\tbreak;\n\tcase TMR_START:\n\t\tmicrotime(&t->start);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_STOP:\n\t\tmicrotime(&t->stop);\n\t\tt->running = 0;\n\t\tbreak;\n\tcase TMR_CONTINUE:\n\t\tmicrotime(&when);\n\t\tSUBTIMEVAL(&when, &t->stop);\n\t\tADDTIMEVAL(&t->start, &when);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_TEMPO:\n\t\t/* parm is ticks per minute / timebase */\n\t\tif (parm < 8)\n\t\t\tparm = 8;\n\t\tif (parm > 360)\n\t\t\tparm = 360;\n\t\tt->tempo = parm;\n\t\tRECALC_TICK(t);\n\t\tbreak;\n\tcase TMR_ECHO:\n\t\terror = seq_input_event(sc, b);\n\t\tbreak;\n\tcase TMR_RESET:\n\t\tt->last = 0;\n\t\tmicrotime(&t->start);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTF((\"seq_timer: unknown %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
  },
  {
    "function_name": "seq_do_sysex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "829-856",
    "snippet": "int\nseq_do_sysex(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev, i;\n\tstruct midi_dev *md;\n\tu_int8_t c, *buf = &b->arr[2];\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tDPRINTF((\"seq_do_sysex: dev=%d\\n\", dev));\n\tmd = sc->devs[dev];\n\n\tif (!sc->doingsysex) {\n\t\tc = MIDI_SYSEX_START;\n\t\tmidiseq_out(md, &c, 1, 0);\n\t\tsc->doingsysex = 1;\n\t}\n\n\tfor (i = 0; i < 6 && buf[i] != 0xff; i++)\n\t\t;\n\tmidiseq_out(md, buf, i, 0);\n\tif (i < 6 || (i > 0 && buf[i-1] == MIDI_SYSEX_END))\n\t\tsc->doingsysex = 0;\n\treturn (0);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_out",
          "args": [
            "md",
            "buf",
            "i",
            "0"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1134-1150",
          "snippet": "int\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_out(md, buf, cc, chk)\n\tstruct midi_dev *md;\n\tu_char *buf;\n\tu_int cc;\n\tint chk;\n{\n\tDPRINTFN(5, (\"midiseq_out: m=%p, unit=%d, buf[0]=0x%02x, cc=%d\\n\",\n\t\t     md->msc, md->unit, buf[0], cc));\n\n\t/* The MIDI \"status\" byte does not have to be repeated. */\n\tif (chk && md->last_cmd == buf[0])\n\t\tbuf++, cc--;\n\telse\n\t\tmd->last_cmd = buf[0];\n\treturn (midi_writebytes(md->unit, buf, cc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"seq_do_sysex: dev=%d\\n\", dev)"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EDEV",
          "args": [
            "b"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_sysex(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev, i;\n\tstruct midi_dev *md;\n\tu_int8_t c, *buf = &b->arr[2];\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tDPRINTF((\"seq_do_sysex: dev=%d\\n\", dev));\n\tmd = sc->devs[dev];\n\n\tif (!sc->doingsysex) {\n\t\tc = MIDI_SYSEX_START;\n\t\tmidiseq_out(md, &c, 1, 0);\n\t\tsc->doingsysex = 1;\n\t}\n\n\tfor (i = 0; i < 6 && buf[i] != 0xff; i++)\n\t\t;\n\tmidiseq_out(md, buf, i, 0);\n\tif (i < 6 || (i > 0 && buf[i-1] == MIDI_SYSEX_END))\n\t\tsc->doingsysex = 0;\n\treturn (0);\n}"
  },
  {
    "function_name": "seq_do_local",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "821-827",
    "snippet": "int\nseq_do_local(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\treturn (EINVAL);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_local(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\treturn (EINVAL);\n}"
  },
  {
    "function_name": "seq_do_timing",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "804-819",
    "snippet": "int\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_timer",
          "args": [
            "sc",
            "SEQ_TCMD(b)",
            "u.i",
            "b"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "seq_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "858-940",
          "snippet": "int\nseq_timer(sc, cmd, parm, b)\n\tstruct sequencer_softc *sc;\n\tint cmd, parm;\n\tseq_event_rec *b;\n{\n\tstruct syn_timer *t = &sc->timer;\n\tstruct timeval when;\n\tint ticks;\n\tint error;\n\tlong long usec;\n\n\tDPRINTFN(2,(\"seq_timer: %02x %d\\n\", cmd, parm));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase TMR_WAIT_REL:\n\t\tparm += t->last;\n\t\t/* fall into */\n\tcase TMR_WAIT_ABS:\n\t\tt->last = parm;\n\t\tusec = (long long)parm * (long long)t->tick; /* convert to usec */\n\t\twhen.tv_sec = usec / 1000000;\n\t\twhen.tv_usec = usec % 1000000;\n\t\tDPRINTFN(4, (\"seq_timer: parm=%d, sleep when=%ld.%06ld\", parm,\n\t\t\t     when.tv_sec, when.tv_usec));\n\t\tADDTIMEVAL(&when, &t->start); /* abstime for end */\n\t\tticks = hzto(&when);\n\t\tDPRINTFN(4, (\" when+start=%ld.%06ld, tick=%d\\n\",\n\t\t\t     when.tv_sec, when.tv_usec, ticks));\n\t\tif (ticks > 0) {\n#ifdef DIAGNOSTIC\n\t\t\tif (ticks > 20 * hz) {\n\t\t\t\t/* Waiting more than 20s */\n\t\t\t\tprintf(\"seq_timer: funny ticks=%d, usec=%lld, parm=%d, tick=%ld\\n\",\n\t\t\t\t       ticks, usec, parm, t->tick);\n\t\t\t}\n#endif\n\t\t\tsc->timeout = 1;\n\t\t\ttimeout(seq_timeout, sc, ticks);\n\t\t}\n#ifdef SEQUENCER_DEBUG\n\t\telse if (tick < 0)\n\t\t\tDPRINTF((\"seq_timer: ticks = %d\\n\", ticks));\n#endif\n\t\tbreak;\n\tcase TMR_START:\n\t\tmicrotime(&t->start);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_STOP:\n\t\tmicrotime(&t->stop);\n\t\tt->running = 0;\n\t\tbreak;\n\tcase TMR_CONTINUE:\n\t\tmicrotime(&when);\n\t\tSUBTIMEVAL(&when, &t->stop);\n\t\tADDTIMEVAL(&t->start, &when);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_TEMPO:\n\t\t/* parm is ticks per minute / timebase */\n\t\tif (parm < 8)\n\t\t\tparm = 8;\n\t\tif (parm > 360)\n\t\t\tparm = 360;\n\t\tt->tempo = parm;\n\t\tRECALC_TICK(t);\n\t\tbreak;\n\tcase TMR_ECHO:\n\t\terror = seq_input_event(sc, b);\n\t\tbreak;\n\tcase TMR_RESET:\n\t\tt->last = 0;\n\t\tmicrotime(&t->start);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTF((\"seq_timer: unknown %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_timer(sc, cmd, parm, b)\n\tstruct sequencer_softc *sc;\n\tint cmd, parm;\n\tseq_event_rec *b;\n{\n\tstruct syn_timer *t = &sc->timer;\n\tstruct timeval when;\n\tint ticks;\n\tint error;\n\tlong long usec;\n\n\tDPRINTFN(2,(\"seq_timer: %02x %d\\n\", cmd, parm));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase TMR_WAIT_REL:\n\t\tparm += t->last;\n\t\t/* fall into */\n\tcase TMR_WAIT_ABS:\n\t\tt->last = parm;\n\t\tusec = (long long)parm * (long long)t->tick; /* convert to usec */\n\t\twhen.tv_sec = usec / 1000000;\n\t\twhen.tv_usec = usec % 1000000;\n\t\tDPRINTFN(4, (\"seq_timer: parm=%d, sleep when=%ld.%06ld\", parm,\n\t\t\t     when.tv_sec, when.tv_usec));\n\t\tADDTIMEVAL(&when, &t->start); /* abstime for end */\n\t\tticks = hzto(&when);\n\t\tDPRINTFN(4, (\" when+start=%ld.%06ld, tick=%d\\n\",\n\t\t\t     when.tv_sec, when.tv_usec, ticks));\n\t\tif (ticks > 0) {\n#ifdef DIAGNOSTIC\n\t\t\tif (ticks > 20 * hz) {\n\t\t\t\t/* Waiting more than 20s */\n\t\t\t\tprintf(\"seq_timer: funny ticks=%d, usec=%lld, parm=%d, tick=%ld\\n\",\n\t\t\t\t       ticks, usec, parm, t->tick);\n\t\t\t}\n#endif\n\t\t\tsc->timeout = 1;\n\t\t\ttimeout(seq_timeout, sc, ticks);\n\t\t}\n#ifdef SEQUENCER_DEBUG\n\t\telse if (tick < 0)\n\t\t\tDPRINTF((\"seq_timer: ticks = %d\\n\", ticks));\n#endif\n\t\tbreak;\n\tcase TMR_START:\n\t\tmicrotime(&t->start);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_STOP:\n\t\tmicrotime(&t->stop);\n\t\tt->running = 0;\n\t\tbreak;\n\tcase TMR_CONTINUE:\n\t\tmicrotime(&when);\n\t\tSUBTIMEVAL(&when, &t->stop);\n\t\tADDTIMEVAL(&t->start, &when);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_TEMPO:\n\t\t/* parm is ticks per minute / timebase */\n\t\tif (parm < 8)\n\t\t\tparm = 8;\n\t\tif (parm > 360)\n\t\t\tparm = 360;\n\t\tt->tempo = parm;\n\t\tRECALC_TICK(t);\n\t\tbreak;\n\tcase TMR_ECHO:\n\t\terror = seq_input_event(sc, b);\n\t\tbreak;\n\tcase TMR_RESET:\n\t\tt->last = 0;\n\t\tmicrotime(&t->start);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTF((\"seq_timer: unknown %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_TCMD",
          "args": [
            "b"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}"
  },
  {
    "function_name": "seq_do_chncommon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "755-802",
    "snippet": "int\nseq_do_chncommon(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, p1, w14;\n\tint error;\n\tstruct midi_dev *md;\n\tunion {\n\t\tint16_t s;\n\t\tu_int8_t b[2];\n\t} u;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tp1 = SEQ_EP1(b);\n\tu.b[0] = b->arr[6];\n\tu.b[1] = b->arr[7];\n\tw14 = u.s;\n\tDPRINTFN(2,(\"seq_do_chncommon: %02x\\n\", cmd));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase MIDI_PGM_CHANGE:\n\t\terror = midiseq_pgmchange(md, chan, p1);\n\t\tbreak;\n\tcase MIDI_CTL_CHANGE:\n\t\tif (chan > 15 || p1 > 127)\n\t\t\treturn (0); /* EINVAL */\n\t\terror = midiseq_ctlchange(md, chan, p1, w14);\n\t\tbreak;\n\tcase MIDI_PITCH_BEND:\n\t\terror = midiseq_pitchbend(md, chan, w14);\n\t\tbreak;\n\tcase MIDI_CHN_PRESSURE:\n\t\terror = midiseq_chnpressure(md, chan, p1);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chncommon: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "-1",
            "(\"seq_do_chncommon: unimpl command %02x\\n\", cmd)"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "midiseq_chnpressure",
          "args": [
            "md",
            "chan",
            "p1"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_chnpressure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1223-1236",
          "snippet": "int\nmidiseq_chnpressure(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CHN_PRESSURE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_chnpressure(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CHN_PRESSURE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_pitchbend",
          "args": [
            "md",
            "chan",
            "w14"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_pitchbend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1254-1267",
          "snippet": "int\nmidiseq_pitchbend(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PITCH_BEND | chan;\n\tbuf[1] = parm & 0x7f;\n\tbuf[2] = (parm >> 7) & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_pitchbend(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PITCH_BEND | chan;\n\tbuf[1] = parm & 0x7f;\n\tbuf[2] = (parm >> 7) & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_ctlchange",
          "args": [
            "md",
            "chan",
            "p1",
            "w14"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_ctlchange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1238-1252",
          "snippet": "int\nmidiseq_ctlchange(md, chan, parm, w14)\n\tstruct midi_dev *md;\n\tint chan, parm, w14;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CTL_CHANGE | chan;\n\tbuf[1] = parm;\n\tbuf[2] = w14 & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_ctlchange(md, chan, parm, w14)\n\tstruct midi_dev *md;\n\tint chan, parm, w14;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CTL_CHANGE | chan;\n\tbuf[1] = parm;\n\tbuf[2] = w14 & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_pgmchange",
          "args": [
            "md",
            "chan",
            "p1"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_pgmchange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1208-1221",
          "snippet": "int\nmidiseq_pgmchange(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PGM_CHANGE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_pgmchange(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[2];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PGM_CHANGE | chan;\n\tbuf[1] = parm;\n\treturn (midiseq_out(md, buf, 2, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"seq_do_chncommon: %02x\\n\", cmd)"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EP1",
          "args": [
            "b"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECHAN",
          "args": [
            "b"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECMD",
          "args": [
            "b"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EDEV",
          "args": [
            "b"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_chncommon(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, p1, w14;\n\tint error;\n\tstruct midi_dev *md;\n\tunion {\n\t\tint16_t s;\n\t\tu_int8_t b[2];\n\t} u;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tp1 = SEQ_EP1(b);\n\tu.b[0] = b->arr[6];\n\tu.b[1] = b->arr[7];\n\tw14 = u.s;\n\tDPRINTFN(2,(\"seq_do_chncommon: %02x\\n\", cmd));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase MIDI_PGM_CHANGE:\n\t\terror = midiseq_pgmchange(md, chan, p1);\n\t\tbreak;\n\tcase MIDI_CTL_CHANGE:\n\t\tif (chan > 15 || p1 > 127)\n\t\t\treturn (0); /* EINVAL */\n\t\terror = midiseq_ctlchange(md, chan, p1, w14);\n\t\tbreak;\n\tcase MIDI_PITCH_BEND:\n\t\terror = midiseq_pitchbend(md, chan, w14);\n\t\tbreak;\n\tcase MIDI_CHN_PRESSURE:\n\t\terror = midiseq_chnpressure(md, chan, p1);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chncommon: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
  },
  {
    "function_name": "seq_do_chnvoice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "711-753",
    "snippet": "int\nseq_do_chnvoice(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, note, parm, voice;\n\tint error;\n\tstruct midi_dev *md;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tnote = SEQ_ENOTE(b);\n\tparm = SEQ_EPARM(b);\n\tDPRINTFN(2,(\"seq_do_chnvoice: cmd=%02x dev=%d chan=%d note=%d parm=%d\\n\", \n\t\t    cmd, dev, chan, note, parm));\n\tvoice = chan;\n\tif (cmd == MIDI_NOTEON && parm == 0) {\n\t\tcmd = MIDI_NOTEOFF;\n\t\tparm = MIDI_HALF_VEL;\n\t}\n\tswitch(cmd) {\n\tcase MIDI_NOTEON:\n\t\tDPRINTFN(5, (\"seq_do_chnvoice: noteon %p %d %d %d\\n\", \n\t\t\t     md, voice, note, parm));\n\t\terror = midiseq_noteon(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_NOTEOFF:\n\t\terror = midiseq_noteoff(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_KEY_PRESSURE:\n\t\terror = midiseq_keypressure(md, voice, note, parm);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chnvoice: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "-1",
            "(\"seq_do_chnvoice: unimpl command %02x\\n\", cmd)"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "midiseq_keypressure",
          "args": [
            "md",
            "voice",
            "note",
            "parm"
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_keypressure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1190-1206",
          "snippet": "int\nmidiseq_keypressure(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_KEY_PRESSURE | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_keypressure(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_KEY_PRESSURE | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_noteoff",
          "args": [
            "md",
            "voice",
            "note",
            "parm"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_noteoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1172-1188",
          "snippet": "int\nmidiseq_noteoff(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEOFF | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_noteoff(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEOFF | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_noteon",
          "args": [
            "md",
            "voice",
            "note",
            "parm"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_noteon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1152-1170",
          "snippet": "int\nmidiseq_noteon(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tDPRINTFN(6, (\"midiseq_noteon 0x%02x %d %d\\n\", \n\t\t     MIDI_NOTEON | chan, note, vel));\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEON | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_noteon(md, chan, note, vel)\n\tstruct midi_dev *md;\n\tint chan, note, vel;\n{\n\tu_char buf[3];\n\n\tDPRINTFN(6, (\"midiseq_noteon 0x%02x %d %d\\n\", \n\t\t     MIDI_NOTEON | chan, note, vel));\n\tif (chan < 0 || chan > 15 ||\n\t    note < 0 || note > 127)\n\t\treturn (EINVAL);\n\tif (vel < 0) vel = 0;\n\tif (vel > 127) vel = 127;\n\tbuf[0] = MIDI_NOTEON | chan;\n\tbuf[1] = note;\n\tbuf[2] = vel;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "5",
            "(\"seq_do_chnvoice: noteon %p %d %d %d\\n\", \n\t\t\t     md, voice, note, parm)"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"seq_do_chnvoice: cmd=%02x dev=%d chan=%d note=%d parm=%d\\n\", \n\t\t    cmd, dev, chan, note, parm)"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EPARM",
          "args": [
            "b"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ENOTE",
          "args": [
            "b"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECHAN",
          "args": [
            "b"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_ECMD",
          "args": [
            "b"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_EDEV",
          "args": [
            "b"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_chnvoice(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, note, parm, voice;\n\tint error;\n\tstruct midi_dev *md;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tnote = SEQ_ENOTE(b);\n\tparm = SEQ_EPARM(b);\n\tDPRINTFN(2,(\"seq_do_chnvoice: cmd=%02x dev=%d chan=%d note=%d parm=%d\\n\", \n\t\t    cmd, dev, chan, note, parm));\n\tvoice = chan;\n\tif (cmd == MIDI_NOTEON && parm == 0) {\n\t\tcmd = MIDI_NOTEOFF;\n\t\tparm = MIDI_HALF_VEL;\n\t}\n\tswitch(cmd) {\n\tcase MIDI_NOTEON:\n\t\tDPRINTFN(5, (\"seq_do_chnvoice: noteon %p %d %d %d\\n\", \n\t\t\t     md, voice, note, parm));\n\t\terror = midiseq_noteon(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_NOTEOFF:\n\t\terror = midiseq_noteoff(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_KEY_PRESSURE:\n\t\terror = midiseq_keypressure(md, voice, note, parm);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chnvoice: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
  },
  {
    "function_name": "seq_do_command",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "678-709",
    "snippet": "int\nseq_do_command(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev;\n\n\tDPRINTFN(4, (\"seq_do_command: %p cmd=0x%02x\\n\", sc, SEQ_CMD(b)));\n\n\tswitch(SEQ_CMD(b)) {\n\tcase SEQ_LOCAL:\n\t\treturn (seq_do_local(sc, b));\n\tcase SEQ_TIMING:\n\t\treturn (seq_do_timing(sc, b));\n\tcase SEQ_CHN_VOICE:\n\t\treturn (seq_do_chnvoice(sc, b));\n\tcase SEQ_CHN_COMMON:\n\t\treturn (seq_do_chncommon(sc, b));\n\tcase SEQ_SYSEX:\n\t\treturn (seq_do_sysex(sc, b));\n\t/* COMPAT */\n\tcase SEQOLD_MIDIPUTC:\n\t\tdev = b->arr[2];\n\t\tif (dev < 0 || dev >= sc->nmidi)\n\t\t\treturn (ENXIO);\n\t\treturn (midiseq_putc(sc->devs[dev], b->arr[1]));\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_command: unimpl command %02x\\n\", \n\t\t\t     SEQ_CMD(b)));\n\t\treturn (EINVAL);\n\t}\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "-1",
            "(\"seq_do_command: unimpl command %02x\\n\", \n\t\t\t     SEQ_CMD(b))"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "b"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "midiseq_putc",
          "args": [
            "sc->devs[dev]",
            "b->arr[1]"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1323-1331",
          "snippet": "int\nmidiseq_putc(md, data)\n\tstruct midi_dev *md;\n\tint data;\n{\n\tu_char c = data;\n\tDPRINTFN(4,(\"midiseq_putc: 0x%02x\\n\", data));\n\treturn (midiseq_out(md, &c, 1, 0));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_putc(md, data)\n\tstruct midi_dev *md;\n\tint data;\n{\n\tu_char c = data;\n\tDPRINTFN(4,(\"midiseq_putc: 0x%02x\\n\", data));\n\treturn (midiseq_out(md, &c, 1, 0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_do_sysex",
          "args": [
            "sc",
            "b"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_sysex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "829-856",
          "snippet": "int\nseq_do_sysex(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev, i;\n\tstruct midi_dev *md;\n\tu_int8_t c, *buf = &b->arr[2];\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tDPRINTF((\"seq_do_sysex: dev=%d\\n\", dev));\n\tmd = sc->devs[dev];\n\n\tif (!sc->doingsysex) {\n\t\tc = MIDI_SYSEX_START;\n\t\tmidiseq_out(md, &c, 1, 0);\n\t\tsc->doingsysex = 1;\n\t}\n\n\tfor (i = 0; i < 6 && buf[i] != 0xff; i++)\n\t\t;\n\tmidiseq_out(md, buf, i, 0);\n\tif (i < 6 || (i > 0 && buf[i-1] == MIDI_SYSEX_END))\n\t\tsc->doingsysex = 0;\n\treturn (0);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_sysex(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev, i;\n\tstruct midi_dev *md;\n\tu_int8_t c, *buf = &b->arr[2];\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tDPRINTF((\"seq_do_sysex: dev=%d\\n\", dev));\n\tmd = sc->devs[dev];\n\n\tif (!sc->doingsysex) {\n\t\tc = MIDI_SYSEX_START;\n\t\tmidiseq_out(md, &c, 1, 0);\n\t\tsc->doingsysex = 1;\n\t}\n\n\tfor (i = 0; i < 6 && buf[i] != 0xff; i++)\n\t\t;\n\tmidiseq_out(md, buf, i, 0);\n\tif (i < 6 || (i > 0 && buf[i-1] == MIDI_SYSEX_END))\n\t\tsc->doingsysex = 0;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_do_chncommon",
          "args": [
            "sc",
            "b"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_chncommon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "755-802",
          "snippet": "int\nseq_do_chncommon(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, p1, w14;\n\tint error;\n\tstruct midi_dev *md;\n\tunion {\n\t\tint16_t s;\n\t\tu_int8_t b[2];\n\t} u;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tp1 = SEQ_EP1(b);\n\tu.b[0] = b->arr[6];\n\tu.b[1] = b->arr[7];\n\tw14 = u.s;\n\tDPRINTFN(2,(\"seq_do_chncommon: %02x\\n\", cmd));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase MIDI_PGM_CHANGE:\n\t\terror = midiseq_pgmchange(md, chan, p1);\n\t\tbreak;\n\tcase MIDI_CTL_CHANGE:\n\t\tif (chan > 15 || p1 > 127)\n\t\t\treturn (0); /* EINVAL */\n\t\terror = midiseq_ctlchange(md, chan, p1, w14);\n\t\tbreak;\n\tcase MIDI_PITCH_BEND:\n\t\terror = midiseq_pitchbend(md, chan, w14);\n\t\tbreak;\n\tcase MIDI_CHN_PRESSURE:\n\t\terror = midiseq_chnpressure(md, chan, p1);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chncommon: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_chncommon(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, p1, w14;\n\tint error;\n\tstruct midi_dev *md;\n\tunion {\n\t\tint16_t s;\n\t\tu_int8_t b[2];\n\t} u;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tp1 = SEQ_EP1(b);\n\tu.b[0] = b->arr[6];\n\tu.b[1] = b->arr[7];\n\tw14 = u.s;\n\tDPRINTFN(2,(\"seq_do_chncommon: %02x\\n\", cmd));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase MIDI_PGM_CHANGE:\n\t\terror = midiseq_pgmchange(md, chan, p1);\n\t\tbreak;\n\tcase MIDI_CTL_CHANGE:\n\t\tif (chan > 15 || p1 > 127)\n\t\t\treturn (0); /* EINVAL */\n\t\terror = midiseq_ctlchange(md, chan, p1, w14);\n\t\tbreak;\n\tcase MIDI_PITCH_BEND:\n\t\terror = midiseq_pitchbend(md, chan, w14);\n\t\tbreak;\n\tcase MIDI_CHN_PRESSURE:\n\t\terror = midiseq_chnpressure(md, chan, p1);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chncommon: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_do_chnvoice",
          "args": [
            "sc",
            "b"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_chnvoice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "711-753",
          "snippet": "int\nseq_do_chnvoice(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, note, parm, voice;\n\tint error;\n\tstruct midi_dev *md;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tnote = SEQ_ENOTE(b);\n\tparm = SEQ_EPARM(b);\n\tDPRINTFN(2,(\"seq_do_chnvoice: cmd=%02x dev=%d chan=%d note=%d parm=%d\\n\", \n\t\t    cmd, dev, chan, note, parm));\n\tvoice = chan;\n\tif (cmd == MIDI_NOTEON && parm == 0) {\n\t\tcmd = MIDI_NOTEOFF;\n\t\tparm = MIDI_HALF_VEL;\n\t}\n\tswitch(cmd) {\n\tcase MIDI_NOTEON:\n\t\tDPRINTFN(5, (\"seq_do_chnvoice: noteon %p %d %d %d\\n\", \n\t\t\t     md, voice, note, parm));\n\t\terror = midiseq_noteon(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_NOTEOFF:\n\t\terror = midiseq_noteoff(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_KEY_PRESSURE:\n\t\terror = midiseq_keypressure(md, voice, note, parm);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chnvoice: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_chnvoice(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint cmd, dev, chan, note, parm, voice;\n\tint error;\n\tstruct midi_dev *md;\n\n\tdev = SEQ_EDEV(b);\n\tif (dev < 0 || dev >= sc->nmidi)\n\t\treturn (ENXIO);\n\tmd = sc->devs[dev];\n\tcmd = SEQ_ECMD(b);\n\tchan = SEQ_ECHAN(b);\n\tnote = SEQ_ENOTE(b);\n\tparm = SEQ_EPARM(b);\n\tDPRINTFN(2,(\"seq_do_chnvoice: cmd=%02x dev=%d chan=%d note=%d parm=%d\\n\", \n\t\t    cmd, dev, chan, note, parm));\n\tvoice = chan;\n\tif (cmd == MIDI_NOTEON && parm == 0) {\n\t\tcmd = MIDI_NOTEOFF;\n\t\tparm = MIDI_HALF_VEL;\n\t}\n\tswitch(cmd) {\n\tcase MIDI_NOTEON:\n\t\tDPRINTFN(5, (\"seq_do_chnvoice: noteon %p %d %d %d\\n\", \n\t\t\t     md, voice, note, parm));\n\t\terror = midiseq_noteon(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_NOTEOFF:\n\t\terror = midiseq_noteoff(md, voice, note, parm);\n\t\tbreak;\n\tcase MIDI_KEY_PRESSURE:\n\t\terror = midiseq_keypressure(md, voice, note, parm);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_chnvoice: unimpl command %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_do_timing",
          "args": [
            "sc",
            "b"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_timing",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "804-819",
          "snippet": "int\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_do_local",
          "args": [
            "sc",
            "b"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "821-827",
          "snippet": "int\nseq_do_local(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\treturn (EINVAL);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_local(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\treturn (EINVAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "b"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "4",
            "(\"seq_do_command: %p cmd=0x%02x\\n\", sc, SEQ_CMD(b))"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "b"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_command(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev;\n\n\tDPRINTFN(4, (\"seq_do_command: %p cmd=0x%02x\\n\", sc, SEQ_CMD(b)));\n\n\tswitch(SEQ_CMD(b)) {\n\tcase SEQ_LOCAL:\n\t\treturn (seq_do_local(sc, b));\n\tcase SEQ_TIMING:\n\t\treturn (seq_do_timing(sc, b));\n\tcase SEQ_CHN_VOICE:\n\t\treturn (seq_do_chnvoice(sc, b));\n\tcase SEQ_CHN_COMMON:\n\t\treturn (seq_do_chncommon(sc, b));\n\tcase SEQ_SYSEX:\n\t\treturn (seq_do_sysex(sc, b));\n\t/* COMPAT */\n\tcase SEQOLD_MIDIPUTC:\n\t\tdev = b->arr[2];\n\t\tif (dev < 0 || dev >= sc->nmidi)\n\t\t\treturn (ENXIO);\n\t\treturn (midiseq_putc(sc->devs[dev], b->arr[1]));\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_command: unimpl command %02x\\n\", \n\t\t\t     SEQ_CMD(b)));\n\t\treturn (EINVAL);\n\t}\n}"
  },
  {
    "function_name": "seq_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "660-676",
    "snippet": "void\nseq_reset(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint i, chn;\n\tstruct midi_dev *md;\n\n\tfor (i = 0; i < sc->nmidi; i++) {\n\t\tmd = sc->devs[i];\n\t\tmidiseq_reset(md);\n\t\tfor (chn = 0; chn < MAXCHAN; chn++) {\n\t\t\tmidiseq_ctlchange(md, chn, MIDI_CTRL_ALLOFF, 0);\n\t\t\tmidiseq_ctlchange(md, chn, MIDI_CTRL_RESET, 0);\n\t\t\tmidiseq_pitchbend(md, chn, MIDI_BEND_NEUTRAL);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "midiseq_pitchbend",
          "args": [
            "md",
            "chn",
            "MIDI_BEND_NEUTRAL"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_pitchbend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1254-1267",
          "snippet": "int\nmidiseq_pitchbend(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PITCH_BEND | chan;\n\tbuf[1] = parm & 0x7f;\n\tbuf[2] = (parm >> 7) & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_pitchbend(md, chan, parm)\n\tstruct midi_dev *md;\n\tint chan, parm;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_PITCH_BEND | chan;\n\tbuf[1] = parm & 0x7f;\n\tbuf[2] = (parm >> 7) & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_ctlchange",
          "args": [
            "md",
            "chn",
            "MIDI_CTRL_RESET",
            "0"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_ctlchange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1238-1252",
          "snippet": "int\nmidiseq_ctlchange(md, chan, parm, w14)\n\tstruct midi_dev *md;\n\tint chan, parm, w14;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CTL_CHANGE | chan;\n\tbuf[1] = parm;\n\tbuf[2] = w14 & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidiseq_ctlchange(md, chan, parm, w14)\n\tstruct midi_dev *md;\n\tint chan, parm, w14;\n{\n\tu_char buf[3];\n\n\tif (chan < 0 || chan > 15 ||\n\t    parm < 0 || parm > 127)\n\t\treturn (EINVAL);\n\tbuf[0] = MIDI_CTL_CHANGE | chan;\n\tbuf[1] = parm;\n\tbuf[2] = w14 & 0x7f;\n\treturn (midiseq_out(md, buf, 3, 1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_reset",
          "args": [
            "md"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1126-1132",
          "snippet": "void\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_reset(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint i, chn;\n\tstruct midi_dev *md;\n\n\tfor (i = 0; i < sc->nmidi; i++) {\n\t\tmd = sc->devs[i];\n\t\tmidiseq_reset(md);\n\t\tfor (chn = 0; chn < MAXCHAN; chn++) {\n\t\t\tmidiseq_ctlchange(md, chn, MIDI_CTRL_ALLOFF, 0);\n\t\t\tmidiseq_ctlchange(md, chn, MIDI_CTRL_RESET, 0);\n\t\t\tmidiseq_pitchbend(md, chn, MIDI_BEND_NEUTRAL);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "sequencerselect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "633-658",
    "snippet": "int\nsequencerselect(dev, rw, p)\n\tdev_t dev;\n\tint rw;\n\tstruct proc *p;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\n\tDPRINTF((\"sequencerselect: %p rw=0x%x\\n\", sc, rw));\n\n\tswitch (rw) {\n\tcase FREAD:\n\t\tif (!SEQ_QEMPTY(&sc->inq))\n\t\t\treturn (1);\n\t\tselrecord(p, &sc->rsel);\n\t\tbreak;\n\n\tcase FWRITE:\n\t\tif (SEQ_QLEN(&sc->outq) < sc->lowat)\n\t\t\treturn (1);\n\t\tselrecord(p, &sc->wsel);\n\t\tbreak;\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "selrecord",
          "args": [
            "p",
            "&sc->wsel"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QLEN",
          "args": [
            "&sc->outq"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selrecord",
          "args": [
            "p",
            "&sc->rsel"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QEMPTY",
          "args": [
            "&sc->inq"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"sequencerselect: %p rw=0x%x\\n\", sc, rw)"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQUENCERUNIT",
          "args": [
            "dev"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nsequencerselect(dev, rw, p)\n\tdev_t dev;\n\tint rw;\n\tstruct proc *p;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\n\tDPRINTF((\"sequencerselect: %p rw=0x%x\\n\", sc, rw));\n\n\tswitch (rw) {\n\tcase FREAD:\n\t\tif (!SEQ_QEMPTY(&sc->inq))\n\t\t\treturn (1);\n\t\tselrecord(p, &sc->rsel);\n\t\tbreak;\n\n\tcase FWRITE:\n\t\tif (SEQ_QLEN(&sc->outq) < sc->lowat)\n\t\t\treturn (1);\n\t\tselrecord(p, &sc->wsel);\n\t\tbreak;\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "sequencerioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "478-631",
    "snippet": "int\nsequencerioctl(dev, cmd, addr, flag, p)\n\tdev_t dev;\n\tu_long cmd;\n\tcaddr_t addr;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tstruct synth_info *si;\n\tstruct midi_dev *md;\n\tint devno;\n\tint error;\n\tint t;\n\n\tDPRINTFN(2, (\"sequencerioctl: %p cmd=0x%08lx\\n\", sc, cmd));\n\n\terror = 0;\n\tswitch (cmd) {\n\tcase FIONBIO:\n\t\t/* All handled in the upper FS layer. */\n\t\tbreak;\n\n\tcase FIOASYNC:\n\t\tif (*(int *)addr) {\n\t\t\tif (sc->async)\n\t\t\t\treturn (EBUSY);\n\t\t\tsc->async = p;\n\t\t\tDPRINTF((\"sequencer_ioctl: FIOASYNC %p\\n\", p));\n\t\t} else\n\t\t\tsc->async = 0;\n\t\tbreak;\n\n\tcase SEQUENCER_RESET:\n\t\tseq_reset(sc);\n\t\tbreak;\n\n\tcase SEQUENCER_PANIC:\n\t\tseq_reset(sc);\n\t\t/* Do more?  OSS doesn't */\n\t\tbreak;\n\n\tcase SEQUENCER_SYNC:\n\t\tif (sc->flags == FREAD)\n\t\t\treturn (0);\n\t\tseq_drain(sc);\n\t\terror = 0;\n\t\tbreak;\n\n\tcase SEQUENCER_INFO:\n\t\tsi = (struct synth_info*)addr;\n\t\tdevno = si->device;\n\t\tif (devno < 0 || devno >= sc->nmidi)\n\t\t\treturn (EINVAL);\n\t\tmd = sc->devs[devno];\n\t\tstrncpy(si->name, md->name, sizeof si->name);\n\t\tsi->synth_type = SYNTH_TYPE_MIDI;\n\t\tsi->synth_subtype = md->subtype;\n\t\tsi->nr_voices = md->nr_voices;\n\t\tsi->instr_bank_size = md->instr_bank_size;\n\t\tsi->capabilities = md->capabilities;\n\t\tbreak;\n\n\tcase SEQUENCER_NRSYNTHS:\n\t\t*(int *)addr = sc->nmidi;\n\t\tbreak;\n\n\tcase SEQUENCER_NRMIDIS:\n\t\t*(int *)addr = sc->nmidi;\n\t\tbreak;\n\n\tcase SEQUENCER_OUTOFBAND:\n\t\tDPRINTFN(3, (\"sequencer_ioctl: OOB=%02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t\t     *(u_char *)addr, *(u_char *)(addr+1),\n\t\t\t     *(u_char *)(addr+2), *(u_char *)(addr+3),\n\t\t\t     *(u_char *)(addr+4), *(u_char *)(addr+5),\n\t\t\t     *(u_char *)(addr+6), *(u_char *)(addr+7)));\n\t\terror = seq_do_command(sc, (seq_event_rec *)addr);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_TIMEBASE:\n\t\tt = *(int *)addr;\n\t\tif (t < 1)\n\t\t\tt = 1;\n\t\tif (t > 1000)\n\t\t\tt = 1000;\n\t\tsc->timer.timebase = t;\n\t\t*(int *)addr = t;\n\t\tRECALC_TICK(&sc->timer);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_START:\n\t\terror = seq_timer(sc, TMR_START, 0, 0);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_STOP:\n\t\terror = seq_timer(sc, TMR_STOP, 0, 0);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_CONTINUE:\n\t\terror = seq_timer(sc, TMR_CONTINUE, 0, 0);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_TEMPO:\n\t\tt = *(int *)addr;\n\t\tif (t < 8)\n\t\t\tt = 8;\n\t\tif (t > 250)\n\t\t\tt = 250;\n\t\tsc->timer.tempo = t;\n\t\t*(int *)addr = t;\n\t\tRECALC_TICK(&sc->timer);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_SOURCE:\n\t\t*(int *)addr = SEQUENCER_TMR_INTERNAL;\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_METRONOME:\n\t\t/* noop */\n\t\tbreak;\n\n\tcase SEQUENCER_THRESHOLD:\n\t\tt = SEQ_MAXQ - *(int *)addr / sizeof (seq_event_rec);\n\t\tif (t < 1)\n\t\t\tt = 1;\n\t\tif (t > SEQ_MAXQ)\n\t\t\tt = SEQ_MAXQ;\n\t\tsc->lowat = t;\n\t\tbreak;\n\n\tcase SEQUENCER_CTRLRATE:\n\t\t*(int *)addr = (sc->timer.tempo*sc->timer.timebase + 30) / 60;\n\t\tbreak;\n\n\tcase SEQUENCER_GETTIME:\n\t{\n\t\tstruct timeval now;\n\t\tu_long t;\n\t\tmicrotime(&now);\n\t\tSUBTIMEVAL(&now, &sc->timer.start);\n\t\tt = now.tv_sec * 1000000 + now.tv_usec;\n\t\tt /= sc->timer.tick;\n\t\t*(int *)addr = t;\n\t\tbreak;\n\t}\n\n\tdefault:\n\t\tDPRINTFN(-1,(\"sequencer_ioctl: unimpl %08lx\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "-1",
            "(\"sequencer_ioctl: unimpl %08lx\\n\", cmd)"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SUBTIMEVAL",
          "args": [
            "&now",
            "&sc->timer.start"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "microtime",
          "args": [
            "&now"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RECALC_TICK",
          "args": [
            "&sc->timer"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_timer",
          "args": [
            "sc",
            "TMR_CONTINUE",
            "0",
            "0"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "seq_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "858-940",
          "snippet": "int\nseq_timer(sc, cmd, parm, b)\n\tstruct sequencer_softc *sc;\n\tint cmd, parm;\n\tseq_event_rec *b;\n{\n\tstruct syn_timer *t = &sc->timer;\n\tstruct timeval when;\n\tint ticks;\n\tint error;\n\tlong long usec;\n\n\tDPRINTFN(2,(\"seq_timer: %02x %d\\n\", cmd, parm));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase TMR_WAIT_REL:\n\t\tparm += t->last;\n\t\t/* fall into */\n\tcase TMR_WAIT_ABS:\n\t\tt->last = parm;\n\t\tusec = (long long)parm * (long long)t->tick; /* convert to usec */\n\t\twhen.tv_sec = usec / 1000000;\n\t\twhen.tv_usec = usec % 1000000;\n\t\tDPRINTFN(4, (\"seq_timer: parm=%d, sleep when=%ld.%06ld\", parm,\n\t\t\t     when.tv_sec, when.tv_usec));\n\t\tADDTIMEVAL(&when, &t->start); /* abstime for end */\n\t\tticks = hzto(&when);\n\t\tDPRINTFN(4, (\" when+start=%ld.%06ld, tick=%d\\n\",\n\t\t\t     when.tv_sec, when.tv_usec, ticks));\n\t\tif (ticks > 0) {\n#ifdef DIAGNOSTIC\n\t\t\tif (ticks > 20 * hz) {\n\t\t\t\t/* Waiting more than 20s */\n\t\t\t\tprintf(\"seq_timer: funny ticks=%d, usec=%lld, parm=%d, tick=%ld\\n\",\n\t\t\t\t       ticks, usec, parm, t->tick);\n\t\t\t}\n#endif\n\t\t\tsc->timeout = 1;\n\t\t\ttimeout(seq_timeout, sc, ticks);\n\t\t}\n#ifdef SEQUENCER_DEBUG\n\t\telse if (tick < 0)\n\t\t\tDPRINTF((\"seq_timer: ticks = %d\\n\", ticks));\n#endif\n\t\tbreak;\n\tcase TMR_START:\n\t\tmicrotime(&t->start);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_STOP:\n\t\tmicrotime(&t->stop);\n\t\tt->running = 0;\n\t\tbreak;\n\tcase TMR_CONTINUE:\n\t\tmicrotime(&when);\n\t\tSUBTIMEVAL(&when, &t->stop);\n\t\tADDTIMEVAL(&t->start, &when);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_TEMPO:\n\t\t/* parm is ticks per minute / timebase */\n\t\tif (parm < 8)\n\t\t\tparm = 8;\n\t\tif (parm > 360)\n\t\t\tparm = 360;\n\t\tt->tempo = parm;\n\t\tRECALC_TICK(t);\n\t\tbreak;\n\tcase TMR_ECHO:\n\t\terror = seq_input_event(sc, b);\n\t\tbreak;\n\tcase TMR_RESET:\n\t\tt->last = 0;\n\t\tmicrotime(&t->start);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTF((\"seq_timer: unknown %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_timer(sc, cmd, parm, b)\n\tstruct sequencer_softc *sc;\n\tint cmd, parm;\n\tseq_event_rec *b;\n{\n\tstruct syn_timer *t = &sc->timer;\n\tstruct timeval when;\n\tint ticks;\n\tint error;\n\tlong long usec;\n\n\tDPRINTFN(2,(\"seq_timer: %02x %d\\n\", cmd, parm));\n\n\terror = 0;\n\tswitch(cmd) {\n\tcase TMR_WAIT_REL:\n\t\tparm += t->last;\n\t\t/* fall into */\n\tcase TMR_WAIT_ABS:\n\t\tt->last = parm;\n\t\tusec = (long long)parm * (long long)t->tick; /* convert to usec */\n\t\twhen.tv_sec = usec / 1000000;\n\t\twhen.tv_usec = usec % 1000000;\n\t\tDPRINTFN(4, (\"seq_timer: parm=%d, sleep when=%ld.%06ld\", parm,\n\t\t\t     when.tv_sec, when.tv_usec));\n\t\tADDTIMEVAL(&when, &t->start); /* abstime for end */\n\t\tticks = hzto(&when);\n\t\tDPRINTFN(4, (\" when+start=%ld.%06ld, tick=%d\\n\",\n\t\t\t     when.tv_sec, when.tv_usec, ticks));\n\t\tif (ticks > 0) {\n#ifdef DIAGNOSTIC\n\t\t\tif (ticks > 20 * hz) {\n\t\t\t\t/* Waiting more than 20s */\n\t\t\t\tprintf(\"seq_timer: funny ticks=%d, usec=%lld, parm=%d, tick=%ld\\n\",\n\t\t\t\t       ticks, usec, parm, t->tick);\n\t\t\t}\n#endif\n\t\t\tsc->timeout = 1;\n\t\t\ttimeout(seq_timeout, sc, ticks);\n\t\t}\n#ifdef SEQUENCER_DEBUG\n\t\telse if (tick < 0)\n\t\t\tDPRINTF((\"seq_timer: ticks = %d\\n\", ticks));\n#endif\n\t\tbreak;\n\tcase TMR_START:\n\t\tmicrotime(&t->start);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_STOP:\n\t\tmicrotime(&t->stop);\n\t\tt->running = 0;\n\t\tbreak;\n\tcase TMR_CONTINUE:\n\t\tmicrotime(&when);\n\t\tSUBTIMEVAL(&when, &t->stop);\n\t\tADDTIMEVAL(&t->start, &when);\n\t\tt->running = 1;\n\t\tbreak;\n\tcase TMR_TEMPO:\n\t\t/* parm is ticks per minute / timebase */\n\t\tif (parm < 8)\n\t\t\tparm = 8;\n\t\tif (parm > 360)\n\t\t\tparm = 360;\n\t\tt->tempo = parm;\n\t\tRECALC_TICK(t);\n\t\tbreak;\n\tcase TMR_ECHO:\n\t\terror = seq_input_event(sc, b);\n\t\tbreak;\n\tcase TMR_RESET:\n\t\tt->last = 0;\n\t\tmicrotime(&t->start);\n\t\tbreak;\n\tdefault:\n\t\tDPRINTF((\"seq_timer: unknown %02x\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RECALC_TICK",
          "args": [
            "&sc->timer"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_do_command",
          "args": [
            "sc",
            "(seq_event_rec *)addr"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "678-709",
          "snippet": "int\nseq_do_command(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev;\n\n\tDPRINTFN(4, (\"seq_do_command: %p cmd=0x%02x\\n\", sc, SEQ_CMD(b)));\n\n\tswitch(SEQ_CMD(b)) {\n\tcase SEQ_LOCAL:\n\t\treturn (seq_do_local(sc, b));\n\tcase SEQ_TIMING:\n\t\treturn (seq_do_timing(sc, b));\n\tcase SEQ_CHN_VOICE:\n\t\treturn (seq_do_chnvoice(sc, b));\n\tcase SEQ_CHN_COMMON:\n\t\treturn (seq_do_chncommon(sc, b));\n\tcase SEQ_SYSEX:\n\t\treturn (seq_do_sysex(sc, b));\n\t/* COMPAT */\n\tcase SEQOLD_MIDIPUTC:\n\t\tdev = b->arr[2];\n\t\tif (dev < 0 || dev >= sc->nmidi)\n\t\t\treturn (ENXIO);\n\t\treturn (midiseq_putc(sc->devs[dev], b->arr[1]));\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_command: unimpl command %02x\\n\", \n\t\t\t     SEQ_CMD(b)));\n\t\treturn (EINVAL);\n\t}\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_command(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev;\n\n\tDPRINTFN(4, (\"seq_do_command: %p cmd=0x%02x\\n\", sc, SEQ_CMD(b)));\n\n\tswitch(SEQ_CMD(b)) {\n\tcase SEQ_LOCAL:\n\t\treturn (seq_do_local(sc, b));\n\tcase SEQ_TIMING:\n\t\treturn (seq_do_timing(sc, b));\n\tcase SEQ_CHN_VOICE:\n\t\treturn (seq_do_chnvoice(sc, b));\n\tcase SEQ_CHN_COMMON:\n\t\treturn (seq_do_chncommon(sc, b));\n\tcase SEQ_SYSEX:\n\t\treturn (seq_do_sysex(sc, b));\n\t/* COMPAT */\n\tcase SEQOLD_MIDIPUTC:\n\t\tdev = b->arr[2];\n\t\tif (dev < 0 || dev >= sc->nmidi)\n\t\t\treturn (ENXIO);\n\t\treturn (midiseq_putc(sc->devs[dev], b->arr[1]));\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_command: unimpl command %02x\\n\", \n\t\t\t     SEQ_CMD(b)));\n\t\treturn (EINVAL);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "3",
            "(\"sequencer_ioctl: OOB=%02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t\t     *(u_char *)addr, *(u_char *)(addr+1),\n\t\t\t     *(u_char *)(addr+2), *(u_char *)(addr+3),\n\t\t\t     *(u_char *)(addr+4), *(u_char *)(addr+5),\n\t\t\t     *(u_char *)(addr+6), *(u_char *)(addr+7))"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "si->name",
            "md->name",
            "sizeof si->name"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_drain",
          "args": [
            "sc"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "seq_drain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "262-274",
          "snippet": "int\nseq_drain(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint error;\n\n\tDPRINTFN(3, (\"seq_drain: %p, len=%d\\n\", sc, SEQ_QLEN(&sc->outq)));\n\tseq_startoutput(sc);\n\terror = 0;\n\twhile(!SEQ_QEMPTY(&sc->outq) && !error)\n\t\terror = seq_sleep_timo(&sc->wchan, \"seq_dr\", 60*hz);\n\treturn (error);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_drain(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint error;\n\n\tDPRINTFN(3, (\"seq_drain: %p, len=%d\\n\", sc, SEQ_QLEN(&sc->outq)));\n\tseq_startoutput(sc);\n\terror = 0;\n\twhile(!SEQ_QEMPTY(&sc->outq) && !error)\n\t\terror = seq_sleep_timo(&sc->wchan, \"seq_dr\", 60*hz);\n\treturn (error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_reset",
          "args": [
            "sc"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1126-1132",
          "snippet": "void\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"sequencer_ioctl: FIOASYNC %p\\n\", p)"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"sequencerioctl: %p cmd=0x%08lx\\n\", sc, cmd)"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQUENCERUNIT",
          "args": [
            "dev"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nsequencerioctl(dev, cmd, addr, flag, p)\n\tdev_t dev;\n\tu_long cmd;\n\tcaddr_t addr;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tstruct synth_info *si;\n\tstruct midi_dev *md;\n\tint devno;\n\tint error;\n\tint t;\n\n\tDPRINTFN(2, (\"sequencerioctl: %p cmd=0x%08lx\\n\", sc, cmd));\n\n\terror = 0;\n\tswitch (cmd) {\n\tcase FIONBIO:\n\t\t/* All handled in the upper FS layer. */\n\t\tbreak;\n\n\tcase FIOASYNC:\n\t\tif (*(int *)addr) {\n\t\t\tif (sc->async)\n\t\t\t\treturn (EBUSY);\n\t\t\tsc->async = p;\n\t\t\tDPRINTF((\"sequencer_ioctl: FIOASYNC %p\\n\", p));\n\t\t} else\n\t\t\tsc->async = 0;\n\t\tbreak;\n\n\tcase SEQUENCER_RESET:\n\t\tseq_reset(sc);\n\t\tbreak;\n\n\tcase SEQUENCER_PANIC:\n\t\tseq_reset(sc);\n\t\t/* Do more?  OSS doesn't */\n\t\tbreak;\n\n\tcase SEQUENCER_SYNC:\n\t\tif (sc->flags == FREAD)\n\t\t\treturn (0);\n\t\tseq_drain(sc);\n\t\terror = 0;\n\t\tbreak;\n\n\tcase SEQUENCER_INFO:\n\t\tsi = (struct synth_info*)addr;\n\t\tdevno = si->device;\n\t\tif (devno < 0 || devno >= sc->nmidi)\n\t\t\treturn (EINVAL);\n\t\tmd = sc->devs[devno];\n\t\tstrncpy(si->name, md->name, sizeof si->name);\n\t\tsi->synth_type = SYNTH_TYPE_MIDI;\n\t\tsi->synth_subtype = md->subtype;\n\t\tsi->nr_voices = md->nr_voices;\n\t\tsi->instr_bank_size = md->instr_bank_size;\n\t\tsi->capabilities = md->capabilities;\n\t\tbreak;\n\n\tcase SEQUENCER_NRSYNTHS:\n\t\t*(int *)addr = sc->nmidi;\n\t\tbreak;\n\n\tcase SEQUENCER_NRMIDIS:\n\t\t*(int *)addr = sc->nmidi;\n\t\tbreak;\n\n\tcase SEQUENCER_OUTOFBAND:\n\t\tDPRINTFN(3, (\"sequencer_ioctl: OOB=%02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t\t     *(u_char *)addr, *(u_char *)(addr+1),\n\t\t\t     *(u_char *)(addr+2), *(u_char *)(addr+3),\n\t\t\t     *(u_char *)(addr+4), *(u_char *)(addr+5),\n\t\t\t     *(u_char *)(addr+6), *(u_char *)(addr+7)));\n\t\terror = seq_do_command(sc, (seq_event_rec *)addr);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_TIMEBASE:\n\t\tt = *(int *)addr;\n\t\tif (t < 1)\n\t\t\tt = 1;\n\t\tif (t > 1000)\n\t\t\tt = 1000;\n\t\tsc->timer.timebase = t;\n\t\t*(int *)addr = t;\n\t\tRECALC_TICK(&sc->timer);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_START:\n\t\terror = seq_timer(sc, TMR_START, 0, 0);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_STOP:\n\t\terror = seq_timer(sc, TMR_STOP, 0, 0);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_CONTINUE:\n\t\terror = seq_timer(sc, TMR_CONTINUE, 0, 0);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_TEMPO:\n\t\tt = *(int *)addr;\n\t\tif (t < 8)\n\t\t\tt = 8;\n\t\tif (t > 250)\n\t\t\tt = 250;\n\t\tsc->timer.tempo = t;\n\t\t*(int *)addr = t;\n\t\tRECALC_TICK(&sc->timer);\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_SOURCE:\n\t\t*(int *)addr = SEQUENCER_TMR_INTERNAL;\n\t\tbreak;\n\n\tcase SEQUENCER_TMR_METRONOME:\n\t\t/* noop */\n\t\tbreak;\n\n\tcase SEQUENCER_THRESHOLD:\n\t\tt = SEQ_MAXQ - *(int *)addr / sizeof (seq_event_rec);\n\t\tif (t < 1)\n\t\t\tt = 1;\n\t\tif (t > SEQ_MAXQ)\n\t\t\tt = SEQ_MAXQ;\n\t\tsc->lowat = t;\n\t\tbreak;\n\n\tcase SEQUENCER_CTRLRATE:\n\t\t*(int *)addr = (sc->timer.tempo*sc->timer.timebase + 30) / 60;\n\t\tbreak;\n\n\tcase SEQUENCER_GETTIME:\n\t{\n\t\tstruct timeval now;\n\t\tu_long t;\n\t\tmicrotime(&now);\n\t\tSUBTIMEVAL(&now, &sc->timer.start);\n\t\tt = now.tv_sec * 1000000 + now.tv_usec;\n\t\tt /= sc->timer.tick;\n\t\t*(int *)addr = t;\n\t\tbreak;\n\t}\n\n\tdefault:\n\t\tDPRINTFN(-1,(\"sequencer_ioctl: unimpl %08lx\\n\", cmd));\n\t\terror = EINVAL;\n\t\tbreak;\n\t}\n\treturn (error);\n}"
  },
  {
    "function_name": "sequencerwrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "427-476",
    "snippet": "int\nsequencerwrite(dev, uio, ioflag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint ioflag;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tstruct sequencer_queue *q = &sc->outq;\n\tint error;\n\tseq_event_rec cmdbuf;\n\tint size;\n\n\tDPRINTFN(2, (\"sequencerwrite: %p, count=%d\\n\", sc, uio->uio_resid));\n\n\terror = 0;\n\tsize = sc->mode == SEQ_NEW ? sizeof cmdbuf : SEQOLD_CMDSIZE;\n\twhile (uio->uio_resid >= size) {\n\t\terror = uiomove((caddr_t)&cmdbuf, size, uio);\n\t\tif (error)\n\t\t\tbreak;\n\t\tif (sc->mode == SEQ_OLD)\n\t\t\tif (seq_to_new(&cmdbuf, uio))\n\t\t\t\tcontinue;\n\t\tif (SEQ_CMD(&cmdbuf) == SEQ_FULLSIZE) {\n\t\t\t/* We do it like OSS does, asynchronously */\n\t\t\terror = seq_do_fullsize(sc, &cmdbuf, uio);\n\t\t\tif (error)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\t\twhile (SEQ_QFULL(q)) {\n\t\t\tseq_startoutput(sc);\n\t\t\tif (SEQ_QFULL(q)) {\n\t\t\t\tif (ioflag & IO_NDELAY)\n\t\t\t\t\treturn (EWOULDBLOCK);\n\t\t\t\terror = seq_sleep(&sc->wchan, \"seq_wr\");\n\t\t\t\tif (error)\n\t\t\t\t\treturn (error);\n\t\t\t}\n\t\t}\n\t\tSEQ_QPUT(q, cmdbuf);\n\t}\n\tseq_startoutput(sc);\n\n#ifdef SEQUENCER_DEBUG\n\tif (error)\n\t\tDPRINTFN(2, (\"sequencerwrite: error=%d\\n\", error));\n#endif\n\treturn (error);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"sequencerwrite: error=%d\\n\", error)"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_startoutput",
          "args": [
            "sc"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "seq_startoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "293-307",
          "snippet": "void\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QPUT",
          "args": [
            "q",
            "cmdbuf"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_sleep",
          "args": [
            "&sc->wchan",
            "\"seq_wr\""
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "seq_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "243-249",
          "snippet": "static int\nseq_sleep(chan, label)\n\tint *chan;\n\tchar *label;\n{\n\treturn (seq_sleep_timo(chan, label, 0));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_sleep(chan, label)\n\tint *chan;\n\tchar *label;\n{\n\treturn (seq_sleep_timo(chan, label, 0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QFULL",
          "args": [
            "q"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QFULL",
          "args": [
            "q"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_do_fullsize",
          "args": [
            "sc",
            "&cmdbuf",
            "uio"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_fullsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "942-962",
          "snippet": "int\nseq_do_fullsize(sc, b, uio)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n\tstruct uio *uio;\n{\n\tstruct sysex_info sysex;\n\tu_int dev;\n\n#ifdef DIAGNOSTIC\n\tif (sizeof(seq_event_rec) != SEQ_SYSEX_HDRSIZE) {\n\t\tprintf(\"seq_do_fullsize: sysex size ??\\n\");\n\t\treturn (EINVAL);\n\t}\n#endif\n\tmemcpy(&sysex, b, sizeof sysex);\n\tdev = sysex.device_no;\n\tDPRINTFN(2, (\"seq_do_fullsize: fmt=%04x, dev=%d, len=%d\\n\",\n\t\t     sysex.key, dev, sysex.len));\n\treturn (midiseq_loadpatch(sc->devs[dev], &sysex, uio));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_fullsize(sc, b, uio)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n\tstruct uio *uio;\n{\n\tstruct sysex_info sysex;\n\tu_int dev;\n\n#ifdef DIAGNOSTIC\n\tif (sizeof(seq_event_rec) != SEQ_SYSEX_HDRSIZE) {\n\t\tprintf(\"seq_do_fullsize: sysex size ??\\n\");\n\t\treturn (EINVAL);\n\t}\n#endif\n\tmemcpy(&sysex, b, sizeof sysex);\n\tdev = sysex.device_no;\n\tDPRINTFN(2, (\"seq_do_fullsize: fmt=%04x, dev=%d, len=%d\\n\",\n\t\t     sysex.key, dev, sysex.len));\n\treturn (midiseq_loadpatch(sc->devs[dev], &sysex, uio));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_CMD",
          "args": [
            "&cmdbuf"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_to_new",
          "args": [
            "&cmdbuf",
            "uio"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "seq_to_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "965-1038",
          "snippet": "int\nseq_to_new(ev, uio)\n\tseq_event_rec *ev;\n\tstruct uio *uio;\n{\n\tint cmd, chan, note, parm;\n\tu_int32_t delay;\n\tint error;\n\n\tcmd = SEQ_CMD(ev);\n\tchan = ev->arr[1];\n\tnote = ev->arr[2];\n\tparm = ev->arr[3];\n\tDPRINTFN(3, (\"seq_to_new: 0x%02x %d %d %d\\n\", cmd, chan, note, parm));\n\n\tif (cmd >= 0x80) {\n\t\t/* Fill the event record */\n\t\tif (uio->uio_resid >= sizeof *ev - SEQOLD_CMDSIZE) {\n\t\t\terror = uiomove(&ev->arr[SEQOLD_CMDSIZE], \n\t\t\t\t\tsizeof *ev - SEQOLD_CMDSIZE, uio);\n\t\t\tif (error)\n\t\t\t\treturn (error);\n\t\t} else\n\t\t\treturn (EINVAL);\n\t}\n\n\tswitch(cmd) {\n\tcase SEQOLD_NOTEOFF:\n\t\tnote = 255;\n\t\tSEQ_ECMD(ev) = MIDI_NOTEOFF;\n\t\tgoto onoff;\n\tcase SEQOLD_NOTEON:\n\t\tSEQ_ECMD(ev) = MIDI_NOTEON;\n\tonoff:\n\t\tSEQ_CMD(ev) = SEQ_CHN_VOICE;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_ENOTE(ev) = note;\n\t\tSEQ_EPARM(ev) = parm;\n\t\tbreak;\n\tcase SEQOLD_WAIT:\n\t\tdelay = *(u_int32_t *)ev->arr >> 8;\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_WAIT_REL;\n\t\t*(u_int32_t *)&ev->arr[4] = delay;\n\t\tbreak;\n\tcase SEQOLD_SYNCTIMER:\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_RESET;\n\t\tbreak;\n\tcase SEQOLD_PGMCHANGE:\n\t\tSEQ_ECMD(ev) = MIDI_PGM_CHANGE;\n\t\tSEQ_CMD(ev) = SEQ_CHN_COMMON;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_EP1(ev) = note;\n\t\tbreak;\n\tcase SEQOLD_MIDIPUTC:\n\t\tbreak;\t\t/* interpret in normal mode */\n\tcase SEQOLD_ECHO:\n\tcase SEQOLD_PRIVATE:\n\tcase SEQOLD_EXTENDED:\n\tdefault:\n\t\tDPRINTF((\"seq_to_new: not impl 0x%02x\\n\", cmd));\n\t\treturn (EINVAL);\n\t/* In case new events show up */\n\tcase SEQ_TIMING:\n\tcase SEQ_CHN_VOICE:\n\tcase SEQ_CHN_COMMON:\n\tcase SEQ_FULLSIZE:\n\t\tbreak;\n\t}\n\treturn (0);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_to_new(ev, uio)\n\tseq_event_rec *ev;\n\tstruct uio *uio;\n{\n\tint cmd, chan, note, parm;\n\tu_int32_t delay;\n\tint error;\n\n\tcmd = SEQ_CMD(ev);\n\tchan = ev->arr[1];\n\tnote = ev->arr[2];\n\tparm = ev->arr[3];\n\tDPRINTFN(3, (\"seq_to_new: 0x%02x %d %d %d\\n\", cmd, chan, note, parm));\n\n\tif (cmd >= 0x80) {\n\t\t/* Fill the event record */\n\t\tif (uio->uio_resid >= sizeof *ev - SEQOLD_CMDSIZE) {\n\t\t\terror = uiomove(&ev->arr[SEQOLD_CMDSIZE], \n\t\t\t\t\tsizeof *ev - SEQOLD_CMDSIZE, uio);\n\t\t\tif (error)\n\t\t\t\treturn (error);\n\t\t} else\n\t\t\treturn (EINVAL);\n\t}\n\n\tswitch(cmd) {\n\tcase SEQOLD_NOTEOFF:\n\t\tnote = 255;\n\t\tSEQ_ECMD(ev) = MIDI_NOTEOFF;\n\t\tgoto onoff;\n\tcase SEQOLD_NOTEON:\n\t\tSEQ_ECMD(ev) = MIDI_NOTEON;\n\tonoff:\n\t\tSEQ_CMD(ev) = SEQ_CHN_VOICE;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_ENOTE(ev) = note;\n\t\tSEQ_EPARM(ev) = parm;\n\t\tbreak;\n\tcase SEQOLD_WAIT:\n\t\tdelay = *(u_int32_t *)ev->arr >> 8;\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_WAIT_REL;\n\t\t*(u_int32_t *)&ev->arr[4] = delay;\n\t\tbreak;\n\tcase SEQOLD_SYNCTIMER:\n\t\tSEQ_CMD(ev) = SEQ_TIMING;\n\t\tSEQ_TCMD(ev) = TMR_RESET;\n\t\tbreak;\n\tcase SEQOLD_PGMCHANGE:\n\t\tSEQ_ECMD(ev) = MIDI_PGM_CHANGE;\n\t\tSEQ_CMD(ev) = SEQ_CHN_COMMON;\n\t\tSEQ_EDEV(ev) = 0;\n\t\tSEQ_ECHAN(ev) = chan;\n\t\tSEQ_EP1(ev) = note;\n\t\tbreak;\n\tcase SEQOLD_MIDIPUTC:\n\t\tbreak;\t\t/* interpret in normal mode */\n\tcase SEQOLD_ECHO:\n\tcase SEQOLD_PRIVATE:\n\tcase SEQOLD_EXTENDED:\n\tdefault:\n\t\tDPRINTF((\"seq_to_new: not impl 0x%02x\\n\", cmd));\n\t\treturn (EINVAL);\n\t/* In case new events show up */\n\tcase SEQ_TIMING:\n\tcase SEQ_CHN_VOICE:\n\tcase SEQ_CHN_COMMON:\n\tcase SEQ_FULLSIZE:\n\t\tbreak;\n\t}\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "(caddr_t)&cmdbuf",
            "size",
            "uio"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"sequencerwrite: %p, count=%d\\n\", sc, uio->uio_resid)"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQUENCERUNIT",
          "args": [
            "dev"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nsequencerwrite(dev, uio, ioflag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint ioflag;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tstruct sequencer_queue *q = &sc->outq;\n\tint error;\n\tseq_event_rec cmdbuf;\n\tint size;\n\n\tDPRINTFN(2, (\"sequencerwrite: %p, count=%d\\n\", sc, uio->uio_resid));\n\n\terror = 0;\n\tsize = sc->mode == SEQ_NEW ? sizeof cmdbuf : SEQOLD_CMDSIZE;\n\twhile (uio->uio_resid >= size) {\n\t\terror = uiomove((caddr_t)&cmdbuf, size, uio);\n\t\tif (error)\n\t\t\tbreak;\n\t\tif (sc->mode == SEQ_OLD)\n\t\t\tif (seq_to_new(&cmdbuf, uio))\n\t\t\t\tcontinue;\n\t\tif (SEQ_CMD(&cmdbuf) == SEQ_FULLSIZE) {\n\t\t\t/* We do it like OSS does, asynchronously */\n\t\t\terror = seq_do_fullsize(sc, &cmdbuf, uio);\n\t\t\tif (error)\n\t\t\t\tbreak;\n\t\t\tcontinue;\n\t\t}\n\t\twhile (SEQ_QFULL(q)) {\n\t\t\tseq_startoutput(sc);\n\t\t\tif (SEQ_QFULL(q)) {\n\t\t\t\tif (ioflag & IO_NDELAY)\n\t\t\t\t\treturn (EWOULDBLOCK);\n\t\t\t\terror = seq_sleep(&sc->wchan, \"seq_wr\");\n\t\t\t\tif (error)\n\t\t\t\t\treturn (error);\n\t\t\t}\n\t\t}\n\t\tSEQ_QPUT(q, cmdbuf);\n\t}\n\tseq_startoutput(sc);\n\n#ifdef SEQUENCER_DEBUG\n\tif (error)\n\t\tDPRINTFN(2, (\"sequencerwrite: error=%d\\n\", error));\n#endif\n\treturn (error);\n}"
  },
  {
    "function_name": "sequencerread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "389-425",
    "snippet": "int\nsequencerread(dev, uio, ioflag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint ioflag;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tstruct sequencer_queue *q = &sc->inq;\n\tseq_event_rec ev;\n\tint error, s;\n\n\tDPRINTFN(20, (\"sequencerread: %p, count=%d, ioflag=%x\\n\", \n\t\t     sc, uio->uio_resid, ioflag));\n\n\tif (sc->mode == SEQ_OLD) {\n\t\tDPRINTFN(-1,(\"sequencerread: old read\\n\"));\n\t\treturn (EINVAL); /* XXX unimplemented */\n\t}\n\n\terror = 0;\n\twhile (SEQ_QEMPTY(q)) {\n\t\tif (ioflag & IO_NDELAY)\n\t\t\treturn (EWOULDBLOCK);\n\t\telse {\n\t\t\terror = seq_sleep(&sc->rchan, \"seq rd\");\n\t\t\tif (error)\n\t\t\t\treturn (error);\n\t\t}\n\t}\n\ts = splaudio();\n\twhile (uio->uio_resid >= sizeof ev && !error && !SEQ_QEMPTY(q)) {\n\t\tSEQ_QGET(q, ev);\n\t\terror = uiomove((caddr_t)&ev, sizeof ev, uio);\n\t}\n\tsplx(s);\n\treturn (error);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiomove",
          "args": [
            "(caddr_t)&ev",
            "sizeof ev",
            "uio"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QGET",
          "args": [
            "q",
            "ev"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QEMPTY",
          "args": [
            "q"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_sleep",
          "args": [
            "&sc->rchan",
            "\"seq rd\""
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "seq_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "243-249",
          "snippet": "static int\nseq_sleep(chan, label)\n\tint *chan;\n\tchar *label;\n{\n\treturn (seq_sleep_timo(chan, label, 0));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_sleep(chan, label)\n\tint *chan;\n\tchar *label;\n{\n\treturn (seq_sleep_timo(chan, label, 0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QEMPTY",
          "args": [
            "q"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "-1",
            "(\"sequencerread: old read\\n\")"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "20",
            "(\"sequencerread: %p, count=%d, ioflag=%x\\n\", \n\t\t     sc, uio->uio_resid, ioflag)"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQUENCERUNIT",
          "args": [
            "dev"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nsequencerread(dev, uio, ioflag)\n\tdev_t dev;\n\tstruct uio *uio;\n\tint ioflag;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tstruct sequencer_queue *q = &sc->inq;\n\tseq_event_rec ev;\n\tint error, s;\n\n\tDPRINTFN(20, (\"sequencerread: %p, count=%d, ioflag=%x\\n\", \n\t\t     sc, uio->uio_resid, ioflag));\n\n\tif (sc->mode == SEQ_OLD) {\n\t\tDPRINTFN(-1,(\"sequencerread: old read\\n\"));\n\t\treturn (EINVAL); /* XXX unimplemented */\n\t}\n\n\terror = 0;\n\twhile (SEQ_QEMPTY(q)) {\n\t\tif (ioflag & IO_NDELAY)\n\t\t\treturn (EWOULDBLOCK);\n\t\telse {\n\t\t\terror = seq_sleep(&sc->rchan, \"seq rd\");\n\t\t\tif (error)\n\t\t\t\treturn (error);\n\t\t}\n\t}\n\ts = splaudio();\n\twhile (uio->uio_resid >= sizeof ev && !error && !SEQ_QEMPTY(q)) {\n\t\tSEQ_QGET(q, ev);\n\t\terror = uiomove((caddr_t)&ev, sizeof ev, uio);\n\t}\n\tsplx(s);\n\treturn (error);\n}"
  },
  {
    "function_name": "seq_event_intr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "355-387",
    "snippet": "void\nseq_event_intr(addr, iev)\n\tvoid *addr;\n\tseq_event_rec *iev;\n{\n\tstruct sequencer_softc *sc = addr;\n\tunion {\n\t\tu_int32_t l;\n\t\tu_int8_t b[4];\n\t} u;\n\tu_long t;\n\tstruct timeval now;\n\tseq_event_rec ev;\n\n\tmicrotime(&now);\n\tSUBTIMEVAL(&now, &sc->timer.start);\n\tt = now.tv_sec * 1000000 + now.tv_usec;\n\tt /= sc->timer.tick;\n\tif (t != sc->input_stamp) {\n\t\tev.arr[0] = SEQ_TIMING;\n\t\tev.arr[1] = TMR_WAIT_ABS;\n\t\tev.arr[2] = 0;\n\t\tev.arr[3] = 0;\n\t\tu.l = t;\n\t\tev.arr[4] = u.b[0];\n\t\tev.arr[5] = u.b[1];\n\t\tev.arr[6] = u.b[2];\n\t\tev.arr[7] = u.b[3];\n\t\tseq_input_event(sc, &ev);\n\t\tsc->input_stamp = t;\n\t}\n\tseq_input_event(sc, iev);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_input_event",
          "args": [
            "sc",
            "iev"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "seq_input_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "335-353",
          "snippet": "static int\nseq_input_event(sc, cmd)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *cmd;\n{\n\tstruct sequencer_queue *q = &sc->inq;\n\n\tDPRINTFN(2, (\"seq_input_event: %02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t     cmd->arr[0], cmd->arr[1], cmd->arr[2], cmd->arr[3],\n\t\t     cmd->arr[4], cmd->arr[5], cmd->arr[6], cmd->arr[7]));\n\tif (SEQ_QFULL(q))\n\t\treturn (ENOMEM);\n\tSEQ_QPUT(q, *cmd);\n\tseq_wakeup(&sc->rchan);\n\tselwakeup(&sc->rsel);\n\tif (sc->async)\n\t\tpsignal(sc->async, SIGIO);\n\treturn (0);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_input_event(sc, cmd)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *cmd;\n{\n\tstruct sequencer_queue *q = &sc->inq;\n\n\tDPRINTFN(2, (\"seq_input_event: %02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t     cmd->arr[0], cmd->arr[1], cmd->arr[2], cmd->arr[3],\n\t\t     cmd->arr[4], cmd->arr[5], cmd->arr[6], cmd->arr[7]));\n\tif (SEQ_QFULL(q))\n\t\treturn (ENOMEM);\n\tSEQ_QPUT(q, *cmd);\n\tseq_wakeup(&sc->rchan);\n\tselwakeup(&sc->rsel);\n\tif (sc->async)\n\t\tpsignal(sc->async, SIGIO);\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SUBTIMEVAL",
          "args": [
            "&now",
            "&sc->timer.start"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "microtime",
          "args": [
            "&now"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_event_intr(addr, iev)\n\tvoid *addr;\n\tseq_event_rec *iev;\n{\n\tstruct sequencer_softc *sc = addr;\n\tunion {\n\t\tu_int32_t l;\n\t\tu_int8_t b[4];\n\t} u;\n\tu_long t;\n\tstruct timeval now;\n\tseq_event_rec ev;\n\n\tmicrotime(&now);\n\tSUBTIMEVAL(&now, &sc->timer.start);\n\tt = now.tv_sec * 1000000 + now.tv_usec;\n\tt /= sc->timer.tick;\n\tif (t != sc->input_stamp) {\n\t\tev.arr[0] = SEQ_TIMING;\n\t\tev.arr[1] = TMR_WAIT_ABS;\n\t\tev.arr[2] = 0;\n\t\tev.arr[3] = 0;\n\t\tu.l = t;\n\t\tev.arr[4] = u.b[0];\n\t\tev.arr[5] = u.b[1];\n\t\tev.arr[6] = u.b[2];\n\t\tev.arr[7] = u.b[3];\n\t\tseq_input_event(sc, &ev);\n\t\tsc->input_stamp = t;\n\t}\n\tseq_input_event(sc, iev);\n}"
  },
  {
    "function_name": "seq_input_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "335-353",
    "snippet": "static int\nseq_input_event(sc, cmd)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *cmd;\n{\n\tstruct sequencer_queue *q = &sc->inq;\n\n\tDPRINTFN(2, (\"seq_input_event: %02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t     cmd->arr[0], cmd->arr[1], cmd->arr[2], cmd->arr[3],\n\t\t     cmd->arr[4], cmd->arr[5], cmd->arr[6], cmd->arr[7]));\n\tif (SEQ_QFULL(q))\n\t\treturn (ENOMEM);\n\tSEQ_QPUT(q, *cmd);\n\tseq_wakeup(&sc->rchan);\n\tselwakeup(&sc->rsel);\n\tif (sc->async)\n\t\tpsignal(sc->async, SIGIO);\n\treturn (0);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "psignal",
          "args": [
            "sc->async",
            "SIGIO"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selwakeup",
          "args": [
            "&sc->rsel"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_wakeup",
          "args": [
            "&sc->rchan"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "seq_wakeup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "251-260",
          "snippet": "static void\nseq_wakeup(chan)\n\tint *chan;\n{\n\tif (*chan) {\n\t\tDPRINTFN(5, (\"seq_wakeup: %p\\n\", chan));\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic void\nseq_wakeup(chan)\n\tint *chan;\n{\n\tif (*chan) {\n\t\tDPRINTFN(5, (\"seq_wakeup: %p\\n\", chan));\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QPUT",
          "args": [
            "q",
            "*cmd"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QFULL",
          "args": [
            "q"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "2",
            "(\"seq_input_event: %02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t     cmd->arr[0], cmd->arr[1], cmd->arr[2], cmd->arr[3],\n\t\t     cmd->arr[4], cmd->arr[5], cmd->arr[6], cmd->arr[7])"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_input_event(sc, cmd)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *cmd;\n{\n\tstruct sequencer_queue *q = &sc->inq;\n\n\tDPRINTFN(2, (\"seq_input_event: %02x %02x %02x %02x %02x %02x %02x %02x\\n\", \n\t\t     cmd->arr[0], cmd->arr[1], cmd->arr[2], cmd->arr[3],\n\t\t     cmd->arr[4], cmd->arr[5], cmd->arr[6], cmd->arr[7]));\n\tif (SEQ_QFULL(q))\n\t\treturn (ENOMEM);\n\tSEQ_QPUT(q, *cmd);\n\tseq_wakeup(&sc->rchan);\n\tselwakeup(&sc->rsel);\n\tif (sc->async)\n\t\tpsignal(sc->async, SIGIO);\n\treturn (0);\n}"
  },
  {
    "function_name": "sequencerclose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "309-333",
    "snippet": "int\nsequencerclose(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tint n, s;\n\n\tDPRINTF((\"sequencerclose: %p\\n\", sc));\n\n\tseq_drain(sc);\n\ts = splaudio();\n\tif (sc->timeout) {\n\t\tuntimeout(seq_timeout, sc);\n\t\tsc->timeout = 0;\n\t}\n\tsplx(s);\n\n\tfor (n = 0; n < sc->nmidi; n++)\n\t\tmidiseq_close(sc->devs[n]);\n\tfree(sc->devs, M_DEVBUF);\n\tsc->isopen = 0;\n\treturn (0);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "sc->devs",
            "M_DEVBUF"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "audio_free_ring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "493-503",
          "snippet": "void\naudio_free_ring(sc, r)\n\tstruct audio_softc *sc;\n\tstruct audio_ringbuffer *r;\n{\n\tif (sc->hw_if->freem) {\n\t    sc->hw_if->freem(sc->hw_hdl, r->start, M_DEVBUF);\n\t} else {\n\t    free(r->start, M_DEVBUF);\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nvoid\naudio_free_ring(sc, r)\n\tstruct audio_softc *sc;\n\tstruct audio_ringbuffer *r;\n{\n\tif (sc->hw_if->freem) {\n\t    sc->hw_if->freem(sc->hw_hdl, r->start, M_DEVBUF);\n\t} else {\n\t    free(r->start, M_DEVBUF);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "midiseq_close",
          "args": [
            "sc->devs[n]"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1117-1124",
          "snippet": "void\nmidiseq_close(md)\n\tstruct midi_dev *md;\n{\n\tDPRINTFN(2, (\"midiseq_close: %d\\n\", md->unit));\n\tmidiclose(makedev(0, md->unit), 0, 0, 0);\n\tfree(md, M_DEVBUF);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidiseq_close(md)\n\tstruct midi_dev *md;\n{\n\tDPRINTFN(2, (\"midiseq_close: %d\\n\", md->unit));\n\tmidiclose(makedev(0, md->unit), 0, 0, 0);\n\tfree(md, M_DEVBUF);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "untimeout",
          "args": [
            "seq_timeout",
            "sc"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_drain",
          "args": [
            "sc"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "seq_drain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "262-274",
          "snippet": "int\nseq_drain(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint error;\n\n\tDPRINTFN(3, (\"seq_drain: %p, len=%d\\n\", sc, SEQ_QLEN(&sc->outq)));\n\tseq_startoutput(sc);\n\terror = 0;\n\twhile(!SEQ_QEMPTY(&sc->outq) && !error)\n\t\terror = seq_sleep_timo(&sc->wchan, \"seq_dr\", 60*hz);\n\treturn (error);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_drain(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint error;\n\n\tDPRINTFN(3, (\"seq_drain: %p, len=%d\\n\", sc, SEQ_QLEN(&sc->outq)));\n\tseq_startoutput(sc);\n\terror = 0;\n\twhile(!SEQ_QEMPTY(&sc->outq) && !error)\n\t\terror = seq_sleep_timo(&sc->wchan, \"seq_dr\", 60*hz);\n\treturn (error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"sequencerclose: %p\\n\", sc)"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQUENCERUNIT",
          "args": [
            "dev"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nsequencerclose(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\tstruct sequencer_softc *sc = &seqdevs[SEQUENCERUNIT(dev)];\n\tint n, s;\n\n\tDPRINTF((\"sequencerclose: %p\\n\", sc));\n\n\tseq_drain(sc);\n\ts = splaudio();\n\tif (sc->timeout) {\n\t\tuntimeout(seq_timeout, sc);\n\t\tsc->timeout = 0;\n\t}\n\tsplx(s);\n\n\tfor (n = 0; n < sc->nmidi; n++)\n\t\tmidiseq_close(sc->devs[n]);\n\tfree(sc->devs, M_DEVBUF);\n\tsc->isopen = 0;\n\treturn (0);\n}"
  },
  {
    "function_name": "seq_startoutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "293-307",
    "snippet": "void\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_do_command",
          "args": [
            "sc",
            "&cmd"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_command",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "678-709",
          "snippet": "int\nseq_do_command(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev;\n\n\tDPRINTFN(4, (\"seq_do_command: %p cmd=0x%02x\\n\", sc, SEQ_CMD(b)));\n\n\tswitch(SEQ_CMD(b)) {\n\tcase SEQ_LOCAL:\n\t\treturn (seq_do_local(sc, b));\n\tcase SEQ_TIMING:\n\t\treturn (seq_do_timing(sc, b));\n\tcase SEQ_CHN_VOICE:\n\t\treturn (seq_do_chnvoice(sc, b));\n\tcase SEQ_CHN_COMMON:\n\t\treturn (seq_do_chncommon(sc, b));\n\tcase SEQ_SYSEX:\n\t\treturn (seq_do_sysex(sc, b));\n\t/* COMPAT */\n\tcase SEQOLD_MIDIPUTC:\n\t\tdev = b->arr[2];\n\t\tif (dev < 0 || dev >= sc->nmidi)\n\t\t\treturn (ENXIO);\n\t\treturn (midiseq_putc(sc->devs[dev], b->arr[1]));\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_command: unimpl command %02x\\n\", \n\t\t\t     SEQ_CMD(b)));\n\t\treturn (EINVAL);\n\t}\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_command(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tint dev;\n\n\tDPRINTFN(4, (\"seq_do_command: %p cmd=0x%02x\\n\", sc, SEQ_CMD(b)));\n\n\tswitch(SEQ_CMD(b)) {\n\tcase SEQ_LOCAL:\n\t\treturn (seq_do_local(sc, b));\n\tcase SEQ_TIMING:\n\t\treturn (seq_do_timing(sc, b));\n\tcase SEQ_CHN_VOICE:\n\t\treturn (seq_do_chnvoice(sc, b));\n\tcase SEQ_CHN_COMMON:\n\t\treturn (seq_do_chncommon(sc, b));\n\tcase SEQ_SYSEX:\n\t\treturn (seq_do_sysex(sc, b));\n\t/* COMPAT */\n\tcase SEQOLD_MIDIPUTC:\n\t\tdev = b->arr[2];\n\t\tif (dev < 0 || dev >= sc->nmidi)\n\t\t\treturn (ENXIO);\n\t\treturn (midiseq_putc(sc->devs[dev], b->arr[1]));\n\tdefault:\n\t\tDPRINTFN(-1,(\"seq_do_command: unimpl command %02x\\n\", \n\t\t\t     SEQ_CMD(b)));\n\t\treturn (EINVAL);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QGET",
          "args": [
            "q",
            "cmd"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QEMPTY",
          "args": [
            "q"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "4",
            "(\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q))"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QLEN",
          "args": [
            "q"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}"
  },
  {
    "function_name": "seq_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "276-291",
    "snippet": "void\nseq_timeout(addr)\n\tvoid *addr;\n{\n\tstruct sequencer_softc *sc = addr;\n\tDPRINTFN(4, (\"seq_timeout: %p\\n\", sc));\n\tsc->timeout = 0;\n\tseq_startoutput(sc);\n\tif (SEQ_QLEN(&sc->outq) < sc->lowat) {\n\t\tseq_wakeup(&sc->wchan);\n\t\tselwakeup(&sc->wsel);\n\t\tif (sc->async)\n\t\t\tpsignal(sc->async, SIGIO);\n\t}\n\t\t\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "psignal",
          "args": [
            "sc->async",
            "SIGIO"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selwakeup",
          "args": [
            "&sc->wsel"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_wakeup",
          "args": [
            "&sc->wchan"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "seq_wakeup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "251-260",
          "snippet": "static void\nseq_wakeup(chan)\n\tint *chan;\n{\n\tif (*chan) {\n\t\tDPRINTFN(5, (\"seq_wakeup: %p\\n\", chan));\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic void\nseq_wakeup(chan)\n\tint *chan;\n{\n\tif (*chan) {\n\t\tDPRINTFN(5, (\"seq_wakeup: %p\\n\", chan));\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QLEN",
          "args": [
            "&sc->outq"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_startoutput",
          "args": [
            "sc"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "seq_startoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "293-307",
          "snippet": "void\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "4",
            "(\"seq_timeout: %p\\n\", sc)"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_timeout(addr)\n\tvoid *addr;\n{\n\tstruct sequencer_softc *sc = addr;\n\tDPRINTFN(4, (\"seq_timeout: %p\\n\", sc));\n\tsc->timeout = 0;\n\tseq_startoutput(sc);\n\tif (SEQ_QLEN(&sc->outq) < sc->lowat) {\n\t\tseq_wakeup(&sc->wchan);\n\t\tselwakeup(&sc->wsel);\n\t\tif (sc->async)\n\t\t\tpsignal(sc->async, SIGIO);\n\t}\n\t\t\n}"
  },
  {
    "function_name": "seq_drain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "262-274",
    "snippet": "int\nseq_drain(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint error;\n\n\tDPRINTFN(3, (\"seq_drain: %p, len=%d\\n\", sc, SEQ_QLEN(&sc->outq)));\n\tseq_startoutput(sc);\n\terror = 0;\n\twhile(!SEQ_QEMPTY(&sc->outq) && !error)\n\t\terror = seq_sleep_timo(&sc->wchan, \"seq_dr\", 60*hz);\n\treturn (error);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_sleep_timo",
          "args": [
            "&sc->wchan",
            "\"seq_dr\"",
            "60*hz"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "seq_sleep_timo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "221-241",
          "snippet": "static int\nseq_sleep_timo(chan, label, timo)\n\tint *chan;\n\tchar *label;\n\tint timo;\n{\n\tint st;\n\n\tif (!label)\n\t\tlabel = \"seq\";\n\n\tDPRINTFN(5, (\"seq_sleep_timo: %p %s %d\\n\", chan, label, timo));\n\t*chan = 1;\n\tst = tsleep(chan, PWAIT | PCATCH, label, timo);\n\t*chan = 0;\n#ifdef MIDI_DEBUG\n\tif (st != 0)\n\t    printf(\"seq_sleep: %d\\n\", st);\n#endif\n\treturn (st);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_sleep_timo(chan, label, timo)\n\tint *chan;\n\tchar *label;\n\tint timo;\n{\n\tint st;\n\n\tif (!label)\n\t\tlabel = \"seq\";\n\n\tDPRINTFN(5, (\"seq_sleep_timo: %p %s %d\\n\", chan, label, timo));\n\t*chan = 1;\n\tst = tsleep(chan, PWAIT | PCATCH, label, timo);\n\t*chan = 0;\n#ifdef MIDI_DEBUG\n\tif (st != 0)\n\t    printf(\"seq_sleep: %d\\n\", st);\n#endif\n\treturn (st);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QEMPTY",
          "args": [
            "&sc->outq"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_startoutput",
          "args": [
            "sc"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "seq_startoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "293-307",
          "snippet": "void\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nseq_startoutput(sc)\n\tstruct sequencer_softc *sc;\n{\n\tstruct sequencer_queue *q = &sc->outq;\n\tseq_event_rec cmd;\n\n\tif (sc->timeout)\n\t\treturn;\n\tDPRINTFN(4, (\"seq_startoutput: %p, len=%d\\n\", sc, SEQ_QLEN(q)));\n\twhile(!SEQ_QEMPTY(q) && !sc->timeout) {\n\t\tSEQ_QGET(q, cmd);\n\t\tseq_do_command(sc, &cmd);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "3",
            "(\"seq_drain: %p, len=%d\\n\", sc, SEQ_QLEN(&sc->outq))"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QLEN",
          "args": [
            "&sc->outq"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_drain(sc)\n\tstruct sequencer_softc *sc;\n{\n\tint error;\n\n\tDPRINTFN(3, (\"seq_drain: %p, len=%d\\n\", sc, SEQ_QLEN(&sc->outq)));\n\tseq_startoutput(sc);\n\terror = 0;\n\twhile(!SEQ_QEMPTY(&sc->outq) && !error)\n\t\terror = seq_sleep_timo(&sc->wchan, \"seq_dr\", 60*hz);\n\treturn (error);\n}"
  },
  {
    "function_name": "seq_wakeup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "251-260",
    "snippet": "static void\nseq_wakeup(chan)\n\tint *chan;\n{\n\tif (*chan) {\n\t\tDPRINTFN(5, (\"seq_wakeup: %p\\n\", chan));\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wakeup",
          "args": [
            "chan"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "seq_wakeup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "251-260",
          "snippet": "static void\nseq_wakeup(chan)\n\tint *chan;\n{\n\tif (*chan) {\n\t\tDPRINTFN(5, (\"seq_wakeup: %p\\n\", chan));\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "5",
            "(\"seq_wakeup: %p\\n\", chan)"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic void\nseq_wakeup(chan)\n\tint *chan;\n{\n\tif (*chan) {\n\t\tDPRINTFN(5, (\"seq_wakeup: %p\\n\", chan));\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}"
  },
  {
    "function_name": "seq_sleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "243-249",
    "snippet": "static int\nseq_sleep(chan, label)\n\tint *chan;\n\tchar *label;\n{\n\treturn (seq_sleep_timo(chan, label, 0));\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_sleep_timo",
          "args": [
            "chan",
            "label",
            "0"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "seq_sleep_timo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "221-241",
          "snippet": "static int\nseq_sleep_timo(chan, label, timo)\n\tint *chan;\n\tchar *label;\n\tint timo;\n{\n\tint st;\n\n\tif (!label)\n\t\tlabel = \"seq\";\n\n\tDPRINTFN(5, (\"seq_sleep_timo: %p %s %d\\n\", chan, label, timo));\n\t*chan = 1;\n\tst = tsleep(chan, PWAIT | PCATCH, label, timo);\n\t*chan = 0;\n#ifdef MIDI_DEBUG\n\tif (st != 0)\n\t    printf(\"seq_sleep: %d\\n\", st);\n#endif\n\treturn (st);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_sleep_timo(chan, label, timo)\n\tint *chan;\n\tchar *label;\n\tint timo;\n{\n\tint st;\n\n\tif (!label)\n\t\tlabel = \"seq\";\n\n\tDPRINTFN(5, (\"seq_sleep_timo: %p %s %d\\n\", chan, label, timo));\n\t*chan = 1;\n\tst = tsleep(chan, PWAIT | PCATCH, label, timo);\n\t*chan = 0;\n#ifdef MIDI_DEBUG\n\tif (st != 0)\n\t    printf(\"seq_sleep: %d\\n\", st);\n#endif\n\treturn (st);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_sleep(chan, label)\n\tint *chan;\n\tchar *label;\n{\n\treturn (seq_sleep_timo(chan, label, 0));\n}"
  },
  {
    "function_name": "seq_sleep_timo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "221-241",
    "snippet": "static int\nseq_sleep_timo(chan, label, timo)\n\tint *chan;\n\tchar *label;\n\tint timo;\n{\n\tint st;\n\n\tif (!label)\n\t\tlabel = \"seq\";\n\n\tDPRINTFN(5, (\"seq_sleep_timo: %p %s %d\\n\", chan, label, timo));\n\t*chan = 1;\n\tst = tsleep(chan, PWAIT | PCATCH, label, timo);\n\t*chan = 0;\n#ifdef MIDI_DEBUG\n\tif (st != 0)\n\t    printf(\"seq_sleep: %d\\n\", st);\n#endif\n\treturn (st);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"seq_sleep: %d\\n\"",
            "st"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "tsleep",
          "args": [
            "chan",
            "PWAIT | PCATCH",
            "label",
            "timo"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTFN",
          "args": [
            "5",
            "(\"seq_sleep_timo: %p %s %d\\n\", chan, label, timo)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nstatic int\nseq_sleep_timo(chan, label, timo)\n\tint *chan;\n\tchar *label;\n\tint timo;\n{\n\tint st;\n\n\tif (!label)\n\t\tlabel = \"seq\";\n\n\tDPRINTFN(5, (\"seq_sleep_timo: %p %s %d\\n\", chan, label, timo));\n\t*chan = 1;\n\tst = tsleep(chan, PWAIT | PCATCH, label, timo);\n\t*chan = 0;\n#ifdef MIDI_DEBUG\n\tif (st != 0)\n\t    printf(\"seq_sleep: %d\\n\", st);\n#endif\n\treturn (st);\n}"
  },
  {
    "function_name": "sequenceropen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "161-219",
    "snippet": "int\nsequenceropen(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\tint unit = SEQUENCERUNIT(dev);\n\tstruct sequencer_softc *sc;\n\tstruct midi_dev *md;\n\tint nmidi;\n\n\tDPRINTF((\"sequenceropen\\n\"));\n\n\tif (unit >= NSEQUENCER)\n\t\treturn (ENXIO);\n\tsc = &seqdevs[unit];\n\tif (sc->isopen)\n\t\treturn (EBUSY);\n\tif (SEQ_IS_OLD(unit))\n\t\tsc->mode = SEQ_OLD;\n\telse\n\t\tsc->mode = SEQ_NEW;\n\tsc->isopen++;\n\tsc->flags = flags & (FREAD|FWRITE);\n\tsc->rchan = 0;\n\tsc->wchan = 0;\n\tsc->pbus = 0;\n\tsc->async = 0;\n\tsc->input_stamp = ~0;\n\n\tsc->nmidi = 0;\n\tnmidi = midi_unit_count();\n\n\tsc->devs = malloc(nmidi * sizeof(struct midi_dev *),\n\t\t\t  M_DEVBUF, M_WAITOK);\n\tfor (unit = 0; unit < nmidi; unit++) {\n\t\tmd = midiseq_open(unit, flags);\n\t\tif (md) {\n\t\t\tsc->devs[sc->nmidi++] = md;\n\t\t\tmd->seq = sc;\n\t\t}\n\t}\n\n\tsc->timer.timebase = 100;\n\tsc->timer.tempo = 60;\n\tsc->doingsysex = 0;\n\tRECALC_TICK(&sc->timer);\n\tsc->timer.last = 0;\n\tmicrotime(&sc->timer.start);\n\n\tSEQ_QINIT(&sc->inq);\n\tSEQ_QINIT(&sc->outq);\n\tsc->lowat = SEQ_MAXQ / 2;\n\n\tseq_reset(sc);\n\n\tDPRINTF((\"sequenceropen: mode=%d, nmidi=%d\\n\", sc->mode, sc->nmidi));\n\treturn (0);\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"sequenceropen: mode=%d, nmidi=%d\\n\", sc->mode, sc->nmidi)"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_reset",
          "args": [
            "sc"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "midiseq_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1126-1132",
          "snippet": "void\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nmidiseq_reset(md)\n\tstruct midi_dev *md;\n{\n\t/* XXX send GM reset? */\n\tDPRINTFN(3, (\"midiseq_reset: %d\\n\", md->unit));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_QINIT",
          "args": [
            "&sc->outq"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQ_QINIT",
          "args": [
            "&sc->inq"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "microtime",
          "args": [
            "&sc->timer.start"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RECALC_TICK",
          "args": [
            "&sc->timer"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "midiseq_open",
          "args": [
            "unit",
            "flags"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "nmidi * sizeof(struct midi_dev *)",
            "M_DEVBUF",
            "M_WAITOK"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "midi_unit_count",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "midi_unit_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "1340-1344",
          "snippet": "int\nmidi_unit_count()\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nmidi_unit_count()\n{\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SEQ_IS_OLD",
          "args": [
            "unit"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"sequenceropen\\n\")"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEQUENCERUNIT",
          "args": [
            "dev"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nsequenceropen(dev, flags, ifmt, p)\n\tdev_t dev;\n\tint flags, ifmt;\n\tstruct proc *p;\n{\n\tint unit = SEQUENCERUNIT(dev);\n\tstruct sequencer_softc *sc;\n\tstruct midi_dev *md;\n\tint nmidi;\n\n\tDPRINTF((\"sequenceropen\\n\"));\n\n\tif (unit >= NSEQUENCER)\n\t\treturn (ENXIO);\n\tsc = &seqdevs[unit];\n\tif (sc->isopen)\n\t\treturn (EBUSY);\n\tif (SEQ_IS_OLD(unit))\n\t\tsc->mode = SEQ_OLD;\n\telse\n\t\tsc->mode = SEQ_NEW;\n\tsc->isopen++;\n\tsc->flags = flags & (FREAD|FWRITE);\n\tsc->rchan = 0;\n\tsc->wchan = 0;\n\tsc->pbus = 0;\n\tsc->async = 0;\n\tsc->input_stamp = ~0;\n\n\tsc->nmidi = 0;\n\tnmidi = midi_unit_count();\n\n\tsc->devs = malloc(nmidi * sizeof(struct midi_dev *),\n\t\t\t  M_DEVBUF, M_WAITOK);\n\tfor (unit = 0; unit < nmidi; unit++) {\n\t\tmd = midiseq_open(unit, flags);\n\t\tif (md) {\n\t\t\tsc->devs[sc->nmidi++] = md;\n\t\t\tmd->seq = sc;\n\t\t}\n\t}\n\n\tsc->timer.timebase = 100;\n\tsc->timer.tempo = 60;\n\tsc->doingsysex = 0;\n\tRECALC_TICK(&sc->timer);\n\tsc->timer.last = 0;\n\tmicrotime(&sc->timer.start);\n\n\tSEQ_QINIT(&sc->inq);\n\tSEQ_QINIT(&sc->outq);\n\tsc->lowat = SEQ_MAXQ / 2;\n\n\tseq_reset(sc);\n\n\tDPRINTF((\"sequenceropen: mode=%d, nmidi=%d\\n\", sc->mode, sc->nmidi));\n\treturn (0);\n}"
  },
  {
    "function_name": "sequencerattach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
    "lines": "155-159",
    "snippet": "void\nsequencerattach(n)\n\tint n;\n{\n}",
    "includes": [
      "#include \"midi.h\"",
      "#include <dev/sequencervar.h>",
      "#include <dev/midivar.h>",
      "#include <dev/midi_if.h>",
      "#include <sys/device.h>",
      "#include <sys/midiio.h>",
      "#include <sys/audioio.h>",
      "#include <sys/conf.h>",
      "#include <sys/signalvar.h>",
      "#include <sys/kernel.h>",
      "#include <sys/syslog.h>",
      "#include <sys/systm.h>",
      "#include <sys/proc.h>",
      "#include <sys/malloc.h>",
      "#include <sys/poll.h>",
      "#include <sys/select.h>",
      "#include <sys/vnode.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/param.h>",
      "#include \"sequencer.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nvoid\nsequencerattach(n)\n\tint n;\n{\n}"
  }
]