[
  {
    "function_name": "rf_FreeReconEventDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_revent.c",
    "lines": "214-219",
    "snippet": "void \nrf_FreeReconEventDesc(event)\n\tRF_ReconEvent_t *event;\n{\n\tRF_FREELIST_FREE(rf_revent_freelist, event, next);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_desc.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_revent.h\"",
      "#include \"rf_raid.h\"",
      "#include <sys/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static RF_FreeList_t *rf_revent_freelist;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_FREELIST_FREE",
          "args": [
            "rf_revent_freelist",
            "event",
            "next"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_desc.h\"\n#include \"rf_freelist.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_revent.h\"\n#include \"rf_raid.h\"\n#include <sys/errno.h>\n\nstatic RF_FreeList_t *rf_revent_freelist;\n\nvoid \nrf_FreeReconEventDesc(event)\n\tRF_ReconEvent_t *event;\n{\n\tRF_FREELIST_FREE(rf_revent_freelist, event, next);\n}"
  },
  {
    "function_name": "rf_CauseReconEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_revent.c",
    "lines": "169-194",
    "snippet": "void \nrf_CauseReconEvent(raidPtr, row, col, arg, type)\n\tRF_Raid_t *raidPtr;\n\tRF_RowCol_t row;\n\tRF_RowCol_t col;\n\tvoid   *arg;\n\tRF_Revent_t type;\n{\n\tRF_ReconCtrl_t *rctrl = raidPtr->reconControl[row];\n\tRF_ReconEvent_t *event = GetReconEventDesc(row, col, arg, type);\n\n\tif (type == RF_REVENT_BUFCLEAR) {\n\t\tRF_ASSERT(col != rctrl->fcol);\n\t}\n\tRF_ASSERT(row >= 0 && row <= raidPtr->numRow && col >= 0 && col <= raidPtr->numCol);\n\tRF_LOCK_MUTEX(rctrl->eq_mutex);\n\tRF_ASSERT((rctrl->eventQueue == NULL) == (rctrl->eq_count == 0));\t/* q null and count==0\n\t\t\t\t\t\t\t\t\t\t * must be equivalent\n\t\t\t\t\t\t\t\t\t\t * conditions */\n\tevent->next = rctrl->eventQueue;\n\trctrl->eventQueue = event;\n\trctrl->eq_count++;\n\tRF_UNLOCK_MUTEX(rctrl->eq_mutex);\n\n\tDO_SIGNAL(rctrl);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_desc.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_revent.h\"",
      "#include \"rf_raid.h\"",
      "#include <sys/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static RF_ReconEvent_t *\nGetReconEventDesc(RF_RowCol_t row, RF_RowCol_t col,\n    void *arg, RF_Revent_t type);",
      "RF_RowCol_t row;",
      "static RF_ReconEvent_t *\nGetReconEventDesc(row, col, arg, type)\n\tRF_RowCol_t row;",
      "RF_RowCol_t col;",
      "void   *arg;",
      "RF_Revent_t type;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DO_SIGNAL",
          "args": [
            "rctrl"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_UNLOCK_MUTEX",
          "args": [
            "rctrl->eq_mutex"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "(rctrl->eventQueue == NULL) == (rctrl->eq_count == 0)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_LOCK_MUTEX",
          "args": [
            "rctrl->eq_mutex"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "row >= 0 && row <= raidPtr->numRow && col >= 0 && col <= raidPtr->numCol"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "col != rctrl->fcol"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetReconEventDesc",
          "args": [
            "row",
            "col",
            "arg",
            "type"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_desc.h\"\n#include \"rf_freelist.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_revent.h\"\n#include \"rf_raid.h\"\n#include <sys/errno.h>\n\nstatic RF_ReconEvent_t *\nGetReconEventDesc(RF_RowCol_t row, RF_RowCol_t col,\n    void *arg, RF_Revent_t type);\nRF_RowCol_t row;\nstatic RF_ReconEvent_t *\nGetReconEventDesc(row, col, arg, type)\n\tRF_RowCol_t row;\nRF_RowCol_t col;\nvoid   *arg;\nRF_Revent_t type;\n\nvoid \nrf_CauseReconEvent(raidPtr, row, col, arg, type)\n\tRF_Raid_t *raidPtr;\n\tRF_RowCol_t row;\n\tRF_RowCol_t col;\n\tvoid   *arg;\n\tRF_Revent_t type;\n{\n\tRF_ReconCtrl_t *rctrl = raidPtr->reconControl[row];\n\tRF_ReconEvent_t *event = GetReconEventDesc(row, col, arg, type);\n\n\tif (type == RF_REVENT_BUFCLEAR) {\n\t\tRF_ASSERT(col != rctrl->fcol);\n\t}\n\tRF_ASSERT(row >= 0 && row <= raidPtr->numRow && col >= 0 && col <= raidPtr->numCol);\n\tRF_LOCK_MUTEX(rctrl->eq_mutex);\n\tRF_ASSERT((rctrl->eventQueue == NULL) == (rctrl->eq_count == 0));\t/* q null and count==0\n\t\t\t\t\t\t\t\t\t\t * must be equivalent\n\t\t\t\t\t\t\t\t\t\t * conditions */\n\tevent->next = rctrl->eventQueue;\n\trctrl->eventQueue = event;\n\trctrl->eq_count++;\n\tRF_UNLOCK_MUTEX(rctrl->eq_mutex);\n\n\tDO_SIGNAL(rctrl);\n}"
  },
  {
    "function_name": "rf_ConfigureReconEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_revent.c",
    "lines": "72-92",
    "snippet": "int \nrf_ConfigureReconEvent(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\tRF_FREELIST_CREATE(rf_revent_freelist, RF_MAX_FREE_REVENT,\n\t    RF_REVENT_INC, sizeof(RF_ReconEvent_t));\n\tif (rf_revent_freelist == NULL)\n\t\treturn (ENOMEM);\n\trc = rf_ShutdownCreate(listp, rf_ShutdownReconEvent, NULL);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to add to shutdown list file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\trf_ShutdownReconEvent(NULL);\n\t\treturn (rc);\n\t}\n\tRF_FREELIST_PRIME(rf_revent_freelist, RF_REVENT_INITIAL, next,\n\t    (RF_ReconEvent_t *));\n\treturn (0);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_desc.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_revent.h\"",
      "#include \"rf_raid.h\"",
      "#include <sys/errno.h>"
    ],
    "macros_used": [
      "#define RF_REVENT_INITIAL    8",
      "#define RF_REVENT_INC        8",
      "#define RF_MAX_FREE_REVENT 128"
    ],
    "globals_used": [
      "static RF_FreeList_t *rf_revent_freelist;",
      "static void rf_ShutdownReconEvent(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_FREELIST_PRIME",
          "args": [
            "rf_revent_freelist",
            "RF_REVENT_INITIAL",
            "next",
            "(RF_ReconEvent_t *)"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_ShutdownReconEvent",
          "args": [
            "NULL"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "rf_ShutdownReconEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_revent.c",
          "lines": "65-70",
          "snippet": "static void\nrf_ShutdownReconEvent(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY(rf_revent_freelist, next, (RF_ReconEvent_t *));\n}",
          "includes": [
            "#include <sys/proc.h>",
            "#include \"rf_shutdown.h\"",
            "#include \"rf_desc.h\"",
            "#include \"rf_freelist.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_etimer.h\"",
            "#include \"rf_revent.h\"",
            "#include \"rf_raid.h\"",
            "#include <sys/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static RF_FreeList_t *rf_revent_freelist;",
            "static void rf_ShutdownReconEvent(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_desc.h\"\n#include \"rf_freelist.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_revent.h\"\n#include \"rf_raid.h\"\n#include <sys/errno.h>\n\nstatic RF_FreeList_t *rf_revent_freelist;\nstatic void rf_ShutdownReconEvent(void *);\n\nstatic void\nrf_ShutdownReconEvent(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY(rf_revent_freelist, next, (RF_ReconEvent_t *));\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG3",
          "args": [
            "\"Unable to add to shutdown list file %s line %d rc=%d\\n\"",
            "__FILE__",
            "__LINE__",
            "rc"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_ShutdownCreate",
          "args": [
            "listp",
            "rf_ShutdownReconEvent",
            "NULL"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_FREELIST_CREATE",
          "args": [
            "rf_revent_freelist",
            "RF_MAX_FREE_REVENT",
            "RF_REVENT_INC",
            "sizeof(RF_ReconEvent_t)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_desc.h\"\n#include \"rf_freelist.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_revent.h\"\n#include \"rf_raid.h\"\n#include <sys/errno.h>\n\n#define RF_REVENT_INITIAL    8\n#define RF_REVENT_INC        8\n#define RF_MAX_FREE_REVENT 128\n\nstatic RF_FreeList_t *rf_revent_freelist;\nstatic void rf_ShutdownReconEvent(void *);\n\nint \nrf_ConfigureReconEvent(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\tRF_FREELIST_CREATE(rf_revent_freelist, RF_MAX_FREE_REVENT,\n\t    RF_REVENT_INC, sizeof(RF_ReconEvent_t));\n\tif (rf_revent_freelist == NULL)\n\t\treturn (ENOMEM);\n\trc = rf_ShutdownCreate(listp, rf_ShutdownReconEvent, NULL);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to add to shutdown list file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\trf_ShutdownReconEvent(NULL);\n\t\treturn (rc);\n\t}\n\tRF_FREELIST_PRIME(rf_revent_freelist, RF_REVENT_INITIAL, next,\n\t    (RF_ReconEvent_t *));\n\treturn (0);\n}"
  },
  {
    "function_name": "rf_ShutdownReconEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_revent.c",
    "lines": "65-70",
    "snippet": "static void\nrf_ShutdownReconEvent(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY(rf_revent_freelist, next, (RF_ReconEvent_t *));\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_desc.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_revent.h\"",
      "#include \"rf_raid.h\"",
      "#include <sys/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static RF_FreeList_t *rf_revent_freelist;",
      "static void rf_ShutdownReconEvent(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_FREELIST_DESTROY",
          "args": [
            "rf_revent_freelist",
            "next",
            "(RF_ReconEvent_t *)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_desc.h\"\n#include \"rf_freelist.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_revent.h\"\n#include \"rf_raid.h\"\n#include <sys/errno.h>\n\nstatic RF_FreeList_t *rf_revent_freelist;\nstatic void rf_ShutdownReconEvent(void *);\n\nstatic void\nrf_ShutdownReconEvent(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY(rf_revent_freelist, next, (RF_ReconEvent_t *));\n}"
  }
]