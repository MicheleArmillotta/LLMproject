[
  {
    "function_name": "le_tc_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_tc.c",
    "lines": "81-112",
    "snippet": "void\nle_tc_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct le_softc *lesc = (void *)self;\n\tregister struct am7990_softc *sc = &lesc->sc_am7990;\n\tstruct tc_attach_args *d = aux;\n\n\t/*\n\t * It's on the turbochannel proper, or a kn02\n\t * baseboard implementation of a TC option card.\n\t */\n\tlesc->sc_r1 = (struct lereg1 *)(d->ta_addr + LE_OFFSET_LANCE);\n\tsc->sc_mem = (void *)(d->ta_addr + LE_OFFSET_RAM);\n\n\tsc->sc_copytodesc = am7990_copytobuf_contig;\n\tsc->sc_copyfromdesc = am7990_copyfrombuf_contig;\n\tsc->sc_copytobuf = am7990_copytobuf_contig;\n\tsc->sc_copyfrombuf = am7990_copyfrombuf_contig;\n\tsc->sc_zerobuf = am7990_zerobuf_contig;\n\n\t/*\n\t * TC lance boards have onboard SRAM buffers.  DMA\n\t * between the onbard RAM and main memory is not possible,\n\t * so  DMA setup is not required.\n\t */\n\n\tdec_le_common_attach(sc, (u_char *)(d->ta_addr + LE_OFFSET_ROM + 2));\n\n\ttc_intr_establish(parent, d->ta_cookie, TC_IPL_NET, am7990_intr, sc);\n}",
    "includes": [
      "#include <dev/tc/tcvar.h>",
      "#include <dev/tc/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tLE_OFFSET_ROM\t\t0x1c0000",
      "#define\tLE_OFFSET_LANCE\t\t0x100000",
      "#define\tLE_OFFSET_RAM\t\t0x0"
    ],
    "globals_used": [
      "void\tle_tc_attach"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "tc_intr_establish",
          "args": [
            "parent",
            "d->ta_cookie",
            "TC_IPL_NET",
            "am7990_intr",
            "sc"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "tc_intr_establish",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/tc.c",
          "lines": "276-287",
          "snippet": "void\ntc_intr_establish(dev, cookie, level, handler, arg)\n\tstruct device *dev;\n\tvoid *cookie, *arg;\n\ttc_intrlevel_t level;\n\tint (*handler) __P((void *));\n{\n\tstruct tc_softc *sc = (struct tc_softc *)dev;\n\n\t(*sc->sc_intr_establish)(sc->sc_dv.dv_parent, cookie, level,\n\t    handler, arg);\n}",
          "includes": [
            "#include <dev/tc/tcdevs_data.h>",
            "#include <machine/autoconf.h>\t/* for the proto of badaddr() */",
            "#include <dev/tc/tcdevs.h>",
            "#include <dev/tc/tcvar.h>",
            "#include <dev/tc/tcreg.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/tc/tcdevs_data.h>\n#include <machine/autoconf.h>\t/* for the proto of badaddr() */\n#include <dev/tc/tcdevs.h>\n#include <dev/tc/tcvar.h>\n#include <dev/tc/tcreg.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\ntc_intr_establish(dev, cookie, level, handler, arg)\n\tstruct device *dev;\n\tvoid *cookie, *arg;\n\ttc_intrlevel_t level;\n\tint (*handler) __P((void *));\n{\n\tstruct tc_softc *sc = (struct tc_softc *)dev;\n\n\t(*sc->sc_intr_establish)(sc->sc_dv.dv_parent, cookie, level,\n\t    handler, arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dec_le_common_attach",
          "args": [
            "sc",
            "(u_char *)(d->ta_addr + LE_OFFSET_ROM + 2)"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "dec_le_common_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_dec.c",
          "lines": "74-98",
          "snippet": "void\ndec_le_common_attach(sc, eap)\n\tstruct am7990_softc *sc;\n\tu_char *eap;\n{\n\tint i;\n\n\tsc->sc_rdcsr = le_dec_rdcsr;\n\tsc->sc_wrcsr = le_dec_wrcsr;\n\tsc->sc_hwinit = NULL;\n\n\tsc->sc_conf3 = 0;\n\tsc->sc_addr = 0;\n\tsc->sc_memsize = 65536;\n\n\t/*\n\t * Get the ethernet address out of rom\n\t */\n\tfor (i = 0; i < sizeof(sc->sc_arpcom.ac_enaddr); i++) {\n\t\tsc->sc_arpcom.ac_enaddr[i] = *eap;\n\t\teap += 4;\n\t}\n\n\tam7990_config(sc);\n}",
          "includes": [
            "#include <dev/tc/tcvar.h>",
            "#include <dev/tc/if_levar.h>",
            "#include <dev/ic/am7990var.h>",
            "#include <dev/ic/am7990reg.h>",
            "#include <netinet/if_ether.h>",
            "#include <netinet/in.h>",
            "#include <net/if_media.h>",
            "#include <net/if.h>",
            "#include <sys/device.h>",
            "#include <sys/socket.h>",
            "#include <sys/syslog.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include \"bpfilter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"bpfilter.h\"\n\nvoid\ndec_le_common_attach(sc, eap)\n\tstruct am7990_softc *sc;\n\tu_char *eap;\n{\n\tint i;\n\n\tsc->sc_rdcsr = le_dec_rdcsr;\n\tsc->sc_wrcsr = le_dec_wrcsr;\n\tsc->sc_hwinit = NULL;\n\n\tsc->sc_conf3 = 0;\n\tsc->sc_addr = 0;\n\tsc->sc_memsize = 65536;\n\n\t/*\n\t * Get the ethernet address out of rom\n\t */\n\tfor (i = 0; i < sizeof(sc->sc_arpcom.ac_enaddr); i++) {\n\t\tsc->sc_arpcom.ac_enaddr[i] = *eap;\n\t\teap += 4;\n\t}\n\n\tam7990_config(sc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tLE_OFFSET_ROM\t\t0x1c0000\n#define\tLE_OFFSET_LANCE\t\t0x100000\n#define\tLE_OFFSET_RAM\t\t0x0\n\nvoid\tle_tc_attach;\n\nvoid\nle_tc_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tregister struct le_softc *lesc = (void *)self;\n\tregister struct am7990_softc *sc = &lesc->sc_am7990;\n\tstruct tc_attach_args *d = aux;\n\n\t/*\n\t * It's on the turbochannel proper, or a kn02\n\t * baseboard implementation of a TC option card.\n\t */\n\tlesc->sc_r1 = (struct lereg1 *)(d->ta_addr + LE_OFFSET_LANCE);\n\tsc->sc_mem = (void *)(d->ta_addr + LE_OFFSET_RAM);\n\n\tsc->sc_copytodesc = am7990_copytobuf_contig;\n\tsc->sc_copyfromdesc = am7990_copyfrombuf_contig;\n\tsc->sc_copytobuf = am7990_copytobuf_contig;\n\tsc->sc_copyfrombuf = am7990_copyfrombuf_contig;\n\tsc->sc_zerobuf = am7990_zerobuf_contig;\n\n\t/*\n\t * TC lance boards have onboard SRAM buffers.  DMA\n\t * between the onbard RAM and main memory is not possible,\n\t * so  DMA setup is not required.\n\t */\n\n\tdec_le_common_attach(sc, (u_char *)(d->ta_addr + LE_OFFSET_ROM + 2));\n\n\ttc_intr_establish(parent, d->ta_cookie, TC_IPL_NET, am7990_intr, sc);\n}"
  },
  {
    "function_name": "le_tc_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/tc/if_le_tc.c",
    "lines": "67-79",
    "snippet": "int\nle_tc_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct tc_attach_args *d = aux;\n\n\tif (strncmp(\"PMAD-AA \", d->ta_modname, TC_ROM_LLEN) &&\n\t    strncmp(\"PMAD-BA \", d->ta_modname, TC_ROM_LLEN))\n\t\treturn (0);\n\n\treturn (1);\n}",
    "includes": [
      "#include <dev/tc/tcvar.h>",
      "#include <dev/tc/if_levar.h>",
      "#include <dev/ic/am7990var.h>",
      "#include <dev/ic/am7990reg.h>",
      "#include <netinet/if_ether.h>",
      "#include <netinet/in.h>",
      "#include <net/if_media.h>",
      "#include <net/if.h>",
      "#include <sys/device.h>",
      "#include <sys/socket.h>",
      "#include <sys/syslog.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tle_tc_match"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "\"PMAD-BA \"",
            "d->ta_modname",
            "TC_ROM_LLEN"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "\"PMAD-AA \"",
            "d->ta_modname",
            "TC_ROM_LLEN"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/tc/tcvar.h>\n#include <dev/tc/if_levar.h>\n#include <dev/ic/am7990var.h>\n#include <dev/ic/am7990reg.h>\n#include <netinet/if_ether.h>\n#include <netinet/in.h>\n#include <net/if_media.h>\n#include <net/if.h>\n#include <sys/device.h>\n#include <sys/socket.h>\n#include <sys/syslog.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tle_tc_match;\n\nint\nle_tc_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct tc_attach_args *d = aux;\n\n\tif (strncmp(\"PMAD-AA \", d->ta_modname, TC_ROM_LLEN) &&\n\t    strncmp(\"PMAD-BA \", d->ta_modname, TC_ROM_LLEN))\n\t\treturn (0);\n\n\treturn (1);\n}"
  }
]