[
  {
    "function_name": "vgapcimmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/vga_pci.c",
    "lines": "175-184",
    "snippet": "int\nvgapcimmap(v, offset, prot)\n\tvoid *v;\n\toff_t offset;\n\tint prot;\n{\n\tstruct vga_pci_softc *sc = v;\n\n\treturn (vgammap(sc->sc_vc, offset, prot));\n}",
    "includes": [
      "#include <dev/pci/vga_pcivar.h>",
      "#include <dev/ic/vgavar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/pte.h>",
      "#include <machine/autoconf.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tvgapcimmap"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vgammap",
          "args": [
            "sc->sc_vc",
            "offset",
            "prot"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "vgammap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vga.c",
          "lines": "229-258",
          "snippet": "int\nvgammap(v, offset, prot)\n\tvoid *v;\n\toff_t offset;\n\tint prot;\n{\n\tstruct vga_config *vc = v;\n\tbus_space_handle_t h;\n\tu_int32_t *port;\n\n\tif (offset >= 0x00000 && offset < 0x100000)\t/* 1MB of mem */\n\t\th = vc->vc_memh + offset;\n\telse if (offset >= 0x10000 && offset < 0x140000) /* 256KB of iohb */\n\t\th = vc->vc_ioh_b;\n\telse if (offset >= 0x140000 && offset < 0x180000) /* 256KB of iohc */\n\t\th = vc->vc_ioh_c;\n\telse if (offset >= 0x180000 && offset < 0x1c0000) /* 256KB of iohd */\n\t\th = vc->vc_ioh_d;\n\telse\n\t\treturn (-1);\n\n\tport = (u_int32_t *)(h << 5);\n#ifdef alpha\n\treturn alpha_btop(port);\t\t/* XXX */\n#elif defined(i386)\n\treturn i386_btop(port);\n#elif defined(powerpc)\n\treturn powerpc_btop(port);\n#endif\n}",
          "includes": [
            "#include <dev/ic/vgavar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgavar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\nvgammap(v, offset, prot)\n\tvoid *v;\n\toff_t offset;\n\tint prot;\n{\n\tstruct vga_config *vc = v;\n\tbus_space_handle_t h;\n\tu_int32_t *port;\n\n\tif (offset >= 0x00000 && offset < 0x100000)\t/* 1MB of mem */\n\t\th = vc->vc_memh + offset;\n\telse if (offset >= 0x10000 && offset < 0x140000) /* 256KB of iohb */\n\t\th = vc->vc_ioh_b;\n\telse if (offset >= 0x140000 && offset < 0x180000) /* 256KB of iohc */\n\t\th = vc->vc_ioh_c;\n\telse if (offset >= 0x180000 && offset < 0x1c0000) /* 256KB of iohd */\n\t\th = vc->vc_ioh_d;\n\telse\n\t\treturn (-1);\n\n\tport = (u_int32_t *)(h << 5);\n#ifdef alpha\n\treturn alpha_btop(port);\t\t/* XXX */\n#elif defined(i386)\n\treturn i386_btop(port);\n#elif defined(powerpc)\n\treturn powerpc_btop(port);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/vga_pcivar.h>\n#include <dev/ic/vgavar.h>\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/pte.h>\n#include <machine/autoconf.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tvgapcimmap;\n\nint\nvgapcimmap(v, offset, prot)\n\tvoid *v;\n\toff_t offset;\n\tint prot;\n{\n\tstruct vga_pci_softc *sc = v;\n\n\treturn (vgammap(sc->sc_vc, offset, prot));\n}"
  },
  {
    "function_name": "vgapciioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/vga_pci.c",
    "lines": "162-173",
    "snippet": "int\nvgapciioctl(v, cmd, data, flag, p)\n\tvoid *v;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct vga_pci_softc *sc = v;\n\n\treturn (vgaioctl(sc->sc_vc, cmd, data, flag, p));\n}",
    "includes": [
      "#include <dev/pci/vga_pcivar.h>",
      "#include <dev/ic/vgavar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/pte.h>",
      "#include <machine/autoconf.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int\tvgapciioctl"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vgaioctl",
          "args": [
            "sc->sc_vc",
            "cmd",
            "data",
            "flag",
            "p"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "vgaioctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vga.c",
          "lines": "215-227",
          "snippet": "int\nvgaioctl(v, cmd, data, flag, p)\n\tvoid *v;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\t/*struct vga_config *vc = v;*/\n\n\t/* XXX */\n\treturn -1;\n}",
          "includes": [
            "#include <dev/ic/vgavar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgavar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\nvgaioctl(v, cmd, data, flag, p)\n\tvoid *v;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\t/*struct vga_config *vc = v;*/\n\n\t/* XXX */\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/pci/vga_pcivar.h>\n#include <dev/ic/vgavar.h>\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/pte.h>\n#include <machine/autoconf.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tvgapciioctl;\n\nint\nvgapciioctl(v, cmd, data, flag, p)\n\tvoid *v;\n\tu_long cmd;\n\tcaddr_t data;\n\tint flag;\n\tstruct proc *p;\n{\n\tstruct vga_pci_softc *sc = v;\n\n\treturn (vgaioctl(sc->sc_vc, cmd, data, flag, p));\n}"
  },
  {
    "function_name": "vga_pci_console",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/vga_pci.c",
    "lines": "145-160",
    "snippet": "void\nvga_pci_console(iot, memt, pc, bus, device, function)\n\tbus_space_tag_t iot, memt;\n\tpci_chipset_tag_t pc;\n\tint bus, device, function;\n{\n\tstruct vga_config *vc = &vga_pci_console_vc;\n\n\t/* for later recognition */\n\tvga_pci_console_tag = pci_make_tag(pc, bus, device, function);\n\n\t/* set up bus-independent VGA configuration */\n\tvga_common_setup(iot, memt, vc);\n\n\tvga_wscons_console(vc);\n}",
    "includes": [
      "#include <dev/pci/vga_pcivar.h>",
      "#include <dev/ic/vgavar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/pte.h>",
      "#include <machine/autoconf.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "pcitag_t vga_pci_console_tag;",
      "struct vga_config vga_pci_console_vc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vga_wscons_console",
          "args": [
            "vc"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "vga_wscons_console",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vga.c",
          "lines": "185-202",
          "snippet": "void\nvga_wscons_console(vc)\n\tstruct vga_config *vc;\n{\n\tstruct wscons_odev_spec wo;\n\n        wo.wo_emulfuncs = &vga_emulfuncs;\n\two.wo_emulfuncs_cookie = vc;\n\n\t/* ioctl and mmap are unused until real attachment. */\n\n        wo.wo_nrows = vc->vc_nrow;\n        wo.wo_ncols = vc->vc_ncol;\n        wo.wo_crow = vc->vc_crow;\n        wo.wo_ccol = vc->vc_ccol;\n \n        wscons_attach_console(&wo);\n}",
          "includes": [
            "#include <dev/ic/vgavar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct wscons_emulfuncs vga_emulfuncs = {\n\tvga_cursor,\n\tvga_putstr,\n\tvga_copycols,\n\tvga_erasecols,\n\tvga_copyrows,\n\tvga_eraserows,\n\tvga_set_attr,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgavar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct wscons_emulfuncs vga_emulfuncs = {\n\tvga_cursor,\n\tvga_putstr,\n\tvga_copycols,\n\tvga_erasecols,\n\tvga_copyrows,\n\tvga_eraserows,\n\tvga_set_attr,\n};\n\nvoid\nvga_wscons_console(vc)\n\tstruct vga_config *vc;\n{\n\tstruct wscons_odev_spec wo;\n\n        wo.wo_emulfuncs = &vga_emulfuncs;\n\two.wo_emulfuncs_cookie = vc;\n\n\t/* ioctl and mmap are unused until real attachment. */\n\n        wo.wo_nrows = vc->vc_nrow;\n        wo.wo_ncols = vc->vc_ncol;\n        wo.wo_crow = vc->vc_crow;\n        wo.wo_ccol = vc->vc_ccol;\n \n        wscons_attach_console(&wo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vga_common_setup",
          "args": [
            "iot",
            "memt",
            "vc"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "vga_common_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vga.c",
          "lines": "112-156",
          "snippet": "void\nvga_common_setup(iot, memt, vc)\n\tbus_space_tag_t iot, memt;\n\tstruct vga_config *vc;\n{\n\tint cpos;\n\n        vc->vc_iot = iot;\n        vc->vc_memt = memt;\n\n        if (bus_space_map(vc->vc_iot, 0x3b0, 0xc, 0, &vc->vc_ioh_b))\n                panic(\"vga_common_setup: couldn't map io b\");\n        if (bus_space_map(vc->vc_iot, 0x3c0, 0x10, 0, &vc->vc_ioh_c))\n                panic(\"vga_common_setup: couldn't map io c\");\n        if (bus_space_map(vc->vc_iot, 0x3d0, 0x10, 0, &vc->vc_ioh_d))\n                panic(\"vga_common_setup: couldn't map io d\");\n        if (bus_space_map(vc->vc_memt, 0xb8000, 0x8000, 0, &vc->vc_memh))\n                panic(\"vga_common_setup: couldn't map memory\"); \n\n\tvc->vc_nrow = 25;\n\tvc->vc_ncol = 80;\n\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 14); \n\tcpos = bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA) << 8;\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 15);\n\tcpos |= bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA);\n\tvc->vc_crow = cpos / vc->vc_ncol;\n\tvc->vc_ccol = cpos % vc->vc_ncol;\n\n\tvc->vc_so = 0;\n#if 0\n\tvc->vc_at = 0x00 | 0xf;\t\t\t/* black bg|white fg */\n\tvc->vc_so_at = 0x00 | 0xf | 0x80;\t/* black bg|white fg|blink */\n\n\t/* clear screen, frob cursor, etc.? */\n\tpcivga_eraserows(vc, 0, vc->vc_nrow);\n#endif\n\t/*\n\t * XXX DEC HAS SWITCHED THE CODES FOR BLUE AND RED!!!\n\t * XXX Therefore, though the comments say \"blue bg\", the code uses\n\t * XXX the value for a red background!\n\t */\n\tvc->vc_at = 0x40 | 0x0f;\t\t/* blue bg|white fg */\n\tvc->vc_so_at = 0x40 | 0x0f | 0x80;\t/* blue bg|white fg|blink */\n}",
          "includes": [
            "#include <dev/ic/vgavar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define\tVGA_IO_D_6845_DATA\t0x5",
            "#define\tVGA_IO_D_6845_ADDR\t0x4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgavar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVGA_IO_D_6845_DATA\t0x5\n#define\tVGA_IO_D_6845_ADDR\t0x4\n\nvoid\nvga_common_setup(iot, memt, vc)\n\tbus_space_tag_t iot, memt;\n\tstruct vga_config *vc;\n{\n\tint cpos;\n\n        vc->vc_iot = iot;\n        vc->vc_memt = memt;\n\n        if (bus_space_map(vc->vc_iot, 0x3b0, 0xc, 0, &vc->vc_ioh_b))\n                panic(\"vga_common_setup: couldn't map io b\");\n        if (bus_space_map(vc->vc_iot, 0x3c0, 0x10, 0, &vc->vc_ioh_c))\n                panic(\"vga_common_setup: couldn't map io c\");\n        if (bus_space_map(vc->vc_iot, 0x3d0, 0x10, 0, &vc->vc_ioh_d))\n                panic(\"vga_common_setup: couldn't map io d\");\n        if (bus_space_map(vc->vc_memt, 0xb8000, 0x8000, 0, &vc->vc_memh))\n                panic(\"vga_common_setup: couldn't map memory\"); \n\n\tvc->vc_nrow = 25;\n\tvc->vc_ncol = 80;\n\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 14); \n\tcpos = bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA) << 8;\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 15);\n\tcpos |= bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA);\n\tvc->vc_crow = cpos / vc->vc_ncol;\n\tvc->vc_ccol = cpos % vc->vc_ncol;\n\n\tvc->vc_so = 0;\n#if 0\n\tvc->vc_at = 0x00 | 0xf;\t\t\t/* black bg|white fg */\n\tvc->vc_so_at = 0x00 | 0xf | 0x80;\t/* black bg|white fg|blink */\n\n\t/* clear screen, frob cursor, etc.? */\n\tpcivga_eraserows(vc, 0, vc->vc_nrow);\n#endif\n\t/*\n\t * XXX DEC HAS SWITCHED THE CODES FOR BLUE AND RED!!!\n\t * XXX Therefore, though the comments say \"blue bg\", the code uses\n\t * XXX the value for a red background!\n\t */\n\tvc->vc_at = 0x40 | 0x0f;\t\t/* blue bg|white fg */\n\tvc->vc_so_at = 0x40 | 0x0f | 0x80;\t/* blue bg|white fg|blink */\n}"
        }
      },
      {
        "call_info": {
          "callee": "pci_make_tag",
          "args": [
            "pc",
            "bus",
            "device",
            "function"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/vga_pcivar.h>\n#include <dev/ic/vgavar.h>\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/pte.h>\n#include <machine/autoconf.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\npcitag_t vga_pci_console_tag;\nstruct vga_config vga_pci_console_vc;\n\nvoid\nvga_pci_console(iot, memt, pc, bus, device, function)\n\tbus_space_tag_t iot, memt;\n\tpci_chipset_tag_t pc;\n\tint bus, device, function;\n{\n\tstruct vga_config *vc = &vga_pci_console_vc;\n\n\t/* for later recognition */\n\tvga_pci_console_tag = pci_make_tag(pc, bus, device, function);\n\n\t/* set up bus-independent VGA configuration */\n\tvga_common_setup(iot, memt, vc);\n\n\tvga_wscons_console(vc);\n}"
  },
  {
    "function_name": "vga_pci_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/vga_pci.c",
    "lines": "115-143",
    "snippet": "void\nvga_pci_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = aux;\n\tstruct vga_pci_softc *sc = (struct vga_pci_softc *)self;\n\tstruct vga_config *vc;\n\tint console;\n\n\tconsole = (!bcmp(&pa->pa_tag, &vga_pci_console_tag, sizeof(pa->pa_tag)));\n\tif (console)\n\t\tvc = sc->sc_vc = &vga_pci_console_vc;\n\telse {\n\t\tvc = sc->sc_vc = (struct vga_config *)\n\t\t    malloc(sizeof(struct vga_config), M_DEVBUF, M_WAITOK);\n\n\t\t/* set up bus-independent VGA configuration */\n\t\tvga_common_setup(pa->pa_iot, pa->pa_memt, vc);\n\t}\n\tvc->vc_mmap = vgapcimmap;\n\tvc->vc_ioctl = vgapciioctl;\n\n\tsc->sc_pcitag = pa->pa_tag;\n\n\tprintf(\"\\n\");\n\n\tvga_wscons_attach(self, vc, console);\n}",
    "includes": [
      "#include <dev/pci/vga_pcivar.h>",
      "#include <dev/ic/vgavar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/pte.h>",
      "#include <machine/autoconf.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\tvga_pci_attach",
      "int\tvgapcimmap",
      "int\tvgapciioctl",
      "pcitag_t vga_pci_console_tag;",
      "struct vga_config vga_pci_console_vc;",
      "void *aux;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vga_wscons_attach",
          "args": [
            "self",
            "vc",
            "console"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "vga_wscons_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vga.c",
          "lines": "158-183",
          "snippet": "void\nvga_wscons_attach(parent, vc, console)\n\tstruct device *parent;\n\tstruct vga_config *vc;\n\tint console;\n{\n\tstruct wscons_attach_args waa;\n\tstruct wscons_odev_spec *wo;\n\n        waa.waa_isconsole = console;\n        wo = &waa.waa_odev_spec;\n\n        wo->wo_emulfuncs = &vga_emulfuncs;\n\two->wo_emulfuncs_cookie = vc;\n\n        wo->wo_ioctl = vc->vc_ioctl;\n        wo->wo_mmap = vc->vc_mmap;\n        wo->wo_miscfuncs_cookie = vc;\n\n        wo->wo_nrows = vc->vc_nrow;\n        wo->wo_ncols = vc->vc_ncol;\n        wo->wo_crow = vc->vc_crow;\n        wo->wo_ccol = vc->vc_ccol;\n \n        config_found(parent, &waa, vgaprint);\n}",
          "includes": [
            "#include <dev/ic/vgavar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct wscons_emulfuncs vga_emulfuncs = {\n\tvga_cursor,\n\tvga_putstr,\n\tvga_copycols,\n\tvga_erasecols,\n\tvga_copyrows,\n\tvga_eraserows,\n\tvga_set_attr,\n};",
            "int\tvgaprint"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgavar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct wscons_emulfuncs vga_emulfuncs = {\n\tvga_cursor,\n\tvga_putstr,\n\tvga_copycols,\n\tvga_erasecols,\n\tvga_copyrows,\n\tvga_eraserows,\n\tvga_set_attr,\n};\nint\tvgaprint;\n\nvoid\nvga_wscons_attach(parent, vc, console)\n\tstruct device *parent;\n\tstruct vga_config *vc;\n\tint console;\n{\n\tstruct wscons_attach_args waa;\n\tstruct wscons_odev_spec *wo;\n\n        waa.waa_isconsole = console;\n        wo = &waa.waa_odev_spec;\n\n        wo->wo_emulfuncs = &vga_emulfuncs;\n\two->wo_emulfuncs_cookie = vc;\n\n        wo->wo_ioctl = vc->vc_ioctl;\n        wo->wo_mmap = vc->vc_mmap;\n        wo->wo_miscfuncs_cookie = vc;\n\n        wo->wo_nrows = vc->vc_nrow;\n        wo->wo_ncols = vc->vc_ncol;\n        wo->wo_crow = vc->vc_crow;\n        wo->wo_ccol = vc->vc_ccol;\n \n        config_found(parent, &waa, vgaprint);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vga_common_setup",
          "args": [
            "pa->pa_iot",
            "pa->pa_memt",
            "vc"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "vga_common_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/ic/vga.c",
          "lines": "112-156",
          "snippet": "void\nvga_common_setup(iot, memt, vc)\n\tbus_space_tag_t iot, memt;\n\tstruct vga_config *vc;\n{\n\tint cpos;\n\n        vc->vc_iot = iot;\n        vc->vc_memt = memt;\n\n        if (bus_space_map(vc->vc_iot, 0x3b0, 0xc, 0, &vc->vc_ioh_b))\n                panic(\"vga_common_setup: couldn't map io b\");\n        if (bus_space_map(vc->vc_iot, 0x3c0, 0x10, 0, &vc->vc_ioh_c))\n                panic(\"vga_common_setup: couldn't map io c\");\n        if (bus_space_map(vc->vc_iot, 0x3d0, 0x10, 0, &vc->vc_ioh_d))\n                panic(\"vga_common_setup: couldn't map io d\");\n        if (bus_space_map(vc->vc_memt, 0xb8000, 0x8000, 0, &vc->vc_memh))\n                panic(\"vga_common_setup: couldn't map memory\"); \n\n\tvc->vc_nrow = 25;\n\tvc->vc_ncol = 80;\n\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 14); \n\tcpos = bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA) << 8;\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 15);\n\tcpos |= bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA);\n\tvc->vc_crow = cpos / vc->vc_ncol;\n\tvc->vc_ccol = cpos % vc->vc_ncol;\n\n\tvc->vc_so = 0;\n#if 0\n\tvc->vc_at = 0x00 | 0xf;\t\t\t/* black bg|white fg */\n\tvc->vc_so_at = 0x00 | 0xf | 0x80;\t/* black bg|white fg|blink */\n\n\t/* clear screen, frob cursor, etc.? */\n\tpcivga_eraserows(vc, 0, vc->vc_nrow);\n#endif\n\t/*\n\t * XXX DEC HAS SWITCHED THE CODES FOR BLUE AND RED!!!\n\t * XXX Therefore, though the comments say \"blue bg\", the code uses\n\t * XXX the value for a red background!\n\t */\n\tvc->vc_at = 0x40 | 0x0f;\t\t/* blue bg|white fg */\n\tvc->vc_so_at = 0x40 | 0x0f | 0x80;\t/* blue bg|white fg|blink */\n}",
          "includes": [
            "#include <dev/ic/vgavar.h>",
            "#include <dev/wscons/wsconsvar.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define\tVGA_IO_D_6845_DATA\t0x5",
            "#define\tVGA_IO_D_6845_ADDR\t0x4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/vgavar.h>\n#include <dev/wscons/wsconsvar.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVGA_IO_D_6845_DATA\t0x5\n#define\tVGA_IO_D_6845_ADDR\t0x4\n\nvoid\nvga_common_setup(iot, memt, vc)\n\tbus_space_tag_t iot, memt;\n\tstruct vga_config *vc;\n{\n\tint cpos;\n\n        vc->vc_iot = iot;\n        vc->vc_memt = memt;\n\n        if (bus_space_map(vc->vc_iot, 0x3b0, 0xc, 0, &vc->vc_ioh_b))\n                panic(\"vga_common_setup: couldn't map io b\");\n        if (bus_space_map(vc->vc_iot, 0x3c0, 0x10, 0, &vc->vc_ioh_c))\n                panic(\"vga_common_setup: couldn't map io c\");\n        if (bus_space_map(vc->vc_iot, 0x3d0, 0x10, 0, &vc->vc_ioh_d))\n                panic(\"vga_common_setup: couldn't map io d\");\n        if (bus_space_map(vc->vc_memt, 0xb8000, 0x8000, 0, &vc->vc_memh))\n                panic(\"vga_common_setup: couldn't map memory\"); \n\n\tvc->vc_nrow = 25;\n\tvc->vc_ncol = 80;\n\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 14); \n\tcpos = bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA) << 8;\n\tbus_space_write_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_ADDR, 15);\n\tcpos |= bus_space_read_1(iot, vc->vc_ioh_d, VGA_IO_D_6845_DATA);\n\tvc->vc_crow = cpos / vc->vc_ncol;\n\tvc->vc_ccol = cpos % vc->vc_ncol;\n\n\tvc->vc_so = 0;\n#if 0\n\tvc->vc_at = 0x00 | 0xf;\t\t\t/* black bg|white fg */\n\tvc->vc_so_at = 0x00 | 0xf | 0x80;\t/* black bg|white fg|blink */\n\n\t/* clear screen, frob cursor, etc.? */\n\tpcivga_eraserows(vc, 0, vc->vc_nrow);\n#endif\n\t/*\n\t * XXX DEC HAS SWITCHED THE CODES FOR BLUE AND RED!!!\n\t * XXX Therefore, though the comments say \"blue bg\", the code uses\n\t * XXX the value for a red background!\n\t */\n\tvc->vc_at = 0x40 | 0x0f;\t\t/* blue bg|white fg */\n\tvc->vc_so_at = 0x40 | 0x0f | 0x80;\t/* blue bg|white fg|blink */\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct vga_config)",
            "M_DEVBUF",
            "M_WAITOK"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "rf_unrecord_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugMem.c",
          "lines": "84-99",
          "snippet": "void \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}",
          "includes": [
            "#include \"rf_general.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_options.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static long tot_mem_in_use = 0;",
            "static int memory_hash_remove(void *addr, int sz);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_general.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_options.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic long tot_mem_in_use = 0;\nstatic int memory_hash_remove(void *addr, int sz);\n\nvoid \nrf_unrecord_malloc(p, sz)\n\tvoid   *p;\n\tint     sz;\n{\n\tint     size;\n\n\t/* RF_LOCK_MUTEX(rf_debug_mem_mutex); */\n\tsize = memory_hash_remove(p, sz);\n\ttot_mem_in_use -= size;\n\t/* RF_UNLOCK_MUTEX(rf_debug_mem_mutex); */\n\tif ((long) p == rf_memDebugAddress) {\n\t\tprintf(\"Free: Found debug address\\n\");\t/* this is really only a\n\t\t\t\t\t\t\t * flag line for gdb */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bcmp",
          "args": [
            "&pa->pa_tag",
            "&vga_pci_console_tag",
            "sizeof(pa->pa_tag)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/pci/vga_pcivar.h>\n#include <dev/ic/vgavar.h>\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/pte.h>\n#include <machine/autoconf.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\tvga_pci_attach;\nint\tvgapcimmap;\nint\tvgapciioctl;\npcitag_t vga_pci_console_tag;\nstruct vga_config vga_pci_console_vc;\nvoid *aux;\n\nvoid\nvga_pci_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = aux;\n\tstruct vga_pci_softc *sc = (struct vga_pci_softc *)self;\n\tstruct vga_config *vc;\n\tint console;\n\n\tconsole = (!bcmp(&pa->pa_tag, &vga_pci_console_tag, sizeof(pa->pa_tag)));\n\tif (console)\n\t\tvc = sc->sc_vc = &vga_pci_console_vc;\n\telse {\n\t\tvc = sc->sc_vc = (struct vga_config *)\n\t\t    malloc(sizeof(struct vga_config), M_DEVBUF, M_WAITOK);\n\n\t\t/* set up bus-independent VGA configuration */\n\t\tvga_common_setup(pa->pa_iot, pa->pa_memt, vc);\n\t}\n\tvc->vc_mmap = vgapcimmap;\n\tvc->vc_ioctl = vgapciioctl;\n\n\tsc->sc_pcitag = pa->pa_tag;\n\n\tprintf(\"\\n\");\n\n\tvga_wscons_attach(self, vc, console);\n}"
  }
]