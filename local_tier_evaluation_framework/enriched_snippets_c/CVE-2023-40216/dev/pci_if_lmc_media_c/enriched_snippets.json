[
  {
    "function_name": "lmc_set_protocol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "1172-1198",
    "snippet": "static void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "LMC_PRINTF_FMT \": disabling keepalive\\n\"",
            "LMC_PRINTF_ARGS"
          ],
          "line": 1191
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}"
  },
  {
    "function_name": "lmc_t1_watchdog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "1116-1169",
    "snippet": "static void\nlmc_t1_watchdog(lmc_softc_t * const sc)\n{\n\tint t1stat;\n\n\t/* read alarm 1 status (recieve) */\n\tt1stat = lmc_t1_read (sc, 0x47);\n\t/* blue alarm -- RAIS */\n\tif (t1stat & 0x08) {\n\t\tif (sc->lmc_blue != 1)\n\t\t\tprintf (\"%s: AIS Recieved\\n\", sc->lmc_xname);\n\t\tlmc_led_on (sc, LMC_DS3_LED1 | LMC_DS3_LED2);\n\t\tsc->lmc_blue = 1;\n\t} else {\n\t\tif (sc->lmc_blue == 1)\n\t\t\tprintf (\"%s: AIS ok\\n\", sc->lmc_xname);\n\t\tlmc_led_off (sc, LMC_DS3_LED1);\n\t\tlmc_led_on (sc, LMC_DS3_LED2);\n\t\tsc->lmc_blue = 0;\n\t}\n\n\t/* Red alarm -- LOS | LOF */\n\tif (t1stat & 0x04) {\n\t\t/* Only print the error once */\n\t\tif (sc->lmc_red != 1)\n\t\t\tprintf (\"%s: Red Alarm\\n\", sc->lmc_xname);\n\t\tlmc_led_on (sc, LMC_DS3_LED2 | LMC_DS3_LED3);\n\t\tsc->lmc_red = 1;\n\t} else { \n\t\tif (sc->lmc_red == 1)\n\t\t\tprintf (\"%s: Red Alarm ok\\n\", sc->lmc_xname);\n\tlmc_led_off (sc, LMC_DS3_LED3);\n\tlmc_led_on (sc, LMC_DS3_LED2);\n\tsc->lmc_red = 0;\n\t}\n\n\t/* check for Recieve Multiframe Yellow Alarm\n\t * Ignore Recieve Yellow Alarm\n\t */\n\tif (t1stat & 0x80) {\n\t\tif (sc->lmc_yel != 1) {\n\t\t\tprintf (\"%s: Recieve Yellow Alarm\\n\", sc->lmc_xname);\n\t\t}\n\t\t\tlmc_led_on (sc, LMC_DS3_LED0 | LMC_DS3_LED2);\n\t\t\tsc->lmc_yel = 1;\n\t}\n\telse {\n\t\tif (sc->lmc_yel == 1)\n\t\tprintf (\"%s: Yellow Alarm ok\\n\", sc->lmc_xname);\n\t\tlmc_led_off (sc, LMC_DS3_LED0);\n\t\tlmc_led_on (sc, LMC_DS3_LED2);\n\t\tsc->lmc_yel = 0;\n\t}\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_led_on",
          "args": [
            "sc",
            "LMC_DS3_LED2"
          ],
          "line": 1166
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_on",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "193-198",
          "snippet": "void\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_led_off",
          "args": [
            "sc",
            "LMC_DS3_LED0"
          ],
          "line": 1165
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_off",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "200-205",
          "snippet": "void\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: Yellow Alarm ok\\n\"",
            "sc->lmc_xname"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_t1_read",
          "args": [
            "sc",
            "0x47"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_t1_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "882-886",
          "snippet": "static int lmc_t1_read(lmc_softc_t * const sc, int a)\n{\n\tlmc_mii_writereg(sc, 0, 17, a);\n\treturn lmc_mii_readreg(sc, 0, 18);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic int lmc_t1_read(lmc_softc_t * const sc, int a)\n{\n\tlmc_mii_writereg(sc, 0, 17, a);\n\treturn lmc_mii_readreg(sc, 0, 18);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_t1_watchdog(lmc_softc_t * const sc)\n{\n\tint t1stat;\n\n\t/* read alarm 1 status (recieve) */\n\tt1stat = lmc_t1_read (sc, 0x47);\n\t/* blue alarm -- RAIS */\n\tif (t1stat & 0x08) {\n\t\tif (sc->lmc_blue != 1)\n\t\t\tprintf (\"%s: AIS Recieved\\n\", sc->lmc_xname);\n\t\tlmc_led_on (sc, LMC_DS3_LED1 | LMC_DS3_LED2);\n\t\tsc->lmc_blue = 1;\n\t} else {\n\t\tif (sc->lmc_blue == 1)\n\t\t\tprintf (\"%s: AIS ok\\n\", sc->lmc_xname);\n\t\tlmc_led_off (sc, LMC_DS3_LED1);\n\t\tlmc_led_on (sc, LMC_DS3_LED2);\n\t\tsc->lmc_blue = 0;\n\t}\n\n\t/* Red alarm -- LOS | LOF */\n\tif (t1stat & 0x04) {\n\t\t/* Only print the error once */\n\t\tif (sc->lmc_red != 1)\n\t\t\tprintf (\"%s: Red Alarm\\n\", sc->lmc_xname);\n\t\tlmc_led_on (sc, LMC_DS3_LED2 | LMC_DS3_LED3);\n\t\tsc->lmc_red = 1;\n\t} else { \n\t\tif (sc->lmc_red == 1)\n\t\t\tprintf (\"%s: Red Alarm ok\\n\", sc->lmc_xname);\n\tlmc_led_off (sc, LMC_DS3_LED3);\n\tlmc_led_on (sc, LMC_DS3_LED2);\n\tsc->lmc_red = 0;\n\t}\n\n\t/* check for Recieve Multiframe Yellow Alarm\n\t * Ignore Recieve Yellow Alarm\n\t */\n\tif (t1stat & 0x80) {\n\t\tif (sc->lmc_yel != 1) {\n\t\t\tprintf (\"%s: Recieve Yellow Alarm\\n\", sc->lmc_xname);\n\t\t}\n\t\t\tlmc_led_on (sc, LMC_DS3_LED0 | LMC_DS3_LED2);\n\t\t\tsc->lmc_yel = 1;\n\t}\n\telse {\n\t\tif (sc->lmc_yel == 1)\n\t\tprintf (\"%s: Yellow Alarm ok\\n\", sc->lmc_xname);\n\t\tlmc_led_off (sc, LMC_DS3_LED0);\n\t\tlmc_led_on (sc, LMC_DS3_LED2);\n\t\tsc->lmc_yel = 0;\n\t}\n}"
  },
  {
    "function_name": "lmc_t1_set_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "1099-1114",
    "snippet": "static void\nlmc_t1_set_clock (lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CLOCK_SOURCE_EXT) {\n\t\tsc->lmc_gpio &= ~(LMC_GEP_SSI_TXCLOCK);\n\t\tLMC_CSR_WRITE (sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tprintf (LMC_PRINTF_FMT \": clock external\\n\", LMC_PRINTF_ARGS);\n\t}\n\telse {\n\t\tsc->lmc_gpio |= LMC_GEP_SSI_TXCLOCK;\n\t\tLMC_CSR_WRITE (sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_INT;\n\t\tprintf (LMC_PRINTF_FMT \": clock internal\\n\", LMC_PRINTF_ARGS);\n\t}\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "LMC_PRINTF_FMT \": clock internal\\n\"",
            "LMC_PRINTF_ARGS"
          ],
          "line": 1112
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_t1_set_clock (lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CLOCK_SOURCE_EXT) {\n\t\tsc->lmc_gpio &= ~(LMC_GEP_SSI_TXCLOCK);\n\t\tLMC_CSR_WRITE (sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tprintf (LMC_PRINTF_FMT \": clock external\\n\", LMC_PRINTF_ARGS);\n\t}\n\telse {\n\t\tsc->lmc_gpio |= LMC_GEP_SSI_TXCLOCK;\n\t\tLMC_CSR_WRITE (sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_INT;\n\t\tprintf (LMC_PRINTF_FMT \": clock internal\\n\", LMC_PRINTF_ARGS);\n\t}\n}"
  },
  {
    "function_name": "lmc_t1_set_crc_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "1076-1094",
    "snippet": "static void\n   lmc_t1_set_crc_length(lmc_softc_t * const sc, int state)\n{\n        if (state == LMC_CTL_CRC_LENGTH_32) {\n                /* 32 bit */\n                sc->lmc_miireg16 |= LMC_MII16_T1_CRC;\n                sc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_4;\n\n        } else {\n                /* 16 bit */\n                sc->lmc_miireg16 &= ~LMC_MII16_T1_CRC;\n                sc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_2;\n\n        }\n\n        lmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\n   lmc_t1_set_crc_length(lmc_softc_t * const sc, int state)\n{\n        if (state == LMC_CTL_CRC_LENGTH_32) {\n                /* 32 bit */\n                sc->lmc_miireg16 |= LMC_MII16_T1_CRC;\n                sc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_4;\n\n        } else {\n                /* 16 bit */\n                sc->lmc_miireg16 &= ~LMC_MII16_T1_CRC;\n                sc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_2;\n\n        }\n\n        lmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_t1_set_circuit_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "1061-1072",
    "snippet": "static void\n   lmc_t1_set_circuit_type(lmc_softc_t * const sc, int ie)\n{\n        if (ie == LMC_CTL_CIRCUIT_TYPE_T1)\n        {\n                sc->lmc_miireg16 |= LMC_MII16_T1_Z;\n                sc->ictl.circuit_type = LMC_CTL_CIRCUIT_TYPE_T1;\n        } else {                sc->lmc_miireg16 &= ~LMC_MII16_T1_Z;\n                sc->ictl.scrambler_onoff = LMC_CTL_CIRCUIT_TYPE_E1;\n        }\n        lmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\n   lmc_t1_set_circuit_type(lmc_softc_t * const sc, int ie)\n{\n        if (ie == LMC_CTL_CIRCUIT_TYPE_T1)\n        {\n                sc->lmc_miireg16 |= LMC_MII16_T1_Z;\n                sc->ictl.circuit_type = LMC_CTL_CIRCUIT_TYPE_T1;\n        } else {                sc->lmc_miireg16 &= ~LMC_MII16_T1_Z;\n                sc->ictl.scrambler_onoff = LMC_CTL_CIRCUIT_TYPE_E1;\n        }\n        lmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_t1_get_link_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "991-1056",
    "snippet": "static int\nlmc_t1_get_link_status(lmc_softc_t * const sc){\n\tu_int16_t link_status;\n\tlmc_mii_writereg(sc, 0, 17, T1FRAMER_ALARM1_STATUS );\n\tlink_status = lmc_mii_readreg(sc, 0, 18);\n\n        /*\n\t * LMC 1200 LED definitions\n         * led0 yellow = far-end adapter is in Red alarm condition\n  \t * led1 blue = received an Alarm Indication signal (upstream failure)\n         * led2 Green = power to adapter, Gate Array loaded & driver attached\n         * led3 red = Loss of Signal (LOS) or out of frame (OOF) conditions\n\t * detected on T3 receive signal\n         */\n\n        /* detect a change in Blue alarm indication signal */\n\n        if( (sc->t1_alarm1_status & T1F_RAIS) != (link_status & T1F_RAIS) )\n        {\n                if( link_status & T1F_RAIS )\n                {                        /* turn on blue LED */\n                        printf(\"%s: link status: RAIS turn ON Blue %x\\n\", sc->lmc_xname, link_status); /* DEBUG */\n                        lmc_led_on(sc, LMC_DS3_LED1);\n                }\n                else\n                {                        /* turn off blue LED */\n                        printf(\"%s: link status: RAIS turn OFF Blue %x\\n\", sc->lmc_xname, link_status ); /* DEBUG */\n\t\t\tlmc_led_off(sc, LMC_DS3_LED1);\n                }       \n\t}\n        /*\n\t * T1F_RYEL wiggles quite a bit,\n\t *  taking it out until I understand why -baz 6/22/99\n         */\n                /* Yellow alarm indication */\n                if( (sc->t1_alarm1_status &  T1F_RMYEL) !=\n                        (link_status & T1F_RMYEL) )\n                {\n\t\tif( (link_status & (T1F_RYEL | T1F_RMYEL)) == 0 )\n                        {\n\t\t\t\t/* turn off yellow LED */\n       \t\t                printf(\"%s: link status: RYEL turn OFF Yellow %x\\n\", sc->lmc_xname, link_status); /* DEBUG */\n                    \t        lmc_led_off(sc, LMC_DS3_LED0);\n\n                        }\n                        else\n                        {\n                                /* turn on yellow LED */                         \n                                printf(\"%s: link status: RYEL turn ON Yellow %x\\n\", sc->lmc_xname, link_status); /* DEBUG */\n                                lmc_led_on(sc, LMC_DS3_LED0);\n                        }\n                }\n\n\n        sc->t1_alarm1_status = link_status;\n\n        lmc_mii_writereg(sc, 0, 17, T1FRAMER_ALARM2_STATUS );\n        sc->t1_alarm2_status = lmc_mii_readreg(sc, 0, 18);\n\n        /* link status based upon T1 receive loss of frame or\n         * loss of signal - RED alarm indication */\n        if ((link_status & (T1F_RLOF | T1F_RLOS)) == 0)\n                return 1;\n        else\n                return 0;\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "18"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "17",
            "T1FRAMER_ALARM2_STATUS"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_led_on",
          "args": [
            "sc",
            "LMC_DS3_LED0"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_on",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "193-198",
          "snippet": "void\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: link status: RYEL turn ON Yellow %x\\n\"",
            "sc->lmc_xname",
            "link_status"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_led_off",
          "args": [
            "sc",
            "LMC_DS3_LED0"
          ],
          "line": 1033
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_off",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "200-205",
          "snippet": "void\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic int\nlmc_t1_get_link_status(lmc_softc_t * const sc){\n\tu_int16_t link_status;\n\tlmc_mii_writereg(sc, 0, 17, T1FRAMER_ALARM1_STATUS );\n\tlink_status = lmc_mii_readreg(sc, 0, 18);\n\n        /*\n\t * LMC 1200 LED definitions\n         * led0 yellow = far-end adapter is in Red alarm condition\n  \t * led1 blue = received an Alarm Indication signal (upstream failure)\n         * led2 Green = power to adapter, Gate Array loaded & driver attached\n         * led3 red = Loss of Signal (LOS) or out of frame (OOF) conditions\n\t * detected on T3 receive signal\n         */\n\n        /* detect a change in Blue alarm indication signal */\n\n        if( (sc->t1_alarm1_status & T1F_RAIS) != (link_status & T1F_RAIS) )\n        {\n                if( link_status & T1F_RAIS )\n                {                        /* turn on blue LED */\n                        printf(\"%s: link status: RAIS turn ON Blue %x\\n\", sc->lmc_xname, link_status); /* DEBUG */\n                        lmc_led_on(sc, LMC_DS3_LED1);\n                }\n                else\n                {                        /* turn off blue LED */\n                        printf(\"%s: link status: RAIS turn OFF Blue %x\\n\", sc->lmc_xname, link_status ); /* DEBUG */\n\t\t\tlmc_led_off(sc, LMC_DS3_LED1);\n                }       \n\t}\n        /*\n\t * T1F_RYEL wiggles quite a bit,\n\t *  taking it out until I understand why -baz 6/22/99\n         */\n                /* Yellow alarm indication */\n                if( (sc->t1_alarm1_status &  T1F_RMYEL) !=\n                        (link_status & T1F_RMYEL) )\n                {\n\t\tif( (link_status & (T1F_RYEL | T1F_RMYEL)) == 0 )\n                        {\n\t\t\t\t/* turn off yellow LED */\n       \t\t                printf(\"%s: link status: RYEL turn OFF Yellow %x\\n\", sc->lmc_xname, link_status); /* DEBUG */\n                    \t        lmc_led_off(sc, LMC_DS3_LED0);\n\n                        }\n                        else\n                        {\n                                /* turn on yellow LED */                         \n                                printf(\"%s: link status: RYEL turn ON Yellow %x\\n\", sc->lmc_xname, link_status); /* DEBUG */\n                                lmc_led_on(sc, LMC_DS3_LED0);\n                        }\n                }\n\n\n        sc->t1_alarm1_status = link_status;\n\n        lmc_mii_writereg(sc, 0, 17, T1FRAMER_ALARM2_STATUS );\n        sc->t1_alarm2_status = lmc_mii_readreg(sc, 0, 18);\n\n        /* link status based upon T1 receive loss of frame or\n         * loss of signal - RED alarm indication */\n        if ((link_status & (T1F_RLOF | T1F_RLOS)) == 0)\n                return 1;\n        else\n                return 0;\n}"
  },
  {
    "function_name": "lmc_t1_set_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "964-984",
    "snippet": "static void\nlmc_t1_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl){\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_circuit_type(sc, sc->ictl.circuit_type);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n        /*\n         * check for change in circuit type\n\t */\n\n\tif (ctl->circuit_type == LMC_CTL_CIRCUIT_TYPE_T1\n\t\t&& sc->ictl.circuit_type == LMC_CTL_CIRCUIT_TYPE_E1)\n\t\tsc->lmc_media->set_circuit_type(sc,LMC_CTL_CIRCUIT_TYPE_E1 );\n\telse if (ctl->circuit_type == LMC_CTL_CIRCUIT_TYPE_E1\n\t\t&& sc->ictl.circuit_type == LMC_CTL_CIRCUIT_TYPE_T1)\n\t\tsc->lmc_media->set_circuit_type(sc, LMC_CTL_CIRCUIT_TYPE_T1);\n\tlmc_set_protocol(sc, ctl);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_set_protocol",
          "args": [
            "sc",
            "ctl"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_set_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "1172-1198",
          "snippet": "static void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_circuit_type",
          "args": [
            "sc",
            "LMC_CTL_CIRCUIT_TYPE_T1"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_circuit_type",
          "args": [
            "sc",
            "LMC_CTL_CIRCUIT_TYPE_E1"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_circuit_type",
          "args": [
            "sc",
            "sc->ictl.circuit_type"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_t1_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl){\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_circuit_type(sc, sc->ictl.circuit_type);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n        /*\n         * check for change in circuit type\n\t */\n\n\tif (ctl->circuit_type == LMC_CTL_CIRCUIT_TYPE_T1\n\t\t&& sc->ictl.circuit_type == LMC_CTL_CIRCUIT_TYPE_E1)\n\t\tsc->lmc_media->set_circuit_type(sc,LMC_CTL_CIRCUIT_TYPE_E1 );\n\telse if (ctl->circuit_type == LMC_CTL_CIRCUIT_TYPE_E1\n\t\t&& sc->ictl.circuit_type == LMC_CTL_CIRCUIT_TYPE_T1)\n\t\tsc->lmc_media->set_circuit_type(sc, LMC_CTL_CIRCUIT_TYPE_T1);\n\tlmc_set_protocol(sc, ctl);\n}"
  },
  {
    "function_name": "lmc_t1_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "951-957",
    "snippet": "static void   lmc_t1_default(lmc_softc_t * const sc)\n{\n        sc->lmc_miireg16 = LMC_MII16_LED_ALL;\n        sc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n        sc->lmc_media->set_circuit_type(sc, LMC_CTL_CIRCUIT_TYPE_T1);\n        sc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc->lmc_media->set_crc_length",
          "args": [
            "sc",
            "LMC_CTL_CRC_LENGTH_16"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_circuit_type",
          "args": [
            "sc",
            "LMC_CTL_CIRCUIT_TYPE_T1"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_link_status",
          "args": [
            "sc",
            "LMC_LINK_DOWN"
          ],
          "line": 954
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void   lmc_t1_default(lmc_softc_t * const sc)\n{\n        sc->lmc_miireg16 = LMC_MII16_LED_ALL;\n        sc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n        sc->lmc_media->set_circuit_type(sc, LMC_CTL_CIRCUIT_TYPE_T1);\n        sc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}"
  },
  {
    "function_name": "lmc_t1_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "888-949",
    "snippet": "static void\n   lmc_t1_init(lmc_softc_t * const sc)\n{\n        u_int16_t mii16;\n        int     i;\n\n        sc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC1200;\n        mii16 = lmc_mii_readreg(sc, 0, 16);\n\n        /* reset 8370 */\n        mii16 &= ~LMC_MII16_T1_RST;\n        lmc_mii_writereg(sc, 0, 16, mii16 | LMC_MII16_T1_RST);\n        lmc_mii_writereg(sc, 0, 16, mii16);\n\n        /* set T1 or E1 line impedance */\n        /* mii16 &= ~LMC_MII16_T1_Z; */\n        mii16 |= LMC_MII16_T1_Z;\n        lmc_mii_writereg(sc, 0, 16, mii16);\n\n\t/* Standard LMC1200 init code */\n        lmc_t1_write(sc, 0x01, 0x1B);  /* CR0     - primary control          */\n        lmc_t1_write(sc, 0x02, 0x42);  /* JAT_CR  - jitter atten config      */\n        lmc_t1_write(sc, 0x14, 0x00);  /* LOOP    - loopback config          */\n        lmc_t1_write(sc, 0x15, 0x00);  /* DL3_TS  - xtrnl datalink timeslot  */\n        lmc_t1_write(sc, 0x18, 0xFF);  /* PIO     - programmable I/O         */\n        lmc_t1_write(sc, 0x19, 0x30);  /* POE     - programmable OE          */\n        lmc_t1_write(sc, 0x1A, 0x0F);  /* CMUX    - clock input mux          */\n        lmc_t1_write(sc, 0x20, 0x41);  /* LIU_CR  - RX LIU config            */\n        lmc_t1_write(sc, 0x22, 0x76);  /* RLIU_CR - RX LIU config            */\n        lmc_t1_write(sc, 0x40, 0x03);  /* RCR0    - RX config                */\n        lmc_t1_write(sc, 0x45, 0x00);  /* RALM    - RX alarm config          */\n        lmc_t1_write(sc, 0x46, 0x05);  /* LATCH   - RX alarm/err/cntr latch  */\n        lmc_t1_write(sc, 0x68, 0x40);  /* TLIU_CR - TX LIU config            */\n        lmc_t1_write(sc, 0x70, 0x0D);  /* TCR0    - TX framer config         */\n        lmc_t1_write(sc, 0x71, 0x05);  /* TCR1    - TX config                */\n        lmc_t1_write(sc, 0x72, 0x0B);  /* TFRM    - TX frame format          */\n        lmc_t1_write(sc, 0x73, 0x00);  /* TERROR  - TX error insert          */\n        lmc_t1_write(sc, 0x74, 0x00);  /* TMAN    - TX manual Sa/FEBE config */\n        lmc_t1_write(sc, 0x75, 0x00);  /* TALM    - TX alarm signal config   */\n        lmc_t1_write(sc, 0x76, 0x00);  /* TPATT   - TX test pattern config   */\n        lmc_t1_write(sc, 0x77, 0x00);  /* TLB     - TX inband loopback confg */\n        lmc_t1_write(sc, 0x90, 0x05);  /* CLAD_CR - clock rate adapter confg */\n        lmc_t1_write(sc, 0x91, 0x05);  /* CSEL    - clad freq sel            */\n        lmc_t1_write(sc, 0xA6, 0x00);  /* DL1_CTL - DL1 control              */\n        lmc_t1_write(sc, 0xB1, 0x00);  /* DL2_CTL - DL2 control              */\n        lmc_t1_write(sc, 0xD0, 0x47);  /* SBI_CR  - sys bus iface config     */\n        lmc_t1_write(sc, 0xD1, 0x70);  /* RSB_CR  - RX sys bus config        */\n        lmc_t1_write(sc, 0xD4, 0x30);  /* TSB_CR  - TX sys bus config        */\n        for (i=0; i<32; i++)\n        {\n                lmc_t1_write(sc, 0x0E0+i, 0x00); /*SBCn sysbus perchannel ctl */\n                lmc_t1_write(sc, 0x100+i, 0x00); /* TPCn - TX per-channel ctl */\n                lmc_t1_write(sc, 0x180+i, 0x00); /* RPCn - RX per-channel ctl */\n        }\n        for (i=1; i<25; i++)\n\t{                lmc_t1_write(sc, 0x0E0+i, 0x0D);\n\t\t\t\t\t/* SBCn - sys bus per-channel ctl    */\n\t}\n        /*  XXX\n        mii16 |= LMC_MII16_T1_XOE;        lmc_mii_writereg(sc, 0, 16, mii16);\n        sc->lmc_miireg16 = mii16;        */\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_t1_write",
          "args": [
            "sc",
            "0x0E0+i",
            "0x0D"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_t1_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "876-880",
          "snippet": "static void lmc_t1_write(lmc_softc_t * const sc, int a, int d)\n{\n        lmc_mii_writereg(sc, 0, 17, a);        \n\tlmc_mii_writereg(sc, 0, 18, d);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void lmc_t1_write(lmc_softc_t * const sc, int a, int d)\n{\n        lmc_mii_writereg(sc, 0, 17, a);        \n\tlmc_mii_writereg(sc, 0, 18, d);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "mii16"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "16"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\n   lmc_t1_init(lmc_softc_t * const sc)\n{\n        u_int16_t mii16;\n        int     i;\n\n        sc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC1200;\n        mii16 = lmc_mii_readreg(sc, 0, 16);\n\n        /* reset 8370 */\n        mii16 &= ~LMC_MII16_T1_RST;\n        lmc_mii_writereg(sc, 0, 16, mii16 | LMC_MII16_T1_RST);\n        lmc_mii_writereg(sc, 0, 16, mii16);\n\n        /* set T1 or E1 line impedance */\n        /* mii16 &= ~LMC_MII16_T1_Z; */\n        mii16 |= LMC_MII16_T1_Z;\n        lmc_mii_writereg(sc, 0, 16, mii16);\n\n\t/* Standard LMC1200 init code */\n        lmc_t1_write(sc, 0x01, 0x1B);  /* CR0     - primary control          */\n        lmc_t1_write(sc, 0x02, 0x42);  /* JAT_CR  - jitter atten config      */\n        lmc_t1_write(sc, 0x14, 0x00);  /* LOOP    - loopback config          */\n        lmc_t1_write(sc, 0x15, 0x00);  /* DL3_TS  - xtrnl datalink timeslot  */\n        lmc_t1_write(sc, 0x18, 0xFF);  /* PIO     - programmable I/O         */\n        lmc_t1_write(sc, 0x19, 0x30);  /* POE     - programmable OE          */\n        lmc_t1_write(sc, 0x1A, 0x0F);  /* CMUX    - clock input mux          */\n        lmc_t1_write(sc, 0x20, 0x41);  /* LIU_CR  - RX LIU config            */\n        lmc_t1_write(sc, 0x22, 0x76);  /* RLIU_CR - RX LIU config            */\n        lmc_t1_write(sc, 0x40, 0x03);  /* RCR0    - RX config                */\n        lmc_t1_write(sc, 0x45, 0x00);  /* RALM    - RX alarm config          */\n        lmc_t1_write(sc, 0x46, 0x05);  /* LATCH   - RX alarm/err/cntr latch  */\n        lmc_t1_write(sc, 0x68, 0x40);  /* TLIU_CR - TX LIU config            */\n        lmc_t1_write(sc, 0x70, 0x0D);  /* TCR0    - TX framer config         */\n        lmc_t1_write(sc, 0x71, 0x05);  /* TCR1    - TX config                */\n        lmc_t1_write(sc, 0x72, 0x0B);  /* TFRM    - TX frame format          */\n        lmc_t1_write(sc, 0x73, 0x00);  /* TERROR  - TX error insert          */\n        lmc_t1_write(sc, 0x74, 0x00);  /* TMAN    - TX manual Sa/FEBE config */\n        lmc_t1_write(sc, 0x75, 0x00);  /* TALM    - TX alarm signal config   */\n        lmc_t1_write(sc, 0x76, 0x00);  /* TPATT   - TX test pattern config   */\n        lmc_t1_write(sc, 0x77, 0x00);  /* TLB     - TX inband loopback confg */\n        lmc_t1_write(sc, 0x90, 0x05);  /* CLAD_CR - clock rate adapter confg */\n        lmc_t1_write(sc, 0x91, 0x05);  /* CSEL    - clad freq sel            */\n        lmc_t1_write(sc, 0xA6, 0x00);  /* DL1_CTL - DL1 control              */\n        lmc_t1_write(sc, 0xB1, 0x00);  /* DL2_CTL - DL2 control              */\n        lmc_t1_write(sc, 0xD0, 0x47);  /* SBI_CR  - sys bus iface config     */\n        lmc_t1_write(sc, 0xD1, 0x70);  /* RSB_CR  - RX sys bus config        */\n        lmc_t1_write(sc, 0xD4, 0x30);  /* TSB_CR  - TX sys bus config        */\n        for (i=0; i<32; i++)\n        {\n                lmc_t1_write(sc, 0x0E0+i, 0x00); /*SBCn sysbus perchannel ctl */\n                lmc_t1_write(sc, 0x100+i, 0x00); /* TPCn - TX per-channel ctl */\n                lmc_t1_write(sc, 0x180+i, 0x00); /* RPCn - RX per-channel ctl */\n        }\n        for (i=1; i<25; i++)\n\t{                lmc_t1_write(sc, 0x0E0+i, 0x0D);\n\t\t\t\t\t/* SBCn - sys bus per-channel ctl    */\n\t}\n        /*  XXX\n        mii16 |= LMC_MII16_T1_XOE;        lmc_mii_writereg(sc, 0, 16, mii16);\n        sc->lmc_miireg16 = mii16;        */\n}"
  },
  {
    "function_name": "lmc_t1_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "882-886",
    "snippet": "static int lmc_t1_read(lmc_softc_t * const sc, int a)\n{\n\tlmc_mii_writereg(sc, 0, 17, a);\n\treturn lmc_mii_readreg(sc, 0, 18);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "18"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "17",
            "a"
          ],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic int lmc_t1_read(lmc_softc_t * const sc, int a)\n{\n\tlmc_mii_writereg(sc, 0, 17, a);\n\treturn lmc_mii_readreg(sc, 0, 18);\n}"
  },
  {
    "function_name": "lmc_t1_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "876-880",
    "snippet": "static void lmc_t1_write(lmc_softc_t * const sc, int a, int d)\n{\n        lmc_mii_writereg(sc, 0, 17, a);        \n\tlmc_mii_writereg(sc, 0, 18, d);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "18",
            "d"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void lmc_t1_write(lmc_softc_t * const sc, int a, int d)\n{\n        lmc_mii_writereg(sc, 0, 17, a);        \n\tlmc_mii_writereg(sc, 0, 18, d);\n}"
  },
  {
    "function_name": "lmc_ssi_watchdog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "848-866",
    "snippet": "static void\nlmc_ssi_watchdog (lmc_softc_t * const sc)\n{\n\tu_int16_t mii17;\n\tstruct ssicsr2 {\n\t\tunsigned short dtr:1, dsr:1, rts:1, cable:3, crc:1, led0:1,\n\t\tled1:1, led2:1, led3:1, fifo:1, ll:1, rl:1, tm:1, loop:1;\n\t};\n\tstruct ssicsr2 *ssicsr;\n\tmii17 = lmc_mii_readreg (sc, 0, 17);\n\tssicsr = (struct ssicsr2 *) &mii17;\n\tif (ssicsr->cable == 7) {\n\t\tlmc_led_off (sc, LMC_MII16_LED2);\n\t}\n\telse {\n\t\tlmc_led_on (sc, LMC_MII16_LED2);\n\t}\n\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_led_on",
          "args": [
            "sc",
            "LMC_MII16_LED2"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_on",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "193-198",
          "snippet": "void\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_led_off",
          "args": [
            "sc",
            "LMC_MII16_LED2"
          ],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_off",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "200-205",
          "snippet": "void\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_off(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 |= led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "17"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_watchdog (lmc_softc_t * const sc)\n{\n\tu_int16_t mii17;\n\tstruct ssicsr2 {\n\t\tunsigned short dtr:1, dsr:1, rts:1, cable:3, crc:1, led0:1,\n\t\tled1:1, led2:1, led3:1, fifo:1, ll:1, rl:1, tm:1, loop:1;\n\t};\n\tstruct ssicsr2 *ssicsr;\n\tmii17 = lmc_mii_readreg (sc, 0, 17);\n\tssicsr = (struct ssicsr2 *) &mii17;\n\tif (ssicsr->cable == 7) {\n\t\tlmc_led_off (sc, LMC_MII16_LED2);\n\t}\n\telse {\n\t\tlmc_led_on (sc, LMC_MII16_LED2);\n\t}\n\n}"
  },
  {
    "function_name": "write_av9110",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "798-846",
    "snippet": "static void\nwrite_av9110(lmc_softc_t *sc, u_int32_t n, u_int32_t m, u_int32_t v,\n\t     u_int32_t x, u_int32_t r)\n{\n\tint i;\n\n#if 0\n\tprintf(LMC_PRINTF_FMT \": speed %u, %d %d %d %d %d\\n\",\n\t       LMC_PRINTF_ARGS, sc->ictl.clock_rate,\n\t       n, m, v, x, r);\n#endif\n\n        sc->lmc_gpio |= LMC_GEP_SSI_GENERATOR;\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL | LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * Set the TXCLOCK, GENERATOR, SERIAL, and SERIALCLK\n\t * as outputs.\n\t */\n\tlmc_gpio_mkoutput(sc, (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                               | LMC_GEP_SSI_GENERATOR));\n\n        sc->lmc_gpio &= ~(LMC_GEP_SSI_GENERATOR);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * a shifting we will go...\n\t */\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, n >> i);\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, m >> i);\n\tfor (i = 0 ; i < 1 ; i++)\n\t\twrite_av9110_bit(sc, v >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, x >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, r >> i);\n\tfor (i = 0 ; i < 5 ; i++)\n\t\twrite_av9110_bit(sc, 0x17 >> i);\n\n\t/*\n\t * stop driving serial-related signals\n\t */\n\tlmc_gpio_mkinput(sc,\n\t\t\t (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                          | LMC_GEP_SSI_GENERATOR));\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);",
      "static void\twrite_av9110(lmc_softc_t *, u_int32_t, u_int32_t, u_int32_t,\n\t\t\t     u_int32_t, u_int32_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_gpio_mkinput",
          "args": [
            "sc",
            "(LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                          | LMC_GEP_SSI_GENERATOR)"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_gpio_mkinput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "179-184",
          "snippet": "void\nlmc_gpio_mkinput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io &= ~bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkinput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io &= ~bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
        }
      },
      {
        "call_info": {
          "callee": "write_av9110_bit",
          "args": [
            "sc",
            "0x17 >> i"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "write_av9110_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "772-796",
          "snippet": "static inline void\nwrite_av9110_bit(lmc_softc_t *sc, int c)\n{\n\t/*\n\t * set the data bit as we need it.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tif (c & 0x01)\n\t\tsc->lmc_gpio |= LMC_GEP_SERIAL;\n\telse\n\t\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to high\n\t */\n\tsc->lmc_gpio |= LMC_GEP_SERIALCLK;\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to low again.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic inline void\nwrite_av9110_bit(lmc_softc_t *sc, int c)\n{\n\t/*\n\t * set the data bit as we need it.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tif (c & 0x01)\n\t\tsc->lmc_gpio |= LMC_GEP_SERIAL;\n\telse\n\t\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to high\n\t */\n\tsc->lmc_gpio |= LMC_GEP_SERIALCLK;\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to low again.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n}"
        }
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lmc_gpio_mkoutput",
          "args": [
            "sc",
            "(LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                               | LMC_GEP_SSI_GENERATOR)"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_gpio_mkoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "186-191",
          "snippet": "void\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
        }
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "LMC_PRINTF_FMT \": speed %u, %d %d %d %d %d\\n\"",
            "LMC_PRINTF_ARGS",
            "sc->ictl.clock_rate",
            "n",
            "m",
            "v",
            "x",
            "r"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\nstatic void\twrite_av9110(lmc_softc_t *, u_int32_t, u_int32_t, u_int32_t,\n\t\t\t     u_int32_t, u_int32_t);\n\nstatic void\nwrite_av9110(lmc_softc_t *sc, u_int32_t n, u_int32_t m, u_int32_t v,\n\t     u_int32_t x, u_int32_t r)\n{\n\tint i;\n\n#if 0\n\tprintf(LMC_PRINTF_FMT \": speed %u, %d %d %d %d %d\\n\",\n\t       LMC_PRINTF_ARGS, sc->ictl.clock_rate,\n\t       n, m, v, x, r);\n#endif\n\n        sc->lmc_gpio |= LMC_GEP_SSI_GENERATOR;\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL | LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * Set the TXCLOCK, GENERATOR, SERIAL, and SERIALCLK\n\t * as outputs.\n\t */\n\tlmc_gpio_mkoutput(sc, (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                               | LMC_GEP_SSI_GENERATOR));\n\n        sc->lmc_gpio &= ~(LMC_GEP_SSI_GENERATOR);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * a shifting we will go...\n\t */\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, n >> i);\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, m >> i);\n\tfor (i = 0 ; i < 1 ; i++)\n\t\twrite_av9110_bit(sc, v >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, x >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, r >> i);\n\tfor (i = 0 ; i < 5 ; i++)\n\t\twrite_av9110_bit(sc, 0x17 >> i);\n\n\t/*\n\t * stop driving serial-related signals\n\t */\n\tlmc_gpio_mkinput(sc,\n\t\t\t (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                          | LMC_GEP_SSI_GENERATOR));\n}"
  },
  {
    "function_name": "write_av9110_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "772-796",
    "snippet": "static inline void\nwrite_av9110_bit(lmc_softc_t *sc, int c)\n{\n\t/*\n\t * set the data bit as we need it.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tif (c & 0x01)\n\t\tsc->lmc_gpio |= LMC_GEP_SERIAL;\n\telse\n\t\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to high\n\t */\n\tsc->lmc_gpio |= LMC_GEP_SERIALCLK;\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to low again.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic inline void\nwrite_av9110_bit(lmc_softc_t *sc, int c)\n{\n\t/*\n\t * set the data bit as we need it.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tif (c & 0x01)\n\t\tsc->lmc_gpio |= LMC_GEP_SERIAL;\n\telse\n\t\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to high\n\t */\n\tsc->lmc_gpio |= LMC_GEP_SERIALCLK;\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * set the clock to low again.\n\t */\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n}"
  },
  {
    "function_name": "lmc_ssi_set_crc_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "750-767",
    "snippet": "static void\nlmc_ssi_set_crc_length(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_CTL_CRC_LENGTH_32) {\n\t\t/* 32 bit */\n                sc->lmc_miireg16 |= LMC_MII16_SSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_4;\n\n\t} else {\n\t\t/* 16 bit */\n                sc->lmc_miireg16 &= ~LMC_MII16_SSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_2;\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_set_crc_length(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_CTL_CRC_LENGTH_32) {\n\t\t/* 32 bit */\n                sc->lmc_miireg16 |= LMC_MII16_SSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_4;\n\n\t} else {\n\t\t/* 16 bit */\n                sc->lmc_miireg16 &= ~LMC_MII16_SSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n                sc->lmc_crcSize = LMC_CTL_CRC_BYTESIZE_2;\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_ssi_set_link_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "730-745",
    "snippet": "static void\nlmc_ssi_set_link_status(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_LINK_UP) {\n                sc->lmc_miireg16 |= (LMC_MII16_SSI_DTR | LMC_MII16_SSI_RTS);\n\t\tprintf(LMC_PRINTF_FMT \": asserting DTR and RTS\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t} else {\n                sc->lmc_miireg16 &= ~(LMC_MII16_SSI_DTR | LMC_MII16_SSI_RTS);\n\t\tprintf(LMC_PRINTF_FMT \": deasserting DTR and RTS\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "LMC_PRINTF_FMT \": deasserting DTR and RTS\\n\"",
            "LMC_PRINTF_ARGS"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_set_link_status(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_LINK_UP) {\n                sc->lmc_miireg16 |= (LMC_MII16_SSI_DTR | LMC_MII16_SSI_RTS);\n\t\tprintf(LMC_PRINTF_FMT \": asserting DTR and RTS\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t} else {\n                sc->lmc_miireg16 &= ~(LMC_MII16_SSI_DTR | LMC_MII16_SSI_RTS);\n\t\tprintf(LMC_PRINTF_FMT \": deasserting DTR and RTS\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n\n}"
  },
  {
    "function_name": "lmc_ssi_get_link_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "696-728",
    "snippet": "static int\nlmc_ssi_get_link_status(lmc_softc_t * const sc)\n{\n\tu_int16_t link_status;\n\n\t/*\n\t * missing CTS?  Hmm.  If we require CTS on, we may never get the\n\t * link to come up, so omit it in this test.\n\t *\n\t * Also, it seems that with a loopback cable, DCD isn't asserted,\n\t * so just check for things like this:\n\t *\tDSR _must_ be asserted.\n\t *\tOne of DCD or CTS must be asserted.\n\t */\n\n#ifdef CONFIG_LMC_IGNORE_HARDWARE_HANDSHAKE\n        link_status = LMC_CSR_READ(sc, csr_gp_timer);\n        link_status = 0x0000ffff - ( link_status & 0x0000ffff);\n\n        return( link_status );\n#else  \n\n\tlink_status = lmc_mii_readreg(sc, 0, 16);\n\n        if ((link_status & LMC_MII16_SSI_DSR) == 0)\n\t\treturn (0);\n\n        if ((link_status & (LMC_MII16_SSI_CTS | LMC_MII16_SSI_DCD)) == 0)\n\t\treturn (0);\n\n\treturn (1);\n#endif\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "16"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "LMC_CSR_READ",
          "args": [
            "sc",
            "csr_gp_timer"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic int\nlmc_ssi_get_link_status(lmc_softc_t * const sc)\n{\n\tu_int16_t link_status;\n\n\t/*\n\t * missing CTS?  Hmm.  If we require CTS on, we may never get the\n\t * link to come up, so omit it in this test.\n\t *\n\t * Also, it seems that with a loopback cable, DCD isn't asserted,\n\t * so just check for things like this:\n\t *\tDSR _must_ be asserted.\n\t *\tOne of DCD or CTS must be asserted.\n\t */\n\n#ifdef CONFIG_LMC_IGNORE_HARDWARE_HANDSHAKE\n        link_status = LMC_CSR_READ(sc, csr_gp_timer);\n        link_status = 0x0000ffff - ( link_status & 0x0000ffff);\n\n        return( link_status );\n#else  \n\n\tlink_status = lmc_mii_readreg(sc, 0, 16);\n\n        if ((link_status & LMC_MII16_SSI_DSR) == 0)\n\t\treturn (0);\n\n        if ((link_status & (LMC_MII16_SSI_CTS | LMC_MII16_SSI_DCD)) == 0)\n\t\treturn (0);\n\n\treturn (1);\n#endif\n}"
  },
  {
    "function_name": "lmc_ssi_set_speed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "655-690",
    "snippet": "static void\nlmc_ssi_set_speed(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tlmc_ctl_t *ictl = &sc->ictl;\n\tlmc_av9110_t *av;\n\n        /* original settings for clock rate of:\n         *  100 Khz (8,25,0,0,2) were incorrect\n         *  they should have been 80,125,1,3,3\n         *  There are 17 param combinations to produce this freq.\n         *  For 1.5 Mhz use 120,100,1,1,2 (226 param. combinations)\n         */\n\tif (ctl == NULL) {\n                av = &ictl->cardspec.ssi;\n                ictl->clock_rate = 1500000;\n\t\tav->f = ictl->clock_rate;\n                av->n = 120;\n                av->m = 100;\n                av->v = 1;\n                av->x = 1;\n\t\tav->r = 2;\n\n\t\twrite_av9110(sc, av->n, av->m, av->v, av->x, av->r);\n\t\treturn;\n\t}\n\n        av = &ctl->cardspec.ssi;\n\n\tif (av->f == 0)\n\t\treturn;\n\n\tictl->clock_rate = av->f;  /* really, this is the rate we are */\n        ictl->cardspec.ssi = *av;\n\n\twrite_av9110(sc, av->n, av->m, av->v, av->x, av->r);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_av9110",
          "args": [
            "sc",
            "av->n",
            "av->m",
            "av->v",
            "av->x",
            "av->r"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "write_av9110",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "798-846",
          "snippet": "static void\nwrite_av9110(lmc_softc_t *sc, u_int32_t n, u_int32_t m, u_int32_t v,\n\t     u_int32_t x, u_int32_t r)\n{\n\tint i;\n\n#if 0\n\tprintf(LMC_PRINTF_FMT \": speed %u, %d %d %d %d %d\\n\",\n\t       LMC_PRINTF_ARGS, sc->ictl.clock_rate,\n\t       n, m, v, x, r);\n#endif\n\n        sc->lmc_gpio |= LMC_GEP_SSI_GENERATOR;\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL | LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * Set the TXCLOCK, GENERATOR, SERIAL, and SERIALCLK\n\t * as outputs.\n\t */\n\tlmc_gpio_mkoutput(sc, (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                               | LMC_GEP_SSI_GENERATOR));\n\n        sc->lmc_gpio &= ~(LMC_GEP_SSI_GENERATOR);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * a shifting we will go...\n\t */\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, n >> i);\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, m >> i);\n\tfor (i = 0 ; i < 1 ; i++)\n\t\twrite_av9110_bit(sc, v >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, x >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, r >> i);\n\tfor (i = 0 ; i < 5 ; i++)\n\t\twrite_av9110_bit(sc, 0x17 >> i);\n\n\t/*\n\t * stop driving serial-related signals\n\t */\n\tlmc_gpio_mkinput(sc,\n\t\t\t (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                          | LMC_GEP_SSI_GENERATOR));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);",
            "static void\twrite_av9110(lmc_softc_t *, u_int32_t, u_int32_t, u_int32_t,\n\t\t\t     u_int32_t, u_int32_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\nstatic void\twrite_av9110(lmc_softc_t *, u_int32_t, u_int32_t, u_int32_t,\n\t\t\t     u_int32_t, u_int32_t);\n\nstatic void\nwrite_av9110(lmc_softc_t *sc, u_int32_t n, u_int32_t m, u_int32_t v,\n\t     u_int32_t x, u_int32_t r)\n{\n\tint i;\n\n#if 0\n\tprintf(LMC_PRINTF_FMT \": speed %u, %d %d %d %d %d\\n\",\n\t       LMC_PRINTF_ARGS, sc->ictl.clock_rate,\n\t       n, m, v, x, r);\n#endif\n\n        sc->lmc_gpio |= LMC_GEP_SSI_GENERATOR;\n\tsc->lmc_gpio &= ~(LMC_GEP_SERIAL | LMC_GEP_SERIALCLK);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * Set the TXCLOCK, GENERATOR, SERIAL, and SERIALCLK\n\t * as outputs.\n\t */\n\tlmc_gpio_mkoutput(sc, (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                               | LMC_GEP_SSI_GENERATOR));\n\n        sc->lmc_gpio &= ~(LMC_GEP_SSI_GENERATOR);\n\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\n\t/*\n\t * a shifting we will go...\n\t */\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, n >> i);\n\tfor (i = 0 ; i < 7 ; i++)\n\t\twrite_av9110_bit(sc, m >> i);\n\tfor (i = 0 ; i < 1 ; i++)\n\t\twrite_av9110_bit(sc, v >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, x >> i);\n\tfor (i = 0 ; i < 2 ; i++)\n\t\twrite_av9110_bit(sc, r >> i);\n\tfor (i = 0 ; i < 5 ; i++)\n\t\twrite_av9110_bit(sc, 0x17 >> i);\n\n\t/*\n\t * stop driving serial-related signals\n\t */\n\tlmc_gpio_mkinput(sc,\n\t\t\t (LMC_GEP_SERIAL | LMC_GEP_SERIALCLK\n                          | LMC_GEP_SSI_GENERATOR));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_set_speed(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tlmc_ctl_t *ictl = &sc->ictl;\n\tlmc_av9110_t *av;\n\n        /* original settings for clock rate of:\n         *  100 Khz (8,25,0,0,2) were incorrect\n         *  they should have been 80,125,1,3,3\n         *  There are 17 param combinations to produce this freq.\n         *  For 1.5 Mhz use 120,100,1,1,2 (226 param. combinations)\n         */\n\tif (ctl == NULL) {\n                av = &ictl->cardspec.ssi;\n                ictl->clock_rate = 1500000;\n\t\tav->f = ictl->clock_rate;\n                av->n = 120;\n                av->m = 100;\n                av->v = 1;\n                av->x = 1;\n\t\tav->r = 2;\n\n\t\twrite_av9110(sc, av->n, av->m, av->v, av->x, av->r);\n\t\treturn;\n\t}\n\n        av = &ctl->cardspec.ssi;\n\n\tif (av->f == 0)\n\t\treturn;\n\n\tictl->clock_rate = av->f;  /* really, this is the rate we are */\n        ictl->cardspec.ssi = *av;\n\n\twrite_av9110(sc, av->n, av->m, av->v, av->x, av->r);\n}"
  },
  {
    "function_name": "lmc_ssi_set_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "637-653",
    "snippet": "static void\nlmc_ssi_set_clock(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CLOCK_SOURCE_EXT) {\n                sc->lmc_gpio &= ~(LMC_GEP_SSI_TXCLOCK);\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tprintf(LMC_PRINTF_FMT \": clock external\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t} else {\n                sc->lmc_gpio |= LMC_GEP_SSI_TXCLOCK;\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_INT;\n\t\tprintf(LMC_PRINTF_FMT \": clock internal\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t}\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "LMC_PRINTF_FMT \": clock internal\\n\"",
            "LMC_PRINTF_ARGS"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_set_clock(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CLOCK_SOURCE_EXT) {\n                sc->lmc_gpio &= ~(LMC_GEP_SSI_TXCLOCK);\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tprintf(LMC_PRINTF_FMT \": clock external\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t} else {\n                sc->lmc_gpio |= LMC_GEP_SSI_TXCLOCK;\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_INT;\n\t\tprintf(LMC_PRINTF_FMT \": clock internal\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t}\n}"
  },
  {
    "function_name": "lmc_ssi_set_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "604-632",
    "snippet": "static void\nlmc_ssi_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_clock_source(sc, sc->ictl.clock_source);\n\t\tsc->lmc_media->set_speed(sc, &sc->ictl);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n\t/*\n\t * check for change in clock source\n\t */\n\tif (ctl->clock_source == LMC_CTL_CLOCK_SOURCE_INT\n            && sc->ictl.clock_source == LMC_CTL_CLOCK_SOURCE_EXT) {\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_INT);\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_INT;\n        } else if (ctl->clock_source == LMC_CTL_CLOCK_SOURCE_EXT\n                 && sc->ictl.clock_source == LMC_CTL_CLOCK_SOURCE_INT) {\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_EXT;\n\t}\n\n\tif (ctl->clock_rate != sc->ictl.clock_rate)\n\t\tsc->lmc_media->set_speed(sc, ctl);\n\n\tlmc_set_protocol(sc, ctl);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_set_protocol",
          "args": [
            "sc",
            "ctl"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_set_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "1172-1198",
          "snippet": "static void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_speed",
          "args": [
            "sc",
            "ctl"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "LMC_CTL_CLOCK_SOURCE_EXT"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "LMC_CTL_CLOCK_SOURCE_INT"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_speed",
          "args": [
            "sc",
            "&sc->ictl"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "sc->ictl.clock_source"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_clock_source(sc, sc->ictl.clock_source);\n\t\tsc->lmc_media->set_speed(sc, &sc->ictl);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n\t/*\n\t * check for change in clock source\n\t */\n\tif (ctl->clock_source == LMC_CTL_CLOCK_SOURCE_INT\n            && sc->ictl.clock_source == LMC_CTL_CLOCK_SOURCE_EXT) {\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_INT);\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_INT;\n        } else if (ctl->clock_source == LMC_CTL_CLOCK_SOURCE_EXT\n                 && sc->ictl.clock_source == LMC_CTL_CLOCK_SOURCE_INT) {\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_EXT;\n\t}\n\n\tif (ctl->clock_rate != sc->ictl.clock_rate)\n\t\tsc->lmc_media->set_speed(sc, ctl);\n\n\tlmc_set_protocol(sc, ctl);\n}"
  },
  {
    "function_name": "lmc_ssi_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "584-598",
    "snippet": "static void\nlmc_ssi_default(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = LMC_MII16_LED_ALL;\n\n\t/*\n\t * make TXCLOCK always be an output\n\t */\n        lmc_gpio_mkoutput(sc, LMC_GEP_SSI_TXCLOCK);\n\n\tsc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\tsc->lmc_media->set_speed(sc, NULL);\n\tsc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc->lmc_media->set_crc_length",
          "args": [
            "sc",
            "LMC_CTL_CRC_LENGTH_16"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_speed",
          "args": [
            "sc",
            "NULL"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "LMC_CTL_CLOCK_SOURCE_EXT"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_link_status",
          "args": [
            "sc",
            "LMC_LINK_DOWN"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lmc_gpio_mkoutput",
          "args": [
            "sc",
            "LMC_GEP_SSI_TXCLOCK"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_gpio_mkoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "186-191",
          "snippet": "void\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_default(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = LMC_MII16_LED_ALL;\n\n\t/*\n\t * make TXCLOCK always be an output\n\t */\n        lmc_gpio_mkoutput(sc, LMC_GEP_SSI_TXCLOCK);\n\n\tsc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\tsc->lmc_media->set_speed(sc, NULL);\n\tsc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}"
  },
  {
    "function_name": "lmc_ssi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "568-582",
    "snippet": "static void\nlmc_ssi_init(lmc_softc_t * const sc)\n{\n\tu_int16_t mii17;\n\tint cable;\n\n\tsc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC1000;\n\n\tmii17 = lmc_mii_readreg(sc, 0, 17);\n\n        cable = (mii17 & LMC_MII17_SSI_CABLE_MASK) >> LMC_MII17_SSI_CABLE_SHIFT;\n\tsc->ictl.cable_type = cable;\n\n        lmc_gpio_mkoutput(sc, LMC_GEP_SSI_TXCLOCK);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_gpio_mkoutput",
          "args": [
            "sc",
            "LMC_GEP_SSI_TXCLOCK"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_gpio_mkoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "186-191",
          "snippet": "void\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "17"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ssi_init(lmc_softc_t * const sc)\n{\n\tu_int16_t mii17;\n\tint cable;\n\n\tsc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC1000;\n\n\tmii17 = lmc_mii_readreg(sc, 0, 17);\n\n        cable = (mii17 & LMC_MII17_SSI_CABLE_MASK) >> LMC_MII17_SSI_CABLE_SHIFT;\n\tsc->ictl.cable_type = cable;\n\n        lmc_gpio_mkoutput(sc, LMC_GEP_SSI_TXCLOCK);\n}"
  },
  {
    "function_name": "lmc_ds3_set_crc_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "547-561",
    "snippet": "static void\nlmc_ds3_set_crc_length(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_CTL_CRC_LENGTH_32) {\n\t\t/* 32 bit */\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n\t} else {\n\t\t/* 16 bit */\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_set_crc_length(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_CTL_CRC_LENGTH_32) {\n\t\t/* 32 bit */\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n\t} else {\n\t\t/* 16 bit */\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_ds3_get_link_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "530-542",
    "snippet": "static int\nlmc_ds3_get_link_status(lmc_softc_t * const sc)\n{\n\tu_int16_t link_status;\n\n\tlmc_mii_writereg(sc, 0, 17, 7);\n\tlink_status = lmc_mii_readreg(sc, 0, 18);\n\n\tif ((link_status & LMC_FRAMER_REG0_DLOS) == 0)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "18"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "17",
            "7"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic int\nlmc_ds3_get_link_status(lmc_softc_t * const sc)\n{\n\tu_int16_t link_status;\n\n\tlmc_mii_writereg(sc, 0, 17, 7);\n\tlink_status = lmc_mii_readreg(sc, 0, 18);\n\n\tif ((link_status & LMC_FRAMER_REG0_DLOS) == 0)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "lmc_ds3_set_scram",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "513-524",
    "snippet": "static void\nlmc_ds3_set_scram(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_ON) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_ON;\n\t} else {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_OFF;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_set_scram(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_ON) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_ON;\n\t} else {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_OFF;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_ds3_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "480-508",
    "snippet": "static void\nlmc_ds3_init(lmc_softc_t * const sc)\n{\n\tint i;\n\n\tsc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC5245;\n\n\t/* writes zeros everywhere */\n\tfor (i = 0 ; i < 21 ; i++) {\n\t\tlmc_mii_writereg(sc, 0, 17, i);\n\t\tlmc_mii_writereg(sc, 0, 18, 0);\n\t}\n\n\t/* set some essential bits */\n\tlmc_mii_writereg(sc, 0, 17, 1);\n\tlmc_mii_writereg(sc, 0, 18, 0x05);\t/* ser, xtx */\n\n\tlmc_mii_writereg(sc, 0, 17, 5);\n\tlmc_mii_writereg(sc, 0, 18, 0x80);\t/* emode */\n\n\tlmc_mii_writereg(sc, 0, 17, 14);\n\tlmc_mii_writereg(sc, 0, 18, 0x30);\t/* rcgen, tcgen */\n\n\t/* clear counters and latched bits */\n\tfor (i = 0 ; i < 21 ; i++) {\n\t\tlmc_mii_writereg(sc, 0, 17, i);\n\t\tlmc_mii_readreg(sc, 0, 18);\n\t}\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "18"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "17",
            "i"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_init(lmc_softc_t * const sc)\n{\n\tint i;\n\n\tsc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC5245;\n\n\t/* writes zeros everywhere */\n\tfor (i = 0 ; i < 21 ; i++) {\n\t\tlmc_mii_writereg(sc, 0, 17, i);\n\t\tlmc_mii_writereg(sc, 0, 18, 0);\n\t}\n\n\t/* set some essential bits */\n\tlmc_mii_writereg(sc, 0, 17, 1);\n\tlmc_mii_writereg(sc, 0, 18, 0x05);\t/* ser, xtx */\n\n\tlmc_mii_writereg(sc, 0, 17, 5);\n\tlmc_mii_writereg(sc, 0, 18, 0x80);\t/* emode */\n\n\tlmc_mii_writereg(sc, 0, 17, 14);\n\tlmc_mii_writereg(sc, 0, 18, 0x30);\t/* rcgen, tcgen */\n\n\t/* clear counters and latched bits */\n\tfor (i = 0 ; i < 21 ; i++) {\n\t\tlmc_mii_writereg(sc, 0, 17, i);\n\t\tlmc_mii_readreg(sc, 0, 18);\n\t}\n}"
  },
  {
    "function_name": "lmc_ds3_set_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "450-478",
    "snippet": "static void\nlmc_ds3_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_cable_length(sc, sc->ictl.cable_length);\n\t\tsc->lmc_media->set_scrambler(sc, sc->ictl.scrambler_onoff);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n\t/*\n\t * check for change in cable length setting\n\t */\n\tif (ctl->cable_length && !sc->ictl.cable_length)\n\t\tlmc_ds3_set_100ft(sc, LMC_CTL_CABLE_LENGTH_GT_100FT);\n\telse if (!ctl->cable_length && sc->ictl.cable_length)\n\t\tlmc_ds3_set_100ft(sc, LMC_CTL_CABLE_LENGTH_LT_100FT);\n\n\t/*\n\t * Check for change in scrambler setting (requires reset)\n\t */\n\tif (ctl->scrambler_onoff && !sc->ictl.scrambler_onoff)\n\t\tlmc_ds3_set_scram(sc, LMC_CTL_ON);\n\telse if (!ctl->scrambler_onoff && sc->ictl.scrambler_onoff)\n\t\tlmc_ds3_set_scram(sc, LMC_CTL_OFF);\n\n\tlmc_set_protocol(sc, ctl);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_set_protocol",
          "args": [
            "sc",
            "ctl"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_set_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "1172-1198",
          "snippet": "static void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_ds3_set_scram",
          "args": [
            "sc",
            "LMC_CTL_OFF"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_ds3_set_scram",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "513-524",
          "snippet": "static void\nlmc_ds3_set_scram(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_ON) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_ON;\n\t} else {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_OFF;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_set_scram(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_ON) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_ON;\n\t} else {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_SCRAM;\n\t\tsc->ictl.scrambler_onoff = LMC_CTL_OFF;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_ds3_set_100ft",
          "args": [
            "sc",
            "LMC_CTL_CABLE_LENGTH_LT_100FT"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_ds3_set_100ft",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "422-433",
          "snippet": "static void\nlmc_ds3_set_100ft(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CABLE_LENGTH_GT_100FT) {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_GT_100FT;\n\t} else if (ie == LMC_CTL_CABLE_LENGTH_LT_100FT) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_LT_100FT;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_set_100ft(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CABLE_LENGTH_GT_100FT) {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_GT_100FT;\n\t} else if (ie == LMC_CTL_CABLE_LENGTH_LT_100FT) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_LT_100FT;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_scrambler",
          "args": [
            "sc",
            "sc->ictl.scrambler_onoff"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_cable_length",
          "args": [
            "sc",
            "sc->ictl.cable_length"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_cable_length(sc, sc->ictl.cable_length);\n\t\tsc->lmc_media->set_scrambler(sc, sc->ictl.scrambler_onoff);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n\t/*\n\t * check for change in cable length setting\n\t */\n\tif (ctl->cable_length && !sc->ictl.cable_length)\n\t\tlmc_ds3_set_100ft(sc, LMC_CTL_CABLE_LENGTH_GT_100FT);\n\telse if (!ctl->cable_length && sc->ictl.cable_length)\n\t\tlmc_ds3_set_100ft(sc, LMC_CTL_CABLE_LENGTH_LT_100FT);\n\n\t/*\n\t * Check for change in scrambler setting (requires reset)\n\t */\n\tif (ctl->scrambler_onoff && !sc->ictl.scrambler_onoff)\n\t\tlmc_ds3_set_scram(sc, LMC_CTL_ON);\n\telse if (!ctl->scrambler_onoff && sc->ictl.scrambler_onoff)\n\t\tlmc_ds3_set_scram(sc, LMC_CTL_OFF);\n\n\tlmc_set_protocol(sc, ctl);\n}"
  },
  {
    "function_name": "lmc_ds3_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "435-444",
    "snippet": "static void\nlmc_ds3_default(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = LMC_MII16_LED_ALL;\n\n\tsc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n\tsc->lmc_media->set_cable_length(sc, LMC_CTL_CABLE_LENGTH_LT_100FT);\n\tsc->lmc_media->set_scrambler(sc, LMC_CTL_OFF);\n\tsc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc->lmc_media->set_crc_length",
          "args": [
            "sc",
            "LMC_CTL_CRC_LENGTH_16"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_scrambler",
          "args": [
            "sc",
            "LMC_CTL_OFF"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_cable_length",
          "args": [
            "sc",
            "LMC_CTL_CABLE_LENGTH_LT_100FT"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_link_status",
          "args": [
            "sc",
            "LMC_LINK_DOWN"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_default(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = LMC_MII16_LED_ALL;\n\n\tsc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n\tsc->lmc_media->set_cable_length(sc, LMC_CTL_CABLE_LENGTH_LT_100FT);\n\tsc->lmc_media->set_scrambler(sc, LMC_CTL_OFF);\n\tsc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}"
  },
  {
    "function_name": "lmc_ds3_set_100ft",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "422-433",
    "snippet": "static void\nlmc_ds3_set_100ft(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CABLE_LENGTH_GT_100FT) {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_GT_100FT;\n\t} else if (ie == LMC_CTL_CABLE_LENGTH_LT_100FT) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_LT_100FT;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_set_100ft(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CABLE_LENGTH_GT_100FT) {\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_GT_100FT;\n\t} else if (ie == LMC_CTL_CABLE_LENGTH_LT_100FT) {\n\t\tsc->lmc_miireg16 |= LMC_MII16_DS3_ZERO;\n\t\tsc->ictl.cable_length = LMC_CTL_CABLE_LENGTH_LT_100FT;\n\t}\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_ds3_watchdog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "404-413",
    "snippet": "static void\nlmc_ds3_watchdog (lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = lmc_mii_readreg (sc, 0, 16);\n\tif (sc->lmc_miireg16 & 0x0018)\n\t{\n\t\tprintf(\"%s: AIS Recieved\\n\", sc->lmc_xname);\n\t\tlmc_led_on (sc, LMC_DS3_LED1 | LMC_DS3_LED2);\n\t}\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_led_on",
          "args": [
            "sc",
            "LMC_DS3_LED1 | LMC_DS3_LED2"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_led_on",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "193-198",
          "snippet": "void\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_led_on(lmc_softc_t * const sc, u_int32_t led)\n{\n\tsc->lmc_miireg16 &= ~led;\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: AIS Recieved\\n\"",
            "sc->lmc_xname"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "16"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_ds3_watchdog (lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = lmc_mii_readreg (sc, 0, 16);\n\tif (sc->lmc_miireg16 & 0x0018)\n\t{\n\t\tprintf(\"%s: AIS Recieved\\n\", sc->lmc_xname);\n\t\tlmc_led_on (sc, LMC_DS3_LED1 | LMC_DS3_LED2);\n\t}\n}"
  },
  {
    "function_name": "lmc_hssi_watchdog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "398-402",
    "snippet": "static void\nlmc_hssi_watchdog (lmc_softc_t * const sc)\n{\n\t/* HSSI is blank */\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_hssi_watchdog (lmc_softc_t * const sc)\n{\n\t/* HSSI is blank */\n}"
  },
  {
    "function_name": "lmc_hssi_set_crc_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "382-396",
    "snippet": "static void\nlmc_hssi_set_crc_length(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_CTL_CRC_LENGTH_32) {\n\t\t/* 32 bit */\n\t\tsc->lmc_miireg16 |= LMC_MII16_HSSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n\t} else {\n\t\t/* 16 bit */\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_HSSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_hssi_set_crc_length(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_CTL_CRC_LENGTH_32) {\n\t\t/* 32 bit */\n\t\tsc->lmc_miireg16 |= LMC_MII16_HSSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_32;\n\t} else {\n\t\t/* 16 bit */\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_HSSI_CRC;\n\t\tsc->ictl.crc_length = LMC_CTL_CRC_LENGTH_16;\n\t}\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_hssi_set_link_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "368-377",
    "snippet": "static void\nlmc_hssi_set_link_status(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_LINK_UP)\n\t\tsc->lmc_miireg16 |= LMC_MII16_HSSI_TA;\n\telse\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_HSSI_TA;\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_writereg",
          "args": [
            "sc",
            "0",
            "16",
            "sc->lmc_miireg16"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_writereg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "379-393",
          "snippet": "void\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nvoid\nlmc_mii_writereg(lmc_softc_t * const sc, u_int32_t devaddr,\n\t\t   u_int32_t regno, u_int32_t data)\n{\n    u_int32_t csr;\n\n    csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_WRCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_WRCMD);\n    lmc_mii_writebits(sc, data, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_hssi_set_link_status(lmc_softc_t * const sc, int state)\n{\n\tif (state == LMC_LINK_UP)\n\t\tsc->lmc_miireg16 |= LMC_MII16_HSSI_TA;\n\telse\n\t\tsc->lmc_miireg16 &= ~LMC_MII16_HSSI_TA;\n\n\tlmc_mii_writereg(sc, 0, 16, sc->lmc_miireg16);\n}"
  },
  {
    "function_name": "lmc_hssi_get_link_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "355-366",
    "snippet": "static int\nlmc_hssi_get_link_status(lmc_softc_t * const sc)\n{\n\tu_int16_t link_status;\n\n\tlink_status = lmc_mii_readreg(sc, 0, 16);\n\n\tif ((link_status & LMC_MII16_HSSI_CA) == LMC_MII16_HSSI_CA)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_mii_readreg",
          "args": [
            "sc",
            "0",
            "16"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_mii_readreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "362-377",
          "snippet": "u_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)"
          ],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MII_EMIT    do { LMC_CSR_WRITE(sc, csr_srom_mii, csr); lmc_delay_300ns(sc); } while (0)\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nu_int32_t\nlmc_mii_readreg(lmc_softc_t * const sc, u_int32_t devaddr, u_int32_t regno)\n{\n    u_int32_t csr = LMC_CSR_READ(sc, csr_srom_mii) & (MII_RD|MII_DOUT|MII_CLK);\n    u_int32_t data;\n\n    csr &= ~(MII_RD|MII_CLK); MII_EMIT;\n    lmc_mii_writebits(sc, MII_PREAMBLE, 32);\n    lmc_mii_writebits(sc, MII_RDCMD, 8);\n    lmc_mii_writebits(sc, devaddr, 5);\n    lmc_mii_writebits(sc, regno, 5);\n    lmc_mii_turnaround(sc, MII_RDCMD);\n\n    data = lmc_mii_readbits(sc);\n    return (data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic int\nlmc_hssi_get_link_status(lmc_softc_t * const sc)\n{\n\tu_int16_t link_status;\n\n\tlink_status = lmc_mii_readreg(sc, 0, 16);\n\n\tif ((link_status & LMC_MII16_HSSI_CA) == LMC_MII16_HSSI_CA)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "lmc_hssi_set_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "333-349",
    "snippet": "static void\nlmc_hssi_set_clock(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CLOCK_SOURCE_EXT) {\n\t\tsc->lmc_gpio |= LMC_GEP_HSSI_CLOCK;\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tprintf(LMC_PRINTF_FMT \": clock external\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t} else {\n\t\tsc->lmc_gpio &= ~(LMC_GEP_HSSI_CLOCK);\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_INT;\n\t\tprintf(LMC_PRINTF_FMT \": clock internal\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t}\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "LMC_PRINTF_FMT \": clock internal\\n\"",
            "LMC_PRINTF_ARGS"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LMC_CSR_WRITE",
          "args": [
            "sc",
            "csr_gp",
            "sc->lmc_gpio"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_hssi_set_clock(lmc_softc_t * const sc, int ie)\n{\n\tif (ie == LMC_CTL_CLOCK_SOURCE_EXT) {\n\t\tsc->lmc_gpio |= LMC_GEP_HSSI_CLOCK;\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tprintf(LMC_PRINTF_FMT \": clock external\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t} else {\n\t\tsc->lmc_gpio &= ~(LMC_GEP_HSSI_CLOCK);\n\t\tLMC_CSR_WRITE(sc, csr_gp, sc->lmc_gpio);\n\t\tsc->ictl.clock_source = LMC_CTL_CLOCK_SOURCE_INT;\n\t\tprintf(LMC_PRINTF_FMT \": clock internal\\n\",\n\t\t       LMC_PRINTF_ARGS);\n\t}\n}"
  },
  {
    "function_name": "lmc_hssi_set_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "306-328",
    "snippet": "static void\nlmc_hssi_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_clock_source(sc, sc->ictl.clock_source);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n\t/*\n\t * check for change in clock source\n\t */\n\tif (ctl->clock_source && !sc->ictl.clock_source) {\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_INT);\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_INT;\n\t} else if (!ctl->clock_source && sc->ictl.clock_source) {\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\t}\n\n\tlmc_set_protocol(sc, ctl);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_set_protocol",
          "args": [
            "sc",
            "ctl"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_set_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
          "lines": "1172-1198",
          "snippet": "static void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_init(lmc_softc_t * const);",
            "static void\tlmc_ds3_default(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
            "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
            "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
            "static void\tlmc_hssi_init(lmc_softc_t * const);",
            "static void\tlmc_hssi_default(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
            "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
            "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
            "static void     lmc_ssi_init(lmc_softc_t * const);",
            "static void     lmc_ssi_default(lmc_softc_t * const);",
            "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
            "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
            "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
            "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
            "static void\tlmc_t1_init(lmc_softc_t * const);",
            "static void\tlmc_t1_default(lmc_softc_t * const);",
            "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
            "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
            "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
            "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
            "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
            "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
            "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
            "static inline void write_av9110_bit(lmc_softc_t *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_set_protocol(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == 0) {\n\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\n\t\treturn;\n\t}\n\n#if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)\n\tif (ctl->keepalive_onoff != sc->ictl.keepalive_onoff) {\n\t\tswitch (ctl->keepalive_onoff) {\n\t\tcase LMC_CTL_ON:\n\t\t\tprintf(LMC_PRINTF_FMT \": enabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_ON;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO | PP_KEEPALIVE;\n\t\t\tbreak;\n\t\tcase LMC_CTL_OFF:\n\t\t\tprintf(LMC_PRINTF_FMT \": disabling keepalive\\n\",\n\t\t\t       LMC_PRINTF_ARGS);\n\t\t\tsc->ictl.keepalive_onoff = LMC_CTL_OFF;\n\t\t\tsc->lmc_sppp.pp_flags = PP_CISCO;\n\t\t}\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "LMC_CTL_CLOCK_SOURCE_EXT"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "LMC_CTL_CLOCK_SOURCE_INT"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "sc->ictl.clock_source"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_hssi_set_status(lmc_softc_t * const sc, lmc_ctl_t *ctl)\n{\n\tif (ctl == NULL) {\n\t\tsc->lmc_media->set_clock_source(sc, sc->ictl.clock_source);\n\t\tlmc_set_protocol(sc, NULL);\n\n\t\treturn;\n\t}\n\n\t/*\n\t * check for change in clock source\n\t */\n\tif (ctl->clock_source && !sc->ictl.clock_source) {\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_INT);\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_INT;\n\t} else if (!ctl->clock_source && sc->ictl.clock_source) {\n\t\tsc->lmc_timing = LMC_CTL_CLOCK_SOURCE_EXT;\n\t\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\t}\n\n\tlmc_set_protocol(sc, ctl);\n}"
  },
  {
    "function_name": "lmc_hssi_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "292-300",
    "snippet": "static void\nlmc_hssi_default(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = LMC_MII16_LED_ALL;\n\n\tsc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\tsc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc->lmc_media->set_crc_length",
          "args": [
            "sc",
            "LMC_CTL_CRC_LENGTH_16"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_clock_source",
          "args": [
            "sc",
            "LMC_CTL_CLOCK_SOURCE_EXT"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc->lmc_media->set_link_status",
          "args": [
            "sc",
            "LMC_LINK_DOWN"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_hssi_default(lmc_softc_t * const sc)\n{\n\tsc->lmc_miireg16 = LMC_MII16_LED_ALL;\n\n\tsc->lmc_media->set_link_status(sc, LMC_LINK_DOWN);\n\tsc->lmc_media->set_clock_source(sc, LMC_CTL_CLOCK_SOURCE_EXT);\n\tsc->lmc_media->set_crc_length(sc, LMC_CTL_CRC_LENGTH_16);\n}"
  },
  {
    "function_name": "lmc_hssi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "284-290",
    "snippet": "static void\nlmc_hssi_init(lmc_softc_t * const sc)\n{\n\tsc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC5200;\n\n\tlmc_gpio_mkoutput(sc, LMC_GEP_HSSI_CLOCK);\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lmc_gpio_mkoutput",
          "args": [
            "sc",
            "LMC_GEP_HSSI_CLOCK"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_gpio_mkoutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_common.c",
          "lines": "186-191",
          "snippet": "void\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmc_types.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nlmc_gpio_mkoutput(lmc_softc_t * const sc, u_int32_t bits)\n{\n\tsc->lmc_gpio_io |= bits;\n\tLMC_CSR_WRITE(sc, csr_gp, TULIP_GP_PINSET | (sc->lmc_gpio_io));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_hssi_init(lmc_softc_t * const sc)\n{\n\tsc->ictl.cardtype = LMC_CTL_CARDTYPE_LMC5200;\n\n\tlmc_gpio_mkoutput(sc, LMC_GEP_HSSI_CLOCK);\n}"
  },
  {
    "function_name": "lmc_dummy_set2_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "275-278",
    "snippet": "static void\nlmc_dummy_set2_1(lmc_softc_t * const sc, lmc_ctl_t *a)\n{\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_set_protocol(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_speed(lmc_softc_t * const, lmc_ctl_t *);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic void\tlmc_t1_set_status(lmc_softc_t * const, lmc_ctl_t *);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic void\tlmc_dummy_set2_1(lmc_softc_t * const, lmc_ctl_t *);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_dummy_set2_1(lmc_softc_t * const sc, lmc_ctl_t *a)\n{\n}"
  },
  {
    "function_name": "lmc_dummy_set_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc_media.c",
    "lines": "270-273",
    "snippet": "static void\nlmc_dummy_set_1(lmc_softc_t * const sc, int a)\n{\n}",
    "includes": [
      "#include \"i386/pci/if_lmcvar.h\"",
      "#include \"i386/pci/if_lmcioctl.h\"",
      "#include \"i386/pci/if_lmc_types.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
      "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
      "#include <dev/ic/dc21040reg.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcireg.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <i386/pci/pci.h>",
      "#include <i386/isa/isavar.h>",
      "#include <i386/isa/dma.h>",
      "#include <i386/isa/icu.h>",
      "#include <i386/isa/isa.h>",
      "#include <i386/pci/ic/dc21040.h>",
      "#include <pci/dc21040reg.h>",
      "#include <pci/pcivar.h>",
      "#include <pci.h>",
      "#include <vm/pmap.h>",
      "#include <net/if_c_hdlc.h>",
      "#include <net/if_p2p.h>",
      "#include <net/if_types.h>",
      "#include <net/netisr.h>",
      "#include <net/if.h>",
      "#include <net/netisr.h>",
      "#include <netinet/ip.h>",
      "#include <netinet/in_systm.h>",
      "#include <netinet/in.h>",
      "#include <net/if_sppp.h>",
      "#include <vm/vm_kern.h>",
      "#include <vm/vm_param.h>",
      "#include <vm/vm.h>",
      "#include <net/bpfdesc.h>",
      "#include <net/bpf.h>",
      "#include \"bpfilter.h\"",
      "#include <net/netisr.h>",
      "#include <net/if_dl.h>",
      "#include <net/if_types.h>",
      "#include <net/if.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/rnd.h>",
      "#include \"rnd.h\"",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/device.h>",
      "#include <machine/clock.h>",
      "#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */",
      "#include <sys/kernel.h>",
      "#include <sys/malloc.h>",
      "#include <sys/errno.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/socket.h>",
      "#include <sys/mbuf.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\tlmc_ds3_init(lmc_softc_t * const);",
      "static void\tlmc_ds3_default(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);",
      "static int\tlmc_ds3_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_set_scram(lmc_softc_t * const, int);",
      "static void\tlmc_ds3_watchdog(lmc_softc_t * const);",
      "static void\tlmc_hssi_init(lmc_softc_t * const);",
      "static void\tlmc_hssi_default(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_clock(lmc_softc_t * const, int);",
      "static int\tlmc_hssi_get_link_status(lmc_softc_t * const);",
      "static void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_hssi_watchdog(lmc_softc_t * const);",
      "static void     lmc_ssi_init(lmc_softc_t * const);",
      "static void     lmc_ssi_default(lmc_softc_t * const);",
      "static void     lmc_ssi_set_clock(lmc_softc_t * const, int);",
      "static int      lmc_ssi_get_link_status(lmc_softc_t * const);",
      "static void     lmc_ssi_set_link_status(lmc_softc_t * const, int);",
      "static void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_ssi_watchdog(lmc_softc_t * const);",
      "static void\tlmc_t1_init(lmc_softc_t * const);",
      "static void\tlmc_t1_default(lmc_softc_t * const);",
      "static int\tlmc_t1_get_link_status(lmc_softc_t * const);",
      "static void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);",
      "static void\tlmc_t1_set_clock(lmc_softc_t * const, int);",
      "static void\tlmc_t1_watchdog(lmc_softc_t * const);",
      "static void\tlmc_dummy_set_1(lmc_softc_t * const, int);",
      "static inline void write_av9110_bit(lmc_softc_t *, int);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmc_types.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\t/* only for declaration of wakeup() used by vm.h */\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void\tlmc_ds3_init(lmc_softc_t * const);\nstatic void\tlmc_ds3_default(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_100ft(lmc_softc_t * const, int);\nstatic int\tlmc_ds3_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_ds3_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_set_scram(lmc_softc_t * const, int);\nstatic void\tlmc_ds3_watchdog(lmc_softc_t * const);\nstatic void\tlmc_hssi_init(lmc_softc_t * const);\nstatic void\tlmc_hssi_default(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_clock(lmc_softc_t * const, int);\nstatic int\tlmc_hssi_get_link_status(lmc_softc_t * const);\nstatic void\tlmc_hssi_set_link_status(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_hssi_watchdog(lmc_softc_t * const);\nstatic void     lmc_ssi_init(lmc_softc_t * const);\nstatic void     lmc_ssi_default(lmc_softc_t * const);\nstatic void     lmc_ssi_set_clock(lmc_softc_t * const, int);\nstatic int      lmc_ssi_get_link_status(lmc_softc_t * const);\nstatic void     lmc_ssi_set_link_status(lmc_softc_t * const, int);\nstatic void     lmc_ssi_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_ssi_watchdog(lmc_softc_t * const);\nstatic void\tlmc_t1_init(lmc_softc_t * const);\nstatic void\tlmc_t1_default(lmc_softc_t * const);\nstatic int\tlmc_t1_get_link_status(lmc_softc_t * const);\nstatic void     lmc_t1_set_circuit_type(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_crc_length(lmc_softc_t * const, int);\nstatic void\tlmc_t1_set_clock(lmc_softc_t * const, int);\nstatic void\tlmc_t1_watchdog(lmc_softc_t * const);\nstatic void\tlmc_dummy_set_1(lmc_softc_t * const, int);\nstatic inline void write_av9110_bit(lmc_softc_t *, int);\n\nstatic void\nlmc_dummy_set_1(lmc_softc_t * const sc, int a)\n{\n}"
  }
]