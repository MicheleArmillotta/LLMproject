[
  {
    "function_name": "rf_FreeAllocList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_alloclist.c",
    "lines": "139-164",
    "snippet": "void \nrf_FreeAllocList(l)\n\tRF_AllocListElem_t *l;\n{\n\tint     i;\n\tRF_AllocListElem_t *temp, *p;\n\n\tfor (p = l; p; p = p->next) {\n\t\tRF_ASSERT(p->numPointers >= 0 && p->numPointers <= RF_POINTERS_PER_ALLOC_LIST_ELEMENT);\n\t\tfor (i = 0; i < p->numPointers; i++) {\n\t\t\tRF_ASSERT(p->pointers[i]);\n\t\t\tRF_Free(p->pointers[i], p->sizes[i]);\n\t\t}\n\t}\n\twhile (l) {\n\t\ttemp = l;\n\t\tl = l->next;\n\t\tif (al_free_list_count > RF_AL_FREELIST_MAX) {\n\t\t\tDO_FREE(temp, sizeof(*temp));\n\t\t} else {\n\t\t\ttemp->next = al_free_list;\n\t\t\tal_free_list = temp;\n\t\t\tal_free_list_count++;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_alloclist.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [
      "#define RF_AL_FREELIST_MAX 256"
    ],
    "globals_used": [
      "static RF_AllocListElem_t *al_free_list = NULL;",
      "static int al_free_list_count;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DO_FREE",
          "args": [
            "temp",
            "sizeof(*temp)"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_Free",
          "args": [
            "p->pointers[i]",
            "p->sizes[i]"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "p->pointers[i]"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "p->numPointers >= 0 && p->numPointers <= RF_POINTERS_PER_ALLOC_LIST_ELEMENT"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_alloclist.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define RF_AL_FREELIST_MAX 256\n\nstatic RF_AllocListElem_t *al_free_list = NULL;\nstatic int al_free_list_count;\n\nvoid \nrf_FreeAllocList(l)\n\tRF_AllocListElem_t *l;\n{\n\tint     i;\n\tRF_AllocListElem_t *temp, *p;\n\n\tfor (p = l; p; p = p->next) {\n\t\tRF_ASSERT(p->numPointers >= 0 && p->numPointers <= RF_POINTERS_PER_ALLOC_LIST_ELEMENT);\n\t\tfor (i = 0; i < p->numPointers; i++) {\n\t\t\tRF_ASSERT(p->pointers[i]);\n\t\t\tRF_Free(p->pointers[i], p->sizes[i]);\n\t\t}\n\t}\n\twhile (l) {\n\t\ttemp = l;\n\t\tl = l->next;\n\t\tif (al_free_list_count > RF_AL_FREELIST_MAX) {\n\t\t\tDO_FREE(temp, sizeof(*temp));\n\t\t} else {\n\t\t\ttemp->next = al_free_list;\n\t\t\tal_free_list = temp;\n\t\t\tal_free_list_count++;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "rf_real_AddToAllocList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_alloclist.c",
    "lines": "107-129",
    "snippet": "void \nrf_real_AddToAllocList(l, p, size, lockflag)\n\tRF_AllocListElem_t *l;\n\tvoid   *p;\n\tint     size;\n\tint     lockflag;\n{\n\tRF_AllocListElem_t *newelem;\n\n\tfor (; l->next; l = l->next)\n\t\tRF_ASSERT(l->numPointers == RF_POINTERS_PER_ALLOC_LIST_ELEMENT);\t/* find end of list */\n\n\tRF_ASSERT(l->numPointers >= 0 && l->numPointers <= RF_POINTERS_PER_ALLOC_LIST_ELEMENT);\n\tif (l->numPointers == RF_POINTERS_PER_ALLOC_LIST_ELEMENT) {\n\t\tnewelem = rf_real_MakeAllocList(lockflag);\n\t\tl->next = newelem;\n\t\tl = newelem;\n\t}\n\tl->pointers[l->numPointers] = p;\n\tl->sizes[l->numPointers] = size;\n\tl->numPointers++;\n\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_alloclist.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "RF_AllocListElem_t *\nrf_real_MakeAllocList(lockflag)\n\tint     lockflag;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_real_MakeAllocList",
          "args": [
            "lockflag"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "l->numPointers >= 0 && l->numPointers <= RF_POINTERS_PER_ALLOC_LIST_ELEMENT"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ASSERT",
          "args": [
            "l->numPointers == RF_POINTERS_PER_ALLOC_LIST_ELEMENT"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_alloclist.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nRF_AllocListElem_t *\nrf_real_MakeAllocList(lockflag)\n\tint     lockflag;\n\nvoid \nrf_real_AddToAllocList(l, p, size, lockflag)\n\tRF_AllocListElem_t *l;\n\tvoid   *p;\n\tint     size;\n\tint     lockflag;\n{\n\tRF_AllocListElem_t *newelem;\n\n\tfor (; l->next; l = l->next)\n\t\tRF_ASSERT(l->numPointers == RF_POINTERS_PER_ALLOC_LIST_ELEMENT);\t/* find end of list */\n\n\tRF_ASSERT(l->numPointers >= 0 && l->numPointers <= RF_POINTERS_PER_ALLOC_LIST_ELEMENT);\n\tif (l->numPointers == RF_POINTERS_PER_ALLOC_LIST_ELEMENT) {\n\t\tnewelem = rf_real_MakeAllocList(lockflag);\n\t\tl->next = newelem;\n\t\tl = newelem;\n\t}\n\tl->pointers[l->numPointers] = p;\n\tl->sizes[l->numPointers] = size;\n\tl->numPointers++;\n\n}"
  },
  {
    "function_name": "rf_ConfigureAllocList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_alloclist.c",
    "lines": "78-100",
    "snippet": "int \nrf_ConfigureAllocList(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\trc = rf_mutex_init(&alist_mutex);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init mutex file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\treturn (rc);\n\t}\n\tal_free_list = NULL;\n\tfl_hit_count = fl_miss_count = al_free_list_count = 0;\n\trc = rf_ShutdownCreate(listp, rf_ShutdownAllocList, NULL);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to add to shutdown list file %s line %d rc=%d\\n\",\n\t\t    __FILE__, __LINE__, rc);\n\t\trf_mutex_destroy(&alist_mutex);\n\t\treturn (rc);\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_alloclist.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "RF_DECLARE_STATIC_MUTEX(alist_mutex)\n\tstatic unsigned",
      "int fl_hit_count, fl_miss_count;",
      "static RF_AllocListElem_t *al_free_list = NULL;",
      "static int al_free_list_count;",
      "static void rf_ShutdownAllocList(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "&alist_mutex"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG3",
          "args": [
            "\"Unable to add to shutdown list file %s line %d rc=%d\\n\"",
            "__FILE__",
            "__LINE__",
            "rc"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_ShutdownCreate",
          "args": [
            "listp",
            "rf_ShutdownAllocList",
            "NULL"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG3",
          "args": [
            "\"Unable to init mutex file %s line %d rc=%d\\n\"",
            "__FILE__",
            "__LINE__",
            "rc"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_mutex_init",
          "args": [
            "&alist_mutex"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "rf_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "173-186",
          "snippet": "int \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_alloclist.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nRF_DECLARE_STATIC_MUTEX(alist_mutex)\n\tstatic unsigned;\nint fl_hit_count, fl_miss_count;\nstatic RF_AllocListElem_t *al_free_list = NULL;\nstatic int al_free_list_count;\nstatic void rf_ShutdownAllocList(void *);\n\nint \nrf_ConfigureAllocList(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\trc = rf_mutex_init(&alist_mutex);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init mutex file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\treturn (rc);\n\t}\n\tal_free_list = NULL;\n\tfl_hit_count = fl_miss_count = al_free_list_count = 0;\n\trc = rf_ShutdownCreate(listp, rf_ShutdownAllocList, NULL);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to add to shutdown list file %s line %d rc=%d\\n\",\n\t\t    __FILE__, __LINE__, rc);\n\t\trf_mutex_destroy(&alist_mutex);\n\t\treturn (rc);\n\t}\n\treturn (0);\n}"
  },
  {
    "function_name": "rf_ShutdownAllocList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_alloclist.c",
    "lines": "60-76",
    "snippet": "static void rf_ShutdownAllocList(ignored)\n\tvoid   *ignored;\n{\n\tRF_AllocListElem_t *p, *pt;\n\n\tfor (p = al_free_list; p;) {\n\t\tpt = p;\n\t\tp = p->next;\n\t\tDO_FREE(pt, sizeof(*pt));\n\t}\n\trf_mutex_destroy(&alist_mutex);\n\t/*\n        printf(\"Alloclist: Free list hit count %lu (%lu %%) miss count %lu (%lu %%)\\n\",\n\t       fl_hit_count, (100*fl_hit_count)/(fl_hit_count+fl_miss_count),\n\t       fl_miss_count, (100*fl_miss_count)/(fl_hit_count+fl_miss_count));\n        */\n}",
    "includes": [
      "#include \"rf_shutdown.h\"",
      "#include \"rf_general.h\"",
      "#include \"rf_etimer.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_alloclist.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "RF_DECLARE_STATIC_MUTEX(alist_mutex)\n\tstatic unsigned",
      "int fl_hit_count, fl_miss_count;",
      "static RF_AllocListElem_t *al_free_list = NULL;",
      "static void rf_ShutdownAllocList(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "&alist_mutex"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DO_FREE",
          "args": [
            "pt",
            "sizeof(*pt)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_etimer.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_alloclist.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nRF_DECLARE_STATIC_MUTEX(alist_mutex)\n\tstatic unsigned;\nint fl_hit_count, fl_miss_count;\nstatic RF_AllocListElem_t *al_free_list = NULL;\nstatic void rf_ShutdownAllocList(void *);\n\nstatic void rf_ShutdownAllocList(ignored)\n\tvoid   *ignored;\n{\n\tRF_AllocListElem_t *p, *pt;\n\n\tfor (p = al_free_list; p;) {\n\t\tpt = p;\n\t\tp = p->next;\n\t\tDO_FREE(pt, sizeof(*pt));\n\t}\n\trf_mutex_destroy(&alist_mutex);\n\t/*\n        printf(\"Alloclist: Free list hit count %lu (%lu %%) miss count %lu (%lu %%)\\n\",\n\t       fl_hit_count, (100*fl_hit_count)/(fl_hit_count+fl_miss_count),\n\t       fl_miss_count, (100*fl_miss_count)/(fl_hit_count+fl_miss_count));\n        */\n}"
  }
]