[
  {
    "function_name": "wsemul_vt100_translate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_keys.c",
    "lines": "87-212",
    "snippet": "int\nwsemul_vt100_translate(cookie, in, out)\n\tvoid *cookie;\n\tkeysym_t in;\n\tchar **out;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\tstatic char c;\n\n\tif (in >= KS_f1 && in <= KS_f20) {\n\t\t*out = vt100_fkeys[in - KS_f1];\n\t\treturn (5);\n\t}\n\tif (in >= KS_F1 && in <= KS_F20) {\n\t\t*out = vt100_fkeys[in - KS_F1];\n\t\treturn (5);\n\t}\n\tif (in >= KS_KP_F1 && in <= KS_KP_F4) {\n\t\t*out = vt100_pfkeys[in - KS_KP_F1];\n\t\treturn (3);\n\t}\n\tif (edp->flags & VTFL_APPLKEYPAD) {\n\t\tif (in >= KS_KP_0 && in <= KS_KP_9) {\n\t\t\t*out = vt100_numpad[in - KS_KP_0];\n\t\t\treturn (3);\n\t\t}\n\t\tswitch (in) {\n\t\t    case KS_KP_Tab:\n\t\t\t*out = \"\\033OI\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Enter:\n\t\t\t*out = \"\\033OM\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Multiply:\n\t\t\t*out = \"\\033Oj\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Add:\n\t\t\t*out = \"\\033Ok\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Separator:\n\t\t\t*out = \"\\033Ol\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Subtract:\n\t\t\t*out = \"\\033Om\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Decimal:\n\t\t\t*out = \"\\033On\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Divide:\n\t\t\t*out = \"\\033Oo\";\n\t\t\treturn (3);\n\t\t}\n\t} else {\n\t\tif (!(in & 0x80)) {\n\t\t\tc = in & 0xff; /* turn into ASCII */\n\t\t\t*out = &c;\n\t\t\treturn (1);\n\t\t}\n\t}\n\tswitch (in) {\n\t    case KS_Help:\n\t\t*out = vt100_fkeys[15 - 1];\n\t\treturn (5);\n\t    case KS_Execute: /* \"Do\" */\n\t\t*out = vt100_fkeys[16 - 1];\n\t\treturn (5);\n\t    case KS_Find:\n\t\t*out = \"\\033[1~\";\n\t\treturn (4);\n\t    case KS_Insert:\n\t    case KS_KP_Insert:\n\t\t*out = \"\\033[2~\";\n\t\treturn (4);\n\t    case KS_KP_Delete:\n\t\t*out = \"\\033[3~\";\n\t\treturn (4);\n\t    case KS_Select:\n\t\t*out = \"\\033[4~\";\n\t\treturn (4);\n\t    case KS_Prior:\n\t    case KS_KP_Prior:\n\t\t*out = \"\\033[5~\";\n\t\treturn (4);\n\t    case KS_Next:\n\t    case KS_KP_Next:\n\t\t*out = \"\\033[6~\";\n\t\treturn (4);\n\t    case KS_Home:\n\t    case KS_KP_Home:\n\t\t*out = \"\\033[7~\";\n\t\treturn (4);\n\t    case KS_End:\n\t    case KS_KP_End:\n\t\t*out = \"\\033[8~\";\n\t\treturn (4);\n\t    case KS_Up:\n\t    case KS_KP_Up:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OA\";\n\t\telse\n\t\t\t*out = \"\\033[A\";\n\t\treturn (3);\n\t    case KS_Down:\n\t    case KS_KP_Down:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OB\";\n\t\telse\n\t\t\t*out = \"\\033[B\";\n\t\treturn (3);\n\t    case KS_Left:\n\t    case KS_KP_Left:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OD\";\n\t\telse\n\t\t\t*out = \"\\033[D\";\n\t\treturn (3);\n\t    case KS_Right:\n\t    case KS_KP_Right:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OC\";\n\t\telse\n\t\t\t*out = \"\\033[C\";\n\t\treturn (3);\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsksymdef.h>",
      "#include <dev/wscons/wsksymvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *vt100_fkeys[] = {\n\t\"\\033[11~\",\t/* F1 */\n\t\"\\033[12~\",\n\t\"\\033[13~\",\t\t/* F1-F5 normally don't send codes */\n\t\"\\033[14~\",\n\t\"\\033[15~\",\t/* F5 */\n\t\"\\033[17~\",\t/* F6 */\n\t\"\\033[18~\",\n\t\"\\033[19~\",\n\t\"\\033[20~\",\n\t\"\\033[21~\",\n\t\"\\033[23~\",\t/* VT100: ESC */\n\t\"\\033[24~\",\t/* VT100: BS */\n\t\"\\033[25~\",\t/* VT100: LF */\n\t\"\\033[26~\",\n\t\"\\033[28~\",\t/* help */\n\t\"\\033[29~\",\t/* do */\n\t\"\\033[31~\",\n\t\"\\033[32~\",\n\t\"\\033[33~\",\n\t\"\\033[34~\",\t/* F20 */\n};",
      "static char *vt100_pfkeys[] = {\n\t\"\\033OP\",\t/* PF1 */\n\t\"\\033OQ\",\n\t\"\\033OR\",\n\t\"\\033OS\",\t/* PF4 */\n};",
      "static char *vt100_numpad[] = {\n\t\"\\033Op\",\t/* KP 0 */\n\t\"\\033Oq\",\t/* KP 1 */\n\t\"\\033Or\",\t/* KP 2 */\n\t\"\\033Os\",\t/* KP 3 */\n\t\"\\033Ot\",\t/* KP 4 */\n\t\"\\033Ou\",\t/* KP 5 */\n\t\"\\033Ov\",\t/* KP 6 */\n\t\"\\033Ow\",\t/* KP 7 */\n\t\"\\033Ox\",\t/* KP 8 */\n\t\"\\033Oy\",\t/* KP 9 */\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsksymdef.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic char *vt100_fkeys[] = {\n\t\"\\033[11~\",\t/* F1 */\n\t\"\\033[12~\",\n\t\"\\033[13~\",\t\t/* F1-F5 normally don't send codes */\n\t\"\\033[14~\",\n\t\"\\033[15~\",\t/* F5 */\n\t\"\\033[17~\",\t/* F6 */\n\t\"\\033[18~\",\n\t\"\\033[19~\",\n\t\"\\033[20~\",\n\t\"\\033[21~\",\n\t\"\\033[23~\",\t/* VT100: ESC */\n\t\"\\033[24~\",\t/* VT100: BS */\n\t\"\\033[25~\",\t/* VT100: LF */\n\t\"\\033[26~\",\n\t\"\\033[28~\",\t/* help */\n\t\"\\033[29~\",\t/* do */\n\t\"\\033[31~\",\n\t\"\\033[32~\",\n\t\"\\033[33~\",\n\t\"\\033[34~\",\t/* F20 */\n};\nstatic char *vt100_pfkeys[] = {\n\t\"\\033OP\",\t/* PF1 */\n\t\"\\033OQ\",\n\t\"\\033OR\",\n\t\"\\033OS\",\t/* PF4 */\n};\nstatic char *vt100_numpad[] = {\n\t\"\\033Op\",\t/* KP 0 */\n\t\"\\033Oq\",\t/* KP 1 */\n\t\"\\033Or\",\t/* KP 2 */\n\t\"\\033Os\",\t/* KP 3 */\n\t\"\\033Ot\",\t/* KP 4 */\n\t\"\\033Ou\",\t/* KP 5 */\n\t\"\\033Ov\",\t/* KP 6 */\n\t\"\\033Ow\",\t/* KP 7 */\n\t\"\\033Ox\",\t/* KP 8 */\n\t\"\\033Oy\",\t/* KP 9 */\n};\n\nint\nwsemul_vt100_translate(cookie, in, out)\n\tvoid *cookie;\n\tkeysym_t in;\n\tchar **out;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\tstatic char c;\n\n\tif (in >= KS_f1 && in <= KS_f20) {\n\t\t*out = vt100_fkeys[in - KS_f1];\n\t\treturn (5);\n\t}\n\tif (in >= KS_F1 && in <= KS_F20) {\n\t\t*out = vt100_fkeys[in - KS_F1];\n\t\treturn (5);\n\t}\n\tif (in >= KS_KP_F1 && in <= KS_KP_F4) {\n\t\t*out = vt100_pfkeys[in - KS_KP_F1];\n\t\treturn (3);\n\t}\n\tif (edp->flags & VTFL_APPLKEYPAD) {\n\t\tif (in >= KS_KP_0 && in <= KS_KP_9) {\n\t\t\t*out = vt100_numpad[in - KS_KP_0];\n\t\t\treturn (3);\n\t\t}\n\t\tswitch (in) {\n\t\t    case KS_KP_Tab:\n\t\t\t*out = \"\\033OI\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Enter:\n\t\t\t*out = \"\\033OM\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Multiply:\n\t\t\t*out = \"\\033Oj\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Add:\n\t\t\t*out = \"\\033Ok\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Separator:\n\t\t\t*out = \"\\033Ol\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Subtract:\n\t\t\t*out = \"\\033Om\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Decimal:\n\t\t\t*out = \"\\033On\";\n\t\t\treturn (3);\n\t\t    case KS_KP_Divide:\n\t\t\t*out = \"\\033Oo\";\n\t\t\treturn (3);\n\t\t}\n\t} else {\n\t\tif (!(in & 0x80)) {\n\t\t\tc = in & 0xff; /* turn into ASCII */\n\t\t\t*out = &c;\n\t\t\treturn (1);\n\t\t}\n\t}\n\tswitch (in) {\n\t    case KS_Help:\n\t\t*out = vt100_fkeys[15 - 1];\n\t\treturn (5);\n\t    case KS_Execute: /* \"Do\" */\n\t\t*out = vt100_fkeys[16 - 1];\n\t\treturn (5);\n\t    case KS_Find:\n\t\t*out = \"\\033[1~\";\n\t\treturn (4);\n\t    case KS_Insert:\n\t    case KS_KP_Insert:\n\t\t*out = \"\\033[2~\";\n\t\treturn (4);\n\t    case KS_KP_Delete:\n\t\t*out = \"\\033[3~\";\n\t\treturn (4);\n\t    case KS_Select:\n\t\t*out = \"\\033[4~\";\n\t\treturn (4);\n\t    case KS_Prior:\n\t    case KS_KP_Prior:\n\t\t*out = \"\\033[5~\";\n\t\treturn (4);\n\t    case KS_Next:\n\t    case KS_KP_Next:\n\t\t*out = \"\\033[6~\";\n\t\treturn (4);\n\t    case KS_Home:\n\t    case KS_KP_Home:\n\t\t*out = \"\\033[7~\";\n\t\treturn (4);\n\t    case KS_End:\n\t    case KS_KP_End:\n\t\t*out = \"\\033[8~\";\n\t\treturn (4);\n\t    case KS_Up:\n\t    case KS_KP_Up:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OA\";\n\t\telse\n\t\t\t*out = \"\\033[A\";\n\t\treturn (3);\n\t    case KS_Down:\n\t    case KS_KP_Down:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OB\";\n\t\telse\n\t\t\t*out = \"\\033[B\";\n\t\treturn (3);\n\t    case KS_Left:\n\t    case KS_KP_Left:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OD\";\n\t\telse\n\t\t\t*out = \"\\033[D\";\n\t\treturn (3);\n\t    case KS_Right:\n\t    case KS_KP_Right:\n\t\tif (edp->flags & VTFL_APPLCURSOR)\n\t\t\t*out = \"\\033OC\";\n\t\telse\n\t\t\t*out = \"\\033[C\";\n\t\treturn (3);\n\t}\n\treturn (0);\n}"
  }
]