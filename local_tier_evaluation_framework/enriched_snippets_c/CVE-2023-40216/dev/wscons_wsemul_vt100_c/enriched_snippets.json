[
  {
    "function_name": "wsemul_vt100_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "948-983",
    "snippet": "void\nwsemul_vt100_output(cookie, data, count, kernel)\n\tvoid *cookie;\n\tconst u_char *data;\n\tu_int count;\n\tint kernel;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\n#ifdef DIAGNOSTIC\n\tif (kernel && !edp->console)\n\t\tpanic(\"wsemul_vt100_output: kernel output, not console\");\n#endif\n\n\tif (edp->flags & VTFL_CURSORON)\n\t(*edp->emulops->cursor)(edp->emulcookie, 0,\n\t\t\t\tedp->crow, edp->ccol << edp->dw);\n\tfor (; count > 0; data++, count--) {\n\t\tif ((*data & 0x7f) < 0x20) {\n\t\t\twsemul_vt100_output_c0c1(edp, *data, kernel);\n\t\t\tcontinue;\n\t\t}\n\t\tif (edp->state == VT100_EMUL_STATE_NORMAL || kernel) {\n\t\t\twsemul_vt100_output_normal(edp, *data, kernel);\n\t\t\tcontinue;\n\t\t}\n#ifdef DIAGNOSTIC\n\t\tif (edp->state > sizeof(vt100_output) / sizeof(vt100_output[0]))\n\t\t\tpanic(\"wsemul_vt100: invalid state %d\\n\", edp->state);\n#endif\n\t\tedp->state = vt100_output[edp->state - 1](edp, *data);\n\t}\n\tif (edp->flags & VTFL_CURSORON)\n\t\t(*edp->emulops->cursor)(edp->emulcookie, 1,\n\t\t\t\tedp->crow, edp->ccol << edp->dw);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [
      "void\twsemul_vt100_output",
      "static void wsemul_vt100_output_normal",
      "static void wsemul_vt100_output_c0c1",
      "vt100_handler *vt100_output[] = {\n\twsemul_vt100_output_esc,\n\twsemul_vt100_output_csi,\n\twsemul_vt100_output_scs94,\n\twsemul_vt100_output_scs94_percent,\n\twsemul_vt100_output_scs96,\n\twsemul_vt100_output_scs96_percent,\n\twsemul_vt100_output_esc_hash,\n\twsemul_vt100_output_esc_spc,\n\twsemul_vt100_output_string,\n\twsemul_vt100_output_string_esc,\n\twsemul_vt100_output_dcs,\n\twsemul_vt100_output_dcs_dollar,\n};",
      "void *cookie;",
      "int ccol, crow;",
      "void *\nwsemul_vt100_attach(console, type, cookie, ccol, crow, cbcookie, defattr)\n\tint console;",
      "void *cookie;",
      "int ccol, crow;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "1",
            "edp->crow",
            "edp->ccol << edp->dw"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vt100_output[edp->state - 1]",
          "args": [
            "edp",
            "*data"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"wsemul_vt100: invalid state %d\\n\"",
            "edp->state"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_output_normal",
          "args": [
            "edp",
            "*data",
            "kernel"
          ],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_output_normal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
          "lines": "316-358",
          "snippet": "static void\nwsemul_vt100_output_normal(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int *ct, dc;\n\n\tif ((edp->flags & (VTFL_LASTCHAR | VTFL_DECAWM)) ==\n\t    (VTFL_LASTCHAR | VTFL_DECAWM)) {\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t}\n\n\tif (c & 0x80) {\n\t\tc &= 0x7f;\n\t\tct = edp->chartab_G[edp->chartab1];\n\t} else {\n\t\tif (edp->sschartab) {\n\t\t\tct = edp->chartab_G[edp->sschartab];\n\t\t\tedp->sschartab = 0;\n\t\t} else\n\t\t\tct = edp->chartab_G[edp->chartab0];\n\t}\n\tdc = (ct ? ct[c] : c);\n\n\tif ((edp->flags & VTFL_INSERTMODE) && COLS_LEFT)\n\t\tCOPYCOLS(edp->ccol, edp->ccol + 1, COLS_LEFT);\n\n\t(*edp->emulops->putchar)(edp->emulcookie, edp->crow,\n\t\t\t\t edp->ccol << edp->dw, dc,\n\t\t\t\t kernel ? edp->kernattr : edp->curattr);\n\n\tif (COLS_LEFT)\n\t\tedp->ccol++;\n\telse\n\t\tedp->flags |= VTFL_LASTCHAR;\n}",
          "includes": [
            "#include <dev/wscons/ascii.h>",
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/malloc.h>",
            "#include <sys/time.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void wsemul_vt100_output_normal",
            "int ccol, crow;",
            "int ccol, crow;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void wsemul_vt100_output_normal;\nint ccol, crow;\nint ccol, crow;\n\nstatic void\nwsemul_vt100_output_normal(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int *ct, dc;\n\n\tif ((edp->flags & (VTFL_LASTCHAR | VTFL_DECAWM)) ==\n\t    (VTFL_LASTCHAR | VTFL_DECAWM)) {\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t}\n\n\tif (c & 0x80) {\n\t\tc &= 0x7f;\n\t\tct = edp->chartab_G[edp->chartab1];\n\t} else {\n\t\tif (edp->sschartab) {\n\t\t\tct = edp->chartab_G[edp->sschartab];\n\t\t\tedp->sschartab = 0;\n\t\t} else\n\t\t\tct = edp->chartab_G[edp->chartab0];\n\t}\n\tdc = (ct ? ct[c] : c);\n\n\tif ((edp->flags & VTFL_INSERTMODE) && COLS_LEFT)\n\t\tCOPYCOLS(edp->ccol, edp->ccol + 1, COLS_LEFT);\n\n\t(*edp->emulops->putchar)(edp->emulcookie, edp->crow,\n\t\t\t\t edp->ccol << edp->dw, dc,\n\t\t\t\t kernel ? edp->kernattr : edp->curattr);\n\n\tif (COLS_LEFT)\n\t\tedp->ccol++;\n\telse\n\t\tedp->flags |= VTFL_LASTCHAR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_output_c0c1",
          "args": [
            "edp",
            "*data",
            "kernel"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_output_c0c1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
          "lines": "360-446",
          "snippet": "static void\nwsemul_vt100_output_c0c1(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int n;\n\n\tswitch (c) {\n\t    case ASCII_NUL:\n\t    default:\n\t\t/* ignore */\n\t\tbreak;\n\t    case ASCII_BEL:\n\t\twsdisplay_emulbell(edp->cbcookie);\n\t\tbreak;\n\t    case ASCII_BS:\n\t\tif (edp->ccol > 0) {\n\t\t\tedp->ccol--;\n\t\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\t}\n\t\tbreak;\n\t    case ASCII_CR:\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case ASCII_HT:\n\t\tif (edp->tabs) {\n\t\t\tif (!COLS_LEFT)\n\t\t\t\tbreak;\n\t\t\tfor (n = edp->ccol + 1; n < NCOLS - 1; n++)\n\t\t\t\tif (edp->tabs[n])\n\t\t\t\t\tbreak;\n\t\t} else {\n\t\t\tn = edp->ccol + min(8 - (edp->ccol & 7), COLS_LEFT);\n\t\t}\n\t\tedp->ccol = n;\n\t\tbreak;\n\t    case ASCII_SO: /* LS1 */\n\t\tedp->chartab0 = 1;\n\t\tbreak;\n\t    case ASCII_SI: /* LS0 */\n\t\tedp->chartab0 = 0;\n\t\tbreak;\n\t    case ASCII_ESC:\n#ifdef DIAGNOSTIC\n\t\tif (kernel)\n\t\t\tpanic(\"ESC in kernel output\");\n#endif\n\t\tif (edp->state == VT100_EMUL_STATE_STRING) {\n\t\t\t/* might be a string end */\n\t\t\tedp->state = VT100_EMUL_STATE_STRING_ESC;\n\t\t} else {\n\t\t\t/* XXX cancel current escape sequence */\n\t\t\tedp->state = VT100_EMUL_STATE_ESC;\n\t\t}\n\t\tbreak;\n#if 0\n\t    case CSI: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->modif1 = edp->modif2 = '\\0';\n\t\tedp->state = VT100_EMUL_STATE_CSI;\n\t\tbreak;\n\t    case DCS: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->state = VT100_EMUL_STATE_DCS;\n\t\tbreak;\n\t    case ST: /* string end 8-bit */\n\t\t/* XXX only in VT100_EMUL_STATE_STRING */\n\t\twsemul_vt100_handle_dcs(edp);\n\t\treturn (VT100_EMUL_STATE_NORMAL);\n#endif\n\t    case ASCII_LF:\n\t    case ASCII_VT:\n\t    case ASCII_FF:\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/wscons/ascii.h>",
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/malloc.h>",
            "#include <sys/time.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */",
            "#define\tVT100_EMUL_STATE_STRING_ESC\t10\t/* waiting for ST, got ESC */",
            "#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */",
            "#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */",
            "#define\tVT100_EMUL_STATE_ESC\t\t1\t/* got ESC */",
            "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
          ],
          "globals_used": [
            "static void wsemul_vt100_output_c0c1",
            "int ccol, crow;",
            "int ccol, crow;",
            "void *cbcookie;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */\n#define\tVT100_EMUL_STATE_STRING_ESC\t10\t/* waiting for ST, got ESC */\n#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */\n#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */\n#define\tVT100_EMUL_STATE_ESC\t\t1\t/* got ESC */\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic void wsemul_vt100_output_c0c1;\nint ccol, crow;\nint ccol, crow;\nvoid *cbcookie;\n\nstatic void\nwsemul_vt100_output_c0c1(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int n;\n\n\tswitch (c) {\n\t    case ASCII_NUL:\n\t    default:\n\t\t/* ignore */\n\t\tbreak;\n\t    case ASCII_BEL:\n\t\twsdisplay_emulbell(edp->cbcookie);\n\t\tbreak;\n\t    case ASCII_BS:\n\t\tif (edp->ccol > 0) {\n\t\t\tedp->ccol--;\n\t\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\t}\n\t\tbreak;\n\t    case ASCII_CR:\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case ASCII_HT:\n\t\tif (edp->tabs) {\n\t\t\tif (!COLS_LEFT)\n\t\t\t\tbreak;\n\t\t\tfor (n = edp->ccol + 1; n < NCOLS - 1; n++)\n\t\t\t\tif (edp->tabs[n])\n\t\t\t\t\tbreak;\n\t\t} else {\n\t\t\tn = edp->ccol + min(8 - (edp->ccol & 7), COLS_LEFT);\n\t\t}\n\t\tedp->ccol = n;\n\t\tbreak;\n\t    case ASCII_SO: /* LS1 */\n\t\tedp->chartab0 = 1;\n\t\tbreak;\n\t    case ASCII_SI: /* LS0 */\n\t\tedp->chartab0 = 0;\n\t\tbreak;\n\t    case ASCII_ESC:\n#ifdef DIAGNOSTIC\n\t\tif (kernel)\n\t\t\tpanic(\"ESC in kernel output\");\n#endif\n\t\tif (edp->state == VT100_EMUL_STATE_STRING) {\n\t\t\t/* might be a string end */\n\t\t\tedp->state = VT100_EMUL_STATE_STRING_ESC;\n\t\t} else {\n\t\t\t/* XXX cancel current escape sequence */\n\t\t\tedp->state = VT100_EMUL_STATE_ESC;\n\t\t}\n\t\tbreak;\n#if 0\n\t    case CSI: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->modif1 = edp->modif2 = '\\0';\n\t\tedp->state = VT100_EMUL_STATE_CSI;\n\t\tbreak;\n\t    case DCS: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->state = VT100_EMUL_STATE_DCS;\n\t\tbreak;\n\t    case ST: /* string end 8-bit */\n\t\t/* XXX only in VT100_EMUL_STATE_STRING */\n\t\twsemul_vt100_handle_dcs(edp);\n\t\treturn (VT100_EMUL_STATE_NORMAL);\n#endif\n\t    case ASCII_LF:\n\t    case ASCII_VT:\n\t    case ASCII_FF:\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "0",
            "edp->crow",
            "edp->ccol << edp->dw"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"wsemul_vt100_output: kernel output, not console\""
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nvoid\twsemul_vt100_output;\nstatic void wsemul_vt100_output_normal;\nstatic void wsemul_vt100_output_c0c1;\nvt100_handler *vt100_output[] = {\n\twsemul_vt100_output_esc,\n\twsemul_vt100_output_csi,\n\twsemul_vt100_output_scs94,\n\twsemul_vt100_output_scs94_percent,\n\twsemul_vt100_output_scs96,\n\twsemul_vt100_output_scs96_percent,\n\twsemul_vt100_output_esc_hash,\n\twsemul_vt100_output_esc_spc,\n\twsemul_vt100_output_string,\n\twsemul_vt100_output_string_esc,\n\twsemul_vt100_output_dcs,\n\twsemul_vt100_output_dcs_dollar,\n};\nvoid *cookie;\nint ccol, crow;\nvoid *\nwsemul_vt100_attach(console, type, cookie, ccol, crow, cbcookie, defattr)\n\tint console;\nvoid *cookie;\nint ccol, crow;\n\nvoid\nwsemul_vt100_output(cookie, data, count, kernel)\n\tvoid *cookie;\n\tconst u_char *data;\n\tu_int count;\n\tint kernel;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\n#ifdef DIAGNOSTIC\n\tif (kernel && !edp->console)\n\t\tpanic(\"wsemul_vt100_output: kernel output, not console\");\n#endif\n\n\tif (edp->flags & VTFL_CURSORON)\n\t(*edp->emulops->cursor)(edp->emulcookie, 0,\n\t\t\t\tedp->crow, edp->ccol << edp->dw);\n\tfor (; count > 0; data++, count--) {\n\t\tif ((*data & 0x7f) < 0x20) {\n\t\t\twsemul_vt100_output_c0c1(edp, *data, kernel);\n\t\t\tcontinue;\n\t\t}\n\t\tif (edp->state == VT100_EMUL_STATE_NORMAL || kernel) {\n\t\t\twsemul_vt100_output_normal(edp, *data, kernel);\n\t\t\tcontinue;\n\t\t}\n#ifdef DIAGNOSTIC\n\t\tif (edp->state > sizeof(vt100_output) / sizeof(vt100_output[0]))\n\t\t\tpanic(\"wsemul_vt100: invalid state %d\\n\", edp->state);\n#endif\n\t\tedp->state = vt100_output[edp->state - 1](edp, *data);\n\t}\n\tif (edp->flags & VTFL_CURSORON)\n\t\t(*edp->emulops->cursor)(edp->emulcookie, 1,\n\t\t\t\tedp->crow, edp->ccol << edp->dw);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_csi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "904-946",
    "snippet": "static u_int\nwsemul_vt100_output_csi(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_CSI;\n\n\tswitch (c) {\n\t    case '0': case '1': case '2': case '3': case '4':\n\t    case '5': case '6': case '7': case '8': case '9':\n\t\t/* argument digit */\n\t\tif (edp->nargs > VT100_EMUL_NARGS - 1)\n\t\t\tbreak;\n\t\tedp->args[edp->nargs] = (edp->args[edp->nargs] * 10) +\n\t\t    (c - '0');\n\t\tbreak;\n\t    case ';': /* argument terminator */\n\t\tedp->nargs++;\n\t\tbreak;\n\t    case '?': /* DEC specific */\n\t    case '>': /* DA query */\n\t\tedp->modif1 = c;\n\t\tbreak;\n\t    case '!':\n\t    case '\"':\n\t    case '$':\n\t    case '&':\n\t\tedp->modif2 = c;\n\t\tbreak;\n\t    default: /* end of escape sequence */\n\t\tedp->nargs++;\n\t\tif (edp->nargs > VT100_EMUL_NARGS) {\n#ifdef VT100_DEBUG\n\t\t\tprintf(\"vt100: too many arguments\\n\");\n#endif\n\t\t\tedp->nargs = VT100_EMUL_NARGS;\n\t\t}\n\t\twsemul_vt100_handle_csi(edp, c);\n\t\tnewstate = VT100_EMUL_STATE_NORMAL;\n\t\tbreak;\n\t}\n\treturn (newstate);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */",
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wsemul_vt100_handle_csi",
          "args": [
            "edp",
            "c"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_handle_csi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "195-622",
          "snippet": "void\nwsemul_vt100_handle_csi(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tint n, help, flags, fgcol, bgcol;\n\tlong attr, bkgdattr;\n\n#define A3(a, b, c) (((a) << 16) | ((b) << 8) | (c))\n\tswitch (A3(edp->modif1, edp->modif2, c)) {\n\t    case A3('>', '\\0', 'c'): /* DA secondary */\n\t\twsdisplay_emulinput(edp->cbcookie, WSEMUL_VT_ID2,\n\t\t\t\t    sizeof(WSEMUL_VT_ID2));\n\t\tbreak;\n\n\t    case A3('\\0', '\\0', 'J'): /* ED selective erase in display */\n\t    case A3('?', '\\0', 'J'): /* DECSED selective erase in display */\n\t\twsemul_vt100_ed(edp, ARG(0));\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'K'): /* EL selective erase in line */\n\t    case A3('?', '\\0', 'K'): /* DECSEL selective erase in line */\n\t\twsemul_vt100_el(edp, ARG(0));\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'h'): /* SM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_ansimode(edp, ARG(n), VTMODE_SET);\n\t\tbreak;\n\t    case A3('?', '\\0', 'h'): /* DECSM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_decmode(edp, ARG(n), VTMODE_SET);\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'l'): /* RM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_ansimode(edp, ARG(n), VTMODE_RESET);\n\t\tbreak;;\n\t    case A3('?', '\\0', 'l'): /* DECRM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_decmode(edp, ARG(n), VTMODE_RESET);\n\t\tbreak;;\n\t    case A3('\\0', '$', 'p'): /* DECRQM request mode ANSI */\n\t\tvt100_ansimode(edp, ARG(0), VTMODE_REPORT);\n\t\tbreak;\n\t    case A3('?', '$', 'p'): /* DECRQM request mode DEC */\n\t\tvt100_decmode(edp, ARG(0), VTMODE_REPORT);\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'i'): /* MC printer controller mode */\n\t    case A3('?', '\\0', 'i'): /* MC printer controller mode */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* print screen */\n\t\t    case 1: /* print cursor line */\n\t\t    case 4: /* off */\n\t\t    case 5: /* on */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%di ignored\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%di unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\n#define A2(a, b) (((a) << 8) | (b))\n\t    case A2('!', 'p'): /* DECSTR soft reset VT300 only */\n\t\twsemul_vt100_reset(edp);\n\t\tbreak;\n\n\t    case A2('\"', 'p'): /* DECSCL */\n\t\tswitch (ARG(0)) {\n\t\t    case 61: /* VT100 mode (no further arguments!) */\n\t\t\tbreak;\n\t\t    case 62:\n\t\t    case 63: /* VT300 mode */\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d\\\"p unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tswitch (ARG(1)) {\n\t\t    case 0:\n\t\t    case 2: /* 8-bit controls */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%d;%d\\\"p ignored\\n\", ARG(0), ARG(1));\n#endif\n\t\t\tbreak;\n\t\t    case 1: /* 7-bit controls */\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d;%d\\\"p unknown\\n\", ARG(0), ARG(1));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('\"', 'q'): /* DECSCA select character attribute VT300 */\n\t\tswitch (ARG(0)) {\n\t\t    case 0:\n\t\t    case 1: /* erasable */\n\t\t\tbreak;\n\t\t    case 2: /* not erasable */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI2\\\"q ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d\\\"q unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\n\t    case A2('$', 'u'): /* DECRQTSR request terminal status report */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* ignored */\n\t\t\tbreak;\n\t\t    case 1: /* terminal state report */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI1$u ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$u unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('$', 'w'): /* DECRQPSR request presentation status report\n\t\t\t\t(VT300 only) */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* error */\n\t\t\tbreak;\n\t\t    case 1: /* cursor information report */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI1$w ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    case 2: /* tab stop report */\n\t\t\t{\n\t\t\tint i, n, ps = 0;\n\t\t\tchar buf[20];\n\t\t\tKASSERT(edp->tabs != 0);\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033P2$u\", 5);\n\t\t\tfor (i = 0; i < edp->ncols; i++)\n\t\t\t\tif (edp->tabs[i]) {\n\t\t\t\t\tn = sprintf(buf, \"%s%d\",\n\t\t\t\t\t\t    (ps ? \"/\" : \"\"), i + 1);\n\t\t\t\t\twsdisplay_emulinput(edp->cbcookie,\n\t\t\t\t\t\t\t    buf, n);\n\t\t\t\t\tps = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033\\\\\", 2);\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$w unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('$', '}'): /* DECSASD select active status display */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* main display */\n\t\t    case 1: /* status line */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%d$} ignored\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$} unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('$', '~'): /* DECSSDD select status line type */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* none */\n\t\t    case 1: /* indicator */\n\t\t    case 2: /* host-writable */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%d$~ ignored\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$~ unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\n\t    case A2('&', 'u'): /* DECRQUPSS request user preferred\n\t\t\t\t  supplemental set */\n\t\twsdisplay_emulinput(edp->emulcookie, \"\\033P0!u%5\\033\\\\\", 9);\n\t\tbreak;\n\n\t    case '@': /* ICH insert character VT300 only */\n\t\tn = min(DEF1_ARG(0), COLS_LEFT + 1);\n\t\thelp = NCOLS - (edp->ccol + n);\n\t\tif (help > 0)\n\t\t\tCOPYCOLS(edp->ccol, edp->ccol + n, help);\n\t\tERASECOLS(edp->ccol, n, edp->bkgdattr);\n\t\tbreak;\n\t    case 'A': /* CUU */\n\t\tedp->crow -= min(DEF1_ARG(0), ROWS_ABOVE);\n\t\tCHECK_DW;\n\t\tbreak;\n\t    case 'B': /* CUD */\n\t\tedp->crow += min(DEF1_ARG(0), ROWS_BELOW);\n\t\tCHECK_DW;\n\t\tbreak;\n\t    case 'C': /* CUF */\n\t\tedp->ccol += min(DEF1_ARG(0), COLS_LEFT);\n\t\tbreak;\n\t    case 'D': /* CUB */\n\t\tedp->ccol -= min(DEF1_ARG(0), edp->ccol);\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case 'H': /* CUP */\n\t    case 'f': /* HVP */\n\t\tif (edp->flags & VTFL_DECOM)\n\t\t\tedp->crow = edp->scrreg_startrow +\n\t\t\t    min(DEF1_ARG(0), edp->scrreg_nrows) - 1;\n\t\telse\n\t\t\tedp->crow = min(DEF1_ARG(0), edp->nrows) - 1;\n\t\tCHECK_DW;\n\t\tedp->ccol = min(DEF1_ARG(1), NCOLS) - 1;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case 'L': /* IL insert line */\n\t    case 'M': /* DL delete line */\n\t\tn = min(DEF1_ARG(0), ROWS_BELOW + 1);\n\t\t{\n\t\tint savscrstartrow, savscrnrows;\n\t\tsavscrstartrow = edp->scrreg_startrow;\n\t\tsavscrnrows = edp->scrreg_nrows;\n\t\tedp->scrreg_nrows -= ROWS_ABOVE;\n\t\tedp->scrreg_startrow = edp->crow;\n\t\tif (c == 'L')\n\t\t\twsemul_vt100_scrolldown(edp, n);\n\t\telse\n\t\t\twsemul_vt100_scrollup(edp, n);\n\t\tedp->scrreg_startrow = savscrstartrow;\n\t\tedp->scrreg_nrows = savscrnrows;\n\t\t}\n\t\tbreak;\n\t    case 'P': /* DCH delete character */\n\t\tn = min(DEF1_ARG(0), COLS_LEFT + 1);\n\t\thelp = NCOLS - (edp->ccol + n);\n\t\tif (help > 0)\n\t\t\tCOPYCOLS(edp->ccol + n, edp->ccol, help);\n\t\tERASECOLS(NCOLS - n, n, edp->bkgdattr);\n\t\tbreak;\n\t    case 'X': /* ECH erase character */\n\t\tn = min(DEF1_ARG(0), COLS_LEFT + 1);\n\t\tERASECOLS(edp->ccol, n, edp->bkgdattr);\n\t\tbreak;\n\t    case 'c': /* DA primary */\n\t\tif (ARG(0) == 0)\n\t\t\twsdisplay_emulinput(edp->cbcookie, WSEMUL_VT_ID1,\n\t\t\t\t\t    sizeof(WSEMUL_VT_ID1));\n\t\tbreak;\n\t    case 'g': /* TBC */\n\t\tKASSERT(edp->tabs != 0);\n\t\tswitch (ARG(0)) {\n\t\t    case 0:\n\t\t\tedp->tabs[edp->ccol] = 0;\n\t\t\tbreak;\n\t\t    case 3:\n\t\t\tbzero(edp->tabs, edp->ncols);\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%dg unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case 'm': /* SGR select graphic rendition */\n\t\tflags = edp->attrflags;\n\t\tfgcol = edp->fgcol;\n\t\tbgcol = edp->bgcol;\n\t\tfor (n = 0; n < edp->nargs; n++) {\n\t\t\tswitch (ARG(n)) {\n\t\t\t    case 0: /* reset */\n\t\t\t\tif (n == edp->nargs - 1) {\n\t\t\t\t\tedp->bkgdattr = edp->curattr = edp->defattr;\n\t\t\t\t\tedp->attrflags = 0;\n\t\t\t\t\tedp->fgcol = WSCOL_WHITE;\n\t\t\t\t\tedp->bgcol = WSCOL_BLACK;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tflags = 0;\n\t\t\t\tfgcol = WSCOL_WHITE;\n\t\t\t\tbgcol = WSCOL_BLACK;\n\t\t\t\tbreak;\n\t\t\t    case 1: /* bold */\n\t\t\t\tflags |= WSATTR_HILIT;\n\t\t\t\tbreak;\n\t\t\t    case 4: /* underline */\n\t\t\t\tflags |= WSATTR_UNDERLINE;\n\t\t\t\tbreak;\n\t\t\t    case 5: /* blink */\n\t\t\t\tflags |= WSATTR_BLINK;\n\t\t\t\tbreak;\n\t\t\t    case 7: /* reverse */\n\t\t\t\tflags |= WSATTR_REVERSE;\n\t\t\t\tbreak;\n\t\t\t    case 22: /* ~bold VT300 only */\n\t\t\t\tflags &= ~WSATTR_HILIT;\n\t\t\t\tbreak;\n\t\t\t    case 24: /* ~underline VT300 only */\n\t\t\t\tflags &= ~WSATTR_UNDERLINE;\n\t\t\t\tbreak;\n\t\t\t    case 25: /* ~blink VT300 only */\n\t\t\t\tflags &= ~WSATTR_BLINK;\n\t\t\t\tbreak;\n\t\t\t    case 27: /* ~reverse VT300 only */\n\t\t\t\tflags &= ~WSATTR_REVERSE;\n\t\t\t\tbreak;\n\t\t\t    case 30: case 31: case 32: case 33:\n\t\t\t    case 34: case 35: case 36: case 37:\n\t\t\t\t/* fg color */\n\t\t\t\tflags |= WSATTR_WSCOLORS;\n\t\t\t\tfgcol = ARG(n) - 30;\n\t\t\t\tbreak;\n\t\t\t    case 40: case 41: case 42: case 43:\n\t\t\t    case 44: case 45: case 46: case 47:\n\t\t\t\t/* bg color */\n\t\t\t\tflags |= WSATTR_WSCOLORS;\n\t\t\t\tbgcol = ARG(n) - 40;\n\t\t\t\tbreak;\n\t\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\t\tprintf(\"CSI%dm unknown\\n\", ARG(n));\n#endif\n\t\t\t}\n\t\t}\n\t\tif (vt100_selectattribute(edp, flags, fgcol, bgcol, &attr,\n\t\t    &bkgdattr)) {\n#ifdef VT100_DEBUG\n\t\t\tprintf(\"error allocating attr %d/%d/%x\\n\",\n\t\t\t       fgcol, bgcol, flags);\n#endif\n\t\t} else {\n\t\t\tedp->curattr = attr;\n\t\t\tedp->bkgdattr = bkgdattr;\n\t\t\tedp->attrflags = flags;\n\t\t\tedp->fgcol = fgcol;\n\t\t\tedp->bgcol = bgcol;\n\t\t}\n\t\tbreak;\n\t    case 'n': /* reports */\n\t\tswitch (ARG(0)) {\n\t\t    case 5: /* DSR operating status */\n\t\t\t/* 0 = OK, 3 = malfunction */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[0n\", 4);\n\t\t\tbreak;\n\t\t    case 6: { /* DSR cursor position report */\n\t\t\tchar buf[20];\n\t\t\tint row;\n\t\t\tif (edp->flags & VTFL_DECOM)\n\t\t\t\trow = ROWS_ABOVE;\n\t\t\telse\n\t\t\t\trow = edp->crow;\n\t\t\tn = sprintf(buf, \"\\033[%d;%dR\",\n\t\t\t\t    row + 1, edp->ccol + 1);\n\t\t\twsdisplay_emulinput(edp->cbcookie, buf, n);\n\t\t\t}\n\t\t\tbreak;\n\t\t    case 15: /* DSR printer status */\n\t\t\t/* 13 = no printer, 10 = ready, 11 = not ready */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[?13n\", 6);\n\t\t\tbreak;\n\t\t    case 25: /* UDK status - VT300 only */\n\t\t\t/* 20 = locked, 21 = unlocked */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[?21n\", 6);\n\t\t\tbreak;\n\t\t    case 26: /* keyboard dialect */\n\t\t\t/* 1 = north american , 7 = german */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[?27;1n\", 8);\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%dn unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case 'r': /* DECSTBM set top/bottom margins */\n\t\thelp = min(DEF1_ARG(0), edp->nrows) - 1;\n\t\tn = min(DEFx_ARG(1, edp->nrows), edp->nrows) - help;\n\t\tif (n < 2) {\n\t\t\t/* minimal scrolling region has 2 lines */\n\t\t\treturn;\n\t\t} else {\n\t\t\tedp->scrreg_startrow = help;\n\t\t\tedp->scrreg_nrows = n;\n\t\t}\n\t\tedp->crow = ((edp->flags & VTFL_DECOM) ?\n\t\t\t     edp->scrreg_startrow : 0);\n\t\tedp->ccol = 0;\n\t\tbreak;\n\t    case 'y':\n\t\tswitch (ARG(0)) {\n\t\t    case 4: /* DECTST invoke confidence test */\n\t\t\t/* ignore */\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%dy unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"CSI%c (%d, %d) unknown\\n\", c, ARG(0), ARG(1));\n#endif\n\t}\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define VTMODE_REPORT 55",
            "#define VTMODE_RESET 44",
            "#define VTMODE_SET 33"
          ],
          "globals_used": [
            "static int vt100_selectattribute",
            "static int vt100_ansimode",
            "static int vt100_decmode"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define VTMODE_REPORT 55\n#define VTMODE_RESET 44\n#define VTMODE_SET 33\n\nstatic int vt100_selectattribute;\nstatic int vt100_ansimode;\nstatic int vt100_decmode;\n\nvoid\nwsemul_vt100_handle_csi(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tint n, help, flags, fgcol, bgcol;\n\tlong attr, bkgdattr;\n\n#define A3(a, b, c) (((a) << 16) | ((b) << 8) | (c))\n\tswitch (A3(edp->modif1, edp->modif2, c)) {\n\t    case A3('>', '\\0', 'c'): /* DA secondary */\n\t\twsdisplay_emulinput(edp->cbcookie, WSEMUL_VT_ID2,\n\t\t\t\t    sizeof(WSEMUL_VT_ID2));\n\t\tbreak;\n\n\t    case A3('\\0', '\\0', 'J'): /* ED selective erase in display */\n\t    case A3('?', '\\0', 'J'): /* DECSED selective erase in display */\n\t\twsemul_vt100_ed(edp, ARG(0));\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'K'): /* EL selective erase in line */\n\t    case A3('?', '\\0', 'K'): /* DECSEL selective erase in line */\n\t\twsemul_vt100_el(edp, ARG(0));\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'h'): /* SM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_ansimode(edp, ARG(n), VTMODE_SET);\n\t\tbreak;\n\t    case A3('?', '\\0', 'h'): /* DECSM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_decmode(edp, ARG(n), VTMODE_SET);\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'l'): /* RM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_ansimode(edp, ARG(n), VTMODE_RESET);\n\t\tbreak;;\n\t    case A3('?', '\\0', 'l'): /* DECRM */\n\t\tfor (n = 0; n < edp->nargs; n++)\n\t\t\tvt100_decmode(edp, ARG(n), VTMODE_RESET);\n\t\tbreak;;\n\t    case A3('\\0', '$', 'p'): /* DECRQM request mode ANSI */\n\t\tvt100_ansimode(edp, ARG(0), VTMODE_REPORT);\n\t\tbreak;\n\t    case A3('?', '$', 'p'): /* DECRQM request mode DEC */\n\t\tvt100_decmode(edp, ARG(0), VTMODE_REPORT);\n\t\tbreak;\n\t    case A3('\\0', '\\0', 'i'): /* MC printer controller mode */\n\t    case A3('?', '\\0', 'i'): /* MC printer controller mode */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* print screen */\n\t\t    case 1: /* print cursor line */\n\t\t    case 4: /* off */\n\t\t    case 5: /* on */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%di ignored\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%di unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\n#define A2(a, b) (((a) << 8) | (b))\n\t    case A2('!', 'p'): /* DECSTR soft reset VT300 only */\n\t\twsemul_vt100_reset(edp);\n\t\tbreak;\n\n\t    case A2('\"', 'p'): /* DECSCL */\n\t\tswitch (ARG(0)) {\n\t\t    case 61: /* VT100 mode (no further arguments!) */\n\t\t\tbreak;\n\t\t    case 62:\n\t\t    case 63: /* VT300 mode */\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d\\\"p unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tswitch (ARG(1)) {\n\t\t    case 0:\n\t\t    case 2: /* 8-bit controls */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%d;%d\\\"p ignored\\n\", ARG(0), ARG(1));\n#endif\n\t\t\tbreak;\n\t\t    case 1: /* 7-bit controls */\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d;%d\\\"p unknown\\n\", ARG(0), ARG(1));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('\"', 'q'): /* DECSCA select character attribute VT300 */\n\t\tswitch (ARG(0)) {\n\t\t    case 0:\n\t\t    case 1: /* erasable */\n\t\t\tbreak;\n\t\t    case 2: /* not erasable */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI2\\\"q ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d\\\"q unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\n\t    case A2('$', 'u'): /* DECRQTSR request terminal status report */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* ignored */\n\t\t\tbreak;\n\t\t    case 1: /* terminal state report */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI1$u ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$u unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('$', 'w'): /* DECRQPSR request presentation status report\n\t\t\t\t(VT300 only) */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* error */\n\t\t\tbreak;\n\t\t    case 1: /* cursor information report */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI1$w ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    case 2: /* tab stop report */\n\t\t\t{\n\t\t\tint i, n, ps = 0;\n\t\t\tchar buf[20];\n\t\t\tKASSERT(edp->tabs != 0);\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033P2$u\", 5);\n\t\t\tfor (i = 0; i < edp->ncols; i++)\n\t\t\t\tif (edp->tabs[i]) {\n\t\t\t\t\tn = sprintf(buf, \"%s%d\",\n\t\t\t\t\t\t    (ps ? \"/\" : \"\"), i + 1);\n\t\t\t\t\twsdisplay_emulinput(edp->cbcookie,\n\t\t\t\t\t\t\t    buf, n);\n\t\t\t\t\tps = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033\\\\\", 2);\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$w unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('$', '}'): /* DECSASD select active status display */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* main display */\n\t\t    case 1: /* status line */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%d$} ignored\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$} unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case A2('$', '~'): /* DECSSDD select status line type */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* none */\n\t\t    case 1: /* indicator */\n\t\t    case 2: /* host-writable */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"CSI%d$~ ignored\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%d$~ unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\n\t    case A2('&', 'u'): /* DECRQUPSS request user preferred\n\t\t\t\t  supplemental set */\n\t\twsdisplay_emulinput(edp->emulcookie, \"\\033P0!u%5\\033\\\\\", 9);\n\t\tbreak;\n\n\t    case '@': /* ICH insert character VT300 only */\n\t\tn = min(DEF1_ARG(0), COLS_LEFT + 1);\n\t\thelp = NCOLS - (edp->ccol + n);\n\t\tif (help > 0)\n\t\t\tCOPYCOLS(edp->ccol, edp->ccol + n, help);\n\t\tERASECOLS(edp->ccol, n, edp->bkgdattr);\n\t\tbreak;\n\t    case 'A': /* CUU */\n\t\tedp->crow -= min(DEF1_ARG(0), ROWS_ABOVE);\n\t\tCHECK_DW;\n\t\tbreak;\n\t    case 'B': /* CUD */\n\t\tedp->crow += min(DEF1_ARG(0), ROWS_BELOW);\n\t\tCHECK_DW;\n\t\tbreak;\n\t    case 'C': /* CUF */\n\t\tedp->ccol += min(DEF1_ARG(0), COLS_LEFT);\n\t\tbreak;\n\t    case 'D': /* CUB */\n\t\tedp->ccol -= min(DEF1_ARG(0), edp->ccol);\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case 'H': /* CUP */\n\t    case 'f': /* HVP */\n\t\tif (edp->flags & VTFL_DECOM)\n\t\t\tedp->crow = edp->scrreg_startrow +\n\t\t\t    min(DEF1_ARG(0), edp->scrreg_nrows) - 1;\n\t\telse\n\t\t\tedp->crow = min(DEF1_ARG(0), edp->nrows) - 1;\n\t\tCHECK_DW;\n\t\tedp->ccol = min(DEF1_ARG(1), NCOLS) - 1;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case 'L': /* IL insert line */\n\t    case 'M': /* DL delete line */\n\t\tn = min(DEF1_ARG(0), ROWS_BELOW + 1);\n\t\t{\n\t\tint savscrstartrow, savscrnrows;\n\t\tsavscrstartrow = edp->scrreg_startrow;\n\t\tsavscrnrows = edp->scrreg_nrows;\n\t\tedp->scrreg_nrows -= ROWS_ABOVE;\n\t\tedp->scrreg_startrow = edp->crow;\n\t\tif (c == 'L')\n\t\t\twsemul_vt100_scrolldown(edp, n);\n\t\telse\n\t\t\twsemul_vt100_scrollup(edp, n);\n\t\tedp->scrreg_startrow = savscrstartrow;\n\t\tedp->scrreg_nrows = savscrnrows;\n\t\t}\n\t\tbreak;\n\t    case 'P': /* DCH delete character */\n\t\tn = min(DEF1_ARG(0), COLS_LEFT + 1);\n\t\thelp = NCOLS - (edp->ccol + n);\n\t\tif (help > 0)\n\t\t\tCOPYCOLS(edp->ccol + n, edp->ccol, help);\n\t\tERASECOLS(NCOLS - n, n, edp->bkgdattr);\n\t\tbreak;\n\t    case 'X': /* ECH erase character */\n\t\tn = min(DEF1_ARG(0), COLS_LEFT + 1);\n\t\tERASECOLS(edp->ccol, n, edp->bkgdattr);\n\t\tbreak;\n\t    case 'c': /* DA primary */\n\t\tif (ARG(0) == 0)\n\t\t\twsdisplay_emulinput(edp->cbcookie, WSEMUL_VT_ID1,\n\t\t\t\t\t    sizeof(WSEMUL_VT_ID1));\n\t\tbreak;\n\t    case 'g': /* TBC */\n\t\tKASSERT(edp->tabs != 0);\n\t\tswitch (ARG(0)) {\n\t\t    case 0:\n\t\t\tedp->tabs[edp->ccol] = 0;\n\t\t\tbreak;\n\t\t    case 3:\n\t\t\tbzero(edp->tabs, edp->ncols);\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%dg unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case 'm': /* SGR select graphic rendition */\n\t\tflags = edp->attrflags;\n\t\tfgcol = edp->fgcol;\n\t\tbgcol = edp->bgcol;\n\t\tfor (n = 0; n < edp->nargs; n++) {\n\t\t\tswitch (ARG(n)) {\n\t\t\t    case 0: /* reset */\n\t\t\t\tif (n == edp->nargs - 1) {\n\t\t\t\t\tedp->bkgdattr = edp->curattr = edp->defattr;\n\t\t\t\t\tedp->attrflags = 0;\n\t\t\t\t\tedp->fgcol = WSCOL_WHITE;\n\t\t\t\t\tedp->bgcol = WSCOL_BLACK;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tflags = 0;\n\t\t\t\tfgcol = WSCOL_WHITE;\n\t\t\t\tbgcol = WSCOL_BLACK;\n\t\t\t\tbreak;\n\t\t\t    case 1: /* bold */\n\t\t\t\tflags |= WSATTR_HILIT;\n\t\t\t\tbreak;\n\t\t\t    case 4: /* underline */\n\t\t\t\tflags |= WSATTR_UNDERLINE;\n\t\t\t\tbreak;\n\t\t\t    case 5: /* blink */\n\t\t\t\tflags |= WSATTR_BLINK;\n\t\t\t\tbreak;\n\t\t\t    case 7: /* reverse */\n\t\t\t\tflags |= WSATTR_REVERSE;\n\t\t\t\tbreak;\n\t\t\t    case 22: /* ~bold VT300 only */\n\t\t\t\tflags &= ~WSATTR_HILIT;\n\t\t\t\tbreak;\n\t\t\t    case 24: /* ~underline VT300 only */\n\t\t\t\tflags &= ~WSATTR_UNDERLINE;\n\t\t\t\tbreak;\n\t\t\t    case 25: /* ~blink VT300 only */\n\t\t\t\tflags &= ~WSATTR_BLINK;\n\t\t\t\tbreak;\n\t\t\t    case 27: /* ~reverse VT300 only */\n\t\t\t\tflags &= ~WSATTR_REVERSE;\n\t\t\t\tbreak;\n\t\t\t    case 30: case 31: case 32: case 33:\n\t\t\t    case 34: case 35: case 36: case 37:\n\t\t\t\t/* fg color */\n\t\t\t\tflags |= WSATTR_WSCOLORS;\n\t\t\t\tfgcol = ARG(n) - 30;\n\t\t\t\tbreak;\n\t\t\t    case 40: case 41: case 42: case 43:\n\t\t\t    case 44: case 45: case 46: case 47:\n\t\t\t\t/* bg color */\n\t\t\t\tflags |= WSATTR_WSCOLORS;\n\t\t\t\tbgcol = ARG(n) - 40;\n\t\t\t\tbreak;\n\t\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\t\tprintf(\"CSI%dm unknown\\n\", ARG(n));\n#endif\n\t\t\t}\n\t\t}\n\t\tif (vt100_selectattribute(edp, flags, fgcol, bgcol, &attr,\n\t\t    &bkgdattr)) {\n#ifdef VT100_DEBUG\n\t\t\tprintf(\"error allocating attr %d/%d/%x\\n\",\n\t\t\t       fgcol, bgcol, flags);\n#endif\n\t\t} else {\n\t\t\tedp->curattr = attr;\n\t\t\tedp->bkgdattr = bkgdattr;\n\t\t\tedp->attrflags = flags;\n\t\t\tedp->fgcol = fgcol;\n\t\t\tedp->bgcol = bgcol;\n\t\t}\n\t\tbreak;\n\t    case 'n': /* reports */\n\t\tswitch (ARG(0)) {\n\t\t    case 5: /* DSR operating status */\n\t\t\t/* 0 = OK, 3 = malfunction */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[0n\", 4);\n\t\t\tbreak;\n\t\t    case 6: { /* DSR cursor position report */\n\t\t\tchar buf[20];\n\t\t\tint row;\n\t\t\tif (edp->flags & VTFL_DECOM)\n\t\t\t\trow = ROWS_ABOVE;\n\t\t\telse\n\t\t\t\trow = edp->crow;\n\t\t\tn = sprintf(buf, \"\\033[%d;%dR\",\n\t\t\t\t    row + 1, edp->ccol + 1);\n\t\t\twsdisplay_emulinput(edp->cbcookie, buf, n);\n\t\t\t}\n\t\t\tbreak;\n\t\t    case 15: /* DSR printer status */\n\t\t\t/* 13 = no printer, 10 = ready, 11 = not ready */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[?13n\", 6);\n\t\t\tbreak;\n\t\t    case 25: /* UDK status - VT300 only */\n\t\t\t/* 20 = locked, 21 = unlocked */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[?21n\", 6);\n\t\t\tbreak;\n\t\t    case 26: /* keyboard dialect */\n\t\t\t/* 1 = north american , 7 = german */\n\t\t\twsdisplay_emulinput(edp->cbcookie, \"\\033[?27;1n\", 8);\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%dn unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    case 'r': /* DECSTBM set top/bottom margins */\n\t\thelp = min(DEF1_ARG(0), edp->nrows) - 1;\n\t\tn = min(DEFx_ARG(1, edp->nrows), edp->nrows) - help;\n\t\tif (n < 2) {\n\t\t\t/* minimal scrolling region has 2 lines */\n\t\t\treturn;\n\t\t} else {\n\t\t\tedp->scrreg_startrow = help;\n\t\t\tedp->scrreg_nrows = n;\n\t\t}\n\t\tedp->crow = ((edp->flags & VTFL_DECOM) ?\n\t\t\t     edp->scrreg_startrow : 0);\n\t\tedp->ccol = 0;\n\t\tbreak;\n\t    case 'y':\n\t\tswitch (ARG(0)) {\n\t\t    case 4: /* DECTST invoke confidence test */\n\t\t\t/* ignore */\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"CSI%dy unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"CSI%c (%d, %d) unknown\\n\", c, ARG(0), ARG(1));\n#endif\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"vt100: too many arguments\\n\""
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic u_int\nwsemul_vt100_output_csi(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_CSI;\n\n\tswitch (c) {\n\t    case '0': case '1': case '2': case '3': case '4':\n\t    case '5': case '6': case '7': case '8': case '9':\n\t\t/* argument digit */\n\t\tif (edp->nargs > VT100_EMUL_NARGS - 1)\n\t\t\tbreak;\n\t\tedp->args[edp->nargs] = (edp->args[edp->nargs] * 10) +\n\t\t    (c - '0');\n\t\tbreak;\n\t    case ';': /* argument terminator */\n\t\tedp->nargs++;\n\t\tbreak;\n\t    case '?': /* DEC specific */\n\t    case '>': /* DA query */\n\t\tedp->modif1 = c;\n\t\tbreak;\n\t    case '!':\n\t    case '\"':\n\t    case '$':\n\t    case '&':\n\t\tedp->modif2 = c;\n\t\tbreak;\n\t    default: /* end of escape sequence */\n\t\tedp->nargs++;\n\t\tif (edp->nargs > VT100_EMUL_NARGS) {\n#ifdef VT100_DEBUG\n\t\t\tprintf(\"vt100: too many arguments\\n\");\n#endif\n\t\t\tedp->nargs = VT100_EMUL_NARGS;\n\t\t}\n\t\twsemul_vt100_handle_csi(edp, c);\n\t\tnewstate = VT100_EMUL_STATE_NORMAL;\n\t\tbreak;\n\t}\n\treturn (newstate);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_esc_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "845-902",
    "snippet": "static u_int\nwsemul_vt100_output_esc_hash(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tint i;\n\n\tswitch (c) {\n\t    case '5': /*  DECSWL single width, single height */\n\t\tif (edp->dw) {\n\t\t\tfor (i = 0; i < edp->ncols / 2; i++)\n\t\t\t\t(*edp->emulops->copycols)(edp->emulcookie,\n\t\t\t\t\t\t\t  edp->crow,\n\t\t\t\t\t\t\t  2 * i, i, 1);\n\t\t\t(*edp->emulops->erasecols)(edp->emulcookie, edp->crow,\n\t\t\t\t\t\t   i, edp->ncols - i,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tedp->dblwid[edp->crow] = 0;\n\t\t\tedp->dw = 0;\n\t\t}\n\t\tbreak;\n\t    case '6': /*  DECDWL double width, single height */\n\t    case '3': /*  DECDHL double width, double height, top half */\n\t    case '4': /*  DECDHL double width, double height, bottom half */\n\t\tif (!edp->dw) {\n\t\t\tfor (i = edp->ncols / 2 - 1; i >= 0; i--)\n\t\t\t\t(*edp->emulops->copycols)(edp->emulcookie,\n\t\t\t\t\t\t\t  edp->crow,\n\t\t\t\t\t\t\t  i, 2 * i, 1);\n\t\t\tfor (i = 0; i < edp->ncols / 2; i++)\n\t\t\t\t(*edp->emulops->erasecols)(edp->emulcookie,\n\t\t\t\t\t\t\t   edp->crow,\n\t\t\t\t\t\t\t   2 * i + 1, 1,\n\t\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tedp->dblwid[edp->crow] = 1;\n\t\t\tedp->dw = 1;\n\t\t\tif (edp->ccol > (edp->ncols >> 1) - 1)\n\t\t\t\tedp->ccol = (edp->ncols >> 1) - 1;\n\t\t}\n\t\tbreak;\n\t    case '8': { /* DECALN */\n\t\tint i, j;\n\t\tfor (i = 0; i < edp->nrows; i++)\n\t\t\tfor (j = 0; j < edp->ncols; j++)\n\t\t\t\t(*edp->emulops->putchar)(edp->emulcookie, i, j,\n\t\t\t\t\t\t\t 'E', edp->curattr);\n\t\t}\n\t\tedp->ccol = 0;\n\t\tedp->crow = 0;\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC#%c unknown\\n\", c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [
      "int ccol, crow;",
      "int ccol, crow;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ESC#%c unknown\\n\"",
            "c"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "i",
            "j",
            "'E'",
            "edp->curattr"
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->crow",
            "2 * i + 1",
            "1",
            "edp->bkgdattr"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->crow",
            "i",
            "2 * i",
            "1"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->crow",
            "i",
            "edp->ncols - i",
            "edp->bkgdattr"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->crow",
            "2 * i",
            "i",
            "1"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nint ccol, crow;\nint ccol, crow;\n\nstatic u_int\nwsemul_vt100_output_esc_hash(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tint i;\n\n\tswitch (c) {\n\t    case '5': /*  DECSWL single width, single height */\n\t\tif (edp->dw) {\n\t\t\tfor (i = 0; i < edp->ncols / 2; i++)\n\t\t\t\t(*edp->emulops->copycols)(edp->emulcookie,\n\t\t\t\t\t\t\t  edp->crow,\n\t\t\t\t\t\t\t  2 * i, i, 1);\n\t\t\t(*edp->emulops->erasecols)(edp->emulcookie, edp->crow,\n\t\t\t\t\t\t   i, edp->ncols - i,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tedp->dblwid[edp->crow] = 0;\n\t\t\tedp->dw = 0;\n\t\t}\n\t\tbreak;\n\t    case '6': /*  DECDWL double width, single height */\n\t    case '3': /*  DECDHL double width, double height, top half */\n\t    case '4': /*  DECDHL double width, double height, bottom half */\n\t\tif (!edp->dw) {\n\t\t\tfor (i = edp->ncols / 2 - 1; i >= 0; i--)\n\t\t\t\t(*edp->emulops->copycols)(edp->emulcookie,\n\t\t\t\t\t\t\t  edp->crow,\n\t\t\t\t\t\t\t  i, 2 * i, 1);\n\t\t\tfor (i = 0; i < edp->ncols / 2; i++)\n\t\t\t\t(*edp->emulops->erasecols)(edp->emulcookie,\n\t\t\t\t\t\t\t   edp->crow,\n\t\t\t\t\t\t\t   2 * i + 1, 1,\n\t\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tedp->dblwid[edp->crow] = 1;\n\t\t\tedp->dw = 1;\n\t\t\tif (edp->ccol > (edp->ncols >> 1) - 1)\n\t\t\t\tedp->ccol = (edp->ncols >> 1) - 1;\n\t\t}\n\t\tbreak;\n\t    case '8': { /* DECALN */\n\t\tint i, j;\n\t\tfor (i = 0; i < edp->nrows; i++)\n\t\t\tfor (j = 0; j < edp->ncols; j++)\n\t\t\t\t(*edp->emulops->putchar)(edp->emulcookie, i, j,\n\t\t\t\t\t\t\t 'E', edp->curattr);\n\t\t}\n\t\tedp->ccol = 0;\n\t\tedp->crow = 0;\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC#%c unknown\\n\", c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_dcs_dollar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "804-843",
    "snippet": "static u_int\nwsemul_vt100_output_dcs_dollar(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case 'p': /* DECRSTS terminal state restore */\n\t    case 'q': /* DECRQSS control function request */\n#ifdef VT100_PRINTNOTIMPL\n\t\tprintf(\"DCS$%c ignored\\n\", c);\n#endif\n\t\tbreak;\n\t    case 't': /* DECRSPS restore presentation state */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* error */\n\t\t\tbreak;\n\t\t    case 1: /* cursor information restore */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"DCS1$t ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    case 2: /* tab stop restore */\n\t\t\tedp->dcspos = 0;\n\t\t\tedp->dcstype = DCSTYPE_TABRESTORE;\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"DCS%d$t unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"DCS$%c (%d, %d) unknown\\n\", c, ARG(0), ARG(1));\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_STRING);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */"
    ],
    "globals_used": [
      "static vt100_handler\nwsemul_vt100_output_esc,\nwsemul_vt100_output_csi,\nwsemul_vt100_output_scs94,\nwsemul_vt100_output_scs94_percent,\nwsemul_vt100_output_scs96,\nwsemul_vt100_output_scs96_percent,\nwsemul_vt100_output_esc_hash,\nwsemul_vt100_output_esc_spc,\nwsemul_vt100_output_string,\nwsemul_vt100_output_string_esc,\nwsemul_vt100_output_dcs,\nwsemul_vt100_output_dcs_dollar;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"DCS$%c (%d, %d) unknown\\n\"",
            "c",
            "ARG(0)",
            "ARG(1)"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARG",
          "args": [
            "1"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARG",
          "args": [
            "0"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARG",
          "args": [
            "0"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARG",
          "args": [
            "0"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */\n\nstatic vt100_handler\nwsemul_vt100_output_esc,\nwsemul_vt100_output_csi,\nwsemul_vt100_output_scs94,\nwsemul_vt100_output_scs94_percent,\nwsemul_vt100_output_scs96,\nwsemul_vt100_output_scs96_percent,\nwsemul_vt100_output_esc_hash,\nwsemul_vt100_output_esc_spc,\nwsemul_vt100_output_string,\nwsemul_vt100_output_string_esc,\nwsemul_vt100_output_dcs,\nwsemul_vt100_output_dcs_dollar;\n\nstatic u_int\nwsemul_vt100_output_dcs_dollar(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case 'p': /* DECRSTS terminal state restore */\n\t    case 'q': /* DECRQSS control function request */\n#ifdef VT100_PRINTNOTIMPL\n\t\tprintf(\"DCS$%c ignored\\n\", c);\n#endif\n\t\tbreak;\n\t    case 't': /* DECRSPS restore presentation state */\n\t\tswitch (ARG(0)) {\n\t\t    case 0: /* error */\n\t\t\tbreak;\n\t\t    case 1: /* cursor information restore */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"DCS1$t ignored\\n\");\n#endif\n\t\t\tbreak;\n\t\t    case 2: /* tab stop restore */\n\t\t\tedp->dcspos = 0;\n\t\t\tedp->dcstype = DCSTYPE_TABRESTORE;\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"DCS%d$t unknown\\n\", ARG(0));\n#endif\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"DCS$%c (%d, %d) unknown\\n\", c, ARG(0), ARG(1));\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_STRING);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_dcs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "753-802",
    "snippet": "static u_int\nwsemul_vt100_output_dcs(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_DCS;\n\n\tswitch (c) {\n\t    case '0': case '1': case '2': case '3': case '4':\n\t    case '5': case '6': case '7': case '8': case '9':\n\t\t/* argument digit */\n\t\tif (edp->nargs > VT100_EMUL_NARGS - 1)\n\t\t\tbreak;\n\t\tedp->args[edp->nargs] = (edp->args[edp->nargs] * 10) +\n\t\t    (c - '0');\n\t\tbreak;\n\t    case ';': /* argument terminator */\n\t\tedp->nargs++;\n\t\tbreak;\n\t    default:\n\t\tedp->nargs++;\n\t\tif (edp->nargs > VT100_EMUL_NARGS) {\n#ifdef VT100_DEBUG\n\t\t\tprintf(\"vt100: too many arguments\\n\");\n#endif\n\t\t\tedp->nargs = VT100_EMUL_NARGS;\n\t\t}\n\t\tnewstate = VT100_EMUL_STATE_STRING;\n\t\tswitch (c) {\n\t\t    case '$':\n\t\t\tnewstate = VT100_EMUL_STATE_DCS_DOLLAR;\n\t\t\tbreak;\n\t\t    case '{': /* DECDLD soft charset */\n\t\t    case '!': /* DECRQUPSS user preferred supplemental set */\n\t\t\t/* 'u' must follow - need another state */\n\t\t    case '|': /* DECUDK program F6..F20 */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"DCS%c ignored\\n\", c);\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"DCS%c (%d, %d) unknown\\n\", c, ARG(0), ARG(1));\n#endif\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn (newstate);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_DCS_DOLLAR\t12\t/* got DCS<p>$ */",
      "#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */",
      "#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"DCS%c (%d, %d) unknown\\n\"",
            "c",
            "ARG(0)",
            "ARG(1)"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARG",
          "args": [
            "1"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARG",
          "args": [
            "0"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_DCS_DOLLAR\t12\t/* got DCS<p>$ */\n#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */\n#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */\n\nstatic u_int\nwsemul_vt100_output_dcs(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_DCS;\n\n\tswitch (c) {\n\t    case '0': case '1': case '2': case '3': case '4':\n\t    case '5': case '6': case '7': case '8': case '9':\n\t\t/* argument digit */\n\t\tif (edp->nargs > VT100_EMUL_NARGS - 1)\n\t\t\tbreak;\n\t\tedp->args[edp->nargs] = (edp->args[edp->nargs] * 10) +\n\t\t    (c - '0');\n\t\tbreak;\n\t    case ';': /* argument terminator */\n\t\tedp->nargs++;\n\t\tbreak;\n\t    default:\n\t\tedp->nargs++;\n\t\tif (edp->nargs > VT100_EMUL_NARGS) {\n#ifdef VT100_DEBUG\n\t\t\tprintf(\"vt100: too many arguments\\n\");\n#endif\n\t\t\tedp->nargs = VT100_EMUL_NARGS;\n\t\t}\n\t\tnewstate = VT100_EMUL_STATE_STRING;\n\t\tswitch (c) {\n\t\t    case '$':\n\t\t\tnewstate = VT100_EMUL_STATE_DCS_DOLLAR;\n\t\t\tbreak;\n\t\t    case '{': /* DECDLD soft charset */\n\t\t    case '!': /* DECRQUPSS user preferred supplemental set */\n\t\t\t/* 'u' must follow - need another state */\n\t\t    case '|': /* DECUDK program F6..F20 */\n#ifdef VT100_PRINTNOTIMPL\n\t\t\tprintf(\"DCS%c ignored\\n\", c);\n#endif\n\t\t\tbreak;\n\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\tprintf(\"DCS%c (%d, %d) unknown\\n\", c, ARG(0), ARG(1));\n#endif\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn (newstate);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_string_esc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "741-751",
    "snippet": "static u_int\nwsemul_vt100_output_string_esc(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tif (c == '\\\\') { /* ST complete */\n\t\twsemul_vt100_handle_dcs(edp);\n\t\treturn (VT100_EMUL_STATE_NORMAL);\n\t} else\n\t\treturn (VT100_EMUL_STATE_STRING);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */",
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wsemul_vt100_handle_dcs",
          "args": [
            "edp"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_handle_dcs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "704-742",
          "snippet": "void\nwsemul_vt100_handle_dcs(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i, pos;\n\n\tswitch (edp->dcstype) {\n\t    case 0: /* not handled */\n\t\treturn;\n\t    case DCSTYPE_TABRESTORE:\n\t\tKASSERT(edp->tabs != 0);\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tpos = 0;\n\t\tfor (i = 0; i < edp->dcspos; i++) {\n\t\t\tchar c = edp->dcsarg[i];\n\t\t\tswitch (c) {\n\t\t\t    case '0': case '1': case '2': case '3': case '4':\n\t\t\t    case '5': case '6': case '7': case '8': case '9':\n\t\t\t\tpos = pos * 10 + (edp->dcsarg[i] - '0');\n\t\t\t\tbreak;\n\t\t\t    case '/':\n\t\t\t\tif (pos > 0)\n\t\t\t\t\tedp->tabs[pos - 1] = 1;\n\t\t\t\tpos = 0;\n\t\t\t\tbreak;\n\t\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\t\tprintf(\"unknown char %c in DCS\\n\", c);\n#endif\n\t\t\t}\n\t\t}\n\t\tif (pos > 0)\n\t\t\tedp->tabs[pos - 1] = 1;\n\t\tbreak;\n\t    default:\n\t\tpanic(\"wsemul_vt100_handle_dcs: bad type %d\", edp->dcstype);\n\t}\n\tedp->dcstype = 0;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_handle_dcs(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i, pos;\n\n\tswitch (edp->dcstype) {\n\t    case 0: /* not handled */\n\t\treturn;\n\t    case DCSTYPE_TABRESTORE:\n\t\tKASSERT(edp->tabs != 0);\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tpos = 0;\n\t\tfor (i = 0; i < edp->dcspos; i++) {\n\t\t\tchar c = edp->dcsarg[i];\n\t\t\tswitch (c) {\n\t\t\t    case '0': case '1': case '2': case '3': case '4':\n\t\t\t    case '5': case '6': case '7': case '8': case '9':\n\t\t\t\tpos = pos * 10 + (edp->dcsarg[i] - '0');\n\t\t\t\tbreak;\n\t\t\t    case '/':\n\t\t\t\tif (pos > 0)\n\t\t\t\t\tedp->tabs[pos - 1] = 1;\n\t\t\t\tpos = 0;\n\t\t\t\tbreak;\n\t\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\t\tprintf(\"unknown char %c in DCS\\n\", c);\n#endif\n\t\t\t}\n\t\t}\n\t\tif (pos > 0)\n\t\t\tedp->tabs[pos - 1] = 1;\n\t\tbreak;\n\t    default:\n\t\tpanic(\"wsemul_vt100_handle_dcs: bad type %d\", edp->dcstype);\n\t}\n\tedp->dcstype = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic u_int\nwsemul_vt100_output_string_esc(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tif (c == '\\\\') { /* ST complete */\n\t\twsemul_vt100_handle_dcs(edp);\n\t\treturn (VT100_EMUL_STATE_NORMAL);\n\t} else\n\t\treturn (VT100_EMUL_STATE_STRING);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "731-739",
    "snippet": "static u_int\nwsemul_vt100_output_string(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tif (edp->dcstype && edp->dcspos < DCS_MAXLEN)\n\t\tedp->dcsarg[edp->dcspos++] = c;\n\treturn (VT100_EMUL_STATE_STRING);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */\n\nstatic u_int\nwsemul_vt100_output_string(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tif (edp->dcstype && edp->dcspos < DCS_MAXLEN)\n\t\tedp->dcsarg[edp->dcspos++] = c;\n\treturn (VT100_EMUL_STATE_STRING);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_esc_spc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "710-729",
    "snippet": "static u_int\nwsemul_vt100_output_esc_spc(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case 'F': /* 7-bit controls */\n\t    case 'G': /* 8-bit controls */\n#ifdef VT100_PRINTNOTIMPL\n\t\tprintf(\"ESC<SPC>%c ignored\\n\", c);\n#endif\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC<SPC>%c unknown\\n\", c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ESC<SPC>%c unknown\\n\"",
            "c"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic u_int\nwsemul_vt100_output_esc_spc(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case 'F': /* 7-bit controls */\n\t    case 'G': /* 8-bit controls */\n#ifdef VT100_PRINTNOTIMPL\n\t\tprintf(\"ESC<SPC>%c ignored\\n\", c);\n#endif\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC<SPC>%c unknown\\n\", c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_scs96_percent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "692-708",
    "snippet": "static u_int\nwsemul_vt100_output_scs96_percent(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case '6': /* portugese */\n\t\tvt100_setnrc(edp, 8);\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%%%c unknown\\n\", edp->designating + '-', c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ESC%c%%%c unknown\\n\"",
            "edp->designating + '-'",
            "c"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vt100_setnrc",
          "args": [
            "edp",
            "8"
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "vt100_setnrc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_chars.c",
          "lines": "145-159",
          "snippet": "void\nvt100_setnrc(edp, nrc)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint nrc;\n{\n\tint i;\n\n\tKASSERT(nrc < sizeof(nrctable) / sizeof(nrctable[0]));\n\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, i, &edp->nrctab[i]);\n\tfor (i = 0; i < 12; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, nrctable[nrc].c[i],\n\t\t\t\t\t &edp->nrctab[nrcovlpos[i]]);\n}",
          "includes": [
            "#include <dev/wscons/unicode.h>",
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nrcovlpos[12] = {\n    0x23, 0x40, 0x5b, 0x5c, 0x5d, 0x5e,\t/* #@[\\]^ */\n    0x5f, 0x60, 0x7b, 0x7c, 0x7d, 0x7e\t/* _`{|}~ */\n};",
            "static struct {\n\tu_int16_t c[12];\n} nrctable[] = {\n\t/* british */\n\t{{0x00a3, 0x0040, 0x005b, 0x005c, 0x005d, 0x005e,\n\t0x005f, 0x0060, 0x007b, 0x007c, 0x007d, 0x007e}},\n\t/* dutch */\n\t{{0x00a3, 0x00be, 0x00dc, 0x00ab, 0x007c, 0x005e,\n\t0x005f, 0x0060, 0x00a8, 0x0192, 0x00bc, 0x00b4}},\n\t/* finnish */\n\t{{0x0023, 0x0040, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* french */\n\t{{0x00a3, 0x00e0, 0x00b0, 0x00e7, 0x00a7, 0x005e,\n\t0x005f, 0x0060, 0x00e9, 0x00f9, 0x00e8, 0x00a8}},\n\t/* french canadian */\n\t{{0x0023, 0x00e0, 0x00e2, 0x00e7, 0x00ea, 0x00ee,\n\t0x005f, 0x00f4, 0x00e9, 0x00f9, 0x00e8, 0x00fb}},\n\t/* german */\n\t{{0x0023, 0x00a7, 0x00c4, 0x00d6, 0x00dc, 0x005e,\n\t0x005f, 0x0060, 0x00e4, 0x00f6, 0x00fc, 0x00df}},\n\t/* italian */\n\t{{0x00a3, 0x00a7, 0x00b0, 0x00e7, 0x00e9, 0x005e,\n\t0x005f, 0x00f9, 0x00e0, 0x00f2, 0x00e8, 0x00ec}},\n\t/* norwegian /danish */\n\t{{0x0023, 0x0040, 0x00c6, 0x00d8, 0x00c5, 0x005e,\n\t0x005f, 0x0060, 0x00e6, 0x00f8, 0x00e5, 0x007e}},\n\t/* portugese */\n\t{{0x0023, 0x0040, 0x00c3, 0x00c7, 0x00d5, 0x005e,\n\t0x005f, 0x0060, 0x00e3, 0x00e7, 0x00f5, 0x007e}},\n\t/* spanish */\n\t{{0x00a3, 0x00a7, 0x00a1, 0x00d1, 0x00bf, 0x005e,\n\t0x005f, 0x0060, 0x0060, 0x00b0, 0x00f1, 0x00e7}},\n\t/* swedish */\n\t{{0x0023, 0x00c9, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* swiss */\n\t{{0x00f9, 0x00e0, 0x00e9, 0x00e7, 0x00ea, 0x00ee,\n\t0x00e8, 0x00f4, 0x00e4, 0x00f6, 0x00fc, 0x00fb}},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/unicode.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int nrcovlpos[12] = {\n    0x23, 0x40, 0x5b, 0x5c, 0x5d, 0x5e,\t/* #@[\\]^ */\n    0x5f, 0x60, 0x7b, 0x7c, 0x7d, 0x7e\t/* _`{|}~ */\n};\nstatic struct {\n\tu_int16_t c[12];\n} nrctable[] = {\n\t/* british */\n\t{{0x00a3, 0x0040, 0x005b, 0x005c, 0x005d, 0x005e,\n\t0x005f, 0x0060, 0x007b, 0x007c, 0x007d, 0x007e}},\n\t/* dutch */\n\t{{0x00a3, 0x00be, 0x00dc, 0x00ab, 0x007c, 0x005e,\n\t0x005f, 0x0060, 0x00a8, 0x0192, 0x00bc, 0x00b4}},\n\t/* finnish */\n\t{{0x0023, 0x0040, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* french */\n\t{{0x00a3, 0x00e0, 0x00b0, 0x00e7, 0x00a7, 0x005e,\n\t0x005f, 0x0060, 0x00e9, 0x00f9, 0x00e8, 0x00a8}},\n\t/* french canadian */\n\t{{0x0023, 0x00e0, 0x00e2, 0x00e7, 0x00ea, 0x00ee,\n\t0x005f, 0x00f4, 0x00e9, 0x00f9, 0x00e8, 0x00fb}},\n\t/* german */\n\t{{0x0023, 0x00a7, 0x00c4, 0x00d6, 0x00dc, 0x005e,\n\t0x005f, 0x0060, 0x00e4, 0x00f6, 0x00fc, 0x00df}},\n\t/* italian */\n\t{{0x00a3, 0x00a7, 0x00b0, 0x00e7, 0x00e9, 0x005e,\n\t0x005f, 0x00f9, 0x00e0, 0x00f2, 0x00e8, 0x00ec}},\n\t/* norwegian /danish */\n\t{{0x0023, 0x0040, 0x00c6, 0x00d8, 0x00c5, 0x005e,\n\t0x005f, 0x0060, 0x00e6, 0x00f8, 0x00e5, 0x007e}},\n\t/* portugese */\n\t{{0x0023, 0x0040, 0x00c3, 0x00c7, 0x00d5, 0x005e,\n\t0x005f, 0x0060, 0x00e3, 0x00e7, 0x00f5, 0x007e}},\n\t/* spanish */\n\t{{0x00a3, 0x00a7, 0x00a1, 0x00d1, 0x00bf, 0x005e,\n\t0x005f, 0x0060, 0x0060, 0x00b0, 0x00f1, 0x00e7}},\n\t/* swedish */\n\t{{0x0023, 0x00c9, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* swiss */\n\t{{0x00f9, 0x00e0, 0x00e9, 0x00e7, 0x00ea, 0x00ee,\n\t0x00e8, 0x00f4, 0x00e4, 0x00f6, 0x00fc, 0x00fb}},\n};\n\nvoid\nvt100_setnrc(edp, nrc)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint nrc;\n{\n\tint i;\n\n\tKASSERT(nrc < sizeof(nrctable) / sizeof(nrctable[0]));\n\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, i, &edp->nrctab[i]);\n\tfor (i = 0; i < 12; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, nrctable[nrc].c[i],\n\t\t\t\t\t &edp->nrctab[nrcovlpos[i]]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic u_int\nwsemul_vt100_output_scs96_percent(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case '6': /* portugese */\n\t\tvt100_setnrc(edp, 8);\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%%%c unknown\\n\", edp->designating + '-', c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_scs96",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "636-690",
    "snippet": "static u_int\nwsemul_vt100_output_scs96(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_NORMAL;\n\tint nrc;\n\n\tswitch (c) {\n\t    case '%': /* probably portugese */\n\t\tnewstate = VT100_EMUL_STATE_SCS96_PERCENT;\n\t\tbreak;\n\t    case 'A': /* ISO-latin-1 supplemental */\n\t\tedp->chartab_G[edp->designating] = edp->isolatin1tab;\n\t\tbreak;\n\t    case '4': /* dutch */\n\t\tnrc = 1;\n\t\tgoto setnrc;\n\t    case '5': case 'C': /* finnish */\n\t\tnrc = 2;\n\t\tgoto setnrc;\n\t    case 'R': /* french */\n\t\tnrc = 3;\n\t\tgoto setnrc;\n\t    case 'Q': /* french canadian */\n\t\tnrc = 4;\n\t\tgoto setnrc;\n\t    case 'K': /* german */\n\t\tnrc = 5;\n\t\tgoto setnrc;\n\t    case 'Y': /* italian */\n\t\tnrc = 6;\n\t\tgoto setnrc;\n\t    case 'E': case '6': /* norwegian / danish */\n\t\tnrc = 7;\n\t\tgoto setnrc;\n\t    case 'Z': /* spanish */\n\t\tnrc = 9;\n\t\tgoto setnrc;\n\t    case '7': case 'H': /* swedish */\n\t\tnrc = 10;\n\t\tgoto setnrc;\n\t    case '=': /* swiss */\n\t\tnrc = 11;\nsetnrc:\n\t\tvt100_setnrc(edp, nrc); /* what table ??? */\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%c unknown\\n\", edp->designating + '-' - 1, c);\n#endif\n\t\tbreak;\n\t}\n\treturn (newstate);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_SCS96_PERCENT\t6\t/* got ESC{-./}% */",
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ESC%c%c unknown\\n\"",
            "edp->designating + '-' - 1",
            "c"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vt100_setnrc",
          "args": [
            "edp",
            "nrc"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "vt100_setnrc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_chars.c",
          "lines": "145-159",
          "snippet": "void\nvt100_setnrc(edp, nrc)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint nrc;\n{\n\tint i;\n\n\tKASSERT(nrc < sizeof(nrctable) / sizeof(nrctable[0]));\n\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, i, &edp->nrctab[i]);\n\tfor (i = 0; i < 12; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, nrctable[nrc].c[i],\n\t\t\t\t\t &edp->nrctab[nrcovlpos[i]]);\n}",
          "includes": [
            "#include <dev/wscons/unicode.h>",
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nrcovlpos[12] = {\n    0x23, 0x40, 0x5b, 0x5c, 0x5d, 0x5e,\t/* #@[\\]^ */\n    0x5f, 0x60, 0x7b, 0x7c, 0x7d, 0x7e\t/* _`{|}~ */\n};",
            "static struct {\n\tu_int16_t c[12];\n} nrctable[] = {\n\t/* british */\n\t{{0x00a3, 0x0040, 0x005b, 0x005c, 0x005d, 0x005e,\n\t0x005f, 0x0060, 0x007b, 0x007c, 0x007d, 0x007e}},\n\t/* dutch */\n\t{{0x00a3, 0x00be, 0x00dc, 0x00ab, 0x007c, 0x005e,\n\t0x005f, 0x0060, 0x00a8, 0x0192, 0x00bc, 0x00b4}},\n\t/* finnish */\n\t{{0x0023, 0x0040, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* french */\n\t{{0x00a3, 0x00e0, 0x00b0, 0x00e7, 0x00a7, 0x005e,\n\t0x005f, 0x0060, 0x00e9, 0x00f9, 0x00e8, 0x00a8}},\n\t/* french canadian */\n\t{{0x0023, 0x00e0, 0x00e2, 0x00e7, 0x00ea, 0x00ee,\n\t0x005f, 0x00f4, 0x00e9, 0x00f9, 0x00e8, 0x00fb}},\n\t/* german */\n\t{{0x0023, 0x00a7, 0x00c4, 0x00d6, 0x00dc, 0x005e,\n\t0x005f, 0x0060, 0x00e4, 0x00f6, 0x00fc, 0x00df}},\n\t/* italian */\n\t{{0x00a3, 0x00a7, 0x00b0, 0x00e7, 0x00e9, 0x005e,\n\t0x005f, 0x00f9, 0x00e0, 0x00f2, 0x00e8, 0x00ec}},\n\t/* norwegian /danish */\n\t{{0x0023, 0x0040, 0x00c6, 0x00d8, 0x00c5, 0x005e,\n\t0x005f, 0x0060, 0x00e6, 0x00f8, 0x00e5, 0x007e}},\n\t/* portugese */\n\t{{0x0023, 0x0040, 0x00c3, 0x00c7, 0x00d5, 0x005e,\n\t0x005f, 0x0060, 0x00e3, 0x00e7, 0x00f5, 0x007e}},\n\t/* spanish */\n\t{{0x00a3, 0x00a7, 0x00a1, 0x00d1, 0x00bf, 0x005e,\n\t0x005f, 0x0060, 0x0060, 0x00b0, 0x00f1, 0x00e7}},\n\t/* swedish */\n\t{{0x0023, 0x00c9, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* swiss */\n\t{{0x00f9, 0x00e0, 0x00e9, 0x00e7, 0x00ea, 0x00ee,\n\t0x00e8, 0x00f4, 0x00e4, 0x00f6, 0x00fc, 0x00fb}},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/unicode.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int nrcovlpos[12] = {\n    0x23, 0x40, 0x5b, 0x5c, 0x5d, 0x5e,\t/* #@[\\]^ */\n    0x5f, 0x60, 0x7b, 0x7c, 0x7d, 0x7e\t/* _`{|}~ */\n};\nstatic struct {\n\tu_int16_t c[12];\n} nrctable[] = {\n\t/* british */\n\t{{0x00a3, 0x0040, 0x005b, 0x005c, 0x005d, 0x005e,\n\t0x005f, 0x0060, 0x007b, 0x007c, 0x007d, 0x007e}},\n\t/* dutch */\n\t{{0x00a3, 0x00be, 0x00dc, 0x00ab, 0x007c, 0x005e,\n\t0x005f, 0x0060, 0x00a8, 0x0192, 0x00bc, 0x00b4}},\n\t/* finnish */\n\t{{0x0023, 0x0040, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* french */\n\t{{0x00a3, 0x00e0, 0x00b0, 0x00e7, 0x00a7, 0x005e,\n\t0x005f, 0x0060, 0x00e9, 0x00f9, 0x00e8, 0x00a8}},\n\t/* french canadian */\n\t{{0x0023, 0x00e0, 0x00e2, 0x00e7, 0x00ea, 0x00ee,\n\t0x005f, 0x00f4, 0x00e9, 0x00f9, 0x00e8, 0x00fb}},\n\t/* german */\n\t{{0x0023, 0x00a7, 0x00c4, 0x00d6, 0x00dc, 0x005e,\n\t0x005f, 0x0060, 0x00e4, 0x00f6, 0x00fc, 0x00df}},\n\t/* italian */\n\t{{0x00a3, 0x00a7, 0x00b0, 0x00e7, 0x00e9, 0x005e,\n\t0x005f, 0x00f9, 0x00e0, 0x00f2, 0x00e8, 0x00ec}},\n\t/* norwegian /danish */\n\t{{0x0023, 0x0040, 0x00c6, 0x00d8, 0x00c5, 0x005e,\n\t0x005f, 0x0060, 0x00e6, 0x00f8, 0x00e5, 0x007e}},\n\t/* portugese */\n\t{{0x0023, 0x0040, 0x00c3, 0x00c7, 0x00d5, 0x005e,\n\t0x005f, 0x0060, 0x00e3, 0x00e7, 0x00f5, 0x007e}},\n\t/* spanish */\n\t{{0x00a3, 0x00a7, 0x00a1, 0x00d1, 0x00bf, 0x005e,\n\t0x005f, 0x0060, 0x0060, 0x00b0, 0x00f1, 0x00e7}},\n\t/* swedish */\n\t{{0x0023, 0x00c9, 0x00c4, 0x00d6, 0x00c5, 0x00dc,\n\t0x005f, 0x00e9, 0x00e4, 0x00f6, 0x00e5, 0x00fc}},\n\t/* swiss */\n\t{{0x00f9, 0x00e0, 0x00e9, 0x00e7, 0x00ea, 0x00ee,\n\t0x00e8, 0x00f4, 0x00e4, 0x00f6, 0x00fc, 0x00fb}},\n};\n\nvoid\nvt100_setnrc(edp, nrc)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint nrc;\n{\n\tint i;\n\n\tKASSERT(nrc < sizeof(nrctable) / sizeof(nrctable[0]));\n\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, i, &edp->nrctab[i]);\n\tfor (i = 0; i < 12; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, nrctable[nrc].c[i],\n\t\t\t\t\t &edp->nrctab[nrcovlpos[i]]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_SCS96_PERCENT\t6\t/* got ESC{-./}% */\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic u_int\nwsemul_vt100_output_scs96(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_NORMAL;\n\tint nrc;\n\n\tswitch (c) {\n\t    case '%': /* probably portugese */\n\t\tnewstate = VT100_EMUL_STATE_SCS96_PERCENT;\n\t\tbreak;\n\t    case 'A': /* ISO-latin-1 supplemental */\n\t\tedp->chartab_G[edp->designating] = edp->isolatin1tab;\n\t\tbreak;\n\t    case '4': /* dutch */\n\t\tnrc = 1;\n\t\tgoto setnrc;\n\t    case '5': case 'C': /* finnish */\n\t\tnrc = 2;\n\t\tgoto setnrc;\n\t    case 'R': /* french */\n\t\tnrc = 3;\n\t\tgoto setnrc;\n\t    case 'Q': /* french canadian */\n\t\tnrc = 4;\n\t\tgoto setnrc;\n\t    case 'K': /* german */\n\t\tnrc = 5;\n\t\tgoto setnrc;\n\t    case 'Y': /* italian */\n\t\tnrc = 6;\n\t\tgoto setnrc;\n\t    case 'E': case '6': /* norwegian / danish */\n\t\tnrc = 7;\n\t\tgoto setnrc;\n\t    case 'Z': /* spanish */\n\t\tnrc = 9;\n\t\tgoto setnrc;\n\t    case '7': case 'H': /* swedish */\n\t\tnrc = 10;\n\t\tgoto setnrc;\n\t    case '=': /* swiss */\n\t\tnrc = 11;\nsetnrc:\n\t\tvt100_setnrc(edp, nrc); /* what table ??? */\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%c unknown\\n\", edp->designating + '-' - 1, c);\n#endif\n\t\tbreak;\n\t}\n\treturn (newstate);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_scs94_percent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "617-634",
    "snippet": "static u_int\nwsemul_vt100_output_scs94_percent(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case '5': /* DEC supplemental graphic */\n\t\t/* XXX there are differences */\n\t\tedp->chartab_G[edp->designating] = edp->isolatin1tab;\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%%%c unknown\\n\", edp->designating + '(', c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ESC%c%%%c unknown\\n\"",
            "edp->designating + '('",
            "c"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic u_int\nwsemul_vt100_output_scs94_percent(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tswitch (c) {\n\t    case '5': /* DEC supplemental graphic */\n\t\t/* XXX there are differences */\n\t\tedp->chartab_G[edp->designating] = edp->isolatin1tab;\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%%%c unknown\\n\", edp->designating + '(', c);\n#endif\n\t\tbreak;\n\t}\n\treturn (VT100_EMUL_STATE_NORMAL);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_scs94",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "581-615",
    "snippet": "static u_int\nwsemul_vt100_output_scs94(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_NORMAL;\n\n\tswitch (c) {\n\t    case '%': /* probably DEC supplemental graphic */\n\t\tnewstate = VT100_EMUL_STATE_SCS94_PERCENT;\n\t\tbreak;\n\t    case 'A': /* british / national */\n\t\tedp->chartab_G[edp->designating] = edp->nrctab;\n\t\tbreak;\n\t    case 'B': /* ASCII */\n\t\tedp->chartab_G[edp->designating] = 0;\n\t\tbreak;\n\t    case '<': /* user preferred supplemental */\n\t\t/* XXX not really \"user\" preferred */\n\t\tedp->chartab_G[edp->designating] = edp->isolatin1tab;\n\t\tbreak;\n\t    case '0': /* DEC special graphic */\n\t\tedp->chartab_G[edp->designating] = edp->decgraphtab;\n\t\tbreak;\n\t    case '>': /* DEC tech */\n\t\tedp->chartab_G[edp->designating] = edp->dectechtab;\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%c unknown\\n\", edp->designating + '(', c);\n#endif\n\t\tbreak;\n\t}\n\treturn (newstate);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_SCS94_PERCENT\t4\t/* got ESC{()*+}% */",
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ESC%c%c unknown\\n\"",
            "edp->designating + '('",
            "c"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_SCS94_PERCENT\t4\t/* got ESC{()*+}% */\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic u_int\nwsemul_vt100_output_scs94(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_NORMAL;\n\n\tswitch (c) {\n\t    case '%': /* probably DEC supplemental graphic */\n\t\tnewstate = VT100_EMUL_STATE_SCS94_PERCENT;\n\t\tbreak;\n\t    case 'A': /* british / national */\n\t\tedp->chartab_G[edp->designating] = edp->nrctab;\n\t\tbreak;\n\t    case 'B': /* ASCII */\n\t\tedp->chartab_G[edp->designating] = 0;\n\t\tbreak;\n\t    case '<': /* user preferred supplemental */\n\t\t/* XXX not really \"user\" preferred */\n\t\tedp->chartab_G[edp->designating] = edp->isolatin1tab;\n\t\tbreak;\n\t    case '0': /* DEC special graphic */\n\t\tedp->chartab_G[edp->designating] = edp->decgraphtab;\n\t\tbreak;\n\t    case '>': /* DEC tech */\n\t\tedp->chartab_G[edp->designating] = edp->dectechtab;\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c%c unknown\\n\", edp->designating + '(', c);\n#endif\n\t\tbreak;\n\t}\n\treturn (newstate);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_esc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "448-579",
    "snippet": "static u_int\nwsemul_vt100_output_esc(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_NORMAL;\n\tint i;\n\n\tswitch (c) {\n\t    case '[': /* CSI */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->modif1 = edp->modif2 = '\\0';\n\t\tnewstate = VT100_EMUL_STATE_CSI;\n\t\tbreak;\n\t    case '7': /* DECSC */\n\t\tedp->savedcursor_row = edp->crow;\n\t\tedp->savedcursor_col = edp->ccol;\n\t\tedp->savedattr = edp->curattr;\n\t\tedp->savedbkgdattr = edp->bkgdattr;\n\t\tedp->savedattrflags = edp->attrflags;\n\t\tedp->savedfgcol = edp->fgcol;\n\t\tedp->savedbgcol = edp->bgcol;\n\t\tfor (i = 0; i < 4; i++)\n\t\t\tedp->savedchartab_G[i] = edp->chartab_G[i];\n\t\tedp->savedchartab0 = edp->chartab0;\n\t\tedp->savedchartab1 = edp->chartab1;\n\t\tbreak;\n\t    case '8': /* DECRC */\n\t\tedp->crow = edp->savedcursor_row;\n\t\tedp->ccol = edp->savedcursor_col;\n\t\tedp->curattr = edp->savedattr;\n\t\tedp->bkgdattr = edp->savedbkgdattr;\n\t\tedp->attrflags = edp->savedattrflags;\n\t\tedp->fgcol = edp->savedfgcol;\n\t\tedp->bgcol = edp->savedbgcol;\n\t\tfor (i = 0; i < 4; i++)\n\t\t\tedp->chartab_G[i] = edp->savedchartab_G[i];\n\t\tedp->chartab0 = edp->savedchartab0;\n\t\tedp->chartab1 = edp->savedchartab1;\n\t\tbreak;\n\t    case '=': /* DECKPAM application mode */\n\t\tedp->flags |= VTFL_APPLKEYPAD;\n\t\tbreak;\n\t    case '>': /* DECKPNM numeric mode */\n\t\tedp->flags &= ~VTFL_APPLKEYPAD;\n\t\tbreak;\n\t    case 'E': /* NEL */\n\t\tedp->ccol = 0;\n\t\t/* FALLTHRU */\n\t    case 'D': /* IND */\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t\tbreak;\n\t\t}\n\t\twsemul_vt100_scrollup(edp, 1);\n\t\tbreak;\n\t    case 'H': /* HTS */\n\t\tKASSERT(edp->tabs != 0);\n\t\tedp->tabs[edp->ccol] = 1;\n\t\tbreak;\n\t    case '~': /* LS1R */\n\t\tedp->chartab1 = 1;\n\t\tbreak;\n\t    case 'n': /* LS2 */\n\t\tedp->chartab0 = 2;\n\t\tbreak;\n\t    case '}': /* LS2R */\n\t\tedp->chartab1 = 2;\n\t\tbreak;\n\t    case 'o': /* LS3 */\n\t\tedp->chartab0 = 3;\n\t\tbreak;\n\t    case '|': /* LS3R */\n\t\tedp->chartab1 = 3;\n\t\tbreak;\n\t    case 'N': /* SS2 */\n\t\tedp->sschartab = 2;\n\t\tbreak;\n\t    case 'O': /* SS3 */\n\t\tedp->sschartab = 3;\n\t\tbreak;\n\t    case 'M': /* RI */\n\t\tif (ROWS_ABOVE > 0) {\n\t\t\tedp->crow--;\n\t\t\tCHECK_DW;\n\t\t\tbreak;\n\t\t}\n\t\twsemul_vt100_scrolldown(edp, 1);\n\t\tbreak;\n\t    case 'P': /* DCS */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tnewstate = VT100_EMUL_STATE_DCS;\n\t\tbreak;\n\t    case 'c': /* RIS */\n\t\twsemul_vt100_reset(edp);\n\t\twsemul_vt100_ed(edp, 2);\n\t\tedp->ccol = edp->crow = 0;\n\t\tbreak;\n\t    case '(': case ')': case '*': case '+': /* SCS */\n\t\tedp->designating = c - '(';\n\t\tnewstate = VT100_EMUL_STATE_SCS94;\n\t\tbreak;\n\t    case '-': case '.': case '/': /* SCS */\n\t\tedp->designating = c - '-' + 1;\n\t\tnewstate = VT100_EMUL_STATE_SCS96;\n\t\tbreak;\n\t    case '#':\n\t\tnewstate = VT100_EMUL_STATE_ESC_HASH;\n\t\tbreak;\n\t    case ' ': /* 7/8 bit */\n\t\tnewstate = VT100_EMUL_STATE_ESC_SPC;\n\t\tbreak;\n\t    case ']': /* OSC operating system command */\n\t    case '^': /* PM privacy message */\n\t    case '_': /* APC application program command */\n\t\t/* ignored */\n\t\tnewstate = VT100_EMUL_STATE_STRING;\n\t\tbreak;\n\t    case '<': /* exit VT52 mode - ignored */\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c unknown\\n\", c);\n#endif\n\t\tbreak;\n\t}\n\n\treturn (newstate);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */",
      "#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */",
      "#define\tVT100_EMUL_STATE_ESC_SPC\t8\t/* got ESC<SPC> */",
      "#define\tVT100_EMUL_STATE_ESC_HASH\t7\t/* got ESC# */",
      "#define\tVT100_EMUL_STATE_SCS96\t\t5\t/* got ESC{-./} */",
      "#define\tVT100_EMUL_STATE_SCS94\t\t3\t/* got ESC{()*+} */",
      "#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */",
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [
      "int ccol, crow;",
      "int ccol, crow;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ESC%c unknown\\n\"",
            "c"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_ed",
          "args": [
            "edp",
            "2"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_ed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "119-162",
          "snippet": "void\nwsemul_vt100_ed(edp, arg)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint arg;\n{\n\tint n;\n\n\tswitch (arg) {\n\t    case 0: /* cursor to end */\n\t\tERASECOLS(edp->ccol, COLS_LEFT + 1, edp->bkgdattr);\n\t\tn = edp->nrows - edp->crow - 1;\n\t\tif (n > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   edp->crow + 1, n,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[edp->crow + 1], n);\n\t\t}\n\t\tbreak;\n\t    case 1: /* beginning to cursor */\n\t\tif (edp->crow > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   0, edp->crow,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[0], edp->crow);\n\t\t}\n\t\tERASECOLS(0, edp->ccol + 1, edp->bkgdattr);\n\t\tbreak;\n\t    case 2: /* complete display */\n\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t   0, edp->nrows,\n\t\t\t\t\t   edp->bkgdattr);\n\t\tif (edp->dblwid)\n\t\t\tbzero(&edp->dblwid[0], edp->nrows);\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ed(%d) unknown\\n\", arg);\n#endif\n\t\tbreak;\n\t}\n\tCHECK_DW;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_ed(edp, arg)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint arg;\n{\n\tint n;\n\n\tswitch (arg) {\n\t    case 0: /* cursor to end */\n\t\tERASECOLS(edp->ccol, COLS_LEFT + 1, edp->bkgdattr);\n\t\tn = edp->nrows - edp->crow - 1;\n\t\tif (n > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   edp->crow + 1, n,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[edp->crow + 1], n);\n\t\t}\n\t\tbreak;\n\t    case 1: /* beginning to cursor */\n\t\tif (edp->crow > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   0, edp->crow,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[0], edp->crow);\n\t\t}\n\t\tERASECOLS(0, edp->ccol + 1, edp->bkgdattr);\n\t\tbreak;\n\t    case 2: /* complete display */\n\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t   0, edp->nrows,\n\t\t\t\t\t   edp->bkgdattr);\n\t\tif (edp->dblwid)\n\t\t\tbzero(&edp->dblwid[0], edp->nrows);\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ed(%d) unknown\\n\", arg);\n#endif\n\t\tbreak;\n\t}\n\tCHECK_DW;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_reset",
          "args": [
            "edp"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
          "lines": "282-310",
          "snippet": "void\nwsemul_vt100_reset(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tedp->state = VT100_EMUL_STATE_NORMAL;\n\tedp->flags = VTFL_DECAWM | VTFL_CURSORON;\n\tedp->bkgdattr = edp->curattr = edp->defattr;\n\tedp->attrflags = 0;\n\tedp->fgcol = WSCOL_WHITE;\n\tedp->bgcol = WSCOL_BLACK;\n\tedp->scrreg_startrow = 0;\n\tedp->scrreg_nrows = edp->nrows;\n\tif (edp->tabs) {\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tfor (i = 8; i < edp->ncols; i += 8)\n\t\t\tedp->tabs[i] = 1;\n\t}\n\tedp->dcspos = 0;\n\tedp->dcstype = 0;\n\tedp->chartab_G[0] = 0;\n\tedp->chartab_G[1] = edp->nrctab; /* ??? */\n\tedp->chartab_G[2] = edp->isolatin1tab;\n\tedp->chartab_G[3] = edp->isolatin1tab;\n\tedp->chartab0 = 0;\n\tedp->chartab1 = 2;\n\tedp->sschartab = 0;\n}",
          "includes": [
            "#include <dev/wscons/ascii.h>",
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/malloc.h>",
            "#include <sys/time.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
          ],
          "globals_used": [
            "long defattr;",
            "long defattr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nlong defattr;\nlong defattr;\n\nvoid\nwsemul_vt100_reset(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tedp->state = VT100_EMUL_STATE_NORMAL;\n\tedp->flags = VTFL_DECAWM | VTFL_CURSORON;\n\tedp->bkgdattr = edp->curattr = edp->defattr;\n\tedp->attrflags = 0;\n\tedp->fgcol = WSCOL_WHITE;\n\tedp->bgcol = WSCOL_BLACK;\n\tedp->scrreg_startrow = 0;\n\tedp->scrreg_nrows = edp->nrows;\n\tif (edp->tabs) {\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tfor (i = 8; i < edp->ncols; i += 8)\n\t\t\tedp->tabs[i] = 1;\n\t}\n\tedp->dcspos = 0;\n\tedp->dcstype = 0;\n\tedp->chartab_G[0] = 0;\n\tedp->chartab_G[1] = edp->nrctab; /* ??? */\n\tedp->chartab_G[2] = edp->isolatin1tab;\n\tedp->chartab_G[3] = edp->isolatin1tab;\n\tedp->chartab0 = 0;\n\tedp->chartab1 = 2;\n\tedp->sschartab = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "edp->args",
            "sizeof (edp->args)"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_scrolldown",
          "args": [
            "edp",
            "1"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_scrolldown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "87-114",
          "snippet": "void\nwsemul_vt100_scrolldown(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow], n);\n\tCHECK_DW;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_scrolldown(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow], n);\n\tCHECK_DW;\n}"
        }
      },
      {
        "call_info": {
          "callee": "KASSERT",
          "args": [
            "edp->tabs != 0"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_scrollup",
          "args": [
            "edp",
            "1"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_scrollup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "55-82",
          "snippet": "void\nwsemul_vt100_scrollup(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow + help, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow + help], n);\n\tCHECK_DW;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_scrollup(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow + help, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow + help], n);\n\tCHECK_DW;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "edp->args",
            "sizeof (edp->args)"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */\n#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */\n#define\tVT100_EMUL_STATE_ESC_SPC\t8\t/* got ESC<SPC> */\n#define\tVT100_EMUL_STATE_ESC_HASH\t7\t/* got ESC# */\n#define\tVT100_EMUL_STATE_SCS96\t\t5\t/* got ESC{-./} */\n#define\tVT100_EMUL_STATE_SCS94\t\t3\t/* got ESC{()*+} */\n#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nint ccol, crow;\nint ccol, crow;\n\nstatic u_int\nwsemul_vt100_output_esc(edp, c)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n{\n\tu_int newstate = VT100_EMUL_STATE_NORMAL;\n\tint i;\n\n\tswitch (c) {\n\t    case '[': /* CSI */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->modif1 = edp->modif2 = '\\0';\n\t\tnewstate = VT100_EMUL_STATE_CSI;\n\t\tbreak;\n\t    case '7': /* DECSC */\n\t\tedp->savedcursor_row = edp->crow;\n\t\tedp->savedcursor_col = edp->ccol;\n\t\tedp->savedattr = edp->curattr;\n\t\tedp->savedbkgdattr = edp->bkgdattr;\n\t\tedp->savedattrflags = edp->attrflags;\n\t\tedp->savedfgcol = edp->fgcol;\n\t\tedp->savedbgcol = edp->bgcol;\n\t\tfor (i = 0; i < 4; i++)\n\t\t\tedp->savedchartab_G[i] = edp->chartab_G[i];\n\t\tedp->savedchartab0 = edp->chartab0;\n\t\tedp->savedchartab1 = edp->chartab1;\n\t\tbreak;\n\t    case '8': /* DECRC */\n\t\tedp->crow = edp->savedcursor_row;\n\t\tedp->ccol = edp->savedcursor_col;\n\t\tedp->curattr = edp->savedattr;\n\t\tedp->bkgdattr = edp->savedbkgdattr;\n\t\tedp->attrflags = edp->savedattrflags;\n\t\tedp->fgcol = edp->savedfgcol;\n\t\tedp->bgcol = edp->savedbgcol;\n\t\tfor (i = 0; i < 4; i++)\n\t\t\tedp->chartab_G[i] = edp->savedchartab_G[i];\n\t\tedp->chartab0 = edp->savedchartab0;\n\t\tedp->chartab1 = edp->savedchartab1;\n\t\tbreak;\n\t    case '=': /* DECKPAM application mode */\n\t\tedp->flags |= VTFL_APPLKEYPAD;\n\t\tbreak;\n\t    case '>': /* DECKPNM numeric mode */\n\t\tedp->flags &= ~VTFL_APPLKEYPAD;\n\t\tbreak;\n\t    case 'E': /* NEL */\n\t\tedp->ccol = 0;\n\t\t/* FALLTHRU */\n\t    case 'D': /* IND */\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t\tbreak;\n\t\t}\n\t\twsemul_vt100_scrollup(edp, 1);\n\t\tbreak;\n\t    case 'H': /* HTS */\n\t\tKASSERT(edp->tabs != 0);\n\t\tedp->tabs[edp->ccol] = 1;\n\t\tbreak;\n\t    case '~': /* LS1R */\n\t\tedp->chartab1 = 1;\n\t\tbreak;\n\t    case 'n': /* LS2 */\n\t\tedp->chartab0 = 2;\n\t\tbreak;\n\t    case '}': /* LS2R */\n\t\tedp->chartab1 = 2;\n\t\tbreak;\n\t    case 'o': /* LS3 */\n\t\tedp->chartab0 = 3;\n\t\tbreak;\n\t    case '|': /* LS3R */\n\t\tedp->chartab1 = 3;\n\t\tbreak;\n\t    case 'N': /* SS2 */\n\t\tedp->sschartab = 2;\n\t\tbreak;\n\t    case 'O': /* SS3 */\n\t\tedp->sschartab = 3;\n\t\tbreak;\n\t    case 'M': /* RI */\n\t\tif (ROWS_ABOVE > 0) {\n\t\t\tedp->crow--;\n\t\t\tCHECK_DW;\n\t\t\tbreak;\n\t\t}\n\t\twsemul_vt100_scrolldown(edp, 1);\n\t\tbreak;\n\t    case 'P': /* DCS */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tnewstate = VT100_EMUL_STATE_DCS;\n\t\tbreak;\n\t    case 'c': /* RIS */\n\t\twsemul_vt100_reset(edp);\n\t\twsemul_vt100_ed(edp, 2);\n\t\tedp->ccol = edp->crow = 0;\n\t\tbreak;\n\t    case '(': case ')': case '*': case '+': /* SCS */\n\t\tedp->designating = c - '(';\n\t\tnewstate = VT100_EMUL_STATE_SCS94;\n\t\tbreak;\n\t    case '-': case '.': case '/': /* SCS */\n\t\tedp->designating = c - '-' + 1;\n\t\tnewstate = VT100_EMUL_STATE_SCS96;\n\t\tbreak;\n\t    case '#':\n\t\tnewstate = VT100_EMUL_STATE_ESC_HASH;\n\t\tbreak;\n\t    case ' ': /* 7/8 bit */\n\t\tnewstate = VT100_EMUL_STATE_ESC_SPC;\n\t\tbreak;\n\t    case ']': /* OSC operating system command */\n\t    case '^': /* PM privacy message */\n\t    case '_': /* APC application program command */\n\t\t/* ignored */\n\t\tnewstate = VT100_EMUL_STATE_STRING;\n\t\tbreak;\n\t    case '<': /* exit VT52 mode - ignored */\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ESC%c unknown\\n\", c);\n#endif\n\t\tbreak;\n\t}\n\n\treturn (newstate);\n}"
  },
  {
    "function_name": "wsemul_vt100_output_c0c1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "360-446",
    "snippet": "static void\nwsemul_vt100_output_c0c1(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int n;\n\n\tswitch (c) {\n\t    case ASCII_NUL:\n\t    default:\n\t\t/* ignore */\n\t\tbreak;\n\t    case ASCII_BEL:\n\t\twsdisplay_emulbell(edp->cbcookie);\n\t\tbreak;\n\t    case ASCII_BS:\n\t\tif (edp->ccol > 0) {\n\t\t\tedp->ccol--;\n\t\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\t}\n\t\tbreak;\n\t    case ASCII_CR:\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case ASCII_HT:\n\t\tif (edp->tabs) {\n\t\t\tif (!COLS_LEFT)\n\t\t\t\tbreak;\n\t\t\tfor (n = edp->ccol + 1; n < NCOLS - 1; n++)\n\t\t\t\tif (edp->tabs[n])\n\t\t\t\t\tbreak;\n\t\t} else {\n\t\t\tn = edp->ccol + min(8 - (edp->ccol & 7), COLS_LEFT);\n\t\t}\n\t\tedp->ccol = n;\n\t\tbreak;\n\t    case ASCII_SO: /* LS1 */\n\t\tedp->chartab0 = 1;\n\t\tbreak;\n\t    case ASCII_SI: /* LS0 */\n\t\tedp->chartab0 = 0;\n\t\tbreak;\n\t    case ASCII_ESC:\n#ifdef DIAGNOSTIC\n\t\tif (kernel)\n\t\t\tpanic(\"ESC in kernel output\");\n#endif\n\t\tif (edp->state == VT100_EMUL_STATE_STRING) {\n\t\t\t/* might be a string end */\n\t\t\tedp->state = VT100_EMUL_STATE_STRING_ESC;\n\t\t} else {\n\t\t\t/* XXX cancel current escape sequence */\n\t\t\tedp->state = VT100_EMUL_STATE_ESC;\n\t\t}\n\t\tbreak;\n#if 0\n\t    case CSI: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->modif1 = edp->modif2 = '\\0';\n\t\tedp->state = VT100_EMUL_STATE_CSI;\n\t\tbreak;\n\t    case DCS: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->state = VT100_EMUL_STATE_DCS;\n\t\tbreak;\n\t    case ST: /* string end 8-bit */\n\t\t/* XXX only in VT100_EMUL_STATE_STRING */\n\t\twsemul_vt100_handle_dcs(edp);\n\t\treturn (VT100_EMUL_STATE_NORMAL);\n#endif\n\t    case ASCII_LF:\n\t    case ASCII_VT:\n\t    case ASCII_FF:\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */",
      "#define\tVT100_EMUL_STATE_STRING_ESC\t10\t/* waiting for ST, got ESC */",
      "#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */",
      "#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */",
      "#define\tVT100_EMUL_STATE_ESC\t\t1\t/* got ESC */",
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [
      "static void wsemul_vt100_output_c0c1",
      "int ccol, crow;",
      "int ccol, crow;",
      "void *cbcookie;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wsemul_vt100_scrollup",
          "args": [
            "edp",
            "1"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_scrollup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "55-82",
          "snippet": "void\nwsemul_vt100_scrollup(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow + help, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow + help], n);\n\tCHECK_DW;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_scrollup(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow + help, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow + help], n);\n\tCHECK_DW;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_handle_dcs",
          "args": [
            "edp"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_handle_dcs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "704-742",
          "snippet": "void\nwsemul_vt100_handle_dcs(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i, pos;\n\n\tswitch (edp->dcstype) {\n\t    case 0: /* not handled */\n\t\treturn;\n\t    case DCSTYPE_TABRESTORE:\n\t\tKASSERT(edp->tabs != 0);\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tpos = 0;\n\t\tfor (i = 0; i < edp->dcspos; i++) {\n\t\t\tchar c = edp->dcsarg[i];\n\t\t\tswitch (c) {\n\t\t\t    case '0': case '1': case '2': case '3': case '4':\n\t\t\t    case '5': case '6': case '7': case '8': case '9':\n\t\t\t\tpos = pos * 10 + (edp->dcsarg[i] - '0');\n\t\t\t\tbreak;\n\t\t\t    case '/':\n\t\t\t\tif (pos > 0)\n\t\t\t\t\tedp->tabs[pos - 1] = 1;\n\t\t\t\tpos = 0;\n\t\t\t\tbreak;\n\t\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\t\tprintf(\"unknown char %c in DCS\\n\", c);\n#endif\n\t\t\t}\n\t\t}\n\t\tif (pos > 0)\n\t\t\tedp->tabs[pos - 1] = 1;\n\t\tbreak;\n\t    default:\n\t\tpanic(\"wsemul_vt100_handle_dcs: bad type %d\", edp->dcstype);\n\t}\n\tedp->dcstype = 0;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_handle_dcs(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i, pos;\n\n\tswitch (edp->dcstype) {\n\t    case 0: /* not handled */\n\t\treturn;\n\t    case DCSTYPE_TABRESTORE:\n\t\tKASSERT(edp->tabs != 0);\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tpos = 0;\n\t\tfor (i = 0; i < edp->dcspos; i++) {\n\t\t\tchar c = edp->dcsarg[i];\n\t\t\tswitch (c) {\n\t\t\t    case '0': case '1': case '2': case '3': case '4':\n\t\t\t    case '5': case '6': case '7': case '8': case '9':\n\t\t\t\tpos = pos * 10 + (edp->dcsarg[i] - '0');\n\t\t\t\tbreak;\n\t\t\t    case '/':\n\t\t\t\tif (pos > 0)\n\t\t\t\t\tedp->tabs[pos - 1] = 1;\n\t\t\t\tpos = 0;\n\t\t\t\tbreak;\n\t\t\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\t\t\tprintf(\"unknown char %c in DCS\\n\", c);\n#endif\n\t\t\t}\n\t\t}\n\t\tif (pos > 0)\n\t\t\tedp->tabs[pos - 1] = 1;\n\t\tbreak;\n\t    default:\n\t\tpanic(\"wsemul_vt100_handle_dcs: bad type %d\", edp->dcstype);\n\t}\n\tedp->dcstype = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "edp->args",
            "sizeof (edp->args)"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "edp->args",
            "sizeof (edp->args)"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"ESC in kernel output\""
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "8 - (edp->ccol & 7)",
            "COLS_LEFT"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "seq_do_timing",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/sequencer.c",
          "lines": "804-819",
          "snippet": "int\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}",
          "includes": [
            "#include \"midi.h\"",
            "#include <dev/sequencervar.h>",
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"midi.h\"\n#include <dev/sequencervar.h>\n#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n\nint\nseq_do_timing(sc, b)\n\tstruct sequencer_softc *sc;\n\tseq_event_rec *b;\n{\n\tunion {\n\t\tint32_t i;\n\t\tu_int8_t b[4];\n\t} u;\n\n\tu.b[0] = b->arr[4];\n\tu.b[1] = b->arr[5];\n\tu.b[2] = b->arr[6];\n\tu.b[3] = b->arr[7];\n\treturn (seq_timer(sc, SEQ_TCMD(b), u.i, b));\n}"
        }
      },
      {
        "call_info": {
          "callee": "wsdisplay_emulbell",
          "args": [
            "edp->cbcookie"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "wsdisplay_emulbell",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsdisplay.c",
          "lines": "1249-1263",
          "snippet": "void\nwsdisplay_emulbell(v)\n\tvoid *v;\n{\n\tstruct wsscreen *scr = v;\n\n\tif (scr == NULL)\t\t/* console, before real attach */\n\t\treturn;\n\n\tif (scr->scr_flags & SCR_GRAPHICS) /* can this happen? */\n\t\treturn;\n\n\t(void) wsdisplay_internal_ioctl(scr->sc, scr, WSKBDIO_BELL, NULL,\n\t\t\t\t\tFWRITE, NULL);\n}",
          "includes": [
            "#include <dev/wscons/wsmuxvar.h>",
            "#include <dev/wscons/wseventvar.h>",
            "#include \"wsmux.h\"",
            "#include \"wskbd.h\"",
            "#include <dev/cons.h>",
            "#include <dev/wscons/wscons_callbacks.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/errno.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/tty.h>",
            "#include <sys/systm.h>",
            "#include <sys/syslog.h>",
            "#include <sys/malloc.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>",
            "#include <sys/cdefs.h>"
          ],
          "macros_used": [
            "#define SCR_GRAPHICS 4\t\t/* graphics mode, no text (emulation) output */"
          ],
          "globals_used": [
            "struct wsscreen *\nwsscreen_attach(sc, console, emul, type, cookie, ccol, crow, defattr)\n\tstruct wsdisplay_softc *sc;",
            "int console;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsmuxvar.h>\n#include <dev/wscons/wseventvar.h>\n#include \"wsmux.h\"\n#include \"wskbd.h\"\n#include <dev/cons.h>\n#include <dev/wscons/wscons_callbacks.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/errno.h>\n#include <sys/signalvar.h>\n#include <sys/tty.h>\n#include <sys/systm.h>\n#include <sys/syslog.h>\n#include <sys/malloc.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/ioctl.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\n#define SCR_GRAPHICS 4\t\t/* graphics mode, no text (emulation) output */\n\nstruct wsscreen *\nwsscreen_attach(sc, console, emul, type, cookie, ccol, crow, defattr)\n\tstruct wsdisplay_softc *sc;\nint console;\n\nvoid\nwsdisplay_emulbell(v)\n\tvoid *v;\n{\n\tstruct wsscreen *scr = v;\n\n\tif (scr == NULL)\t\t/* console, before real attach */\n\t\treturn;\n\n\tif (scr->scr_flags & SCR_GRAPHICS) /* can this happen? */\n\t\treturn;\n\n\t(void) wsdisplay_internal_ioctl(scr->sc, scr, WSKBDIO_BELL, NULL,\n\t\t\t\t\tFWRITE, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_DCS\t\t11\t/* got DCS (ESC P) */\n#define\tVT100_EMUL_STATE_STRING_ESC\t10\t/* waiting for ST, got ESC */\n#define\tVT100_EMUL_STATE_STRING\t\t9\t/* waiting for ST (ESC\\) */\n#define\tVT100_EMUL_STATE_CSI\t\t2\t/* got CSI (ESC[) */\n#define\tVT100_EMUL_STATE_ESC\t\t1\t/* got ESC */\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nstatic void wsemul_vt100_output_c0c1;\nint ccol, crow;\nint ccol, crow;\nvoid *cbcookie;\n\nstatic void\nwsemul_vt100_output_c0c1(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int n;\n\n\tswitch (c) {\n\t    case ASCII_NUL:\n\t    default:\n\t\t/* ignore */\n\t\tbreak;\n\t    case ASCII_BEL:\n\t\twsdisplay_emulbell(edp->cbcookie);\n\t\tbreak;\n\t    case ASCII_BS:\n\t\tif (edp->ccol > 0) {\n\t\t\tedp->ccol--;\n\t\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\t}\n\t\tbreak;\n\t    case ASCII_CR:\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t\tbreak;\n\t    case ASCII_HT:\n\t\tif (edp->tabs) {\n\t\t\tif (!COLS_LEFT)\n\t\t\t\tbreak;\n\t\t\tfor (n = edp->ccol + 1; n < NCOLS - 1; n++)\n\t\t\t\tif (edp->tabs[n])\n\t\t\t\t\tbreak;\n\t\t} else {\n\t\t\tn = edp->ccol + min(8 - (edp->ccol & 7), COLS_LEFT);\n\t\t}\n\t\tedp->ccol = n;\n\t\tbreak;\n\t    case ASCII_SO: /* LS1 */\n\t\tedp->chartab0 = 1;\n\t\tbreak;\n\t    case ASCII_SI: /* LS0 */\n\t\tedp->chartab0 = 0;\n\t\tbreak;\n\t    case ASCII_ESC:\n#ifdef DIAGNOSTIC\n\t\tif (kernel)\n\t\t\tpanic(\"ESC in kernel output\");\n#endif\n\t\tif (edp->state == VT100_EMUL_STATE_STRING) {\n\t\t\t/* might be a string end */\n\t\t\tedp->state = VT100_EMUL_STATE_STRING_ESC;\n\t\t} else {\n\t\t\t/* XXX cancel current escape sequence */\n\t\t\tedp->state = VT100_EMUL_STATE_ESC;\n\t\t}\n\t\tbreak;\n#if 0\n\t    case CSI: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->modif1 = edp->modif2 = '\\0';\n\t\tedp->state = VT100_EMUL_STATE_CSI;\n\t\tbreak;\n\t    case DCS: /* 8-bit */\n\t\t/* XXX cancel current escape sequence */\n\t\tedp->nargs = 0;\n\t\tbzero(edp->args, sizeof (edp->args));\n\t\tedp->state = VT100_EMUL_STATE_DCS;\n\t\tbreak;\n\t    case ST: /* string end 8-bit */\n\t\t/* XXX only in VT100_EMUL_STATE_STRING */\n\t\twsemul_vt100_handle_dcs(edp);\n\t\treturn (VT100_EMUL_STATE_NORMAL);\n#endif\n\t    case ASCII_LF:\n\t    case ASCII_VT:\n\t    case ASCII_FF:\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "wsemul_vt100_output_normal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "316-358",
    "snippet": "static void\nwsemul_vt100_output_normal(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int *ct, dc;\n\n\tif ((edp->flags & (VTFL_LASTCHAR | VTFL_DECAWM)) ==\n\t    (VTFL_LASTCHAR | VTFL_DECAWM)) {\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t}\n\n\tif (c & 0x80) {\n\t\tc &= 0x7f;\n\t\tct = edp->chartab_G[edp->chartab1];\n\t} else {\n\t\tif (edp->sschartab) {\n\t\t\tct = edp->chartab_G[edp->sschartab];\n\t\t\tedp->sschartab = 0;\n\t\t} else\n\t\t\tct = edp->chartab_G[edp->chartab0];\n\t}\n\tdc = (ct ? ct[c] : c);\n\n\tif ((edp->flags & VTFL_INSERTMODE) && COLS_LEFT)\n\t\tCOPYCOLS(edp->ccol, edp->ccol + 1, COLS_LEFT);\n\n\t(*edp->emulops->putchar)(edp->emulcookie, edp->crow,\n\t\t\t\t edp->ccol << edp->dw, dc,\n\t\t\t\t kernel ? edp->kernattr : edp->curattr);\n\n\tif (COLS_LEFT)\n\t\tedp->ccol++;\n\telse\n\t\tedp->flags |= VTFL_LASTCHAR;\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void wsemul_vt100_output_normal",
      "int ccol, crow;",
      "int ccol, crow;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->crow",
            "edp->ccol << edp->dw",
            "dc",
            "kernel ? edp->kernattr : edp->curattr"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COPYCOLS",
          "args": [
            "edp->ccol",
            "edp->ccol + 1",
            "COLS_LEFT"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_scrollup",
          "args": [
            "edp",
            "1"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_scrollup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "55-82",
          "snippet": "void\nwsemul_vt100_scrollup(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow + help, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow + help], n);\n\tCHECK_DW;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_scrollup(edp, n)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint n;\n{\n\tint help;\n\n\tif (n > edp->scrreg_nrows)\n\t\tn = edp->scrreg_nrows;\n\n\thelp = edp->scrreg_nrows - n;\n\tif (help > 0) {\n\t\t(*edp->emulops->copyrows)(edp->emulcookie,\n\t\t\t\t\t  edp->scrreg_startrow + n,\n\t\t\t\t\t  edp->scrreg_startrow,\n\t\t\t\t\t  help);\n\t\tif (edp->dblwid)\n\t\t\tmemmove(&edp->dblwid[edp->scrreg_startrow],\n\t\t\t\t&edp->dblwid[edp->scrreg_startrow + n],\n\t\t\t\thelp);\n\t}\n\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t   edp->scrreg_startrow + help, n,\n\t\t\t\t   edp->bkgdattr);\n\tif (edp->dblwid)\n\t\tbzero(&edp->dblwid[edp->scrreg_startrow + help], n);\n\tCHECK_DW;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void wsemul_vt100_output_normal;\nint ccol, crow;\nint ccol, crow;\n\nstatic void\nwsemul_vt100_output_normal(edp, c, kernel)\n\tstruct wsemul_vt100_emuldata *edp;\n\tu_char c;\n\tint kernel;\n{\n\tu_int *ct, dc;\n\n\tif ((edp->flags & (VTFL_LASTCHAR | VTFL_DECAWM)) ==\n\t    (VTFL_LASTCHAR | VTFL_DECAWM)) {\n\t\tif (ROWS_BELOW > 0) {\n\t\t\tedp->crow++;\n\t\t\tCHECK_DW;\n\t\t} else\n\t\t\twsemul_vt100_scrollup(edp, 1);\n\t\tedp->ccol = 0;\n\t\tedp->flags &= ~VTFL_LASTCHAR;\n\t}\n\n\tif (c & 0x80) {\n\t\tc &= 0x7f;\n\t\tct = edp->chartab_G[edp->chartab1];\n\t} else {\n\t\tif (edp->sschartab) {\n\t\t\tct = edp->chartab_G[edp->sschartab];\n\t\t\tedp->sschartab = 0;\n\t\t} else\n\t\t\tct = edp->chartab_G[edp->chartab0];\n\t}\n\tdc = (ct ? ct[c] : c);\n\n\tif ((edp->flags & VTFL_INSERTMODE) && COLS_LEFT)\n\t\tCOPYCOLS(edp->ccol, edp->ccol + 1, COLS_LEFT);\n\n\t(*edp->emulops->putchar)(edp->emulcookie, edp->crow,\n\t\t\t\t edp->ccol << edp->dw, dc,\n\t\t\t\t kernel ? edp->kernattr : edp->curattr);\n\n\tif (COLS_LEFT)\n\t\tedp->ccol++;\n\telse\n\t\tedp->flags |= VTFL_LASTCHAR;\n}"
  },
  {
    "function_name": "wsemul_vt100_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "282-310",
    "snippet": "void\nwsemul_vt100_reset(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tedp->state = VT100_EMUL_STATE_NORMAL;\n\tedp->flags = VTFL_DECAWM | VTFL_CURSORON;\n\tedp->bkgdattr = edp->curattr = edp->defattr;\n\tedp->attrflags = 0;\n\tedp->fgcol = WSCOL_WHITE;\n\tedp->bgcol = WSCOL_BLACK;\n\tedp->scrreg_startrow = 0;\n\tedp->scrreg_nrows = edp->nrows;\n\tif (edp->tabs) {\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tfor (i = 8; i < edp->ncols; i += 8)\n\t\t\tedp->tabs[i] = 1;\n\t}\n\tedp->dcspos = 0;\n\tedp->dcstype = 0;\n\tedp->chartab_G[0] = 0;\n\tedp->chartab_G[1] = edp->nrctab; /* ??? */\n\tedp->chartab_G[2] = edp->isolatin1tab;\n\tedp->chartab_G[3] = edp->isolatin1tab;\n\tedp->chartab0 = 0;\n\tedp->chartab1 = 2;\n\tedp->sschartab = 0;\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
    ],
    "globals_used": [
      "long defattr;",
      "long defattr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "edp->tabs",
            "edp->ncols"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nlong defattr;\nlong defattr;\n\nvoid\nwsemul_vt100_reset(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tedp->state = VT100_EMUL_STATE_NORMAL;\n\tedp->flags = VTFL_DECAWM | VTFL_CURSORON;\n\tedp->bkgdattr = edp->curattr = edp->defattr;\n\tedp->attrflags = 0;\n\tedp->fgcol = WSCOL_WHITE;\n\tedp->bgcol = WSCOL_BLACK;\n\tedp->scrreg_startrow = 0;\n\tedp->scrreg_nrows = edp->nrows;\n\tif (edp->tabs) {\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tfor (i = 8; i < edp->ncols; i += 8)\n\t\t\tedp->tabs[i] = 1;\n\t}\n\tedp->dcspos = 0;\n\tedp->dcstype = 0;\n\tedp->chartab_G[0] = 0;\n\tedp->chartab_G[1] = edp->nrctab; /* ??? */\n\tedp->chartab_G[2] = edp->isolatin1tab;\n\tedp->chartab_G[3] = edp->isolatin1tab;\n\tedp->chartab0 = 0;\n\tedp->chartab1 = 2;\n\tedp->sschartab = 0;\n}"
  },
  {
    "function_name": "wsemul_vt100_resetop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "257-280",
    "snippet": "void\nwsemul_vt100_resetop(cookie, op)\n\tvoid *cookie;\n\tenum wsemul_resetops op;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\n\tswitch (op) {\n\tcase WSEMUL_RESET:\n\t\twsemul_vt100_reset(edp);\n\t\tbreak;\n\tcase WSEMUL_SYNCFONT:\n\t\tvt100_initchartables(edp);\n\t\tbreak;\n\tcase WSEMUL_CLEARSCREEN:\n\t\twsemul_vt100_ed(edp, 2);\n\t\tedp->ccol = edp->crow = 0;\n\t\t(*edp->emulops->cursor)(edp->emulcookie,\n\t\t\t\t\tedp->flags & VTFL_CURSORON, 0, 0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\twsemul_vt100_resetop",
      "void *cookie;",
      "int ccol, crow;",
      "void *cookie;",
      "int ccol, crow;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "edp->emulcookie",
            "edp->flags & VTFL_CURSORON",
            "0",
            "0"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_ed",
          "args": [
            "edp",
            "2"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_ed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_subr.c",
          "lines": "119-162",
          "snippet": "void\nwsemul_vt100_ed(edp, arg)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint arg;\n{\n\tint n;\n\n\tswitch (arg) {\n\t    case 0: /* cursor to end */\n\t\tERASECOLS(edp->ccol, COLS_LEFT + 1, edp->bkgdattr);\n\t\tn = edp->nrows - edp->crow - 1;\n\t\tif (n > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   edp->crow + 1, n,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[edp->crow + 1], n);\n\t\t}\n\t\tbreak;\n\t    case 1: /* beginning to cursor */\n\t\tif (edp->crow > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   0, edp->crow,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[0], edp->crow);\n\t\t}\n\t\tERASECOLS(0, edp->ccol + 1, edp->bkgdattr);\n\t\tbreak;\n\t    case 2: /* complete display */\n\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t   0, edp->nrows,\n\t\t\t\t\t   edp->bkgdattr);\n\t\tif (edp->dblwid)\n\t\t\tbzero(&edp->dblwid[0], edp->nrows);\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ed(%d) unknown\\n\", arg);\n#endif\n\t\tbreak;\n\t}\n\tCHECK_DW;\n}",
          "includes": [
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nwsemul_vt100_ed(edp, arg)\n\tstruct wsemul_vt100_emuldata *edp;\n\tint arg;\n{\n\tint n;\n\n\tswitch (arg) {\n\t    case 0: /* cursor to end */\n\t\tERASECOLS(edp->ccol, COLS_LEFT + 1, edp->bkgdattr);\n\t\tn = edp->nrows - edp->crow - 1;\n\t\tif (n > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   edp->crow + 1, n,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[edp->crow + 1], n);\n\t\t}\n\t\tbreak;\n\t    case 1: /* beginning to cursor */\n\t\tif (edp->crow > 0) {\n\t\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t\t   0, edp->crow,\n\t\t\t\t\t\t   edp->bkgdattr);\n\t\t\tif (edp->dblwid)\n\t\t\t\tbzero(&edp->dblwid[0], edp->crow);\n\t\t}\n\t\tERASECOLS(0, edp->ccol + 1, edp->bkgdattr);\n\t\tbreak;\n\t    case 2: /* complete display */\n\t\t(*edp->emulops->eraserows)(edp->emulcookie,\n\t\t\t\t\t   0, edp->nrows,\n\t\t\t\t\t   edp->bkgdattr);\n\t\tif (edp->dblwid)\n\t\t\tbzero(&edp->dblwid[0], edp->nrows);\n\t\tbreak;\n\t    default:\n#ifdef VT100_PRINTUNKNOWN\n\t\tprintf(\"ed(%d) unknown\\n\", arg);\n#endif\n\t\tbreak;\n\t}\n\tCHECK_DW;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vt100_initchartables",
          "args": [
            "edp"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "vt100_initchartables",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100_chars.c",
          "lines": "82-98",
          "snippet": "void\nvt100_initchartables(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, 128 + i,\n\t\t\t\t\t &edp->isolatin1tab[i]);\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, decspcgr2uni[i],\n\t\t\t\t\t &edp->decgraphtab[i]);\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, dectech2uni[i],\n\t\t\t\t\t &edp->dectechtab[i]);\n\tvt100_setnrc(edp, 0);\n}",
          "includes": [
            "#include <dev/wscons/unicode.h>",
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u_int16_t decspcgr2uni[128] = {\n\t0x0000, 0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007,\n\t0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e, 0x000f,\n\t0x0010, 0x0011, 0x0012, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017,\n\t0x0018, 0x0019, 0x001a, 0x001b, 0x001c, 0x001d, 0x001e, 0x001f,\n/* 2 */\t0x0020, 0x0021, 0x0022, 0x0023, 0x0024, 0x0025, 0x0026, 0x0027,\n\t0x0028, 0x0029, 0x002a, 0x002b, 0x002c, 0x002d, 0x002e, 0x002f,\n\t0x0030, 0x0031, 0x0032, 0x0033, 0x0034, 0x0035, 0x0036, 0x0037,\n\t0x0038, 0x0039, 0x003a, 0x003b, 0x003c, 0x003d, 0x003e, 0x003f,\n/* 4 */\t0x0040, 0x0041, 0x0042, 0x0043, 0x0044, 0x0045, 0x0046, 0x0047,\n\t0x0048, 0x0049, 0x004a, 0x004b, 0x004c, 0x004d, 0x004e, 0x004f,\n\t0x0050, 0x0051, 0x0052, 0x0053, 0x0054, 0x0055, 0x0056, 0x0057,\n\t0x0058, 0x0059, 0x005a, 0x005b, 0x005c, 0x005d, 0x005e, 0x00a0,\n/* 6 */\t0x25c6, 0x2592, 0x2409, 0x240c, 0x240d, 0x240a, 0x00b0, 0x00b1,\n\t_e006U, 0x240b, 0x2518, 0x2510, 0x250c, 0x2514, 0x253c, _e001U,\n\t_e002U, _e003U, _e004U, _e005U, 0x251c, 0x2524, 0x2534, 0x252c,\n\t0x2502, 0x2264, 0x2265, 0x03c0, 0x2260, 0x00a3, 0x00b7, 0x007f,\n};",
            "static u_int16_t dectech2uni[128] = {\n\t0x0000, 0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007,\n\t0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e, 0x000f,\n\t0x0010, 0x0011, 0x0012, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017,\n\t0x0018, 0x0019, 0x001a, 0x001b, 0x001c, 0x001d, 0x001e, 0x001f,\n/* 2 */\t0x0020, 0x221a, 0x250c, 0x2212, 0x2320, 0x2321, 0x2502, 0x2308,\n\t0x230a, 0x2309, 0x230b, _e007U, _e008U, _e009U, _e00aU, _e00bU,\n\t_e00cU, _e00dU, _e00eU, 0x2216, 0x2215, 0x00ac, _e00fU, 0x232a,\n\t_e000U, _e000U, _e000U, _e000U, 0x2264, 0x2260, 0x2265, 0x222b,\n/* 4 */\t0x2234, 0x221d, 0x221e, 0x00f7, 0x2206, 0x2207, 0x03a6, 0x0393,\n\t0x223c, 0x2243, 0x0398, 0x00d7, 0x039b, 0x21d4, 0x21d2, 0x2261,\n\t0x03a0, 0x03a8, _e000U, 0x03a3, _e000U, _e000U, 0x221a, 0x03a9,\n\t0x039e, 0x03a5, 0x2282, 0x2283, 0x2229, 0x222a, 0x2227, 0x2228,\n/* 6 */\t0x00ac, 0x03b1, 0x03b2, 0x03c7, 0x03b4, 0x03b5, 0x03c6, 0x03b3,\n\t0x03b7, 0x03b9, 0x03b8, 0x03ba, 0x03bb, _e000U, 0x03bd, 0x2202,\n\t0x03c0, 0x03c8, 0x03c1, 0x03c3, 0x03c4, _e000U, 0x0192, 0x03c9,\n\t0x03be, 0x03c5, 0x03b6, 0x2190, 0x2191, 0x2192, 0x2193, 0x007f,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/unicode.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic u_int16_t decspcgr2uni[128] = {\n\t0x0000, 0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007,\n\t0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e, 0x000f,\n\t0x0010, 0x0011, 0x0012, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017,\n\t0x0018, 0x0019, 0x001a, 0x001b, 0x001c, 0x001d, 0x001e, 0x001f,\n/* 2 */\t0x0020, 0x0021, 0x0022, 0x0023, 0x0024, 0x0025, 0x0026, 0x0027,\n\t0x0028, 0x0029, 0x002a, 0x002b, 0x002c, 0x002d, 0x002e, 0x002f,\n\t0x0030, 0x0031, 0x0032, 0x0033, 0x0034, 0x0035, 0x0036, 0x0037,\n\t0x0038, 0x0039, 0x003a, 0x003b, 0x003c, 0x003d, 0x003e, 0x003f,\n/* 4 */\t0x0040, 0x0041, 0x0042, 0x0043, 0x0044, 0x0045, 0x0046, 0x0047,\n\t0x0048, 0x0049, 0x004a, 0x004b, 0x004c, 0x004d, 0x004e, 0x004f,\n\t0x0050, 0x0051, 0x0052, 0x0053, 0x0054, 0x0055, 0x0056, 0x0057,\n\t0x0058, 0x0059, 0x005a, 0x005b, 0x005c, 0x005d, 0x005e, 0x00a0,\n/* 6 */\t0x25c6, 0x2592, 0x2409, 0x240c, 0x240d, 0x240a, 0x00b0, 0x00b1,\n\t_e006U, 0x240b, 0x2518, 0x2510, 0x250c, 0x2514, 0x253c, _e001U,\n\t_e002U, _e003U, _e004U, _e005U, 0x251c, 0x2524, 0x2534, 0x252c,\n\t0x2502, 0x2264, 0x2265, 0x03c0, 0x2260, 0x00a3, 0x00b7, 0x007f,\n};\nstatic u_int16_t dectech2uni[128] = {\n\t0x0000, 0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007,\n\t0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e, 0x000f,\n\t0x0010, 0x0011, 0x0012, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017,\n\t0x0018, 0x0019, 0x001a, 0x001b, 0x001c, 0x001d, 0x001e, 0x001f,\n/* 2 */\t0x0020, 0x221a, 0x250c, 0x2212, 0x2320, 0x2321, 0x2502, 0x2308,\n\t0x230a, 0x2309, 0x230b, _e007U, _e008U, _e009U, _e00aU, _e00bU,\n\t_e00cU, _e00dU, _e00eU, 0x2216, 0x2215, 0x00ac, _e00fU, 0x232a,\n\t_e000U, _e000U, _e000U, _e000U, 0x2264, 0x2260, 0x2265, 0x222b,\n/* 4 */\t0x2234, 0x221d, 0x221e, 0x00f7, 0x2206, 0x2207, 0x03a6, 0x0393,\n\t0x223c, 0x2243, 0x0398, 0x00d7, 0x039b, 0x21d4, 0x21d2, 0x2261,\n\t0x03a0, 0x03a8, _e000U, 0x03a3, _e000U, _e000U, 0x221a, 0x03a9,\n\t0x039e, 0x03a5, 0x2282, 0x2283, 0x2229, 0x222a, 0x2227, 0x2228,\n/* 6 */\t0x00ac, 0x03b1, 0x03b2, 0x03c7, 0x03b4, 0x03b5, 0x03c6, 0x03b3,\n\t0x03b7, 0x03b9, 0x03b8, 0x03ba, 0x03bb, _e000U, 0x03bd, 0x2202,\n\t0x03c0, 0x03c8, 0x03c1, 0x03c3, 0x03c4, _e000U, 0x0192, 0x03c9,\n\t0x03be, 0x03c5, 0x03b6, 0x2190, 0x2191, 0x2192, 0x2193, 0x007f,\n};\n\nvoid\nvt100_initchartables(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, 128 + i,\n\t\t\t\t\t &edp->isolatin1tab[i]);\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, decspcgr2uni[i],\n\t\t\t\t\t &edp->decgraphtab[i]);\n\tfor (i = 0; i < 128; i++)\n\t\t(*edp->emulops->mapchar)(edp->emulcookie, dectech2uni[i],\n\t\t\t\t\t &edp->dectechtab[i]);\n\tvt100_setnrc(edp, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wsemul_vt100_reset",
          "args": [
            "edp"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "wsemul_vt100_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
          "lines": "282-310",
          "snippet": "void\nwsemul_vt100_reset(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tedp->state = VT100_EMUL_STATE_NORMAL;\n\tedp->flags = VTFL_DECAWM | VTFL_CURSORON;\n\tedp->bkgdattr = edp->curattr = edp->defattr;\n\tedp->attrflags = 0;\n\tedp->fgcol = WSCOL_WHITE;\n\tedp->bgcol = WSCOL_BLACK;\n\tedp->scrreg_startrow = 0;\n\tedp->scrreg_nrows = edp->nrows;\n\tif (edp->tabs) {\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tfor (i = 8; i < edp->ncols; i += 8)\n\t\t\tedp->tabs[i] = 1;\n\t}\n\tedp->dcspos = 0;\n\tedp->dcstype = 0;\n\tedp->chartab_G[0] = 0;\n\tedp->chartab_G[1] = edp->nrctab; /* ??? */\n\tedp->chartab_G[2] = edp->isolatin1tab;\n\tedp->chartab_G[3] = edp->isolatin1tab;\n\tedp->chartab0 = 0;\n\tedp->chartab1 = 2;\n\tedp->sschartab = 0;\n}",
          "includes": [
            "#include <dev/wscons/ascii.h>",
            "#include <dev/wscons/wsemul_vt100var.h>",
            "#include <dev/wscons/wsemulvar.h>",
            "#include <dev/wscons/wsdisplayvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/malloc.h>",
            "#include <sys/time.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */"
          ],
          "globals_used": [
            "long defattr;",
            "long defattr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define\tVT100_EMUL_STATE_NORMAL\t\t0\t/* normal processing */\n\nlong defattr;\nlong defattr;\n\nvoid\nwsemul_vt100_reset(edp)\n\tstruct wsemul_vt100_emuldata *edp;\n{\n\tint i;\n\n\tedp->state = VT100_EMUL_STATE_NORMAL;\n\tedp->flags = VTFL_DECAWM | VTFL_CURSORON;\n\tedp->bkgdattr = edp->curattr = edp->defattr;\n\tedp->attrflags = 0;\n\tedp->fgcol = WSCOL_WHITE;\n\tedp->bgcol = WSCOL_BLACK;\n\tedp->scrreg_startrow = 0;\n\tedp->scrreg_nrows = edp->nrows;\n\tif (edp->tabs) {\n\t\tbzero(edp->tabs, edp->ncols);\n\t\tfor (i = 8; i < edp->ncols; i += 8)\n\t\t\tedp->tabs[i] = 1;\n\t}\n\tedp->dcspos = 0;\n\tedp->dcstype = 0;\n\tedp->chartab_G[0] = 0;\n\tedp->chartab_G[1] = edp->nrctab; /* ??? */\n\tedp->chartab_G[2] = edp->isolatin1tab;\n\tedp->chartab_G[3] = edp->isolatin1tab;\n\tedp->chartab0 = 0;\n\tedp->chartab1 = 2;\n\tedp->sschartab = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\twsemul_vt100_resetop;\nvoid *cookie;\nint ccol, crow;\nvoid *cookie;\nint ccol, crow;\n\nvoid\nwsemul_vt100_resetop(cookie, op)\n\tvoid *cookie;\n\tenum wsemul_resetops op;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\n\tswitch (op) {\n\tcase WSEMUL_RESET:\n\t\twsemul_vt100_reset(edp);\n\t\tbreak;\n\tcase WSEMUL_SYNCFONT:\n\t\tvt100_initchartables(edp);\n\t\tbreak;\n\tcase WSEMUL_CLEARSCREEN:\n\t\twsemul_vt100_ed(edp, 2);\n\t\tedp->ccol = edp->crow = 0;\n\t\t(*edp->emulops->cursor)(edp->emulcookie,\n\t\t\t\t\tedp->flags & VTFL_CURSORON, 0, 0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "wsemul_vt100_detach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "235-255",
    "snippet": "void\nwsemul_vt100_detach(cookie, crowp, ccolp)\n\tvoid *cookie;\n\tu_int *crowp, *ccolp;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\n\t*crowp = edp->crow;\n\t*ccolp = edp->ccol;\n#define f(ptr) if (ptr) {free(ptr, M_DEVBUF); ptr = 0;}\n\tf(edp->tabs)\n\tf(edp->dblwid)\n\tf(edp->dcsarg)\n\tf(edp->isolatin1tab)\n\tf(edp->decgraphtab)\n\tf(edp->dectechtab)\n\tf(edp->nrctab)\n#undef f\n\tif (edp != &wsemul_vt100_console_emuldata)\n\t\tfree(edp, M_DEVBUF);\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void\twsemul_vt100_detach",
      "struct wsemul_vt100_emuldata wsemul_vt100_console_emuldata;",
      "void *cookie;",
      "int ccol, crow;",
      "void *cookie;",
      "int ccol, crow;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "edp",
            "M_DEVBUF"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "wskbd_pickfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbd.c",
          "lines": "1057-1070",
          "snippet": "int\nwskbd_pickfree()\n{\n\tint i;\n\tstruct wskbd_softc *sc;\n\n\tfor (i = 0; i < wskbd_cd.cd_ndevs; i++) {\n\t\tif ((sc = wskbd_cd.cd_devs[i]) == NULL)\n\t\t\tcontinue;\n\t\tif (sc->sc_displaydv == NULL)\n\t\t\treturn (i);\n\t}\n\treturn (-1);\n}",
          "includes": [
            "#include <dev/wscons/wsmuxvar.h>",
            "#include \"wsmux.h\"",
            "#include \"wsdisplay.h\"",
            "#include <dev/wscons/wscons_callbacks.h>",
            "#include <dev/wscons/wseventvar.h>",
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <dev/wscons/wskbdvar.h>",
            "#include <dev/wscons/wsconsio.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/errno.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/tty.h>",
            "#include <sys/malloc.h>",
            "#include <sys/timeout.h>",
            "#include <sys/systm.h>",
            "#include <sys/syslog.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/device.h>",
            "#include <sys/conf.h>",
            "#include <sys/param.h>",
            "#include <sys/cdefs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cfdriver wskbd_cd = {\n\tNULL, \"wskbd\", DV_TTY\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsmuxvar.h>\n#include \"wsmux.h\"\n#include \"wsdisplay.h\"\n#include <dev/wscons/wscons_callbacks.h>\n#include <dev/wscons/wseventvar.h>\n#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <dev/wscons/wskbdvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/errno.h>\n#include <sys/signalvar.h>\n#include <sys/tty.h>\n#include <sys/malloc.h>\n#include <sys/timeout.h>\n#include <sys/systm.h>\n#include <sys/syslog.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/ioctl.h>\n#include <sys/device.h>\n#include <sys/conf.h>\n#include <sys/param.h>\n#include <sys/cdefs.h>\n\nstruct cfdriver wskbd_cd = {\n\tNULL, \"wskbd\", DV_TTY\n};\n\nint\nwskbd_pickfree()\n{\n\tint i;\n\tstruct wskbd_softc *sc;\n\n\tfor (i = 0; i < wskbd_cd.cd_ndevs; i++) {\n\t\tif ((sc = wskbd_cd.cd_devs[i]) == NULL)\n\t\t\tcontinue;\n\t\tif (sc->sc_displaydv == NULL)\n\t\t\treturn (i);\n\t}\n\treturn (-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "f",
          "args": [
            "edp->nrctab"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "fillmapentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wskbdutil.c",
          "lines": "285-328",
          "snippet": "static void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}",
          "includes": [
            "#include <dev/wscons/wsksymvar.h>",
            "#include <dev/wscons/wsksymdef.h>",
            "#include <sys/malloc.h>",
            "#include <sys/systm.h>",
            "#include <sys/errno.h>",
            "#include <sys/cdefs.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static keysym_t ksym_upcase",
            "static void fillmapentry"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/wscons/wsksymvar.h>\n#include <dev/wscons/wsksymdef.h>\n#include <sys/malloc.h>\n#include <sys/systm.h>\n#include <sys/errno.h>\n#include <sys/cdefs.h>\n#include <sys/types.h>\n#include <sys/param.h>\n\nstatic keysym_t ksym_upcase;\nstatic void fillmapentry;\n\nstatic void\nfillmapentry(kp, len, mapentry)\n\tconst keysym_t *kp;\n\tint len;\n\tstruct wscons_keymap *mapentry;\n{\n\tswitch (len) {\n\tcase 0:\n\t\tmapentry->group1[0] = KS_voidSymbol;\n\t\tmapentry->group1[1] = KS_voidSymbol;\n\t\tmapentry->group2[0] = KS_voidSymbol;\n\t\tmapentry->group2[1] = KS_voidSymbol;\n\t\tbreak;\n\n\tcase 1:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = ksym_upcase(kp[0]);\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 2:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = mapentry->group1[0];\n\t\tmapentry->group2[1] = mapentry->group1[1];\n\t\tbreak;\n\n\tcase 3:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = ksym_upcase(kp[2]);\n\t\tbreak;\n\n\tcase 4:\n\t\tmapentry->group1[0] = kp[0];\n\t\tmapentry->group1[1] = kp[1];\n\t\tmapentry->group2[0] = kp[2];\n\t\tmapentry->group2[1] = kp[3];\n\t\tbreak;\n\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\twsemul_vt100_detach;\nstruct wsemul_vt100_emuldata wsemul_vt100_console_emuldata;\nvoid *cookie;\nint ccol, crow;\nvoid *cookie;\nint ccol, crow;\n\nvoid\nwsemul_vt100_detach(cookie, crowp, ccolp)\n\tvoid *cookie;\n\tu_int *crowp, *ccolp;\n{\n\tstruct wsemul_vt100_emuldata *edp = cookie;\n\n\t*crowp = edp->crow;\n\t*ccolp = edp->ccol;\n#define f(ptr) if (ptr) {free(ptr, M_DEVBUF); ptr = 0;}\n\tf(edp->tabs)\n\tf(edp->dblwid)\n\tf(edp->dcsarg)\n\tf(edp->isolatin1tab)\n\tf(edp->decgraphtab)\n\tf(edp->dectechtab)\n\tf(edp->nrctab)\n#undef f\n\tif (edp != &wsemul_vt100_console_emuldata)\n\t\tfree(edp, M_DEVBUF);\n}"
  },
  {
    "function_name": "wsemul_vt100_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/wscons/wsemul_vt100.c",
    "lines": "121-137",
    "snippet": "static void\nwsemul_vt100_init(edp, type, cookie, ccol, crow, defattr)\n\tstruct wsemul_vt100_emuldata *edp;\n\tconst struct wsscreen_descr *type;\n\tvoid *cookie;\n\tint ccol, crow;\n\tlong defattr;\n{\n\tedp->emulops = type->textops;\n\tedp->emulcookie = cookie;\n\tedp->scrcapabilities = type->capabilities;\n\tedp->nrows = type->nrows;\n\tedp->ncols = type->ncols;\n\tedp->crow = crow;\n\tedp->ccol = ccol;\n\tedp->defattr = defattr;\n}",
    "includes": [
      "#include <dev/wscons/ascii.h>",
      "#include <dev/wscons/wsemul_vt100var.h>",
      "#include <dev/wscons/wsemulvar.h>",
      "#include <dev/wscons/wsdisplayvar.h>",
      "#include <dev/wscons/wsconsio.h>",
      "#include <sys/fcntl.h>",
      "#include <sys/malloc.h>",
      "#include <sys/time.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void wsemul_vt100_init",
      "void *\nwsemul_vt100_cnattach(type, cookie, ccol, crow, defattr)\n\tconst struct wsscreen_descr *type;",
      "void *cookie;",
      "int ccol, crow;",
      "long defattr;",
      "const struct wsscreen_descr *type;",
      "void *cookie;",
      "int ccol, crow;",
      "long defattr;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/wscons/ascii.h>\n#include <dev/wscons/wsemul_vt100var.h>\n#include <dev/wscons/wsemulvar.h>\n#include <dev/wscons/wsdisplayvar.h>\n#include <dev/wscons/wsconsio.h>\n#include <sys/fcntl.h>\n#include <sys/malloc.h>\n#include <sys/time.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void wsemul_vt100_init;\nvoid *\nwsemul_vt100_cnattach(type, cookie, ccol, crow, defattr)\n\tconst struct wsscreen_descr *type;\nvoid *cookie;\nint ccol, crow;\nlong defattr;\nconst struct wsscreen_descr *type;\nvoid *cookie;\nint ccol, crow;\nlong defattr;\n\nstatic void\nwsemul_vt100_init(edp, type, cookie, ccol, crow, defattr)\n\tstruct wsemul_vt100_emuldata *edp;\n\tconst struct wsscreen_descr *type;\n\tvoid *cookie;\n\tint ccol, crow;\n\tlong defattr;\n{\n\tedp->emulops = type->textops;\n\tedp->emulcookie = cookie;\n\tedp->scrcapabilities = type->capabilities;\n\tedp->nrows = type->nrows;\n\tedp->ncols = type->ncols;\n\tedp->crow = crow;\n\tedp->ccol = ccol;\n\tedp->defattr = defattr;\n}"
  }
]