[
  {
    "function_name": "isapnp_process_tag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpres.c",
    "lines": "225-433",
    "snippet": "int\nisapnp_process_tag(tag, len, buf, card, dev, conf)\n\tu_char tag, len, *buf;\n\tstruct isa_attach_args **card, **dev, **conf;\n{\n\tchar str[64];\n\tstruct isapnp_region *r;\n\tstruct isapnp_pin *p;\n\tstruct isa_attach_args *pa;\n\n#define COPY(a, b) strncpy((a), (b), sizeof(a)), (a)[sizeof(a) - 1] = '\\0'\n\n\tswitch (tag) {\n\tcase ISAPNP_TAG_VERSION_NUM:\n\t\tDPRINTF((\"PnP version %d.%d, Vendor version %d.%d\\n\",\n\t\t    buf[0] >> 4, buf[0] & 0xf, buf[1] >> 4,  buf[1] & 0xf));\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_LOGICAL_DEV_ID:\n\t\t(void) isapnp_id_to_vendor(str, buf);\n\t\tDPRINTF((\"Logical device id %s\\n\", str));\n\n\t\t*dev = isapnp_newdev(*card);\n\t\tCOPY((*dev)->ipa_devlogic, str);\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_COMPAT_DEV_ID:\n\t\t(void) isapnp_id_to_vendor(str, buf);\n\t\tDPRINTF((\"Compatible device id %s\\n\", str));\n\n\t\tif (*dev == NULL)\n\t\t\treturn -1;\n\n\t\tif (*(*dev)->ipa_devcompat == '\\0')\n\t\t\tCOPY((*dev)->ipa_devcompat, str);\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_DEP_START:\n\t\tif (len == 0)\n\t\t\tbuf[0] = ISAPNP_DEP_ACCEPTABLE;\n\n\t\tif (*dev == NULL)\n\t\t\treturn -1;\n\n\t\t*conf = isapnp_newconf(*dev);\n\t\t(*conf)->ipa_pref = buf[0];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_dep_start(\">>> Start dependent function \",\n\t\t    (*conf)->ipa_pref);\n#endif\n\t\treturn 0;\n\t\t\n\tcase ISAPNP_TAG_DEP_END:\n\t\tDPRINTF((\"<<<End dependent functions\\n\"));\n\t\t*conf = NULL;\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_ANSI_IDENT_STRING:\n\t\tbuf[len] = '\\0';\n\t\tDPRINTF((\"ANSI Ident: %s\\n\", buf));\n\t\tif (*dev == NULL)\n\t\t\tCOPY((*card)->ipa_devident, buf);\n\t\telse\n\t\t\tCOPY((*dev)->ipa_devclass, buf);\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_END:\n\t\t*dev = NULL;\n\t\treturn 0;\n\n\tdefault:\n\t\t/* Handled below */\n\t\tbreak;\n\t}\n\n\n\t/*\n\t * Decide which configuration we add the tag to\n\t */\n\tif (*conf)\n\t\tpa = *conf;\n\telse if (*dev)\n\t\tpa = *dev;\n\telse\n\t\t/* error */\n\t\treturn -1;\n\n\tswitch (tag) {\n\tcase ISAPNP_TAG_IRQ_FORMAT:\n\t\tif (len < 2)\n\t\t\tbreak;\n\n\t\tif (len != 3)\n\t\t\tbuf[2] = ISAPNP_IRQTYPE_EDGE_PLUS;\n\n\t\tp = &pa->ipa_irq[pa->ipa_nirq++];\n\t\tp->bits = buf[0] | (buf[1] << 8);\n\t\tp->flags = buf[2];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_irq(\"\", p);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_DMA_FORMAT:\n\t\tif (buf[0] == 0)\n\t\t\tbreak;\n\n\t\tp = &pa->ipa_drq[pa->ipa_ndrq++];\n\t\tp->bits = buf[0];\n\t\tp->flags = buf[1];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_drq(\"\", p);\n#endif\n\t\tbreak;\n\n\n\tcase ISAPNP_TAG_IO_PORT_DESC:\n\t\tr = &pa->ipa_io[pa->ipa_nio++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[2] << 8) | buf[1];\n\t\tr->maxbase = (buf[4] << 8) | buf[3];\n\t\tr->align = buf[5];\n\t\tr->length = buf[6];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_io(\"\", r);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_FIXED_IO_PORT_DESC:\n\t\tr = &pa->ipa_io[pa->ipa_nio++];\n\t\tr->flags = 0;\n\t\tr->minbase = (buf[1] << 8) | buf[0];\n\t\tr->maxbase = r->minbase;\n\t\tr->align = 1;\n\t\tr->length = buf[2];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_io(\"FIXED \", r);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_VENDOR_DEF:\n\t\tDPRINTF((\"Vendor defined (short)\\n\"));\n\t\tbreak;\n\n\tcase ISAPNP_TAG_MEM_RANGE_DESC:\n\t\tr = &pa->ipa_mem[pa->ipa_nmem++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[2] << 16) | (buf[1] << 8);\n\t\tr->maxbase = (buf[4] << 16) | (buf[3] << 8);\n\t\tr->align = (buf[6] << 8) | buf[5];\n\t\tr->length = (buf[8] << 16) | (buf[7] << 8);\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_mem(\"\", r);\n#endif\n\t\tbreak;\n\n\n\tcase ISAPNP_TAG_UNICODE_IDENT_STRING:\n\t\tDPRINTF((\"Unicode Ident\\n\"));\n\t\tbreak;\n\n\tcase ISAPNP_TAG_VENDOR_DEFINED:\n\t\tDPRINTF((\"Vendor defined (long)\\n\"));\n\t\tbreak;\n\n\tcase ISAPNP_TAG_MEM32_RANGE_DESC:\n\t\tr = &pa->ipa_mem32[pa->ipa_nmem32++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[4] << 24) | (buf[3] << 16) |\n\t\t    (buf[2] << 8) | buf[1];\n\t\tr->maxbase = (buf[8] << 24) | (buf[7] << 16) |\n\t\t    (buf[6] << 8) | buf[5];\n\t\tr->align = (buf[12] << 24) | (buf[11] << 16) | \n\t\t    (buf[10] << 8) | buf[9];\n\t\tr->length = (buf[16] << 24) | (buf[15] << 16) |\n\t\t    (buf[14] << 8) | buf[13];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_mem(\"32-bit \", r);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_FIXED_MEM32_RANGE_DESC:\n\t\tr = &pa->ipa_mem32[pa->ipa_nmem32++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[4] << 24) | (buf[3] << 16) |\n\t\t    (buf[2] << 8) | buf[1];\n\t\tr->maxbase = r->minbase;\n\t\tr->align = 1;\n\t\tr->length = (buf[8] << 24) | (buf[7] << 16) |\n\t\t    (buf[6] << 8) | buf[5];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_mem(\"FIXED 32-bit \", r);\n#endif\n\t\tbreak;\n\n\tdefault:\n#ifdef DEBUG_ISAPNP\n\t\t{\n\t\t\tint i;\n\t\t\tprintf(\"tag %.2x, len %d: \", tag, len);\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tprintf(\"%.2x \", buf[i]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n#endif\n\t\tbreak;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct isa_attach_args *\n    isapnp_newdev",
      "struct isa_attach_args *\n    isapnp_newconf",
      "int isapnp_process_tag",
      "struct isa_attach_args *\nisapnp_newdev(card)\n\tstruct isa_attach_args *card;",
      "struct isa_attach_args *\nisapnp_newconf(dev)\n\tstruct isa_attach_args *dev;",
      "struct isa_attach_args *\nisapnp_flatten(card)\n\tstruct isa_attach_args *card;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_print_mem",
          "args": [
            "\"FIXED 32-bit \"",
            "r"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "48-79",
          "snippet": "void\nisapnp_print_mem(str, mem)\n\tconst char *str;\n\tconst struct isapnp_region *mem;\n{\n\tprintf(\"%sMemory: %s,%sshadowable,decode-%s,%scacheable,%s\", str,\n\t    (mem->flags & ISAPNP_MEMATTR_ROM) ? \"ROM,\" : \"RAM,\",\n\t    (mem->flags & ISAPNP_MEMATTR_SHADOWABLE) ? \"\" : \"non-\",\n\t    (mem->flags & ISAPNP_MEMATTR_HIGH_ADDR) ?\n\t\t\"high-addr,\" : \"range-len,\",\n\t    (mem->flags & ISAPNP_MEMATTR_CACHEABLE) ? \"\" : \"non-\",\n\t    (mem->flags & ISAPNP_MEMATTR_WRITEABLE) ?\n\t\t\"writeable,\" : \"read-only,\");\n\n\tswitch (mem->flags & ISAPNP_MEMWIDTH_MASK) {\n\tcase ISAPNP_MEMWIDTH_8:\n\t\tprintf(\"8-bit \");\n\t\tbreak;\n\tcase ISAPNP_MEMWIDTH_16:\n\t\tprintf(\"16-bit \");\n\t\tbreak;\n\tcase ISAPNP_MEMWIDTH_8_16:\n\t\tprintf(\"8/16-bit \");\n\t\tbreak;\n\tcase ISAPNP_MEMWIDTH_32:\n\t\tprintf(\"32-bit \");\n\t\tbreak;\n\t}\n\n\tprintf(\"min 0x%x, max 0x%x, \", mem->minbase, mem->maxbase);\n\tprintf(\"align 0x%x, length 0x%x\\n\", mem->align, mem->length);\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_print_mem(str, mem)\n\tconst char *str;\n\tconst struct isapnp_region *mem;\n{\n\tprintf(\"%sMemory: %s,%sshadowable,decode-%s,%scacheable,%s\", str,\n\t    (mem->flags & ISAPNP_MEMATTR_ROM) ? \"ROM,\" : \"RAM,\",\n\t    (mem->flags & ISAPNP_MEMATTR_SHADOWABLE) ? \"\" : \"non-\",\n\t    (mem->flags & ISAPNP_MEMATTR_HIGH_ADDR) ?\n\t\t\"high-addr,\" : \"range-len,\",\n\t    (mem->flags & ISAPNP_MEMATTR_CACHEABLE) ? \"\" : \"non-\",\n\t    (mem->flags & ISAPNP_MEMATTR_WRITEABLE) ?\n\t\t\"writeable,\" : \"read-only,\");\n\n\tswitch (mem->flags & ISAPNP_MEMWIDTH_MASK) {\n\tcase ISAPNP_MEMWIDTH_8:\n\t\tprintf(\"8-bit \");\n\t\tbreak;\n\tcase ISAPNP_MEMWIDTH_16:\n\t\tprintf(\"16-bit \");\n\t\tbreak;\n\tcase ISAPNP_MEMWIDTH_8_16:\n\t\tprintf(\"8/16-bit \");\n\t\tbreak;\n\tcase ISAPNP_MEMWIDTH_32:\n\t\tprintf(\"32-bit \");\n\t\tbreak;\n\t}\n\n\tprintf(\"min 0x%x, max 0x%x, \", mem->minbase, mem->maxbase);\n\tprintf(\"align 0x%x, length 0x%x\\n\", mem->align, mem->length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"Vendor defined (long)\\n\")"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"Unicode Ident\\n\")"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"Vendor defined (short)\\n\")"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_print_io",
          "args": [
            "\"FIXED \"",
            "r"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "85-95",
          "snippet": "void\nisapnp_print_io(str, io)\n\tconst char *str;\n\tconst struct isapnp_region *io;\n{\n\tprintf(\"%d %sIO Ports: %d address bits, alignment %d \",\n\t    io->length, str, (io->flags & ISAPNP_IOFLAGS_16) ? 16 : 10,\n\t    io->align);\n\n\tprintf(\"min 0x%x, max 0x%x\\n\", io->minbase, io->maxbase);\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_print_io(str, io)\n\tconst char *str;\n\tconst struct isapnp_region *io;\n{\n\tprintf(\"%d %sIO Ports: %d address bits, alignment %d \",\n\t    io->length, str, (io->flags & ISAPNP_IOFLAGS_16) ? 16 : 10,\n\t    io->align);\n\n\tprintf(\"min 0x%x, max 0x%x\\n\", io->minbase, io->maxbase);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_print_drq",
          "args": [
            "\"\"",
            "p"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_drq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "127-178",
          "snippet": "void\nisapnp_print_drq(str, drq)\n\tconst char *str;\n\tconst struct isapnp_pin *drq;\n{\n\tint i;\n\tu_char flags = drq->flags;\n\n\tprintf(\"%sDRQ's supported: \", str);\n\tfor (i = 0; i < 8; i++)\n\t\tif (drq->bits & (1 << i))\n\t\t    printf(\"%d \", i);\n\n\tprintf(\"Width: \");\n\tswitch (flags & ISAPNP_DMAWIDTH_MASK) {\n\tcase ISAPNP_DMAWIDTH_8:\n\t\tprintf(\"8-bit \");\n\t\tbreak;\n\tcase ISAPNP_DMAWIDTH_8_16:\n\t\tprintf(\"8/16-bit \");\n\t\tbreak;\n\tcase ISAPNP_DMAWIDTH_16:\n\t\tprintf(\"16-bit \");\n\t\tbreak;\n\tcase ISAPNP_DMAWIDTH_RESERVED:\n\t\tprintf(\"Reserved \");\n\t\tbreak;\n\t}\n\n\tprintf(\"Speed: \");\n\tswitch (flags & ISAPNP_DMASPEED_MASK) {\n\tcase ISAPNP_DMASPEED_COMPAT:\n\t\tprintf(\"compat \");\n\t\tbreak;\n\tcase ISAPNP_DMASPEED_A:\n\t\tprintf(\"A \");\n\t\tbreak;\n\tcase ISAPNP_DMASPEED_B:\n\t\tprintf(\"B \");\n\t\tbreak;\n\tcase ISAPNP_DMASPEED_F:\n\t\tprintf(\"F \");\n\t\tbreak;\n\t}\n\n\tif (flags & ISAPNP_DMAATTR_MASK)\n\t\tprintf(\"Attributes: %s%s%s\",\n\t\t    (flags & ISAPNP_DMAATTR_BUS_MASTER) ?  \"bus master \" : \"\",\n\t\t    (flags & ISAPNP_DMAATTR_INCR_8) ?  \"incr 8 \" : \"\",\n\t\t    (flags & ISAPNP_DMAATTR_INCR_16) ?  \"incr 16 \" : \"\");\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_print_drq(str, drq)\n\tconst char *str;\n\tconst struct isapnp_pin *drq;\n{\n\tint i;\n\tu_char flags = drq->flags;\n\n\tprintf(\"%sDRQ's supported: \", str);\n\tfor (i = 0; i < 8; i++)\n\t\tif (drq->bits & (1 << i))\n\t\t    printf(\"%d \", i);\n\n\tprintf(\"Width: \");\n\tswitch (flags & ISAPNP_DMAWIDTH_MASK) {\n\tcase ISAPNP_DMAWIDTH_8:\n\t\tprintf(\"8-bit \");\n\t\tbreak;\n\tcase ISAPNP_DMAWIDTH_8_16:\n\t\tprintf(\"8/16-bit \");\n\t\tbreak;\n\tcase ISAPNP_DMAWIDTH_16:\n\t\tprintf(\"16-bit \");\n\t\tbreak;\n\tcase ISAPNP_DMAWIDTH_RESERVED:\n\t\tprintf(\"Reserved \");\n\t\tbreak;\n\t}\n\n\tprintf(\"Speed: \");\n\tswitch (flags & ISAPNP_DMASPEED_MASK) {\n\tcase ISAPNP_DMASPEED_COMPAT:\n\t\tprintf(\"compat \");\n\t\tbreak;\n\tcase ISAPNP_DMASPEED_A:\n\t\tprintf(\"A \");\n\t\tbreak;\n\tcase ISAPNP_DMASPEED_B:\n\t\tprintf(\"B \");\n\t\tbreak;\n\tcase ISAPNP_DMASPEED_F:\n\t\tprintf(\"F \");\n\t\tbreak;\n\t}\n\n\tif (flags & ISAPNP_DMAATTR_MASK)\n\t\tprintf(\"Attributes: %s%s%s\",\n\t\t    (flags & ISAPNP_DMAATTR_BUS_MASTER) ?  \"bus master \" : \"\",\n\t\t    (flags & ISAPNP_DMAATTR_INCR_8) ?  \"incr 8 \" : \"\",\n\t\t    (flags & ISAPNP_DMAATTR_INCR_16) ?  \"incr 16 \" : \"\");\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_print_irq",
          "args": [
            "\"\"",
            "p"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "101-122",
          "snippet": "void\nisapnp_print_irq(str, irq)\n\tconst char *str;\n\tconst struct isapnp_pin *irq;\n{\n\tint i;\n\n\tprintf(\"%sIRQ's supported: \", str);\n\tfor (i = 0; i < 16; i++)\n\t\tif (irq->bits & (1 << i))\n\t\t    printf(\"%d \", i);\n\n\tif (irq->flags & ISAPNP_IRQTYPE_EDGE_PLUS)\n\t\tprintf(\"E+\");\n\tif (irq->flags & ISAPNP_IRQTYPE_EDGE_MINUS)\n\t\tprintf(\"E-\");\n\tif (irq->flags & ISAPNP_IRQTYPE_LEVEL_PLUS)\n\t\tprintf(\"L+\");\n\tif (irq->flags & ISAPNP_IRQTYPE_LEVEL_MINUS)\n\t\tprintf(\"L-\");\n\tprintf(\"\\n\");\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_print_irq(str, irq)\n\tconst char *str;\n\tconst struct isapnp_pin *irq;\n{\n\tint i;\n\n\tprintf(\"%sIRQ's supported: \", str);\n\tfor (i = 0; i < 16; i++)\n\t\tif (irq->bits & (1 << i))\n\t\t    printf(\"%d \", i);\n\n\tif (irq->flags & ISAPNP_IRQTYPE_EDGE_PLUS)\n\t\tprintf(\"E+\");\n\tif (irq->flags & ISAPNP_IRQTYPE_EDGE_MINUS)\n\t\tprintf(\"E-\");\n\tif (irq->flags & ISAPNP_IRQTYPE_LEVEL_PLUS)\n\t\tprintf(\"L+\");\n\tif (irq->flags & ISAPNP_IRQTYPE_LEVEL_MINUS)\n\t\tprintf(\"L-\");\n\tprintf(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "COPY",
          "args": [
            "(*dev)->ipa_devclass",
            "buf"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COPY",
          "args": [
            "(*card)->ipa_devident",
            "buf"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"ANSI Ident: %s\\n\", buf)"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"<<<End dependent functions\\n\")"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_print_dep_start",
          "args": [
            "\">>> Start dependent function \"",
            "(*conf)->ipa_pref"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_dep_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "184-216",
          "snippet": "void\nisapnp_print_dep_start(str, pref)\n\tconst char *str;\n\tconst u_char pref;\n{\n\n\tprintf(\"%sconfig: \", str);\n\tswitch (pref) {\n\tcase ISAPNP_DEP_PREFERRED:\n\t\tprintf(\"preferred\\n\");\n\t\tbreak;\n\t\n\tcase ISAPNP_DEP_ACCEPTABLE:\n\t\tprintf(\"acceptable\\n\");\n\t\tbreak;\n\n\tcase ISAPNP_DEP_FUNCTIONAL:\n\t\tprintf(\"functional\\n\");\n\t\tbreak;\n\n\tcase ISAPNP_DEP_UNSET: \t\t/* Used internally */\n\t\tprintf(\"unset\\n\");\n\t\tbreak;\n\n\tcase ISAPNP_DEP_CONFLICTING:\t/* Used internally */\n\t\tprintf(\"conflicting\\n\");\n\t\tbreak;\n\n\tdefault:\n\t\tprintf(\"invalid\\n\");\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_print_dep_start(str, pref)\n\tconst char *str;\n\tconst u_char pref;\n{\n\n\tprintf(\"%sconfig: \", str);\n\tswitch (pref) {\n\tcase ISAPNP_DEP_PREFERRED:\n\t\tprintf(\"preferred\\n\");\n\t\tbreak;\n\t\n\tcase ISAPNP_DEP_ACCEPTABLE:\n\t\tprintf(\"acceptable\\n\");\n\t\tbreak;\n\n\tcase ISAPNP_DEP_FUNCTIONAL:\n\t\tprintf(\"functional\\n\");\n\t\tbreak;\n\n\tcase ISAPNP_DEP_UNSET: \t\t/* Used internally */\n\t\tprintf(\"unset\\n\");\n\t\tbreak;\n\n\tcase ISAPNP_DEP_CONFLICTING:\t/* Used internally */\n\t\tprintf(\"conflicting\\n\");\n\t\tbreak;\n\n\tdefault:\n\t\tprintf(\"invalid\\n\");\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_newconf",
          "args": [
            "*dev"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COPY",
          "args": [
            "(*dev)->ipa_devcompat",
            "str"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"Compatible device id %s\\n\", str)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_id_to_vendor",
          "args": [
            "str",
            "buf"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COPY",
          "args": [
            "(*dev)->ipa_devlogic",
            "str"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_newdev",
          "args": [
            "*card"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"Logical device id %s\\n\", str)"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_id_to_vendor",
          "args": [
            "str",
            "buf"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"PnP version %d.%d, Vendor version %d.%d\\n\",\n\t\t    buf[0] >> 4, buf[0] & 0xf, buf[1] >> 4,  buf[1] & 0xf)"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct isa_attach_args *\n    isapnp_newdev;\nstruct isa_attach_args *\n    isapnp_newconf;\nint isapnp_process_tag;\nstruct isa_attach_args *\nisapnp_newdev(card)\n\tstruct isa_attach_args *card;\nstruct isa_attach_args *\nisapnp_newconf(dev)\n\tstruct isa_attach_args *dev;\nstruct isa_attach_args *\nisapnp_flatten(card)\n\tstruct isa_attach_args *card;\n\nint\nisapnp_process_tag(tag, len, buf, card, dev, conf)\n\tu_char tag, len, *buf;\n\tstruct isa_attach_args **card, **dev, **conf;\n{\n\tchar str[64];\n\tstruct isapnp_region *r;\n\tstruct isapnp_pin *p;\n\tstruct isa_attach_args *pa;\n\n#define COPY(a, b) strncpy((a), (b), sizeof(a)), (a)[sizeof(a) - 1] = '\\0'\n\n\tswitch (tag) {\n\tcase ISAPNP_TAG_VERSION_NUM:\n\t\tDPRINTF((\"PnP version %d.%d, Vendor version %d.%d\\n\",\n\t\t    buf[0] >> 4, buf[0] & 0xf, buf[1] >> 4,  buf[1] & 0xf));\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_LOGICAL_DEV_ID:\n\t\t(void) isapnp_id_to_vendor(str, buf);\n\t\tDPRINTF((\"Logical device id %s\\n\", str));\n\n\t\t*dev = isapnp_newdev(*card);\n\t\tCOPY((*dev)->ipa_devlogic, str);\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_COMPAT_DEV_ID:\n\t\t(void) isapnp_id_to_vendor(str, buf);\n\t\tDPRINTF((\"Compatible device id %s\\n\", str));\n\n\t\tif (*dev == NULL)\n\t\t\treturn -1;\n\n\t\tif (*(*dev)->ipa_devcompat == '\\0')\n\t\t\tCOPY((*dev)->ipa_devcompat, str);\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_DEP_START:\n\t\tif (len == 0)\n\t\t\tbuf[0] = ISAPNP_DEP_ACCEPTABLE;\n\n\t\tif (*dev == NULL)\n\t\t\treturn -1;\n\n\t\t*conf = isapnp_newconf(*dev);\n\t\t(*conf)->ipa_pref = buf[0];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_dep_start(\">>> Start dependent function \",\n\t\t    (*conf)->ipa_pref);\n#endif\n\t\treturn 0;\n\t\t\n\tcase ISAPNP_TAG_DEP_END:\n\t\tDPRINTF((\"<<<End dependent functions\\n\"));\n\t\t*conf = NULL;\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_ANSI_IDENT_STRING:\n\t\tbuf[len] = '\\0';\n\t\tDPRINTF((\"ANSI Ident: %s\\n\", buf));\n\t\tif (*dev == NULL)\n\t\t\tCOPY((*card)->ipa_devident, buf);\n\t\telse\n\t\t\tCOPY((*dev)->ipa_devclass, buf);\n\t\treturn 0;\n\n\tcase ISAPNP_TAG_END:\n\t\t*dev = NULL;\n\t\treturn 0;\n\n\tdefault:\n\t\t/* Handled below */\n\t\tbreak;\n\t}\n\n\n\t/*\n\t * Decide which configuration we add the tag to\n\t */\n\tif (*conf)\n\t\tpa = *conf;\n\telse if (*dev)\n\t\tpa = *dev;\n\telse\n\t\t/* error */\n\t\treturn -1;\n\n\tswitch (tag) {\n\tcase ISAPNP_TAG_IRQ_FORMAT:\n\t\tif (len < 2)\n\t\t\tbreak;\n\n\t\tif (len != 3)\n\t\t\tbuf[2] = ISAPNP_IRQTYPE_EDGE_PLUS;\n\n\t\tp = &pa->ipa_irq[pa->ipa_nirq++];\n\t\tp->bits = buf[0] | (buf[1] << 8);\n\t\tp->flags = buf[2];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_irq(\"\", p);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_DMA_FORMAT:\n\t\tif (buf[0] == 0)\n\t\t\tbreak;\n\n\t\tp = &pa->ipa_drq[pa->ipa_ndrq++];\n\t\tp->bits = buf[0];\n\t\tp->flags = buf[1];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_drq(\"\", p);\n#endif\n\t\tbreak;\n\n\n\tcase ISAPNP_TAG_IO_PORT_DESC:\n\t\tr = &pa->ipa_io[pa->ipa_nio++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[2] << 8) | buf[1];\n\t\tr->maxbase = (buf[4] << 8) | buf[3];\n\t\tr->align = buf[5];\n\t\tr->length = buf[6];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_io(\"\", r);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_FIXED_IO_PORT_DESC:\n\t\tr = &pa->ipa_io[pa->ipa_nio++];\n\t\tr->flags = 0;\n\t\tr->minbase = (buf[1] << 8) | buf[0];\n\t\tr->maxbase = r->minbase;\n\t\tr->align = 1;\n\t\tr->length = buf[2];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_io(\"FIXED \", r);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_VENDOR_DEF:\n\t\tDPRINTF((\"Vendor defined (short)\\n\"));\n\t\tbreak;\n\n\tcase ISAPNP_TAG_MEM_RANGE_DESC:\n\t\tr = &pa->ipa_mem[pa->ipa_nmem++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[2] << 16) | (buf[1] << 8);\n\t\tr->maxbase = (buf[4] << 16) | (buf[3] << 8);\n\t\tr->align = (buf[6] << 8) | buf[5];\n\t\tr->length = (buf[8] << 16) | (buf[7] << 8);\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_mem(\"\", r);\n#endif\n\t\tbreak;\n\n\n\tcase ISAPNP_TAG_UNICODE_IDENT_STRING:\n\t\tDPRINTF((\"Unicode Ident\\n\"));\n\t\tbreak;\n\n\tcase ISAPNP_TAG_VENDOR_DEFINED:\n\t\tDPRINTF((\"Vendor defined (long)\\n\"));\n\t\tbreak;\n\n\tcase ISAPNP_TAG_MEM32_RANGE_DESC:\n\t\tr = &pa->ipa_mem32[pa->ipa_nmem32++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[4] << 24) | (buf[3] << 16) |\n\t\t    (buf[2] << 8) | buf[1];\n\t\tr->maxbase = (buf[8] << 24) | (buf[7] << 16) |\n\t\t    (buf[6] << 8) | buf[5];\n\t\tr->align = (buf[12] << 24) | (buf[11] << 16) | \n\t\t    (buf[10] << 8) | buf[9];\n\t\tr->length = (buf[16] << 24) | (buf[15] << 16) |\n\t\t    (buf[14] << 8) | buf[13];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_mem(\"32-bit \", r);\n#endif\n\t\tbreak;\n\n\tcase ISAPNP_TAG_FIXED_MEM32_RANGE_DESC:\n\t\tr = &pa->ipa_mem32[pa->ipa_nmem32++];\n\t\tr->flags = buf[0];\n\t\tr->minbase = (buf[4] << 24) | (buf[3] << 16) |\n\t\t    (buf[2] << 8) | buf[1];\n\t\tr->maxbase = r->minbase;\n\t\tr->align = 1;\n\t\tr->length = (buf[8] << 24) | (buf[7] << 16) |\n\t\t    (buf[6] << 8) | buf[5];\n#ifdef DEBUG_ISAPNP\n\t\tisapnp_print_mem(\"FIXED 32-bit \", r);\n#endif\n\t\tbreak;\n\n\tdefault:\n#ifdef DEBUG_ISAPNP\n\t\t{\n\t\t\tint i;\n\t\t\tprintf(\"tag %.2x, len %d: \", tag, len);\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tprintf(\"%.2x \", buf[i]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n#endif\n\t\tbreak;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "isapnp_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpres.c",
    "lines": "152-173",
    "snippet": "void\nisapnp_merge(c, d)\n\tstruct isa_attach_args *c;\n\tconst struct isa_attach_args *d;\n{\n\tint i;\n\n\tfor (i = 0; i < d->ipa_nio; i++)\n\t\tc->ipa_io[c->ipa_nio++] = d->ipa_io[i];\n\n\tfor (i = 0; i < d->ipa_nmem; i++)\n\t\tc->ipa_mem[c->ipa_nmem++] = d->ipa_mem[i];\n\n\tfor (i = 0; i < d->ipa_nmem32; i++)\n\t\tc->ipa_mem32[c->ipa_nmem32++] = d->ipa_mem32[i];\n\n\tfor (i = 0; i < d->ipa_nirq; i++)\n\t\tc->ipa_irq[c->ipa_nirq++] = d->ipa_irq[i];\n\n\tfor (i = 0; i < d->ipa_ndrq; i++)\n\t\tc->ipa_drq[c->ipa_ndrq++] = d->ipa_drq[i];\n}",
    "includes": [
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_merge",
      "int c;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_merge;\nint c;\n\nvoid\nisapnp_merge(c, d)\n\tstruct isa_attach_args *c;\n\tconst struct isa_attach_args *d;\n{\n\tint i;\n\n\tfor (i = 0; i < d->ipa_nio; i++)\n\t\tc->ipa_io[c->ipa_nio++] = d->ipa_io[i];\n\n\tfor (i = 0; i < d->ipa_nmem; i++)\n\t\tc->ipa_mem[c->ipa_nmem++] = d->ipa_mem[i];\n\n\tfor (i = 0; i < d->ipa_nmem32; i++)\n\t\tc->ipa_mem32[c->ipa_nmem32++] = d->ipa_mem32[i];\n\n\tfor (i = 0; i < d->ipa_nirq; i++)\n\t\tc->ipa_irq[c->ipa_nirq++] = d->ipa_irq[i];\n\n\tfor (i = 0; i < d->ipa_ndrq; i++)\n\t\tc->ipa_drq[c->ipa_ndrq++] = d->ipa_drq[i];\n}"
  },
  {
    "function_name": "isapnp_wait_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpres.c",
    "lines": "70-83",
    "snippet": "int\nisapnp_wait_status(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\n\t/* wait up to 1 ms for each resource byte */\n\tfor (i = 0; i < 10; i++) {\n\t\tif (isapnp_read_reg(sc, ISAPNP_STATUS) & 1)\n\t\t\treturn 0;\n\t\tDELAY(100);\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isapnp_wait_status",
      "struct isa_attach_args *\nisapnp_get_resource(sc, c)\n\tstruct isapnp_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "100"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_read_reg",
          "args": [
            "sc",
            "ISAPNP_STATUS"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_read_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isavar.h",
          "lines": "433-439",
          "snippet": "static __inline u_char\nisapnp_read_reg(sc, r)\n\tstruct isapnp_softc *sc;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\treturn ISAPNP_READ_DATA(sc);\n}",
          "includes": [
            "#include <alpha/isa/isapnp_machdep.h>",
            "#include <i386/isa/isapnp_machdep.h>",
            "#include \"isapnp.h\"",
            "#include <hppa/isa/isa_machdep.h>",
            "#include <powerpc/isa/isa_machdep.h>",
            "#include <wgrisc/isa/isa_machdep.h>",
            "#include <arc/isa/isa_machdep.h>",
            "#include <i386/isa/isa_machdep.h>",
            "#include <amiga/isa/isa_machdep.h>",
            "#include <alpha/isa/isa_machdep.h>",
            "#include \"isadma.h\"",
            "#include <machine/bus.h>",
            "#include <sys/queue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <alpha/isa/isapnp_machdep.h>\n#include <i386/isa/isapnp_machdep.h>\n#include \"isapnp.h\"\n#include <hppa/isa/isa_machdep.h>\n#include <powerpc/isa/isa_machdep.h>\n#include <wgrisc/isa/isa_machdep.h>\n#include <arc/isa/isa_machdep.h>\n#include <i386/isa/isa_machdep.h>\n#include <amiga/isa/isa_machdep.h>\n#include <alpha/isa/isa_machdep.h>\n#include \"isadma.h\"\n#include <machine/bus.h>\n#include <sys/queue.h>\n\nstatic __inline u_char\nisapnp_read_reg(sc, r)\n\tstruct isapnp_softc *sc;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\treturn ISAPNP_READ_DATA(sc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_wait_status;\nstruct isa_attach_args *\nisapnp_get_resource(sc, c)\n\tstruct isapnp_softc *sc;\n\nint\nisapnp_wait_status(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\n\t/* wait up to 1 ms for each resource byte */\n\tfor (i = 0; i < 10; i++) {\n\t\tif (isapnp_read_reg(sc, ISAPNP_STATUS) & 1)\n\t\t\treturn 0;\n\t\tDELAY(100);\n\t}\n\treturn 1;\n}"
  }
]